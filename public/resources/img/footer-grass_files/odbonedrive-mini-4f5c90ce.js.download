define("d8",["require","exports","jn","aC","jm","aq","bA","dc","jl","jk","jj","ji","jg","jf","i6","iX","iW","iV","iU","iT","iQ","iP","iO","iN","iM","iL","iK","iJ","iI","iH","cX","bX","dZ","iG","iF","d7","iE","iD","iC","iB","iA","iy","ix","iw","iv","iu","is","hz","hy","hx","hw","hv","hu","hd","g7","g2","gN","gM","gJ","gH","gG","gE","gD","gB","gw","gs","gq","gp","go","gn","gm","gd","f9","f8","f7","fQ","fP","fN","fM","fG","fF","fD","fz","fy","fw","bz","ft","fh","fb","ba","e6","e3","e2","eK","eI","c7","bt","eD","bi","eC","a9","dH","eB","es","bI","er","d9"],function(h,e,t,m,g,y,v,_,b,S,w,T,C,x,I,P,E,D,k,U,R,F,A,O,L,M,N,q,V,B,H,K,j,G,z,W,X,Q,J,Y,Z,$,ee,te,re,ie,ne,oe,ae,se,ue,le,ce,de,pe,fe,he,me,ge,ye,ve,_e,r,be,Se,we,Te,Ce,xe,Ie,Pe,Ee,De,ke,Ue,Re,Fe,Ae,Oe,Le,Me,Ne,qe,Ve,Be,He,Ke,je,Ge,ze,We,Xe,Qe,Je,Ye,Ze,i,$e,et,tt,rt,it,nt,ot){"use strict";Object.defineProperty(e,"__esModule",{value:!0});t.default();var at="Documents";(new(function(){function e(){Ge.default.addToLoggingManager("ODBNext",new je.default);var i=this._resourceScope=new v.ResourceScope({owner:"ODBOneDrive",useFactoriesOnKeys:!0});i.exposeAsync(j.engagementHandlers,new v.AliasResourceLoader(function(){return Ze.loadModuleExport({path:"VS",getModule:function(){return new m.default(function(e,t){h(["VS"],e,t)})},getExport:function(e){return e.resourceKey}})}));i.expose(j.bundle,new(i.injected(Ue.default)));var e=new(i.injected(we.default));i.expose(W.bundleLoader,e);i.expose(J.dataContext,new(i.injected(Ce.default)));var t=i.consume(q.resourceKey);i.expose(z.userInfoStore,new xe.default);var r=window._spPageContextInfo;r.listUrl=new et.default(r.webAbsoluteUrl).path+"/"+at;i.expose(K.viewParams,y.observable({}));i.expose(z.userSettingsStore,new Ie.default);var n=new Be.default,o=n.viewParams&&n.viewParams.env&&"WebView"===n.viewParams.env;i.expose(K.isWebViewHosted,o);i.expose(_.navigation,n);i.expose(X.pageContext,r);var a=i.expose(j.url,new(i.injected(he.default))),s=a.getPageType(),u=a.getQueryType();s===rt.default.Files&&u===it.default.Files&&i.expose(v.asyncLoadBarrierKey,{wait:function(){return e.waitForPLT()}});i.expose(j.settings,new ue.default);i.expose(j.microService,new(i.resolved(Re.default))({}));i.exposeFactory(j.identity,new v.AliasResourceFactory(T.resourceKey));i.expose(j.userInfo,new(i.injected(Ee.default)));i.expose(W.userInfo,new(i.injected(De.default)));i.expose(Q.experimentHelper,new(i.injected($e.default)));i.expose(j.teachingBubble,new(i.injected(Fe.default)));i.exposeFactory(W.teachingBubble,new v.AliasResourceFactory(H.resourceKey));i.exposeFactory(j.people,new v.AliasResourceFactory(P.resourceKey));i.expose(j.instrumentation,new(i.injected(be.default)));i.expose(W.instrumentation,new(i.injected(Se.default)));i.expose(j.shareByLink,new(i.injected(le.default))(r));i.expose(W.shareByLink,new(i.injected(ce.default)));i.expose(j.folderItemCount,new(i.injected(Z.default)));i.expose(j.itemActivity,new(i.injected(te.default)));i.expose(W.itemActivity,new(i.injected(re.default)));i.expose(j.itemActivityFeed,new ie.default(r));i.exposeAsync(j.batchUploaderType,new v.AliasResourceLoader(function(){return Ze.loadModuleExport({path:"vl",getModule:function(){return new m.default(function(e,t){h(["vl"],e,t)})},getExport:function(e){return e.typeResourceKey}})}));i.exposeFactory(j.rootItems,new v.AliasResourceFactory(R.resourceKey));var l=ze.isFeatureEnabled(ze.UseOLSQueryForSearch)&&"EDOG_Content"!==r.farmLabel;i.expose(b.isOLSQueryEnabledResourceKey,l);i.exposeFactory(j.restore,new v.AliasResourceFactory(k.resourceKey));i.exposeFactory(j.restoreActivities,new v.AliasResourceFactory(U.resourceKey));if(ze.isFeatureEnabled(ze.UseQfSearch))i.exposeFactory(j.search,new v.AliasResourceFactory(F.resourceKey));else{i.expose(X.searchBehavior,{supportsResultsWheeling:!0,searchScope:0,showSearchPage:!0});i.exposeFactory(j.search,new v.AliasResourceFactory(A.resourceKey))}ze.isFeatureEnabled(ze.ODBFlow)&&i.exposeAsync(j.list,new v.AliasResourceLoader(function(){return Ze.loadModuleExport({path:"hD",getModule:function(){return new m.default(function(e,t){h(["hD"],e,t)})},getExport:function(e){return e.resourceKey}})}));i.expose(K.useMobileList,!1);i.expose(j.sharing,new(i.injected(de.default))(r));i.expose(j.sharingData,new(i.injected(pe.default))(r));i.exposeAsync(j.sites,new v.AliasResourceLoader(function(){return Ze.loadModuleExport({path:"vR",getModule:function(){return new m.default(function(e,t){h(["vR"],e,t)})},getExport:function(e){return e.resourceKey}})}));i.exposeAsync(j.trendingDocs,new v.AliasResourceLoader(function(){return Ze.loadModuleExport({path:"VK",getModule:function(){return new m.default(function(e,t){h(["VK"],e,t)})},getExport:function(e){return e.resourceKey}})}));i.expose(tt.sharepointUrl,y.observable(""));i.expose(tt.isTenantAdmin,y.observable(!1));i.expose(j.suiteNav,new(i.resolved(fe.default))({workloadId:ne.default.ONEDRIVE,showMySiteSettings:!ze.isFeatureEnabled(ze.HideODBSiteSettings),helpNamespace:"Groove",helpId:"ODB_Overview"}));i.expose(G.rumOneHelper,new(i.injected(Ke.default))("ODBNext"));i.expose(j.versionControl,new(i.injected(me.default)));i.expose(j.versionHistory,new(i.injected(ge.default)));i.expose(K.isItemSetRendered,y.observable(!1));i.expose(K.isInNewRecentView,y.observable(!1));i.exposeFactory(nt.resourceKey,new v.AliasResourceFactory(ot.resourceKey));Pe.default.addConfig({enforceDefine:!1});Pe.default.addPaths({optimizely:he.default.OPTIMIZELY_URL});ze.isFeatureEnabled(ze.RecycleBinImmersive)&&i.expose(j.footer,new(i.injected($.default)));i.expose(K.isDebugWindowVisible,y.observable(!0));i.exposeFactory(j.shortcut,new v.AliasResourceFactory(C.resourceKey));var c=function(e,t,r){i.exposeAsync(e,new v.AliasResourceLoader(function(){return Ze.loadModuleExport({path:t,getModule:r,getExport:function(e){return e.resourceKey}})}))};c(j.graphUrl,"i3",function(){return new m.default(function(e,t){h(["i3"],e,t)})});c(W.graphToken,"i4",function(){return new m.default(function(e,t){h(["i4"],e,t)})});c(j.fileHandler,"VG",function(){return new m.default(function(e,t){h(["VG"],e,t)})});c(j.preAuth,"VI",function(){return new m.default(function(e,t){h(["VI"],e,t)})});c(j.appUrl,"VL",function(){return new m.default(function(e,t){h(["VL"],e,t)})});c(Q.fileHandlerHelper,"VM",function(){return new m.default(function(e,t){h(["VM"],e,t)})});c(j.graph,"VN",function(){return new m.default(function(e,t){h(["VN"],e,t)})});var d=new(i.injected(oe.default))({itemsStore:t,pageContext:r,listRootFolderWebRelativeUrl:at,useFolderScopedSearch:!1});i.expose(j.getItem,d);i.expose(j.items,d);i.expose(j.deleteRestore,d);i.expose(j.iosMobileAppPath,new(i.injected(ee.default)));i.expose(Q.newFeatureExperienceEnabler,new(i.injected(We.default)));i.expose(j.newFeatureExperience,new(i.injected(Xe.default)));i.expose(W.newFeatureExperience,new(i.injected(Qe.default)));i.exposeFactory(j.download,new v.AliasResourceFactory(S.resourceKey));i.expose(j.copy,new(i.injected(ae.default))(r));i.expose(Je.resourceKey,new(i.resolved(Je.default))({}));i.expose(Q.syncActiveXClient,new(i.injected(Ye.default))({}));i.expose(j.language,new(i.injected(ye.default)));i.expose(j.encoding,new(i.injected(ve.default)));i.expose(W.encoding,new(i.injected(_e.default)));i.exposeFactory(j.videoItem,new v.AliasResourceFactory(L.resourceKey));i.expose(W.profile,new(i.injected(Te.default)));i.exposeFactory(j.subscriptions,new v.AliasResourceFactory(O.resourceKey));i.expose(W.subscriptions,new(i.injected(ke.default)));i.exposeFactory(j.folder,new v.AliasResourceFactory(w.resourceKey));i.exposeFactory(j.itemCommand,new v.AliasResourceFactory(I.resourceKey));i.expose(j.error,new(i.injected(Y.default)));i.expose(K.isFirstRunExperienceVisible,y.observable(!1));i.expose(W.uploadTeachingBubble,new(i.injected(Ne.default)));i.expose(K.didUserUploadOrCreateFile,y.observable(!1));i.expose(K.didUserCreateOfficeFile,y.observable(!1));i.expose(K.mobileUpsellDismissedThisSession,y.observable(!1));i.expose(N.allowInfectedFileDownloadsResourceKey,r.allowInfectedDownload);var p=new He.default;if(!p.isWindows&&!p.isWinPhone){e.queueLoad("ay",function(){return new m.default(function(e,t){h(["ay"],e,t)})});e.queueLoad("a7",function(){return new m.default(function(e,t){h(["a7"],e,t)})})}if(ze.isFeatureEnabled(ze.PeopleCardsOnLoki)&&!ze.isFeatureEnabled(ze.PeopleCardsReactComponent)){i.expose(j.peopleCardFactory,function(){return Ze.loadModule({path:"Rj",getModule:function(){return new m.default(function(e,t){h(["Rj"],e,t)})}}).then(function(e){if(i.isExposed(j.peopleCard))return i.consume(j.peopleCard);var t=new(i.injected(e));return i.expose(j.peopleCard,t)})});i.expose(W.peopleCard,new(i.injected(se.default)))}r.isSPO||i.expose(K.displayImageTileNames,!0);i.expose(K.isSharingSectionExpanded,y.observable(!1));i.expose(j.recycleBin,new(i.injected(Ae.default)));i.expose(W.recycleBin,new(i.injected(Oe.default)));i.expose(W.dragAndDropRobot,new(i.injected(Le.default)));i.expose(j.site,new(i.injected(qe.default))(r));i.expose(W.site,new(i.injected(Ve.default)));i.exposeFactory(j.policyTip,new v.AliasResourceFactory(E.resourceKey));var f=e.createDeferredContext(1);f.expose(j.teachingBanner,"FG",function(){return new m.default(function(e,t){h(["FG"],e,t)})});f.expose(W.teachingBanner,"FH",function(){return new m.default(function(e,t){h(["FH"],e,t)})});f.expose(j.firstRunExperience,"Fg",function(){return new m.default(function(e,t){h(["Fg"],e,t)})});f.expose(W.firstRunExperience,"Ff",function(){return new m.default(function(e,t){h(["Ff"],e,t)})});f.expose(W.smartFilters,"E3",function(){return new m.default(function(e,t){h(["E3"],e,t)})});f.expose(j.guidedTour,"EQ",function(){return new m.default(function(e,t){h(["EQ"],e,t)})});f.expose(W.guidedTour,"ET",function(){return new m.default(function(e,t){h(["ET"],e,t)})});(f=e.createDeferredContext(2)).expose(j.notifications,"ahp",function(){return new m.default(function(e,t){h(["ahp"],e,t)})});f.expose(W.notification,"ahq",function(){return new m.default(function(e,t){h(["ahq"],e,t)})});f.expose(W.notificationManager,"aho",function(){return new m.default(function(e,t){h(["aho"],e,t)})});i.exposeFactory(j.web,new v.AliasResourceFactory(M.resourceKey));if(ze.isFeatureEnabled(ze.EnablePushChannel)){i.exposeFactory(j.pushChannel,new v.AliasResourceFactory(D.resourceKey));i.exposeFactory(j.itemAutoRefresh,new v.AliasResourceFactory(x.resourceKey));i.consumeAsync(ze.isFeatureEnabled(ze.EnablePushChannelAutoRefresh)?V.resourceKey:B.resourceKey)}i.exposeAsync(j.vroomItemIdentityProcessor,new v.AliasResourceLoader(function(){return Ze.loadModuleExport({path:"Vc",getModule:function(){return new m.default(function(e,t){h(["Vc"],e,t)})},getExport:function(e){return e.resourceKey}})}));i.exposeAsync(j.analytics,new v.AliasResourceLoader(function(){return Ze.loadModuleExport({path:"Rn",getModule:function(){return new m.default(function(e,t){h(["Rn"],e,t)})},getExport:function(e){return e.resourceKey}})}));i.exposeAsync(j.zip,new v.AliasResourceLoader(function(){return Ze.loadModuleExport({path:"Rs",getModule:function(){return new m.default(function(e,t){h(["Rs"],e,t)})},getExport:function(e){return e.resourceKey}})}));i.exposeAsync(j.customAction,new v.AliasResourceLoader(function(){return Ze.loadModuleExport({path:"NO",getModule:function(){return new m.default(function(e,t){h(["NO"],e,t)})},getExport:function(e){return e.resourceKey}})}));i.expose(W.customAction,new(i.resolved(Me.default))({}));g.EngagementHelpers.registerClicks("ODB")}e.prototype.main=function(){this._applyBindings()};e.prototype._applyBindings=function(){this._addPinnedTabIcon();var e=document.createElement("div");document.body.appendChild(e);y.applyBindingsToNode(e,{component:{name:i.default.tagName,params:{resources:this._resourceScope}}})};e.prototype._addPinnedTabIcon=function(){r.default.SetMaskIcon("undefined"==typeof __webpack_public_path__?"odsp-media/images/maskicon/mask_icon.svg":h("@ms/odsp-media/dist/media/images/maskIcon/mask_icon.svg"),"#094AB2")};return e}())).main();window.__ko=y});define("jn",["require","exports","jr","jq","jo"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.default({workload:"ODB",tokens:i.ODBTenantTokens});t.default=function(){}});define("jr",["require","exports","jC","jz","aZ","aV","jy","jx","da","jw","ju","js"],function(e,t,r,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.default.init();t.default=function(e){var t="",r=window._spPageContextInfo.env||"devbox",i="",n="",o=window._spModuleLink;if(o){i=o.buildNumber;n=o.manifestName;if(o.usingRedirectCookie)t=e.tokens.ppe;else switch(r.toLowerCase()){case"edog":case"prodbubble":t=e.tokens.ppe;break;case"prod":case"dprod":t=e.tokens.prod;break;default:t=e.tokens.ppe}}t&&"dev"!==i&&a.default.Init(t,{isAuthenticated:!window._spPageContextInfo.isAnonymousGuestUser,market:window._spPageContextInfo.currentUICultureName,session:s.default.generate(),version:i,manifest:n,userId:window._spPageContextInfo.systemUserKey,accountType:window._spPageContextInfo.userLoginName?u.AccountType.Business:u.AccountType.BusinessAnonymous,siteSubscriptionId:window._spPageContextInfo.siteSubscriptionId,farmLabel:window._spPageContextInfo.farmLabel,environment:r,workload:e.workload,disableCookies:window._spPageContextInfo.isAnonymousGuestUser})}});define("jC",["require","exports","fe","jy"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,n=function(){function e(){}e.init=function(){i||(i=r.PageInit.logData({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0}));return i};return e}();t.default=n});define("fe",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PageInit=r.createSingleEvent({eventName:"PageInit,",shortEventName:"PageInit",requiresParent:!1},{screenWidth:2,screenHeight:2,availableScreenWidth:2,availableScreenHeight:2,renderWidth:2,renderHeight:2,browserWidth:2,browserHeight:2,devicePixelRatio:2,referrer:1});t.default=t.PageInit});define("jy",["require","exports","aU","aV","jt"],function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.Manager.logValidationError=function(e,t){var r=n.ValidationErrorType[t];o.default.enabled()&&o.default.logData({message:"Validation error for "+e.shortEventName+" of type "+r,validatedEventName:e.shortEventName,validatedFullEventName:e.eventName,validationType:r,stack:i.Manager.getStack()},e)}});define("jt",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ValidationError=r.createSingleEvent({eventName:"ValidationError,",shortEventName:"ValidationError",samplingFeature:{ODB:-1,ODC:"ValidationErrorSampling",Fallback:!1},critical:!0,requiresParent:!1},{message:1,validationType:1,validatedEventName:1,validatedFullEventName:1,stack:1});t.default=t.ValidationError});define("jz",["require","exports","aW","jA"],function(i,e,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=function(){function e(){}e.Init=function(t,r){(r.forceEnabled||n.default.isFeatureEnabled(this.EnableAriaLogging))&&i(["aria"],function(e){o.default.Init(t,r,e)})};Object.defineProperty(e,"logStartEvents",{get:function(){return o.default.logStartEvents},set:function(e){o.default.logStartEvents=e},enumerable:!0,configurable:!0});e.getAriaTimeZone=function(e){var t=Math.abs(e),r=t%60,i=Math.floor(t/60);return(0<e?"-":"+")+(10<=i?i:"0"+i)+":"+(10<=r?r:"0"+r)};e.EnableAriaLogging={ODB:588,ODC:"EnableAriaLogging",Fallback:!1};return e}();e.default=t});define("jA",["require","exports","aV","aU","fg","aN","fx","bz","V","jB","bi"],function(e,t,m,d,g,y,p,f,v,h,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b,S,w="AriaBeacon",T={logStartEvents:!1,Init:function(e,t,r){try{b=r;T.logStartEvents=!0;var i=new f.default,n={disableCookies:t.disableCookies};b.LogManager.initialize(e,n);var o=(S=new b.Logger).getSemanticContext(),a=o.contextMap;a["AppInfo.Session"]=t.session;o.setAppVersion(t.version);a["AppInfo.Manifest"]=t.manifest;o.setUserLanguage(t.market||"");o.setUserId(t.userId);o.setDeviceOsName(i.osName);o.setDeviceOsVersion(i.osVersion);p.default.init();p.default.registerHandler(function(e){e&&b.LogManager.flush(null);return null});var s={AccountType:m.AccountType[t.accountType],Environment:t.environment,Workload:t.workload,IsAuthenticated:t.isAuthenticated?1:0,BrowserName:i.browserName,BrowserMajVer:i.browserMajor,BrowserMinVer:i.browserMinor,BrowserUserAgent:i.userAgent,BrowserIsMobile:i.isMobile,SiteSubscriptionId:t.siteSubscriptionId||""};t.farmLabel&&(s.FarmLabel=t.farmLabel);for(var u in s)S.setContext(u,s[u]);var l=new _.SimpleUri(t.completenessCallbackEndpoint),c={telemetryTenantToken:e,appVersion:t.version,environment:t.environment,workload:t.workload,farmLabel:t.farmLabel,callbackEndpoint:l};b.LogManager.addCallbackListener(function(e,t,r,i){new g.Beacon({name:w,retryCount:0,totalRetries:0,eventCount:i?i.length:0}).end({success:0===e,status:t+""});0;""!==l.authority&&new h.DataCompletenessInfo(c,e,t,(new Date).getTime(),i).send()});d.Manager.addLogHandler(C).forEach(C)}catch(e){e instanceof b.Exception&&(e=new Error("Aria error: "+e.toString()));y.default.log(e)}},isInitialized:function(e){var t=!1;try{t=e.LogManager.isInitialized()}catch(e){e instanceof b.Exception&&(e=new Error("Aria error: "+e.toString()));y.default.log(e)}return t}};t.default=T;function C(e){try{!function(e){if(e.enabled&&(e.eventType!==m.ClonedEventType.Start||T.logStartEvents)&&(!g.Beacon.isTypeOf(e)||!e.data||e.data.name!==w)){var t=new b.EventProperties,r={CorrelationVector:e.vector.toString(),ValidationErrors:e.validationErrors,WebLog_FullName:e.eventName,WebLog_EventType:m.ClonedEventType[e.eventType]};e.eventType===m.ClonedEventType.End&&(r.Duration=e.endTime-e.startTime);for(var i=e.eventName.split(","),n=0,o=i;n<o.length;n++){var a=o[n];a&&(r["WebLog_Type_"+a]=1)}var s=!1,u=e.data;if(u)for(var l in u){var c=u[l];if(null!=c){var d=e.metadata[l];if(d){var p=d.isPrefixingDisabled?v.capitalize(l):v.capitalize(d.definedInName)+"_"+l,f=d.type;if(4===f)for(var h in c)void 0!==c[h]&&(r[p+"_"+h.replace(".","_")]=c[h]);else r[p]=6===f?d.typeRef[c]:c;d.isEventTypePrefixingDisabled&&(s=!0)}}}t.name=s?i[i.length-2]:"ev_"+i[i.length-2];!function(e,t){var r;try{for(r in t)e.setProperty(r,t[r])}catch(e){var i=void 0,n=void 0;if(e instanceof b.Exception){i=e.ErrorCode();n=new Error("Aria error: "+e.toString())}if(n){e.handled=!0;y.default.logError(n,{errorCode:i,propertyKey:r})}throw e}}(t,r);S.logEvent(t)}}(e)}catch(e){var t=void 0;e instanceof b.Exception&&(t=new Error("Aria error: "+e.toString()));e&&e.handled||y.default.log(t||e)}}});define("fg",["require","exports","aK"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Beacon=r.createPairedEvent({eventName:"Beacon,",shortEventName:"Beacon",requiresParent:!1},{name:1,status:1,success:3,retryCount:2,totalRetries:2,eventCount:2});t.default=t.Beacon});define("fx",["require","exports","aN","bS"],function(e,t,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){this._localHandlers=[]}n.init=function(){var t=this;if(!this._initialized){this._initialized=!0;this._originalBeforeUnload=window.onbeforeunload;window.onbeforeunload=window.__onbeforeunload=function(e){return t._handleBeforeUnload(e)}}};n.registerHandler=function(e){this._handlers.push(e)};n.unRegisterHandler=function(e){for(var t=0;t<this._handlers.length;t++)if(this._handlers[t]===e){this._handlers.splice(t,1);break}};n.dispose=function(){this._originalBeforeUnload?window.onbeforeunload=this._originalBeforeUnload:window.onbeforeunload=null};n._handleBeforeUnload=function(e){var t=void 0;if(!this._allowNavs){for(var r=0;r<this._handlers.length;r++)try{if(t=this._handlers[r](!0))break}catch(e){o.default.log(e)}if(!t&&this._originalBeforeUnload)try{t=this._originalBeforeUnload(e)}catch(e){o.default.log(e)}}return t||void 0};n.prototype.registerHashNavDialogCallback=function(e){this._hashNavDialogCallback=e};n.prototype.allowHashNav=function(e,t){var r=void 0;if(!n._isDialogOpen&&!n._allowNavs){for(var i=0;i<n._handlers.length;i++)try{if(r=n._handlers[i](!1))break}catch(e){o.default.log(e)}if(r){n._isDialogOpen=!0;this._hashNavDialogCallback(r).then(function(){n._isDialogOpen=!1;n._allowNavs=!0;n._blockNavsAgainId||(n._blockNavsAgainId=n._async.setImmediate(function(){n._allowNavs=!1;n._blockNavsAgainId=null}));e&&e()},function(){n._isDialogOpen=!1;t&&t()})}}return!r&&!n._isDialogOpen};n.prototype.registerHandler=function(e){this._localHandlers.push(e);n.registerHandler(e)};n.prototype.unRegisterHandler=function(e){for(var t=0;t<this._localHandlers.length;t++)if(this._localHandlers[t]===e){this._localHandlers.splice(t,1);break}n.unRegisterHandler(e)};n.prototype.dispose=function(){for(var e=0,t=this._localHandlers;e<t.length;e++){var r=t[e];n.unRegisterHandler(r)}};n._handlers=[];n._async=new r.default;n._initialized=!1;return n}();(t.default=i).init()});define("jB",["require","exports","fX","aN"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,i,n){this._endpointUrl=e.callbackEndpoint.authority+e.callbackEndpoint.path;var o={};if(n)for(var a=0;a<n.length;++a)o[n[a].EventType]=o[n[a].EventType]+1||1;var s={TelemetryTenantId:e.telemetryTenantToken.substring(0,32),AppVersion:e.appVersion,EventType:t,StatusCode:r,EventCount:n?n.length:0,Timestamp:i,Environment:e.environment||"",DatapointSchemaVersion:"1.0",TelemetrySource:"Aria",EventSummary:o,Workload:e.workload||"",FarmLabel:e.farmLabel||""};this._dataCompletenessJson=JSON.stringify(s)}Object.defineProperty(e.prototype,"endpointUrl",{get:function(){return this._endpointUrl},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"dataCompletenessJson",{get:function(){return this._dataCompletenessJson},enumerable:!0,configurable:!0});e.prototype.send=function(){new r.default({method:"POST",url:this._endpointUrl,json:this._dataCompletenessJson,requestTimeoutInMS:1e3}).start(function(e,t){},function(e,t,r){0})};return e}();t.DataCompletenessInfo=n});define("fX",["require","exports","bS","aN","aL"],function(e,t,v,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function y(e){this._async=new v.default(this);var t=e.url,r=e.requestTimeoutInMS,i=void 0===r?y.DEFAULT_TIMEOUT_MS:r,n=e.json,o=e.responseType,a=void 0===o?"":o,s=e.headers,u=void 0===s?{}:s,l=e.withCredentials,c=void 0!==l&&l,d=e.needsCors,p=void 0!==d&&d,f=e.onProgress,h=e.onUploadProgress,m=e.method,g=void 0===m?n?"POST":"GET":m;this._url=t;this._requestTimeoutInMS=i;this._postData=n;this._headers=u;this._method=g;this._withCredentials=c;this._needsCors=p;this._responseType=a;this._progressCallback=f;this._uploadProgressCallback=h}y.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,-3,!1)};y.prototype.start=function(e,t){var r=this;this._successCallback=e;this._failureCallback=t;var i=this._method,n=this._headers;try{this._request=this._getRequest();var o=this._progressCallback,a=this._uploadProgressCallback,s=this._request,u=this._responseType;o&&(s.onprogress=function(e){try{o(e)}catch(e){c.default.logError(e)}});a&&(s.upload.onprogress=function(e){try{a(e)}catch(e){c.default.logError(e)}});this._async.setTimeout(function(){r._completed||r._timeoutCallback()},this._requestTimeoutInMS);s.onreadystatechange=function(){if(!r._completed){var e=4;try{e=s.DONE||4}catch(e){}s.readyState===e&&r._requestEndCallback()}};s.open(i,this._url,!0);"withCredentials"in s&&(s.withCredentials=this._withCredentials);s.responseType=u;for(var l in n)s.setRequestHeader(l,n[l]);s.send(this._postData)}catch(e){c.default.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:d.safeSerialize(n),method:i});this._abortRequest();this._callFailureCallback(this._request,-1,!1)}};y.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;var t=new XDomainRequest;t.setRequestHeader=function(){};t.onprogress=function(){};t.ontimeout=function(){};t.onload=function(){e._requestEndCallback()};return t};y.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0;this._async.dispose();try{this._request&&this._request.abort()}catch(e){}e=!0}return e};y.prototype._timeoutCallback=function(){if(!this._completed){this._abortRequest();this._callFailureCallback(this._request,-2,!0)}};y.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t)}catch(e){c.default.log(e)}};y.prototype._callFailureCallback=function(e,t,r){try{this._failureCallback&&this._failureCallback(e,t,r)}catch(e){c.default.log(e)}};y.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var t=-1;try{this._async.dispose();try{t=this._request.status}catch(e){}}catch(e){t=-1;c.default.log(e)}t<400&&0<t?this._callSuccessCallback(this._request,t):this._callFailureCallback(this._request,t,!1)}};y.DEFAULT_TIMEOUT_MS=3e4;return y}();t.default=r});define("jx",["require","exports","ff"],function(e,u,l){"use strict";Object.defineProperty(u,"__esModule",{value:!0});var c=10,a=50;u.MAXERRORS=100;var d=0;function p(e){var t;if(e){var r=e&&e.toString?e.toString():"InvalidMethod()",i=8===r.indexOf(" ")?9:0,n=r.indexOf(")")+1;if(0===(t=r.substring(i,n)).indexOf("function")||t.indexOf("(")<3){var o=n+a;t=function(e,t){e&&e.length>t&&(e=e.substr(0,t-3)+"...");return e}(r=r.replace(/\s\s*/g," "),o)+(o<r.length?"}":"")}}return t}function f(e,t,r,i,n){try{window.parent&&window.parent.opener&&"LogOnError"in window.parent.opener&&Function.prototype.apply.call(window.parent.opener.LogOnError,window.parent.opener,[e,t,r,i,n])}catch(e){}var o=n&&n.stack,a=function e(){var t,r=[];try{t=arguments.callee;for(;t===f||t===e;)t=t?t.caller:t}catch(e){t=null}var i=0;try{for(;t&&i<c;){r.push(p(t));t=t.caller;i++}}catch(e){}return r}().join("\n"),s={message:e,url:t,line:r,col:i,stack:o=o?o.replace(/[ \t]{2,}/g," "):"",builtStack:a=a.replace(/[ \t]{2,}/g," ")};d<u.MAXERRORS?l.UnhandledError.logData(s):d===u.MAXERRORS&&l.UnhandledError.logData({message:"Hit max error limit of "+u.MAXERRORS,url:"NA",line:0,col:0,stack:"",builtStack:""});d++}u.handleOnError=f;window.onerror=f});define("ff",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UnhandledError=r.createSingleEvent({eventName:"UnhandledError,",shortEventName:"UnhandledError",critical:!0,requiresParent:!1},{message:1,stack:1,builtStack:1,line:2,col:2,url:1});t.default=t.UnhandledError});define("jw",["require","exports","aN","aq"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.onError=function(e){r.default.log(e)}});define("ju",["require","exports","aN","bS","aC","bT","aL","jv"],function(e,t,o,r,a,i,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=new(function(){function e(){this._outstandingPromiseErrors={};this._async=new r.default}e.prototype.log=function(e){var t=this,r=e.id;if(e.parent)e.handler&&delete this._outstandingPromiseErrors[r];else{this._outstandingPromiseErrors[r]=e;1===Object.keys(this._outstandingPromiseErrors).length&&this._async.setTimeout(function(){var n=t._outstandingPromiseErrors;t._outstandingPromiseErrors={};Object.keys(n).forEach(function(e){var t=n[e],r=t.exception?t.exception:t.error;r instanceof Error||r&&r.stack?a.default.isCanceled(t)||o.default.log(r):u.UnhandledPromise.logData({message:"Promise with no error callback",extraData:s.safeSerialize(r)});if(window.console&&console.log){var i="Promise with no error callback:"+t.id;console.warn?console.warn(i):console.log(i);console.log(t);r&&r.stack&&console.log(r.stack)}})},0)}};return e}());new i.default(n).on(a.default,"error",n.log)});define("jv",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UnhandledPromise=r.createSingleEvent({eventName:"UnhandledPromise,",shortEventName:"UnhandledPromise",samplingFeature:{ODB:!0,ODC:"UnhandledPromiseLogging",Fallback:!1},requiresParent:!1},{message:1,extraData:1});t.default=t.UnhandledPromise});define("js",["require","exports","aU","ff","aT","aS","db","jt","aV"],function(e,t,r,i,n,o,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});0});define("jq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SPOTenantTokens={ppe:"3620e5572cf04917bf4993285ebe4e15-d5c60963-35a1-45e2-9430-928e0656b9cd-6718",prod:"a9e9a63d9df4411ebbf89297947d7666-b5f0498b-a808-4b74-bb7b-2b33f7971660-7417"};t.ODBTenantTokens={ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"}});define("jo",["require","exports","jp","aU","aI","aT","db","ff","cd","aN"],function(e,t,r,i,n,o,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c;!function(e){e[e.AppLoad=0]="AppLoad";e[e.PLT=1]="PLT";e[e.SessionError=2]="SessionError"}(c=t.Stages||(t.Stages={}));var d=!1,p=!1,f=-1;function h(){f===c.SessionError-1&&v.markStage(c.SessionError)}function m(e){if(n.Qos.isTypeOf(e)){if(e.data.resultType===n.ResultTypeEnum.Failure){p=!0;h();d=!0}}else if(o.default.isTypeOf(e)||a.default.isTypeOf(e)||s.default.isTypeOf(e)){p=!0;h();d=!0}else if(u.default.isTypeOf(e)){v.markStage(c.PLT);d&&h()}}for(var g=0,y=i.Manager.addLogHandler(m);g<y.length;g++){m(y[g])}var v=function(){function e(){}e.markStage=function(e){if(e-1===f||e===c.AppLoad){r.default.logData({stage:c[e],errorBeforeStage:d,errorDuringStage:p});p=!1;f=e}else try{throw new Error("Stage "+c[e]+" - "+e+" came out of order - previous stage "+c[f]+" - "+f)}catch(e){l.default.log(e)}};e.reset=function(){f=-1;p=d=!1};return e}();(t.default=v).markStage(c.AppLoad)});define("jp",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Qoe=r.createSingleEvent({eventName:"Qoe,",shortEventName:"Qoe",requiresParent:!1},{stage:{isKey:!0,type:1},errorBeforeStage:3,errorDuringStage:3});t.default=t.Qoe});define("jm",["require","exports","a0"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function t(){}t.registerClicks=function(e){if(e&&!t._appDictionary[e]){t._appDictionary[e]=!0;document&&document.body&&document.body.addEventListener("click",function(e){var t=e.target;if(t){var r=t.getAttribute("data-logging-id");r&&i.Engagement.logData({name:r+".Click"})}},!0)}};t._appDictionary={};return t}();t.EngagementHelpers=r});define("jl",["require","exports","dJ","bA","gl","iE","bb"],function(e,w,T,t,r,i,C){"use strict";Object.defineProperty(w,"__esModule",{value:!0});var n='[\\.\\;\\,\\s-_\\(\\)\\/\\"\\u201c\\xab\\!\\&\\+\\¤\\<\\>\\@\\+\\=]',x=new RegExp(n,"g"),I=new RegExp("^"+n+"+|"+n+"+$|"+n+"+(?="+n+")","g");w.DEFAULT_SELECT_PROPERTIES=["Path","SecondaryFileExtension","FileExtension","ParentLink","Size","Description","CreatedBy","Created","ModifiedBy","LastModifiedTime","IsContainer","Filename","Title","LinkingUrl","SharedWithDetails","ListID","SiteID","WebId","UniqueID","piPageImpression","piPageImpressionBlockType","piSearchResultId",".mediaBaseUrl",".spResourceUrl",".callerStack",".correlationId",".thumbnailUrl",".videoManifestUrl",".pdfConversionUrl"];w.QueryBoxSkyDrive="QueryBoxSkyDrive";w.FullResults="FullResults";w.isOLSQueryEnabledResourceKey=new t.ResourceKey({name:e("module").id+".isOLSQueryEnabled",factory:new t.ConstantResourceFactory(!1)});var o=function(){function e(e,t){void 0===e&&(e={});this._dataRequestor=new t.dataRequestorType({});this._pageContext=t.pageContext;this._isOLSQueryEnabled=t.isOLSQueryEnabled}e.prototype.query=function(e,t){var r=void 0===t?{}:t,i=r.pageSize,n=void 0===i?50:i,o=r.startRow,a=void 0===o?0:o,s=r.qosName,u=r.clientType,l=void 0===u?"OneDriveWeb":u,c=r.clientFunction,d=r.clientFunctionDetails,p=r.searchSessionId,f=r.filterQuery,h=r.selectProperties,m=void 0===h?w.DEFAULT_SELECT_PROPERTIES:h,g=this._pageContext.webAbsoluteUrl.replace("'","''"),y=C.default.isActivated("945C4BDA-4609-4C8C-8346-6B7AD2EF83AD","01/31/2018","Request to remove query expansion by @olas")?'{searchTerms} (path:"'+g+'" OR SharedWithUsersOWSUser:{User.EncodedLoginName}) (ContentTypeId:0x010100* OR ContentTypeId:0x012000*) -ContentClass=STS_List_* -ContentClass=STS_Site -ContentClass=STS_Web -ContentClass=STS_ListItem_544 -ContentClass=STS_ListItem_550':'(({searchTerms}) OR ({searchTerms}*)) (path:"'+g+'" OR SharedWithUsersOWSUser:{User.EncodedLoginName}) (ContentTypeId:0x010100* OR ContentTypeId:0x012000*) -ContentClass=STS_List_* -ContentClass=STS_Site -ContentClass=STS_Web -ContentClass=STS_ListItem_544 -ContentClass=STS_ListItem_550',v=this._isOLSQueryEnabled,_=v?e:function(e){var t;if(e){x.test(e)&&(e=(r=e,r.replace(I,"").split(x)).join(" "));e=e.replace(/\'/g,"''");t=e.lastIndexOf("*")===e.length-1||e.lastIndexOf(" ")===e.length-1?e.replace(/^\s+|\s+$|\s+(?=\s)/g,""):"(("+e+") OR ("+e+"*))"}else t="*";var r;return t}(e);f&&(_+=" AND "+f);var b={clientType:"'"+l+"'",EnableQueryRules:!1,queryTemplate:"'"+y+"'",querytext:"'"+_+"'",rowLimit:n,culture:this._pageContext.currentLanguage,startRow:a,properties:"'"+function(e){var t=[];for(var r in e){var i=e[r];i&&t.push(r+":"+e[r])}return t.join(",")}({ClientFunction:c,ClientFunctionDetails:d})+"'",selectProperties:"'"+m.join(",")+"'"};v&&c===w.FullResults&&(b.useOLSQuery=1);p&&(b.OLSQuerySession="'"+p+"'");var S=this._pageContext.webAbsoluteUrl+"/_api/search/query?"+T.serializeQuery(b);return this._dataRequestor.getData({url:S,method:"GET",qosName:s||"Odb.SearchService.query"}).then(function(e){return e.d.query})};e.prototype.getSearchResultsForUrl=function(e,t){e=this._pageContext.webAbsoluteUrl+e;return this._dataRequestor.getData({url:e,method:"GET",qosName:t}).then(function(e){return e.d.query})};e.prototype.getSearchInstrumentationUrl=function(e){var t,r=e.itemFromServer.piSearchResultId,i=e.pageImpression,n=e.pageImpressionBlockType,o=e.index;if(r){var a={pageInfo:"'"+i+"'",clickType:"'0'",subResultIndex:o,clickedResultId:"'"+r+"'",blockType:n};t=this._pageContext.webAbsoluteUrl+"/_api/search/recordpageclick?"+T.serializeQuery(a)}return t};e.dependencies={dataRequestorType:r.typeResourceKey,pageContext:i.pageContext,isOLSQueryEnabled:w.isOLSQueryEnabledResourceKey};return e}();w.default=o;w.resourceKey=t.createResolvedResourceKey(e("module").id,o)});define("gl",["require","exports","eg","iE","bA"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataRequestor=r.default;t.typeResourceKey=n.createResolvedTypeResourceKey(e("module").id,r.default,{pageContext:i.pageContext});t.default=r.default});define("eg",["require","exports","ap","aC","bS","eo","aI","cb","el","eh","bf"],function(e,t,R,F,r,A,O,L,M,N,q){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function c(e,t){this._pageContext=t?t.pageContext:e.pageContext;this._qosName=e.qosName;this._async=new r.default(this)}c.parseJSON=function(e){return e&&JSON.parse(e)||void 0};c.prototype.getData=function(e){var h=this,m=e.url,t=e.parseResponse,g=void 0===t?c.parseJSON:t,y=e.qosName,v=e.qosHandler,d=e.customQosLogger,r=e.additionalPostData,_=void 0===r?"":r,b=e.additionalHeaders,S=e.contentType,i=e.method,w=void 0===i?"POST":i,n=e.maxRetries,T=void 0===n?0:n,o=e.crossSiteCollectionCall,p=void 0!==o&&o,a=e.noRedirect,C=void 0!==a&&a,s=e.needsRequestDigest,x=void 0===s||s,I=e.responseType,P=e.onUploadProgress,E=e.timeout,u=e.authToken,l=e.noTimeoutInLastRetry,D=void 0!==l&&l;T=Math.max(T,0);var k=0,U=this._pageContext;return F.default.resolve(u||U&&(U.getAuthToken&&U.getAuthToken()||U.authToken)).then(function(r){if(r){var e="Bearer "+r;if(b){var t=!1;for(var i in b)i&&"authorization"===i.toLowerCase()&&(t=!0);t||(b.Authorization=e)}else b={Authorization:e};x=!1;C=p=!0}var l=new N.default(R.__assign({},U?{webServerRelativeUrl:U.webServerRelativeUrl,webAbsoluteUrl:p?U.webAbsoluteUrl:void 0,formDigest:{updateFormDigestPageLoaded:U.updateFormDigestPageLoaded,formDigestValue:U.formDigestValue,formDigestTimeoutSeconds:U.formDigestTimeoutSeconds}}:{},{needsRequestDigest:x})),n=[];h._qosName&&n.push(h._qosName);y&&n.push(y);y=n.join(".");var o,f=function(e){d&&d(e)},a=function(u,d){var e,t,p;e=function(e){var t,r=new O.default({name:y}),i=e.getResponseText(),n=e.getStatus(),o=e.getCorrelationId(),a=!1;try{t=h._isBlobResponse(I,i)?i:g(i);a=!0;var s={resultType:O.ResultTypeEnum.Success,extraData:{CorrelationId:o,HttpStatus:n}};r.end(s);f(s)}catch(e){s={resultType:O.ResultTypeEnum.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:{CorrelationId:o,HttpStatus:n}};r.end(s);f(s);d()}if(a){r=new O.default({name:y+"Complete"});try{u(t);s={resultType:O.ResultTypeEnum.Success,extraData:{CorrelationId:o,HttpStatus:n}};r.end(s);f(s)}catch(e){s={resultType:O.ResultTypeEnum.Failure,error:"object"==typeof e?JSON.stringify(e):e,extraData:{CorrelationId:o,HttpStatus:n}};r.end(s);f(s)}}l=void 0};t=function(e){var a=new O.default({name:y});if(e){var s=e.getCorrelationId(),u=e.getGroupThrottle(),l=e.getStatus(),c=O.ResultTypeEnum.Failure;if(403===l||404===l||429===l){T=0;c=O.ResultTypeEnum.ExpectedFailure}var t=function(e){var t=void 0;if("object"==typeof e&&"number"==typeof e.status)t=e;else if("string"==typeof e){var r=void 0;try{r=JSON.parse(e)}catch(e){}r&&(t=r.error||r["odata.error"]||{responseData:r})}(t=t||{}).status=l;s&&(t.correlationId=s);u&&(t.groupThrottle=u);var i=l.toString();if(v){i=v(t);if(500===l&&("DefaultDoclibNotFound"===i||"PrefetchWebMismatch"===i)){T=0;c=O.ResultTypeEnum.ExpectedFailure}}var n=JSON.stringify(t),o={resultType:c,error:n,resultCode:i,extraData:{CorrelationId:s,HttpStatus:l,GroupThrottle:u}};a.end(o);f(o);if(k<T){++k;p()}else d(t)},r=e.getResponseType();r&&"text"!==r?e.parseError().then(t):t(e.getResponseText())}else{var i=void 0;if(o)i={resultType:O.ResultTypeEnum.ExpectedFailure,resultCode:"RequestAborted"};else{i={resultType:O.ResultTypeEnum.ExpectedFailure,resultCode:"Unknown"};d({status:0,code:""})}a.end(i);f(i)}};(p=function(){l.getServerDataFromUrl({url:m,successCallback:e,failureCallback:t,uploadProgressCallback:P,additionalPostData:_,method:w,additionalHeaders:b,contentType:S,withCredentials:!r&&void 0,noRedirect:C,responseType:I,needsRequestDigest:x})})()},s=function(){o=!0;if(l){l.abort();T<=k&&l.dispose()}},u=M.default.getRUMOneLogger(),c=Date.now();u&&(Boolean(u.readTempData("appDataFetchStart"))||u.saveTempData("appDataFetchStart",c));return L.default.instrumentPromise({url:m,name:y+".Promise"},function(){var e=function(){var e=new F.default(a,s);return E&&(!D||k<T)?F.default.timeout(E,e):e};return(k<T?A.default({retries:T,callback:e,canRetry:function(e){return!0},async:h._async,delay:0,adjustRetries:function(e){return T-k},beforeRetry:function(){k++}}):e()).then(function(e){l&&l.dispose();return e},function(e){l&&l.dispose();return F.default.reject(e)})},void 0,function(e){return e instanceof Error&&F.default.isCanceled(e)?{error:e.message,resultCode:"Canceled",resultType:O.ResultTypeEnum.ExpectedFailure}:e&&403===e.status?{error:JSON.stringify(e),resultCode:"AccessDenied",resultType:O.ResultTypeEnum.ExpectedFailure}:R.__assign({},(t=e,q.Killswitch.isActivated("78C04DFD-1688-4679-A984-ED60A4341F51","4/10/2018","Include error data in QoS failures.")?{resultCode:"",error:""+t}:t instanceof Error?{resultCode:"",error:t.toString()}:(r=t)&&"object"==typeof r&&"code"in r?{resultCode:"string"==typeof t.code?t.code:""+t.status,error:JSON.stringify(t)}:{error:t,resultCode:""}),{resultType:O.ResultTypeEnum.Failure});var t,r})})};c.prototype._isBlobResponse=function(e,t){return"blob"===e&&t&&"object"==typeof t};return c}();t.DataRequestor=i;t.default=i});define("eo",["require","exports","bE"],function(e,t,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t,r=e.adjustRetries,i=e.async,n=e.beforeRetry,o=e.callback,a=e.canRetry,s=void 0===a?function(){return!0}:a,u=e.delay,l=e.resetAttemptsOnRestart,c=e.retries,d=e.shouldRestart,p=0,f=new y.default(function(){t.cancel()});function h(e){if(d&&d()){l&&(p=0);g()}else f.complete(e)}function m(e){r&&(c=r(e));if(p<c&&s(e)){p++;n&&n();"number"==typeof u&&i?i.setTimeout(g,u):g()}else f.error(e)}function g(){(t=o()).then(h,m)}g();return f.getPromise()}});define("el",["require","exports","bS","en","em","bz","ca"],function(e,t,r,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u;!function(e){e[e.Incomplete=1]="Incomplete";e[e.ReadyToUpload=2]="ReadyToUpload";e[e.Uploaded=3]="Uploaded";e[e.TimeOut=4]="TimeOut";e[e.Skipped=5]="Skipped"}(u||(u={}));var n=function(e,t,r,i,n,o,a){this.url=e;this.duration=t;this.correlationId=r;this.status=i;this.startTime=n;this.endTime=o;this.name=a};t.APICallPerformanceData=n;var l=["EUPL","ScenarioId"],c=function(e,t,r,i,n,o,a){this.controlId=e;this.startTime=t;this.endTime=r;this.renderTimeCalculator=i;this.renderTimeRequiredDataChecker=n;this.ignoreForEUPL=void 0===o||o;this.needFlatten=void 0!==a&&a};t.ControlPerformanceData=c;function d(e){return null==e}var f=window.performance,p=function(){function n(e){this._keyMetrics=l;this.async=new r.default(this);this.dataStartTime=Number((new Date).getTime());this._rumoneData={};this.dataState=u.Incomplete;this.controls=[];this.apis=[];this.euplBreakDown={};this.serverMetrics={};this.isW3cTimingCollected=!1;this.isW3cResourceTimingCollected=!1;this.tempData={};this._emergencyUpdateFunc=this._emergencyUpload.bind(this);this.loggingFunc=e;this.setPerfDataTimer();this._platformDetection=new a.default;this._hookUnloadEvent()}n.getRUMOneLogger=function(e){var t=e||function(e,t){o.RUMOneDataUpload.logData({streamName:e,dictionary:t})};if(!n.rumOneLogger)try{n.rumOneLogger=new n(t)}catch(e){n.rumOneLogger=null}return n.rumOneLogger};Object.defineProperty(n,"KeyMetrics",{get:function(){return this.rumOneLogger._keyMetrics},enumerable:!0,configurable:!0});n.prototype.getPerformanceData=function(){return this._rumoneData};n.prototype.resetLogger=function(){this._emergencyUpload();this.dataStartTime=(new Date).getTime();this.dataState=u.Incomplete;this.isW3cTimingCollected=!1;this.isW3cResourceTimingCollected=!1;this.controls=[];this.apis=[];this.tempData={};this._rumoneData={};this._excludePageData=!1;this._waitOnAddingExpectedControl=!1;this._keyMetrics=l;this.clearPerfDataTimer();this.setPerfDataTimer();this.euplBreakDown={};this.serverMetrics={};this.clearResourceTimings();s.clearMarks();this._unhookUnloadEvent();this._hookUnloadEvent();this.logMessageInConsole("Reset performance Logger Done")};n.prototype.excludePageForPerfData=function(){this._excludePageData=!0};n.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e]};n.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this.controls.filter(function(e){return e.controlId===t.controlId})[0].ignoreForEUPL=t.ignoreForEUPL:this.controls.push(t)};n.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return 0<this.controls.filter(function(e){return e.controlId===t.controlId}).length};n.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e};n.prototype.writeServerUrl=function(e){this._rumoneData.ServerUrl||(this._rumoneData.ServerUrl=e||window.location.href)};n.prototype.writeServerSideLatency=function(e,t){if(!this.isCollected("ServerRequestDuration")){this._rumoneData.ServerRequestDuration=e;this._rumoneData.IISLatency=t}};n.prototype.writeControlPerformanceData=function(t){if(t){var e=this.controls.filter(function(e){return e.controlId===t.controlId})[0];if(e)e.data||(e.data=t);else{var r={controlId:t.controlId,data:t,ignoreForEUPL:t.ignoreForEUPL};this.controls.push(r)}}};n.prototype.writeAPICallPerformanceData=function(e){e&&this.apis.push(e)};n.prototype.readAPICallPerformanceData=function(){return this.apis};n.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e)};n.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==i.default.fullPageLoad&&e!==i.default.none&&e!==i.default.onePageAppNavigation||(this._rumoneData.PageTransitionType=e)};n.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e)};n.prototype.collectW3CPerfTimings=function(){if(!this.isW3cTimingCollected){var e=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"],t=f&&f.timing;if(t){for(var r=0;r<e.length;r++){var i=t[e[r]];i&&this._logRUMOneData(this.getW3cTimingName(e[r]),Number(i))}this.isW3cTimingCollected=!0}}};n.prototype.collectW3cResourceTimings=function(){if(!this.isW3cResourceTimingCollected&&f&&f.getEntriesByType){for(var e=f.getEntriesByType("resource"),t=document.getElementsByTagName("iframe"),r=0;r<t.length;r++){var i=null;try{i=t[r].contentWindow.performance}catch(e){}i&&i.getEntriesByType&&e.concat(i.getEntriesByType("resource"))}var n={SharePoint:function(e){return/\.sharepoint\.com|\.spoppe\.com/i.test(e.name)},CDN:function(e){return/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net/i.test(e.name)},ThirdParty:function(e){return!n.SharePoint(e)&&!n.CDN(e)}},o={ASPX:function(e){return/\.aspx/i.test(e.name)},JS:function(e){return/script/i.test(e.initiatorType)},CSS:function(e){return/link|css/i.test(e.initiatorType)},IMG:function(e){return/img/i.test(e.initiatorType)}},a=Object.keys(n);for(r=0;r<a.length;r++){var s=a[r],u=this.categorizeResourceRequests(e,{from:n[s],requestType:null});this._logRUMOneData(s+"RequestCountTotal",u.length);for(var l=Object.keys(o),c=0;c<l.length;c++){var d=l[c];this._logRUMOneData(s+"RequestCount"+d,this.categorizeResourceRequests(u,{from:null,requestType:o[d]}).length)}if(0<u.length){this._logRUMOneData(s+"RequestDownloadTime",Math.round(u.reduce(function(e,t){return e+t.duration},0)/u.length));var p=JSON.stringify(u.map(function(e){return{name:e.name.split("/").map(function(e){return e.split("?")[0]}).filter(function(e){return e&&0<e.length}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0}}));this._logRUMOneData(s+"RequestNames",p)}}this.isW3cResourceTimingCollected=!0}};n.prototype.saveTempData=function(e,t){this.tempData[e]=t};n.prototype.readTempData=function(e){return this.tempData[e]};n.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e)};n.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e)};n.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e)};n.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e)};n.prototype.isRunning=function(){return!(this.dataState===u.Uploaded||this.dataState===u.TimeOut||this.dataState===u.Skipped)};n.prototype.writeEUPLBreakdown=function(e,t){if(e)try{var r=JSON.parse(e);for(var i in r)r.hasOwnProperty(i)&&this.addEUPLBreakdown(i,r[i],t)}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString())}};n.prototype.addEUPLBreakdown=function(e,t,r){if(e&&!d(t)){if(d(this.euplBreakDown[e])||r){var i=this._isBreakdownValue(t)?t.data:t;this.euplBreakDown[e]=i}this._isBreakdownValue(t)&&t.needFlatten&&this._logRUMOneData(e,t.data)}};n.prototype.readEUPLBreakdown=function(e){return e?this.euplBreakDown[e]:this.euplBreakDown};n.prototype.addFlights=function(e){if(e&&0<e.length){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),r=0;r<e.length;r++){var i=e[r];i&&-1===t.indexOf(i)&&t.push(i)}this._rumoneData.Flights=JSON.stringify(t)}};n.prototype.addServerMetrics=function(e,t){if(e)for(var r in e)r&&!d(e[r])&&(d(this.serverMetrics[r])||t)&&(this.serverMetrics[r]=e[r])};n.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e};n.prototype.readControlPerformanceData=function(){return this.controls.filter(function(e){return!!e.data}).map(function(e){return e.data})};n.prototype.mark=function(e){s.mark(e)};n.prototype.now=function(){return f&&f.now?Math.round(f.now()):NaN};n.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e};n.prototype.registerErrorHandler=function(e){};n.prototype.getMarkerTime=function(e){return s.getMarkerTime(e)};n.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&this._keyMetrics.indexOf(e)<=-1&&this._keyMetrics.push(e)};Object.defineProperty(n.prototype,"waitOnAddingExpectedControl",{set:function(e){this._waitOnAddingExpectedControl=e},enumerable:!0,configurable:!0});n.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t)};n.prototype.clearResourceTimings=function(){f&&f.clearResourceTimings&&f.clearResourceTimings()};n.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten};n.prototype.collectMarks=function(){var r={},i=0;s.getAllMarks().forEach(function(e){if(i<n.MAX_MARKS){var t=e.name.substr(s.MARKER_PREFIX.length)+".mark"+i++;r[t]=Math.round(e.startTime)}});this.writeEUPLBreakdown(JSON.stringify(r))};n.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e)};Object.defineProperty(n.prototype,"isRUMOneDebuggingEnabled",{get:function(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1},enumerable:!0,configurable:!0});n.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var r=e+" : "+JSON.stringify(t);console.log(r)}};n.prototype.isCollected=function(e){return!d(this.getPerformanceDataPropertyValue(e))};n.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e};n.prototype.setPerfDataTimer=function(){this.perfDataTimer=this.async.setTimeout(this.loopForDataCompleteness,n.CHECK_INTERVAL)};n.prototype.clearPerfDataTimer=function(){if(!d(this.perfDataTimer)){this.async.clearTimeout(this.perfDataTimer);this.perfDataTimer=null}};n.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)};n.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)};n.prototype.categorizeResourceRequests=function(e,t){for(var r=[],i=0;i<e.length;i++){var n=e[i];t.from&&!t.from(n)||t.requestType&&!t.requestType(n)||r.push(n)}return r};n.prototype.collectSupplementaryData=function(){this.setAPIDataToRUMOne();this.collectMarks();this.writeServerUrl(null);this.setBrowseInfo();this.setReferrer();this._rumoneData.ServerMetrics=JSON.stringify(this.serverMetrics);this._rumoneData.EUPLBreakdown=JSON.stringify(this.euplBreakDown)};n.prototype.loopForDataCompleteness=function(){this.clearPerfDataTimer();if(!this._waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled){this.logObjectForDebugging("RUMONE: ",this._rumoneData);this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this.dataState)));this.logObjectForDebugging("Controls: ",this.controls);this.logObjectForDebugging("API Performance Data: ",this.apis);this.logObjectForDebugging("Temp Data: ",this.tempData);this.logObjectForDebugging("EUPLBreakdown: ",this.euplBreakDown);this.logObjectForDebugging("ServerMetrics: ",this.serverMetrics);this.logMessageInConsole("====================================================================")}if(!this.isRunning())return;this._updateState();if(this.dataState===u.ReadyToUpload){this.finishPerfDataUpload();return}this.processControlRenderTime();if(this.readyToComputeEUPL()){this.setEUPL();this._updateState()}}this._checkTimeout();this.isRunning()&&this.setPerfDataTimer()};n.prototype._checkTimeout=function(){if(this.isRunning()&&this.dataState!==u.ReadyToUpload&&!(Number((new Date).getTime())-Number(this.dataStartTime)<=n.ERROR_TIMEOUT)){this.dataState=u.TimeOut;var e={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(e);this.finishPerfDataUpload()}};n.prototype._updateState=function(){this.dataState=0===this._getMissedKeyMetrics().length&&0===this._getMissedControls().length?u.ReadyToUpload:u.Incomplete};n.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this._keyMetrics.length;t++){d(this.getPerformanceDataPropertyValue(this._keyMetrics[t]))&&e.push(this._keyMetrics[t])}return e};n.prototype._getMissedControls=function(){return this.controls.filter(function(e){return!e.data||!e.data.renderTime})};n.prototype._emergencyUpload=function(){this.isRunning()&&0===this._getMissedKeyMetrics().length&&this.finishPerfDataUpload(!0)};n.prototype.finishPerfDataUpload=function(e){this.writeControlDataToRUMOne();this.collectSupplementaryData();try{this.uploadPerfData(e);if(this.isRUMOneDebuggingEnabled){this.logMessageInConsole("Final Data uploaded");this.logObjectForDebugging("RUMONE: ",this._rumoneData);this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this.dataState))}}catch(e){t="PerformanceLogger error writing RUMOne data: "+e,"undefined"!=typeof console&&Boolean(console)&&console.error(t)}finally{this._unhookUnloadEvent()}var t};n.prototype.getReadableDataState=function(e){for(var t in u)if(e===Number(u[t]))return t;return"NaN"};n.prototype.writeControlDataToRUMOne=function(){if(this.controls&&this.controls.length){var e=this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL});e.sort(function(e,t){return t.data.renderTime-e.data.renderTime});for(var t=0;t<10&&t<e.length;t++){this._logRUMOneData("Control"+(t+1)+"Id",e[t].controlId);this._logRUMOneData("Control"+(t+1)+"RenderTime",e[t].data.renderTime)}var r={};this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL}).forEach(function(e){r[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten}});0<Object.keys(r).length&&this.writeEUPLBreakdown(JSON.stringify(r),!0)}};n.prototype.processControlRenderTime=function(){for(var e=0,t=this.controls;e<t.length;e++){var r=t[e];r.data&&!r.data.renderTime&&r.data.renderTimeRequiredDataChecker(this,r.data)&&(r.data.renderTime=r.data.renderTimeCalculator(this,r.data))}};n.prototype.readyToComputeEUPL=function(){for(var e=this.controls.filter(function(e){return!e.ignoreForEUPL}),t=0<e.length,r=0,i=e;r<i.length;r++){var n=i[r];if(!n.data||!n.data.renderTime){t=!1;break}}return t};n.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,r=this.controls;t<r.length;t++){var i=r[t];!i.ignoreForEUPL&&i.data&&i.data.renderTime&&e<i.data.renderTime&&(e=i.data.renderTime)}this._rumoneData.EUPL=e;"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e)}};n.prototype.setBrowseInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor;this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile};n.prototype.setAPIDataToRUMOne=function(){for(var e=0,t=0,r=0;r<this.apis.length;r++){var i=this.apis[r];if(i){e++;t+=i.duration;i.url=i.url.split("/").map(function(e){return e.split("?")[0]}).slice(-1)[0].replace(/\(.*?\)/g,"()")}}this._rumoneData.APICallCount=e;this._rumoneData.APICallDurationSum=t;this._rumoneData.APICalls=JSON.stringify(this.apis)};n.prototype.setReferrer=function(){this._rumoneData.Referrer=document.referrer};n.prototype.getW3cTimingName=function(e){return"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart"};n.prototype.uploadPerfData=function(e){if(this._excludePageData){this.dataState=u.Skipped;this.logMessageInConsole("Uploading perf data skipped as requested by the consumer")}else if(e||this.dataState===u.ReadyToUpload||this.dataState===u.TimeOut)if(this.loggingFunc)if(this._rumoneData){this.loggingFunc("RUMOne",this.getPerformanceData());this.dataState=u.Uploaded}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error("Error: Uploading perf data called with wrong data state "+this.dataState)};n.rumOneLogger=void 0;n.CHECK_INTERVAL=100;n.ERROR_TIMEOUT=3e4;n.MAX_MARKS=100;return n}();t.default=p});define("en",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.none=0]="none";e[e.fullPageLoad=4]="fullPageLoad";e[e.onePageAppNavigation=5]="onePageAppNavigation"}(r||(r={}));t.default=r});define("em",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RUMOneDataUpload=r.createSingleEvent({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:1,dictionary:4});t.default=t.RUMOneDataUpload});define("eh",["require","exports","ek","aM","ej","bD","ei","el","bT","aC"],function(e,t,m,g,y,r,v,_,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function h(e){void 0===e&&(e={});this._scope=new r.default;this._events=this._scope.attach(new i.default(this));var t=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||t&&new y.default(t).getPath();"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl="");if(t){this._webAbsoluteUrl=t;this._alwaysGetDigest=!0}else this._alwaysGetDigest=!1;this._needsRequestDigest=!1!==e.needsRequestDigest;this._needsRequestDigest&&this._tryLoadDigest(e.formDigest);this._requestCanaryForAuth=!1}h._isXhrAborted=function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!0;if(e.isCancelled)return!0}catch(e){return!0}return!1};h._isValidFormDigest=function(e){return e&&e.updateFormDigestPageLoaded&&Date.now()-e.updateFormDigestPageLoaded.getTime()<1e3*e.formDigestTimeoutSeconds};h.prototype.dispose=function(){this._scope.dispose()};h.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0;e.abort();this._currentRequest=void 0}};h.prototype.isRequestActive=function(){return!!this._currentRequest};h.prototype.getServerDataFromUrl=function(e){var t=this,r=e.url,i=e.successCallback,n=e.failureCallback,o=e.uploadProgressCallback,a=e.additionalPostData,s=e.isRest,u=void 0===s||s,l=e.method,c=void 0===l?"POST":l,d=e.withCredentials,p=e.additionalHeaders,f=e.contentType,h=e.noRedirect,m=e.responseType,g=e.needsRequestDigest,y=void 0===g?this._needsRequestDigest:g,v=(new Date).toISOString(),_=new XMLHttpRequest;_.open(c,r,!0);"boolean"==typeof d&&(_.withCredentials=d);m&&(_.responseType=m);f?_.setRequestHeader("Content-Type",f):u?_.setRequestHeader("Content-Type","application/json;odata=verbose"):_.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var b=!1;if(p)for(var S in p)if(S){_.setRequestHeader(S,p[S]);"accept"===S.toLowerCase()&&(b=!0)}b||_.setRequestHeader("accept","application/json;odata=verbose");this._currentRequest=_;var w=function(e){y&&e&&_.setRequestHeader("x-requestdigest",e);t._events.on(_,"readystatechange",function(){t._onReadyStateChange(_,r,i,n,h,v)});o&&_.upload&&t._events.on(_.upload,"progress",function(e){o(e)});_.send(a)};y?this._ensureRequestDigest(w,n):w()};h.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)};h.prototype._ensureRequestDigest=function(e,t){var r=h._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&h._isValidFormDigest(r)?e(r.formDigestValue):this._ensureRequestDigestWorker(e,t)};h.prototype._ensureRequestDigestWorker=function(r,n){var o=this,e=new h({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});r||(e._requestCanaryForAuth=!0);var a=this._webAbsoluteUrl||this._webServerRelativeUrl;if("string"==typeof a){h._requestDigestPromise||(h._requestDigestPromise=new s.default(function(i,t){e.getServerDataFromUrl({url:y.default.concatenate(a,"/_api/contextinfo"),successCallback:function(e){var t=e.getResponseText(),r=JSON.parse(t).d.GetContextWebInformation;h._formDigests[o._webServerRelativeUrl]={formDigestValue:r.FormDigestValue,formDigestTimeoutSeconds:r.FormDigestTimeoutSeconds-h.INTERVAL_ADJUST,updateFormDigestPageLoaded:new Date};i(h._formDigests[o._webServerRelativeUrl].formDigestValue);h._requestDigestPromise=void 0},failureCallback:function(e){r?r(void 0):n&&n(e);t(void 0);h._requestDigestPromise=void 0},method:"POST",noRedirect:!!n})}));h._requestDigestPromise.then(function(e){r&&r(e);return e})}else n&&n(void 0)};h.prototype._onReadyStateChange=function(e,t,r,i,n,o){if(4===e.readyState){this._currentRequest=void 0;this._events.off(e);e.upload&&this._events.off(e.upload);if(h._isXhrAborted(e))i();else{var a=new m.default(e,t),s=a.getStatus(),u=_.default.getRUMOneLogger(),l=Date.now();if(u){var c=new v.default(t,Number(e.getResponseHeader("SPClientServiceRequestDuration")),e.getResponseHeader("SPRequestGuid"),s,o,(new Date).toISOString());u.writeAPICallPerformanceData(c);u.saveTempData("appDataFetchEnd",l)}var d=!n&&this._shouldRedirectToErrorCustomPromptLocation(e);if(this._requestCanaryForAuth){this._requestCanaryForAuth=!1;if(403===s){try{d?this._redirectToErrorCustomPromptLocation(e):i(a)}catch(e){}if(!n){if(p=a.getAuthenticationRedirect()){(f=new y.default(p)).setQueryParameter("ReturnUrl",g.default.encodeURIComponent(window.location.href));window.location.href=f.toString()}}}else{try{i(a)}catch(e){}if(!n){var p;if(p=(this._webAbsoluteUrl||this._webServerRelativeUrl)+"/_layouts/15/AccessDenied.aspx"){var f;(f=new y.default(p)).setQueryParameter("Source",g.default.encodeURIComponent(window.location.href));f.setQueryParameter("Type","list");f.setQueryParameter("correlation",g.default.encodeURIComponent(a.getCorrelationId()));window.location.href=f.toString()}}}return}if(200===s||201===s||204===s){r(a);return}if(403===s){h._requestDigestPromise=void 0;n?this._ensureRequestDigestWorker(void 0,function(){return i(a)}):d?this._redirectToErrorCustomPromptLocation(e):this._ensureRequestDigestWorker(void 0);return}401===s&&d&&this._redirectToErrorCustomPromptLocation(e);i(a)}}};h.prototype._tryLoadDigest=function(e){var t=h._formDigests[this._webServerRelativeUrl];h._isValidFormDigest(e)&&(!h._isValidFormDigest(t)||t.updateFormDigestPageLoaded.getTime()<e.updateFormDigestPageLoaded.getTime())&&(h._formDigests[this._webServerRelativeUrl]=e)};h.prototype._shouldRedirectToErrorCustomPromptLocation=function(e){var t=e.getResponseHeader("X-SPO-ErrorCode"),r=e.getResponseHeader("sharepointerror");return"9.3"===t||"-2130575129"===r};h.prototype._redirectToErrorCustomPromptLocation=function(e){var t=new y.default(e.getResponseHeader("X-SPO-ErrorCustomPromptLocation"));t.setQueryParameter("ReturnUrl",window.location.href);window.location.href=t.toString()};h.INTERVAL_ADJUST=10;h._formDigests={};h._requestDigestPromise=void 0;return h}();t.default=n});define("ek",["require","exports","bE"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function r(e,t){this._request=e;this._url=t}r.prototype.getSourceUrl=function(){return this._url};r.prototype.getCorrelationId=function(){return this._request.getResponseHeader("SPRequestGuid")};r.prototype.getGroupThrottle=function(){return this._request.getResponseHeader("SPGroupThrottle")};r.prototype.getStatus=function(){try{return this._request.status}catch(e){}};r.prototype.getAuthenticationRedirect=function(){return this._request.getResponseHeader("X-Forms_Based_Auth_Required")};r.prototype.getResponseType=function(){return this._request.responseType};r.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText};r.prototype.getErrorResponseText=function(){if("blob"===this._request.responseType){var e={status:this._request.status,statusText:this._request.statusText,infected:void 0};this._request.getResponseHeader("x-virus-infected")&&(e.infected=!0);return e}return this.getResponseText()};r.prototype.parseError=function(){var r=this,i=new o.default;this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?function(e){var t,r=new o.default,i=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result);r.complete(e)}catch(e){r.complete({message:"Unable to parse blob result."})}}},n=function(){r.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",i);t.addEventListener("error",n);t.readAsText(e)}catch(e){n()}return r.getPromise().then(function(e){if(t){t.removeEventListener("load",i);t.removeEventListener("error",n)}return e})}(this._request.response).then(function(e){var t={data:e,status:r.getStatus(),statusText:r._request.statusText,infected:!!r._request.getResponseHeader("x-virus-infected")};i.complete(t)}):i.complete(this._request.response):i.complete(this._request.responseText);return i.getPromise()};r.prototype.getValue=function(e){var t;switch(e){case r.DataValueKeys.SourceURL:t=this.getSourceUrl();break;case r.DataValueKeys.CorrelationId:t=this.getCorrelationId();break;case r.DataValueKeys.Status:t=this.getStatus();break;case r.DataValueKeys.AuthenticationRedirect:t=this.getAuthenticationRedirect();break;case r.DataValueKeys.ResponseText:t=this.getResponseText();break;case r.DataValueKeys.ErrorResponseText:t=this.getErrorResponseText()}return t};r.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"};return r}();t.default=r});define("ej",["require","exports","aL","V"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.scheme=0]="scheme";e[e.authority=1]="authority";e[e.path=2]="path";e[e.query=3]="query"}(n=t.UriPartial||(t.UriPartial={}));var u=/[;\/?:@&=$,]/,l=/[\/?]/;function a(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r.toLowerCase()]=e[r].toLowerCase());return t}var o=function(){function o(e,t){this._scheme="";this._user="";this._host="";this._port="";this._path="";this._pathSegments=[];this._pathEncoded="";this._query={};this._fragment="";if(t){this._queryCaseInsensitive=!!t.queryCaseInsensitive;this._pathCaseInsensitive=!!t.pathCaseInsensitive}this._parseURI(e)}o.concatenate=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r="",i=0;i<e.length;i++){var n=e[i];0<i&&(n=o.ensureNoPrecedingSlash(n));i<e.length-1&&(n=o.ensureTrailingSlash(n));r+=n}return r};o.ensureNoPrecedingSlash=function(e){return"/"===e[0]?e.substr(1):e};o.ensureTrailingSlash=function(e){return"/"!==e[e.length-1]?e+"/":e};o.prototype.getScheme=function(){return this._scheme};o.prototype.setScheme=function(e){this._scheme=e};o.prototype.getAuthority=function(){return this._getAuthority(!1)};o.prototype.setAuthority=function(e){this._parseAuthority(e)};o.prototype.getUser=function(){return this._user};o.prototype.getHost=function(){return this._host};o.prototype.getPort=function(){return this._port};o.prototype.getPath=function(e){var t=this._path;Boolean(e)&&null!==t&&t.lastIndexOf("/")===t.length-1&&(t=t.slice(0,-1));return t};o.prototype.getLeftPart=function(e){var t=this._scheme+"://";e===n.authority&&(t+=this.getAuthority());e===n.path&&(t+=this.getPath());e===n.query&&(t+=this.getQuery());return t};o.prototype.setPath=function(e){e&&"/"!==e[0]&&(e="/"+e);this._parsePath(e)};o.prototype.getPathSegments=function(){return this._pathSegments};o.prototype.getLastPathSegment=function(){var e=this._pathSegments;return e[e.length-1]||""};o.prototype.getQuery=function(e){return this._serializeQuery(e)};o.prototype.setQuery=function(e){this.setQueryFromObject(this._deserializeQuery(e))};o.prototype.getQueryAsObject=function(){return this._query};o.prototype.setQueryFromObject=function(e){this._query={};for(var t in e)e.hasOwnProperty(t)&&this.setQueryParameter(t,e[t])};o.prototype.getQueryParameter=function(e){var t=null,r=this._query;if(this._queryCaseInsensitive){e=e.toLowerCase();for(var i in r)r.hasOwnProperty(i)&&i.toLowerCase()===e&&(t=r[i])}else t=r[e];return t||null};o.prototype.setQueryParameter=function(e,t,r){void 0===r&&(r=!0);var i=this._decodeQueryString(t);(i||r)&&(this._query[this._decodeQueryString(e)]=i)};o.prototype.removeQueryParameter=function(e){delete this._query[this._decodeQueryString(e)]};o.prototype.getFragment=function(){return this._fragment};o.prototype.setFragment=function(e){"#"===e[0]&&(e=e.substring(1));this._fragment=this._decodeQueryString(e)};o.prototype.equals=function(e){return i.equalsCaseInsensitive(this._scheme,e.getScheme())&&this._user===e.getUser()&&i.equalsCaseInsensitive(this._host,e.getHost())&&this._port===e.getPort()&&this._fragment===e.getFragment()&&this._equalsCaseAppropriate(this.getPath(!0),e.getPath(!0),this._pathCaseInsensitive)&&this._equalsCaseAppropriate(this.getQuery(),e.getQuery(),this._queryCaseInsensitive)};o.prototype.equivalent=function(e){return i.equalsCaseInsensitive(this._scheme,e.getScheme())&&i.equalsCaseInsensitive(this._user,e.getUser())&&i.equalsCaseInsensitive(this._host,e.getHost())&&i.equalsCaseInsensitive(this._port,e.getPort())&&i.equalsCaseInsensitive(this.getPath(!0),e.getPath(!0))&&r.deepCompare(a(this.getQueryAsObject()),a(e.getQueryAsObject()))&&i.equalsCaseInsensitive(this._fragment,e.getFragment())};o.prototype.toString=function(e){return this._getStringInternal(!0,e)};o.prototype.getDecodedStringForDisplay=function(){return this._getStringInternal(!1)};o.prototype.getStringWithoutQueryAndFragment=function(){return this._getStringWithoutQueryAndFragmentInternal(!0)};o.prototype._equalsCaseAppropriate=function(e,t,r){return r?i.equalsCaseInsensitive(e,t):e===t};o.prototype._getStringInternal=function(e,t){var r=this._getStringWithoutQueryAndFragmentInternal(e,t),i=this.getQuery(e);i&&(r+="?"+i);this._fragment&&(r+="#"+(e?encodeURIComponent(this._fragment):this._fragment));return r};o.prototype._getStringWithoutQueryAndFragmentInternal=function(e,t){var r="";this._scheme&&(r+=(e?encodeURIComponent(this._scheme):this._scheme)+":");var i=this._getAuthority(e,t);i&&(r+="//"+i);this._pathEncoded&&(r+=e?this._pathEncoded:this._path);return r};o.prototype._deserializeQuery=function(e){var t={};0===e.indexOf("?")&&(e=e.substring(1));for(var r=0,i=e.split(/[;&]+/);r<i.length;r++){var n=i[r],o=n.indexOf("=");o<0&&(o=n.length);0<o&&(t[n.substr(0,o)]=n.substr(o+1))}return t};o.prototype._serializeQuery=function(e){var t="";for(var r in this._query)if(this._query.hasOwnProperty(r)){var i=r,n=this._query[r];if(e){i=encodeURIComponent(i);n=encodeURIComponent(n)}t+=null===n||""===n?i+"=&":i+"="+n+"&"}""!==t&&(t=t.slice(0,-1));return t};o.prototype._parseURI=function(e){var t=e,r=t.indexOf("#");if(0<=r){var i=t.substring(r+1);this.setFragment(i);t=t.substring(0,r)}var n=t.search(u);if(0<=n){if(":"===t[n]){this.setScheme(t.substring(0,n));t=t.substring(n+1)}var o="";if(0===t.indexOf("//")){var a=(t=t.substring(2)).search(l);if(0<=a){o=t.substring(0,a);t=t.substring(a)}else{o=t;t=""}this.setAuthority(o);if(!t){this.setPath("");return}}var s=t.indexOf("?");if(0<=s){this.setQuery(t.substring(s+1));t=t.substring(0,s)}this.setPath(t)}else this.setPath(t)};o.prototype._parseAuthority=function(e){var t=(this._host=e).lastIndexOf("@");0<=t&&(this._host=this._host.substring(t+1));var r=this._host.indexOf(":");if(!(t<0&&r<0)){var i=e;if(t<0)this._host=i;else{this._user=i.substring(0,t);this._host=i.substring(t+1)}if(0<=r){this._port=this._host.substring(r+1);this._host=this._host.substring(0,r)}this._user=decodeURIComponent(this._user);this._host=decodeURIComponent(this._host)}};o.prototype._parsePath=function(e){this._path=decodeURIComponent(e);for(var t=this._pathSegments=[],r=(this._pathEncoded=e).split("/"),i=0;i<r.length;++i)t[i]=decodeURIComponent(r[i]);""===t[0]&&t.shift();""===t[t.length-1]&&t.pop()};o.prototype._getAuthority=function(e,t){void 0===t&&(t={});var r,i,n,o=t&&t.doNotPercentEncodeHost,a="";if(e){r=encodeURIComponent(this._user).replace("%3A",":");i=o?this._host:encodeURIComponent(this._host);n=encodeURIComponent(this._port)}else{r=this._user;i=this._host;n=this._port}""!==r&&(a=r+"@");""!==this._host&&(a+=i);""!==this._port&&(a+=":"+n);return a};o.prototype._decodeQueryString=function(e){var t=e;try{t=decodeURIComponent(e.replace(/\+/g," "))}catch(e){}return t};return o}();t.default=o});define("ei",["require","exports","el"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=r.APICallPerformanceData});define("iE",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pageContext=new r.ResourceKey("pageContext");t.listContext=new r.ResourceKey("listContext");t.listItems=new r.ResourceKey("listItems");t.inplaceEditorUrl=new r.ResourceKey("inplaceEditorUrl");t.inplaceEditorClosing=new r.ResourceKey("inplaceEditorClosing");t.appViewChangeInProgress=new r.ResourceKey("appViewChangeInProgress");t.appViewErrorMessage=new r.ResourceKey("appViewChangeInProgress");t.itemsPerGroup=new r.ResourceKey("itemsPerGroup");t.loggingContext=new r.ResourceKey("loggingContext");t.loggingContextBuckets=new r.ResourceKey("loggingContextBuckets");t.contentTypes=new r.ResourceKey("provider.contentTypes");t.onePageContext=new r.ResourceKey("onePageContext");t.sharingContextInformation=new r.ResourceKey("sharingContextInformation");t.searchBehavior=new r.ResourceKey("searchBehavior")});define("jk",["require","exports","aC","c7","bA"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:r("module").id,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({path:"uP",getModule:function(){return new t.default(function(e,t){r(["uP"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("jj",["require","exports","ap","bN","fZ","fO","gl","bA"],function(e,t,r,n,o,a,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){r.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._dataRequestor=new(r.scope.attached(t.dataRequestorType))({});r._apiUrlHelper=t.apiUrlHelper;r._itemUrlHelper=t.itemUrlHelper;return r}e.prototype.getFolderId=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key),r=this._apiUrlHelper.build().webByItemUrl(t).method("GetFolderByServerRelativeUrl",t.serverRelativeItemUrl);return this._dataRequestor.getData({url:r.toString(),qosName:"GetFolderId"}).then(function(e){return e.d.UniqueId})};e.prototype.getFolderItemId=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key),r=this._apiUrlHelper.build().webByItemUrl(t).method("GetFolderByServerRelativeUrl",t.serverRelativeItemUrl).oDataParameter("$Expand","ListItemAllFields");return this._dataRequestor.getData({url:r.toString(),qosName:"GetFolderItemId"}).then(function(e){return e.d.ListItemAllFields.ID})};e.prototype.getFolderChannelUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key),r=this._apiUrlHelper.build().webByItemUrl(t).oDataParameter("$Expand","Properties").methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:e.id});return this._dataRequestor.getData({url:r.toString(),qosName:"getFolderFromWeb"}).then(function(e){return e.d.Properties.vti_x005f_teamchannelurl})};e.dependencies=r.__assign({},n.default.dependencies,{dataRequestorType:s.typeResourceKey,apiUrlHelper:o.resourceKey,itemUrlHelper:a.resourceKey});return e}(n.default);t.default=u;t.resourceKey=i.createResolvedResourceKey(e("module").id,u)});define("fZ",["require","exports","iE","fO","bj","bA"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedResourceKey(e("module").id,n.ApiUrlHelper,{itemUrlHelper:i.resourceKey,pageContext:r.pageContext});t.default=n.ApiUrlHelper});define("fO",["require","exports","iE","bl","bA"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemUrlHelper=i.ItemUrlHelper;t.SiteRelation=i.SiteRelation;t.resourceKey=n.createResolvedResourceKey(e("module").id,i.ItemUrlHelper,{pageContext:r.pageContext});t.default=i.ItemUrlHelper});define("ji",["require","exports","cY","bA","iE"],function(e,t,o,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._pageContext=t.pageContext}e.prototype.getIdentity=function(){var e=o.IdentityType.aad,t=this._pageContext;!0!==t.isAnonymousGuestUser&&!0!==t.isEmailAuthenticationGuestUser||(e=o.IdentityType.anonymous);var r=this._getUserId(),i=t.userLoginName,n=t.webPermMasks;return{email:t.userEmail,id:r,loginName:i,type:e,sessionState:"",webPermMasks:n}};e.prototype.getSignInUrl=function(){throw new Error("Not Implemented")};e.prototype._getUserId=function(){var e=this._pageContext,t=e&&e.systemUserKey;return t&&t.substring(t.lastIndexOf("|")+1).replace("@live.com","")||""};return e}();t.default=n;t.resourceKey=r.createResolvedResourceKey(""+e("module").id,n,{pageContext:i.pageContext})});define("jg",["require","exports","ap","bN","hs","aZ","aC","jh","ej","aM","bi","il","ig","eT","eS","gA","fZ","fO","gl","iE","bA"],function(e,t,r,n,a,s,u,l,c,d,p,f,h,m,g,y,v,_,b,S,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(o,i);function o(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._shortcutResolverQueue=new l.default;r._pageContext=t.pageContext;r._apiUrlHelper=t.apiUrlHelper;r._itemUrlHelper=t.itemUrlHelper;r._dataRequestor=new(r.scope.attached(t.dataRequestorType))({qosName:"ShortcutLinkDataSource"});return r}o.isSharePointUrl=function(e){var t=new c.default(e).getHost().toLowerCase();return 0<=t.indexOf("spoppe.com")||(0<=t.indexOf("sharepoint.com")||0<=t.indexOf("sharepoint.cn"))};o.prototype.isInternal=function(e,t){if(t&&t!==s.default.Empty&&/@"^[{|\(]?[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}[\)|}]?$/i.test(t))return!0;if(!this._itemUrlHelper.getUrlParts({path:e}).isCrossDomain)return!0;var r=new c.default(e).getHost().toLowerCase(),i=new c.default(this._pageContext.webAbsoluteUrl).getHost().toLowerCase();if(r===i)return!0;var n=void 0,o=/(?:(.+?)(-my)??(\.[^\/]*))|(?:([^\.]*)$)/i.exec(i);if(!o)return!1;if(void 0!==o[2])n=o[1]+o[3];else if(void 0!==o[3])n=o[1]+"-my"+o[3];else if(void 0!==o[4])return!1;return r===n};o.prototype.createShortcut=function(e,t,r){var i=this._itemUrlHelper.getItemUrlParts(e),n=this._apiUrlHelper.build().webByItemUrl(i).method("GetFolderByServerRelativeUrl",i.serverRelativeItemUrl).segment("Files").methodWithAliases("AddUsingPath",{decodedUrl:t,overwrite:!1});return this._dataRequestor.getData({url:n.toString(),parseResponse:function(e){return e},qosName:"CreateShortcut",method:"POST",additionalPostData:this._getCreateShortcutPostBody(r)}).then(void 0,function(e){var t=e.code;return/^\-2130575257,/.test(t)?u.default.wrapError(h.default.ShortcutErrors.NewFileCreationFileAlreadyExistsError):/^\-2130575245,/.test(t)?u.default.wrapError(h.default.ShortcutErrors.InvalidCharacterError):u.default.wrapError(h.default.ShortcutErrors.UnknownError)})};o.prototype.getShortcutTargetData=function(e,t){var i=this,r=this._itemUrlHelper.getUrlParts({path:e}),n=this._apiUrlHelper.build().method("SP.Utilities.ShortcutLink.GetShortcutLink",r.fullItemUrl);return this._dataRequestor.getData({url:n.toString(),qosName:"GetShortcutTargetData",method:"GET",noRedirect:!0}).then(function(e){return{url:e.d.url,siteId:e.d.siteId!==s.default.Empty?e.d.siteId:null,webId:e.d.webId!==s.default.Empty?e.d.webId:null,uniqueId:e.d.uniqueId!==s.default.Empty?e.d.uniqueId:null,isInternal:i.isInternal(e.d.url,e.d.uniqueId),webUrl:void 0}},function(e){return null}).then(function(r){return r.uniqueId||t?u.default.wrap(r):o.isSharePointUrl(r.url)?i.getFileByUrl(r.url).then(function(e){var t=!!e&&e.UniqueId&&s.default.normalizeLower(e.UniqueId);t&&(r.uniqueId=t);return r}):u.default.wrap(r)})};o.prototype.generateShortcutsOpenUrl=function(e,t,r,i,n,o){if(i&&n&&o&&-1===r.toLowerCase().indexOf("guestaccess.aspx")){var a="",s="?";if(r){var u=r.indexOf("?");-1!==u&&(s=r.substring(u)+"&")}a=e+"/"+t+"/ShortcutLink.aspx";a+=s+"siteid="+d.default.encodeURIComponent(i);a+="&webid="+d.default.encodeURIComponent(n);return a+="&uniqueid="+d.default.encodeURIComponent(o)}return r};o.prototype.enqueueParseShortcut=function(o){var a=this,e=this._itemUrlHelper.getItemUrlParts(o);this.trackPromise(this._shortcutResolverQueue.enqueue(function(){var n=new(a.managed(m.default));return a.getShortcutTargetData(e.fullItemUrl,!0).then(function(e){var t,r=a.generateShortcutsOpenUrl(a._pageContext.webAbsoluteUrl,a._pageContext.layoutsUrl,e.url,e.siteId,e.webId,e.uniqueId),i={key:o,shortcutInfo:{shortcutLinkRewritten:!0},urls:(t={},t[y.default.shortcutTarget]=r,t)};e.uniqueId&&(i.thumbnail=f.previewImageUrl(e,a._pageContext.webAbsoluteUrl,a._pageContext));n.update([new g.default(o).succeed({item:i})]);n.flush()}).then(function(){n.dispose()},function(e){n.dispose();return u.default.wrapError(e)})}))};o.prototype.getFileByUrl=function(r){var e,i=this,t=this._itemUrlHelper.getUrlParts({path:r});if(t.isCrossDomain||t.siteRelation===_.SiteRelation.sameSite)e=u.default.wrap(r);else{var n=this._apiUrlHelper.contextInfoUrl(t.fullItemUrl);e=this._dataRequestor.getData({url:n,method:"POST",qosName:"GetContextInfo"}).then(function(e){return e.d.GetContextWebInformation.WebFullUrl})}return e.then(function(e){var t=i._apiUrlHelper.build().webByUrl({path:e,webUrl:e}).method("GetFileByUrl",r);return i._dataRequestor.getData({url:t.toString(),qosName:"GetFileByUrl",method:"GET",noRedirect:!0}).then(function(e){return i._parseGetFileResponse(e,r)})})};o.prototype._getCreateShortcutPostBody=function(e){return"[InternetShortcut]\nURL="+e+"\n"};o.prototype._parseGetFileResponse=function(e,t){return{CheckInComment:e.d.CheckInComment,CheckOutType:parseInt(e.d.CheckOutType,10),ContentTag:e.d.ContentTag,CustomizedPageStatus:e.d.CustomizedPageStatus,ETag:e.d.ETag,Exists:!!e.d.Exists,IrmEnabled:!!e.d.IrmEnabled,Length:parseInt(e.d.Length,10),Level:parseInt(e.d.Level,10),LinkingUrl:e.d.LinkingUrl,MajorVersion:parseInt(e.d.MajorVersion,10),MinorVersion:parseInt(e.d.MinorVersion,10),Name:e.d.Name,ServerRelativeUrl:e.d.ServerRelativeUrl,ServerUrl:new p.default(t).authority,TimeCreated:a.iso8601DateTimeToJsDate(e.d.TimeCreated),TimeLastModified:a.iso8601DateTimeToJsDate(e.d.TimeLastModified),Title:e.d.Title,UIVersion:parseInt(e.d.UIVersion,10),UIVersionLabel:e.d.UIVersionLabel,UniqueId:e.d.UniqueId}};o.dependencies=r.__assign({},n.default.dependencies,{pageContext:S.pageContext,apiUrlHelper:v.resourceKey,itemUrlHelper:_.resourceKey,dataRequestorType:b.typeResourceKey});return o}(n.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});var __assign=this&&this.__assign||Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};define("hs",["require","exports","ht","cL","V"],function(e,t,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r,o,a,s,u,p,f,h,m,i=621355968e5,g=6e4,y=2*g,v=60*g,_=2*v,b=24*v,S=2*b,w=7*b,T=32*b;t.iso8601DateTimeToJsDate=function(e){var t=!1;e.toUpperCase().indexOf("Z")===e.length-1&&(t=!0);var r=e.split(/[^0-9]/);if(!(r.length<6))return t?new Date(Date.UTC(Number(r[0]),Number(r[1])-1,Number(r[2]),Number(r[3]),Number(r[4]),Number(r[5]))):new Date(Number(r[0]),Number(r[1])-1,Number(r[2]),Number(r[3]),Number(r[4]),Number(r[5]))};function C(e,t){void 0===t&&(t=!1);var r=Date.now()-e.getTime();if(r<-5*g)return e.toLocaleDateString(c.default.language);if(r<g)return t?l.strings.RelativeDateTime_LessThanAMinute_StartWithLowerCase:l.strings.RelativeDateTime_LessThanAMinute;if(r<y)return t?l.strings.RelativeDateTime_AboutAMinute_StartWithLowerCase:l.strings.RelativeDateTime_AboutAMinute;if(r<v){var i=Math.floor(r/g);return d.getLocalizedCountValue(l.strings.RelativeDateTime_XMinutes,l.strings.RelativeDateTime_XMinutesIntervals,i).replace("{0}",String(i))}if(r<_)return t?l.strings.RelativeDateTime_AboutAnHour_StartWithLowerCase:l.strings.RelativeDateTime_AboutAnHour;if(r<b){var n=Math.floor(r/v);return d.getLocalizedCountValue(l.strings.RelativeDateTime_XHours,l.strings.RelativeDateTime_XHoursIntervals,n).replace("{0}",String(n))}if(r<S)return t?l.strings.RelativeDateTime_YesterdayAndTime_StartWithLowerCase.replace("{0}",e.toLocaleTimeString(c.default.language)):l.strings.RelativeDateTime_YesterdayAndTime.replace("{0}",e.toLocaleTimeString(c.default.language));if(r<T){var o=Math.floor(r/b);return d.getLocalizedCountValue(l.strings.RelativeDateTime_XDays,l.strings.RelativeDateTime_XDaysIntervals,o).replace("{0}",String(o))}return e.toLocaleDateString(c.default.language)}t.getRelativeDateTimeStringPast=C;t.getFriendlyDateTimeStringPast=function(e,t,r,i){void 0===t&&(t=!1);void 0===r&&(r=!1);void 0===i&&(i=!1);var n=Date.now()-e.getTime(),o=function(e){var t=new Date(e);t.setHours(0,0,0,0);return t}(new Date),a=k(o,-1),s=k(o,-6);if(n<-5*g)return e.toLocaleDateString(c.default.language,R({month:"short",day:"numeric"},i));if(n<y)return r?l.strings.FriendlyDateTime_JustNow_withinSentence:l.strings.FriendlyDateTime_JustNow_asSentence;if(n<v)return U(n,l.strings.FriendlyDateTime_minutesShort,g);if(x(o,e))return U(n,l.strings.FriendlyDateTime_hoursShort,v);if(a<=e)return t?r?l.strings.RelativeDateTime_Yesterday_StartWithLowerCase:l.strings.RelativeDateTime_Yesterday:(r?l.strings.RelativeDateTime_YesterdayAndTime_StartWithLowerCase:l.strings.RelativeDateTime_YesterdayAndTime).replace("{0}",e.toLocaleTimeString(c.default.language,R({hour:"numeric",minute:"2-digit"},i)));if(s<=e){var u=e.toLocaleDateString(c.default.language,R({weekday:"short"},i));return t?u:l.strings.RelativeDateTime_DayAndTime.replace("{0}",u).replace("{1}",e.toLocaleTimeString(c.default.language,R({hour:"numeric",minute:"2-digit"},i)))}return I(o,e)?c.default.language.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(c.default.language,R({month:"long",day:"numeric"},i)):e.toLocaleDateString(c.default.language,R({month:"short",day:"numeric"},i)):e.toLocaleDateString(c.default.language,R({month:"short",day:"numeric",year:"numeric"},i))};t.getRelativeDateTimeStringPastWithHourMinute=function(e){var t=Date.now()-e.getTime(),r=e.toLocaleDateString(c.default.language),i=e.toLocaleTimeString(c.default.language,{hour:"numeric",minute:"2-digit"});return t<b?C(e):t<S?d.format(l.strings.RelativeDateTime_YesterdayAndTime,i):d.format(l.strings.DateTime_DateAndTime,r,i)};function x(e,t){return e.getDate()===t.getDate()&&Math.abs(t.getTime()-e.getTime())<b}t.isSameDay=x;t.isSameMonth=function(e,t){return e.getFullYear()===t.getFullYear()&&t.getMonth()===e.getMonth()};function I(e,t){return e.getFullYear()===t.getFullYear()}t.isSameYear=I;t.isThisWeek=function(e,t){t=t||new Date;var r=new Date(t.getTime()-t.getDay()*b),i=new Date(r.getTime()+w-b);return r.getTime()<=e.getTime()&&e.getTime()<=i.getTime()};t.isLastWeek=function(e,t){t=t||new Date;var r=new Date(t.getTime()-t.getDay()*b-w),i=new Date(r.getTime()+w-b);return r.getTime()<=e.getTime()&&e.getTime()<=i.getTime()};t.getRelativeDateTimeStringForLists=function(e,t){void 0===t&&(t=!1);var r=null,i=null,n=e.split("|");if("0"===n[0])return e.substring(2);var o="1"===n[1],a=n[2],s=4<=n.length?n[3]:null,u=5<=n.length?n[4]:null;switch(a){case"1":r=o?t?l.strings.RelativeDateTime_AFewSecondsFuture_StartWithLowerCase:l.strings.RelativeDateTime_AFewSecondsFuture:t?l.strings.RelativeDateTime_AFewSeconds_StartWithLowerCase:l.strings.RelativeDateTime_AFewSeconds;break;case"2":r=o?t?l.strings.RelativeDateTime_AboutAMinuteFuture_StartWithLowerCase:l.strings.RelativeDateTime_AboutAMinuteFuture:t?l.strings.RelativeDateTime_AboutAMinute_StartWithLowerCase:l.strings.RelativeDateTime_AboutAMinute;break;case"3":i=d.getLocalizedCountValue(o?t?l.strings.RelativeDateTime_XMinutesFuture_StartWithLowerCase:l.strings.RelativeDateTime_XMinutesFuture:l.strings.RelativeDateTime_XMinutes,o?l.strings.RelativeDateTime_XMinutesFutureIntervals:l.strings.RelativeDateTime_XMinutesIntervals,Number(s));break;case"4":r=o?t?l.strings.RelativeDateTime_AboutAnHourFuture_StartWithLowerCase:l.strings.RelativeDateTime_AboutAnHourFuture:t?l.strings.RelativeDateTime_AboutAnHour_StartWithLowerCase:l.strings.RelativeDateTime_AboutAnHour;break;case"5":null==s?r=o?t?l.strings.RelativeDateTime_Tomorrow_StartWithLowerCase:l.strings.RelativeDateTime_Tomorrow:t?l.strings.RelativeDateTime_Yesterday_StartWithLowerCase:l.strings.RelativeDateTime_Yesterday:i=o?t?l.strings.RelativeDateTime_TomorrowAndTime_StartWithLowerCase:l.strings.RelativeDateTime_TomorrowAndTime:t?l.strings.RelativeDateTime_YesterdayAndTime_StartWithLowerCase:l.strings.RelativeDateTime_YesterdayAndTime;break;case"6":i=d.getLocalizedCountValue(o?t?l.strings.RelativeDateTime_XHoursFuture_StartWithLowerCase:l.strings.RelativeDateTime_XHoursFuture:l.strings.RelativeDateTime_XHours,o?l.strings.RelativeDateTime_XHoursFutureIntervals:l.strings.RelativeDateTime_XHoursIntervals,Number(s));break;case"7":null===u?r=s:i=l.strings.RelativeDateTime_DayAndTime;break;case"8":i=d.getLocalizedCountValue(o?l.strings.RelativeDateTime_XDaysFuture:l.strings.RelativeDateTime_XDays,o?l.strings.RelativeDateTime_XDaysFutureIntervals:l.strings.RelativeDateTime_XDaysIntervals,Number(s));break;case"9":r=t?l.strings.RelativeDateTime_Today_StartWithLowerCase:l.strings.RelativeDateTime_Today}if(null!==i){r=i.replace("{0}",s);null!==u&&(r=r.replace("{1}",u))}return r};t.convertDateToISOString=function(e,t){void 0===t&&(t=!1);var r=new Date(e),i=r.getTimezoneOffset()<0,n=r.getFullYear().toString(),o=D((r.getMonth()+1).toString(),2),a=D(r.getDate().toString(),2),s=D(r.getHours().toString(),2),u=D(r.getMinutes().toString(),2),l=D(r.getSeconds().toString(),2),c=(i?"+":"-")+D(i?Math.ceil(r.getTimezoneOffset()/60).toString().replace("-",""):Math.floor(r.getTimezoneOffset()/60).toString(),2)+D((r.getTimezoneOffset()%60).toString().replace("-",""),2);return t?n+"-"+o+"-"+a+"T"+s+":"+u+":"+l+c:n+o+a+"T"+s+u+l+c};t.getLastDayOfMonth=function(e){var t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1,0,0,0,0));t.setUTCMonth(t.getUTCMonth()+1);t.setUTCDate(t.getUTCDate()-1);t.setUTCHours(23,59,59,999);return t};t.getDateFromDotNetTicks=function(e){return e?new Date(e/1e4-i):null};function P(){var t=n(),e=E();if(window.Intl&&window.Intl.DateTimeFormat){var r={},i={hour:"2-digit",minute:"2-digit"};o=new Intl.DateTimeFormat(t,r);a=new Intl.DateTimeFormat(t,i);if(e){r.timeZone="UTC";i.timeZone="UTC"}s=new Intl.DateTimeFormat(t,r);u=new Intl.DateTimeFormat(t,i);p=o.format;f=a.format;h=s.format;m=u.format}else{p=h=function(e){return e.toLocaleDateString(t)};f=m=function(e){return e.toLocaleTimeString(t)}}}t.getShortDisplayDate=function(e,t){if(!e)return"";p||P();var r=x(new Date,e);return(t?r?m:h:r?f:p)(e)};t.getFullDisplayDate=function(e,t,r){p||P();var i=t?h(e):p(e),n=t?m(e):f(e);return d.format(l.strings.DateAndTime,i,n)};n=function(){for(var e,t=0,r=[window.$Config&&window.$Config.mkt,c.default.language,navigator.language,"en"].filter(function(e){return!!e});t<r.length;t++){var i=r[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}n=function(){return e};return e};function E(){if(void 0===r)try{var e=n();(new Date).toLocaleDateString(e,{timeZone:"UTC"});r=!0}catch(e){r=!1}return r}function D(e,t){for(var r=e;r.length<t;)r="0"+r;return r}function k(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function U(e,t,r){var i=Math.round(e/r);return t.replace("{0}",String(i))}function R(e,t){return E()&&t&&e?__assign({},e,{timeZone:"UTC"}):e}});define("jh",["require","exports","bE"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).done(this._promiseComplete,this._promiseComplete)}else{var r={callback:e,signal:null,canceled:!1,result:null};r.signal=new i.default(function(){r.canceled=!0;r.result&&r.result.cancel()});this._queue.push(r);t=r.signal.getPromise()}return t};e.prototype._promiseComplete=function(){var t=this;this._running--;if(this._running<this.concurrency&&this._queue.length){for(var r=this._queue.shift();r&&r.canceled;)r=this._queue.length?this._queue.shift():null;if(r){this._running++;r.result=r.callback();r.result.done(function(e){r.signal.complete(e);t._promiseComplete()},function(e){r.signal.error(e);t._promiseComplete()})}}};return e}();t.default=r});define("il",["require","exports","f0"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.previewImageUrl=function(e,t,r,i){if(r.isSPO){var n=e.SiteId||e.SiteID||e.siteId||r.siteId,o=e.WebId||e.webId||r.webId,a=e.UniqueId||e.UniqueID||e.uniqueId,s=e.Url||e.url||e.Path;return a&&n&&o&&!i?u(n,o,a,t,r):l(s,t,r)}};function u(r,i,n,o,a){if(a.isSPO){var e;n&&(e=s(function(e){var t=e?"":"&resolution=Width1024";return o+"/"+a.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&guidFile="+n+"&guidSite="+r+"&guidWeb="+i+t}));return e}}t.previewImageUrlFromProps=u;function l(r,i,n){if(n.isSPO){var e;r&&(e=s(function(e){var t=e?"":"&resolution=Width1024";return i+"/"+n.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&path="+r+t}));return e}}t.previewImageUrlFromUrl=l;function s(r){return{url:r(!0),width:0,height:0,getAligned:function(e,t){return{url:r(t.name===i.cover.name),width:0,height:0}}}}});define("f0",["require","exports","f1","bV"],function(e,i,u,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o;!function(e){e[e.cover=0]="cover";e[e.center=1]="center";e[e.fit=2]="fit";e[e.fitWidth=3]="fitWidth";e[e.fitHeight=4]="fitHeight";e[e.top=5]="top"}(o=i.AlignmentType||(i.AlignmentType={}));var t=function(e,t){this.name=e;this.getTransform=t};function r(){for(var s=[],e=0;e<arguments.length;e++)s[e]=arguments[e];return new t(s.map(function(e){return e.name}).join("-"),function(e,t){for(var r=u.default.IDENTITY,i=0,n=s;i<n.length;i++){var o=n[i],a={width:e.width*r.scale,height:e.height*r.scale};r=o.getTransform(a,t).multiply(r)}return r})}i.center=new t(o[o.center],function(e,t){var r=new n.default((t.width-e.width)/2,(t.height-e.height)/2);return new u.default(r)});i.top=new t(o[o.top],function(e,t){var r=new n.default((t.width-e.width)/2,0);return new u.default(r)});i.fitWidth=new t(o[o.fitWidth],function(e,t){var r=t.width/e.width;return new u.default(n.default.ORIGIN,Math.min(r,1))});i.fitHeight=new t(o[o.fitHeight],function(e,t){var r=t.height/e.height;return new u.default(n.default.ORIGIN,Math.min(r,1))});i.fit=new t(o[o.fit],function(e,t){var r=e.width/e.height;return(t.width/t.height<r?i.fitWidth:i.fitHeight).getTransform(e,t)});i.cover=new t(o[o.cover],function(e,t){var r=e.width/e.height;return(t.width/t.height<r?i.fitHeight:i.fitWidth).getTransform(e,t)});i.fitCenter=r(i.fit,i.center);i.coverCenter=r(i.cover,i.center);function a(e){var t,r;if("string"==typeof e)t=o[e];else{if("object"==typeof e)return e;t=e}switch(t){case o.top:r=i.top;break;case o.fitHeight:r=i.fitHeight;break;case o.fitWidth:r=i.fitWidth;break;case o.fit:r=i.fitCenter;break;case o.center:r=i.center;break;default:r=i.coverCenter}return r}i.getAlignment=a;i.createAlignment=function(e){var t;t=e instanceof Array?e:[e];return r.apply(void 0,t.map(a))}});define("f1",["require","exports","bV","b7"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function i(e,t){void 0===e&&(e=new n.default);void 0===t&&(t=1);this.translate=e;this.scale=t}i.areEqual=function(e,t,r){void 0===r&&(r=1e-6);return n.default.areEqual(e.translate,t.translate,r)&&Math.abs(Math.log(e.scale/t.scale))<r};i.zoom=function(e,t,r){return new i(e.subtract(t).scale(r-1),r)};i.centerWithinBounds=function(e,t,r){return new i(new o.default(n.default.ORIGIN,e).getCenter().subtract(n.default.getCenter([t,r])))};i.prototype.apply=function(e){return e.scale(this.scale).add(this.translate)};i.prototype.multiply=function(e){return new i(this.translate.add(e.translate.scale(this.scale)),this.scale*e.scale)};i.prototype.invert=function(){return new i(this.translate.scale(-1/this.scale),1/this.scale)};i.IDENTITY=new i;return i}();t.default=r});define("ig",["require","exports","aW"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,n={ODB:563,ODC:null,Fallback:!1};!function(e){e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))};function t(e){return"url"===e||"website"===e}e.isShortcutFileType=t;e.isShortcutEnabled=function(){return r.default.isFeatureEnabled(n)};!function(e){e[e.UnknownError=0]="UnknownError";e[e.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError";e[e.InvalidCharacterError=2]="InvalidCharacterError"}(e.ShortcutErrors||(e.ShortcutErrors={}))}(i||(i={}));t.default=i});define("eT",["require","exports","ap","bN","eS","eV","iJ","eU","eU","bA"],function(e,t,_,r,i,b,a,S,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Task=i.default;t.Graft=n;var s=function(o){_.__extends(e,o);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=o.call(this,e,t)||this,i=t.itemsStore,n=void 0===i?r.resources.consume(a.resourceKey):i;r._itemsStore=n;r._itemUpdatesByKey={};return r}e.prototype.update=function(e,t){void 0===t&&(t=!1);for(var r=0,i=e;r<i.length;r++){var n=i[r];this._processTask(n)}};e.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,r=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,n=r;i<n.length;i++){var o=n[i],a=t[o],s=new b.default(o),u=this._getStoreItem(o);if(u){u.parent;var l=_.__rest(u,["parent"]);S.default(s,l)}S.default(s,{revision:0});for(var c=0,d=a.item;c<d.length;c++){var p=d[c];S.default(s,p)}e[o]=s}for(var f=0,h=r;f<h.length;f++){var m=(s=e[o=h[f]]).parentKey;if(m){var g=e[m]||this._getStoreItem(m)||new b.default(m);e[m]=g;s.parent=g}else delete s.parent}this._pushItemsToStore(e);for(var y=0,v=r;y<v.length;y++){o=v[y];delete(a=t[o]).item}};e.prototype.reset=function(){this._itemUpdatesByKey={}};e.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};e.prototype.getChildren=function(e){var t,r,i,n=e.parentKey,o=e.startIndex,a=e.endIndex,s=[],u=this._itemUpdatesByKey[n];if(u){var l=u.set;if(l)if(l.childrenByIndex){o=void 0===(r=(t={startIndex:o,endIndex:a}).startIndex)?l.startIndex:r,a=void 0===(i=t.endIndex)?l.endIndex:i;for(var c=o;c<a;c++){var d=l.childrenByIndex[c],p=this._getStoreItem(d);s.push(p)}}else if(l.childrenBySibling)for(var f={},h="";h=l.childrenBySibling[h];){if(f[h])throw new Error("Circular reference encountered enumerating the children of '"+n+"'.");f[h]=!0;p=this._getStoreItem(h);s.push(p)}}return s};e.prototype._processTask=function(e){var t=e.key,r=e.output,i=r.item,n=r.set,o=this._itemUpdatesByKey,a=o[t];a||(a=o[t]={});if(i){a.item||(a.item=[]);a.item.push(i)}if(n){var s=o[n.parent.key];s||(s=o[n.parent.key]={});s.set||(s.set={});var u=s.set;if(void 0!==n.index){u.childrenByIndex||(u.childrenByIndex=[]);void 0===u.startIndex?u.startIndex=n.index:u.startIndex=Math.min(u.startIndex,n.index);var l=u.childrenByIndex.length;u.childrenByIndex[n.index]=t;void 0===u.endIndex?u.endIndex=n.index+1:u.endIndex>n.index+1?u.endIndex+=u.childrenByIndex.length-l:u.endIndex=Math.max(u.endIndex,n.index+1)}else if(n.after){u.childrenBySibling||(u.childrenBySibling={});u.childrenBySibling[n.after.key]=t}}};e.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};e.prototype._pushItemsToStore=function(e){var t={};for(var r in e){(o=t[n=e[(u=e[r]).parentKey]&&u.parentKey||""]||(t[n]=[])).push(r)}for(var i=[""];i.length;){var n,o;if(o=t[n=i.shift()]){for(var a=0,s=o;a<s.length;a++){var u;if(!(u=e[r=s[a]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(u,r)}i.push.apply(i,o)}}};e.dependencies=_.__assign({},r.default.dependencies,{itemsStore:a.resourceKey});return e}(r.default);t.ItemTaskObserver=s;t.resourceKey=new o.ResourceKey({name:e("module").id,factory:new o.ResolvedResourceTypeFactory(s)});t.default=s});define("eS",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function i(e,t){if((r=e)&&"object"==typeof r){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}var r}i.prototype.succeed=function(e){var t=new i(this);t.output=e;t.status=1;delete t.error;return t};i.prototype.fail=function(e){var t=new i(this);t.error=e;t.status=2;return t};i.prototype.cancel=function(){var e=new i(this);delete e.error;e.status=3;return e};i.prototype.restart=function(){return new i(this.key,this.input)};i.prototype.changeInput=function(e){var t=e(this.input),r=new i(this.key,t);r.output=this.output;r.status=this.status;r.error=this.error;return r};i.prototype.changeOutput=function(e){var t=e(this.output),r=new i(this.key,this.input);r.output=t;r.status=this.status;r.error=this.error;return r};i.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return i}();t.default=r});define("eV",["require","exports","dH"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=r.default.Files;this.displayType=r.default.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}};t.default=i});define("iJ",["require","exports","ap","eV","a3","bP","bA","dJ","bR","eO","ic","eU"],function(e,t,r,i,n,o,a,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p="result=",f="item=";function h(e){return e&&e.item&&e.item.peek().key}function m(e){e.isExpired=!0;var t=e.content,r=t.peek();r.groupings=null;r.items=[];t.valueHasMutated()}var g=function(t){r.__extends(e,t);function e(){var e=t.call(this,"ItemsStore")||this;e._itemSetsKeys={};e._observables=new o.default({owner:e});return window.odstore=e}e.prototype.dispose=function(){this._observables.dispose()};e.prototype.setItem=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this._handleSetItem.apply(this,[e,f].concat(t))};e.prototype.getItem=function(e){return this.getValue(f+e)};e.prototype.setItemSet=function(e,t){var r=p+e;this.setValue(r,t);this._itemSetsKeys[r]=1};e.prototype.getItemSetFromItemKey=function(e){var t;for(var r in this._itemSetsKeys){var i=(t=this.getValue(r)).content&&t.content.peek(),n=i&&i.items;if(n)for(var o=0,a=n;o<a.length;o++){var s=a[o];if(s&&s.peek().parentKey===e)return t}}};e.prototype.getItemSet=function(e){return this.getValue(p+e)};e.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(p.length));return e};e.prototype.setNextRequestToken=function(e,t,r){var i="token="+t;r?this.setValue(i,r):this.remove(i)};e.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};e.prototype.invalidateItem=function(e){return this._handleItemInvalidation(e,this.getItem(e))};e.prototype.invalidateItemSet=function(e){var t=this.getValue(p+e);t&&m(t)};e.prototype.emptyAllOtherSets=function(e){var t;for(var r in this._itemSetsKeys)(t=this.getValue(r)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&m(t)};e.prototype.invalidateLocation=function(e){var t;for(var r in this._itemSetsKeys){var i=h(t=this.getValue(r));if(i){var n=s.deserializeQuery(i),o=n&&n.locationFilter;o&&0<=o.indexOf(e)&&(t.isExpired=!0)}}};e.prototype.invalidateTag=function(e){var t;for(var r in this._itemSetsKeys){var i=h(t=this.getValue(r));if(i){var n=s.deserializeQuery(i);n&&n.tagFilter===e&&(t.isExpired=!0)}}};e.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var r=(e=this.getValue(t)).item&&e.item.peek();if(r&&r.key&&0<=r.key.indexOf("allmyphotos")){e.isExpired=!0;this._invalidateItem(r)}}};e.prototype._handleItemInvalidation=function(e,t){if(t){var r=t.peek(),i=!1,n=[];if(r){n.push(r);switch(r.type){case c.default.Folder:case c.default.Media:i=!0}}for(var o in this._itemSetsKeys){var a=this.getValue(o),s=a.item&&a.item.peek(),u=s&&s.key;if(u&&(u===e||i&&-1<u.indexOf("allmyphotos"))){u===e?this.setNextRequestToken(e,a.key,""):n.push(s);a.isExpired=!0}}n.forEach(this._invalidateItem,this)}};e.prototype._invalidateItem=function(e){var t=new i.default(e.key);u.default(t,e);u.default(t,{revision:e.revision+1});this.setItem(t)};e.prototype._handleSetItem=function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];for(var n=[],o=0,a=d.removeDuplicates([e.key].concat(r));o<a.length;o++){var s=""+t+a[o],u=this.getValue(s);if(u)u(e);else{(u=this._observables.create(e)).equalityComparer=l.objectStrictEquality;this.setValue(s,u)}n.push(u)}return n[0]};return e}(n.default);t.ItemsStore=g;t.resourceKey=new a.ResourceKey({name:e("module").id,factory:new a.SimpleResourceFactory(g)});t.default=g});define("eO",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.File=0]="File";e[e.Folder=1]="Folder";e[e.Media=2]="Media";e[e.OneNote=3]="OneNote";e[e.Unknown=4]="Unknown";e[e.Error=5]="Error";e[e.App=6]="App";e[e.Subsite=7]="Subsite";e[e.Shortcut=8]="Shortcut"}(r||(r={}));t.default=r});define("ic",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeDuplicates=function(e){var t;t={};for(var r=[],i=0,n=e;i<n.length;i++){var o=n[i],a=""+o;if(!t[a]){t[a]=!0;r.push(o)}}return r}});define("eU",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.remove=function(){return{graftOperationType:3}};t.optional=function(e){return{graftOperationType:2,value:e}};t.backup=function(e){return{graftOperationType:4,value:e}};t.replace=function(e){return{graftOperationType:1,value:e}};t.default=function e(t,r){if(!h(t))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!h(r))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(r===t)return t;for(var i=0,n=Object.keys(r);i<n.length;i++){var o=n[i],a=r[o],s=t[o];if(a!==s){var u=a;if(h(f=u)&&f.graftOperationType)if(1===u.graftOperationType){s=void 0;a=l=u.value}else if(4===u.graftOperationType){var l=u.value;if(void 0!==t[o])continue;a=l}else{if(2!==u.graftOperationType){if(3===u.graftOperationType){delete t[o];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(l=u.value))continue;a=l}var c=void 0;if(a instanceof Date)c=new Date(a.getTime());else if(m(a)){var d=s;m(d)||(d=[]);d.splice.apply(d,[0,d.length].concat(a));c=d}else if(h(a)){var p=s;h(p)||(p={});e(p,a);c=p}else c=a;t[o]=c}}var f;return t};function h(e){return"object"==typeof e&&!!e}function m(e){return Array.isArray(e)}});define("gA",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.download=0]="download";e[e.open=1]="open";e[e.textContent=2]="textContent";e[e.viewInBrowser=3]="viewInBrowser";e[e.bingClickInstrumentation=4]="bingClickInstrumentation";e[e.original=5]="original";e[e.shortcutTarget=6]="shortcutTarget";e[e.video=7]="video";e[e.downloadAsZip=8]="downloadAsZip";e[e.itemUrl=9]="itemUrl"}(r=t.UrlType||(t.UrlType={}));t.default=r});define("jf",["require","exports","aC","c7","bA"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:r("module").id,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({path:"avi",getModule:function(){return new t.default(function(e,t){r(["avi"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("i6",["require","exports","bA","je","jd","jc","jb","ja","i9","i7","iE","cY"],function(e,t,r,n,o,a,s,u,l,c,i,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p,f,h,m=((p={})[a.moveTo.id]=!0,p[a.copyTo.id]=!0,p[s.checkout.id]=!0,p[s.quickEdit.id]=!0,p[a.createShortcut.id]=!0,p[u.openInClient.id]=!0,p[c.sync.id]=!0,p[a.rename.id]=!0,p[l.share.id]=!0,p[s.editItem.id]=!0,p[s.viewItem.id]=!0,p[o.createWorkflow.id]=!0,p[o.baseFlow.id]=!0,p),g=((f={})[s.checkout.id]=!0,f[a.createShortcut.id]=!0,f[c.sync.id]=!0,f[o.createWorkflow.id]=!0,f[o.baseFlow.id]=!0,f[u.openInClient.id]=!0,f[s.versionHistory.id]=!0,f[l.alertItem.id]=!0,f),y=((h={})[a.deleteItem.id]=!0,h),v=function(){function e(e,t){this._pageContext=t.pageContext}e.prototype.getCommand=function(e,t){var r,i;switch(t){case a.restoreItem:i=this._isRestoreEnabled(e);break;case a.open:i=!this._pageContext.isAnonymousGuestUser||d.PermissionMask.hasItemPermission(e,d.PermissionMask.openItems);break;case s.versionHistory:case s.quickEdit:case s.editItem:case s.checkout:case a.copyTo:case a.moveTo:case a.rename:case a.pinToMru:case a.openInTextEditor:case a.openPdfInBrowser:case u.openInClient:case u.openOnline:case l.share:case l.alertItem:case l.addToSpotlight:case a.createShortcut:case c.sync:case c.upload:case c.download:case s.viewItem:case o.createWorkflow:case o.baseFlow:i=!0}this._pageContext.isAnonymousGuestUser&&m[t.id]?i=!1:this._pageContext.isEmailAuthenticationGuestUser&&g[t.id]&&(i=!1);e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected&&(i=y[t.id]);i&&(r=new n.default);return r};e.prototype._isRestoreEnabled=function(e){return!!e.recycleBinProperties.itemState};return e}();t.default=v;t.resourceKey=r.createResolvedResourceKey(e("module").id,v,{pageContext:i.pageContext})});define("je",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){void 0===e&&(e={});var t=e.behavior;this.behavior=t};t.default=r});define("jd",["require","exports","i8"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createWorkflow=new r.default("createWorkflow");t.baseFlow=new r.default("baseFlow")});define("i8",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function t(e){this.id=""+ ++t._lastId;this.name=e}t.prototype.matches=function(e){return e===this};t._lastId=0;return t}();t.default=r});define("jc",["require","exports","i8"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolder=new r.default("createFolder");t.rename=new r.default("rename");t.moveFrom=new r.default("moveFrom");t.copyFrom=new r.default("copyFrom");t.moveTo=new r.default("moveTo");t.copyTo=new r.default("copyTo");t.deleteItem=new r.default("deleteItem");t.restoreItem=new r.default("restoreItem");t.deleteAllItems=new r.default("deleteAllItems");t.restoreAllItems=new r.default("restoreAllItems");t.createText=new r.default("createText");t.changeExpiration=new r.default("changeExpiration");t.open=new r.default("open");t.openInTextEditor=new r.default("openInTextEditor");t.openPdfInBrowser=new r.default("openPdfInBrowser");t.quickEdit=new r.default("quickEdit");t.editItem=new r.default("editItem");t.createShortcut=new r.default("createShortcut");t.pinToMru=new r.default("pinToMru")});define("jb",["require","exports","i8"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.checkout=new r.default("checkout");t.quickEdit=new r.default("quickEdit");t.editItem=new r.default("editItem");t.viewItem=new r.default("viewItem");t.versionHistory=new r.default("versionHistory")});define("ja",["require","exports","i8"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createExcel=new r.default("createExcel");t.createOneNote=new r.default("createOneNote");t.createPowerPoint=new r.default("createPowerPoint");t.createWord=new r.default("createWord");t.createSurvey=new r.default("createSurvey");t.viewSurvey=new r.default("viewSurvey");t.editSurvey=new r.default("editSurvey");t.publishSurvey=new r.default("publishSurvey");t.openOnline=new r.default("openOnline");t.openInClient=new r.default("openInClient");t.viewVersionHistory=new r.default("viewVersionHistory")});define("i9",["require","exports","i8"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.share=new r.default("share");t.addToShared=new r.default("addToShared");t.embed=new r.default("embed");t.comment=new r.default("comment");t.removeFromShared=new r.default("removeFromShared");t.addAsMountPoint=new r.default("addAsMountPoint");t.removeAsMountPoint=new r.default("removeAsMountPoint");t.reportAbuse=new r.default("reportAbuse");t.requestReview=new r.default("requestReview");t.alertItem=new r.default("alertItem");t.addToSpotlight=new r.default("alertItem")});define("i7",["require","exports","i8"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.upload=new r.default("upload");t.download=new r.default("download");t.sync=new r.default("sync")});define("iX",["require","exports","bA","i5","fZ","iE","i2","i0","iY"],function(e,t,r,i,n,o,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedResourceKey(e("module").id,i.PeoplePickerDataSource,{apiUrlHelper:n.resourceKey,pageContext:o.pageContext,dataRequestor:a.resourceKey,oAuthTokenProvider:s.resourceKey,graphPeoplePickerHelper:u.resourceKey})});define("i5",["require","exports","ap","bj","eq","bc","ef","hb","bl","gi","eu","bf"],function(e,a,t,s,u,c,r,f,l,d,p,h){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.PeoplePickerGraph={ODB:387};a.DisablePeoplePickerGraphExperiment={ODB:776};a.EnablePeoplePickerGraphDLErrorExperiment={ODB:779};var i=function(o){t.__extends(e,o);function e(e,t){var r=this,i=m(e)?e:t.pageContext;r=o.call(this,i)||this;var n=m(e)?e.apiUrlHelper:t.apiUrlHelper;r._imageAbsoluteWebUrl=e.imageAbsoluteWebUrl||"";r._apiUrlHelper=n||new s.ApiUrlHelper({},{itemUrlHelper:new l.ItemUrlHelper({},{pageContext:i}),pageContext:i});r._capabilities={supportsMruCaching:!0};if(t){r._dataRequestor=t.dataRequestor;r._graphPeoplePickerHelper=t.graphPeoplePickerHelper}return r}e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.getPersonaDetails=function(e){var n=this;return this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",parseResponse:function(e){var t=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},r=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,i={personDetails:t(r.Primary),managerChain:r.ManagerChain.results.map(t),directReports:r.DirectReports.results.map(t)};i.personDetails.profilePage=u.getServerUrl(n._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(i.personDetails.sip)+"&origin=ProfileODBCard";return i}})};e.prototype.getPickerEntityInformation=function(t){var e=0;t.principalType===f.default.sharePointGroup&&(e=Number(t.rawPersonData.EntityData.SPGroupID));var r=JSON.stringify({entityInformationRequest:{PrincipalType:t.principalType,EmailAddress:t.email,GroupId:e}});return this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:r,qosName:"getPickerEntityInformation",parseResponse:function(e){return{totalMemberCount:JSON.parse(e).d.TotalMemberCount,person:t}}})};e.prototype.resolve=function(e,o){var a=this;return this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:this._constructPostBody(e,o),qosName:"Resolve",parseResponse:function(e){var t=JSON.parse(e),r=JSON.parse(t.d.ClientPeoplePickerResolveUser),i=[];i[0]=r;h.Killswitch.isActivated("067ca2b4-2244-4153-8dfa-d11e6b4487bb","03/19/2018","Only overwrite display text if it is null or empty")?r.IsResolved||(i[0].DisplayText=r.Key):r.IsResolved||r.EntityData.IsBlockedOnODB&&"true"===r.EntityData.IsBlockedOnODB.toLowerCase()||(i[0].DisplayText=r.Key);var n=(i=a._transformData(i,o.filterExternalUsers))[0];if(o.filterExternalUsers&&n&&1===n.entityType){n.isResolved=!1;n.entityType=0}else if(o.blockViaPolicy&&!o.filterExternalUsers&&n&&!n.isResolved&&0===n.multipleMatches.length){n.isResolved=!0;n.isExternal=!0;n.entityType=1}if(o.isGraphDistributionList&&o.useGraph&&n.isExternal){n.entityType=2;n.principalType=f.default.distributionList}return n}})};e.prototype.search=function(e,t){return t.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph()?this._graphSearch(e,t):this.sharePointSearch(e,t)};e.prototype.sharePointSearch=function(c,d){var p=this;d.onToggleGetMoreResults&&d.onToggleGetMoreResults(!1);return this.dataRequestor.getData({url:this._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:this._constructPostBody(c,d),qosName:"Search",parseResponse:function(e){var t=d.allowSharePointGroups,r=void 0===t||t,i=d.filterExternalUsers,n=d.forceResolve,o=JSON.parse(e),a=JSON.parse(o.d.ClientPeoplePickerSearchUser),s=p._transformData(a,i);i&&(s=s.filter(function(e){return 1!==e.entityType}));var u=!s.length;s=s.filter(function(e){return e.principalType===f.default.sharePointGroup?r:e.principalType===f.default.securityGroup?r||p._isValidEmail(e.email,!0):p._isValidEmail(e.email,!1)});if(h.Killswitch.isActivated("cc7520a8-6922-4e12-81c1-179764750212","3/29/2018","Disable limiting no results behavior to e-mail addresses."))n&&u&&s.push({name:c,userId:c,email:c});else if(0===s.length&&p._isValidEmail(c,!1)){var l={Key:c,IsResolved:!1};s.push({email:c,entityType:1,isResolved:!0,job:c,name:c,userId:c,rawData:l,rawPersonData:l,isExternal:!0})}return s}})};e.prototype.subscribePresence=function(e,t){var r=this;try{this._ensureSkypePresence();if(!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var i=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};this._skypeIntegration.TrackPresence(e,i);return{dispose:function(){try{r._skypeIntegration.UntrackPresence(e,i)}catch(e){}}}}catch(e){}return null};e.prototype.sendSourceName=function(){return"PeoplePickerDataSource"};e.prototype._constructPostBody=function(e,t){var r={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(r)};e.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}};e.prototype._graphSearch=function(i,n){var l=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(e){if(!e)return l.sharePointSearch(i,n);var t='https://graph.microsoft.com/v1.0/me/people?$search="'+i+'"&$top=30&$select=displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName',r=!1;if(c.default.isFeatureEnabled(a.EnablePeoplePickerGraphDLErrorExperiment)){r=new p.ABExperiment({name:"FilterPublicDistributionLists",startDate:"02/15/2018"}).IsExperimentOn()}r||(t+="&$filter=personType/subclass ne 'PublicDistributionList'");return l._dataRequestor.send({apiName:"Graph.PeopleSearch",path:t,headers:{Authorization:"Bearer "+e},needsAuthorization:!1}).then(function(e){n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0);var t=e.value,u=[];t.forEach(function(e){var t=l._transformToSharePointRawPerson(e),r=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",i="ImplicitContact"===e.personType.subclass,n="OrganizationUser"===e.personType.subclass,o="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,a="PublicDistributionList"===e.personType.subclass,s={department:e.department,email:r,image:i?void 0:"/_layouts/15/userphoto.aspx?size=S&accountname="+r,job:e.jobTitle||r,name:e.displayName,providerName:n?"Provider":void 0,userId:e.userPrincipalName||r,rawData:t,rawPersonData:t,isExternal:!n};if(n){s.entityType=0;s.principalType=f.default.user;s.isResolved=!0}else if(o){s.entityType=2;s.principalType=f.default.sharePointGroup;s.isResolved=!1}else{s.principalType=a?f.default.distributionList:f.default.none;s.entityType="Group"===e.personType.class?2:1;s.isResolved=!1;s.providerName=void 0}u.push(s)});if(0===u.length&&l._isValidEmail(i,!1)){var r={Key:i,IsResolved:!1};u.push({email:i,entityType:1,isResolved:!0,job:i,name:i,userId:i,rawData:r,rawPersonData:r,isExternal:!0})}return u},function(e){if(d.isGraphError(e))switch(e.status){case 403:case 404:l._graphPeoplePickerHelper.disableGraphCallsForPicker();return l.sharePointSearch(i,n);default:return null}return null})})};e.prototype._isValidEmail=function(e,t){if(!e)return!t;if(-1<e.indexOf(" ")||-1<e.indexOf(";"))return!1;return/\S+@\S+\.\S+/.test(e)};e.prototype._transformData=function(e,o){var a=this;return e.map(function(e){var t=e.EntityData,r={name:e.DisplayText,email:t.Email,userId:e.Key,job:t.Title,department:t.Department,phone:t.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};if(0<r.multipleMatches.length){r.multipleMatches=a._transformData(r.multipleMatches,o);o&&(r.multipleMatches=r.multipleMatches.filter(function(e){return 1!==e.entityType}))}var i=r.email;r.isResolved&&(r.image=i?a._imageAbsoluteWebUrl+"/_layouts/15/userphoto.aspx?size=S&accountname="+i:null);var n=t.PrincipalType||e.EntityType;switch(n){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":r.entityType=1;r.principalType=f.default.user;r.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":r.entityType=2;r.principalType="SharePointGroup"===n?f.default.sharePointGroup:f.default.securityGroup;break;default:r.entityType=0;r.principalType=f.default.user}return r})};e.prototype._transformToSharePointRawPerson=function(e){return{Key:e.userPrincipalName,IsResolved:!1}};return e}(r.default);a.PeoplePickerDataSource=i;function m(e){return!!e.webAbsoluteUrl}});define("eq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.None=0]="None";e[e.Soft=2]="Soft";e[e.Strong=3]="Strong"}(t.SPVariantThemeType||(t.SPVariantThemeType={}));t.DEFAULT_LOGO_URL="_layouts/15/images/siteicon.png";t.getServerUrl=function(e){var t=e.webAbsoluteUrl,r=e.webServerRelativeUrl;return"/"===r||""===r?t:t.substring(0,t.lastIndexOf(r))};t.getSafeWebServerRelativeUrl=function(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl};t.isGroupWebContext=function(e){return e&&!!e.groupId&&e.webAbsoluteUrl===e.siteAbsoluteUrl}});define("ef",["require","exports","eg"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._pageContext=e;this.dataRequestor=new r.default({qosName:this.getDataSourceName()},{pageContext:e})}e.prototype.getDataSourceName=function(){return"DataSource"};e.prototype.needsRequestDigest=function(e){return!0};e.prototype.getData=function(e,t,r,i,n,o,a,s,u,l,c,d){void 0===n&&(n="POST");var p=e();return this.dataRequestor.getData({url:p,parseResponse:t,qosName:r,qosHandler:c,customQosLogger:d,additionalPostData:i&&i(),method:n,additionalHeaders:o,contentType:a,maxRetries:s,noRedirect:u,crossSiteCollectionCall:l,needsRequestDigest:this.needsRequestDigest(p)})};return e}();t.DataSource=i;t.default=i});define("hb",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.none=0]="none";e[e.user=1]="user";e[e.distributionList=2]="distributionList";e[e.securityGroup=4]="securityGroup";e[e.sharePointGroup=8]="sharePointGroup";e[e.all=15]="all"}(r||(r={}));t.default=r});define("gi",["require","exports","aL"],function(e,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){var r=t.response,i=(void 0===r?{}:r).error,n=(void 0===i?{}:i).innererror,o=(void 0===n?{}:n).stackTrace,a=void 0===o?"":o,s=t.response,u=t.request,l=t.status,c=e.message;this.name="GraphError";this.message=c;(this.type=this).response=s;this.status=l;this.serverStack=a;this.request=u;this.error=e;return d.extend(e,this)};t.GraphError=r;var o="errorMessage",a="vroomStatus",s="vroomErrorCode",u="vroomErrorMessage",l="vroomErrorInnerCode",c="vroomErrorInnerMessage",p="vroomErrorInnerDebugMessage",f="vroomErrorInnerStack";t.getQosExtraDataFromError=function(e){var t={};t[o]=e.message;if(h(e)){t[a]=e.status;var r=e.response;if(r&&r.error){var i=r.error;t[s]=i.code;t[u]=i.message;var n=i.innererror;if(n){t[l]=n.code;t[c]=n.message;t[p]=n.debugMessage;t[f]=n.stackTrace}}}return t};function h(e){return e.type instanceof r}t.isGraphError=h;function i(e,t){if(h(e)){var r=e.response,i=e.status;if(r){for(var n=[],o=r.error;o;){n.push(o);o=o.innererror}for(;o=n.pop();){var a=t(o.code,e);if(void 0!==a)return a}}return t(i,e)}}t.getErrorResolution=i;t.getResultCodeFromError=function(e){return i(e,function(e){return""+e})||"unhandled"}});__assign=this&&this.__assign||Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};define("eu",["require","exports","a0","ev"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.user=1]="user";e[e.tenant=2]="tenant";e[e.farm=3]="farm";e[e.site=4]="site"}(r=t.TargetType||(t.TargetType={}));var i=function(){function i(e){this._experimentData={name:e.name,startDate:e.startDate,segmentPopulation:void 0===e.segmentPopulation?.5:e.segmentPopulation,targetType:void 0===e.targetType?r.user:e.targetType};this._isOn=!1;if(null==i._pageContext)n.Engagement.logData({name:this._experimentData.name+".Experiment.HostSettingsMissing"});else switch(this._experimentData.targetType){case r.user:this._isOn=this._isUserExperimentOn();break;case r.tenant:this._isOn=this._isTenantExperimentOn();break;case r.farm:this._isOn=this._isFarmExperimentOn();break;case r.site:this._isOn=this._isSiteExperimentOn()}}i.Init=function(e){i._pageContext=__assign({},e,{userLoginName:e.userLoginName||"missing_user",siteSubscriptionId:e.siteSubscriptionId||"missing_tenant",farmLabel:e.farmLabel||"missing_farm",siteId:e.siteId||"missing_site"})};i.prototype.GetExperimentData=function(){return this._experimentData};i.prototype.IsExperimentOn=function(){return this._isOn};i.prototype._isUserExperimentOn=function(){if(null===i._pageContext)return!1;var e=this._experimentData.name+"_"+i._pageContext.userLoginName+"_"+i._pageContext.siteSubscriptionId+"_"+i._pageContext.farmLabel;return this._isExperimentOn(e)};i.prototype._isTenantExperimentOn=function(){if(null===i._pageContext)return!1;var e=this._experimentData.name+"_"+i._pageContext.siteSubscriptionId+"_"+i._pageContext.farmLabel;return this._isExperimentOn(e)};i.prototype._isFarmExperimentOn=function(){if(null===i._pageContext)return!1;var e=this._experimentData.name+"_"+i._pageContext.farmLabel;return this._isExperimentOn(e)};i.prototype._isSiteExperimentOn=function(){if(null===i._pageContext)return!1;var e=this._experimentData.name+"_"+i._pageContext.siteId+"_"+i._pageContext.siteSubscriptionId+"_"+i._pageContext.farmLabel;return this._isExperimentOn(e)};i.prototype._isExperimentOn=function(e){if(null===e)return!1;if(this._getHashNumber(e)<=this._experimentData.segmentPopulation){this._logData(!0);return!0}this._logData(!1);return!1};i.prototype._getHashNumber=function(e){if(0===e.length)return 1;for(var t=5381,r=0;r<e.length;++r){t=(t<<5)+t+e.charCodeAt(r);t&=t}return(t&=65535)/65535};i.prototype._logData=function(e){var t=i._pageContext,r={isTreatment:e,startDate:this._experimentData.startDate,isExternalGuestUser:t.isExternalGuestUser,isAnonymousGuestUser:t.isAnonymousGuestUser,farmLabel:t.farmLabel,targetType:this._experimentData.targetType};n.Engagement.logData({name:this._experimentData.name+".Experiment",siteId:t.siteId,webId:t.webId,groupId:t.groupId,listId:t.listId,extraData:r});o.Experiment.logData({name:"",isInRamp:e,experiment:this._experimentData.name,variant:e.toString()})};return i}();t.ABExperiment=i});define("ev",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Experiment=r.createSingleEvent({eventName:"Experiment,",shortEventName:"Experiment"},{name:{isPrefixingDisabled:!0,type:1},isInRamp:{isPrefixingDisabled:!0,type:3},experiment:{isPrefixingDisabled:!0,type:1},variant:{isPrefixingDisabled:!0,type:1}});t.default=t.Experiment});define("i2",["require","exports","bA","i4","i3","gg"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedResourceKey(e("module").id,o.DataRequestor,{sessionManagementProvider:i.resourceKey,urlDataSource:n.resourceKey});t.default=o.DataRequestor});define("i4",["require","exports","ap","bN","aC","bA","cY","dZ"],function(e,t,r,n,o,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){r.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._identityDataSource=t.identityDataSource;return r}e.prototype.getToken=function(){return this._identityDataSource.getIdentity().type!==a.IdentityType.msa||"function"!=typeof this._identityDataSource.getGraphToken?o.default.wrapError(new Error("Can only request a graph token for an MSA account.")):this._identityDataSource.getGraphToken()};e.dependencies=r.__assign({},n.default.dependencies,{identityDataSource:s.identity});return e}(n.default);t.default=u;t.resourceKey=i.createResolvedResourceKey(e("module").id,u)});define("i3",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.prototype.getApiName=function(){return"Graph"};e.prototype.getApiBaseUrl=function(){return"https://graph.microsoft.com/v1.0"};return e}();t.default=i;t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.SimpleResourceFactory(i)})});define("gg",["require","exports","ap","gh"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t)});define("gh",["require","exports","ap","aC","fW","cb","aI","ej","gi"],function(e,t,T,C,x,I,P,E,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var r=t.sessionManagementProvider,i=t.urlDataSource;this._sessionManagementProvider=r;this._apiName=i&&"function"==typeof i.getApiName?i.getApiName():"Vroom";this._apiBaseUrl=i?"function"==typeof i.getApiBaseUrl?i.getApiBaseUrl():i.getVroomApiBaseUrl():void 0}e.prototype.send=function(o){var a=this,e=o.headers,s=void 0===e?{}:e,u=o.path,l=o.apiName,t=o.requestType,c=void 0===t?"GET":t,r=o.disableLogging,d=void 0!==r&&r,p=o.timeout,f=o.onProgress,h=o.onUploadProgress,S=o.qosExtraData,i=o.apiVersion,n=void 0===i?"v2.0":i,m=o.needsAuthorization,g=void 0===m||m,y=o.useAuthorizationHeaders,w=void 0!==y&&y,v=o.accessToken,_=this._sessionManagementProvider,b=g&&(v||_&&_.getToken(n).catch(function(e){return C.default.reject(new D.GraphError(e,{status:0,response:{error:{code:"authFailure"}}}))}))||void 0;return C.default.resolve(b).then(function(v){var _,e=a._apiBaseUrl,t=T.__assign({Accept:"application/json"},o.postData?{"Content-Type":"application/json"}:{},s);if(v&&v.tokenUrl&&0===u.indexOf("/drive/"))_=new E.default(v.tokenUrl+"/"+u.substring(7));else{_=new E.default(u);e&&!_.getScheme()&&(_=new E.default(e+u))}var b,r=_.toString();if(v){var i=v.accessToken,n=v.proofToken;if(w){i&&(t=T.__assign({},t,{Authorization:"bearer "+i}));n&&(t=T.__assign({},t,{"X-PROOF_TOKEN":n}))}else{i&&_.setQueryParameter("access_token",i);n&&_.setQueryParameter("prooftoken",n)}}d||(b=new I.Api({url:r,name:a._apiName+"DataRequest."+l,extraData:S}));return x.default.start({url:_.toString(),headers:t,method:c,json:o.postData||"",requestTimeoutInMS:p,withCredentials:!1,onProgress:f,onUploadProgress:h}).then(function(e){b&&b.end({resultType:P.ResultTypeEnum.Success});return o.parseResponse?o.parseResponse(e):0===e.responseText.length?null:JSON.parse(e.responseText)},function(e){var t,r,i;if(e instanceof Error){var n=C.default.isCanceled(e)?P.ResultTypeEnum.ExpectedFailure:P.ResultTypeEnum.Failure;r={error:e.message,resultType:n};i=e}else{if(e.responseText)try{t=JSON.parse(e.responseText)}catch(i){}var o=e.status,a=e.statusText,s=(t||{}).error,u=void 0===s?{}:s,l=u.message,c=void 0===l?"":l,d=u.innererror,p=void 0===d?{}:d,f=p.stackTrace,h=void 0===f?"":f,m=p.debugMessage,g=void 0===m?"":m;i=new D.GraphError(new Error(c),{response:t,status:o,request:e});var y=D.getResultCodeFromError(i);r={resultType:P.ResultTypeEnum.Failure,error:c,resultCode:y,extraData:T.__assign({},S||{},D.getQosExtraDataFromError(i),{stack:h,httpStatus:o,httpStatusText:a,requestId:e.getResponseHeader("request-id")||e.getResponseHeader("sprequestguid"),debugMessage:g,accessTokenLength:v&&v.accessToken?v.accessToken.length:-1,urlLength:_.toString().length})}}b&&b.end(r);return C.default.reject(i)})})};return e}();t.DataRequestor=r;t.default=r});define("fW",["require","exports","fX","aC"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.start=function(e){var r=new n.default(e);return new o.default(function(e,t){r.start(e,t)},function(){r.abort(!0)})};e.startAndPostProcess=function(e,i){var t=new n.default(e);return new o.default(function(r,e){t.start(function(e,t){r(i(e,t))},e)},function(){t.abort(!0)})};return e}();t.default=r});define("i0",["require","exports","ap","iE","bA","i1","i1"],function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(a,t);t.resourceKey=n.createResolvedResourceKey(e("module").id,o.default,{pageContext:i.pageContext})});define("i1",["require","exports","aC","aI","c7"],function(o,e,r,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t;(t=e.TokenFetchServerErrorCodes||(e.TokenFetchServerErrorCodes={}))[t.InteractionRequired=10013]="InteractionRequired";var i=function(){function e(e,t){void 0===e&&(e={});this._pageContext=t.pageContext}e.prototype.getToken=function(t,r){var i=this,n=new a.Qos({name:"getToken"});return this._getDataSource().then(function(e){return"undefined"==typeof __webpack_require__?s.loadModule({path:"ax",require:o}).then(function(){return i._getTokenFromDataSource(e,t,n,r)},function(e){return i._getTokenFetchError(e,n)}):i._getTokenFromDataSource(e,t,n,r)})};e.prototype.enableAbsoluteUrlForOAuth=function(){this._useAbsoluteUrlForOAuth=!0};e.prototype._getTokenFromDataSource=function(e,t,r,i){return e.getToken(t,i).then(function(e){r.end({resultType:a.ResultTypeEnum.Success});return e})};e.prototype._getTokenFetchError=function(e,t){t.end({resultCode:"GetTokenError",resultType:a.ResultTypeEnum.Failure,extraData:{error:e}});return r.default.wrapError(e)};e.prototype._getDataSource=function(){var t=this;return this._dataSource?r.default.as(this._dataSource):"undefined"==typeof __webpack_require__?s.loadModule({path:"YD",require:o}).then(function(e){t._dataSource=new e(t._pageContext);return t._dataSource}):this._getDataSourceViaImport()};e.prototype._getDataSourceViaImport=function(){var t=this;return new r.default(function(t){o.ensure(["YD"],function(e){t(e("YD").default)},"oauth-token-data-source")}).then(function(e){return e}).then(function(e){t._dataSource=new e(t._pageContext,{useAbsoluteUrlForOAuth:t._useAbsoluteUrlForOAuth});return r.default.as(t._dataSource)})};return e}();e.default=i});define("iY",["require","exports","ap","iE","bA","iZ","i0","iZ"],function(e,t,r,i,n,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(s,t);t.resourceKey=n.createResolvedResourceKey(e("module").id,o.GraphPeoplePickerHelper,{oAuthTokenProvider:a.resourceKey,pageContext:i.pageContext})});define("iZ",["require","exports","aC","bc","eu","aI","a3","a2"],function(e,t,i,r,n,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PeoplePickerGraph={ODB:387};t.DisablePeoplePickerGraphExperiment={ODB:776};var u="DisableGraph",l=function(){function e(e,t){this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider;this.initializeDataStore()}e.prototype.canUseGraph=function(){if(this._pageContext&&!this._pageContext.isSPO)return!1;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&r.default.isFeatureEnabled(t.PeoplePickerGraph);this._dataStore&&(e=e&&!this._dataStore.getValue(u,s.default.session));e&&(e=e&&this.isInExperimentToUseGraph());return e};e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue(u,!0,s.default.session)};e.prototype.getGraphToken=function(){var t=this;if(this._oAuthTokenProvider){var r=new o.Qos({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken("https://graph.microsoft.com").then(function(e){r.end({resultType:o.ResultTypeEnum.Success});return e},function(e){if(i.default.isCanceled(e)){r.end({resultType:o.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return i.default.reject(e)}r.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:o.ResultTypeEnum.Failure,extraData:{serverErrorCode:e._serverErrorCode,message:e.message}});t.disableGraphCallsForPicker();return null})}return null};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new a.default("PeoplePicker",s.default.session))};e.prototype.isInExperimentToUseGraph=function(){if(!r.default.isFeatureEnabled(t.DisablePeoplePickerGraphExperiment)){return new n.ABExperiment({name:"UseSmartPeoplePicker",startDate:"02/28/2018"}).IsExperimentOn()}return!0};return e}();t.GraphPeoplePickerHelper=l});define("iW",["require","exports","ap","bN","aC","bA","fZ","fO","gl","bX","eA","iE"],function(e,t,r,i,u,n,o,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r._apiUrlHelper=t.apiUrlHelper;r._dataRequestor=r.scope.attach(new t.dataRequestorType({qosName:"PolicyTipDataSource"}));r._itemParentHelper=t.itemParentHelper;r._itemUrlHelper=t.itemUrlHelper;r._viewParams=t.viewParams;r._sharingContextInformation=t.sharingContextInformation;return r}e.prototype.getExternalSharingStatus=function(){return this._isPseudo()?u.default.wrap({isExternalSharingTipEnabled:!0,externalSharingTipsLearnMoreUrl:"http://bing.com"}):this._dataRequestor.getData({url:this._apiUrlHelper.build().segments("web","DataLeakagePreventionStatusInfo").toString(),qosName:"GetExternalSharingStatus"}).then(function(e){var t=e&&e.d;return t?{isExternalSharingTipEnabled:t.ExternalSharingTipsEnabled,externalSharingTipsLearnMoreUrl:t.ExternalSharingTipsLearnMoreUrl}:null})};e.prototype.getPolicyTip=function(e){if(this._isPseudo())return u.default.wrap({issueDescriptions:["Item contains the following sensitive information: U.S. Social Security Number (SSN)","Item is shared with people outside your organization","Item contains sensitive document properties"],overrideOption:2,lastScanned:new Date,policyInfoUrl:"http://bing.com",explanationText:"This item conflicts with a policy in your organization. Access to this item is blocked for everyone except its owner, last modifier, and the site owner."});if(!this._sharingContextInformation&&!e)return u.default.wrap(null);var t=this._getApiRoot(e).segment("getdlppolicytip");return this._dataRequestor.getData({url:t.toString(),qosName:"GetPolicyTip"}).then(function(e){var t=e&&e.d;if(!t||null===t.GetDlpPolicyTip)return u.default.wrap(null);var r=t.MatchedConditionDescriptions,i=t.OverrideOptions,n=void 0===i?0:i,o=t.GeneralText,a=t.AppliedActionsText,s=Date.parse(t.LastProcessedTime);return{issueDescriptions:r&&r.results,overrideOption:Number(n),policyInfoUrl:t.ComplianceUrl,explanationText:o&&a?o+" "+a:o||a||"",lastScanned:isNaN(s)?void 0:new Date(s)}})};e.prototype.updatePolicy=function(e){if(this._isPseudo())return u.default.wrap(0===e.action?2:1===e.action?3:0);var t=this._getApiRoot(e.item).segment("overridepolicytip");return this._dataRequestor.getData({url:t.toString(),additionalPostData:JSON.stringify({userAction:e.action,justification:e.justification}),method:"POST",qosName:"UpdatePolicyTip"}).then(function(e){var t=e&&e.d,r=t&&t.OverridePolicyTip;return"number"==typeof r?r:null})};e.prototype._getApiRoot=function(e){var t;if(this._sharingContextInformation)t=this._sharingContextInformation.listUrl?this._apiUrlHelper.build().webByUrl({listUrl:this._sharingContextInformation.listUrl}).method("GetListItem",this._sharingContextInformation.serverRelativeItemUrl):this._sharingContextInformation.itemUrl?this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetFileByUrl",this._sharingContextInformation.itemUrl).segment("ListItemAllFields"):this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetListItemByResourceId",this._sharingContextInformation.resourceId);else{var r=this._itemUrlHelper.getItemUrlParts(e.key),i=this._getParentListId(e);t=this._apiUrlHelper.build().webByItemUrl(r).method("Lists",i).method("GetItemById",e.properties.ID)}return t};e.prototype._getParentListId=function(e){var t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return t?t.list.id:e&&e.properties&&e.properties.listId};e.prototype._isPseudo=function(){return"1"===this._viewParams.peek().showpolicytips};return e}(i.default);t.default=p;t.resourceKey=n.createResolvedResourceKey(e("module").id,p,{apiUrlHelper:o.resourceKey,dataRequestorType:s.typeResourceKey,itemParentHelper:c.resourceKey,itemUrlHelper:a.resourceKey,viewParams:l.viewParams,sharingContextInformation:d.sharingContextInformation.optional})});define("eA",["require","exports","iJ","bA"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getFacetedAncestorOrSelf=function(e,t){return this.getAncestorOrSelf(e,function(e){return!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var r;e;){var i=this._itemsStore.getItem(e.key),n=i&&i.peek();if(!n)break;if(t(n)){r=i;break}e=e.parent}return r};e.dependencies={itemsStore:r.resourceKey};return e}();t.default=n;t.resourceKey=i.createResolvedResourceKey(e("module").id,n)});define("iV",["require","exports","aC","c7","bA"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:r("module").id,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({path:"avk",getModule:function(){return new t.default(function(e,t){r(["avk"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("iU",["require","exports","aC","c7","bA"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:r("module").id,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({path:"api",getModule:function(){return new t.default(function(e,t){r(["api"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("iT",["require","exports","aC","c7","bA"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:r("module").id,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({path:"apk",getModule:function(){return new t.default(function(e,t){r(["apk"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("iQ",["require","exports","ap","bN","bA","eT","eO","dH","dZ","eT","fO","iJ","iS","iL","iR","aG"],function(e,t,p,r,i,f,h,m,n,o,g,a,s,u,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={itemTaskObserverType:o.resourceKey,itemUrlHelper:g.resourceKey,itemsStore:a.resourceKey,observablesFactoryType:r.observablesFactoryTypeResourceKey,rootItemsTypeFilter:s.resourceKey.optional,urlDataSource:n.url,webDataSource:u.resourceKey};t.resourceKey=new i.ResourceKey({name:e("module").id+".rootItems",factory:{dependencies:l,create:function(a){var s=a.itemUrlHelper,u=a.itemsStore,l=a.rootItemsTypeFilter,c=a.urlDataSource,e=new a.observablesFactoryType,d=e.create();a.webDataSource.getMyOneDriveUrl().then(function(e){var t,r=s.getUrlParts({path:e,webUrl:e}),i=new a.itemTaskObserverType,n=c.getKey(p.__assign(((t={}).id=r.fullItemUrl,t.view=m.default.DocumentLibraries,t),c.saveItemTypeFilter(l))),o=c.getKey(p.__assign({},c.getKeyParams(c.getRootItemKey(m.default.Recent)),c.saveItemTypeFilter(l)));i.update([new f.Task(n).succeed({item:{key:n,name:f.Graft.backup(r.siteRelation===g.SiteRelation.sameSite?y.strings.Files:y.strings.oneDriveGroupTitle),displayName:f.Graft.backup(r.siteRelation===g.SiteRelation.sameSite?y.strings.Files:y.strings.oneDriveGroupTitle),type:f.Graft.backup(h.default.Folder),subsite:{webTemplateId:v.default.mySite}}}),new f.Task(o).succeed({item:{key:o,name:f.Graft.backup(y.strings.Recent),displayName:f.Graft.backup(y.strings.Recent),type:f.Graft.backup(h.default.Folder)}})]);i.flush();d({files:u.getItem(n),recent:u.getItem(o)})});return{instance:d,disposable:e}}}})});define("iS",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey(e("module").id)});define("iL",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"vO",getModule:function(){return new t.default(function(e,t){r(["vO"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("iP",["require","exports","c7","bA"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:""+e("module").id,loader:new i.AliasResourceLoader(function(){return r.loadModuleExport({path:"Vh",require:e,getExport:function(e){return e.resourceKey}})})})});define("iO",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"Vk",getModule:function(){return new t.default(function(e,t){r(["Vk"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("iN",["require","exports","ap","aC","bN","bA","gf"],function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._vroomDataRequestor=t.vroomDataRequestor;return r}e.prototype.getSubscriptions=function(e){var t=this;return e.itemId?this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/items/"+e.itemId+"/subscriptions"}).then(function(e){return e.value.map(function(e){return t._translateToSubscriptionModel(e)})}):n.default.wrap([])};e.prototype.updateSubscription=function(e){var t=this,r=new Date;r.setMonth(r.getMonth()+1);var i={notificationUrl:"ActivityService://activity",expirationDateTime:r.toISOString(),scenarios:["FollowAFile"],muted:!e.isOn};return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drives/"+e.item.ownerId+"/items/"+e.item.itemId+"/subscriptions",requestType:"POST",postData:JSON.stringify(i)}).then(function(e){return t._translateToSubscriptionModel(e)})};e.prototype.getRootSubscriptions=function(){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0}).then(function(e){return e.value.map(function(e){return t._translateToSubscriptionModel(e)})})};e.prototype.createRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0,requestType:"POST",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})};e.prototype.updateRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions/"+e.id,useAuthorizationHeaders:!0,requestType:"PATCH",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})};e.prototype.deleteRootSubscription=function(e){return this._vroomDataRequestor.send({apiName:"subscriptions",requestType:"DELETE",path:"/drive/root/subscriptions/"+e.id,useAuthorizationHeaders:!0})};e.prototype._translateToSubscriptionModel=function(e){if(!e)return null;var t={id:e.id,muted:e.muted,expirationDateTime:e.expirationDateTime,notificationUrl:e.notificationUrl,resource:e.resource,scenarios:e.scenarios};e.createdBy&&e.createdBy.user&&(t.createdBy={user:{id:e.createdBy.user.id}});return t};e.prototype._getPostData=function(e){var t={notificationUrl:e.notificationUrl};if(e.expirationDateTime)t.expirationDateTime=e.expirationDateTime.toISOString();else{if(!e.expiresAfterDuration)throw new Error("Invalid expiration time");t.expiresAfterDuration=e.expiresAfterDuration}return t};e.dependencies=r.__assign({},o.default.dependencies,{vroomDataRequestor:a.resourceKey});return e}(o.default);t.default=s;t.resourceKey=i.createResolvedResourceKey(e("module").id,s)});define("gf",["require","exports","bA","dZ","gj","gg"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedResourceKey(e("module").id,o.DataRequestor,{sessionManagementProvider:n.resourceKey,urlDataSource:i.url});t.default=o.DataRequestor});define("gj",["require","exports","cY","aC","dZ","bA"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._identityDataSource=t.identityDataSource;this._microServiceDataSource=t.microServiceDataSource}e.prototype.getToken=function(t){var e=this._identityDataSource.getIdentity().type;if(e===r.IdentityType.aad){if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(e){if(e)return t&&"v2.1"===t?{accessToken:e.authTokenV21,proofToken:e.proofTokenV21,tokenUrl:e.tokenUrlV21}:{accessToken:e.authToken,proofToken:e.proofToken,tokenUrl:e.tokenUrl}},function(e){return i.default.resolve()})}else if(e===r.IdentityType.msa)return this._identityDataSource.getSessionToken();return i.default.reject(new Error("Cannot request a token for an unauthenticated user."))};e.dependencies={identityDataSource:n.identity,microServiceDataSource:n.microService.optional};return e}();t.default=a;t.resourceKey=o.createResolvedResourceKey(e("module").id,a)});define("iM",["require","exports","aC","c7","bA"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:r("module").id,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({path:"ab5",getModule:function(){return new t.default(function(e,t){r(["ab5"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("iK",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.allowInfectedFileDownloadsResourceKey=new r.ResourceKey({name:e("module").id+".allowInfectedFileDownloads",factory:new r.ConstantResourceFactory(!1)})});define("iI",["require","exports","aC","c7","bA"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:r("module").id,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({path:"avd",getModule:function(){return new t.default(function(e,t){r(["avd"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("iH",["require","exports","aC","c7","bA"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:r("module").id,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({path:"avf",getModule:function(){return new t.default(function(e,t){r(["avf"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("iG",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.beacon=new r.ResourceKey("beacon");t.rumOneHelper=new r.ResourceKey("rumOneHelper");t.rumOneEmbedVideoHelper=new r.ResourceKey("rumOneEmbedVideoHelper")});define("iF",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dataStore=new r.ResourceKey("dataStore");t.userSettingsStore=new r.ResourceKey("userSettingsStore");t.userInfoStore=new r.ResourceKey("userInfoStore");t.smartFiltersStore=new r.ResourceKey("smartFiltersStore")});define("iD",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.idle=new r.ResourceKey("idle");t.beforeUnload=new r.ResourceKey("beforeUnload");t.newFeatureExperienceEnabler=new r.ResourceKey("newFeatureExperienceEnabler");t.syncActiveXClient=new r.ResourceKey("syncActiveXClient");t.experimentHelper=new r.ResourceKey("experimentHelper");t.attributionHelper=new r.ResourceKey("attributionHelper");t.educationAndUpsells=new r.ResourceKey("educationAndUpsells");t.fileHandlerHelper=new r.ResourceKey("fileHandlerHelper");t.clientSideExtensionHelper=new r.ResourceKey("clientSideExtensionHelper");t.needsAttentionViewHelper=new r.ResourceKey("needsAttentionViewHelper")});define("iC",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dataContext=new r.ResourceKey("vroom.dataContext")});define("iB",["require","exports","ap","bN"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getAction=function(e){return{text:null,url:null,hideButton:!0}};return t}(i.default);t.default=n});define("iA",["require","exports","ap","bN","fZ","fO","gl"],function(e,t,i,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._dataRequestor=new(t.child(a.typeResourceKey))({qosName:"FolderItemCountDataSource"});t._apiUrlHelper=t.resources.consume(n.resourceKey);t._itemUrlHelper=t.resources.consume(o.resourceKey);return t}e.prototype.getFolderItemCountInfo=function(e){return this._dataRequestor.getData({url:this._getQueryUrl(e),qosName:"GetFolderItemCountInfo"}).then(function(e){var t=(void 0===e?{}:e).d,r=(void 0===t?{}:t).ItemCount,i=void 0===r?void 0:r;return"number"==typeof i?{itemCount:i}:void 0})};e.prototype._getQueryUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(t).method("GetFolderByServerRelativeUrl",t.serverRelativeItemUrl).segment("ItemCount").toString()};return e}(r.default);t.default=s});define("iy",["require","exports","ap","bN","iz","dH","a9","dZ","gN","V","bX","iE"],function(e,t,r,i,a,s,u,n,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){r.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this,r=l.default.getQueryUrl(u.default.Files,s.default.SecondStageRecycleBin),i=a.strings.SecondStageRecycleBinLink,n=c.format(a.strings.SecondStageRecycleBinInfoText,'<a title="'+i+'" href="'+r+'">'+i+"</a>");t._recycleBinFooters=[{encodedText:n}];return t}e.prototype.showLanguageLink=function(){return!1};e.prototype.showConfidentialText=function(){return!1};e.prototype.getLanguageText=function(){return""};e.prototype.getFooterLinks=function(){var e=this.resources.consume(p.pageContext);this.resources.consume(d.viewParams)();this._urlDataSource=this.resources.consume(n.url);return e.isSiteAdmin&&this._urlDataSource.isCurrentQuery(s.default.RecycleBin)?this._recycleBinFooters:[]};return e}(i.default);t.default=o});define("gN",["require","exports","ap","bN","dH","a9","dJ","iE","dZ","g1","eO","ej","cY","aq","g0","gZ","gY","ba","gX","gA","gV","gU","gT","gR","eq","aM","ep","gQ","gP","fO","dc","by","gK","gO","bA","eA","bb"],function(e,v,t,i,l,_,b,S,n,o,w,T,c,a,s,u,C,d,p,x,f,h,m,g,I,P,E,D,k,U,R,F,A,O,r,L,M){"use strict";Object.defineProperty(v,"__esModule",{value:!0});v.useOneUpTextEditorResourceKey=new r.ResourceKey({name:e("module").id+".useOneUpTextEditor",factory:new r.ConstantResourceFactory(d.isFeatureEnabled(d.UseOneUpTextEditor))});v.supportsOneUpResourceKey=new r.ResourceKey({name:e("module").id+".supportsOneUp",factory:new r.ConstantResourceFactory(!0)});var y=function(y){t.__extends(r,y);function r(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=y.call(this,e,t)||this,i=t.navigation,n=void 0===i?r.resources.consume(R.navigation):i,o=t.platform,a=void 0===o?r.resources.consume(F.platformDetection):o,s=t.pageContext,u=void 0===s?r.resources.consume(S.pageContext):s,l=t.itemUrlHelper,c=void 0===l?r.resources.consume(U.resourceKey):l,d=t.itemParentHelper,p=void 0===d?r.resources.consume(L.resourceKey):d,f=t.useOneUpTextEditor,h=void 0===f?r.resources.consume(v.useOneUpTextEditorResourceKey):f,m=t.supportsOneUp,g=void 0===m?r.resources.consume(v.supportsOneUpResourceKey):m;r._navigation=n;r._platform=a;r._pageContext=u;r._itemUrlHelper=c;r._itemParentHelper=p;r._useOneUpTextEditor=h;r._supportsOneUp=g;r._updateViewParamsFromWindowName();return r}r.getKey=function(e,t){var r,i=Number(e.view)||l.default.Files,n=((r={}).id=e.id||t,r.listurl=e.listurl||"",r.view=""+(i||""),r.q=e.q||"",r.typeFilters=e.typeFilters||"",r.userFilters=e.userFilters||"",r.dateFilter=e.dateFilter||"",r.u=e.u||"",r);return b.serializeQuery(n,null,!0)};r.getKeyParams=function(e){return b.deserializeQuery(e)};r.getQueryUrl=function(e,t){var r={};e!==_.default.Files&&(r.p=e);r.view=""+(t||"");return"#"+b.serializeQuery(r,null,!0)};r.prototype.getDefaultRootItemId=function(){return this._pageContext.listUrl?this._pageContext.listUrl:this._listContext()&&this._listContext().listUrl?this._listContext().listUrl:"root"};r.prototype.getQueryType=function(e){void 0===e&&(e=this._navigation.viewParams);return e.view?Number(e.view):l.default.Files};r.prototype.getPageType=function(e){void 0===e&&(e=this._navigation.viewParams);switch(Number(e.p)){case _.default.FilePicker:return _.default.FilePicker;case _.default.TextFileEditor:return _.default.TextFileEditor;case _.default.Error:return _.default.Error;case _.default.Share:return _.default.Share;case _.default.Embed:return _.default.Embed;case _.default.Restore:return _.default.Restore}return _.default.Files};r.prototype.isCurrentQuery=function(e,t){void 0===t&&(t=this._navigation.viewParams);return t.view?e===l.default.Files?0===Object.keys(t).length||t.view.toString()===l.default.Files.toString():t.view.toString()===e.toString():e===l.default.Files};r.prototype.isRecycleBin=function(e){return e===l.default.RecycleBin||e===l.default.SecondStageRecycleBin};r.prototype.getKey=function(e){(e.listurl===this._pageContext.listUrl||!this._pageContext.listUrl&&this._pageContext.groupId&&!this._navigation.viewParams.newTargetListUrl)&&delete e.listurl;e.newTargetListUrl&&delete e.newTargetListUrl;return r.getKey(e,this.getDefaultRootItemId())};r.prototype.getKeyParams=function(e){return r.getKeyParams(e)};r.prototype.getFocusItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);var t=null,r=e.parent,i=e.parentview;if(r||i){t={};if(r){t.id=e.id;t.listurl=e.listurl}i&&(t.view=e.view)}return t&&b.serializeQuery(t,null,!0)};r.prototype.getCurrentItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);var t={};!e.id&&e.RootFolder&&(e.id=e.RootFolder);a.utils.extend(t,e);var r=t.parent,i=t.parentview;if(r||i){r&&(t.id=r);if(i){t.view=i;delete t.listurl}delete t.parent;delete t.parentview}return this.getKey(t)};r.prototype.areKeysEqual=function(e,t){var r=this.getKeyParams(e),i=this.getKeyParams(t);delete r.listurl;delete i.listurl;delete r.u;delete i.u;return this.getKey(r)===this.getKey(i)};r.prototype.getRootItemKey=function(e){void 0===e&&(e=l.default.Files);return this.getKey(((t={}).view=e,t));var t};r.prototype.getQueryUrl=function(e,t){return r.getQueryUrl(e,t)};r.prototype.getSearchQueryUrl=function(e){return"#"+b.serializeQuery(((t={}).view=l.default.Search,t.q=e,t));var t};r.prototype.getQueryParamValue=function(e){void 0===e&&(e=this._navigation.viewParams);return e.q};r.prototype.getLayoutContentType=function(e){void 0===e&&(e=this._navigation.viewParams);return""};r.prototype.getItemTypeFilter=function(e){for(var t=[],r=0,i=(e.typeFilters||"").split(",");r<i.length;r++){var n=i[r];if("."===n[0])t.push(n);else{var o=D.ItemTypeFilter[n];o&&t.push(o)}}return{filters:t}};r.prototype.saveItemTypeFilter=function(e){void 0===e&&(e={filters:[]});for(var t=[],r=0,i=e.filters;r<i.length;r++){var n=i[r];"string"==typeof n?t.push(n):t.push(D.ItemTypeFilter[n])}var o=t.join(","),a={};o&&(a.typeFilters=o);return a};r.prototype.getUsersFilter=function(e){var t=e.userFilters;return t&&t.split(";#")};r.prototype.saveUsersFilter=function(e){var t={};t.userFilters=e&&e.join(";#");return t};r.prototype.getDateDurationFilter=function(e){return e.dateFilter};r.prototype.saveDateDurationFilter=function(e){var t={},r="string"==typeof e?e:k.DateTimeSliderValue[e];t.dateFilter=r;return t};r.prototype.getOwnerId=function(){return""};r.prototype.getRootUrl=function(){return this._pageContext&&this._pageContext.listUrl||"/"};r.prototype.getSharedByUrl=function(e,t){return""};r.prototype.getExternalUrl=function(e){return"/externalredirector?alias="+o.default[e]};r.prototype.getAppSubfolder=function(){return"odb"};r.prototype.getUploadStorageUrl=function(e,t){return""};r.prototype.getVideoPlayerUrl=function(e){return""};r.prototype.getTaggingOptionsUrl=function(){return""};r.prototype.getAllPhotosForPlaceUrl=function(e,t){return""};r.prototype.getSearchFilterQueryUrl=function(e){return""};r.prototype.isSearchFilterApplied=function(e){return!1};r.prototype.isSearchPassThrough=function(){return!1};r.prototype.getItemHintRedirectViewParams=function(e){return e};r.prototype.getDefaultClickUrl=function(e,t){void 0===t&&(t={});if(!e||!e.key)return"";var r,i=t.preferCurrentView,n=void 0!==i&&i,o=t.itemSet,a=t.focusUrl,s=void 0!==a&&a,u=t.viewParams,l=void 0===u?this._navigation.viewParams:u,c=t.page,d=void 0===c?this.getPageType(l):c,p=this.getKeyParams(e.key),f=this._getItemQueryParams(e.key,{viewParams:l});if(d===_.default.FilePicker){f.p=_.default.FilePicker;if(e.type!==w.default.Folder)return""}if(this.isRecycleBin(e.queryType)&&!this.isRecycleBin(this.getQueryType(p)))return"";var h=s&&!(e.officeBundle&&this._itemUrlHelper.getItemUrlParts(e.key).isCrossDomain),m=this.getPageType(l)===_.default.FilePicker;if(this.getFocusItemKey(l)&&n||h)r=this._getMediaUrl(e,{params:f,itemSet:o});else if(C.isUnifiedAppSupportedFile(e,this._platform.isMobile))r=this.getOpenInOfficeOnlineUrl(e,l,{});else if(e.officeBundle&&e.officeBundle.enableDefaultClick)r=this._getMediaUrl(e,{params:f,itemSet:o});else switch(e.type){case w.default.Media:r=this._getMediaUrl(e,{params:f,itemSet:o});break;case w.default.Folder:var g=this._itemUrlHelper.getItemUrlParts(e.key);if(!m&&e.subsite&&e.subsite.isExternal)return e.subsite.serverRelativeUrl;if(!m&&e.list&&e.list.isExternal&&!M.default.isActivated("3901F929-4939-4EDF-B47F-9267BBBF4294","3/2/2018","Open cross-farm lists externally."))return g.fullItemUrl;if(e.isDocSet)return e.openUrl;if(m||!g.isCrossList&&g.siteRelation===U.SiteRelation.sameSite||Number(this._pageContext.webTemplate)===E.default.mySite&&this._pageContext.isNoScriptEnabled&&g.isCrossDomain)r="#"+b.serializeQuery(f,null,!1);else{if(e.openUrl){if(new T.default(e.openUrl).getScheme()){r=e.openUrl;break}}r=this.getItemUrl(e.key)}break;case w.default.Shortcut:r=e.urls&&e.urls[x.default.shortcutTarget]||e.openUrl;break;default:r=this._isTextEditorFile(e)?this._useOneUpTextEditor&&d!==_.default.TextFileEditor?this._getMediaUrl(e,{params:f,itemSet:o}):this.getTextEditorItemUrl(e,{itemSet:o,viewParams:l}):e.openUrl||e.key&&"#"+e.key}var y="wopiframe.aspx";if(this._listContext()&&(e.type===w.default.File&&e.previewIFrameUrl&&-1!==e.previewIFrameUrl.toLowerCase().indexOf(y)||e.type===w.default.OneNote)){var v=new T.default(r);if(v.getLastPathSegment().toLowerCase()===y){v.setQueryParameter("1"===e.properties.FSObjType?"IsFolder":"IsList","1");v.setQueryParameter("ListId",this._listContext().listId);v.setQueryParameter("ListItemId",e.properties.ID);r=v.toString()}}return r};r.prototype.getPageModulePath=function(e){void 0===e&&(e={});var t=this.getPageType(e);if(d.isFeatureEnabled(d.UseBasePageInODB)||t===_.default.Error||t===_.default.Share||t===_.default.Restore)switch(t){case _.default.Files:case _.default.Error:case _.default.Restore:return"afR";case _.default.FilePicker:return"ahs";case _.default.Share:return"ahO"}switch(t){case _.default.FilePicker:return"zP";case _.default.TextFileEditor:return"DT";case _.default.Embed:return"u7"}return"jD"};r.prototype.getInnerPageModulePath=function(e){void 0===e&&(e={});var t=this.getPageType(e);return t===_.default.Files?"afZ":t===_.default.Error||t===_.default.Restore&&(!d.isFeatureEnabled(d.PointInTimeRestore)||M.default.isActivated("2f65941a-6573-4ca9-8a66-8d9dde1cb280","1/24/2018","Show error page on Files Restore URL"))?"aoy":t===_.default.Restore?"aoC":""};r.prototype.getTopLevelCommandSetModulePath=function(e){void 0===e&&(e={});return"K9"};r.prototype.getTagUrl=function(e){return""};r.prototype.getRecycleBinQueryUrl=function(){return this._pageContext.webAbsoluteUrl+"/"+this._pageContext.layoutsUrl+"/AdminRecycleBin.aspx?mysite=1"};r.prototype.getRecentQueryUrl=function(){return this.getQueryUrl(this.getPageType(),l.default.Recent)};r.prototype.getDateTimeControlIframeUrl=function(){return I.getSafeWebServerRelativeUrl(this._pageContext)+"/"+this._pageContext.layoutsUrl+"/iframe.aspx"};r.prototype.getNewFormRichTextEditorIFrameUrl=function(e,t,r){var i=t?"&ContentTypeId="+t:"",n=r?this.getKeyParams(r).id:this._navigation.viewParams.RootFolder,o=n?"&RootFolder="+P.default.encodeURIComponent(n):"";return this._listContext().listUrl+"/NewForm.aspx?OnlyIncludeOneField="+e+"&ClientFormOverwriteSave=1&IsDlg=1"+i+o};r.prototype.getEditFormRichTextEditorIFrameUrl=function(e,t,r){var i=r?this.getKeyParams(r).id:this._navigation.viewParams.RootFolder,n=i?"&RootFolder="+P.default.encodeURIComponent(i):"";return this._listContext().listUrl+"/EditForm.aspx?OnlyIncludeOneField="+e+"&ID="+t+"&IsDlg=1"+n};r.prototype.getEditFormUrl=function(e){return this._getListItemFormUrl(this._listContext().editFormUrl,e)};r.prototype.getDisplayFormUrl=function(e){return this._getListItemFormUrl(this._listContext().displayFormUrl,e)};r.prototype.getOneDriveAppsUrl=function(){return"https://onedrive.com/download"};r.prototype.handleFatalErrorDuringViewLoad=function(){};r.prototype.getAutoActionType=function(e){return m.default.none};r.prototype.getPhotoType=function(e){return null};r.prototype.getItemUrl=function(e){void 0===e&&(e="");var t=this._itemUrlHelper.getItemUrlParts(e);return A.canonicalizeDecodedUrl(t.fullItemUrl)};r.prototype.qualifyUrl=function(e){var t;if(0===e.indexOf("#")){var r=e.substring(1);t=""+this.getCurrentPageBaseUrl()+window.location.pathname+(r?"?"+r:"")}else t=e;return t};r.prototype.getNavLinkClickUrl=function(e){return""};r.prototype.getApiName=function(){return"Vroom"};r.prototype.getApiBaseUrl=function(e){var t="v2.1"===e?e:"v2.0";return I.getServerUrl(this._pageContext)+"/_api/"+t};r.prototype.getSearchByDateFilterQueryUrl=function(e){return""};r.prototype.isSearchByDateFilterApplied=function(e){return!1};r.prototype.getResourcePreloadUrl=function(){return""};r.prototype.getHipCheckUrl=function(){return""};r.prototype.getVerifyAccountUrl=function(){return""};r.prototype.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host};r.prototype.getOpenInOfficeOnlineUrl=function(e,t,r){void 0===r&&(r={});var i=r.useDefaultAction,n=void 0!==i&&i,o=O.convertToISPListItem(e),a=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return("ms-word"!==(e.appMap?e.appMap.toLowerCase():void 0)?C.isUnifiedAppSupportedFile(e,this._platform.isMobile)?g.WopiHelper.GetWopiDocEditUrl(o,a&&a.list.id||"",this._pageContext.env):!n&&g.WopiHelper.GetWopiFrameEditUrl(o):!n&&g.WopiHelper.GetWopiDocEditUrl(o,a&&a.list.id||"",this._pageContext.env))||e.openUrl};r.prototype.getOpenInOfficeClientUrl=function(e,t,r){var i=e.appMap,n=e.properties&&e.properties.path||this.getItemUrl(e.key),o=e.extension||"",a=-1!==[".jpg",".jpeg",".bmp",".png",".gif",".onetoc2",".one",".odc"].indexOf(o.toLowerCase()),s=e.queryType===l.default.SharedWithMe&&("ms-word"===e.appMap||"ms-powerpoint"===e.appMap),u=c.PermissionMask.hasItemPermission(e,c.PermissionMask.editListItems)&&!a&&(!h.isCheckedOut(e)||h.isCheckedOutByUser(e,this._pageContext.userId))||s;return f.createProtocolHandlerUrl(i,n,u?f.protocolCommand.Edit:f.protocolCommand.View,"",this._platform.isChrome&&this._platform.isMac,this._pageContext.isSPO)};r.prototype.getNewInOfficeClientUrl=function(e,t,r){return f.createProtocolHandlerUrl(e,t,f.protocolCommand.New,r,this._platform.isChrome&&this._platform.isMac,this._pageContext.isSPO)};r.prototype.getNewPlaceholderItemKey=function(){return b.serializeQuery(((e={}).id="placeHolder "+r.placeholderId++,e));var e};r.prototype.getWACResourcesPreloadUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/wopihiddenframe.aspx"};r.prototype.getWopiDocUrl=function(){return this.getWebUrl()+"/"+this.getLayoutsUrl()+"/doc.aspx"};r.prototype.getMyRestorePageUrl=function(){var t=this;return this.resources.consumeAsync(n.web).then(function(e){return e.getMyOneDriveUrl()}).then(function(e){return e+"/"+t.getLayoutsUrl()+"/onedrive.aspx?p="+_.default.Restore})};r.prototype.getTextEditorItemUrl=function(e,t){var r=t.itemSet,i=t.viewParams,n=this._getItemQueryParams(e.key,{viewParams:i}),o=r&&r.item.peek(),a=o&&o.key!==e.key&&o||e.parent,s=b.deserializeQuery(a&&a.key||""),u=s.id;if("root"===u){var l=b.deserializeQuery(e.key).listurl;l&&(u=l)}n.parent=u;n.parentview=s.view;n.p=_.default.TextFileEditor;delete n.view;var c="";if(!this._supportsOneUp&&e.parentLink){delete n.parentview;c=e.parentLink;return e.parentLink+"?"+b.serializeQuery(n,null,!0)}Number(i.p)!==_.default.TextFileEditor&&(c=this.getCurrentPageBaseUrl()+window.location.pathname);return c+"#"+b.serializeQuery(n,null,!0)};r.prototype._listContext=function(){var e=this.resources.consume(S.listContext);this._listContext=function(){return e};return e};r.prototype.getWebUrl=function(){return this._pageContext.webAbsoluteUrl};r.prototype.getLayoutsUrl=function(){return this._pageContext.layoutsUrl};r.prototype._getListItemFormUrl=function(e,t){if(!this._listContext().listUrl||!e)return"";var r,i,n;if(t&&t.properties){r=t.properties.ID;i=t.properties.ContentTypeId;n=this.getKeyParams(t.parentKey).id}var o={Source:P.default.encodeURIComponent(window.location.href),RootFolder:P.default.encodeURIComponent(n||this._listContext().folderPath)};r&&(o.ID=r);i&&(o.ContentTypeId=i);var a=new T.default(e);for(var s in o)o.hasOwnProperty(s)&&a.setQueryParameter(s,o[s]);return a.toString()};r.prototype._isTextEditorFile=function(e){return e.parent&&e.type===w.default.File&&p.default.isAllowed(e.extension)&&u.canOpenInMonaco(e.extension)};r.prototype._getItemQueryParams=function(e,t){var r=t.viewParams,i=void 0===r?this._navigation.viewParams:r,n=b.deserializeQuery(e);delete n.u;var o=a.utils.extend({},i);delete o.id;delete o.RootFolder;delete o.view;delete o.q;delete o.listurl;delete o.typeFilters;a.utils.extend(o,n);delete o.parent;delete o.parentview;delete o.p;if(n.id===this.getDefaultRootItemId()){delete o.id;delete o.RootFolder}return o};r.prototype._getMediaUrl=function(e,t){var r=t.params,i=void 0===r?{}:r,n=t.itemSet;if(!this._supportsOneUp){var o=this._itemUrlHelper.getItemUrlParts(e.key),a=o.serverRelativeItemUrl,s=((l={}).id=a,l.parent=a.substring(0,a.lastIndexOf("/")),l);return o.fullListUrl+"?"+b.serializeQuery(s,null,!0)}var u=n?n.item.peek():e.parent;if(!u)return"";var l,c=u&&u.key||"",d=b.deserializeQuery(c);i.parent=d.id;i.parentview=d.view;delete d.id;delete d.view;delete d.u;return"#"+b.serializeQuery(i,d,!0)};r.prototype._updateViewParamsFromWindowName=function(){var e=(new s.default).removeState("ODBParams");e&&this._navigation.updateViewParams(e,{ignoreHistory:!0,clearOtherParams:!1})};r.dependencies=t.__assign({},i.default.dependencies,{navigation:R.navigation,platform:F.platformDetection,pageContext:S.pageContext,itemUrlHelper:U.resourceKey,itemParentHelper:L.resourceKey,useOneUpTextEditor:v.useOneUpTextEditorResourceKey,supportsOneUp:v.supportsOneUpResourceKey});r.DISCOVER_URL_MAIN="/_api/search/query?Querytext=%27%28ContentClass:STS_ListItem_DocumentLibrary%20OR%20ContentClass:STS_ListItem_MySiteDocumentLibrary%29%20AND%20Path%3C%3Enull%20AND%20-FileExtension%3Aone%27&Properties=%27GraphQuery:actor(ME),GraphRankingModel:action%5C:1020%5C,weight%5C:1%5C,edgeFunc%5C:weight%5C,mergeFunc%5C:max,EnableLegacySPOGraph:true%27&RankingModelId=%270c77ded8-c3ef-466d-929d-905670ea1d72%27&rowlimit=%2740%27&selectProperties=%27.mediaBaseUrl%2C.spResourceUrl%2C.callerStack%2C.correlationId%2C.thumbnailUrl%2C.videoManifestUrl%2C.pdfConversionUrl%2CUniqueID%2CPath%2CSecondaryFileExtension%2CFileExtension%2CParentLink%2CSPSiteURL%2CSize%2CDescription%2CCreatedBy%2CCreated%2CModifiedBy%2CLastModifiedTime%2CIsContainer%2CFilename%2CTitle%2CLinkingUrl%2CSharedWithDetails%2CListID%2CSiteID%2CWebId%2CpiPageImpression%2CpiPageImpressionBlockType%2CpiSearchResultId%27";r.DISCOVER_URL_ACTORS="/_api/search/query?SourceId=%27b09a7990-05ea-4af9-81ef-edfab16c4e31%27&Querytext=%27";r.OPTIMIZELY_URL="https://cdn.optimizely.com/js/2874820064";r.placeholderId=0;return r}(i.default);v.default=y;v.resourceKey=r.createResolvedResourceKey(e("module").id,y)});define("g1",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i;(i=r||(r={}))[i.iosappstore=0]="iosappstore";t.default=r});define("g0",["require","exports"],function(e,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.VALUE_KEY="value";var t=function(){function e(){}e.prototype.getState=function(e){return this._getNormalizedWindowName()[e]};e.prototype.setState=function(e,t){var r=this._getNormalizedWindowName();r[e]=t;window.name=JSON.stringify(r)};e.prototype.removeState=function(e){var t=this._getNormalizedWindowName(),r=t[e];delete t[e];window.name=JSON.stringify(t);return r};e.prototype._getNormalizedWindowName=function(){var t,e;try{t=JSON.parse(name)||{}}catch(e){t={}}"object"!=typeof t&&(t=((e={})[r.VALUE_KEY]=t,e));return t};return e}();r.default=t});define("gZ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TEXT_MIME_TYPE="text/plain";var r={abap:t.TEXT_MIME_TYPE,ada:t.TEXT_MIME_TYPE,adp:t.TEXT_MIME_TYPE,ahk:t.TEXT_MIME_TYPE,as:t.TEXT_MIME_TYPE,as3:t.TEXT_MIME_TYPE,asc:t.TEXT_MIME_TYPE,ascx:"text/xml",asm:t.TEXT_MIME_TYPE,asp:t.TEXT_MIME_TYPE,awk:t.TEXT_MIME_TYPE,bash:t.TEXT_MIME_TYPE,bash_login:t.TEXT_MIME_TYPE,bash_logout:t.TEXT_MIME_TYPE,bash_profile:t.TEXT_MIME_TYPE,bashrc:t.TEXT_MIME_TYPE,bat:"text/x-bat",bib:t.TEXT_MIME_TYPE,bsh:"text/x-java",build:t.TEXT_MIME_TYPE,builder:t.TEXT_MIME_TYPE,c:"text/x-cpp","c++":"text/x-c++src",capfile:t.TEXT_MIME_TYPE,cc:"text/x-c++src",cfc:t.TEXT_MIME_TYPE,cfm:t.TEXT_MIME_TYPE,cfml:t.TEXT_MIME_TYPE,cl:t.TEXT_MIME_TYPE,clj:t.TEXT_MIME_TYPE,cls:t.TEXT_MIME_TYPE,cmake:t.TEXT_MIME_TYPE,cmd:"text/x-bat",coffee:"text/coffeescript",cpp:"text/x-cpp",cpt:"text/xml",cpy:t.TEXT_MIME_TYPE,cs:"text/x-csharp",cshtml:"text/x-cshtml",cson:"text/coffeescript",csproj:"text/xml",css:"text/css",ctp:"text/html",cxx:"text/x-c++src",d:t.TEXT_MIME_TYPE,db:t.TEXT_MIME_TYPE,ddl:t.TEXT_MIME_TYPE,di:t.TEXT_MIME_TYPE,dif:t.TEXT_MIME_TYPE,diff:t.TEXT_MIME_TYPE,disco:"text/xml",dml:t.TEXT_MIME_TYPE,dtd:"text/xml",dtml:"text/xml",el:t.TEXT_MIME_TYPE,emakefile:t.TEXT_MIME_TYPE,erb:t.TEXT_MIME_TYPE,erl:t.TEXT_MIME_TYPE,f:t.TEXT_MIME_TYPE,f90:t.TEXT_MIME_TYPE,f95:t.TEXT_MIME_TYPE,fs:"text/x-fsharp",fsi:"text/x-fsharp",fsscript:"text/x-fsharp",fsx:"text/x-fsharp",gemfile:t.TEXT_MIME_TYPE,gemspec:"text/ruby",gitconfig:"text/x-ini",go:t.TEXT_MIME_TYPE,groovy:t.TEXT_MIME_TYPE,gvy:t.TEXT_MIME_TYPE,h:"text/x-cpp","h++":"text/x-c++hdr",haml:t.TEXT_MIME_TYPE,handlebars:"text/x-handlebars-template",hbs:"text/x-handlebars-template",hcp:t.TEXT_MIME_TYPE,hh:"text/x-c++hdr",hpp:"text/x-cpp",hrl:t.TEXT_MIME_TYPE,hs:t.TEXT_MIME_TYPE,htc:"text/javascript",htm:"text/html",html:"text/html",hxx:"text/x-c++hdr",idl:"text/x-c++hdr",iim:t.TEXT_MIME_TYPE,inc:"text/html",inf:t.TEXT_MIME_TYPE,ini:"text/x-ini",inl:"text/x-c++src",ipp:"text/x-c++src",irbrc:t.TEXT_MIME_TYPE,jade:"text/x-jade",jav:"text/x-java-source",java:"text/x-java-source",js:"text/javascript",json:"application/json",jsp:t.TEXT_MIME_TYPE,jsx:"text/javascript",l:t.TEXT_MIME_TYPE,less:"text/x-less",lhs:t.TEXT_MIME_TYPE,lisp:t.TEXT_MIME_TYPE,log:t.TEXT_MIME_TYPE,lst:t.TEXT_MIME_TYPE,ltx:t.TEXT_MIME_TYPE,lua:"text/x-lua",m:t.TEXT_MIME_TYPE,make:t.TEXT_MIME_TYPE,markdn:"text/x-web-markdown",markdown:"text/x-web-markdown",md:"text/x-web-markdown",mdown:"text/x-web-markdown",mkdn:"text/x-web-markdown",ml:t.TEXT_MIME_TYPE,mli:t.TEXT_MIME_TYPE,mll:t.TEXT_MIME_TYPE,mly:t.TEXT_MIME_TYPE,mm:t.TEXT_MIME_TYPE,mud:t.TEXT_MIME_TYPE,nfo:t.TEXT_MIME_TYPE,opml:"text/xml",osascript:t.TEXT_MIME_TYPE,out:t.TEXT_MIME_TYPE,p:t.TEXT_MIME_TYPE,pas:t.TEXT_MIME_TYPE,patch:t.TEXT_MIME_TYPE,php:"application/x-php",php2:"application/x-php",php3:"application/x-php",php4:"application/x-php",php5:"application/x-php",phtml:"text/html",pl:t.TEXT_MIME_TYPE,plist:t.TEXT_MIME_TYPE,pm:t.TEXT_MIME_TYPE,pod:t.TEXT_MIME_TYPE,pp:t.TEXT_MIME_TYPE,profile:t.TEXT_MIME_TYPE,properties:t.TEXT_MIME_TYPE,ps1:"text/x-powershell",pt:"text/xml",py:"text/python",pyw:t.TEXT_MIME_TYPE,r:t.TEXT_MIME_TYPE,rake:t.TEXT_MIME_TYPE,rb:"text/ruby",rbx:t.TEXT_MIME_TYPE,rc:t.TEXT_MIME_TYPE,re:t.TEXT_MIME_TYPE,reg:t.TEXT_MIME_TYPE,rest:t.TEXT_MIME_TYPE,resw:"text/xml",resx:"text/xml",rhtml:t.TEXT_MIME_TYPE,rjs:t.TEXT_MIME_TYPE,rprofile:t.TEXT_MIME_TYPE,rpy:t.TEXT_MIME_TYPE,rss:"text/xml",rst:t.TEXT_MIME_TYPE,rxml:t.TEXT_MIME_TYPE,s:t.TEXT_MIME_TYPE,sass:"text/scss",scala:t.TEXT_MIME_TYPE,scm:t.TEXT_MIME_TYPE,sconscript:t.TEXT_MIME_TYPE,sconstruct:t.TEXT_MIME_TYPE,script:t.TEXT_MIME_TYPE,scss:"text/scss",sgml:"text/xml",sh:t.TEXT_MIME_TYPE,shtml:"text/html",sml:"text/xml",sql:t.TEXT_MIME_TYPE,sty:t.TEXT_MIME_TYPE,t:t.TEXT_MIME_TYPE,tcl:t.TEXT_MIME_TYPE,tex:t.TEXT_MIME_TYPE,text:t.TEXT_MIME_TYPE,textile:t.TEXT_MIME_TYPE,tld:"text/xml",tli:"text/x-c++hdr",tmpl:"text/html",tpl:"text/html",ts:"text/typescript",txt:t.TEXT_MIME_TYPE,vb:"text/x-vb",vi:t.TEXT_MIME_TYPE,vim:t.TEXT_MIME_TYPE,wsdl:"text/xml",xaml:"text/xml",xhtml:"text/html",xml:"text/xml",xoml:"text/xml",xsd:"text/xml",xsl:t.TEXT_MIME_TYPE,xslt:t.TEXT_MIME_TYPE,yaml:t.TEXT_MIME_TYPE,yaws:t.TEXT_MIME_TYPE,yml:t.TEXT_MIME_TYPE,zsh:t.TEXT_MIME_TYPE};function i(e){return((e&&"."===e[0]?e.substring(1):e)||"").toLowerCase()}t.canOpenInMonaco=function(e){return(e=i(e))in r};t.getMimeTypeForExtension=function(e){e=i(e);return r[e]}});define("gY",["require","exports","ba","bb"],function(e,t,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){var r=e.appMap?e.appMap.toLowerCase():void 0,i="ms-powerpoint"===r,n="ms-word"===r,o="ms-visio"===r,a="ms-excel"===r,s=t&&(l.isFeatureEnabled(l.DefaultToDocAspxForPowerpoint)&&i||(!c.default.isActivated("88E16BF7-E8BC-4ABA-ABE7-001818C101E8","04/15/2018","KillSwitchDirectAllTraffic to DocAspx")||l.isFeatureEnabled(l.DocAspxForWord))&&n||l.isFeatureEnabled(l.DefaultToDocAspxForVisio)&&o||l.isFeatureEnabled(l.DocAspxForExcel)&&a),u=!t&&(l.isFeatureEnabled(l.DocAspxForPowerpoint)&&i||(!c.default.isActivated("88E16BF7-E8BC-4ABA-ABE7-001818C101E8","04/15/2018","KillSwitchDirectAllTraffic to DocAspx")||l.isFeatureEnabled(l.DocAspxForWord))&&n||l.isFeatureEnabled(l.DocAspxForVisio)&&o||l.isFeatureEnabled(l.DocAspxForExcel)&&a);return s||u}t.unifiedAppEnabled=r;function i(e){return!!(e&&e.openUrl&&e.appMap)}t.openInOffice=i;t.isUnifiedAppSupportedFile=function(e,t){return!t&&r(e,!0)&&i(e)&&!l.isFeatureEnabled(l.EnablePdfCoversionForAllTypes)}});define("gX",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[".aspx",".ascx",".master",".xsf",".xap",".swf",".jar",".asmx",".htc",".ashx",".json",".soap",".svc",".xamlx"],i=function(){function e(){}e.isAllowed=function(e){return!(0<=r.indexOf(e.toLocaleLowerCase()))};return e}();t.default=i});define("gV",["require","exports","gW"],function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.protocolCommand=s.ProtocolHandlerHelper.protocolCommand;t.createProtocolHandlerUrl=function(e,t,r,i,n,o){var a=s.ProtocolHandlerEncodeOption.none;n&&(a=s.ProtocolHandlerEncodeOption.encodeCommand);return s.ProtocolHandlerHelper.CreateProtocolHandlerUrl(e,t,r,i,a,o)}});define("gW",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;!function(e){e[e.none=0]="none";e[e.encodeUrl=1]="encodeUrl";e[e.encodeCommand=2]="encodeCommand"}(l=t.ProtocolHandlerEncodeOption||(t.ProtocolHandlerEncodeOption={}));var r=function(){function e(){}e.CreateProtocolHandlerUrl=function(e,t,r,i,n,o){var a=[],s=e.split("|");if(2===s.length){a.push(s[0]);a.push(":");a.push(t);return a.join("")}3===s.length&&(e=s[0]);a.push(e);a.push(":");a.push(r);o&&"ms-excel"===e&&r!==this.protocolCommand.New&&a.push(n===l.encodeCommand?"%7Cofc":"|ofc");a.push(n===l.encodeCommand?"%7Cu%7C":"|u|");a.push(t);if(r===this.protocolCommand.New){a.push(n===l.encodeCommand?"%7Cs%7C":"|s|");a.push(i)}var u=a.join("");return n===l.encodeUrl?encodeURI(u):u};e.protocolCommand={View:"ofv",Edit:"ofe",New:"nft"};return e}();t.ProtocolHandlerHelper=r;t.default=r});define("gU",["require","exports"],function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.CheckOutUserProperty="CheckedOutUserId";function r(e){return!!e.properties[i.CheckOutUserProperty]}i.isCheckedOut=r;function n(e,t){var r=Number(t);return!isNaN(r)&&Number(e.properties[i.CheckOutUserProperty])===r}i.isCheckedOutByUser=n;i.isCheckedOutByOther=function(e,t){return r(e)&&!n(e,t)}});define("gT",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.none=0]="none";e[e.locate=1]="locate";e[e.defaultClick=2]="defaultClick";e[e.download=3]="download";e[e.share=4]="share";e[e.sharing=5]="sharing";e[e.sendSurvey=6]="sendSurvey";e[e.createTextDocument=7]="createTextDocument";e[e.createWord=8]="createWord";e[e.createExcel=9]="createExcel";e[e.createExcelForm=10]="createExcelForm";e[e.createPowerPoint=11]="createPowerPoint";e[e.createOneNote=12]="createOneNote";e[e.openInExcel=13]="openInExcel";e[e.openInWord=14]="openInWord";e[e.openInPowerPoint=15]="openInPowerPoint";e[e.openInOneNote=16]="openInOneNote";e[e.openInVisio=17]="openInVisio";e[e.openInProject=18]="openInProject";e[e.openInPublisher=19]="openInPublisher";e[e.openInOffice=20]="openInOffice";e[e.embed=21]="embed";e[e.reportAbuse=22]="reportAbuse";e[e.addToShared=23]="addToShared";e[e.editBrowser=24]="editBrowser";e[e.feedback=25]="feedback";e[e.versionHistory=26]="versionHistory"}(r=t.AutoActionType||(t.AutoActionType={}));t.ACTION_MAPPING={};for(var i in r)if("number"==typeof r[i]){var n=i,o=r[n];t.ACTION_MAPPING[n.toLowerCase()]=o}t.default=r});define("gR",["require","exports","gS"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WopiHelper=r.WopiHelper});define("gS",["require","exports","cZ","ej"],function(e,t,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function n(){}n.AddWopiPerfMarkToTargetUrl=function(e,t,r){try{var i=new a.default(r);i.setQueryParameter(n.param_CT,e,!0);i.setQueryParameter(n.param_OR,t,!0);return i.toString()}catch(e){}};n.AddWopiPerfMark=function(e,t,r){try{if("sessionStorage"in window&&window.sessionStorage){if(r){var i=decodeURIComponent(r),n=i&&i.indexOf("sourcedoc=");if(-1!==n){var o=i.substring(n).indexOf("&"),a=-1===o?i.substring(n):i.substring(n,n+o);a=escape(a);window.sessionStorage["WOPIPerf_UserClick_"+a]=t}}window.sessionStorage.WOPIPerf_UserClickOrigin=e}}catch(e){}};n.GetWopiFrameEditUrl=function(e){if(e.properties["serverurl.progid"]){var t="action=interactivepreview",r=e.properties.ServerRedirectedEmbedUrl;r&&(r="ms-visio"!==e.appMap&&"ms-excel"!==e.appMap&&o.default.hasItemPermission(e,o.default.editListItems)?r.replace(t,"action=edit"):r.replace(t,"action=default"));return r}return""};n.GetWopiDocEditUrl=function(e,t,r){if(e.properties["serverurl.progid"]){var i="action=interactivepreview",n=e.properties.ServerRedirectedEmbedUrl;if(n){n=this.ReplaceToDocAspx(n,e,t,r);n="ms-visio"!==e.appMap&&"ms-excel"!==e.appMap&&o.default.hasItemPermission(e,o.default.editListItems)?n.replace(i,"action=edit"):n.replace(i,"action=default")}return n}};n.ReplaceToDocAspx=function(e,t,r,i){e=e.replace("/WopiFrame.aspx?","/doc.aspx?");var n=new a.default(e);n.setQueryParameter("uid",t.properties.UniqueId);n.setQueryParameter("ListItemId",t.properties.ID);n.setQueryParameter("ListId",r);n.setQueryParameter("odsp","1");i&&0<i.length&&n.setQueryParameter("env",i);return n.toString()};n.param_CT="CT";n.param_OR="OR";return n}();t.WopiHelper=r;t.default=r});define("ep",["require","exports","ap","aG","aG"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t);t.default=n.default});define("gQ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.any=0]="any";e[e.file=1]="file";e[e.folder=2]="folder";e[e.media=3]="media";e[e.photo=4]="photo";e[e.video=5]="video";e[e.document=6]="document";e[e.audio=7]="audio";e[e.word=8]="word";e[e.powerpoint=9]="powerpoint";e[e.excel=10]="excel";e[e.onenote=11]="onenote";e[e.zip=12]="zip";e[e.pdf=13]="pdf";e[e.text=14]="text"}(t.ItemTypeFilter||(t.ItemTypeFilter={}))});define("gP",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FiltersPaneEvents={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged"};!function(e){e[e.user=0]="user";e[e.date=1]="date";e[e.fileType=2]="fileType";e[e.choice=3]="choice";e[e.hierarchy=4]="hierarchy"}(t.FilterSectionType||(t.FilterSectionType={}));!function(e){e[e.none=0]="none";e[e.last3Months=1]="last3Months";e[e.last30Days=2]="last30Days";e[e.last7Days=3]="last7Days";e[e.yesterday=4]="yesterday";e[e.today=5]="today";e[e.tomorrow=6]="tomorrow";e[e.next7Days=7]="next7Days";e[e.next30Days=8]="next30Days";e[e.next3Months=9]="next3Months";e[e.nextYear=10]="nextYear"}(t.DateTimeSliderValue||(t.DateTimeSliderValue={}))});define("gK",["require","exports","ap","gL","gL"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(n,t);t.getFolderNameFromPath=function(e){var t=e.lastIndexOf("/");return 0<=t?e.substring(t+1):e};t.getSharePointPath=function(e){return decodeURI(e)};t.canonicalizeUrl=function(t){var r;try{r=decodeURI(t)}catch(e){r=t}return t=r===t?i.encodePath(t,!0):t.replace("#","%23")};t.canonicalizeDecodedUrl=function(e){e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23"));return e}});define("gL",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.splitFileName=function(e){var t=r(e);return{name:t?e.substring(0,e.length-t.length):e,extension:t}};function r(e,t){void 0===t&&(t=!1);var r="";if(e){var i=e.lastIndexOf(".");0<=i&&(r=t?e.substr(i+1):e.substr(i))}return r}t.getFileExtension=r;t.encodePath=function(e,t){void 0===t&&(t=!0);e=encodeURI(e);t&&e&&(e=e.replace(/#/g,"%23"));return e}});define("gO",["require","exports","cY"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertToISPListItem=function(e){return e};t.convertToIOneDriveItem=function(e){return e};t.canListItemBeOpened=function(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&4!==e.itemStatus&&3!==e.itemStatus&&r.PermissionMask.hasItemPermission(e,r.PermissionMask.openItems)}});define("ix",["require","exports","ap","V","bN"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.FIRST_PARM_FORMAT="{0}?{1}";return e}e.prototype.getPath=function(){return i.format(this.FIRST_PARM_FORMAT,e.APP_PATH_PRE_FIX,e.APP_PATH_POST_FIX)};e.prototype.getStorePath=function(){return"https://itunes.apple.com/us/app/onedrive/id477537958?mt=8"};e.APP_PATH_PRE_FIX="ms-onedrive://";e.APP_PATH_POST_FIX="from=web";return e}(n.default);t.default=o});define("iw",["require","exports","ap","bN","aC","eO","dZ","cY","fZ","fO","gl","bi","iJ","eA","ba"],function(e,t,i,r,o,a,n,s,u,l,c,T,d,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h="/_layouts/15/userphoto.aspx?size=S&accountname=",m=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._urlDataSource=t.resources.consume(n.url);t._itemsStore=t.resources.consume(d.resourceKey);t._apiUrlHelper=t.resources.consume(u.resourceKey);t._itemUrlHelper=t.resources.consume(l.resourceKey);t._itemParentHelper=t.resources.consume(p.resourceKey);t._dataRequestor=new(t.child(c.typeResourceKey))({qosName:"ItemActivityDataSource"});return t}e.prototype.getItemActivities=function(t,r,i){var n=this;return s.PermissionMask.hasItemPermission(t,s.PermissionMask.openItems)?f.isFeatureEnabled(f.UseActivitiesApi)?this._dataRequestor.getData({url:this._getItemNewActivitiesUrl(t,i,r),qosName:"Activities"}).then(function(e){return n._transformNewActivitiesData(e,t)}):this._dataRequestor.getData({url:this._getItemActivitiesUrl(t,i),qosName:"GetChanges",additionalPostData:this._constructPostBody(r)}).then(function(e){return n._transformData(e,r,i,t)}):o.default.wrap(new Array)};e.prototype._getItemActivitiesUrl=function(e,t){var r=this._itemUrlHelper.getItemUrlParts(e.key),i=this._apiUrlHelper.build().webByItemUrl(r);if(e.type===a.default.Folder&&!e.isRootFolder&&t)i=i.method("GetFolderByServerRelativeUrl",r.serverRelativeItemUrl).segment("GetListItemChanges");else{i=i.method("GetList",r.serverRelativeListUrl);i=e.isRootFolder?i.segment("RootFolder").segment("GetListItemChanges"):i.method("Items",e.properties.ID).segment("GetChanges")}return(i=i.oDataParameter("$Expand","RelativeTime")).toString()};e.prototype._getItemNewActivitiesUrl=function(e,t,r){var i=this._itemUrlHelper.getItemUrlParts(e.key),n=this._apiUrlHelper.build().webByItemUrl(i);if(e.type===a.default.Folder&&!e.isRootFolder&&t)n=n.method("GetFolderByServerRelativeUrl",i.serverRelativeItemUrl);else{n=n.method("GetList",i.serverRelativeListUrl);e.isRootFolder||(n=n.method("Items",e.properties.ID))}return(n=n.segment("Activities").parameter("$top",r.fetchLimit)).toString()};e.prototype._transformData=function(e,t,r,i){for(var n,o=e.d.results,a=[],s=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(i,"list")),u=this._itemUrlHelper.getItemUrlParts(i.key),l=0;l<o.length;l++){var c=o[l],d=c.ItemId,p=c.ServerRelativeUrl,f=this._itemUrlHelper.getUrlParts({path:p,listUrl:u.fullListUrl}),h=this._urlDataSource.getKey(((n={}).id=f.serverRelativeItemUrl,n.listurl=f.normalizedListUrl,n)),m=new T.default(f.webRelativeItemUrl),g=this._mapActivityChangeType(c.ChangeType);if(0!==g){var y=this._getSharedWith(c,g),v=this._getEditor(c,g),_={id:d,changeToken:c.ChangeToken.StringValue,date:new Date(c.Time),relativeTime:c.RelativeTime,editor:v,itemActivityChangeType:g,latestName:!s||s.list.isDocumentLibrary?this._getFileName(m):this._getListItemName(h),latestFolder:this._getFolderPath(m),sharedWith:y,type:0,navigateToOptions:5!==g?this._getNavigateToOptions(h,s):void 0,serverRelativeUrl:p};if(l===o.length-1){o.length<t.fetchLimit&&a.push(_);break}if(!r){var b=o[l+1].ServerRelativeUrl,S=this._itemUrlHelper.getUrlParts({path:b,listUrl:u.fullListUrl}),w=new T.default(S.webRelativeItemUrl);_.previousName=this._getFileName(w);_.previousFolder=this._getFolderPath(w)}6===g&&(r?_.itemActivityChangeType=7:_.previousFolder!==_.latestFolder&&(_.itemActivityChangeType=4));a.push(_)}}return a};e.prototype._transformNewActivitiesData=function(e,t){for(var r,i=e.d.results,n=[],o=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list")),a=this._itemUrlHelper.getItemUrlParts(t.key),s=0,u=i;s<u.length;s++){var l=u[s],c=void 0,d=void 0;if(l.resource){c=l.resource.itemId;d=l.resource.serverRelativePath.DecodedUrl}else{c=parseInt(t.itemId,10);d=a.serverRelativeItemUrl}var p=this._itemUrlHelper.getUrlParts({path:d,listUrl:a.fullListUrl}),f=this._urlDataSource.getKey(((r={}).id=p.serverRelativeItemUrl,r.listurl=p.normalizedListUrl,r)),h=new T.default(p.webRelativeItemUrl),m=this._mapNewActivityType(l);if(0!==m){var g=this._getActor(l),y={id:c,changeToken:l.id,date:new Date(l.times.recordedTime),editor:g,itemActivityChangeType:m,latestName:!o||o.list.isDocumentLibrary?this._getFileName(h):this._getListItemName(f),latestFolder:this._getFolderPath(h),type:0,navigateToOptions:5!==m?this._getNavigateToOptions(f,o):void 0,serverRelativeUrl:d};6===m&&(y.previousName=l.action.rename.oldName);n.push(y)}}return n};e.prototype._getNavigateToOptions=function(e,t){var r,i=this.peekUnwrapObservable(this._itemsStore.getItem(e));if(t&&t.list.isDocumentLibrary)r=i?{url:this._urlDataSource.getDefaultClickUrl(i)}:{url:this._urlDataSource.getItemUrl(e)};else if(i){r={url:this._urlDataSource.getDisplayFormUrl(i),frameId:"_blank"}}return r};e.prototype._getSharedWith=function(e,t){var r=[];if(9===t)if(e.SharedWithUsers&&e.SharedWithUsers.Items&&e.SharedWithUsers.Items.results){(i=e.SharedWithUsers.Items.results)&&r.push.apply(r,this._createSharedWith(i))}else if(e.SharedWithUsersHint&&e.SharedWithUsersHint.results){var i;if(i=e.SharedWithUsersHint.results)for(var n=0;n+1<i.length;n+=2){var o={email:i[n+1],name:i[n],image:h+i[n+1],userId:"invalid"};r.push(o)}}return r};e.prototype._getEditor=function(e,t){return 9===t&&e.SharedByUser?{email:e.SharedByUser.Email,name:e.SharedByUser.Name,image:h+e.SharedByUser.Email,userId:"invalid"}:{email:e.EditorEmailHint,name:e.Editor,image:h+e.EditorEmailHint,userId:"invalid"}};e.prototype._getActor=function(e){var t=e.actor,r=t.email;return{email:r,name:t.name,image:h+r,userId:"invalid"}};e.prototype._createSharedWith=function(e){return e.map(function(e){return{email:e.Email,name:e.Name,image:h+e.Email,userId:"invalid"}})};e.prototype._getFolderPath=function(e){return"/"+e.segments.slice(0,-1).join("/")};e.prototype._getFileName=function(e){return e.segments[e.segments.length-1]};e.prototype._getListItemName=function(e){var t=this.peekUnwrapObservable(this._itemsStore.getItem(e));return t?t.name:"a list item"};e.prototype._mapActivityChangeType=function(e){var t;switch(e){case 1:t=1;break;case 2:t=3;break;case 3:t=5;break;case 4:t=6;break;case 7:t=8;break;case 11:t=9;break;case 0:t=12;break;default:t=0}return t};e.prototype._mapNewActivityType=function(e){return e.action.create?1:e.action.edit?3:e.action.rename?6:e.action.comment?2:e.action.version?11:0};e.prototype._constructPostBody=function(e){var t=""+(e.fetchLimit+1),r={query:{Add:e.add,DeleteObject:e.deleteObject,FetchLimit:t,Group:e.group,Item:e.item,LatestFirst:e.latestFirst,Move:e.move,Rename:e.rename,Restore:e.restore,RoleAssignmentAdd:e.roleAssignmentAdd,RoleDefinitionAdd:e.roleDefinitionAdd,Update:e.update,User:e.user}};return JSON.stringify(r)};return e}(r.default);t.default=m});define("iv",["require","exports","ap","bN","dZ"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._dataSource=t.resources.consume(n.itemActivity);return t}e.prototype.getItemActivities=function(e,t,r){return this._dataSource.getItemActivities(e,t,r)};return e}(r.default);t.default=o});define("iu",["require","exports","bi"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=((this._pageContext=e)&&new r.default(e.webAbsoluteUrl)).authority;this._itemUrlBase=t+this._pageContext.listUrl}e.prototype.getActivityItemUrl=function(e){var t=e&&e.driveItem;return t&&t.webUrl?t.webUrl:t&&e&&void 0!==e.relativePath?this._itemUrlBase+e.relativePath:void 0};e.prototype.getPageContextForRenderUser=function(){return this._pageContext};return e}();t.default=i});define("is",["require","exports","it"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=r.SUITE_NAV_LINK_IDS});define("it",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SUITE_NAV_LINK_IDS={CUSTOM_SETTINGS_1:"WorkloadSettingsSubLinks1",CUSTOM_SETTINGS_2:"WorkloadSettingsSubLinks2",CUSTOM_SETTINGS_3:"WorkloadSettingsSubLinks3",FEEDBACK:"ShellFeedback",DIAGNOSTICS:"Diagnostics",O365_SETTINGS:"ShellO365Settings",ADD_APP:"SuiteMenu_zz5_MenuItemCreate",SITE_CONTENTS:"SuiteMenu_zz6_MenuItem_ViewAllSiteContents",SITE_SETTINGS:"SuiteMenu_zz7_MenuItem_Settings",SITE_INFORMATION:"SuiteMenu_MenuItem_SiteInformation",SITE_PERMISSIONS:"SuiteMenu_MenuItem_SitePermissions",HUB_SETTINGS:"SuiteMenu_MenuItem_HubSettings",USER_ACTIVITY:"UserActivity",LIBRARY_SETTINGS:"SuiteMenu_LibrarySettings",LANGUAGE:"SuiteMenu_Language",CHANGE_THE_LOOK:"Change_The_Look",ABOUT_ME:"ShellAboutMe",SETTINGS:"ShellSettings",MY_SETTINGS:"SuiteMenu_zz2_ID_PersonalInformation",SIGN_OUT:"ShellSignout",HELP:"HelpLink",COMMUNITY:"ShellCommunity",PRIVACY:"ShellPrivacy",LEGAL:"ShellLegal",USERVOICE:"UserVoice",FIRSTRUN:"FirstRun",DEVELOPERS:"Developers",ABUSE:"ReportAbuse",IMPRESSUM:"Impressum",MAIL:"ShellMail",CALENDAR:"ShellCalendar",PEOPLE:"ShellPeople",ONEDRIVE:"ShellDocuments",WORD:"ShellWordOnline",EXCEL:"ShellExcelOnline",POWERPOINT:"ShellPowerPointOnline",ONENOTE:"ShellOneNoteOnline",SITES:"ShellSites",YAMMER:"ShellYammer",TASKS:"ShellTasks",POWER_BI:"ShellPowerBI",DELVE:"ShellOfficeGraph",VIDEO:"ShellVideo",ALCHEMY:"ShellAlchemy",SMILE:"ShellSendASmile"};t.ISuiteNavLinkIds=t.SUITE_NAV_LINK_IDS});define("hz",["require","exports","ap","ir","hc","bs","eM","iq","ip","eq","in","dH","eO","ey","iJ","ep","cY","dZ","iE","aC","c7","aM","ba","aZ","im","cE","aI","cb","ei","el","V","id","h8","h7","eT","eS","fO","h4","bd","h3","h2","h1","h0","hZ","hY","hX","hW","hV","hU","dJ","hL","b9","aP","hI","bo","bp","bn","iD","ej","hD","hC","hB","bX","fZ","fO","eA","bb","gt","eu","hA"],function(o,e,de,pe,t,g,a,f,h,s,d,fe,p,he,m,y,v,w,me,_,u,E,ge,ye,l,ve,b,r,S,T,C,x,I,P,_e,D,k,U,R,F,A,i,n,O,L,M,N,q,V,B,be,Se,H,K,j,G,z,W,X,Q,J,Y,Z,$,ee,te,re,ie,ne,we){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var oe=new XMLSerializer,ae="__next__",se="fieldCustomizers",c=function(c){de.__extends(e,c);function e(e){void 0===e&&(e={});var t=this,r=e.itemsStore,i=e.useFolderScopedSearch,n=void 0===i||i,o=e.pageContext;(t=c.call(this,o)||this)._itemsStore=r||t.resources.consume(m.resourceKey);var a=new b.Qos({name:t.getDataSourceName()+".constructor"});ne.ABExperiment.Init(t._pageContext);try{t.apiUrlHelper=t.resources.consume($.resourceKey);t.itemUrlHelper=t.resources.consume(ee.resourceKey);t.itemParentHelper=t.resources.consume(te.resourceKey);t._useFolderScopedSearch=n;t._alwaysRenderFilesTitle=e.listShouldRenderFilesTitle;t._urlDataSource=t.resources.consume(w.url);t._engagement=t.resources.consume(ve.resourceKey);t._microServiceDataSource=t.resources.consume(w.microService);t._listDataSource=t.resources.consume(Q.resourceKey);t._showNewRecentOverride=ge.isFeatureEnabled(ge.ForceNewRecentUX)||ge.isFeatureEnabled(ge.DemoTenantForceMruVariation);if(e.listContext)t._listContext=e.listContext;else{t._listContext={};t._initListContext(e)}t.resources.isExposed(me.listContext)||t.resources.expose(me.listContext,t._listContext);t._itemsPerGroup=t.createObservable(-1);t.resources.isExposed(me.itemsPerGroup)||t.resources.expose(me.itemsPerGroup,t._itemsPerGroup);t.resources.isExposed(Z.disableShareHeroCommand)||t.resources.expose(Z.disableShareHeroCommand,!(ge.isFeatureEnabled(ge.EnableUpdatedFilesListView)&&ge.isFeatureEnabled(ge.FlipOnNewGridAndListExperiment)));var s=[t._urlDataSource.getRootItemKey(fe.default.Files),t._urlDataSource.getRootItemKey(fe.default.Recent),t._urlDataSource.getRootItemKey(fe.default.SharedWithMe),t._urlDataSource.getRootItemKey(fe.default.RecycleBin)],u=new(t.resources.consume(_e.resourceKey));u.update(s.map(function(e){return new D.default(e).succeed({item:{key:e,type:p.default.Folder,isRootFolder:!0}})}));u.flush();t._listItemBuilder=t.resources.consume(x.resourceKey);t._listItemResultProcessor=t.resources.consume(I.resourceKey);t._subsiteItemResultProcessor=t.resources.consume(P.resourceKey);t.resources.isExposed(w.identity)&&(t._userIsAnonymous=t.resources.consume(w.identity).getIdentity().type===v.IdentityType.anonymous);a.end({resultType:b.ResultTypeEnum.Success})}catch(e){var l=void 0;l=e.message?e.message+" "+e.stack:"object"==typeof e?JSON.stringify(e):e;a.end({resultType:b.ResultTypeEnum.Failure,error:l})}return t}e.prototype.restoreAll=function(e){return null};e.prototype.createMountPoint=function(e){return null};e.prototype.removeMountPoint=function(e){return _.default.wrap(!1)};e.prototype.changeFolderType=function(e){return null};e.prototype.saveSortOrder=function(e){return null};e.prototype.addCoverPhotos=function(e){return null};e.prototype.removeCoverPhotos=function(e){return null};e.prototype.getOpenInClientDetails=function(e){return null};e.prototype.removeFromRecent=function(e){return _.default.wrap(!1)};e.prototype.rotateItems=function(e){return _.default.wrap()};e.prototype.updateBundle=function(e){return null};e.prototype.reportAbuse=function(e){return null};e.prototype.requestReview=function(e){return null};e.prototype.updateItemOcrInfo=function(e,t,r){return null};e.prototype.getItemOcrTextContent=function(e){return _.default.wrap("")};e.prototype.updateItemProperty=function(e){return null};e.prototype.redeemPermissionToken=function(e){return _.default.wrap(null)};e.prototype.updateViewCount=function(e){return _.default.wrap(null)};e.prototype.processReferral=function(e,t){return null};e.prototype.updateListContext=function(e){this._initListContext({listFullUrl:e})};e.prototype.getItem=function(t){function e(e){return e.then(function(e){return e.getItem(t)})}var r=this._urlDataSource.getKeyParams(t.parentKey),i=this._urlDataSource.getQueryType(r);t.qosName=t.qosName||"Odb."+fe.default[i]+".ListItemsDataSource.getItem";switch(i){case fe.default.RecycleBin:case fe.default.SecondStageRecycleBin:return e(this._getRecycleBinDataSource());case fe.default.Discover:return ge.isFeatureEnabled(ge.EnableDiscoverUxWithMicroservice)?e(this.resources.consumeAsync(w.trendingDocs.bypass)):e(this._getSearchDataSource());case fe.default.Search:return this._useFolderScopedSearch?this._getItem(t):e(this._getSearchDataSource());case fe.default.SharedWithMe:return e(this._pageContext.groupId?this._getSharedItemDataSource():this._getVroomSharedItemDataSource());case fe.default.SharedByMe:case fe.default.DocsInCommon:return e(this._getSharedItemDataSource());case fe.default.Recent:var n=!1;if(ge.isFeatureEnabled(ge.EnableNewRecentUX))if(this._showNewRecentOverride)n=!0;else{n=new ne.ABExperiment({name:"MruRecent",startDate:"2/13/2018"}).IsExperimentOn()}if("21"===this._pageContext.webTemplate){this.resources.consume(Z.isInNewRecentView)(n)}return e(n?this.resources.consumeAsync(J.resourceKey.bypass):this.resources.consumeAsync(A.resourceKey.bypass));case fe.default.Popular:case fe.default.RecentUnpopular:return e(this.resources.consumeAsync(F.resourceKey.bypass));case fe.default.DocumentLibraries:return e(this.resources.consumeAsync(O.resourceKey.bypass));case fe.default.Subsites:return e(this.resources.consumeAsync(L.resourceKey.bypass));default:return this._getItem(t)}};e.prototype.getSpecifiedItems=function(e){var a=this,t={parentKey:e.parentKey||this._urlDataSource.getDefaultRootItemId(),itemKeys:e.itemKeys,recurseInFolders:e.recurseInFolders,getRootFolderFromParentKey:e.getRootFolderFromParentKey,viewId:null,needContentTypes:e.needContentTypes,itemSetKey:""},s=de.__assign({itemIds:null,recurseInFolders:!1,folderPath:null},this._listContext);this._listContext.itemIds=e.itemKeys;this._listContext.recurseInFolders=e.recurseInFolders;this._listContext.needSchema=!!e.needSchema;this._listContext.needForm=!!e.needForm;this._listContext.isGrouped=!1;this._listContext.group=null;this._listContext.groupBy=null;this._listContext.groupByOverride=null;this._listContext.groupLevel=null;this._listContext.groupSchema=null;this._listContext.isGrouped=!1;this._listContext.lastGroup=null;this._listContext.viewResult=null;this._listContext.viewIdForRequest=null;this._listContext.viewXmlForRequest=null;this._listContext.filterParams="";this._listContext.sortField=null;this._listContext.searchTerm=null;this._listContext.requestToken=null;t.parentKey&&(this._listContext.folderPath=this._getFolderPath(t.parentKey));var u=new b.Qos({name:this.getDataSourceName()+".GetSpecifiedItems"});return this._getItemInternal(t).then(function(e){e.children&&e.children[0]?u.end({resultType:b.ResultTypeEnum.Success}):u.end({resultType:b.ResultTypeEnum.Failure,resultCode:"ItemNotFound"});for(var t=0,r=Object.keys(s);t<r.length;t++){var i=r[t];a._listContext[i]=s[i]}return e},function(e){u.end({resultType:b.ResultTypeEnum.Failure,resultCode:"ServerError",extraData:{error:e}});for(var t,r=0,i=Object.keys(a._listContext);r<i.length;r++){t=i[r];a._listContext[t]=null}for(var n=0,o=Object.keys(s);n<o.length;n++){t=o[n];a._listContext[t]=s[t]}return e})};e.prototype.getFilterData=function(e,t,r,i){if(this._urlDataSource.isCurrentQuery(fe.default.SharedWithMe))return _.default.wrap();var n=this._urlDataSource.getCurrentItemKey(B.deserializeQuery(t)),o=this._getFolderPath(n);return new K.ListFilterDataSource({parentKey:n,listContext:this._listContext,pageContext:this._pageContext,folderPath:o,itemUrlHelper:this.itemUrlHelper,apiUrlHelper:this.apiUrlHelper}).getFilterData(e,t,r,i)};e.prototype.createDocument=function(t,r,i,n){return this._getDeferredDataSource().then(function(e){return e.createDocument(t,r,i,n)})};e.prototype.createCustomDocument=function(t,r,i){return this._getDeferredDataSource().then(function(e){return e.createCustomDocument(t,r,i)})};e.prototype.createFolder=function(t){return this._getDeferredDataSource().then(function(e){return e.createFolder(t)})};e.prototype.deleteItems=function(t){return this._getRecycleBinDataSource().then(function(e){return e.deleteItems(t)})};e.prototype.moveItems=function(t){return this._getDeferredDataSource().then(function(e){return e.moveItems(t)})};e.prototype.copyItems=function(t){return this._getDeferredDataSource().then(function(e){return e.copyItems(t)})};e.prototype.getWorkProgress=function(t){return this._getDeferredDataSource().then(function(e){return e.getWorkProgress(t)})};e.prototype.cancelWork=function(t){return this._getDeferredDataSource().then(function(e){return e.cancelWork(t)})};e.prototype.restoreItems=function(t){return this._getRecycleBinDataSource().then(function(e){return e.restoreItems(t)})};e.prototype.renameItem=function(t){return this._getDeferredDataSource().then(function(e){return e.renameItem(t)})};e.prototype.removeFromSharedList=function(t){return this._getDeferredDataSource().then(function(e){return e.removeFromSharedList(t)})};e.prototype.getDataSourceName=function(){return"ListItemDataSource"};e.prototype.needsRequestDigest=function(e){return!this._isRequestingListViewData(e)};e.prototype._isRequestingListViewData=function(e){return new RegExp("web/.*?/RenderListDataAsStream").test(e)};e.prototype._getPostDataContext=function(e){var t=!!this._listContext.needSchema||!this._listContext.listSchema||this._listContext.isGrouped&&!this._isExpandingGroup()||e.isGrouped,r=!!e.needContentTypes||!!this._listContext.needContentTypes,i=this._needsQuickLaunch();this._isFirstGroupOnlyQuery=!this._supportsNestedGroups&&0===this._listContext.groupLevel&&this._listContext.groupBy&&1<this._listContext.groupBy.length;var n=!1;if(e.parentKey&&this.resources.isExposed(w.spotlight)&&!this._isSpecifiedItemRequest()){var o=this._listContext.viewIdForRequest;n=this.resources.consume(w.spotlight).shouldFetchSpotlight(e.parentKey,o,this._listContext)}var a=!!this._listContext.viewIdForRequest&&!this._listContext.viewResult,s=this._userIsAnonymous,u=this._fetchNextGroup(),l=e.additionalFiltersXml;if(u){var c=R.getFilterXmlToFetchNextGroup(this._listContext.lastGroup);if(this._listContext.viewXmlForRequest){var d=j.getViewDomParts(this._listContext.viewXmlForRequest);if(d&&d.where){var p=d.where.innerHTML?G.combineFilters([d.where.innerHTML,c]):c,f=C.format("<{0}>{1}</{0}>",z.CamlTags.where,p),h=oe.serializeToString(d.where);this._listContext.viewXmlForRequest=this._listContext.viewXmlForRequest.replace(h,f)}}else l=l?"<And>"+l+c+"</And>":c}return{needsSchema:t,needsContentTypes:r,needsForms:!!this._listContext.needForm,needsQuickLaunch:i,needsSpotlight:n,needsViewMetadata:a,needsParentInfo:s,viewXml:this._getViewXml(),firstGroupOnly:this._isFirstGroupOnlyQuery,expandGroups:this._expandGroup,allowMultipleValueFilterForTaxonomyFields:!!this._pageContext.isSPO||void 0,fieldNames:this._listContext.fieldNames,requestToken:this._listContext.requestToken,isListDataRenderOptionChangeFeatureEnabled:ge.isFeatureEnabled(ge.ListDataRenderOptionChange),isSpotlightFeatureEnabled:ge.isFeatureEnabled(ge.Spotlight),groupByOverride:this._listContext.groupByOverride,requestDatesInUtc:Number(this._pageContext.webTemplate)===y.WebTemplateType.mySite&&ge.isFeatureEnabled(ge.RequestDatesInUtc),needUpdatePageContext:!!this._listContext.needUpdatePageContext,needClientSideComponentManifest:!1,groupReplace:!!this._groupReplace,additionalFiltersXml:l,webId:e.webId,siteId:e.siteId}};e.prototype._processData=function(e,t,r){Se.default.mark("EUPL.ListItemDataSource.ProcessData.Start");var i,n=e.parentKey,o=r.ListData||r,a=o.Row,s=this._urlDataSource.getKeyParams(n),u=s.id,l=this._listContext.listSchema,c=r.ListContenTypes,d=this.resources.consume(me.onePageContext.optional),p=d&&d.handleOnePageNavigationFallback,f=null;e.itemSetKey&&(i=this._itemsStore.getItemSet(e.itemSetKey));r.ListSchema&&(f=r.ListSchema.CustomFormatter);var h=r.NewExperienceRendering,m=void 0===h||h,g=r.ListSchema;if(!m&&p){p("modern UX is not supported");throw{code:"-4, onePageNavigationError"}}r.PageContextInfo&&this._updatePageContextInfo(r.PageContextInfo);be.ListItemBuilderHelpers.updateListContext(r,this._listContext);if(g){var y={};l=this._listContext.listSchema=pe.default.getListSchema(g,this.resources,y,this._listContext.listTemplateType===he.ListTemplateType.mySiteDocumentLibrary,this._listContext,e);g.group1&&(this._listContext.groupSchema=y)}else i&&i.schema&&i.schema.peek()&&(l=this._listContext.listSchema=i.schema.peek());r.Navigation&&(this._listContext.leftNavigationData={quickLaunchNodes:r.Navigation.Nodes});if(r.ViewMetadata&&d){var v=this._listContext.viewResult.serverRelativeUrl,_=this._listContext.viewResult.id,b=d.newTargetListViewUrl,S=d.newTargetListViewId;if(v&&b&&-1===b.toLowerCase().indexOf(v.toLowerCase())&&_&&S!==_&&p){p("view does not match");throw{code:"-4, onePageNavigationError"}}d.newTargetListViewId=d.newTargetListViewUrl=void 0}var w=g&&"TRUE"===g.Collapse,T=!w&&a?a.slice(0):[];u&&u!==this._urlDataSource.getDefaultRootItemId()||(u=this._listContext.listUrl);var C="";o.NextHref&&(C=(C=o.NextHref).replace("&View="+ye.default.Empty,""));var x=new(this.resources.consume(_e.resourceKey));this._processResponse({response:r,observer:x,requestKey:n});var I={id:s.id,folder:{childCount:T.length,children:T},nextRequestToken:C,PermMask:o.FolderPermissions,groups:w?a:null,isRootFolder:!1};if(we.isTeamChannelBannerEnabled()){var P=r&&r.ListData&&r.ListData.CurrentFolderProgId;I.ProgId=P}t===fe.default.Search&&this.resources.consume(ve.resourceKey).logData({name:"Search.InpageNumResults",extraData:{count:T.length}});var E=null;if(this._listContext.groupByOverride)E=[this._listContext.groupByOverride];else if(this._listContext.rawListSchema&&this._listContext.rawListSchema.group1){(E=[]).push(this._listContext.rawListSchema.group1);this._listContext.rawListSchema.group2&&E.push(this._listContext.rawListSchema.group2);this._isFirstGroupOnlyQuery||(this._listContext.groupBy=E)}this._listContext.groupLevel=this._getGroupLevel();this._listContext.isGrouped=!!E;1===e.groupingType&&(E=["__ItemType"]);if(this.resources.isExposed(me.contentTypes)){var D=this.resources.consume(me.contentTypes);c?D(c):c=D.peek()}if(l&&c){for(var k={},U=0,R=l;U<R.length;U++){var F=R[U];k[F.internalName]=de.__assign({},F,{requiredForContentTypes:{}})}for(var A=0,O=c;A<O.length;A++){if(G=(j=O[A]).requiredFields&&j.requiredFields.split(","))for(var L=0,M=G;L<M.length;L++){var N=M[L];k[N]&&(k[N].requiredForContentTypes[j.contentTypeId]=!0)}}l=l.map(function(e){return k[e.internalName]})}if(c&&0<c.length){for(var q={},V={},B={},H=0,K=c;H<K.length;H++){var j,G=(j=K[H]).requiredFields&&j.requiredFields.split(","),z=j.requiredLookups&&j.requiredLookups.split(",");if(q[j.contentTypeId]=G)for(var W=0;W<G.length;W++){var X=G[W];V[X]||(V[X]=!0);B[X]=z&&"True"===z[W]}}this._listContext.contentTypeRequiredFields=q;this._listContext.requiredFieldsAreLookups=B;this._listContext.requiredFields=Object.keys(V);this._listContext.needContentTypes=!1}var Q=this._listItemBuilder.getItemResult({requestKey:n,queryType:t,itemFromServer:I,groupBy:E,itemGroups:null,contentTypes:c,supportsNestedGroups:this._supportsNestedGroups,observer:x}),J=Q.children,Y=Q.item,Z=Q.groupings,$=Q.totalChildren;this._processListTitleOverride({response:r,listUrl:this._getListUrl(n),requestKey:n,observer:x});x.flush();ge.isFeatureEnabled(ge.Spotlight)&&this._cacheSpotlightItemsFromServerData({requestKey:n,parentItem:this._itemsStore.getItem(n),queryType:t,spdata:r});var ee,te,re=this._itemsStore.getItem(Y.key);if(J){ee=[];for(var ie=0,ne=J;ie<ne.length;ie++){var oe=ne[ie];ee.push(this.peekUnwrapObservable(this._itemsStore.getItem(oe.key)))}}if(Z&&Z[0]){var ae=Z[0].itemGroups,se=ae[ae.length-1];se.fieldSchema&&this._listContext.groupSchema[se.fieldSchema.Name]&&(this._listContext.lastGroup=se)}for(var ue=0,le=l;ue<le.length;ue++){if((F=le[ue]).internalName===this._listContext.sortField){te=F.key;break}}var ce={item:this.peekUnwrapObservable(re),groupings:Z,children:ee,totalChildren:$,schema:l,contentTypes:c,nextRequestToken:C,sortField:te,isAscending:"true"===this._listContext.isAscending,customViewRenderer:f,viewId:this._listContext.viewResult?this._listContext.viewResult.id:void 0};this._listContext.group?ce.startIndex=this._listContext.group.startIndex:o.FirstRow&&(ce.startIndex=o.FirstRow-1);Se.default.mark("EUPL.ListItemDataSource.ProcessData.End");return ce};e.prototype._processResponse=function(e){var t,r=e.response,i=e.requestKey,n=e.observer,o=this.itemUrlHelper.getItemUrlParts(i);if(ue(r)){var a=(t=r).ListSchema;a&&this._microServiceDataSource.setBaseInfo({data:a,allowCookies:this._isOneDrive(o.normalizedListUrl)})}else t={ListData:r};this._listItemResultProcessor.processResponse({response:t,requestKey:i,observer:n})};e.prototype._updatePageContextInfo=function(e){try{var t=JSON.parse(e);t.serverRequestPath=void 0;this.updateContext(t);this._defaultListUrl=t.listUrl}catch(e){}};e.prototype._getFolderPath=function(e,t){var r=this._urlDataSource.getKeyParams(e).id;return r&&r!==this._urlDataSource.getDefaultRootItemId()?r:null};e.prototype._getListUrl=function(e){var t=this._urlDataSource.getKeyParams(e),r=t&&t.listurl;r||(r=this._listContext.listUrl);return r};e.prototype._isOneDrive=function(e){return!this.itemUrlHelper.getItemUrlParts(e).isCrossList&&this._listContext.listTemplateType===he.ListTemplateType.mySiteDocumentLibrary};e.prototype._processListTitleOverride=function(e){var t,r=e.response,i=e.requestKey,n=e.observer;t=ue(r)?r:{ListData:r};var o,a,s=this._urlDataSource.getKeyParams(i),u=s.q,l=this.itemUrlHelper.getItemUrlParts(i),c=this.itemUrlHelper.getUrlParts({path:l.serverRelativeListUrl,listUrl:l.fullListUrl}),d=t.ListTemplateType;this._urlDataSource.isCurrentQuery(fe.default.Search,s)&&u?o=C.format(h.strings.SearchResultsTitle,u):(this._alwaysRenderFilesTitle||Number(d)===he.ListTemplateType.mySiteDocumentLibrary)&&(o=f.strings.Files);if(o){var p=this._urlDataSource.getKey(((a={}).id=c.serverRelativeItemUrl,a.listurl=c.normalizedListUrl,a.view=s.view,a.q=s.q,a.typeFilters=s.typeFilters,a));n.update([new D.default(p).succeed({item:{key:p,name:o,displayName:o}})])}};e.prototype._setContext=function(e){var t=this,r=this._urlDataSource.getKeyParams(e.parentKey),i=e.newTargetListUrl||r.listurl||this._defaultListUrl,n=this._urlDataSource.getItemTypeFilter(r);this._supportsNestedGroups=e.supportsNestedGroups;this._expandGroup=e.expandGroup;this._groupReplace=e.groupReplace;var o=e.baseViewId,a=e.viewXml,s=e.filters,u=void 0===s?{}:s,l=e.sortField,c=e.isAscending,d=e.requestToken,p=e.needSchema,f=e.pageSize,h=void 0===f?30:f,m=e.parentKey,g=e.groupBy,y=e.group,v=e.query,_=e.queryType,b=e.needUpdatePageContext,S=e.resultSetOptions,w=(void 0===S?{}:S).fieldNames,T=void 0===w?[]:w,C=e.viewPath;this._listContext.listUrl=i;this._listContext.filterParams=Object.keys(u||{}).map(function(e){return"&"+e+"="+E.default.encodeURIComponent(u[e])}).join("");this._listContext.itemIds=null;this._listContext.requestToken=d;this._listContext.needSchema=!!p;this._listContext.pageSize=h;this._listContext.folderPath=this._getFolderPath(m,e);this._listContext.groupByOverride=g;this._listContext.groupLevel=this._getGroupLevel();this._listContext.group=y;this._listContext.searchTerm=v;this._listContext.queryType=_;this._listContext.typeFilter=n;this._listContext.fieldNames=T;var x=this._urlDataSource.getKeyParams(m);!x.listurl&&e.newTargetListUrl&&(x.listurl=e.newTargetListUrl);var I=this._urlDataSource.getKey(x);this._listContext.urlParts=this.itemUrlHelper.getItemUrlParts(I);this._listContext.needUpdatePageContext=!!b;!this._listContext.refreshClientForm&&this._listContext.needUpdatePageContext&&(this._listContext.refreshClientForm=!0);try{var P=JSON.stringify({defaultFullWebUrl:this._pageContext.webAbsoluteUrl,defaultListUrl:this._pageContext.listUrl,keyParts:r});H.Verbose.logData({name:"ListItemsDataSource._setContext",message:P})}catch(e){}return this._loadRemoteParentWeb({parentKey:m}).then(function(){return t._loadView({fieldNames:T,typeFilter:n,baseViewId:o,viewXml:a,viewPath:C,listFullUrl:t._listContext.urlParts.fullListUrl})}).then(function(){if(l){t._listContext.sortField=l;t._listContext.isAscending=!1===c?"false":"true"}else if(t._isUsingView()){t._listContext.sortField=null;t._listContext.isAscending=null}else if(!t._isTeamSiteLike()){t._listContext.sortField="LinkFilename";t._listContext.isAscending="true"}})};e.prototype._loadRemoteParentWeb=function(e){var t,r=this,i=e.parentKey;delete this._listContext.remoteParentWeb;var n=this.itemUrlHelper.getItemUrlParts(i);n.isCrossList&&n.siteRelation!==k.SiteRelation.sameSite&&(t=this.resources.consumeAsync(M.resourceKey.bypass).then(function(e){return e.getSiteForList(n.fullListUrl)}).then(function(e){r._listContext.remoteParentWeb=e;var t=new(r.resources.consume(_e.resourceKey));r._subsiteItemResultProcessor.processSubsite({subsite:e,requestKey:i,observer:t});t.flush()},function(e){}));return _.default.as(t).then(function(){})};e.prototype._loadView=function(e){var t,r=this,i=e.fieldNames,n=e.typeFilter,o=e.baseViewId,a=e.viewXml,s=e.viewPath,u=e.listFullUrl;this._setViewIdAndPath(o,s);var l=i.filter(function(e){return"name.FileSystemItemId"!==e});(n.filters.length||l.length)&&o&&!a&&(t=this._listDataSource.getView({id:o},u).then(function(e){a=e.getEffectiveViewXml();r._listContext.viewResult=e}));return _.default.as(t).then(function(){r._listContext.viewXmlForRequest=a})};e.prototype._getViewXml=function(){var e=this._listContext,t=e.fieldNames,r=void 0===t?[]:t,i=e.typeFilter,n=void 0===i?{filters:[]}:i,o=e.viewXmlForRequest,a=e.sortField,s=e.groupByOverride,u=r.filter(function(e){return"name.FileSystemItemId"!==e}),l="";if(this._isSpecifiedItemRequest()||!this._isUsingView())l=R.getViewXml({sortField:a,itemIds:this._listContext.itemIds,isAscending:this._listContext.isAscending,pageSize:this._listContext.pageSize,fetchNextGroup:void 0,lastGroup:this._listContext.lastGroup,recurseInFolders:this._listContext.recurseInFolders,fieldNames:u,typeFilter:n,groupBy:this._listContext.groupByOverride?[this._listContext.groupByOverride]:this._listContext.groupBy,userIsAnonymous:this._userIsAnonymous,requestMetaInfo:ge.isFeatureEnabled(ge.EnablePowerPointWrsPreview)||ge.isFeatureEnabled(ge.EnableWordWrsPreview)});else if(o)if(a||s||n.filters.length||u.length){var c=new d.default(o);a&&c.updateSort(null,{overwriteAll:!0});s&&c.updateGroupBy({isCollapsed:!1,group1:{fieldName:s}});n.filters.length&&c.addFilters([R.getTypeFilterViewXml(n)]);u.length&&c.replaceFields(c.getEffectiveFieldNames().concat(u));l=c.getEffectiveViewXml()}else l=this._listContext.viewXmlForRequest;return l};e.prototype._getItem=function(t){var i=this,e=this.itemUrlHelper.getItemUrlParts(t.parentKey),r=this.peekUnwrapObservable(this._itemsStore.getItem(t.parentKey));if(t.newTargetListUrl||t.requestToken||r&&r.type===p.default.Folder||e.fullItemUrl===e.fullListUrl)return this._getAsFolder(t);if(r&&(r.type===p.default.File||r.type===p.default.Media||r.type===p.default.Unknown||r.type===p.default.Shortcut)||t.ignoreChildren){Se.default.mark("EUPL.OneUP.GetSingleItem.Start");return this._getSingleItem(t)}return this._getAsFolder(t).then(function(r){var e=i.peekUnwrapObservable(i._itemsStore.getItem(r.item.key));if(!v.PermissionMask.hasPermission(e.permissions,v.PermissionMask.openItems)&&!r.totalChildren){Se.default.mark("EUPL.NoOneUP.GetSingleItem.Start");return i._getSingleItem(t).then(function(e){var t=r&&i.peekUnwrapObservable(i._itemsStore.getItem(r.item.key));return t&&t.type!==p.default.Folder?e:r})}i._listContext.listTemplateType===he.ListTemplateType.mySiteDocumentLibrary&&i._getSingleItem(t).done();return r})};e.prototype._getAsFolder=function(t){var r=this,i=this._listContext;t.ignoreListContext&&(this._listContext={});return this._setContext(t).then(function(){var e=r._getItemInternal(t);if(re.default.isActivated("420d156f-942a-486e-bd30-e3f642b56699","1/16/2018","Ignore list context applies in result processing stage")){t.ignoreListContext&&(r._listContext=i);return e}return e.then(function(e){t.ignoreListContext&&(r._listContext=i);return e})})};e.prototype._getSingleItem=function(s){var e,u=this,t=this.itemUrlHelper.getItemUrlParts(s.parentKey),r=new U.SPListItemRetriever({pageContext:this._pageContext}),i=this.itemUrlHelper.getUrlParts({path:t.serverRelativeListUrl,listUrl:t.fullListUrl}),l=this._urlDataSource.getKey(((e={}).id=i.serverRelativeItemUrl,e.listurl=i.normalizedListUrl,e)),n=R.getViewXml({sortField:void 0,itemIds:void 0,itemRefs:[t.serverRelativeItemUrl],isAscending:void 0,recurseInFolders:!0,requestMetaInfo:!0,pageSize:1}),c=new b.Qos({name:"GetSingleItem"}),o={viewXml:n,needsSchema:!0,needsParentInfo:!0,isListDataRenderOptionChangeFeatureEnabled:ge.isFeatureEnabled(ge.ListDataRenderOptionChange)},a={urlParts:i};return this._tryGetPrefetchedListViewData({url:r.getUrl(a,s),parseResponse:function(e){return JSON.parse(e)},qosName:"GetSingleItemFromPrefetchedData",qos:c,additionalPostData:r.getAdditionalPostData(o),fallbackGetData:function(){var e={parentKey:l,postDataContext:o},t={qosEvent:c,qosName:"GetData"};return r.getItem(e,a,t)}}).then(function(e){var t=new(u.resources.consume(_e.resourceKey));u._processResponse({response:e,requestKey:l,observer:t});var r=e.ListData.Row,i=!r.length&&u._getError(-2147024894);if(i)t.update([new D.default(s.parentKey).succeed({item:{key:s.parentKey,type:p.default.Error,error:{type:2,data:i},isPlaceholder:!1}})]);else for(var n=0,o=r;n<o.length;n++){var a=o[n];u._listItemBuilder.getItemResult({requestKey:l,queryType:fe.default.Files,itemFromServer:a,supportsNestedGroups:!1,observer:t})}u._processListTitleOverride({response:e,listUrl:u._getListUrl(l),requestKey:l,observer:t});t.flush();c.end({resultType:b.ResultTypeEnum.Success});return i?_.default.wrapError(i):{item:{key:s.parentKey},children:[],totalChildren:0}},function(e){var t="string"==typeof e.code?e.code.split(","):e.error.code.split(","),r=1<t.length?Number(t[0]):-1,i=u._getError(r,void 0,e),n=new(u.resources.consume(_e.resourceKey));n.update([new D.default(s.parentKey).succeed({item:{key:s.parentKey,type:p.default.Error,isPlaceholder:!1,error:{type:2,data:i}}})]);n.flush();return _.default.wrapError(i)})};e.prototype._isUsingView=function(){return!(!this._listContext.viewXmlForRequest&&!this._listContext.viewIdForRequest)};e.prototype._isTeamSiteLike=function(){return y.isTeamSiteLike(this._pageContext.webTemplate)};e.prototype._getItemInternal=function(i){var n=this,e=this._urlDataSource.getKeyParams(i.parentKey),r=this._urlDataSource.getQueryType(e),o=new b.Qos({name:"GetPrefetchedListViewData"}),a=new U.SPListItemRetriever({pageContext:this._pageContext}),t=r===fe.default.Files,s=r===fe.default.Search,u=this._getPostDataContext(i),l=function(e){e.resultCode&&(e.resultCode="GetData."+e.resultCode);switch(e.resultType){case b.ResultTypeEnum.ExpectedFailure:ie.logExpectedFailure(e);break;case b.ResultTypeEnum.Failure:ie.logUnexpectedFailure(e)}},c=function(){var e=de.__assign({},i);e.postDataContext=n._getPostDataContext(i);var t={qosEvent:o,qosName:s?"SearchGetData":"GetData"};return a.getItem(e,n._listContext,t,l).then(function(e){return n._handleDataProcessing(e,r,i)})},d=a.getUrl(this._listContext,i);return(t&&this._isRequestingListViewData(d)?this._tryGetPrefetchedListViewData({url:d,parseResponse:function(t){var r;try{"string"==typeof t&&(r=JSON.parse(t))}catch(e){if("{}"!==t.substring(0,2)){o.end({resultType:b.ResultTypeEnum.Failure,resultCode:"BadJSON",extraData:{responseText:t,prefetch:"true"}});throw e}r=JSON.parse(t.substring(2))}return n._handleDataProcessing(r,i.queryType,i)},qosName:"GetItemFromPrefetchedData",qos:o,additionalPostData:a.getAdditionalPostData(u),fallbackGetData:c}):c()).then(function(e){return e},function(e){var t="string"==typeof e.code?e.code.split(","):e.error.code.split(","),r=1<t.length?Number(t[0]):-1;return _.default.wrapError(n._getError(r,void 0,e))})};e.prototype._tryGetPrefetchedListViewData=function(l){var i=this;0;Se.default.mark("EUPL.GetPrefetch.Start");var c=l.url,d=l.qos,p=l.fallbackGetData,f=l.additionalPostData,h=g.default.createHashCode(c,f);window.ListDataActualHash=h;var m=g.default.prefetchData(h);if(!m){if(g.default.shouldLogError){var e=-1===c.indexOf("?")?null:B.deserializeQuery(c.substring(c.indexOf("?")+1));d.end({resultType:b.ResultTypeEnum.Failure,resultCode:"PrefetchNotStartedOrUrlOrPayLoadNotMatch",extraData:{AdditionalPostData:f||"null",QueryStrings:e?Object.getOwnPropertyNames(e):"null"}});g.default.shouldLogError=!1}0;return p()}g.default.shouldLogError=!1;var n=function(){var e="ListContenTypes",t=g.default.createHashCode(e,e),r=g.default.prefetchData(t);if(r&&r.listData){if(i.resources.isExposed(me.contentTypes)){i.resources.consume(me.contentTypes)(r.listData)}}else m&&(m.contentTypesCallback=n)};n();var t=function(s,u){var e=function(e,t){if(200===e||t){d.end({resultType:b.ResultTypeEnum.Success});var r=Se.default.getResponseEnd();if(e&&!t){Se.default.summary.dataFetchServerTime=m.serverDuration;if(window.performance&&performance.timing){Se.default.summary.prefetchStart=m.startTimeMark-r;window.g_prefetchStart=Se.default.summary.prefetchStart}var i=T.default.getRUMOneLogger();if(i){var n=m.correlationId,o=new S.default(c,m.serverDuration,n,e,null,(new Date).toISOString());i.writeAPICallPerformanceData(o)}Se.default.mark("EUPL.Prefetch.End")}else if(t){if(window.g_deferDataLoadTime&&window.performance&&performance.timing){Se.default.summary.deferredListDataRender=Number(window.g_deferDataLoadTime)-r;window.g_deferredListDataRender=Se.default.summary.deferredListDataRender}Se.default.mark("EUPL.DeferredListData.End")}try{var a=m.listData;s(l.parseResponse(a))}catch(e){u()}}else{(403===e?{resultType:b.ResultTypeEnum.ExpectedFailure,resultCode:"PrefetchUnauthorized"}:{resultType:b.ResultTypeEnum.Failure,resultCode:"PrefetchFailed"}).extraData={AdditionalPostData:f||"null",ResponseStatusCode:e};0;p().then(s,u)}g.default.clearPrefetchData(h)};m.responseCode||m.deferredListData?e(m.responseCode,m.deferredListData):m.completedCallback=e};return r.Api.instrumentPromise({url:c,name:this.getDataSourceName()+"."+l.qosName},function(){return new _.default(t)},null,function(e){return e&&"Canceled"===e.name?{error:e,resultCode:"Canceled",resultType:b.ResultTypeEnum.ExpectedFailure}:{error:e,resultType:b.ResultTypeEnum.Failure}})};e.prototype._initListContext=function(e){var t,r=this._listContext.listUrl;if(e.listRootFolderWebRelativeUrl||e.listRootFolderServerRelativeUrl||!e.listFullUrl)e.listRootFolderWebRelativeUrl?t=s.getSafeWebServerRelativeUrl(this._pageContext)+"/"+e.listRootFolderWebRelativeUrl:e.listRootFolderServerRelativeUrl&&(t=e.listRootFolderServerRelativeUrl);else{t=decodeURIComponent(e.listFullUrl).split(s.getServerUrl(this._pageContext))[1]}this._defaultListUrl=t;if(!r||t!==r){for(var i=0,n=Object.keys(this._listContext);i<n.length;i++){var o=n[i];delete this._listContext[o]}this._listContext.listUrl=t;this._listContext.listId=e.listId}!this._listContext.listTitle&&e.pageContext&&(this._listContext.listTitle=e.pageContext.listTitle);this._listContext.customWidthDictionary||(this._listContext.customWidthDictionary={})};e.prototype._setViewIdAndPath=function(e,t){if(e){e=ye.default.normalizeLower(e,!1);this._listContext.viewIdForRequest=e;this._listContext.viewResult&&this._listContext.viewResult.id!==e&&(this._listContext.viewResult=null)}e&&e!==ye.default.Empty||!t||(this._listContext.viewPathForRequest=t)};e.prototype._getError=function(e,t,r){var i=r&&r.correlationId,n={ItemNotFoundTitle:a.strings.ItemNotFoundTitle,ItemNotFoundSubText:a.strings.ItemNotFoundSubText,InvalidViewTitle:a.strings.InvalidViewTitle,InvalidViewSubText:a.strings.InvalidViewSubText,InvalidListTitle:a.strings.InvalidListTitle,InvalidListSubText:a.strings.InvalidListSubText,QueryThrottledSubText:a.strings.QueryThrottledSubText,QueryThrottledLinkText:a.strings.QueryThrottledLinkText,DefaultTitle:a.strings.DefaultTitle,DefaultSubText:a.strings.DefaultSubText};-2147024860===e&&this.resources.consume(ve.resourceKey).logData({name:"listView.Throttled",extraData:{correlationId:r.correlationId}});return Y.generateError(e,n,i)};e.prototype._fetchNextGroup=function(){return this._listContext.isGrouped&&this._listContext.group&&this._listContext.group.groupingId===ae&&!(this._groupReplace&&this._listContext.lastGroup&&this._listContext.lastGroup.count<this._itemsPerGroup.peek())&&!this._isSpecifiedItemRequest()};e.prototype._isSpecifiedItemRequest=function(){return this._listContext.itemIds&&0<this._listContext.itemIds.length};e.prototype._needsQuickLaunch=function(){return!this._listContext.leftNavigationData&&this._isTeamSiteLike()&&ge.isFeatureEnabled(ge.RenderListDataAsStreamLeftNavOpt)};e.prototype._isExpandingGroup=function(){return this._listContext.group&&this._listContext.group.groupingId!==ae};e.prototype._getGroupLevel=function(){var e=-1,t=this._listContext.groupByOverride?[this._listContext.groupByOverride]:this._listContext.groupBy,r=this._listContext.rawListSchema&&"TRUE"===this._listContext.rawListSchema.Collapse;if(t&&0<t.length){e=0;if(this._supportsNestedGroups){if(this._listContext.filterParams&&!r){var i=(n=l.default.getFilterFieldByName(this._listContext.filterParams,t[0]))&&t[1]&&l.default.getFilterFieldByName(this._listContext.filterParams,t[1]);(n&&1===t.length||i&&2===t.length)&&(e=-1)}}else if(this._listContext.filterParams){var n;if(n=l.default.getFilterFieldByName(this._listContext.filterParams,t[0])){e=(i=l.default.getFilterFieldByName(this._listContext.filterParams,t[1]))&&!r?-1:1}}}return e};e.prototype._cacheSpotlightItemsFromServerData=function(e){var t=e.requestKey,r=e.parentItem,i=e.queryType,n=e.spdata;if(this.resources.isExposed(w.spotlight)&&n.SpotlightInfo&&this._listContext.viewIdForRequest&&r&&r.peek()&&r.peek().key){var o=[],a=this.resources.consume(w.spotlight);if(n.SpotlightInfo.Items&&n.SpotlightInfo.Items.Row&&n.SpotlightInfo.Order&&n.SpotlightInfo.Order.length){for(var s=n.SpotlightInfo.Items.Row,u=n.SpotlightInfo.Order,l=new(this.resources.consume(_e.resourceKey)),c=[],d=0,p=s;d<p.length;d++){var f=p[d];c.push(this._listItemBuilder.getItemResult({requestKey:t,queryType:i,itemFromServer:f,groupBy:null,itemGroups:null,contentTypes:[],supportsNestedGroups:this._supportsNestedGroups,observer:l}).item)}l.flush();for(var h={},m=0,g=c;m<g.length;m++){var y=g[m].key;(b=this._itemsStore.getItem(y))&&(h[b.peek().properties.ID]=b)}for(var v=0,_=u;v<_.length;v++){var b;(b=h[_[v]])&&o.push(b)}}var S=this._listContext.viewIdForRequest===ye.default.Empty?this._listContext.viewResult.id:this._listContext.viewIdForRequest;a.cacheSpotlightItems(r,S,o)}};e.prototype._getDeferredDataSource=function(){return this.resources.consumeAsync(V.resourceKey)};e.prototype._getSearchDataSource=function(){return this.resources.consumeAsync(n.resourceKey.bypass)};e.prototype._getSharedItemDataSource=function(){return this.resources.consumeAsync(q.resourceKey.bypass)};e.prototype._getVroomSharedItemDataSource=function(){return ge.isFeatureEnabled(ge.ODBVroomSharedWithMe)?this.resources.consumeAsync(N.resourceKey.bypass):this._getSharedItemDataSource()};e.prototype._getRecycleBinDataSource=function(){return this.resources.consumeAsync(i.resourceKey.bypass)};e.prototype._handleDataProcessing=function(r,o,a){var e,s=this,u=a.parentKey,t=r.ShouldLoadSPFramework,i=void 0!==t&&t,n=this.resources.consume(me.onePageContext.optional),l=n&&n.handleOnePageNavigationFallback,c=!1;if(i){if(r.SPFrameworkClientInfo){this._clientSideExtensionHelper||(this._clientSideExtensionHelper=this.resources.consume(W.clientSideExtensionHelper));e=this._clientSideExtensionHelper.loadSPFrameworkForOnePageNavigation(r.SPFrameworkClientInfo)}else c=!0;if(c&&l){l("SPFramework");throw{code:"-4, onePageNavigationError"}}}var d=function(e){s._engagement.logData({name:"List."+e});e="EUPL."+e+".LoadModule.";Se.default.mark(e+"Start")},p=function(){var e=s._loadClientSideCustomizer(r,a.parentKey),t=s._getCustomFormatterModule(r);if(t||e){var n;if(t&&e){d("MultipleCustomizers");return _.default.all([e,t]).then(function(e){var t=e[0],r=e[1],i=t;window.CustomFormatter=r.CustomFormatter;return s._onCustomLoadersEnd(a,i,o,u,n)},function(e){return s._onCustomLoadersEnd(a,r,o,u,n)})}if(t){d("CustomFormatter");return t.then(function(e){window.CustomFormatter=e.CustomFormatter;return s._onCustomLoadersEnd(a,r,o,u,n)},function(e){return s._onCustomLoadersEnd(a,r,o,u,n)})}d("ClientSideCustomizer");return e.then(function(e){return s._onCustomLoadersEnd(a,e,o,u,n)},function(e){return s._onCustomLoadersEnd(a,r,o,u,n)})}return s._processData(a,o,r)};return e?e.then(function(){return p()}).catch(function(e){l("SPFramework");throw{code:"-4, onePageNavigationError"}}):p()};e.prototype._onCustomLoadersEnd=function(e,t,r,i,n){Se.default.mark(n+"End");return this._processData(e,r,t)};e.prototype._getCustomFormatterModule=function(e){if(!!ge.isFeatureEnabled(ge.CustomFormatter)&&e&&e.ListSchema&&e.ListSchema.Field){for(var t=e.ListSchema.Field,r=!1,i=0;i<t.length;i++){var n=t[i];if(n.CustomFormatter){r=!0;this._engagement.logData({name:"CustomFormatterField."+n.FieldType})}}if(e.ListSchema.CustomFormatter){r=!0;this._engagement.logData({name:"CustomFormatterViewLoad"})}if(r){this._engagement.logData({name:"CustomFormatterLoad"});return u.loadModule({path:"a",getModule:function(){return new _.default(function(e,t){o(["a"],e,t)})}})}}return null};e.prototype._loadClientSideCustomizer=function(t,e){var r=this,i=Number(this._pageContext.webTemplate);if((ge.isFeatureEnabled(ge.FieldCustomizerInListNext)||this._pageContext.isTenantDevSite)&&(!re.default.isActivated("4A5A7D00-358C-4BA3-8E26-5206C5AD9159","11/29/2017","Enable client-side extensions to all site templates")||i===y.WebTemplateType.teamSite||i===y.WebTemplateType.group||i===y.WebTemplateType.sitePagePublishing)){var n,o=this._engagement;if(t.ListSchema)n=t.ListSchema.Field;else{var a=this._listContext.listSchema;n=a&&a.map(function(e){return{RealFieldName:e.realFieldName||e.internalName,ID:e.id,Type:e.serverFieldType,DisplayName:e.name,Name:e.name,ClientSideComponentId:e.clientSideComponentId,ClientSideComponentProperties:e.clientSideComponentProperties}})}if(!n||n.length<1){o.logData({name:"LoadSpfx.ListFieldsNotAvailable"});return}if(this._prepareClientSideCustomizedFields(t,n)){var s=new b.Qos({name:"LoadFieldCustomizers"});Se.default.mark("EUPL.LoadFieldCustomizers.Start");this._clientSideExtensionHelper||(this._clientSideExtensionHelper=this.resources.consume(W.clientSideExtensionHelper));if(!this._clientSideExtensionHelper){console.log("Error on consuming ClientSideExtensionHelper");s.end({resultType:b.ResultTypeEnum.Failure,resultCode:"ConsumeClientSideExtensionHelperFailed"});Se.default.mark("EUPL.LoadFieldCustomizers.NoClientSideExtensionHelper.End");return _.default.wrap(t)}if(!window.moduleLoaderPromise){o.logData({name:"LoadSpfx.moduleLoaderPromiseNotFound",extraData:{SpModuleLoaderExists:!!window.spModuleLoader}});console.log("sp-client module loader promise does not exist")}return this._clientSideExtensionHelper.getListViewAdapter().then(function(o){try{if(!o){console.log("sp-client listViewHostApp failed to create listViewAdapter");s.end({resultType:b.ResultTypeEnum.Failure,resultCode:"FailToCreateListViewAdapter"});Se.default.mark("EUPL.LoadFieldCustomizers.Error.FailListViewAdapter.End");return t}Se.default.mark("EUPL.LoadFieldCustomizers.GotListViewAdapter");n.forEach(function(t,e,r){try{var i={id:t.ID,internalName:t.RealFieldName||t.Name,fieldType:t.FieldType,isRequired:!!t.Required&&"TRUE"===t.Required.toUpperCase(),isVisible:!0,displayName:t.DisplayName,clientSideComponentId:t.ClientSideComponentId,clientSideComponentProperties:t.ClientSideComponentProperties,onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+t.Name+", componentId: "+t.ClientSideComponentId+", error: "+e.message)}},n=o.addColumnAdapter(i);if(!n)throw"addColumnAdapter returns null";if(i.clientSideComponentId&&i.clientSideComponentId!==ye.default.Empty){t.ClientSideColumnAdapter=n;console.log("Add Spfx column adapter for "+t.RealFieldName)}}catch(e){console.log("Error on addColumnAdapter for column: "+t.Name+", error: "+e)}});return o.loadFieldCustomizers().then(function(e){console.log("fieldCustomizers loaded");s.end({resultType:b.ResultTypeEnum.Success});Se.default.mark("EUPL.LoadFieldCustomizers.End");r._logLoadFieldCustomizersResult(t);return t},function(e){console.log("fieldCustomizers failed to load, error: "+e);s.end({resultType:b.ResultTypeEnum.Failure,resultCode:"ListViewHostAppFailedToLoadCustomizersPromiseError",error:e});Se.default.mark("EUPL.LoadFieldCustomizers.PromiseError.End");return t})}catch(e){s.end({resultType:b.ResultTypeEnum.Failure,resultCode:"ListViewHostAppFailedToLoadCustomizersCatch",error:e});Se.default.mark("EUPL.LoadFieldCustomizers.Error.End");return t}})}}return null};e.prototype._logLoadFieldCustomizersResult=function(e){(e.ListSchema?e.ListSchema.Field:[]).forEach(function(e,t,r){if(e.ClientSideComponentId&&e.ClientSideColumnAdapter){var i="EUPL.LoadFieldCustomizers."+e.ClientSideComponentId+".";i+=e.ClientSideColumnAdapter.fieldCustomizerLoaded?"Loaded":"Failed";Se.default.mark(i)}})};e.prototype._prepareClientSideCustomizedFields=function(e,t){var r,i={},n=new X.default(document.location.href),o=n.getQueryParameter(se);try{if(r=JSON.parse(o))for(var a in r){var s=r[a],u="",l="";if("string"==typeof s)u=s;else if("object"==typeof s){s.id&&(u=s.id);if(s.properties){var c="";"object"==typeof s.properties&&(c=JSON.stringify(s.properties));l=c}}i[a]={internalName:a,clientSideComponentId:u,clientSideComponentProperties:l}}}catch(e){console.log("Error when parse query parameter: "+se+", error: "+e)}for(var d=!1,p=!1,f=0,h=t;f<h.length;f++){var m=h[f],g=m.RealFieldName,y=void 0;i.hasOwnProperty(g)&&(y=i[g]);if(y&&!m.CustomFormatter){m.ClientSideComponentId=y.clientSideComponentId;m.ClientSideComponentProperties=y.clientSideComponentProperties;d=!0}m.ClientSideComponentId&&m.ClientSideComponentId!==ye.default.Empty&&!m.CustomFormatter&&(p=!0)}if(!p&&d){n.getQueryParameter("loadSPFX")||console.log("WARNING! SPFX is required to be loaded. Add 'loadSPFX=true' query parameter")}return d||p};return e}(t.default);e.default=c;function ue(e){return!!e.ListData}});define("ir",["require","exports","ap","aq","ex","bX","iE","ep","by","hL"],function(e,t,S,w,T,h,m,g,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.getListSchema=function(e,t,r,i,n,o){var a=this,s=t.consume(h.disableCalloutInvoker.optional),u=t.consume(h.disableShareHeroCommand.optional),l=t.consume(y.platformDetection).isMobile&&t.consume(h.useMobileList.optional);n||(n=t.consume(m.listContext));var c={disableCalloutInvoker:s,hasFixedSchema:i,serverSupportsAutoHyperLink:!1,useCustomColumn:l,disableShareHeroCommand:u},d=v.SchemaBuilder.buildSchema(e,n,c,r,o),p=t.consume(m.pageContext),f=Number(p.webTemplate)===g.default.mySite;return d.filter(function(e){return!f||"ItemChildCount"!==e.internalName&&"FolderChildCount"!==e.internalName}).map(function(e){e.groupable=!f&&e.groupable;return a._convertToODNColumn(e,n)})};e.getCustomColumns=function(e,t,r){var i=this,n=this._convertToSPColumn(e),o=t.map(function(e){return e.map(function(e){return i._convertToSPColumn(e)})}),a=r.map(function(e){return i._convertToSPColumn(e)});return v.SchemaBuilder.getCustomColumns(n,o,a).map(function(e){return i._convertToODNColumn(e)})};e.getMappedColumnType=function(e){return v.SchemaBuilder.getMappedColumnType(e)};e.getIconColumnWidth=function(e){return e.consume(y.platformDetection).isMobile&&e.consume(h.useMobileList.optional)?48:16};e.getIconColumnMinWidth=function(e){return e.consume(y.platformDetection).isMobile&&e.consume(h.useMobileList.optional)?48:16};e.fillColumnDefinitionDefaults=function(e,v,_){void 0===v&&(v={});void 0===_&&(_={});var t=v.isCollapsible,b=void 0===t||t;return e.map(function(e,t){var r=e.isIcon,i=void 0!==r&&r,n=e.sortable,o=void 0===n?!!v.sortable:n,a=e.resizable,s=void 0===a?!!v.resizable:a,u=e.isCollapsable,l=void 0===u?b:u,c=e.fieldType,d=void 0===c?T.ColumnFieldType.Text:c,p=e.name,f=e.getValue,h=e.key,m=e.width,g=!!_.sortField&&_.sortField===e.internalName,y=!!_.groupBy&&_.groupBy===e.internalName;return S.__assign({},e,{key:h,name:p,width:m,index:t,fieldType:d,isCollapsable:l,isIcon:i,isVisible:!0,isVisibleMobile:!0,isGrouped:y,sortable:o,isSorted:g,isAscending:g&&_.isAscending,filterable:!1,isFocused:w.observable(!1),getValue:f,resizable:s})})};e._convertToODNColumn=function(e,t){var r=this;return S.__assign({},e,{key:function(e){var t;switch(e){case"FileSizeDisplay":t="size";break;default:t=e}return t}(e.key),clientSideColumnAdapter:e.clientSideColumnAdapter,isFiltered:w.observable(e.isFiltered),isMenuOpen:w.observable(!1),isFocused:w.observable(!1),customWidth:w.observable(0),filterValues:w.observable(e.filterValues),customFields:e.customFields?e.customFields.map(function(e){return r._convertToODNColumn(e,t)}):void 0})};e._convertToSPColumn=function(e){var t=this;return S.__assign({},e,{isFiltered:e.isFiltered&&e.isFiltered.peek(),filterValues:e.filterValues&&e.filterValues.peek(),customWidth:e.customWidth&&e.customWidth.peek(),clientSideColumnAdapter:e.clientSideColumnAdapter,customFields:e.customFields&&e.customFields.map(function(e){return t._convertToSPColumn(e)})})};return e}();t.default=r});define("ex",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.Text=0]="Text";e[e.Hyperlink=1]="Hyperlink";e[e.Image=2]="Image";e[e.User=3]="User";e[e.Boolean=4]="Boolean";e[e.DateTime=5]="DateTime";e[e.Currency=6]="Currency";e[e.Counter=7]="Counter";e[e.Number=8]="Number";e[e.Note=9]="Note";e[e.Computed=10]="Computed";e[e.Name=11]="Name";e[e.FileSize=12]="FileSize";e[e.Shared=13]="Shared";e[e.SharedWith=14]="SharedWith";e[e.FileIcon=15]="FileIcon";e[e.DotDotDot=16]="DotDotDot";e[e.Tag=17]="Tag";e[e.Lookup=18]="Lookup";e[e.Taxonomy=19]="Taxonomy";e[e.Hashtag=20]="Hashtag";e[e.Attachments=21]="Attachments";e[e.AverageRating=22]="AverageRating";e[e.Title=23]="Title";e[e.WorkflowStatus=24]="WorkflowStatus";e[e.ProgressBar=25]="ProgressBar";e[e.RatedBy=26]="RatedBy";e[e.Ratings=27]="Ratings";e[e.LikedBy=28]="LikedBy";e[e.Likes=29]="Likes";e[e.ComplianceRecordFlag=30]="ComplianceRecordFlag";e[e.Custom=31]="Custom";e[e.Activity=32]="Activity";e[e.Choice=33]="Choice";e[e.ClientSideCustom=34]="ClientSideCustom";e[e.FileActivity=35]="FileActivity";e[e.MruName=36]="MruName";e[e.ShareCommand=37]="ShareCommand";e[e.PinCommand=38]="PinCommand";e[e.Thumbnail=39]="Thumbnail";e[e.ImageSize=40]="ImageSize"}(r=t.ColumnFieldType||(t.ColumnFieldType={}));t.default=r});define("hL",["require","exports","ap","hT","hK","hR","hM"],function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t);r.__exportStar(n,t);r.__exportStar(o,t);r.__exportStar(a,t)});define("hT",["require","exports","dp","ey","im","in"],function(e,t,i,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.getItemName=function(e,t,r){return r&&!r.isDocLib&&t!==i.default.Folder&&(e.Title||e["URL.desc"])||e.FileLeafRef};e.updateListContext=function(e,t){if(Number(e.ListTemplateType)){t.listTemplateType=Number(e.ListTemplateType);t.isDocLib=n.isDocumentLibrary(t.listTemplateType)}"boolean"==typeof e.ContentTypesEnabled&&(t.contentTypesEnabled=e.ContentTypesEnabled);if(e.ListSchema){t.listId=e.listName;t.rawListSchema=e.ListSchema;t.viewTitle=e.viewTitle;t.openInClient="0"===t.rawListSchema.DefaultItemOpen}e.ListTitle&&(t.listTitle=e.ListTitle);e.listUrlDir&&!t.listUrl&&(t.listUrl=decodeURIComponent(e.listUrlDir));e.EnableAttachments&&(t.enableAttachments="true"===e.EnableAttachments);var r=e.BasePermissions;r&&(t.permissions={manageLists:r.ManageLists,managePersonalViews:r.ManagePersonalViews,openItems:r.OpenItems});"boolean"!=typeof e.ExcludeFromOfflineClient&&"boolean"!=typeof e.WebExcludeFromOfflineClient||(t.excludeFromOfflineClient=!(!e.ExcludeFromOfflineClient&&!e.WebExcludeFromOfflineClient));"boolean"==typeof e.TenantTagPolicyEnabled&&(t.tenantTagPolicyEnabled=e.TenantTagPolicyEnabled);"boolean"==typeof e.verEnabled&&(t.enableVersions=e.verEnabled);"boolean"==typeof e.EnableMinorVersions&&(t.enableMinorVersions=e.EnableMinorVersions);"boolean"==typeof e.NewWOPIDocumentEnabled&&(t.newWOPIDocumentEnabled=e.NewWOPIDocumentEnabled);"number"==typeof e.NewWOPIDocumentTypes&&(t.newWOPIDocumentTypes=e.NewWOPIDocumentTypes);"boolean"==typeof e.isModerated&&(t.isModerated=e.isModerated);"boolean"==typeof e.AllowCreateFolder&&(t.allowCreateFolder=e.AllowCreateFolder);"boolean"==typeof e.AllowGridMode?t.allowGridMode=e.AllowGridMode:"boolean"!=typeof t.allowGridMode&&(t.allowCreateFolder=!0);e.displayFormUrl&&(t.displayFormUrl=e.displayFormUrl);e.editFormUrl&&(t.editFormUrl=e.editFormUrl);e.newFormUrl&&(t.newFormUrl=e.newFormUrl);e.metadataNavFeatureEnabled&&(t.metadataNavFeatureEnabled=e.metadataNavFeatureEnabled);if(e.ViewMetadata){var i=e.ViewMetadata;if(e.VisualizationInfo)try{i.VisualizationInfo=JSON.parse(e.VisualizationInfo)}catch(e){}t.viewResult=new o.default(i)}t.isPlaceholder=!1};e.updateListContextGroupInfo=function(e){var t=void 0;if(e.groupByOverride)t=[e.groupByOverride];else if(e.rawListSchema&&e.rawListSchema.group1){(t=[]).push(e.rawListSchema.group1);e.rawListSchema.group2&&t.push(e.rawListSchema.group2)}var r=-1,i=e.rawListSchema&&"TRUE"===e.rawListSchema.Collapse;if(t&&0<t.length){r=0;if(e.filterParams&&!i){var n=Boolean(a.default.getFilterFieldByName(e.filterParams,t[0])),o=!(!n||!t[1])&&Boolean(a.default.getFilterFieldByName(e.filterParams,t[1]));(n&&1===t.length||o&&2===t.length)&&(r=-1)}}e.groupLevel=r;e.groupBy=-1<r?t:void 0;e.isGrouped=Boolean(e.groupBy)}}(t.ListItemBuilderHelpers||(t.ListItemBuilderHelpers={}))});define("ey",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.invalidType=-1]="invalidType";e[e.noListTemplate=0]="noListTemplate";e[e.genericList=100]="genericList";e[e.documentLibrary=101]="documentLibrary";e[e.survey=102]="survey";e[e.links=103]="links";e[e.announcements=104]="announcements";e[e.contacts=105]="contacts";e[e.events=106]="events";e[e.tasks=107]="tasks";e[e.pictureLibrary=109]="pictureLibrary";e[e.webTemplateCatalog=111]="webTemplateCatalog";e[e.webPartCatalog=113]="webPartCatalog";e[e.listTemplateCatalog=114]="listTemplateCatalog";e[e.xmlFormLibrary=115]="xmlFormLibrary";e[e.masterPageCatalog=116]="masterPageCatalog";e[e.webPageLibrary=119]="webPageLibrary";e[e.solutionCatalog=121]="solutionCatalog";e[e.themeCatalog=123]="themeCatalog";e[e.designCatalog=124]="designCatalog";e[e.appDataCatalog=125]="appDataCatalog";e[e.ganttTasks=150]="ganttTasks";e[e.promotedLinks=170]="promotedLinks";e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy";e[e.meetings=200]="meetings";e[e.externalList=600]="externalList";e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary";e[e.publishingPageLibrary=850]="publishingPageLibrary";e[e.publishingAsset=851]="publishingAsset";e[e.issueTracking=1100]="issueTracking"}(r=t.ListTemplateType||(t.ListTemplateType={}));var i=[r.mySiteDocumentLibrary,r.documentLibrary,r.pictureLibrary,r.xmlFormLibrary,r.webPageLibrary,r.publishingPageLibrary,r.publishingAsset];t.isDocumentLibrary=function(e){var t=Number(e);return-1!==i.indexOf(t)};t.isGenericList=function(e){return e===r.genericList||e===r.announcements||e===r.issueTracking||e===r.contacts};t.isPromotedLinksList=function(e){return Number(e)===r.promotedLinks};t.default=r});define("im",["require","exports","aM","h6","bp"],function(e,t,l,b,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,k="useFiltersInViewXml";!function(_){var S="FilterLookupId",r="FilterField",i="FilterValue",n="FilterType";function w(e,t){t=l.default.encodeURIComponent(t);var r=e.match(new RegExp("FilterField([0-9]+)="+t+"&"));Boolean(r)||(r=e.match(new RegExp("FilterFields([0-9]+)="+t+"&")));return r}_.getFilterFieldByName=w;_.getFilterValueByName=function(e,t){t=l.default.encodeURIComponent(t);var r=e.match(new RegExp("FilterField([0-9]+)="+t+"&FilterValue([0-9]+)=([^&]+)"));Boolean(r)||(r=e.match(new RegExp("FilterFields([0-9]+)="+t+"&FilterValues([0-9]+)=([^&]+)")));return r?decodeURIComponent(r[r.length-1]):void 0};function T(e,t){return o(r,e,t)}_.getFilterFieldByIndex=T;function C(e,t){return o(i,e,t)}_.getFilterValueByIndex=C;function x(e,t){return o(n,e,t)}_.getFilterTypeByIndex=x;function I(e,t){return o(S,e,t)}_.getFilterUseLookupIdByIndex=I;_.getFilterParams=function(e,t){var r,i,n,o="",a=0;do{r=T(e,++a);i=C(e,a);n=x(e,a);var s=i&&i.toString(),u=n&&n.toString();if(t&&u&&s){var l=String(u.substr(u.indexOf("=")+1)),c=String(s.substr(s.indexOf("=")+1));if("datetime"===(l&&l.toLowerCase())){var d=_.parseMultiColumnValue(c,";#",!0);if(d&&d.length&&D.isTodayString(d[0]))continue}}null!==r&&null!==i&&(o+="&"+r.toString()+"&"+s);null!==n&&(o+="&"+u)}while(null!=r);return o};_.isFiltered=function(e){var t=!1;for(var r in e)if(0===r.indexOf("FilterField")){t=!0;break}return t};_.updateFilterInfo=function(e,t,r,i,n){e=_.addFilterInfo(e,t,"",!0,i,n);if(r&&0<r.length){for(var o=0,a=[];a=T(e,++o),Boolean(a););""!==e&&(e+="&");e+=E(o,t,r,i,n)}return e};_.addMultipleFilterInfo=function(e,t,i,r){var n=e,o={};r&&r.forEach(function(e){o[e.Name]=e});t.forEach(function(e,t){var r=o&&o[e];n=r?a(n,e,i[t],!1,r.FieldType):a(n,e,i[t])});return n};function a(e,t,r,i,n,o){var a=w(e,t);if(Boolean(a)){var s=parseInt(a[1],10),u=C(e,s),l=x(e,s),c=I(e,s),d=a[0]+u[0];l&&(d+="&"+l[0]);c&&(d+="&"+c[0]);var p=d,f="";if(Boolean(i))p=new RegExp("(\\?|\\&)"+d);else{var h=[],m=!1,g=P(String(u[0].substr(u[0].indexOf("=")+1)),";#",!0);for(var y in g)if(y){if(g[y]===r){m=!0;continue}h.push(g[y])}m||h.push(r);0<h.length&&(f=E(a[1],t,h,n,o))}var v=e.replace(p,f);i&&v===e&&(v=e.replace(d,f));e=function(e,t){var r=t+1,i=e.match(new RegExp("FilterField"+String(r)+"=[^&]*")),n=!1;if(!Boolean(i)){i=e.match(new RegExp("FilterFields"+String(r)+"=[^&]*"));n=Boolean(i)}for(var o=t;Boolean(i);o++){var a=n?"FilterFields"+String(o):"FilterField"+String(o),s=n?"FilterFields"+String(r):"FilterField"+String(r);e=e.replace(s,a);a=n?"FilterValues"+String(o):"FilterValue"+String(o);s=n?"FilterValues"+String(r):"FilterValue"+String(r);e=e.replace(s,a);a=n?"FilterTypes"+String(o):"FilterType"+String(o);s=n?"FilterTypes"+String(r):"FilterType"+String(r);e=e.replace(s,a);a=S+String(o);s=S+String(r);e=e.replace(s,a);i=T(e,++r)}return e}(v,s)}else{for(var _=0,b=[];b=T(e,++_),Boolean(b););if(!Boolean(i)){""!==e&&(e+="&");e+=E(_,t,[r],n,o)}}return e}_.addFilterInfo=a;function P(e,t,r){var i=t.charAt(0),n=new RegExp(i+i,"g");r&&(e=decodeURIComponent(e));var o=e.split(t);return o=o.map(function(e){return e.replace(n,i)})}_.parseMultiColumnValue=P;_.isFieldValueInUrl=function(e,t,r,i){var n=w(e,t);if(Boolean(n)){var o=C(e,parseInt(n[1],10)),a=String(o[0].substr(o[0].indexOf("=")+1)),s=decodeURIComponent(a).split(";#");for(var u in s)if(s[u]===r||i&&s[u]===i)return!0}return!1};_.getText=function(e){return Boolean(e.innerText)?e.innerText.toString():Boolean(e.textContent)?e.textContent.toString():e.innerHTML.toString()};_.getFilterList=function(e,t,r,i,n){var o,a,s,u,l=[],c=0,d="Eq",p=0<=e.indexOf(k+"=1");do{c++;o=_.getFilterFieldByIndex(e,c);a=_.getFilterValueByIndex(e,c);s=_.getFilterTypeByIndex(e,c);u=_.getFilterUseLookupIdByIndex(e,c);if(null!==o&&null!==a){var f=String(o[0].substr(o[0].indexOf("=")+1)),h=String(a[0].substr(a[0].indexOf("=")+1)),m=decodeURIComponent(f),g=s&&s[0]?String(s[0].substr(s[0].indexOf("=")+1)):t?b.getFieldType(m,t):null,y=void 0;u&&u[0]&&"1"===u[0].substr(u[0].indexOf("=")+1)&&(y=!0);var v=_.parseMultiColumnValue(h,";#",!0).map(function(e){return r?e:e||n});p&&g&&"datetime"===g.toLowerCase()&&v&&v.length&&D.isTodayString(v[0])&&(d="Geq");l.push({fieldName:m,values:v,operator:d,type:g,id:i?m:void 0,lookupId:y})}}while(o);return l};_.formatBreadcrumbFilterValues=function(e,t,r){return e.map(function(e){return"Boolean"===t?"0"===e?r.booleanFalse:"1"===e?r.booleanTrue:e:new RegExp("^\\d*\\.0+$").test(e)?parseFloat(e).toString():e}).join(", ")};function o(e,t,r){var i=t.match(new RegExp(e+String(r)+"=[^&#]*"));Boolean(i)||(i=t.match(new RegExp(e+"s"+String(r)+"=[^&#]*")));return i}function E(e,t,r,i,n){var o="FilterField",a="&FilterValue",s="&FilterType";if(1<r.length){o="FilterFields";a="&FilterValues";s="&FilterTypes"}var u=o+e+"="+t+a+e+"="+function(e,t){var r=t.charAt(0),i=r+r,n=new RegExp(r,"g");e=e.map(function(e){return e.replace(n,i)});return l.default.encodeURIComponent(e.join(t))}(r,";#");i&&(u+=s+e+"="+i);n&&(u+="&"+S+e+"=1");return u}}(r||(r={}));t.default=r});define("h6",["require","exports","bg","aM","aP","bf"],function(e,t,_,b,S,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getListDataUrl=function(e){var t,r,i=e.webUrl,n=e.webId,o=e.listId,a=e.view,s=e.searchTerm,u=e.rootFolder,l=e.sortField,c=e.sortDir,d=e.filterParams,p=e.groupString,f=e.requestToken,h=e.viewId,m=e.viewPath,g=e.urlParts,y=[b.default.escapeUrlForCallback(i)];"/"!==i.slice(-1)&&y.push("/");g&&(t=void 0===(r=g.siteRelation)?g.isCrossSite:r);if((t===_.SiteRelation.crossSite||n)&&g.fullListUrl){y.push("_api/SP.List.GetListDataAsStream?listFullUrl='");y.push(b.default.encodeRestUriStringToken(g.fullListUrl));if(f){"?"!==f[0]&&S.Verbose.logData({name:"ListItemDataHelper.InvalidRequestToken",message:f});y.push("'&"+f.substring(1));return y.join("")}y.push("'&View=")}else{var v=g&&g.serverRelativeListUrl;if(v)y.push("_api/web/GetList(@listUrl)");else if(o){y.push("_api/web/lists/GetById('");y.push(o);y.push("')")}else y.push("_api/web/DefaultDocumentLibrary");if(f){y.push("/RenderListDataAsStream");y.push(f);y.push(w(v));if("string"==typeof s){y.push("&InplaceSearchQuery=");y.push(b.default.encodeURIComponent(s))}return y.join("")}y.push("/RenderListDataAsStream?");v&&y.push(w(v,!0));y.push("View=");a&&y.push(a);if(m){y.push("&ViewPath=");y.push(b.default.encodeURIComponent(m))}}h&&y.push("&ViewId="+h);if("string"==typeof s){y.push("&InplaceSearchQuery=");y.push(b.default.encodeURIComponent(s))}if(u){y.push("&RootFolder=");y.push(b.default.encodeURIComponent(u))}if("string"==typeof p){y.push("&IsGroupRender=TRUE");y.push("&DrillDown=1");y.push("&GroupString="+p)}l&&y.push("&SortField="+l);c&&y.push("&SortDir="+c);d&&y.push(d);return y.join("")};function w(e,t){var r=[];if(e){t||r.push("&");r.push("@listUrl='");r.push(b.default.encodeRestUriStringToken(e));r.push("'");t&&r.push("&")}return r.join("")}t.getListRequestHeaders=function(e,t){var r,i,n,o;if(t){r=t.needsQuickLaunch;i=t.webId;n=t.siteId}e.listUrl?o="listUrl="+b.default.encodeURIComponent(e.listUrl):e.listId&&(o="list="+e.listId);i&&(o+=",webId="+i);n&&!a.Killswitch.isActivated("ade8eb60-e615-4e1f-b530-ccfbc7d1c145","11/30/2017","Pass site id to GetListDataAsStream")&&(o+=",siteId="+n);return{"X-SP-REQUESTRESOURCES":r?"NAVIGATIONSTRUCTURE,"+o:o}};t.getListEntityTypeName=function(e,t){var r=e;t&&0===e.indexOf(t)&&(r=e.replace(t,""));"/"===r.substring(0,1)&&(r=r.substring(1));0===r.toLowerCase().indexOf("lists/")&&(r=r.substr("lists/".length)+"List");for(var i=[],n=0;n<r.length;n++){var o=r.charAt(n),a=r.charCodeAt(n);47<a&&a<58||64<a&&a<91||96<a&&a<123||(o="_x"+("0000"+a.toString(16)).slice(-4)+"_");i.push(o)}0<i.length&&1===i[0].length&&(i[0]=i[0].toUpperCase());return"SP.Data."+i.join("")+"Item"};t.getEntityPropertyName=function(e,t){var r="_"===e[0]?"OData_"+e:e;if(t)switch(t.toLowerCase()){case"lookup":r+="Id";break;case"user":case"usermulti":r+="StringId"}return r};t.getFieldType=function(e,t,r){void 0===r&&(r="Text");if(!t)return r;for(var i=0,n=t;i<n.length;i++){var o=n[i];if(o.Name===e)return o.FieldType}return r}});define("in",["require","exports","io","aZ","bn","bo","bp","aI","V","b6"],function(e,t,h,o,m,r,g,i,d,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=new XMLSerializer,n=function(){function n(e){if("string"!=typeof e){var t=e;this.id=o.default.normalizeLower(t.Id,!1);this.title=t.Title;this.isDefault=t.DefaultView;this.isHidden=t.Hidden;this.isPersonal=!!t.PersonalView;this.isReadOnly=t.ReadOnlyView;this.modifiedInEditor=t.EditorModified;this.rowLimit=t.RowLimit;this.scope=t.Scope||0;this.serverRelativeUrl=t.ServerRelativeUrl;this.baseViewId=t.BaseViewId;this.baseViewXml=t.ListViewXml;var r=t.TabularView,i=void 0===r||r;this.tabularView=i;if(n.isAppView(t)){this.isHidden=!1;this.viewType=134217728;this.visualizationInfo=t.VisualizationInfo}else if(t.ViewType)switch(t.ViewType.toLowerCase()){case"html":this.viewType=1;break;case"grid":this.viewType=2048;break;case"calendar":this.viewType=524288;break;case"recurrence":this.viewType=8193;break;case"chart":this.viewType=131072;break;case"gantt":this.viewType=67108864}}else this.baseViewXml=e}n.isAppView=function(e){return!!(e&&e.Hidden&&e.VisualizationInfo&&2===e.VisualizationInfo.VisualizationType&&e.VisualizationInfo.VisualizationAppInfo&&e.VisualizationInfo.VisualizationAppInfo.Id)};n.prototype.canUserEdit=function(e){if(!e||this.isReadOnly)return!1;var t=e.managePersonalViews&&this.isPersonal;return e.manageLists||t};Object.defineProperty(n.prototype,"baseViewXml",{get:function(){return this._baseViewXml},set:function(e){this._baseViewXml=e;this.clearXmlOverrides()},enumerable:!0,configurable:!0});n.prototype.getEffectiveViewXml=function(){return this.isDirty()&&this._viewDom?s.serializeToString(this._viewDom.view):this._baseViewXml};n.prototype.getEffectiveQueryXml=function(e){this._ensureDom();if(this._viewDom){return this._viewDom.query?e?s.serializeToString(this._viewDom.query):(this._viewDom.where?s.serializeToString(this._viewDom.where):"")+(this._viewDom.orderBy?s.serializeToString(this._viewDom.orderBy):"")+(this._viewDom.groupBy?s.serializeToString(this._viewDom.groupBy):""):e?"<Query/>":""}};n.prototype.updateColumnWidths=function(e){this._ensureDom();var t=this._viewDom.view.getElementsByTagName("ColumnWidth"),r=0<t.length;this._viewDom.columnWidth=r?t[0]:this._xmlDoc.createElement(m.CamlTags.columnWidth);for(var i in e){var n=e[i],o=this._viewDom.columnWidth.querySelector("[Name="+i+"]");if(o)o.setAttribute(m.CamlAttributes.width,n);else{var a=g.getFieldRefDom(this._xmlDoc,{fieldName:i});a.setAttribute(m.CamlAttributes.width,n);this._viewDom.columnWidth.appendChild(a)}}r?this._viewDom.view.replaceChild(this._viewDom.columnWidth,t[0]):this._viewDom.view.appendChild(this._viewDom.columnWidth);this.setIsDirty(!0,h.ArrangeInfoType.columnWidth)};n.prototype.getEffectiveFieldNames=function(){this._ensureDom();return this._viewDom&&this._viewDom.viewFields?r.parseViewFields(this._viewDom.viewFields):void 0};n.prototype.isDirty=function(e){return"number"==typeof e?!!this._modificationTypes&&-1!==this._modificationTypes.indexOf(e):this._isDirty};n.prototype.setIsDirty=function(e,t){(this._isDirty=e)?"number"==typeof t&&-1===this._modificationTypes.indexOf(t)&&this._modificationTypes.push(t):this._modificationTypes=[]};n.prototype.hasParseError=function(){return this._hasParseError};n.prototype.getDomParts=function(){this._ensureDom();return this._viewDom};n.prototype.clearXmlOverrides=function(){this._hasParseError=!1;this._xmlDoc=void 0;this._viewDom=void 0;this.setIsDirty(!1)};n.prototype.prepareForSaving=function(){this._ensureDom();if(this._viewDom&&this._viewDom.where)for(var e=this._viewDom.where.querySelectorAll("[id]"),t=0;t<e.length;t++){e[t].removeAttribute("id");this._isDirty||(this._isDirty=!0)}};n.prototype.updateSort=function(e,t){void 0===t&&(t={});this._ensureDom();var r=t.removeSort,i=t.overwriteAll,n=t.prepend,o=!e&&i;if(this._viewDom&&(o||e)&&(!r||this._viewDom.orderBy)){var a=this._viewDom.orderBy;if(o){a&&this._viewDom.query.removeChild(a);this._viewDom.orderBy=void 0;this.setIsDirty(!0,h.ArrangeInfoType.sorts)}else{var s=!1;if(!a&&!o){a=this._viewDom.orderBy=this._xmlDoc.createElement(m.CamlTags.orderBy);this._viewDom.query.appendChild(a);s=!0}var u=a.querySelector(d.format(m.CamlConstants.fieldNameQuery,e.fieldName));if(r){if(u){a.removeChild(u);s=!0;if(!a.childElementCount){this._viewDom.query.removeChild(a);this._viewDom.orderBy=void 0}}}else{s=!0;u&&g.updateBooleanAttr(u,m.CamlAttributes.ascending,e.isAscending);var l=void 0;if(i){for(var c=a.lastChild;c;c=a.lastChild)a.removeChild(c);l=!0}else l=!u;if(l){u=u||g.getFieldRefDom(this._xmlDoc,e);n?a.insertBefore(u,a.firstChild):a.appendChild(u)}}s&&this.setIsDirty(!0,h.ArrangeInfoType.sorts)}}};n.prototype.updateGroupBy=function(e){this._ensureDom();if(this._viewDom){var t=this._viewDom.query,r=this._viewDom.groupBy;if(e&&e.group1&&e.group1.fieldName){var i,n,o=e.isCollapsed,a=e.group1,s=e.group2;if(!r){this._viewDom.groupBy=r=this._xmlDoc.createElement(m.CamlTags.groupBy);t.appendChild(r)}g.updateBooleanAttr(r,m.CamlAttributes.collapse,o);0<r.childElementCount&&(n=(i=r.firstElementChild).nextElementSibling);g.replaceField(this._xmlDoc,a,i,r);s&&s.fieldName&&s.fieldName!==a.fieldName?g.replaceField(this._xmlDoc,s,n,r):n&&r.removeChild(n);this.setIsDirty(!0,h.ArrangeInfoType.groupBy)}else if(r){t.removeChild(r);this._viewDom.groupBy=void 0;this.setIsDirty(!0,h.ArrangeInfoType.groupBy)}}};n.prototype.updateGroupByCollapseAttribute=function(e){this._ensureDom();if(this._viewDom){var t=this._viewDom.groupBy;t&&g.updateBooleanAttr(t,m.CamlAttributes.collapse,e);this.setIsDirty(!0,h.ArrangeInfoType.groupBy)}};n.prototype.updateField=function(e,t){this._ensureDom();if(this._viewDom&&e){var r=!1,i=this._viewDom.viewFields,n=i.querySelector(d.format(m.CamlConstants.fieldNameQuery,e));if(n){r=!0;i.removeChild(n)}if("number"==typeof t){r=!0;n||(n=g.getFieldRefDom(this._xmlDoc,{fieldName:e}));t>=i.childElementCount?i.appendChild(n):0<=t&&a.default.insertAtIndex(i,n,t,m.CamlTags.fieldRef)}r&&this.setIsDirty(!0,h.ArrangeInfoType.fieldNames)}};n.prototype.replaceFields=function(e,t){this._ensureDom();if(this._viewDom&&e&&(e=e.filter(function(e){return!!e})).length){for(var r={},i=0;i<e.length;i++){r[e[i]]={index:i};t&&"boolean"==typeof t[i]&&(r[e[i]].lookupId=t[i])}for(var n=this._viewDom.viewFields,o=n.firstElementChild;o;o=o.nextElementSibling){r[c=g.getAttr(o,m.CamlAttributes.name)]&&(r[c].elem=o)}var a=this._viewDom.viewFields=this._xmlDoc.createElement(m.CamlTags.viewFields);this._viewDom.view.replaceChild(a,n);for(var s=[],u=0,l=Object.keys(r);u<l.length;u++){var c,d=r[c=l[u]];(o=d.elem)||(o=g.getFieldRefDom(this._xmlDoc,{fieldName:c,lookupId:d.lookupId}));s[d.index]=o}for(var p=0,f=s;p<f.length;p++){o=f[p];a.appendChild(o)}this.setIsDirty(!0,h.ArrangeInfoType.fieldNames)}};n.prototype.clearFilters=function(){this._ensureDom();if(this._viewDom.where){this._viewDom.query.removeChild(this._viewDom.where);this._viewDom.where=void 0;this.setIsDirty(!0,h.ArrangeInfoType.filters)}};n.prototype.addFilters=function(e){this._ensureDom();if(this._viewDom&&e&&(e=e.filter(function(e){return!!e})).length){var t,r=g.combineFilters(e,m.CamlTags.and);if(!r)throw new Error("Invalid filter: must be defined and have values");this.setIsDirty(!0,h.ArrangeInfoType.filters);try{t=g.xmlToDom(r).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}var i=this._viewDom.where;if(!i){i=this._viewDom.where=this._xmlDoc.createElement(m.CamlTags.where);this._viewDom.query.appendChild(i)}if(i.childElementCount){var n=i.firstElementChild,o=this._xmlDoc.createElement(m.CamlTags.and);o.appendChild(n);o.appendChild(t);i.appendChild(o)}else i.appendChild(t)}};n.prototype.updateRowLimit=function(e){this._ensureDom();if(this._viewDom&&e&&"number"==typeof e.rowLimit){this.rowLimit=e.rowLimit;var t=this._viewDom.rowLimit;if(!t){this._viewDom.rowLimit=t=this._xmlDoc.createElement(m.CamlTags.rowLimit);this._viewDom.view.appendChild(t)}if(t.firstChild)t.firstChild.nodeValue=String(e.rowLimit);else{var r=this._xmlDoc.createTextNode(String(e.rowLimit));t.appendChild(r)}"boolean"==typeof e.isPerPage&&g.updateBooleanAttr(t,m.CamlAttributes.paged,e.isPerPage);this.setIsDirty(!0,h.ArrangeInfoType.rowLimit)}};n.prototype.updateAll=function(e){var t=e.fieldNames,r=e.groupBy,i=e.sorts,n=e.filters;t&&t.length&&this.replaceFields(t);r&&this.updateGroupBy(r);if(i&&i.length){this.updateSort(i[0],{overwriteAll:!0});for(var o=0,a=i.slice(1);o<a.length;o++){var s=a[o];this.updateSort(s)}}if(n&&n.length&&"string"==typeof n[0]){this.clearFilters();this.addFilters(n)}};n.prototype.compareTo=function(e){if(!e)return 1;if(134217728===this.viewType&&134217728!==e.viewType)return 1;if(134217728!==this.viewType&&134217728===e.viewType)return-1;var t=(this.title||"").toLocaleLowerCase(),r=(e.title||"").toLocaleLowerCase();return t===r?0:t<r?-1:1};n.prototype._ensureDom=function(){if(this._baseViewXml&&!this._viewDom){this._isDirty=!1;this._hasParseError=!1;var t=new i.Qos({name:"View.Parse"});try{this._viewDom=r.getViewDomParts(this._baseViewXml);this._xmlDoc=this._viewDom.xmlDoc;t.end({resultType:i.ResultTypeEnum.Success})}catch(e){this._viewDom=void 0;this._xmlDoc=void 0;this._hasParseError=!0;t.end({resultType:i.ResultTypeEnum.Failure,error:e.message||JSON.stringify(e)})}}};return n}();t.default=n});define("io",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.filters=0]="filters";e[e.sorts=1]="sorts";e[e.groupBy=2]="groupBy";e[e.fieldNames=3]="fieldNames";e[e.rowLimit=4]="rowLimit";e[e.columnWidth=5]="columnWidth"}(t.ArrangeInfoType||(t.ArrangeInfoType={}))});define("hK",["require","exports","ex"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ColumnFieldType=r.ColumnFieldType;!function(e){e[e.icon=16]="icon";e[e.iconMin=16]="iconMin";e[e.bigIcon=48]="bigIcon";e[e.bigIconMin=48]="bigIconMin";e[e.regularMin=90]="regularMin";e[e.regular=130]="regular";e[e.nameMin=220]="nameMin";e[e.nameODC=440]="nameODC";e[e.nameODB=280]="nameODB";e[e.originalLocation=300]="originalLocation";e[e.custom=900]="custom";e[e.sharedWith=150]="sharedWith";e[e.note=250]="note";e[e.dateModifiedMl=150]="dateModifiedMl";e[e.dotDotDot=32]="dotDotDot";e[e.ratingsMin=110]="ratingsMin"}(t.ColumnWidth||(t.ColumnWidth={}));!function(e){e[e.none=0]="none";e[e.icon=1]="icon";e[e.name=2]="name";e[e.title=3]="title";e[e.calloutInvoker=4]="calloutInvoker";e[e.shareHeroCommand=5]="shareHeroCommand";e[e.modified=6]="modified";e[e.url=7]="url"}(t.MappedColumnType||(t.MappedColumnType={}));!function(e){e[e.none=0]="none";e[e.notify=1]="notify";e[e.block=2]="block";e[e.notifyAndBlock=3]="notifyAndBlock";e[e.blockSharing=4]="blockSharing"}(t.PolicyTipType||(t.PolicyTipType={}));!function(e){e[e.Auto=0]="Auto";e[e.Pinned=1]="Pinned";e[e.Removed=2]="Removed"}(t.ShowInFiltersPaneStatus||(t.ShowInFiltersPaneStatus={}));!function(e){e[e.fileNotFound=-2147024894]="fileNotFound";e[e.invalidView=-2147024809]="invalidView";e[e.listNotFound=-1]="listNotFound";e[e.docAlreadyExists=-2130575257]="docAlreadyExists";e[e.queryThrottled=-2147024860]="queryThrottled";e[e.newExperieceRenderingNotSupported=-2]="newExperieceRenderingNotSupported";e[e.onePageNavigationViewMismatch=-3]="onePageNavigationViewMismatch";e[e.onePageNavigationError=-4]="onePageNavigationError"}(t.ErrorType||(t.ErrorType={}))});define("hR",["require","exports","hK","im","bo","hs","bf","ey","hS"],function(e,P,E,m,g,y,v,_,b){"use strict";Object.defineProperty(P,"__esModule",{value:!0});var D=((t={})[1]={key:"type",index:0,isVisibleMobile:!0,isCollapsable:!1,type:E.ColumnFieldType.FileIcon},t[2]={key:"name",index:1,isRowHeader:!0,isVisibleMobile:!0,isCollapsable:!1,minWidth:E.ColumnWidth.nameMin,width:E.ColumnWidth.nameODB,type:E.ColumnFieldType.Name},t[3]={key:"Title",index:1,isVisibleMobile:!0,isCollapsable:!1,minWidth:E.ColumnWidth.nameMin,width:E.ColumnWidth.nameODB,type:E.ColumnFieldType.Title},t[5]={key:"_shareHeroCommand",index:2,isVisibleMobile:!1,isCollapsable:!0,minWidth:16,width:18,type:E.ColumnFieldType.ShareCommand},t[4]={key:"_calloutInvoker",index:3,isVisibleMobile:!1,isCollapsable:!0,minWidth:16,width:18,type:E.ColumnFieldType.DotDotDot},t[6]={key:"dateModified",index:4,isVisibleMobile:!0,isCollapsable:!1,minWidth:E.ColumnWidth.regularMin,width:E.ColumnWidth.regular,type:E.ColumnFieldType.DateTime,sortDescFirst:!0},t[7]={key:"URL",index:5,isVisibleMobile:!0,isCollapsable:!1,minWidth:E.ColumnWidth.nameMin,width:E.ColumnWidth.nameODB,type:E.ColumnFieldType.Hyperlink},t),k=5;P.EXCLUDED_FIELDS=["_ip_UnifiedCompliancePolicyUIAction","Edit","MediaServiceFastMetadata","name.FileSystemItemId","SMTotalFileCount","SMTotalSize"];var t,U=P.EXCLUDED_FIELDS.concat(["FolderChildCount","ItemChildCount"]),S=[E.ColumnFieldType.Text,E.ColumnFieldType.Name,E.ColumnFieldType.Title,E.ColumnFieldType.DateTime,E.ColumnFieldType.Number];!function(e){e.buildSchema=function(e,t,r,i,n){if(e&&e.Field){for(var o=-1,a=0,s=0,u=e.Field;s<u.length;s++){if("TRUE"===(g=u[s]).listItemMenu){o=a;break}a++}!r.disableCalloutInvoker&&0<=o&&e.Field.splice(o+1,0,{DisplayName:r.calloutInvokerDisplayName,Name:"_calloutInvoker",Sortable:"FALSE",Type:"Computed"});!r.disableShareHeroCommand&&0<=o&&e.Field.splice(o+1,0,{DisplayName:r.shareHeroCommandDisplayName,Name:"_shareHeroCommand",Sortable:"FALSE",Type:"Computed"});for(var l,c,d,p=new Array(r.hasFixedSchema?k:0),f={},h=0,m=e.Field;h<m.length;h++){var g,y=(g=m[h]).Name;if(-1===(r.hasFixedSchema?U:P.EXCLUDED_FIELDS).indexOf(y)){var v=w(y),_=D[v],b=C(g,_,t,r,e,n);if("TRUE"===g.GroupField&&i){i[y]=g;if(f[y])continue;b.isVisible=!1;b.isVisibleMobile=!1}p[r.hasFixedSchema&&_&&!p[_.index]?_.index:p.length]=b;f[y]=b;switch(v){case 1:l=b;break;case 2:c=b;break;case 6:d=b}}}if((t.groupBy||e.group1||e.group2)&&(!l||l!==p[0])){var S={key:"other",name:"",minWidth:E.ColumnWidth.regularMin,width:E.ColumnWidth.regular,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isAscending:!0,fieldType:E.ColumnFieldType.Text,filterable:!1,groupable:!1,resizable:!1,isGrouped:!1,isFiltered:!1};S.minWidth=I(r.useCustomColumn);S.width=x(r.useCustomColumn);S.fieldType=E.ColumnFieldType.Computed;p.unshift(S)}return r.useCustomColumn?T(l,[[c],[d]],[c,d]):p.filter(function(e){return!!e})}};function w(e){switch(e){case"FSObjType":case"DocIcon":return 1;case"LinkFilename":case"LinkFilenameNoMenu":case"FileLeafRef":return 2;case"LinkTitle":case"LinkTitleNoMenu":case"Title":case"LinkIssueIDNoMenu":return 3;case"_calloutInvoker":return 4;case"_shareHeroCommand":return 5;case"Modified":return 6;case"URLwMenu":case"URLNoMenu":return 7;default:return 0}}e.getMappedColumnType=w;function T(e,t,r){for(var i={key:"custom",name:"",minWidth:E.ColumnWidth.regularMin,width:E.ColumnWidth.custom,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:E.ColumnFieldType.Text,filterable:!1,groupable:!1,customFields:[]},n=0;n<t.length;n++)for(var o=0,a=t[n];o<a.length;o++){var s=a[o];s.customRowNumber=n;i.customFields.push(s)}for(var u=[e,i],l=0,c=r;l<c.length;l++){var d=c[l];d.isVisible=!1;d.isVisibleMobile=!1;u.push(d)}return u}e.getCustomColumns=T;e.getMappedColumnFieldType=function(e){var t=w(e.Name),r=D[t];return r?r.type:b.getColumnFieldType(e)};function C(e,t,r,i,n,o){var a=e.Name,s=t?t.type:b.getColumnFieldType(e),u=!!t&&"type"===t.key,l=-1<S.indexOf(s),c=r.filterParams||"",d=!!m.default.getFilterFieldByName(c,a);!d&&o&&o.additionalFiltersXml&&(d=!!o.additionalFiltersXml.match(new RegExp('FieldRef Name="'+a+'"')));if(r.viewXmlForRequest)try{var p=g.getViewDomParts(r.viewXmlForRequest);if(p&&p.where){1===p.where.querySelectorAll('[id="'+a+'"]').length&&(d=!0)}}catch(e){}var f={key:t?t.key:a,name:e.DisplayName,internalName:a,staticName:e.StaticName,fieldType:s,width:E.ColumnWidth.regular,minWidth:E.ColumnWidth.regularMin,isVisible:!0,isVisibleMobile:!t||t.isVisibleMobile,isCollapsable:!t||t.isCollapsable,canAutoResize:l,isIcon:u,resizable:!0,isRowHeader:!!t&&t.isRowHeader,sortable:"FALSE"!==e.Sortable,filterable:!("FALSE"===e.Filterable||"TRUE"===e.FilterDisable||"Note"===e.FieldType||"URL"===e.FieldType||"FileSizeDisplay"===a||"_IsRecord"===a),groupable:"FALSE"!==e.Groupable&&"FALSE"!==e.Sortable&&function(e,t){switch(t){case E.ColumnFieldType.Attachments:case E.ColumnFieldType.Hyperlink:case E.ColumnFieldType.Image:case E.ColumnFieldType.Note:case E.ColumnFieldType.FileSize:case E.ColumnFieldType.FileIcon:return!1;default:var r=w(e);return 2!==r&&3!==r}}(a,s),editable:!(e.FromBaseType&&"TRUE"===e.FromBaseType),isGrouped:r.groupByOverride===a||n.group1===a||n.group2===a,isSorted:r.sortField===a,isAscending:r.sortField!==a||"true"===r.isAscending,sortDescFirst:!!t&&!!t.sortDescFirst,isFiltered:d,filterValues:m.default.getFilterValueByName(c,a),isRequired:!!e.Required,isAutoHyperLink:t?i.serverSupportsAutoHyperLink:!!e.AutoHyperLink&&i.serverSupportsAutoHyperLink||s===E.ColumnFieldType.Note&&"FALSE"!==e.RichText,isAppendOnly:e.AppendOnly&&"TRUE"===e.AppendOnly,choices:e.Choices,dispFormUrl:e.DispFormUrl,pinnedToFiltersPane:e.PinnedToFiltersPane&&"TRUE"===e.PinnedToFiltersPane,showInFiltersPane:e.ShowInFiltersPane&&E.ShowInFiltersPaneStatus[e.ShowInFiltersPane],clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties,customFormatter:e.CustomFormatter,serverFieldType:e.Type,resultType:e.ResultType,isCalculated:"Calculated"===e.role,isNote:s===E.ColumnFieldType.Note&&"FALSE"===e.RichText,clientSideColumnAdapter:e.ClientSideColumnAdapter,sspId:e.SspId,termSetId:e.TermSetId,anchorId:e.AnchorId,realFieldName:e.RealFieldName,hasListItemMenu:"TRUE"===e.listItemMenu,linkToItem:!!e.LinkToItem,isLink:"URLwMenu"===e.Name&&r.listTemplateType===_.default.links};e.ID&&(f.id=e.ID);if(t){f.minWidth=u?I(i.useCustomColumn):t.minWidth;f.width=u?x(i.useCustomColumn):t.width}s===E.ColumnFieldType.SharedWith?f.width=E.ColumnWidth.sharedWith:s===E.ColumnFieldType.Note?f.width=E.ColumnWidth.note:s===E.ColumnFieldType.AverageRating?f.minWidth=E.ColumnWidth.ratingsMin:s!==E.ColumnFieldType.DateTime||v.Killswitch.isActivated("5BF871F9-43C4-415C-8FEF-5288A169E0F8","11/13/2017","Support friendly date time columns")||(f.getValue=function(e){return function(e,t){var r=void 0;e&&t&&(r=(r=h(e.key+".FriendlyDisplay",t))?y.getRelativeDateTimeStringForLists(r):h(e.key,t));return r}(f,e)});return f}function h(e,t){var r="";if(t&&void 0===(r=t[e])&&t.properties){void 0===(r=t.properties[e])&&t.recycleBinProperties&&(r=t.recycleBinProperties[e]);r&&Array.isArray(r)&&(r=r.join(", "))}return r}function x(e){return e?E.ColumnWidth.bigIcon:E.ColumnWidth.icon}function I(e){return e?E.ColumnWidth.bigIcon:E.ColumnWidth.iconMin}}(P.SchemaBuilder||(P.SchemaBuilder={}))});define("hS",["require","exports","hK"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getColumnFieldType=function(e){var t=e.FieldType;"Calculated"===t&&(t=e.ResultType);if("Computed"===t)switch(e.Name){case"FileSizeDisplay":return i.ColumnFieldType.FileSize;case"ImageSize":return i.ColumnFieldType.ImageSize;case"SharedWith":return i.ColumnFieldType.SharedWith;case"_IsRecord":return i.ColumnFieldType.ComplianceRecordFlag;case"ThumbnailOnForm":case"Thumbnail":return i.ColumnFieldType.Thumbnail;default:return i.ColumnFieldType.Computed}var r=i.ColumnFieldType[t];if("number"==typeof r)return r;switch(t){case"UserMulti":return i.ColumnFieldType.User;case"URL":return"Hyperlink"===e.Format?i.ColumnFieldType.Hyperlink:i.ColumnFieldType.Image;case"LookupMulti":return i.ColumnFieldType.Lookup;case"MultiChoice":return i.ColumnFieldType.Choice;case"TaxonomyFieldType":case"TaxonomyFieldTypeMulti":return i.ColumnFieldType.Taxonomy}return i.ColumnFieldType.Text}});define("hM",["require","exports","hQ","hO","hN"],function(e,t,g,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.buildCollapsedGroups=function(e,t,r){for(var i=[],n=0,o=void 0,a=void 0,s=(r=r||t.groupBy)[0],u=r[1],l=0,c=e;l<c.length;l++){var d=c[l];if(s&&"1"===d[s+".newgroup"]){var p=f(t,d,s,0,!0,n);i.push(p);n+=p.count;o=p;a=void 0}u&&"1"===d[u+".newgroup"]&&(a=f(t,d,u,1,!0,a?a.startIndex+a.count:o?o.startIndex:0,o))}return{groups:i,totalCount:n}};e.buildGroupFromItem=function(e,t,r,i){if((i=i||r.groupBy)&&0<i.length){var n=t&&0<t.length?t[t.length-1]:void 0,o=i[0],a=i[1];if(o&&"1"===e[o+".newgroup"]){var s=f(r,e,o,0,!1,n?n.startIndex+n.count:0);t||(t=[]);t.push(s);n=s}if(a&&"1"===e[a+".newgroup"]){var u=n&&n.children&&0<n.children.length?n.children[n.children.length-1]:void 0;f(r,e,a,1,!1,u?u.startIndex+u.count:n?n.startIndex:0,n)}}};function f(e,t,r,i,n,o,a){var s=e.groupSchema[r],u=0===i?r+".COUNT.group":r+".COUNT.group2",l=s?s.Type:void 0,c=m(t,r,l),d=t[r+".urlencoded"],p=function(e,t,r){var i=void 0;if("string"!=typeof e[t+".groupdisp"]||"DateTime"===r&&!Boolean(e[t+".groupdisp"])){if("FileSizeDisplay"===t&&e.hasOwnProperty("File_x0020_Size"))i=y.default.getDisplayString(Number(e.File_x0020_Size),{ignoreZero:!0});else if("_IsRecord"===t&&e.hasOwnProperty("_ComplianceFlags")){var n=+e._ComplianceFlags;i=4&n&&1&n?v.default.yes:v.default.no}else if(e.hasOwnProperty(t))switch(r){case"User":var o=e[t];o&&0<o.length&&(i=o[0].title);break;case"Lookup":var a=e[t];a&&(a.Label&&a.TermID?i=a.Label:0<a.length&&(i=a[0].lookupValue));break;case"WorkflowStatus":i=e[t]?g.default.getWorkflowStatusFromRawHtml(e[t]).display:"";break;case"Boolean":case"ModStat":case"Number":case"Currency":case"Text":case"DateTime":i=e[t]}}else i=e[t+".groupdisp"];"string"!=typeof i&&(i=m(e,t,r));return i}(t,r,l),f=function(e,t,r,i){var n=void 0;switch(i){case"Lookup":var o=e[t];o&&(o.Label&&o.TermID?n=o.Label+"|"+o.TermID:0<o.length&&(n=String(o[0].lookupId)));break;case"Boolean":n=e[t+".value"];break;case"User":var a=e[t];if(a&&0<a.length){var s=a[0].email;n=JSON.stringify([{Key:s,IsResolved:!1}])}break;default:n=r}return n}(t,r,c,l),h={groupingType:"SPListGroup",groupingId:(a?a.groupingId+"-":"")+(c||"(null)"),name:p,groupString:d,fieldSchema:s,fieldValue:f,count:Number(t[u]),isCollapsed:n,startIndex:o,isDropEnabled:s&&"TRUE"!==s.ReadOnly&&void 0!==f,parentKey:a?a.groupingId:void 0,level:a?a.level+1:0};if(a){a.children||(a.children=[]);a.children.push(h)}return h}e.buildGroup=f;function m(e,t,r){var i=void 0;if("DateTime"===r)i=(i=e[t]).split(" ")[0];else if(e.hasOwnProperty(t+".urlencoded")){var n=(i=decodeURIComponent(e[t+".urlencoded"])).split(";#");2<=n.length&&(i=n[n.length-2])}else"FileSizeDisplay"===t&&e.hasOwnProperty("File_x0020_Size")?i=e.File_x0020_Size:"_IsRecord"===t&&e.hasOwnProperty("_ComplianceFlags")&&(i=e._ComplianceFlags);return i}}(t.GroupBuilder||(t.GroupBuilder={}))});define("hQ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e.getItemKey=function(e,t){return t&&t.properties&&(e?t.properties.uniqueId:t.properties.ID)||t&&t.key||void 0};e.getWorkflowStatusFromRawHtml=function(e){var t=document.createElement("div");t.innerHTML=e;var r=t.querySelector("a"),i=r.querySelector("span[value]");return{url:r.href,display:r.innerText,value:i&&i.getAttribute("value")}}}(r||(r={}));t.default=r});define("hO",["require","exports","hP","cL"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,a=1024,s=1048576,u=1073741824,l=1099511627776,c=1.2.toLocaleString(r.default.language).replace(/\d+/g,""),d=/\.?0+$/;!function(e){(o||(o={})).getDisplayString=function(e,t){void 0===t&&(t={});if("number"!=typeof e||isNaN(e)||t.ignoreZero&&0===e||e<0)return"";var r=t.trimDecimal;return 1===e?n.strings.fileSizeBytesSingular:e<a?i(n.strings.fileSizeBytesPlural,e,r):e<1e3*a?i(n.strings.fileSizeKB,e/a,r):e<1e3*s?i(n.strings.fileSizeMB,e/s,r):e<1e3*u?i(n.strings.fileSizeGB,e/u,r):i(n.strings.fileSizeTB,e/l,r)};function i(e,t,r){return e.replace("{0}",function(e,t){if(100<=e||e===Math.floor(e))return e.toFixed(0);var r=e.toFixed(10<=e?1:2);return(t?r.replace(d,""):r).replace(".",c)}(t,r))}}();t.default=o});define("hc",["require","exports","ap","bN","gl","iE","aL"],function(e,t,i,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this)||this;t._pageContext=e||t.resources.consume(o.pageContext);t.dataRequestor=new n.default({},{pageContext:t._pageContext});return t}e.prototype.updateContext=function(e){a.extend(this._pageContext,e);this.dataRequestor=new n.default({},{pageContext:this._pageContext})};e.prototype.getDataSourceName=function(){return"DataSource"};e.prototype.needsRequestDigest=function(e){return!0};e.prototype.getData=function(e,t,r,i,n,o,a,s,u,l){void 0===n&&(n="POST");var c=e();return this.dataRequestor.getData({url:c,parseResponse:t,qosName:this.getDataSourceName()+"."+r,additionalPostData:i&&i(),method:n,additionalHeaders:o,contentType:a,maxRetries:s,noRedirect:u,crossSiteCollectionCall:l,needsRequestDigest:this.needsRequestDigest(c)})};return e}(r.default);t.default=s});define("id",["require","exports","ap","bN","gA","il","dH","ej","ik","dq","gK","ij","ii","ih","eO","hs","jg","ig","ib","ba","if","aM","aZ","ey","dZ","ie","iE","iC","dc","eS","eU","fO","ia","aL","hL","bA","bb","aN","f4","et"],function(e,t,Ge,r,ze,We,Xe,Qe,o,Je,Ye,Ze,$e,et,tt,rt,n,it,nt,ot,at,st,ut,lt,a,ct,s,u,l,dt,pt,c,d,ft,ht,i,mt,p,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(i){Ge.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._pageContext=t.pageContext;r._urlDataSource=t.urlDataSource;r._listContext=t.listContext;r._navigation=t.navigation;r._microServiceDataSource=t.microServiceDataSource;r._vroomUrlHelper=t.vroomUrlHelper;r._itemUrlHelper=t.itemUrlHelper;r._vroomDataContext=t.vroomDataContext;r._shortcutLinkDataSource=t.shortcutLinkDataSource;r._isActivityFeatureEnabled=t.isActivityFeatureEnabled;r._htmlDecodeDiv=document.createElement("textarea");return r}e.prototype.getItemResult=function(e){try{return this._getItemResult(e)}catch(e){p.default.log(e,"ListItemBuilder.getItemResult");throw e}};e.prototype._getItemResult=function(e){var t=e.requestKey,r=e.queryType,i=void 0===r?this._urlDataSource.getQueryType():r,n=e.itemFromServer,o=e.groupBy,a=e.itemGroups,s=e.contentTypes,u=e.supportsNestedGroups,l=e.observer;if(!n)return null;var c=this._urlDataSource.getKeyParams(t),d=this._itemUrlHelper.getUrlParts({path:n.id||n.FileRef||n.ServerRelativeUrl,listUrl:c.listurl}),p=((Ve={}).id=d.serverRelativeItemUrl,Ve.listurl=d.normalizedListUrl,Ve),f=n.File_x0020_Type,h=f?"."+f:"",m=this._getMediaServiceMetadata(n),g=this._getOfficeBundleFacet(n,h,m,d),y=this._getItemType(n,h,g,d,m);if(y===tt.default.Folder){var v=this._urlDataSource.getQueryParamValue(c),_=this._urlDataSource.getItemTypeFilter(c),b=((Be={}).view=i,Be.q=v,Be);_&&ft.extend(b,this._urlDataSource.saveItemTypeFilter(_));ft.extend(p,b)}var S=this._urlDataSource.getKey(p),w={key:S,extension:h};g&&g.cTag&&(w.officeBundle=g);var T,C,x=n.id||n.FileRef;w.id=x;var I=n[".spItemUrl"];if(I){var P=this._vroomUrlHelper.getUrlParts(I);T=P.itemId;C=P.driveId}else T=n["name.FileSystemItemId"]||(n.isRootFolder?"root":void 0);this._vroomDataContext&&T&&this._vroomDataContext.setFileSystemIdMapping(T,x);w.itemId=pt.optional(T);w.graph=pt.optional(T&&{itemId:T,driveId:C});var E=Number(n._ip_UnifiedCompliancePolicyUIAction)||0;"1"===this._navigation.viewParams.showpolicytips&&(E=Number(n.ID)%6);w.policyTip=pt.optional(E);var D=ct.isDicomFile(h);(D||".ai"===h||".eps"===h||".psd"===h)&&this._microServiceDataSource.getThumbnail({fileExtension:h,item:n,itemKey:S,mediaServiceMetadata:m})&&(y=tt.default.Media);if(".md"===h){if(k=this._microServiceDataSource.getHtmlConversionUrl({fileExtension:h,item:n,mediaServiceMetadata:m})){y=tt.default.Media;w.htmlConversion={url:k}}}if(ot.isFeatureEnabled(ot.EnableZipFilePreviewing)&&(".zip"===h||".rar"===h)){var k=this._microServiceDataSource.getZipMetaDataUrl({fileExtension:h,item:n,mediaServiceMetadata:m}),U=this._microServiceDataSource.getDownloadZipContentsUrl(n);if(k&&U){y=tt.default.Media;w.zip={zipMetaDataUrl:k,downloadZipContentsUrl:U}}}var R,F,A,O,L,M={},N=this._microServiceDataSource.getDownloadAsZipUrl(n);N&&(M[ze.default.downloadAsZip]=N);I&&(M[ze.default.itemUrl]=I);var q=this._listContext,V=Number(n.File_x0020_Size)||void 0,B=!mt.default.isActivated("3ab525c6-be7e-4cc0-8afa-df493d9f3bb7","2/22/2018","Treat small .ts files as TypeScript")&&".ts"===h&&V<1<<19;B&&(y=tt.default.File);if(y===tt.default.Folder)R=n.ProgId&&"sharepoint.documentset"===n.ProgId.toLowerCase();else if(y!==tt.default.Media||lt.isPromotedLinksList(this._listContext.listTemplateType))y===tt.default.File&&q&&void 0!==q.isDocLib&&!q.isDocLib&&(F={});else{var H=Je.getIconNameFromExtension(f);if(D)A={width:0,height:0};else{var K=m&&m.photo,j=m&&m.video,G=m&&m.audio,z=m&&m.media;"video"!==H||B?"photo"===H?A={originalUrl:n.FileRef,width:K&&K.width||0,height:K&&K.height||0}:"audio"===H&&ot.isFeatureEnabled(ot.EnableAudioPlayer)&&(L={}):O={fourCC:j&&j.fourCC||(".mp4"===h.toLowerCase()?"H264":void 0),bitrate:pt.optional(j&&j.encodingBitrate),width:j&&j.frameWidth||0,height:j&&j.frameHeight||0,duration:function(e){if("number"==typeof e&&!mt.default.isActivated("7F572FB6-3D81-4762-8499-379671FD5F86","9/20/2017","Convert 100ns video durations to ms"))return e/1e4;return e}(z&&z.duration),audioFormat:G&&G.format}}}var W=m&&m.media&&m.media.title;w.caption=pt.optional(W);A&&(w.photo=A);O&&(w.video=O);L&&(w.audio=L);w.listItem=pt.optional(F);w.isDocSet=pt.optional(R);d.serverRelativeItemUrl===d.serverRelativeListUrl&&(w.isRootFolder=!0);var X,Q=ht.ListItemBuilderHelpers.getItemName(n,y,q);w.name=pt.optional(Q);w.displayName=pt.optional(Q);var J,Y=!0;if(n.Modified&&"21"===this._pageContext.webTemplate&&ot.isFeatureEnabled(ot.RequestDatesInUtc))try{var Z=new Date(n.Modified);w.dateModifiedTime=Z;w.dateModifiedValue=Z.getTime();X=rt.getShortDisplayDate(Z);Y=!1}catch(e){}if(Y){w.dateModifiedValue=pt.optional(n.Modified);X=n["Modified.FriendlyDisplay"]?rt.getRelativeDateTimeStringForLists(n["Modified.FriendlyDisplay"]):n.Modified?""+n.Modified:""}w.dateModified=pt.optional(X||void 0);w.permissions=pt.optional(nt.default.fromHexString(n.PermMask));if(a&&o&&0<o.length)if(u){a[0]||(a[0]=[]);var $=a[0]&&0<a[0].length?a[0][a[0].length-1]:null,ee=o[0],te=o[1];if(ee&&"1"===n[ee+".newgroup"]){var re=$?$.startIndex+$.count:0,ie=ht.GroupBuilder.buildGroup(q,n,ee,0,!1,re),ne=this._convertToODNGroup(ie);a[0].push(ne);$=ne}if(te&&"1"===n[te+".newgroup"]){var oe=$&&$.children&&0<$.children.length?$.children[$.children.length-1]:null;re=oe?oe.startIndex+oe.count:$?$.startIndex:0;ht.GroupBuilder.buildGroup(q,n,te,1,!1,re,$);var ae=$.children.pop();$.children.push(this._convertToODNGroup(ae))}}else for(var se=0;se<o.length;se++){var ue=o[se];if(ue){var le=a[se]&&0<a[se].length?a[se][a[se].length-1]:null;if("1"===n[ue+".newgroup"]){re=le?le.startIndex+le.count:0,ne=ht.GroupBuilder.buildGroup(q,n,ue,se,!1,re);a[se]||(a[se]=[]);a[se].push(this._convertToODNGroup(ne))}}}if(s&&0<s.length&&n.ContentTypeId)for(var ce=0,de=s;ce<de.length;ce++){var pe=de[ce];if(n.ContentTypeId===pe.contentTypeId){J=!1;if(pe.requiredFields)for(var fe=0,he=pe.requiredFields.split(",");fe<he.length;fe++){if(!n[he[fe]]){J=!0;break}}}}w.hasMissingMetadata=pt.optional(J);w.contentTypeId=pt.optional(n.ContentTypeId);var me,ge,ye,ve,_e,be=n.folder,Se=[];if(be){w.folder={};me=[];if(be.children){for(var we=0,Te=be.children,Ce=Te.length,xe=0,Ie=0;Ie<Ce;Ie++){var Pe=this.getItemResult({requestKey:t,queryType:i,itemFromServer:Te[Ie],groupBy:o,itemGroups:Se,contentTypes:s,supportsNestedGroups:u,observer:l});if(Pe){me[Ie]=Pe.item;xe<10&&Pe.itemType===tt.default.Media&&we++;xe++}}0<Ce&&(10<=we||Ce<=we)&&(w.displayType=Xe.default.Photos)}}else{ye=(ye=n["serverurl.progid"])?ye.substring(1):Ye.canonicalizeDecodedUrl(this._itemUrlHelper.getUrlParts({path:n.FileRef,listUrl:d.normalizedListUrl}).normalizedItemUrl);M[ze.default.original]=ye;g&&(M[ze.default.viewInBrowser]=this._microServiceDataSource.getPdfConversionUrl({fileExtension:h,item:n,mediaServiceMetadata:m},!0));if(ot.isFeatureEnabled(ot.ShortcutLink)&&it.default.isShortcutItem({key:S,extension:h})){y=tt.default.Shortcut;if(n._ShortcutUrl){w.shortcutInfo={shortcutLinkRewritten:!0};M[ze.default.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,n._ShortcutUrl,n._ShortcutSiteId,n._ShortcutWebId,n._ShortcutUniqueId);n._ShortcutUniqueId&&(ge=We.previewImageUrl({url:n._ShortcutUrl,siteId:n._ShortcutSiteId,webId:n._ShortcutWebId,uniqueId:n._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))}else{w.shortcutInfo=pt.backup({shortcutLinkRewritten:!1});this._shortcutLinkDataSource.enqueueParseShortcut(S);M[ze.default.shortcutTarget]=Qe.default.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+st.default.encodeURIComponent(n.FileRef)}}M[ze.default.open]=ye;ve=n["File_x0020_Type.mapapp"]||n["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];w.size=pt.optional(V);w.totalSize=pt.optional(Number(n.SMTotalSize)||void 0);ge||(ge=this._getThumbnail(n,{extension:h,key:S,type:y,mediaServiceMetadata:m}));w.openUrl=ye;var Ee=n["IconOverlay.mapoly"];Ee&&(w.overlayUrl="/"+this._pageContext.layoutsUrl+"/images/"+Ee);w.thumbnail=ge;var De=this._getPdfConversionFacet(n,h,m);De&&(w.pdfConversion=De);var ke=this._get3dFacet(n,h,m);ke&&(w.model3d=ke);if(y===tt.default.Folder){var Ue=Number(n.ItemChildCount)+Number(n.FolderChildCount);w.childCount=Ue;var Re=Number(n.SMTotalFileCount);w.folder={totalCount:0<Re?Re:Ue,childCount:Ue}}var Fe=n.ServerRedirectedEmbedUrl;Fe&&(this._itemUrlHelper.getUrlParts({path:Fe}).isCrossDomain||(_e=Fe))}w.previewIFrameUrl=_e;w.type=y;w.appMap=pt.optional(ve);this._pageContext.blockDownloadsExperienceEnabled&&(w.type===tt.default.Media||ye&&ve)?w.itemStatus=4:this._pageContext.blockDownloadsExperienceEnabled&&y!==tt.default.Folder?w.itemStatus=3:this._pageContext.viewOnlyExperienceEnabled&&(w.itemStatus=4);w.type===tt.default.Folder&&(w.isDropEnabled=!0);var Ae={};for(var Oe in n)n.hasOwnProperty(Oe)&&(Ae[Oe]=n[Oe]);var Le=n.UniqueId&&ut.default.normalizeLower(n.UniqueId);Le&&(Ae.uniqueId=Le);w.reputationProperties=this.getReputationProperties(n);var Me,Ne=Q;h&&(Ne=Q.substring(0,Q.toLowerCase().lastIndexOf(h.toLowerCase())));Me=(w.sharingRole=0)<Number(n.PrincipalCount)?Ze.default.Shared:void 0===n.PrincipalCount?ot.isOneDrive?void 0:Ze.default.Unknown:Ze.default.Private;w.sharingType=pt.optional(Me);Ae.FileName=Ne;var qe=Je.getIconNameFromItem({extension:h,isDocSet:R,listItem:F,sharingType:Me,type:y,textEditorMimeType:B?"text/typescript":void 0});w.iconName=qe;w.defaultSubText=at.getGridSubTitleTextFromModifiedBy(at.getModifiedByFromObject(n.Editor));w.isPlaceholder=!n.PermMask;w.queryType=i;w.displayType=pt.backup(w.queryType);w.isDraggable=w.queryType===Xe.default.Files;n.folder||(Ae.modifiedByUser=at.getModifiedByUserFromObject(n.Editor));w.properties=Ae;w.lifeCycleStatus=pt.optional(this._getItemLifeCycleStatus(n));w.urls=Ge.__assign({},M,this._getVideoUrl(n,h,m));l.update([new dt.default(S).succeed({item:w})]);ot.isFeatureEnabled(ot.ItemAnalytics)&&ot.isFeatureEnabled(ot.EnableListViewTrendingSignal)&&S&&this.resources.consumeAsync($e.resourceKey).then(function(e){e.queueNewItem(S)});this._isActivityFeatureEnabled&&Le&&T&&this.resources.consumeAsync(et.resourceKey).then(function(e){e.enqueue(S)});var Ve,Be,He=this._getGroupings({itemFromServer:n,supportsNestedGroups:u,groupBy:o,groups:Se}),Ke=He.groupings,je=He.totalChildren;return{item:{key:S},itemType:y,children:me,groupings:Ke,totalChildren:je,nextRequestToken:n.nextRequestToken}};e.prototype._getItemLifeCycleStatus=function(e){var t={};1===Number(e["Created_x0020_Date.ifnew"])&&(t.isNew=!0);var r=Number(e._VirusStatus)||0;ot.isFeatureEnabled(ot.EnableATPFilesListView)&&0!==r&&3!==r&&(t.isMalwareDetected=!0);return t};e.prototype._getGroupings=function(e){var t=this,r=e.itemFromServer,i=e.supportsNestedGroups,n=e.groupBy,o=e.groups,a=null,s=this._listContext.groupLevel,u=r.folder?r.folder.childCount:0;if(r.folder&&r.folder.children&&n&&"__ItemType"===n[0])a=this._getItemTypeGroupings({itemFromServer:r});else if(-1!==s)if(r.groups){var l=[],c=0;if(i){var d=ht.GroupBuilder.buildCollapsedGroups(r.groups,this._listContext,n),p=d.groups,f=d.totalCount;l=p.map(function(e){return t._convertToODNGroup(e)});c=f}else for(var h=0,m=r.groups;h<m.length;h++){var g=m[h],y=n[s];if(g[y+".newgroup"]){var v=ht.GroupBuilder.buildGroup(this._listContext,g,y,s,!0,c);l.push(this._convertToODNGroup(v));c+=v.count}}if(l&&0<l.length){a=[{name:void 0,itemGroups:l,isAllCollapsed:this.createObservable(!0)}];u=c}}else o&&0<o.length&&o[s]&&0<o[s].length&&(a=[{name:void 0,itemGroups:o[s],isAllCollapsed:this.createObservable(!1)}]);return{groupings:a,totalChildren:u}};e.prototype._getItemTypeGroupings=function(e){for(var t,r=e.itemFromServer,i=[],n=r.folder.children,o=r.nextRequestToken?2:0,a=n.length+o,s=0;s<a;s++){var u=n[s];if(u){if(!(this._getItemTypeOneNoteOrFolder(u)===tt.default.Folder)){t=s;break}}}(void 0===t&&0<a||0<t)&&i.push({count:void 0!==t?t:a,groupingId:"folder",startIndex:0,state:this.createObservable({isCollapsed:!1})});void 0!==t&&i.push({count:a-t,startIndex:t,groupingId:"document",state:this.createObservable({isCollapsed:!1})});return i.length?[{name:"FoldersDocumentsPhotos",itemGroups:i,isAllCollapsed:this.createObservable(!1)}]:void 0};e.prototype.getReputationProperties=function(e){for(var t={},r=0,i=o.default;r<i.length;r++){var n=i[r];t[n]=pt.optional(e[n])}return t};e.prototype._getPdfConversionFacet=function(e,t,r){var i=this._microServiceDataSource.getPdfConversionUrl({fileExtension:t,item:e,mediaServiceMetadata:r});if(i)return{url:i}};e.prototype._get3dFacet=function(e,t,r){var i=this._microServiceDataSource.getFbxConversionUrl({fileExtension:t,item:e}),n=f.canRenderNative(t);if(i||n)return{canConvertToFbx:!0,canRenderNative:n,fbxConversionUrl:i}};e.prototype._getOfficeBundleFacet=function(e,t,r,i){var n,o,a,s=e["File_x0020_Type.mapapp"],u=!i.isCrossDomain&&("ms-word"===s&&ot.isFeatureEnabled(ot.EnableWordWrsPreview)||"ms-powerpoint"===s&&ot.isFeatureEnabled(ot.EnablePowerPointWrsPreview)||"ms-visio"===s&&ot.isFeatureEnabled(ot.EnableOneUpVisioPreview)||"ms-excel"===s&&ot.isFeatureEnabled(ot.EnableOneUpExcelPreview)),l=("ms-word"===s||"ms-powerpoint"===s||"ms-visio"===s||"ms-excel"===s)&&e["serverurl.progid"]&&!this._pageContext.blockDownloadsExperienceEnabled&&("21"===this._pageContext.webTemplate||ot.isFeatureEnabled(ot.EnableWrsPreviewOutsideODB)),c=this._microServiceDataSource.getOfficeBundleGenerateUrl({fileExtension:t,item:e,mediaServiceMetadata:r}),d=this._microServiceDataSource.getOfficeBundleGetFragmentUrl({fileExtension:t,item:e,mediaServiceMetadata:r}),p=!1,f="",h=e[".ctag"],m=r&&r.officeBundle;if(m){n=m.ctag;a=m.version;p=m.fatalError||!1;m.generationTime&&(o=new Date(m.generationTime));f=m.errorInfo||""}if(l)return{officeBundleGenerateUrl:c,officeBundleGetFragmentUrl:d,bundleCTag:n,bundleVersion:a,hasBundleGenerationFailed:p,bundleErrorInfo:f,generationTime:o,cTag:h,enableDefaultClick:u}};e.prototype._getThumbnail=function(e,t){if(t.type!==tt.default.Folder){if(lt.isPromotedLinksList(this._listContext.listTemplateType))return{url:e.BackgroundImageLocation,width:0,height:0};var r=this._microServiceDataSource.getThumbnail({fileExtension:t.extension,allowCookieAuth:this._listContext.listTemplateType===lt.ListTemplateType.mySiteDocumentLibrary,itemKey:t.key,item:e,mediaServiceMetadata:t.mediaServiceMetadata});if(r)return r;if(ct.fileTypeSupportsPreview(t.extension)){if(this._listContext.remoteParentWeb){var i=new Qe.default(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(Qe.UriPartial.authority),n=encodeURI(e.FileRef);return We.previewImageUrlFromUrl(st.default.encodeURIComponent(i+n),this._pageContext.webAbsoluteUrl,this._pageContext)}return We.previewImageUrl(e,this._pageContext.webAbsoluteUrl,this._pageContext)}}};e.prototype._getVideoUrl=function(e,t,r){var i=this._microServiceDataSource.getVideoUrl({fileExtension:t,item:e,mediaServiceMetadata:r}),n={};i&&(n[ze.default.video]=i);return n};e.prototype._getItemType=function(e,t,r,i,n){var o=this._getItemTypeOneNoteOrFolder(e);if(o===tt.default.Unknown){var a=e.File_x0020_Type,s=a?"."+a:"";ot.isFeatureEnabled(ot.ShortcutLink)&&it.default.isShortcutFileType(a)?o=tt.default.Shortcut:ot.isFeatureEnabled(ot.UseWebPdfViewer)&&("pdf"===a||this._getPdfConversionFacet(e,s,n))?o=tt.default.Media:"cool"===a||this._get3dFacet(e,s,n)?o=tt.default.Media:"audio"===Je.getIconNameFromExtension(s)&&ot.isFeatureEnabled(ot.EnableAudioPlayer)?o=tt.default.Media:(o=Je.getItemTypeFromExtension(s))===tt.default.Unknown&&lt.isGenericList(this._listContext.listTemplateType)?o=tt.default.File:o===tt.default.Unknown&&lt.isPromotedLinksList(this._listContext.listTemplateType)&&(o=tt.default.Media)}return o||tt.default.File};e.prototype._getItemTypeOneNoteOrFolder=function(e){var t;if(e.folder)t=tt.default.Folder;else if("1"===e.FSObjType){var r=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],i=e["File_x0020_Type.mapapp"];t=i&&"onenote"===i.substring(0,7)||r&&-1!==r.indexOf("onenote")?tt.default.OneNote:tt.default.Folder}else t=tt.default.Unknown;return t};e.prototype._convertToODNGroup=function(e){var t=this,r=e;r.state=this.createObservable({isCollapsed:e.isCollapsed});r.children&&0<r.children.length&&(r.children=e.children.map(function(e){return t._convertToODNGroup(e)}));return r};e.prototype._getMediaServiceMetadata=function(e){var t=e.MediaServiceFastMetadata;if(!t)return{};try{this._htmlDecodeDiv.innerHTML=t;return JSON.parse(this._htmlDecodeDiv.innerText)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}};e.dependencies=Ge.__assign({},r.default.dependencies,{pageContext:s.pageContext,urlDataSource:a.url,listContext:s.listContext,navigation:l.navigation,microServiceDataSource:a.microService,vroomUrlHelper:d.resourceKey,itemUrlHelper:c.resourceKey,vroomDataContext:u.dataContext.optional,shortcutLinkDataSource:n.resourceKey,isActivityFeatureEnabled:h.isActivityFieldEnabledResourceKey});return e}(r.default);t.default=m;t.resourceKey=i.createResolvedResourceKey(e("module").id,m)});define("ik",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"]});define("ij",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"}(r||(r={}));t.default=r});define("ii",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"Rr",getModule:function(){return new t.default(function(e,t){r(["Rr"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("ih",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"Ro",getModule:function(){return new t.default(function(e,t){r(["Ro"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("ib",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e.fromHexString=function(e,t){var r=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},i=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(i){var n=void 0,o=void 0;if((e=(e=i[2]||"0").slice(-16)).length<=8){n=0;o=parseInt(e,16)}else{n=parseInt(e.slice(0,-8),16);o=parseInt(e.slice(-8),16)}if(!isNaN(n)&&!isNaN(o)){r.High=n;r.Low=o}}return r};e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})};e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}}(r=t.Double||(t.Double={}));t.default=r});define("if",["require","exports","iq","V"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getGridSubTitleTextFromModifiedBy=function(e){return e?i.format(r.strings.gridViewSubTitle,e):""};t.getModifiedByFromObject=function(e){var t=e&&e[e.length-1];return t?t.title||t.Title:""};t.getModifiedByUserFromObject=function(e){var t=e&&e[e.length-1];return{title:t&&t.title,email:t&&t.email,picture:t&&"/_layouts/15/userphoto.aspx?size=S&accountname="+t.email}};t.getModifiedByFromString=function(e){return e?e.substr(e.lastIndexOf("\n")+1):""};t.FOLDER_CONTENT_TYPE_PREFIX="0x0120";t.isFolderContentType=function(e){return e&&e.slice(0,6)===t.FOLDER_CONTENT_TYPE_PREFIX}});define("ie",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[".dcm",".dcm30",".dic",".dicm",".dicom"],i={".docm":!0,".dotm":!0,".dotx":!0,".docx":!0,".bmp":!0,".jpg":!0,".jpeg":!0,".tiff":!0,".tif":!0,".png":!0,".gif":!0,".emf":!0,".wmf":!0,".psd":!0,".svg":!0,".ai":!0,".eps":!0,".pdf":!0,".pptm":!0,".pptx":!0,".potm":!0,".potx":!0,".ppsm":!0,".ppsx":!0,".xlsm":!0,".xlsx":!0,".aspx":!0};t.fileTypeSupportsPreview=function(e){return!!e&&i[e.toLowerCase()]};t.isDicomFile=function(e){return 0<=r.indexOf(e)}});define("ia",["require","exports","ap","bN","ej","bA"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getUrlParts=function(e){return new s(e)};return t}(i.default);t.default=a;var s=function(){function e(e){this._url=e}Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!0,configurable:!0});e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment();if(-1<t){var r=this._getPathSegments();e=r[t+1]}this._getDriveId=function(){return e};return e};e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(-1<t){var r=this._getPathSegments();e=r[t+1]}this._getItemId=function(){return e};return e};e.prototype._getPathSegments=function(){var e,t=this._url;e=t?new n.default(t).getPathSegments():[];this._getPathSegments=function(){return e};return e};e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");this._getIndexOfDrivesSegment=function(){return e};return e};e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");this._getIndexOfItemsSegment=function(){return e};return e};return e}();t.resourceKey=o.createResolvedResourceKey(e("module").id,a)});define("f4",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["3mf","fbx","obj","ply","stl"],i=["cool","gltf","glb"];function n(e){return e.replace(".","").toLowerCase()}t.canConvertToFbx=function(e){return!!e&&0<=r.indexOf(n(e))};t.canRenderNative=function(e){return!!e&&0<=i.indexOf(n(e))}});define("et",["require","exports","ba","bA","eu"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isActivityFieldVisibleResourceKey=new i.ResourceKey({name:e("module").id+".isActivityFieldVisible",factory:{dependencies:{},create:function(){return{instance:new n.ABExperiment({name:"ItemActivityColumnExperiment",startDate:"04/30/2018",targetType:n.TargetType.user}).IsExperimentOn()}}}});t.isActivityFieldEnabledResourceKey=new i.ResourceKey({name:e("module").id+".isActivityFieldEnabled",factory:new i.ConstantResourceFactory(r.isFeatureEnabled(r.ItemActivityColumn))})});define("h8",["require","exports","a0","dH","dZ","eS","ic","iE","aL","eO","ib","ey","eU","fO","ia","gK","dJ","bA","h9","bb"],function(e,t,z,W,r,X,C,i,h,Q,x,J,Y,n,o,Z,$,a,ee,te){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var re=!1;var s=function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._pageContext=t.pageContext;this._itemUrlHelper=t.itemUrlHelper;this._vroomUrlHelper=t.vroomUrlHelper;this._resources=t.resources}e.prototype.processResponse=function(e){var t=e.response,r=e.response,i=r.HttpRoot,n=r.ListData,o=r.rootFolder,a=r.ListSchema,s=(void 0===a?{}:a).Collapse,u=void 0===s?"FALSE":s,l=e.requestKey,c=e.observer,d=this._urlDataSource.getKeyParams(l),p="TRUE"===u,f=this._itemUrlHelper.getItemUrlParts(l),h=this._itemUrlHelper.getUrlParts({path:f.serverRelativeListUrl,listUrl:f.fullListUrl});i&&this._processWeb({list:t,requestKeyParts:d,observer:c});this._processList({list:t,listUrlParts:h,requestKeyParts:d,observer:c});var m=[];if(o){var g=this._processRootFolder({list:t,listUrlParts:h,requestKeyParts:d,observer:c});m.push.apply(m,g.parentItemUrls)}if(n&&!p){g=this._processListData({listData:n,listUrlParts:h,parentKey:l,requestKeyParts:d,observer:c});m.push.apply(m,g.parentItemUrls)}var y={};if(t.ParentInfo)for(var v=0,_=t.ParentInfo.ParentFolderInfo;v<_.length;v++){var b=_[v];y[b.ServerRelativeUrl]=x.default.fromHexString(b.Permissions)}for(var S=0,w=C.removeDuplicates(m);S<w.length;S++){var T=w[S];this._processParentItem({itemUrl:T,listUrlParts:h,parentInfo:y,requestKeyParts:d,observer:c})}};e.prototype._processListData=function(e){for(var t=e.listData.Row,r=e.parentKey,i=e.requestKeyParts,n=e.listUrlParts,o=e.observer,a=[],s="",u=0,l=t;u<l.length;u++){var c=l[u],d=c.FileRef,p=this._processRow({row:c,observer:o,requestKeyParts:i,listUrlParts:n}).key;a.push.apply(a,this._getParentItemUrls({listUrlParts:n,itemUrl:d}));o.update([new X.default(p).succeed({set:{parent:{key:r},after:{key:s}}})]);s=p}return{parentItemUrls:a}};e.prototype._processRow=function(e){var t=e.row,r=e.row.FileRef,i=e.listUrlParts,n=e.requestKeyParts,o=e.observer,a=this._itemUrlHelper.getUrlParts({path:r,listUrl:i.fullListUrl}),s=((l={}).id=a.serverRelativeItemUrl,l.listurl=a.normalizedListUrl,l);if(this._isFolder(t)){var u=((c={}).view=n.view,c.q=n.q,c.typeFilters=n.typeFilters,c);h.extend(s,u)}var l,c,d=this._urlDataSource.getKey(s),p=this._getParentKeyForListItem({listUrlParts:i,itemUrl:r,requestKeyParts:n}),f={key:d};p&&(f.parentKey=p);o.update([new X.default(d).succeed({item:f})]);return{key:d}};e.prototype._processRootFolder=function(e){var t,r,i=e.list,n=e.listUrlParts,o=e.requestKeyParts,a=e.observer,s=i.rootFolder,u=this._itemUrlHelper.getUrlParts({path:s,listUrl:n.fullListUrl}),l=this._urlDataSource.getKey(((r={}).id=u.serverRelativeItemUrl,r.listurl=u.normalizedListUrl,r.view=o.view,r.q=o.q,r.typeFilters=o.typeFilters,r)),c=this._getParentKeyForListItem({listUrlParts:n,itemUrl:s,requestKeyParts:o}),d={key:l,type:Q.default.Folder,newWOPIDocumentEnabled:Y.optional(i.NewWOPIDocumentEnabled)};c&&(d.parentKey=c);i.ListData&&(t=i.ListData.FolderId);d.properties={ID:Y.optional(t)};if(!this._isListRoot({itemUrl:s,listUrlParts:n})){var p=s.split("/").slice(-1)[0];d.name=p;d.displayName=p}a.update([new X.default(l).succeed({item:d})]);return{parentItemUrls:this._getParentItemUrls({listUrlParts:n,itemUrl:s})}};e.prototype._processWeb=function(e){var t,r=e.list,i=e.requestKeyParts,n=e.observer,o=r.HttpRoot,a=r.SiteTitle,s=Z.getSharePointPath(o),u=this._itemUrlHelper.getUrlParts({path:s,webUrl:s}),l=this._urlDataSource.getKey(((t={}).id=u.normalizedItemUrl,t.view=W.default.DocumentLibraries,t.typeFilters=i.typeFilters,t)),c={},d={key:l,type:Q.default.Folder,subsite:c};if(this._pageContext.webAbsoluteUrl===s){d.name=a;d.displayName=a;c.webTemplateId=Number(this._pageContext.webTemplate);c.serverRelativeUrl=this._pageContext.webAbsoluteUrl;c.id=this._pageContext.webId;c.siteCollectionId=this._pageContext.siteId;c.title=this._pageContext.webTitle;c.icon=this._pageContext.webLogoUrl}n.update([new X.default(l).succeed({item:d})])};e.prototype._processList=function(e){var t,r,i,n=e.list,o=e.listUrlParts,a=e.requestKeyParts,s=e.observer,u=n.ListTitle,l=n.HttpRoot,c=n.listUrlDir,d=this._urlDataSource.getKey(((H={}).id=o.serverRelativeItemUrl,H.listurl=o.normalizedListUrl,H.view=a.view,H.q=a.q,H.typeFilters=a.typeFilters,H)),p=n.AllowCreateFolder,f=n.EnableMinorVersions,h=n.verEnabled,m=n.AllowGridMode,g=n.DisableGridEditing,y=n.ListTemplateType,v=n.BasePermissions,_=void 0===v?{}:v,b=_.ManageLists,S=void 0===b?void 0:b,w=_.ManagePersonalViews,T=void 0===w?void 0:w,C=_.OpenItems,x=void 0===C?void 0:C,I=_.UseClientIntegration,P=void 0===I?void 0:I,E=n.ListSchema,D=void 0===E?{}:E,k=D.DefaultItemOpen,U=void 0===k?void 0:k,R=D[".driveAccessTokenV21"],F=void 0===R?void 0:R,A=D[".driveAccessToken"],O=void 0===A?void 0:A,L=n.ExcludeFromOfflineClient,M=n.WebExcludeFromOfflineClient;if(O){t={accessToken:(N=$.deserializeQuery(O)).access_token,proofToken:N.prooftoken}}if(F){var N;r={accessToken:(N=$.deserializeQuery(F)).access_token,proofToken:N.prooftoken}}if(l){var q=Z.getSharePointPath(l),V=this._itemUrlHelper.getUrlParts({path:q,webUrl:q});i=this._urlDataSource.getKey(((K={}).id=V.normalizedItemUrl,K.view=W.default.DocumentLibraries,K.typeFilters=a.typeFilters,K))}var B="string"==typeof U?"0"===U:void 0;B&&function(){if(!re){z.Engagement.logData({name:"List.openInClient"});re=!0}}();var H,K,j=n.ListSchema&&n.ListSchema[".driveUrl"],G=this._vroomUrlHelper.getUrlParts(j);s.update([new X.default(d).succeed({item:{key:d,parentKey:Y.optional(i),itemId:Y.backup("root"),graph:{itemId:Y.backup("root"),driveId:Y.optional(G.driveId),sessionToken:Y.optional(t),sessionTokenV21:Y.optional(r)},type:Q.default.Folder,name:Y.optional(u),displayName:Y.optional(u),isRootFolder:!0,isDropEnabled:!0,newWOPIDocumentEnabled:Y.optional(n.rootFolder?void 0:n.NewWOPIDocumentEnabled),list:{id:Y.optional(n.listName),allowGridMode:"boolean"==typeof m?m:Y.backup(!0),allowCreateFolder:Y.optional(p),disableGridEditing:"boolean"==typeof g?g:Y.backup(!1),enableMinorVersions:Y.optional(f),enableVersions:Y.optional(h),templateType:Y.optional("string"==typeof y?Number(y):void 0),isDocumentLibrary:Y.optional("string"==typeof y?J.isDocumentLibrary(y):void 0),isPromotedLinks:Y.optional("string"==typeof y?J.isPromotedLinksList(y):void 0),isModerated:Y.optional(n.isModerated),newWOPIDocumentEnabled:Y.optional(n.NewWOPIDocumentEnabled),newWOPIDocumentTypes:Y.optional(n.NewWOPIDocumentTypes),permissions:{manageLists:Y.optional(S),managePersonalViews:Y.optional(T),openItems:Y.optional(x),useClientIntegration:Y.optional(P)},openInClient:Y.optional(B),excludeFromOfflineClient:Y.optional("boolean"==typeof L||"boolean"==typeof M?L||M:void 0),contentTypesEnabled:Y.optional(n.ContentTypesEnabled),metadataNavFeatureEnabled:Y.optional(n.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:Y.optional(n.canUserCreateMicrosoftForm),itemCount:Y.optional(n.ListSchema&&n.ListSchema.ItemCount),rowLimit:Y.optional(n.ListData.RowLimit),listUrlDir:decodeURIComponent(c)},properties:{commandsSupported:Y.optional(n.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})]);te.default.isActivated("AA918EC4-B203-49D2-9EF6-0DB64E830D56","1/09/2018","Disable list token update automatically")||this._resources.consumeAsync(ee.resourceKey).then(function(e){e.trackListToken(d)})};e.prototype._processParentItem=function(e){var t,r=e.itemUrl,i=e.listUrlParts,n=e.parentInfo,o=e.requestKeyParts,a=e.observer,s=this._itemUrlHelper.getUrlParts({path:r,listUrl:i.fullListUrl}),u=this._urlDataSource.getKey(((t={}).id=s.serverRelativeItemUrl,t.listurl=s.normalizedListUrl,t.view=o.view,t.q=o.q,t.typeFilters=o.typeFilters,t)),l={key:u,parentKey:this._getParentKeyForListItem({listUrlParts:i,itemUrl:r,requestKeyParts:o})};if(this._isListRoot({itemUrl:r,listUrlParts:i}))l.list={};else{var c=Z.getFolderNameFromPath(r);l.name=c;l.displayName=c;l.type=Q.default.Folder;l.isDropEnabled=!0;n&&n[r]&&(l.permissions=n[r])}a.update([new X.default(u).succeed({item:l})])};e.prototype._getParentKeyForListItem=function(e){var t,r,i=e.listUrlParts,n=e.itemUrl,o=e.requestKeyParts;if(i.serverRelativeListUrl!==n){var a=n.split("/").slice(0,-1).join("/"),s=this._itemUrlHelper.getUrlParts({path:a,listUrl:i.fullListUrl});t=this._urlDataSource.getKey(((r={}).id=s.serverRelativeItemUrl,r.listurl=s.normalizedListUrl,r.view=o.view,r.q=o.q,r.typeFilters=o.typeFilters,r))}return t};e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,r=e.itemUrl,i=[],n=t.serverRelativeListUrl;if(0===r.indexOf(n))for(var o="",a=0,s=r.substring(n.length).split("/").slice(1,-1);a<s.length;a++){var u=""+n+(o+="/"+s[a]);i.push(u)}return i};e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t};e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var r=e["File_x0020_Type.mapapp"],i=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(r&&"onenote"===r.substring(0,7)||i&&-1!==i.indexOf("onenote"))}else t=!1;return t};e.dependencies={urlDataSource:r.url,pageContext:i.pageContext,itemUrlHelper:n.resourceKey,vroomUrlHelper:o.resourceKey,resources:a.resourceScopeKey};return e}();t.default=s;t.resourceKey=a.createResolvedResourceKey(e("module").id,s)});define("h9",["require","exports","aC","c7","bA"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:r("module").id,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({path:"YB",getModule:function(){return new t.default(function(e,t){r(["YB"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("h7",["require","exports","eS","dZ","dH","eO","dq","fO","bA"],function(e,t,d,r,p,f,h,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._itemUrlHelper=t.itemUrlHelper}e.prototype.processSubsite=function(e){var t,r=e.subsite,i=e.requestKey,n=e.unique,o=e.observer,a=this._urlDataSource.getKeyParams(i),s=this._itemUrlHelper.getUrlParts({path:r.serverRelativeUrl,webUrl:r.serverRelativeUrl}),u=this._urlDataSource.getKey(((t={}).id=s.normalizedItemUrl,t.view=p.default.DocumentLibraries,t.typeFilters=a.typeFilters,t.u=n,t)),l=h.getIconNameFromItem({type:f.default.Folder}),c={key:u,isRootFolder:!0,isPlaceholder:!1,name:r.title,displayName:r.title,type:f.default.Folder,iconName:l,subsite:r,queryType:p.default.DocumentLibraries};o.update([new d.default(u).succeed({item:c})]);return{key:u}};e.dependencies={urlDataSource:r.url,itemUrlHelper:i.resourceKey};return e}();t.default=o;t.resourceKey=n.createResolvedResourceKey(e("module").id,o)});define("h4",["require","exports","ap","h5"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(i,t)});define("h5",["require","exports","ap","h6","bd","ef","aC","aI","a0","aZ"],function(e,t,r,a,i,n,s,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.GROUPINGID_NEXT="__next__";var o=function(o){r.__extends(e,o);function e(e){return o.call(this,e.pageContext)||this}e.prototype.getDataSourceName=function(){return"ListItemDataSource"};e.prototype.getItem=function(e,t,r,i){var n=this;e.postDataContext.isOnePage=!!e.newTargetListUrl;return o.prototype.getData.call(this,function(){return n.getUrl(t,e)},function(e){return n._parseResponse(e,r.qosEvent)},r.qosName,function(){return n.getAdditionalPostData(e.postDataContext,t)},"POST",a.getListRequestHeaders(t,e.postDataContext),void 0,void 0,void 0,void 0,this._qosHandler,i).then(function(e){return e},function(e){n._errorHandler(r.qosName,e);return s.default.reject(e)})};e.prototype.getUrl=function(e,t){var r=t&&t.postDataContext,i={webUrl:this._pageContext.webAbsoluteUrl,listId:e.listId,urlParts:e.urlParts||{},searchTerm:e.searchTerm,rootFolder:e.folderPath};if(this._isSpecifiedItemRequest(e))i.viewId=e.viewIdForRequest;else{(!e.viewXmlForRequest||r&&r.isOnePage)&&e.viewIdForRequest!==c.default.Empty&&(i.view=e.viewIdForRequest);!i.view&&e.viewPathForRequest&&(i.viewPath=e.viewPathForRequest);t&&t.ignoreFilterParams||(i.filterParams=e.filterParams);if(e.sortField){i.sortField=e.sortField;i.sortDir="false"===e.isAscending?"Desc":"Asc"}r&&r.groupReplace?i.requestToken=this._isExpandingGroup(i)?void 0:e.requestToken:i.requestToken=e.group?void 0:e.requestToken;!this._isExpandingGroup(e)||r&&r.groupReplace||(i.groupString=e.group.groupString);r&&r.webId&&(i.webId=r.webId)}return a.getListDataUrl(i)};e.prototype.getAdditionalPostData=function(e,t){return i.getAdditionalPostData(e,t)};e.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&0<e.itemIds.length};e.prototype._isExpandingGroup=function(e){return e.group&&e.group.groupingId!==t.GROUPINGID_NEXT};e.prototype._parseResponse=function(t,r){try{if(void 0!==t)return JSON.parse(t)}catch(e){if("{}"!==t.substring(0,2)){r.end({resultType:u.ResultTypeEnum.Failure,resultCode:"BadJSON"});throw e}return JSON.parse(t.substring(2))}};e.prototype._qosHandler=function(e){var t=e&&e.code?e.code:"";return t=-1<t.indexOf("2147024860")?"ListViewTreshold":-1<t.indexOf("2147024749")?"LookupColumnTreshold":-1<t.indexOf("2147024809")&&-1<t.indexOf("requestUrl")?"RequestURLFailure":-1<t.indexOf("2147024809")&&-1<t.indexOf("range")?"RangeError":-1<t.indexOf("2147024809")&&-1<t.indexOf("view")?"InvalidView":-1<t.indexOf("2130575340")&&-1<t.indexOf("field")?"FieldTypesNotInstalledProperly":-1<t.indexOf("2146232832")?"DefaultDoclibNotFound":-1<t.indexOf("2147024895")?"PrefetchWebMismatch":e.status.toString()};e.prototype._errorHandler=function(e,t){var r=t&&t.code?t.code:"";-1<r.indexOf("2147024860")?l.default.logData({name:e+".ListViewTreshold"}):-1<r.indexOf("2147024749")&&l.default.logData({name:e+".LookupColumnTreshold"})};return e}(n.default);t.SPListItemRetriever=o;t.default=o});define("h3",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"aBq",getModule:function(){return new t.default(function(e,t){r(["aBq"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("h2",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"UT",getModule:function(){return new t.default(function(e,t){r(["UT"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("h1",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"U2",getModule:function(){return new t.default(function(e,t){r(["U2"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("h0",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"E5",getModule:function(){return new t.default(function(e,t){r(["E5"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("hZ",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"vI",getModule:function(){return new t.default(function(e,t){r(["vI"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("hY",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"vQ",getModule:function(){return new t.default(function(e,t){r(["vQ"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("hX",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"vK",getModule:function(){return new t.default(function(e,t){r(["vK"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("hW",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"Va",getModule:function(){return new t.default(function(e,t){r(["Va"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("hV",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"U5",getModule:function(){return new t.default(function(e,t){r(["U5"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("hU",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:""+r("module").id,loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"Vd",getModule:function(){return new t.default(function(e,t){r(["Vd"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("hI",["require","exports","ap","ef","aM","hK","bl","bj","im","hJ"],function(e,t,i,r,s,u,n,o,l,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e.pageContext)||this;t._listContext=e.listContext;t._itemUrlHelper=e.itemUrlHelper||new n.ItemUrlHelper({},{pageContext:e.pageContext});t._apiUrlHelper=e.apiUrlHelper||new o.ApiUrlHelper({},{pageContext:e.pageContext,itemUrlHelper:t._itemUrlHelper});t._folderPath=e.folderPath;void 0===t._folderPath&&(t._folderPath=a.getFolderPath(e.parentKey,t._listContext));return t}e.prototype.getFilterData=function(e,t,r,i){var n=this;return this.getData(function(){return n._getFilterDataUrl(e,t,r,i)},function(e){return e},"GetFilterData")};e.prototype._getFilterDataUrl=function(e,t,r,i){var n=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl}),o=this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e);r&&(o=o.parameter("ViewId",r));this._folderPath&&(o=o.parameter("RootFolder",{raw:s.default.encodeURIComponent(this._folderPath)}));i&&i===u.ColumnFieldType.Taxonomy&&(o=o.parameter("ExcludeFieldFilteringHtml",!0));var a=l.default.getFilterParams(t,!0);return(o=o.rawParameter(a)).toString()};return e}(r.default);t.ListFilterDataSource=c;t.default=c});define("hJ",["require","exports","br","dK"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFolderPath=function(e,t){var r=i.deserializeQuery(e).id;t&&t.urlParts&&(r===t.urlParts.fullListUrl||r===t.urlParts.serverRelativeListUrl)&&(r=void 0);return r};t.buildItemKey=function(e,t){var r=e;0!==r.indexOf("id")&&(r=n.serializeQuery({id:e,listurl:t}));return r}});define("hD",["require","exports","ap","bN","in","hc","ey","fZ","fO","hH","hG","ba","hE","aC","aI","bA","iE"],function(e,t,r,n,u,i,s,o,a,l,c,d,p,f,h,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NeedsAttentionViewId="f9ebc8b2-a976-48f0-a8fa-0846164c0466";var y=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo"].join(","),v=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,t.pageContext)||this;r._apiUrlHelper=t.apiUrlHelper;r._itemUrlHelper=t.itemUrlHelper;return r}e.prototype.getView=function(e,t){var r=this;return this.getData(function(){return r._getViewApiUrl(e,t).oDataParameter("$select",y).toString()},function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d,!0)},"GetView",null,"GET")};e.prototype.getViews=function(e,t){var r=this;return this.getData(function(){return r.getListApiUrl(e).segment("Views").oDataParameter("$select",y).toString()},function(e){return JSON.parse(e).d.results.map(function(e){return r._viewFromServerView(e,!1,t)}).filter(function(e){return!!e})},"GetViews",null,"GET")};e.prototype.createView=function(e,t){var r,i=this,n=e.viewParams,o=e.sourceView,a=n.useFiltersInViewXml?void 0:this._getFilterParams(n),s=!1,u=!1,l=!1,c=!1;return h.Qos.instrumentPromise({name:"ListDataSource.CreateView"},function(){return i._addView(e,t).then(function(e){if(!e)throw new Error("No view returned by /Views/Add");r=e;s=!0;if(a){c=!0;return i._saveLegacyFilters(r,a,t)}}).then(function(){u=!0;if(o.scope){c=!0;return i.modifyView({id:r.id,scope:o.scope},t)}}).then(function(){l=!0;return c?i.getView({id:r.id},t):r}).then(null,function(e){s&&a&&!u&&i.deleteView(r.id,t);return e})},null,function(e){return f.default.isCanceled(e)?{resultType:h.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:{resultType:h.ResultTypeEnum.Failure,resultCode:s?u?l?c?"SecondGetView":"Unknown":"SaveScope":"SaveFilters":"CreateView",error:e}})};e.prototype.saveView=function(e,t){var r=this,i=e.sourceView,n=e.viewParams,o=e.updateViewXml,a=n.useFiltersInViewXml?void 0:this._getFilterParams(n),s=!1,u=!1;return h.Qos.instrumentPromise({name:"ListDataSource.SaveView"},function(){return r._setViewXml(e,t).then(function(){s=!0;if(a)return r._saveLegacyFilters(i,a,t)}).then(function(){u=!0;return o?r.getView({id:i.id},t):null}).then(function(e){o&&e&&(i.baseViewXml=e.baseViewXml)})},null,function(e){return f.default.isCanceled(e)?{resultType:h.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:{resultType:h.ResultTypeEnum.Failure,resultCode:s?u?"UpdateView":"SaveAsNewView":"SetViewXml",error:e}})};e.prototype.deleteView=function(e,t){var r=this;return this.getData(function(){return r._getViewApiUrl({id:e},t).toString()},function(){},"DeleteView",null,"POST",{"X-HTTP-Method":"DELETE"})};e.prototype.modifyView=function(e,t){var r=this,i={__metadata:{type:"SP.View"},DefaultView:e.isDefault,Title:e.title};"number"==typeof e.scope&&(i.Scope=e.scope);return this.getData(function(){return r._getViewApiUrl({id:e.id},t).toString()},function(e){return e},"ModifyView",function(){return JSON.stringify(i)},"PATCH",{"X-HTTP-Method":"PATCH"})};e.prototype.createMappedView=function(e,t,r){var i=this,n={appViewCreationInfo:{Title:e.title,AppId:e.appId,IsPrivate:e.isPrivate},visualizationTarget:t};return this.getData(function(){return i.getListApiUrl(r).segment("CreateMappedView").toString()},function(e){var t=JSON.parse(e);return i._viewFromServerView(t.d)},"CreateMappedView",function(){return JSON.stringify(n)},"POST")};e.prototype.getMappedApp=function(e,t,r){var i=this;return this.getData(function(){return i.getListApiUrl(r).segment("GetMappedApp").oDataParameter("$expand","AppMappedViews").toString()},function(e){return i.appSynchronizationResultFromMappedApps(e,!0)},"GetMappedApp",function(){return JSON.stringify({appId:e,visualizationAppTarget:t})},"POST")};e.prototype.getMappedApps=function(e,t){var r=this;return this.getData(function(){return r.getListApiUrl(t).segment("GetMappedApps").oDataParameter("$expand","AppMappedViews").toString()},function(e){return r.appSynchronizationResultFromMappedApps(e,!1)},"GetMappedApps",function(){return JSON.stringify({visualizationAppTarget:e})},"POST")};e.prototype.publishMappedView=function(e,t,r){var i=this;return this.getData(function(){return i.getListApiUrl(r).segment("PublishMappedView").toString()},function(e){var t=JSON.parse(e);return i._viewFromServerView(t.d)},"PublishMappedView",function(){return JSON.stringify({appId:e,visualizationTarget:t})},"POST")};e.prototype.unpublishMappedView=function(e,t,r){var i=this;return this.getData(function(){return i.getListApiUrl(r).segment("UnpublishMappedView").toString()},function(e){var t=JSON.parse(e);return i._viewFromServerView(t.d)},"UnpublishMappedView",function(){return JSON.stringify({appId:e,visualizationTarget:t})},"POST")};e.prototype.getFlowTemplates=function(e,t){var r=this,i=t&&d.isFeatureEnabled(d.FlowTemplateVersioning)?function(){return JSON.stringify({category:t})}:null;return this.getData(function(){return r.getListApiUrl(e).segment("SyncFlowTemplates").toString()},function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var r=JSON.parse(e);t.synchronizationDataObject=r.d;t.synchronizationStatus=r.d.SynchronizationStatus;return t},"GetFlowTemplates",i,"POST",null,null,null,!0)};e.prototype.getFlowInstance=function(e,t){var r=this;return this.getData(function(){return r.getListApiUrl(t).segment("SyncFlowInstance").toString()},function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var r=JSON.parse(e);t.synchronizationDataObject=r.d;t.synchronizationStatus=r.d.SynchronizationStatus;return t},"GetFlowInstance",function(){return JSON.stringify({flowID:e})},"POST",null,null,null,!0)};e.prototype.getFlowInstances=function(e){var t=this;return this.getData(function(){return t.getListApiUrl(e).segment("SyncFlowInstances").toString()},function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var r=JSON.parse(e);t.synchronizationDataObject=r.d;t.synchronizationStatus=r.d.SynchronizationStatus;return t},"GetFlowInstances",null,"POST",null,null,null,!0)};e.prototype.getFlowCallbackUrl=function(e,t){var r=this;return this.getData(function(){return r.getListApiUrl(t).segment("SyncFlowCallbackUrl").toString()},function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var r=JSON.parse(e);t.synchronizationDataObject=r.d;t.synchronizationStatus=r.d.SynchronizationStatus;return t},"GetFlowCallbackUrl",function(){return JSON.stringify({flowId:e})},"POST",null,null,null,!0)};e.prototype.modifyFieldProperties=function(e,t){var r=this,i=e.id,n={__metadata:{type:"SP.Field"},Title:e.displayName,SchemaXml:e.fieldDescription,ShowInFiltersPane:e.showInFiltersPane};return this.getData(function(){return r.getListApiUrl(t).method("Fields",i).toString()},function(e){return null},"ModifyFieldProperties",function(){return JSON.stringify(n)},"POST",{"X-HTTP-Method":"MERGE"})};e.prototype.setContentApproval=function(e,t){var r=this,i={__metadata:{type:"SP.List"},EnableModeration:e};return this.getData(function(){return r.getListApiUrl(t).toString()},function(e){return null},"SetContentApproval",function(){return JSON.stringify(i)},"POST",{"IF-MATCH":"*","X-HTTP-Method":"MERGE"})};e.prototype.appSynchronizationResultFromMappedApps=function(e,t){var r=this,i=JSON.parse(e),n=i&&i.d;if(!n)return null;var o=[];n.AppMappedViews&&n.AppMappedViews.results&&(o=n.AppMappedViews.results.map(function(e){return r._viewFromServerView(e)}));var a=null;try{a=JSON.parse(n.SynchronizationData);(t?a&&a.name&&a.properties:a&&a.value)||(a={id:null,name:null,properties:{createdBy:null,createdTime:null,displayName:null,isPrivate:!0,permissions:null}});for(var s=t?[a]:a.value,u=0,l=s;u<l.length;u++){var c=l[u].properties;c.isPrivate=!c.permissions||!c.permissions.some(function(e){return e.properties&&e.properties.principal&&"Tenant"===e.properties.principal.type})}}catch(e){}return{appMappedViews:o,synchronizationData:i.d.SynchronizationData,synchronizationDataObject:a,synchronizationStatus:i.d.SynchronizationStatus}};e.prototype.getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e,listUrl:e});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)};e.prototype.getDataSourceName=function(){return"ListDataSource"};e.prototype._addView=function(e,t){var r=this,i=e.title,n=e.sourceView,o=e.viewParams,a=e.isPublic,s=this._combineViewParamsAndXml(n,o);s.prepareForSaving();return this.getData(function(){return r.getListApiUrl(t).segment("Views").segment("Add").toString()},function(e){var t=JSON.parse(e);return new u.default(t.d)},"AddView",function(){return JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:i,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:n.getEffectiveFieldNames()},Query:s.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!a,RowLimit:n.rowLimit}})})};e.prototype._combineViewParamsAndXml=function(e,t){var r=new u.default(e.getEffectiveViewXml());if(t){if(t.sortField){var i={fieldName:t.sortField,isAscending:"false"!==t.isAscending};r.updateSort(i,{overwriteAll:!0})}t.groupBy&&r.updateGroupBy({group1:{fieldName:t.groupBy,isAscending:!0}});if(d.isFeatureEnabled(d.SaveColumnResize)){var n=localStorage.getItem("SPColumnSize-Unsaved-"+e.id);if(n){r.updateColumnWidths(JSON.parse(n));localStorage.removeItem("SPColumnSize-Unsaved-"+e.id)}}}return r};e.prototype._getFilterParams=function(e){for(var t={},r=!1,i=0,n=Object.keys(e||{});i<n.length;i++){var o=n[i];if(l.filterKeyRegex.test(o)){r=!0;t[o]=e[o]}}return r?t:void 0};e.prototype._saveLegacyFilters=function(e,t,r){var i=this;return this.getData(function(){return i.getListApiUrl(r).methodWithAliases("SaveAsNewView",{oldName:e.id,newName:e.title,privateView:!!e.isPersonal,uri:i._pageContext.webAbsoluteUrl+p.default.getInplviewHash(e.id,t)}).toString()},function(e){var t=JSON.parse(e);return t&&t.d&&t.d.SaveAsNewView},"SaveViewFilters")};e.prototype._setViewXml=function(e,t){var r=this,i=e.sourceView,n=e.viewParams,o=this._combineViewParamsAndXml(i,n);o.prepareForSaving();return i.isDirty()||o.isDirty()?this.getData(function(){return r._getViewApiUrl({id:i.id},t).method("SetViewXml").toString()},function(){return null},"UpdateView",function(){return JSON.stringify({viewXml:o.getEffectiveViewXml()})}):f.default.wrap()};e.prototype._getViewApiUrl=function(e,t){return c.isViewById(e)?this.getListApiUrl(t).method("Views",e.id):c.isViewByUrl(e)?this._apiUrlHelper.build().webByUrl({path:t,listUrl:t}).method("GetViewFromUrl",e.url):this.getListApiUrl(t).method("Views",e.title)};e.prototype._viewFromServerView=function(e,t,r){if(e.ViewType&&e.Id){var i=d.isFeatureEnabled(d.PowerApps)&&u.default.isAppView(e),n=e.Hidden&&!i,o=r===s.default.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!n&&!o){var a=new u.default(e);if(a.viewType)return a}}return null};e.dependencies=r.__assign({},n.default.dependencies,{pageContext:g.pageContext,apiUrlHelper:o.resourceKey,itemUrlHelper:a.resourceKey});return e}(i.default);t.default=v;t.resourceKey=m.createResolvedResourceKey(e("module").id,v)});define("hH",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sortGroupKeyRegex=/^(sortField|isAscending|groupBy)$/;t.filterKeyRegex=/^Filter(Field|Value|Type)(s?)([1-9]|10)$/});define("hG",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isViewById=function(e){return e&&!!e.id};t.isViewByUrl=function(e){return e&&!!e.url};t.isViewByTitle=function(e){return e&&!!e.title}});define("hE",["require","exports","hF","aM","aZ","im"],function(e,t,n,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function o(){}o.getFilterList=function(e,t,r,i){return s.default.getFilterList(e,t,r,i,n.strings.EmptyFilterValue)};o.clearFilterInfo=function(e,t){t=t||0;for(var r=o.getFilterList(e),i=t;i<r.length;i++){var n=r[i];e=s.default.addFilterInfo(e,n.fieldName,null,!0)}return e};o.getInplviewHash=function(e,r){var t="#InplviewHash"+(e=a.default.normalizeLower(e||"",!1))+"=";r&&(t+=Object.keys(r).map(function(e){var t=i.default.encodeURIComponent(r[e]);return i.default.encodeURIComponent((e+"="+t).replace(/-/g,"--"))}).join("-"));return t};return o}();t.default=r});define("hC",["require","exports","aC","bA","c7","bN"],function(r,e,t,i,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:r("module").id+".mruRecentListDataSource",loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"UU",getModule:function(){return new t.default(function(e,t){r(["UU"],e,t)})},getExport:function(e){return e.resourceKey}})})});e.loadTimeResourceKey=new i.ResourceKey({name:r("module").id+".mruRecentLoadTime",factory:{dependencies:{observablesFactoryType:o.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(null),disposables:t}}}});e.default=e.resourceKey});define("hB",["require","exports","V","U"],function(e,t,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t,r){var i,n,o;switch(e){case-2147024894:i=t.ItemNotFoundTitle;n=t.ItemNotFoundSubText;break;case-2147024809:i=t.InvalidViewTitle;n=t.InvalidViewSubText;break;case-1:i=t.InvalidListTitle;n=t.InvalidListSubText;break;case-2147024860:i=t.DefaultTitle;var a='<a href="'+u.default.encodeText("https://support.office.com/en-us/article/Manage-lists-and-libraries-with-many-items-b8588dae-9387-48c2-9248-c24122f07c59")+'">'+t.QueryThrottledLinkText+"</a>";o=s.format(t.QueryThrottledSubText,a);break;case-4:o=i=null;break;default:i=t.DefaultTitle;n=t.DefaultSubText}return{errorCode:e,errorDetailedText:n,errorTitle:i,errorDetailedHtml:o,correlationId:r}}t.generateError=r;t.default=r});define("U",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/[<>&'"\\]/g,i={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","\\":"&#92;"};function n(e){return i[e]}var o=function(){function e(){}e.encodeText=function(e){return e?e.replace(r,n):""};return e}();t.default=o});define("gt",["require","exports","aI"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;function n(e){if(!i){var t=e||{name:"App"};i=new r.Qos(t)}return i}t.init=n;t.restart=function(){i=void 0;return n()};t.reset=function(){i=void 0};t.logSuccess=function(e){i||n();i.end(e||{resultType:r.ResultTypeEnum.Success})};t.logUnexpectedFailure=function(e){i||n();i.end(e||{resultType:r.ResultTypeEnum.Failure})};t.logExpectedFailure=function(e){i||n();i.end(e||{resultType:r.ResultTypeEnum.ExpectedFailure})};t.logEndData=function(e){i||n();e&&i.end(e)}});define("hA",["require","exports","ba"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isTeamChannelFolder=function(e){var t=!!e&&!!e.folder,r=e&&e.properties.ProgId,i=!!r&&0===r.toLowerCase().indexOf("team.channel");return n()&&t&&i};function n(){return r.isFeatureEnabled(r.TeamChannelFolder)}t.isTeamChannelBannerEnabled=n});define("hy",["require","exports","ap","hc","dZ","ba","eN","aC","aP"],function(e,t,i,r,n,o,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._urlDataSource=t.resources.consume(n.url);return t}e.prototype.getCapabilities=function(){this._capabilities={supportsMoveCopy:!0,supportsMoveCopyOnShared:!1,supportsMoveCopyFilterParams:!0,supportsCopyCrossSite:o.isFeatureEnabled(o.CopyCrossSiteFromTeamSite),supportsMoveCrossSite:o.isFeatureEnabled(o.MoveCrossSite),supportsThrottling:!0,supportsProgressCaching:!0};return this._capabilities};e.prototype.copyItemsAsync=function(e){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+"/_api/site/CreateCopyJobs"},this._parseCopyResponse,"CopyAsyncPrime",function(){return t._getCopyItemsAsyncPostData(e)},"POST").then(function(e){return e},function(e){var t=e.code?e.code.split(","):e.error.code.split(","),r={code:Number(t[0]),message:e.message&&e.message.value};return s.default.wrapError(r)})};e.prototype.hasMatchingId=function(e,t){return t&&t.properties.ID&&t.properties.ID===e};e.prototype._parseCopyResponse=function(e){var t;try{t=JSON.parse(e)}catch(e){u.Verbose.logData({name:"MoveCopyDataSource._parseCopyResponse.InvalidJson",message:e})}var r=t&&t.d&&t.d.CreateCopyJobs&&t.d.CreateCopyJobs.results,i=r&&r[0]&&r[0].JobId;return{id:i,jobInfo:{spData:r},progress:[{id:i,status:a.ITaskStatuses[a.ITaskStatuses.NotStarted]}]}};e.prototype._getCopyItemsAsyncPostData=function(e){for(var t={exportObjectUris:[]},r=0,i=e.items;r<i.length;r++){var n=i[r];t.exportObjectUris.push(this._urlDataSource.getItemUrl(n.key))}t.destinationUri=this._urlDataSource.getItemUrl(e.targetKey);t.options={IgnoreVersionHistory:!0};e.isMove&&(t.options.IsMoveMode=!0);e.allowSchemaMismatch&&(t.options.AllowSchemaMismatch=!0);e.allowSmallerVersionLimit&&(t.options.AllowSmallerVersionLimitOnDestination=!0);return JSON.stringify(t)};return e}(r.default);t.default=l});define("eN",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.NotStarted=0]="NotStarted";e[e.InProgress=1]="InProgress";e[e.Completed=2]="Completed";e[e.Cancelled=3]="Cancelled";e[e.Failed=4]="Failed";e[e.Unknown=5]="Unknown"}(t.ITaskStatuses||(t.ITaskStatuses={}))});define("hx",["require","exports","ap","aC","bN","dZ"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){r.__extends(e,t);function e(e){void 0===e&&(e={});return t.call(this,e)||this}e.prototype.prefetchPeopleCards=function(t,r){this._getPeopleCardDataSource().then(function(e){e.prefetchPeopleCards(t,r)})};e.prototype.getPeopleCard=function(t,r){return this._getPeopleCardDataSource().then(function(e){return e.getPeopleCard(t,r)})};e.prototype.getOrgChart=function(t){return this._getPeopleCardDataSource().then(function(e){return e.getOrgChart(t)})};e.prototype.getDocuments=function(t,r){return this._getPeopleCardDataSource().then(function(e){return e.getDocuments(t,r)})};e.prototype.prefetchDocuments=function(t,r){this._getPeopleCardDataSource().then(function(e){e.prefetchDocuments(t,r)})};e.prototype._getPeopleCardDataSource=function(){var t=this;return this._peopleCardDataSource?i.default.as(this._peopleCardDataSource):this.resources.consume(o.peopleCardFactory)().then(function(e){return t._peopleCardDataSource=e})};return e}(n.default);t.default=a});define("hw",["require","exports","gm"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var e=this.mediaBaseUrl="odsp-media";r.default.addPaths({"@ms/odsp-media/lib":e})};t.default=i});define("gm",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.addConfig=function(e){window.require.config(e)};e.addPaths=function(e){window.require.config({paths:e})};e.addShims=function(e){window.require.config({shim:e})};return e}();t.default=r});define("hv",["require","exports","ap","hc","eq"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._connectionUrl="";t._connectionUrl=n.getSafeWebServerRelativeUrl(t._pageContext)+"/_api/Site/ShareByLinkEnabled";return t}e.prototype.getShareByLinkInfo=function(){var e=this;return this.getData(function(){return e._connectionUrl},function(e){var t=JSON.parse(e);return t&&t.d?{isExternalSharingTipEnabled:!!t.d.ShareByLinkEnabled}:null},"GetShareByLinkInfo")};e.prototype.getDataSourceName=function(){return"ShareByLinkDataSource"};return e}(r.default);t.default=o});define("hu",["require","exports","ap","bN","dZ"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._dataSource=t.resources.consume(n.shareByLink);return t}e.prototype.getShareByLinkInfo=function(){return this._dataSource.getShareByLinkInfo().then(function(e){return e})};return e}(r.default);t.default=o});define("hd",["require","exports","ap","hs","fZ","hc","ba","eq","eA","eO","g9","gO","he","ep","iE","ey"],function(e,t,r,u,n,i,c,o,a,d,s,l,p,f,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._apiUrlHelper=t.resources.consume(n.resourceKey);t._itemParentHelper=t.resources.consume(a.resourceKey);t._sharingDataSourceHelper=new(t.managed(s.default));t._sharingContextInformation=t.resources.consume(h.sharingContextInformation.optional);t._sharingDataSourceCommon=new p.SharingDataSource({pageContext:e,getParentListId:t._getParentListId.bind(t),apiUrlHelper:t._apiUrlHelper,sharingContextInformation:t._sharingContextInformation,usesSharingAbilities:c.isFeatureEnabled(c.SharingAbilities)});var r=o.getSafeWebServerRelativeUrl(t._pageContext);t._createAnonymousLinkMethodName="CreateAnonymousLink";t._createAnonymousLinkUrl=r+"/_api/SP.Web."+t._createAnonymousLinkMethodName;t._createAnonymousLinkWithExpirationMethodName="CreateAnonymousLinkWithExpiration";t._createAnonymousLinkWithExpirationUrl=r+"/_api/SP.Web."+t._createAnonymousLinkWithExpirationMethodName;t._createOrganizationLinkMethodName="CreateOrganizationSharingLink";t._createOrganizationLinkUrl=r+"/_api/SP.Web."+t._createOrganizationLinkMethodName;t._disableAnonymousLinkMethodName="DeleteAnonymousLinkForObject";t._disableAnonymousLinkUrl=r+"/_api/SP.Web."+t._disableAnonymousLinkMethodName;t._disableOrganizationLinkMethodName="DestroyOrganizationSharingLink";t._disableOrganizationLinkUrl=r+"/_api/SP.Web."+t._disableOrganizationLinkMethodName;t._managePermissionsUrl=r+"/_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo";t._unshareUrl=r+"/_api/SP.Web.UnshareObject";return t}e.prototype.getSharingInformation=function(e,t){return this._sharingDataSourceCommon.getSharingInformation(l.convertToISPListItem(e),t)};e.prototype.emailWithoutPermissioning=function(e,t,r){return this._sharingDataSourceCommon.emailWithoutPermissioning(e,l.convertToISPListItem(t),r)};e.prototype.checkPermissions=function(e,t){return this._sharingDataSourceCommon.checkPermissions(e,l.convertToISPListItem(t))};e.prototype.share=function(e,t){var r={items:t.items.map(function(e){return l.convertToISPListItem(e)}),roleValue:t.roleValue,message:t.message,sendEmail:t.sendEmail,requireSignIn:t.requireSignIn,propagateSharing:t.propagateSharing,linkType:t.linkType,expiration:t.expiration};return this._sharingDataSourceCommon.share(e,r)};e.prototype.unshare=function(i){var e,t=this,r=this._sharingDataSourceHelper.canUseSecurable(i);if(r){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,i);e=n.segment("UnshareObject").toString()}else e=this._unshareUrl;return this.getData(function(){return e},function(e){var t=JSON.parse(e).d,r={};r.statusCode=t.StatusCode;r.errorMessage=t.ErrorMessage;r.itemId=i.id;return r},"StopSharing",function(){var e={};r||(e.url=t._sharingDataSourceHelper.getFileUrl(i));return JSON.stringify(e)})};e.prototype.updatePermissions=function(o,a,s){var e,u=this,l=this._sharingDataSourceHelper.canUseSecurable(a);if(l){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a);e=t.segment("UpdateDocumentSharingInfo").toString()}else e=this._managePermissionsUrl;return this.getData(function(){return e},function(e){var t=JSON.parse(e).d,r=[];t.UpdateDocumentSharingInfo&&t.UpdateDocumentSharingInfo.results&&(r=t.UpdateDocumentSharingInfo.results);var i={statusCode:0,errorMessage:null};i.people=p.SharingDataSource.parsePeople(r);i.itemId=a.id;return i},"ManagePermissions",function(){var e,t=[];switch(s){case 5:e=0;break;case 1:e=1;break;case 6:e=6;break;case 2:e=2;break;default:e=1}for(var r=0;r<o.length;r++){var i={UserId:o[r].userId,Role:e};t.push(i)}var n={userRoleAssignments:t,validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:a.type===d.default.Folder&&c.isFeatureEnabled(c.RecursiveUnsharing)};l||(n.resourceAddress=u._sharingDataSourceHelper.getFileUrl(a));return JSON.stringify(n)})};e.prototype.updatePermissions2=function(e,t,r){return this._sharingDataSourceCommon.updatePermissions2(e,l.convertToISPListItem(t),r)};e.prototype.parseRawSharingInformation=function(e){return this._sharingDataSourceCommon.parseRawSharingInformation(e)};e.prototype.manageSharingLinks=function(n,o){var a=this,e=this._createAnonymousLinkUrl,t="CreateAnonymousSharingLink",s=this._createAnonymousLinkMethodName;if(this._sharingDataSourceHelper.canUseSecurable(n[0].item)){var r={items:[n[0].item],expiration:o.expiration,linkType:o.type,roleValue:o.role.toString()};return(o.create?this._getSharingLink.bind(this):this._deleteSharingLink.bind(this))(r,n[0],o.role)}if(o.expiration){e=this._createAnonymousLinkWithExpirationUrl;t="CreateAnonymousSharingLinkWithExpiration";s=this._createAnonymousLinkWithExpirationMethodName}if(!o.create){e=this._disableAnonymousLinkUrl;t="DisableAnonymousSharingLink";s=this._disableAnonymousLinkMethodName}if(9===o.type){e=o.create?this._createOrganizationLinkUrl:this._disableOrganizationLinkUrl;t=o.create?"CreateOrganizationSharingLink":"DisableOrganizationSharingLink";s=o.create?this._createOrganizationLinkMethodName:this._disableOrganizationLinkMethodName}return this.getData(function(){return e},function(e){var t=JSON.parse(e).d,r=[],i={};i.url=t[s]?a._sharingDataSourceHelper.encodeSharingLink(t[s]):"";i.type=o.type;i.role=o.role;i.expiration=a._sharingDataSourceHelper.getExpirationFromLink(i.url);i.isActive=!!i.url;n[0].setLink(i);t[s]&&r.push(i);return r},t,function(){var e={url:a._sharingDataSourceHelper.getFileUrl(n[0].item),isEditLink:2===o.role};o.expiration&&(e.expirationString=u.convertDateToISOString(o.expiration));return JSON.stringify(e)})};e.prototype.unshareLink=function(e){var t={item:l.convertToISPListItem(e.item),kind:e.kind,shareId:e.shareId};return this._sharingDataSourceCommon.unshareLink(t)};e.prototype.shareLink=function(e){var t={emailData:e.emailData,items:e.items.map(function(e){return l.convertToISPListItem(e)}),recipients:e.recipients,settings:e.settings};return this._sharingDataSourceCommon.shareLink(t)};e.prototype.supportsExistingAccessOption=function(e){var t=!0;if(e){var r=this._getRootItem(e,"list");r&&(t=r.list.templateType===m.default.mySiteDocumentLibrary)}var i=Number(this._pageContext.webTemplate);return i===f.default.teamSite||i===f.default.group||!t};e.prototype.getClientId=function(){return this._sharingDataSourceCommon.getClientId()};e.prototype.getDataSourceName=function(){return"SharingDataSource"};e.prototype._deleteSharingLink=function(n,o,a){var s=this,e=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n.items[0]).segment("DeleteLinkByKind").toString();return this.getData(function(){return e},function(e){var t=JSON.parse(e).d,r=[],i={};i.url=t.DeleteLinkByKind?s._sharingDataSourceHelper.encodeSharingLink(t.DeleteLinkByKind.sharingLinkInfo.Url):"";i.type=n.linkType;i.role=a;i.expiration=s._sharingDataSourceHelper.getExpirationFromLink(i.url);i.isActive=!!i.url;o.setLink(i);t.DeleteLinkByKind&&r.push(i);return r},"DeleteLinkByKind",function(){var e={linkKind:s._getSharingLinkKind(n.linkType,n.roleValue)};return JSON.stringify(e)})};e.prototype._getSharingLink=function(n,o,a){var s=this,e=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n.items[0]).segment("ShareLink").toString();return this.getData(function(){return e},function(e){var t=JSON.parse(e).d,r=[],i={};i.url=t.ShareLink?s._sharingDataSourceHelper.encodeSharingLink(t.ShareLink.sharingLinkInfo.Url):"";i.type=n.linkType;i.role=a;i.expiration=s._sharingDataSourceHelper.getExpirationFromLink(i.url);i.isActive=!!i.url;o.setLink(i);t.ShareLink&&r.push(i);return r},"GetLinkViaShareLink",function(){var e=null;n.expiration&&(e=u.convertDateToISOString(n.expiration));var t={request:{emailData:null,linkKind:s._getSharingLinkKind(n.linkType,n.roleValue),createLink:!0,expiration:e}};return JSON.stringify(t)})};e.prototype._getSharingLinkKind=function(e,t){var r=1;6===e?r=5:5===e?r=4:9===e&&(r=t===2..toString()?3:2);return r};e.prototype._getRootItem=function(e,t){var r=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,t));return r||null};e.prototype._getParentListId=function(e){var t=l.convertToIOneDriveItem(e);return this._sharingDataSourceHelper.getParentListId(t)};return e}(i.default);t.default=g});define("g9",["require","exports","ap","iE","bN","eA","fO","ha","gO","gK","ej"],function(e,t,i,n,r,o,a,s,u,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._itemParentHelper=t.resources.consume(o.resourceKey);t._itemUrlHelper=t.resources.consume(a.resourceKey);t._sharingContextInformation=t.resources.consume(n.sharingContextInformation.optional);t._sharingDataSourceHelperCommon=new s.default({itemUrlHelper:t._itemUrlHelper,sharingContextInformation:t._sharingContextInformation});return t}e.prototype.encodeSharingLink=function(e){if(!e)return e;var t=e.split("?");return l.encodePath(t[0],!0)+(t[1]?"?"+t[1]:"")};e.prototype.getApiRoot=function(e,t){var r=this.getParentListId(t);return this._sharingDataSourceHelperCommon.getApiRoot(e,u.convertToISPListItem(t),r)};e.prototype.getExpirationFromLink=function(e){if(e&&-1<e.indexOf("expiration=")){var t=new c.default(e).getQueryParameter("expiration");t.indexOf("Z")!==t.length-1&&(t=t.replace(/\+/g," ")+" UTC");var r=Date.parse(t);if(r)return new Date(r).toString()}return null};e.prototype.getExpirationFromSharingLinkInfo=function(e){return""!==e?e:null};e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl};e.prototype.getParentListId=function(e){var t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return t?t.list.id:e&&e.properties?e.properties.listId:null};e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(!!t.ID||!!t.uniqueId)};return e}(r.default);t.default=d});define("ha",["require","exports","gK"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._sharingContextInformation=e.sharingContextInformation}e.prototype.getApiRoot=function(e,t,r){if(this._sharingContextInformation)return this._sharingContextInformation.listUrl?e.build().webByUrl({listUrl:this._sharingContextInformation.listUrl}).method("GetListItem",this._sharingContextInformation.serverRelativeItemUrl):this._sharingContextInformation.itemUrl?e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetFileByUrl",o.canonicalizeUrl(this._sharingContextInformation.itemUrl)).segment("ListItemAllFields"):e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetListItemByResourceId",this._sharingContextInformation.resourceId);var i;i=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var n=e.build().webByItemUrl(i).method("Lists",r);return n=t.properties.ID?n.method("GetItemById",t.properties.ID):n.method("GetItemByUniqueId",t.properties.uniqueId)};e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl};e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(!!t.ID||!!t.uniqueId)};return e}();t.default=r});define("he",["require","exports","ap","hs","bl","bj","ef","bc","hf","eq","dp","ha","ep"],function(e,c,t,d,n,o,r,u,m,a,g,s,p){"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.EDIT_ROLE="role:1073741827";c.VIEW_ROLE="role:1073741826";c.SharingAbilities={ODB:378};c.SharingSupportsEmailAuthGuest={ODB:469};c.PeopleSharingLinks={ODB:781};var i=function(i){t.__extends(l,i);function l(e){var t=i.call(this,e.pageContext)||this;t._usesSharingAbilities=e.usesSharingAbilities||u.default.isFeatureEnabled(c.SharingAbilities);t._getParentListId=e.getParentListId;t._itemUrlHelper=e.itemUrlHelper||new n.ItemUrlHelper({},{pageContext:e.pageContext});t._apiUrlHelper=e.apiUrlHelper||new o.ApiUrlHelper({},{pageContext:e.pageContext,itemUrlHelper:t._itemUrlHelper});t._sharingContextInformation=e.sharingContextInformation||void 0;t._sharingDataSourceHelper=new s.default({itemUrlHelper:t._itemUrlHelper,sharingContextInformation:t._sharingContextInformation});var r=a.getSafeWebServerRelativeUrl(t._pageContext);t._shareUrl=r+"/_api/SP.Web.ShareObject";return t}l.parsePeople=function(e){return e.map(function(e){var t={role:l.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:t}})};l.parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;case 6:return 6;default:return 1}};l.prototype.getDataSourceName=function(){return"SharingDataSource"};l.prototype.getSharingInformation=function(r,e){var t,i=this,n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r,this._getParentListId(r)).segment("GetSharingInformation");t=this._usesSharingAbilities&&!e?n.oDataParameter("$Expand","pickerSettings").toString():n.oDataParameter("$Expand","permissionsInformation,pickerSettings").toString();return this.getData(function(){return t},function(e){var t=JSON.parse(e);return i._parseGetSharingInformationResponse(t,r)},"GetSharingInformation",null,"POST",null,null,null,!0)};l.prototype.emailWithoutPermissioning=function(o,u,a){var e=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,u,this._getParentListId(u)).segment("ForwardObjectLink").toString();return this.getData(function(){return e},function(e){var t=JSON.parse(e).d,r=[];t.UniquelyPermissionedUsers&&t.UniquelyPermissionedUsers.results&&(r=t.UniquelyPermissionedUsers.results);var i=[];t.InvitedUsers&&t.InvitedUsers.results&&(i=t.InvitedUsers.results);var n={};n.statusCode=t.StatusCode;n.errorMessage=t.ErrorMessage;n.people=l.parsePeople(r);n.invitedUsers=l.parsePeople(i);n.itemId=u&&u.id;0<i.length&&(n.invitationLink=i[0].InvitationLink);n.invalidEmails=[];if(t.UsersWithInvalidEmails&&t.UsersWithInvalidEmails.results)for(var o=0,a=t.UsersWithInvalidEmails.results;o<a.length;o++){var s=a[o];n.invalidEmails.push(s.User)}return n},"ForwardObjectLink",function(){for(var e=[],t=0,r=o;t<r.length;t++){var i=r[t];e.push(i.rawPersonData)}var n={peoplePickerInput:JSON.stringify(e),emailBody:a};return JSON.stringify(n)})};l.prototype.checkPermissions=function(t,e){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("CheckPermissions").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);if(t.d){return t.d.CheckPermissions.results}return null},"CheckPermissions",function(){var e={recipients:t};return JSON.stringify(e)})};l.prototype.share=function(n,u){var e,o=this,a=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(u.items[0]);if(9===u.linkType||6===u.linkType||5===u.linkType)return this._shareLink(n,u);if(a){var t=u.items[0],r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t));e=r.segment("ShareObject").toString()}else e=this._shareUrl;return this.getData(function(){return e},function(e){var t=JSON.parse(e).d,r=[];t.UniquelyPermissionedUsers&&t.UniquelyPermissionedUsers.results&&(r=t.UniquelyPermissionedUsers.results);var i=[];t.InvitedUsers&&t.InvitedUsers.results&&(i=t.InvitedUsers.results);var n={};n.statusCode=t.StatusCode;n.errorMessage=t.ErrorMessage;n.people=l.parsePeople(r);n.invitedUsers=l.parsePeople(i);n.itemId=u.items[0]&&u.items[0].id;0<i.length&&(n.invitationLink=i[0].InvitationLink);n.invalidEmails=[];if(t.UsersWithInvalidEmails&&t.UsersWithInvalidEmails.results)for(var o=0,a=t.UsersWithInvalidEmails.results;o<a.length;o++){var s=a[o];n.invalidEmails.push(s.User)}return n},"Share",function(){for(var e=[],t=0;t<n.length;t++){var r=n[t];e.push(r.rawPersonData)}u.roleValue===2..toString()?u.roleValue=c.EDIT_ROLE:u.roleValue===1..toString()&&(u.roleValue=c.VIEW_ROLE);var i={peoplePickerInput:JSON.stringify(e),roleValue:u.roleValue,sendEmail:u.sendEmail,emailBody:u.message,includeAnonymousLinkInEmail:!u.requireSignIn,propagateAcl:u.propagateSharing,useSimplifiedRoles:!0};a||(i.url=o._sharingDataSourceHelper.getFileUrl(u.items[0]));return JSON.stringify(i)})};l.prototype.updatePermissions2=function(r,e,i){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return t},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var e;switch(i){case 0:e=0;break;case 1:e=1;break;case 6:e=6;break;case 2:e=2;break;default:e=1}var t={userRoleAssignments:[{UserId:r.loginName,Role:e}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(t)})};l.prototype.parseRawSharingInformation=function(e){return this._parseGetSharingInformationResponse(e,void 0)};l.prototype.unshareLink=function(t){var e=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t.item,this._getParentListId(t.item)).segment("UnshareLink").toString();return this.getData(function(){return e},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var e={linkKind:t.kind,shareId:t.shareId};return JSON.stringify(e)})};l.prototype.shareLink=function(s){var n=this,u=s.settings,e=s.items[0],t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,s.items[0],this._getParentListId(e)).segment("ShareLink").toString();return this.getData(function(){return t},function(e){var t=JSON.parse(e);if(t.d){var r=t.d.ShareLink.sharingLinkInfo,i=r.Expiration?new Date(r.Expiration):void 0;return{link:{allowsAnonymousAccess:r.AllowsAnonymousAccess,audience:n._getSharingLinkAudience(r.LinkKind),expiration:i,isActive:r.IsActive,isEdit:n._computeIsEditLink(r.LinkKind)||r.IsEditLink,principals:null,invitees:null,shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url}}}if(t.error)return{error:5,errorMessage:t.error.message}},"ShareLink",function(){var e=null;u.expiration&&(e=d.convertDateToISOString(u.expiration.toString()));var t=null;if(s.recipients&&0<s.recipients.length){t=[];for(var r=0,i=s.recipients;r<i.length;r++){var n=i[r];t.push(n.rawPersonData)}}var o={request:{createLink:!0,settings:{linkKind:u.sharingLinkKind,expiration:e,role:u.role,restrictShareMembership:u.restrictShareMembership}}};if(t){o.request.peoplePickerInput=JSON.stringify(t);void 0!==s.emailData&&(o.request.emailData={body:s.emailData})}var a=s.settings.shareId;a&&(o.request.settings.shareId=a);return JSON.stringify(o)},"POST",null,null,null,!0).catch(function(e){return{error:5}})};l.prototype.getClientId=function(){switch(Number(this._pageContext.webTemplate)){case p.default.teamSite:case p.default.group:case p.default.subgroup:return m.ClientId.sharePoint;case p.default.mySite:return m.ClientId.odb;default:return m.ClientId.unknown}};l.prototype._shareLink=function(a,s){var u=this,e=s.items[0],t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("ShareLink").toString();return this.getData(function(){return t},function(e){return{statusCode:0,errorMessage:"",people:a,itemId:s.items[0].id}},"ShareLink",function(){for(var e=[],t=0,r=a;t<r.length;t++){var i=r[t];e.push(i.rawPersonData)}var n=null;s.expiration&&(n=d.convertDateToISOString(s.expiration));var o={request:{peoplePickerInput:JSON.stringify(e),emailData:{body:s.message},linkKind:u._getSharingLinkKind(s.linkType,s.roleValue),createLink:!0,expiration:n}};return JSON.stringify(o)})};l.prototype._getSharingLinkKind=function(e,t){var r=1;6===e?r=5:5===e?r=4:9===e&&(r=t===2..toString()?3:2);return r};l.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:5,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,isShared:void 0,item:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0};var r=e.d,i=!!r.permissionsInformation,n=i?this._parseSharingLinks(r.permissionsInformation.links.results,r.directUrl):[],o=i?r.permissionsInformation.siteAdmins.results.concat(r.permissionsInformation.principals.results):[],a=this._parseSharingPrincipals(o),s=this._getDefaultSharingLink(r.defaultLinkKind,n,r.sharingAbilities),u={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0};if(t){var l=t.properties,c=l.ItemChildCount?parseInt(l.ItemChildCount,10):0,d=l.FolderChildCount?parseInt(l.FolderChildCount,10):0,p=t.type===g.default.OneNote?0:c+d,f=this._isPolicyTipFlagSet(t.policyTip,4);u={name:t.name,childCount:p,hasDlpPolicy:f,appmap:t.appMap}}var h=r.canRequestAccessForGrantAccess||r.canAddInternalPrincipal||1<n.length;return{anonymousLinkExpirationRestrictionDays:0===r.anonymousLinkExpirationRestrictionDays?-1:r.anonymousLinkExpirationRestrictionDays,canAddExternalPrincipal:r.canAddExternalPrincipal,canManagePermissions:h,defaultSharingLink:s,isShared:this._computeIsShared(n,a),item:u,sharingLinks:n,sharingPrincipals:a,peoplePickerSettings:r.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:r.blockPeoplePickerAndSharing,requiresAccessApproval:!r.canAddInternalPrincipal&&r.canRequestAccessForGrantAccess,userRole:r.currentRole,defaultShareLinkPermission:r.defaultShareLinkPermission,sharingAbilities:this._usesSharingAbilities?r.sharingAbilities:void 0,defaultLinkKind:r.defaultLinkKind,directLink:{allowsAnonymousAccess:!1,audience:m.SharingAudience.existing,expiration:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:r.directUrl},hasPermissionsInformation:!!r.permissionsInformation}};l.prototype._computeIsShared=function(e,t){for(var r=!1,i=0,n=e;i<n.length;i++){var o=n[i];o.isActive&&1!==o.sharingLinkKind&&(r=!0)}r||(r=0<t.length);return r};l.prototype._parseSharingLinks=function(e,t){var r=this,i=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t=e.linkDetails;return{allowsAnonymousAccess:t.AllowsAnonymousAccess,audience:r._getSharingLinkAudience(t.LinkKind),expiration:t.Expiration?new Date(t.Expiration):null,isActive:t.IsActive,isEdit:r._computeIsEditLink(t.LinkKind)||t.IsEditLink,isReview:t.IsReviewLink,principals:r._parseSharingPrincipals(e.linkMembers.results,t.LinkKind),invitees:r._parseLinkInvitees(t),shareId:t.ShareId,sharingLinkKind:t.LinkKind,url:t.Url}});i.push({allowsAnonymousAccess:!1,audience:m.SharingAudience.specificPeople,expiration:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:t});return i};l.prototype._parseLinkInvitees=function(e){var t=this,r=e.Invitations;if(!r)return[];for(var i=[],n=0,o=r.results;n<o.length;n++){var a=o[n];i.push(a.invitee)}return i.map(function(e){return{userId:e.userId,name:e.name,email:e.email,image:t._getImageUrl(e.email)}})};l.prototype._parseSharingPrincipals=function(e,i){var n=this;return e.map(function(e){var t=e.principal;t||(t=e);var r={id:t.id,isExternal:t.isExternal,loginName:t.loginName,primaryText:t.name,role:e.role,secondaryText:t.jobTitle,type:t.principalType,imageUrl:n._getImageUrl(t.email)};i&&(r.sharingLinkKind=i);return r})};l.prototype._getSharingLinkAudience=function(e){return 5===e||4===e?m.SharingAudience.anyone:3===e||2===e?m.SharingAudience.organization:1===e?m.SharingAudience.specificPeople:6===e?m.SharingAudience.specificPeopleFlex:void 0};l.prototype._getDefaultSharingLink=function(e,t,r){u.default.isFeatureEnabled(c.PeopleSharingLinks)&&u.default.isFeatureEnabled(c.SharingSupportsEmailAuthGuest)&&1===e&&(e=6);if(this._usesSharingAbilities){var i=e;5!==i||r.anonymousLinkAbilities.canManageEditLink.enabled||(i=4);4!==i||r.anonymousLinkAbilities.canManageReadLink.enabled||(i=3);3!==i||r.organizationLinkAbilities.canManageEditLink.enabled||(i=2);2!==i||r.organizationLinkAbilities.canManageReadLink.enabled||(i=1);return{allowsAnonymousAccess:void 0,audience:void 0,expiration:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:i,url:void 0,invitees:void 0}}for(var n,o=0,a=t;o<a.length;o++){var s=a[o];if(s.sharingLinkKind===e)return s;n=s}return n};l.prototype._computeIsEditLink=function(e){return 5===e||3===e||4!==e&&2!==e&&null};l.prototype._getImageUrl=function(e){return e&&this._sharingContextInformation?this._sharingContextInformation.webAbsoluteUrl+"/_layouts/15/userphoto.aspx?size=S&accountname="+e:null};l.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};return l}(r.default);c.SharingDataSource=i});define("hf",["require","exports","hr","hq","hp","ho","hn","hm","hl","hk","hj","hi","hh","hg"],function(e,t,r,i,n,o,a,s,u,l,c,d,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UpdatePermissionsRole=r.UpdatePermissionsRole;t.SharingLinkKind=i.SharingLinkKind;t.SharingLinkType=n.SharingLinkType;t.SharingInfoType=o.SharingInfoType;t.SharingRole=a.SharingRole;t.AccessStatus=s.AccessStatus;t.ClientId=u.default;t.Error=l.default;t.Category=l.Category;t.Mode=c.default;t.SharePermission=d.default;t.SharingAudience=p.default;t.SharingRoleV3=f.SharingRoleV3});define("hr",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.NONE=0]="NONE";e[e.VIEW=1]="VIEW";e[e.EDIT=2]="EDIT"}(t.UpdatePermissionsRole||(t.UpdatePermissionsRole={}))});define("hq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.uninitialized=0]="uninitialized";e[e.direct=1]="direct";e[e.organizationView=2]="organizationView";e[e.organizationEdit=3]="organizationEdit";e[e.anonymousView=4]="anonymousView";e[e.anonymousEdit=5]="anonymousEdit";e[e.flexible=6]="flexible"}(t.SharingLinkKind||(t.SharingLinkKind={}))});define("hp",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Network=1]="Network";e[e.Embed=3]="Embed";e[e.App=4]="App";e[e.View=5]="View";e[e.Edit=6]="Edit";e[e.Form=7]="Form";e[e.Direct=8]="Direct";e[e.Organization=9]="Organization";e[e.AppAccess=10]="AppAccess"}(t.SharingLinkType||(t.SharingLinkType={}))});define("ho",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Email=0]="Email";e[e.User=1]="User";e[e.Group=2]="Group";e[e.Link=3]="Link";e[e.Public=4]="Public";e[e.Friends=5]="Friends";e[e.Facebook=6]="Facebook";e[e.Application=7]="Application";e[e.GroupOwned=99]="GroupOwned"}(t.SharingInfoType||(t.SharingInfoType={}))});define("hn",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Owner=0]="Owner";e[e.View=1]="View";e[e.Edit=2]="Edit";e[e.Submitter=3]="Submitter";e[e.CoOwner=4]="CoOwner";e[e.None=5]="None";e[e.Review=6]="Review";e[e.Custom=7]="Custom"}(t.SharingRole||(t.SharingRole={}))});define("hm",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=1]="none";e[e.pending=2]="pending";e[e.hasAccess=3]="hasAccess"}(t.AccessStatus||(t.AccessStatus={}))});define("hl",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample"}(r||(r={}));t.default=r});define("hk",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.authFailure=1]="authFailure";e[e.serverFailure=2]="serverFailure";e[e.invalidItem=3]="invalidItem";e[e.invalidWebAbsoluteUrl=4]="invalidWebAbsoluteUrl";e[e.generic=5]="generic";e[e.objectNotSupported=6]="objectNotSupported";e[e.invalidEmail=7]="invalidEmail"}(r||(r={}));!function(e){e[e.getSharingInformation=1]="getSharingInformation";e[e.shareLink=2]="shareLink";e[e.shareObject=3]="shareObject"}(t.Category||(t.Category={}));t.default=r});define("hj",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess"}(r||(r={}));t.default=r});define("hi",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.view=1]="view";e[e.edit=2]="edit"}(r||(r={}));t.default=r});define("hh",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.specificPeople=0]="specificPeople";e[e.organization=1]="organization";e[e.anyone=2]="anyone";e[e.existing=3]="existing";e[e.specificPeopleFlex=4]="specificPeopleFlex"}(r||(r={}));t.default=r});define("hg",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none";e[e.view=1]="view";e[e.edit=2]="edit";e[e.owner=3]="owner";e[e.review=6]="review"}(t.SharingRoleV3||(t.SharingRoleV3={}))});define("g7",["require","exports","ap","fZ","hc","hb","ba","eq","aC","g9","aM","ep","eO","g8"],function(e,t,r,n,i,o,p,a,s,u,l,c,f,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=d.strings.Edit,m=d.strings.View,g=d.strings.Review,y=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._apiUrlHelper=t.resources.consume(n.resourceKey);t._sharingDataSourceHelper=new(t.managed(u.default));var r=a.getSafeWebServerRelativeUrl(t._pageContext);t._getPermissionsUrl=r+"/_api/SP.ObjectSharingInformation.GetObjectSharingInformationByUrl?$expand=SharedWithUsersCollection";t._getSharingSettingsUrl=r+"/_api/SP.Web.GetObjectSharingSettings?$expand=ObjectSharingInformation,SharePointSettings,SharePointSettings/PickerProperties,ObjectSharingInformation/SharedWithUsersCollection";t._groupImgExchangeUrl="/_layouts/15/userphoto.aspx?size=S&accountname=";return t}e.prototype.getRawResponse=function(e){var t,r=e.item,i=this._sharingDataSourceHelper.canUseSecurable(r),n="GetSharingInformationOld",o={};if(p.isFeatureEnabled(p.EnableGetSharingInformation)&&i){var a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r);t=a.segment("GetSharingInformation").oDataParameter("$Expand","permissionsInformation,pickerSettings").toString()}else if(i){a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r);t=a.segment("GetObjectSharingSettings").oDataParameter("$Expand","ObjectSharingInformation,SharePointSettings,SharePointSettings/PickerProperties,ObjectSharingInformation/SharedWithUsersCollection").toString();o.useSimplifiedRoles=!0;n="GetObjectSharingSettings"}else{t=this._getSharingSettingsUrl;o.useSimplifiedRoles=!0;o.objectUrl=this._sharingDataSourceHelper.getFileUrl(r);n="SP.Web.GetObjectSharingSettings"}return this.getData(function(){return t},function(e){return JSON.parse(e).d},n,function(){return JSON.stringify(o)},"POST",null,null,null,!0)};e.prototype.getSettings=function(t){var r=this;return t.getRawResponse().then(function(e){return r._parseSettings(e,t.item)},function(e){return r._parseError(e)})};e.prototype.getPermissions=function(t){var r=this;return p.isFeatureEnabled(p.EnableGetSharingInformation)&&this._sharingDataSourceHelper.canUseSecurable(t.item)?t.getRawResponse().then(function(e){return r._parsePermissions(e,t.item)}):this._getPermissions(t.item).then(function(e){return r._parsePermissions(e,t.item)})};e.prototype.getBestSharingLink=function(e,t){var r=this;return e.getLinks().then(function(e){return e&&0<e.length?s.default.wrap(r._getDefaultSharingLink(e,t)):null},function(e){return null})};e.prototype.getLinks=function(t){var r=this;return t.getRawResponse().then(function(e){return r._parseLinks(e,t.item)})};e.prototype.doSharingScopesContainLinks=function(){return!1};e.prototype.mappingSharingRole=function(e){var t;switch(e){case 0:t=5;break;case 3:t=0;break;case 5:t=3;break;default:t=e}return t};e.prototype.getDataSourceName=function(){return"SharingDataDataSource"};e.prototype._getPermissions=function(t){var e,r=this,i=this._sharingDataSourceHelper.canUseSecurable(t);if(i){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t);e=n.segment("GetObjectSharingInformation").oDataParameter("$Expand","SharedWithUsersCollection").toString()}else e=this._getPermissionsUrl;return this.getData(function(){return e},function(e){return JSON.parse(e).d},"GetItemPermissions",function(){var e={excludeCurrentUser:!1,excludeSiteAdmin:!1,excludeSecurityGroups:!1,retrieveAnonymousLinks:!0,retrieveUserInfoDetails:!0,checkForAccessRequests:!0,retrievePermissionLevels:!0};i||(e.objectUrl=r._sharingDataSourceHelper.getFileUrl(t));return JSON.stringify(e)},"POST",null,null,null,!0)};e.prototype._parsePermissions=function(e,t){var r=[],i=[];if(p.isFeatureEnabled(p.EnableGetSharingInformation)&&this._sharingDataSourceHelper.canUseSecurable(t))r=this._processAllPrincipals(e,t,e.canAddExternalPrincipal||e.canAddInternalPrincipal);else{e.SharedWithUsersCollection&&e.SharedWithUsersCollection.results&&(i=e.SharedWithUsersCollection.results);r=this._processPeople(i,t,e.CanManagePermissions)}for(var n=0,o=r;n<o.length;n++){var a=o[n];2===a.entityType&&a.email&&(a.image=this._getGroupImage(a.email))}var s=0===this.mappingSharingRole(e.currentRole)&&t.type!==f.default.Folder&&t.type!==f.default.OneNote;return[{item:t,people:r,hasPendingAccessRequests:e.HasPendingAccessRequests,pendingAccessRequestsLink:e.PendingAccessRequestsLink,canUnshare:e.CanBeUnshared||s}]};e.prototype._getGroupImage=function(e){return e?this._groupImgExchangeUrl+e:null};e.prototype._parseError=function(e){var t={};t.sharingApiErrorMessage=e.message.value;return t};e.prototype._parseSettings=function(e,t){var r={};r.canSendEmail=e.canSendEmail;r.pickerProperties={};r.itemUrl=this._sharingDataSourceHelper.getFileUrl(t);r.networkLinksEnabled=!1;r.mailSettings={defaultCharacterLimit:500};if(p.isFeatureEnabled(p.EnableGetSharingInformation)&&this._sharingDataSourceHelper.canUseSecurable(t)){r.itemId=t.properties.ID||t.properties.uniqueId;r.itemName=t.displayName;r.canManagePermissions=0===this.mappingSharingRole(e.currentRole);r.canManageReadWriteLink=this._isLinkKindEnabled(5,e.permissionsInformation.links);r.canManageOrganizationalReadWriteLink=this._isLinkKindEnabled(3,e.permissionsInformation.links);r.canManageLinks=this._isLinkKindEnabled(5,e.permissionsInformation.links)||this._isLinkKindEnabled(3,e.permissionsInformation.links)||this._isLinkKindEnabled(4,e.permissionsInformation.links)||this._isLinkKindEnabled(2,e.permissionsInformation.links);r.canSendLink=this._isLinkKindEnabled(4,e.permissionsInformation.links)||this._isLinkKindEnabled(5,e.permissionsInformation.links);r.supportsSharingPropagation=t.type===f.default.Folder;r.anonymousLinksEnabled=this._isLinkKindEnabled(4,e.permissionsInformation.links);r.organizationLinksEnabled=this._isLinkKindEnabled(2,e.permissionsInformation.links);r.showAdditionalExternalWarning=e.showExternalSharingWarning;r.sharedWithMany=this._isSharedWithMany(e);r.hasInheritedLink=this._containsInheritedLink(e);r.blockPeoplePickerAndSharing=e.blockPeoplePickerAndSharing;r.canCurrentUserShareExternally=e.canAddExternalPrincipal;r.defaultLinkType=e.defaultLinkKind;e.permissionsInformation&&e.permissionsInformation.principals&&e.permissionsInformation.principals.results&&(r.sharedWith=this._processAllPrincipals(e,t,r.canManagePermissions));var i=t.properties.listId||this._sharingDataSourceHelper.getParentListId(t),n=[e.webUrl],o=t.properties.ID;null!==o&&(o=t.properties.ID.toString());this._setAdvancedLink(i,n,o,r);e.pickerSettings&&this._setPickerProperties(e.pickerSettings,e.pickerSettings.PrincipalAccountType,r);var a=[],s={};s.name=h;s.value="role:1073741827";a.push(s);var u={};u.name=m;u.value="role:1073741826";a.push(u);if(p.isFeatureEnabled(p.ReviewPermissionUI)&&t.appMap&&"ms-word"===t.appMap){var l={};l.name=g;l.value="roletype:Reviewer";a.push(l)}r.sharingRoles=a;this._setAnonymousLinkExpirationInDays(e.anonymousLinkExpirationRestrictionDays,r)}else{r.itemId=e.ItemId;r.itemName=e.ItemName;r.canManagePermissions=e.ObjectSharingInformation.CanManagePermissions;r.canManageLinks=this._canManageLinks(e);r.canManageReadWriteLink=e.CanCurrentUserManageReadWriteLink;r.canManageOrganizationalReadWriteLink=e.CanCurrentUserManageOrganizationReadWriteLink;r.canSendEmail=e.CanSendEmail;r.canSendLink=e.CanSendLink;r.pickerProperties={};r.supportsSharingPropagation=e.SupportsAclPropagation;r.anonymousLinksEnabled=e.CanCurrentUserRetrieveReadonlyLink;r.organizationLinksEnabled=e.CanCurrentUserRetrieveOrganizationReadonlyLink;r.showAdditionalExternalWarning=e.ShowExternalSharingWarning;r.sharedWithMany=e.ObjectSharingInformation.IsSharedWithSecurityGroup||e.ObjectSharingInformation.IsSharedWithMany;r.blockPeoplePickerAndSharing=e.BlockPeoplePickerAndSharing;r.canCurrentUserShareExternally=e.CanCurrentUserShareExternally;r.defaultLinkType=this._getMostPermissiveLinkKind(r,e.DefaultShareLinkType);e.ObjectSharingInformation&&e.ObjectSharingInformation.SharedWithUsersCollection&&e.ObjectSharingInformation.SharedWithUsersCollection.results&&(r.sharedWith=this._processPeople(e.ObjectSharingInformation.SharedWithUsersCollection.results,t,e.CanManagePermissions));n=[e.WebUrl];this._setAdvancedLink(e.ListId,n,e.ItemId,r);e.SharePointSettings&&e.SharePointSettings.PickerProperties&&this._setPickerProperties(e.SharePointSettings.PickerProperties,e.SharePointSettings.PickerProperties.PrincipalAccountType,r);a=[];if(e.SimplifiedRoles&&e.SimplifiedRoles.results)for(var c=0;c<e.SimplifiedRoles.results.length;c++){var d={};d.name=e.SimplifiedRoles.results[c].Key;d.value=e.SimplifiedRoles.results[c].Value;a.push(d)}r.sharingRoles=a;this._setAnonymousLinkExpirationInDays(e.RequiredAnonymousLinkExpirationInDays,r)}r.showAdvanced=r.canManagePermissions;return r};e.prototype._setAnonymousLinkExpirationInDays=function(e,t){var r=parseInt(e,10);t.requiredAnonymousLinkExpirationInDays=NaN!==r?r:0};e.prototype._setPickerProperties=function(e,t,r){r.pickerProperties=e;r.pickerProperties.PrincipalAccountType=this._convertPrincipalType(t)};e.prototype._setAdvancedLink=function(e,t,r,i){t.push("/_layouts/15/user.aspx");t.push("?List="+l.default.encodeURIComponent(e));e&&t.push("&obj=",l.default.encodeURIComponent(e),",",l.default.encodeURIComponent(r),",LISTITEM");if(Number(this._pageContext.webTemplate)===c.default.group){t.push("&noredirect=true&isDlg=1");i.advancedUrlOpenInPlace=!0}i.advancedUrl=t.join("")};e.prototype._getMostPermissiveLinkKind=function(e,t){var r=t,i=3===(r=0===r?5:r)||2===r;if(5===r||4===r){if(e.anonymousLinksEnabled&&e.canManageReadWriteLink)return r;if(e.organizationLinksEnabled&&e.canManageOrganizationalReadWriteLink)return 3}else if(i&&e.organizationLinksEnabled&&e.canManageOrganizationalReadWriteLink)return r;return 1};e.prototype._parseLinks=function(t,r){var i=this,n=[];if(p.isFeatureEnabled(p.EnableGetSharingInformation)){if(t.permissionsInformation&&t.permissionsInformation.links){[{linkDetails:{Url:t.directUrl,IsActive:!0,LinkKind:1}}].concat(t.permissionsInformation.links.results).forEach(function(e){if(!e.isInherited){var t=i._initSharingLinkFromServerData(e.linkDetails);t.item=r;t.isInherited=e.isInherited;t.linkMembers=i._convertPrincipalToPeople(e.linkMembers);t.shareId=e.linkDetails?e.linkDetails.ShareId:"";t.kind=e.linkDetails?e.linkDetails.LinkKind:0;t.linkInvitees=i._getLinkInvitees(e.linkDetails);n.push(t)}});var o=t.canAddExternalPrincipal||t.canAddInternalPrincipal;n=n.filter(function(e){return!!((2!==i.mappingSharingRole(e.role)||o)&&(1!==i.mappingSharingRole(e.role)||o)||e.url&&e.isActive)&&(!!(o||e.url&&e.isActive)&&!(1===i.mappingSharingRole(e.role)&&5===e.type&&!o||2===i.mappingSharingRole(e.role)&&6===e.type&&!o))})}}else if(t.ObjectSharingInformation&&t.ObjectSharingInformation.SharingLinks){t.ObjectSharingInformation.SharingLinks.results.forEach(function(e){var t=i._initSharingLinkFromServerData(e);t.item=r;n.push(t)});var a=this._canManageLinks(t);n=n.filter(function(e){return!!((2!==e.role||t.CanCurrentUserManageReadWriteLink||t.CanCurrentUserManageOrganizationReadWriteLink)&&(1!==e.role||t.CanCurrentUserManageReadonlyLink||t.CanCurrentUserManageOrganizationReadonlyLink)||e.url&&e.isActive)&&(!!(a||e.url&&e.isActive)&&!(1===e.role&&5===e.type&&!t.CanCurrentUserRetrieveReadonlyLink||2===e.role&&6===e.type&&!t.CanCurrentUserRetrieveReadWriteLink))})}return n};e.prototype._getLinkInvitees=function(e){var t=this,r=e.Invitations;if(!r)return[];for(var i=[],n=0,o=r.results;n<o.length;n++){var a=o[n];i.push(a.invitee)}return i.map(function(e){return{userId:e.userId,name:e.name,email:e.email,image:t._getGroupImage(e.email),isExternal:e.isExternal}})};e.prototype._processPeople=function(e,t,i){var n=this;return e.map(function(e){var t={userId:e.LoginName,name:e.Name,email:e.Email,job:e.JobTitle,department:e.Department,image:e.Picture,sip:e.SipAddress,isExternal:e.isExternal};0===t.image.length&&(t.image=n._placeholderImage);var r={};if(e.IsSiteAdmin)r.role=0;else if(void 0!==e.CustomRoleNames&&""!==e.CustomRoleNames){r.role=7;r.customRole=e.CustomRoleNames}else e.HasEditPermission?r.role=2:e.HasViewPermission&&(r.role=1);r.isChangeable=i;t.sharingInfo=r;e.IsDomainGroup?t.entityType=2:e.IsExternalUser&&(t.entityType=1);return t})};e.prototype._getAllSharedUsers=function(e){for(var t=e.permissionsInformation.siteAdmins.results,r=e.permissionsInformation.principals.results,i={},n=0,o=t;n<o.length;n++){i[(u=o[n]).principal.loginName]=!0}for(var a=0,s=r;a<s.length;a++){var u;i[(u=s[a]).principal.loginName]||t.push(u)}return t};e.prototype._processAllPrincipals=function(e,t,i){var n=this;return this._getAllSharedUsers(e).map(function(e){var t={userId:e.principal.loginName,name:e.principal.name,email:e.principal.email,job:e.principal.jobTitle,image:n._getGroupImage(e.principal.email),isExternal:e.principal.isExternal},r={};r.role=n.mappingSharingRole(e.role);r.isChangeable=i;t.sharingInfo=r;e.principal.principalType===o.default.securityGroup||e.principal.principalType===o.default.sharePointGroup?t.entityType=2:e.principal.isExternal&&(t.entityType=1);return t})};e.prototype._convertPrincipalType=function(e){if(!e)return 0;for(var t=0,r=0,i=e.split(",");r<i.length;r++){var n=i[r];"User"===n?t|=1:"DL"===n?t|=2:"SecGroup"===n?t|=4:"SPGroup"===n&&(t|=8)}return t};e.prototype._convertPrincipalToPeople=function(e){var t=this;return(e&&e.results||[]).map(function(e){return{userId:e.loginName,name:e.name,email:e.email,job:e.jobTitle,image:t._getGroupImage(e.email)}})};e.prototype._initSharingLinkFromServerData=function(e){if(!e)return null;var t={};switch(e.LinkKind){case 1:t={type:8,role:5,displayPriority:0,tag:"Direct",supportsExpiration:!1};break;case 2:t={type:9,role:1,displayPriority:1,tag:"OrganizationView",supportsExpiration:!1};break;case 3:t={type:9,role:2,displayPriority:2,tag:"OrganizationEdit",supportsExpiration:!1};break;case 4:t={type:5,role:1,displayPriority:3,tag:"AnonymousView",supportsExpiration:!0};break;case 5:t={type:6,role:2,displayPriority:4,tag:"AnonymousEdit",supportsExpiration:!0};break;case 6:t={type:6,role:e.IsEditLink?2:e.IsReviewLink?6:1,displayPriority:5,tag:"Flexible",supportsExpiration:!1};break;case 0:default:t={}}return r.__assign({role:5,url:p.isFeatureEnabled(p.EnableGetSharingInformation)?e.Url:this._sharingDataSourceHelper.encodeSharingLink(e.Url),isActive:e.IsActive,expiration:t.supportsExpiration?this._sharingDataSourceHelper.getExpirationFromSharingLinkInfo(e.Expiration):null},t)};e.prototype._getDefaultSharingLink=function(e,t){if(!e||e.length<1)return null;var r,i,n;if(1===t){i=8;n=5}else if(2===t){i=9;n=1}else if(3===t){i=9;n=2}else if(4===t){i=5;n=1}else if(5===t){i=6;n=2}for(var o=0,a=e;o<a.length;o++){var s=a[o];8===s.type&&(r=s);if(s.type===i&&s.role===n)return s}return r};e.prototype._isLinkKindEnabled=function(t,e){return e.results.some(function(e){return e.linkDetails.LinkKind===t})};e.prototype._canManageLinks=function(e){return e.CanCurrentUserManageReadWriteLink||e.CanCurrentUserManageOrganizationReadWriteLink||e.CanCurrentUserManageReadonlyLink||e.CanCurrentUserManageOrganizationReadonlyLink};e.prototype._isSharedWithMany=function(e){if(30<this._getAllSharedUsers(e).length)return!0;for(var t=0,r=e;t<r.length;t++){var i=r[t];if(i.principal.principalType===o.default.securityGroup||i.principal.principalType===o.default.sharePointGroup)return!0}return!1};e.prototype._containsInheritedLink=function(e){for(var t=0,r=e.permissionsInformation.links.results;t<r.length;t++){var i=r[t];if(i.isInherited&&i.linkDetails.Url)return!0}return!1};return e}(i.default);t.default=y});define("g2",["require","exports","ap","g6","is","bN","gl","eq","cY","ey","g5","ep","aM","a0","g3","ba","bX","iE","eC","bb"],function(e,t,r,v,_,n,o,s,b,S,a,u,l,c,d,p,f,h,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(y,i);function y(e,t){var r=i.call(this,e,t)||this;r._dataRequestor=new t.dataRequestorType({qosName:"SuiteNavDataSource"});r._showMySiteSettings=e.showMySiteSettings;r._showTrimmedSettings=e.showTrimmedSettings;r._workloadId=e.workloadId;r._helpNamespace=e.helpNamespace;r._helpId=e.helpId;r._pageContext=t.pageContext;r._suiteNavDataSourceParams=e;r._sharePointUrl=t.sharePointUrl||r.createObservable("");r._isTenantAdmin=t.isTenantAdmin||r.createObservable(!1);r._capabilities={supportsCaching:!0,supportsRealSuiteNav:!0,showO365Text:!0};return r}y.prototype.getCapabilities=function(){return this._capabilities};y.prototype.getUserIdentifier=function(){return this._pageContext.systemUserKey};y.prototype.getCacheToken=function(){var e=this._pageContext.siteClientTag;return"string"==typeof e?e.substring(0,e.indexOf("$$")):""};y.prototype.getSettingsLinks=function(){var e=v.strings,t=this._pageContext.webAbsoluteUrl,r=S.isDocumentLibrary(this._pageContext.listBaseTemplate),i={Id:_.default.LIBRARY_SETTINGS,Text:r?e.LibrarySettings:e.ListSettings,Url:t+"/_layouts/15/listedit.aspx?List="+encodeURIComponent(this._pageContext.listId),Hidden:!this._pageContext.listId,IsMySiteSettingLink:!1,ListPermissions:[b.PermissionMask.manageLists]},n=[];if(this._showMySiteSettings||this._showTrimmedSettings){var o=this._pageContext.listPermsMask||b.PermissionMask.fullMask,a=this._pageContext.webPermMasks,s=!1,u=this._pageContext.MenuData&&this._pageContext.MenuData.SettingsData;if(u){for(var l=this._showTrimmedSettings&&!i.Hidden&&b.PermissionMask.hasAny(o,i.ListPermissions),c=function(e){return{Id:e.Id,Text:e.Text,Url:e.Url}},d=0,p=u;d<p.length;d++){var f=p[d];if(f){if(s){n.push(null);s=!1}if(f.Id===i.Id)l=!1;else if(l&&f.Id===_.default.SITE_SETTINGS){n.push(c(i));l=!1}n.push(c(f))}else s=!0}l&&n.push(c(i))}else for(var h=0,m=[{Id:_.default.ADD_APP,Text:e.AddAnApp,Url:t+"/_layouts/15/addanapp.aspx",IsMySiteSettingLink:!0,WebPermissions:[b.PermissionMask.manageLists,b.PermissionMask.manageSubwebs]},{Id:_.default.SITE_CONTENTS,Text:e.SiteContents,Url:t+"/_layouts/15/viewlsts.aspx",IsMySiteSettingLink:!0,WebPermissions:[b.PermissionMask.viewFormPages]},null,i,{Id:_.default.SITE_SETTINGS,Text:e.SiteSettings,Url:t+"/_layouts/15/settings.aspx",IsMySiteSettingLink:!0,WebPermissions:y.siteSettingsPermissions}];h<m.length;h++){var g=m[h];s=s||!g;if(g&&!g.Hidden){if(this._showMySiteSettings?g.IsMySiteSettingLink:b.PermissionMask.hasAny(a,g.WebPermissions)||b.PermissionMask.hasAny(o,g.ListPermissions)){if(s){n.push(null);s=!1}n.push({Id:g.Id,Text:g.Text,Url:g.Url})}}}}this._isHubSettingsLinkEnabled()&&n.push({Id:_.default.HUB_SETTINGS,Text:v.strings.HubSettings,Url:"#"});this._isSiteInformationLinkEnabled()&&(n=n.filter(function(e){return!e||e.Id!==_.default.SITE_SETTINGS})).push({Id:_.default.SITE_INFORMATION,Text:v.strings.SiteInformation,Url:"#"});this._isSitePermissionsLinkEnabled()&&n.push({Id:_.default.SITE_PERMISSIONS,Text:v.strings.SitePermissions,Url:"#"});this._isSiteAnalyticsLinkEnabled()&&n.push({Id:"Site_Analytics",Text:v.strings.SiteAnalytics,Url:t+"/_layouts/15/siteanalytics.aspx"});this._isChangeTheLookLinkEnabled()&&n.push({Id:_.default.CHANGE_THE_LOOK,Text:v.strings.ChangeTheLookPanel,Url:"#"});return 0<n.length?n:null};y.prototype.loadData=function(e){var n=this;if(!e&&this._dataPromise)return this._dataPromise;var o=this._pageContext.isSPO,t=l.default.escapeUrlForCallback(s.getSafeWebServerRelativeUrl(this._pageContext)),r=l.default.escapeUrlForCallback(this._pageContext.currentUICultureName),i=o?t+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?Locale="+r+"&v=2&msajax=1&cv=2":t+"/_api/Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData?v=2&Locale="+r,a=this._dataPromise=this._dataRequestor.getData({url:i,qosName:"LoadData",maxRetries:1,timeout:2500,noTimeoutInLastRetry:!0}).then(function(e){var t=o?e:JSON.parse(e.d.GetSuiteNavData),r=n._fixData(t.NavBarData),i=!(!r.HasTenantBranding||!t.TenantPrimaryColorShades&&!r.TenantLogoUrl);n._model={data:r,requireConfig:{paths:{shellcore:t.JsUrl.replace(/\.js$/,"")},shim:{shellcore:{exports:"O365Shell"}}},cssUrl:t.CssUrl,hasCobranding:i,userIdentifier:n.getUserIdentifier(),cacheToken:n.getCacheToken()};return n._model});a.done(null,function(){n._dataPromise=null});return a};y.prototype.onCssLoad=function(e){if(e.data&&e.data.ClientData)try{var t=JSON.parse(e.data.ClientData);t&&t.IsFallbackShell&&a.loadFallbackShellThemableCss()}catch(e){}};y.prototype.updateDataForCurrentPage=function(e){return this._fixData(e)};y.prototype._isSiteAnalyticsLinkEnabled=function(){return p.isFeatureEnabled(p.SiteAnalyticsV3)};y.prototype._isSiteInformationLinkEnabled=function(){var e=Number(this._pageContext.webTemplate)===u.default.mySite||Number(this._pageContext.webTemplate)===u.default.mySiteHost;return b.PermissionMask.hasPermission(this._pageContext.webPermMasks,b.PermissionMask.manageWeb)&&(s.isGroupWebContext(this._pageContext)||p.isFeatureEnabled(p.UseNewSiteSettings)&&!e)};y.prototype._isHubSettingsLinkEnabled=function(){var e=this._pageContext;return e.isSiteAdmin&&e.isHubSite&&p.isFeatureEnabled(p.DepartmentNav)};y.prototype._isSitePermissionsLinkEnabled=function(){return!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isExternalGuestUser};y.prototype._isChangeTheLookLinkEnabled=function(){var e=Number(this._pageContext.webTemplate);if(g.default.isActivated("B1529C2B-3774-4936-9637-AE8EC7223B8F","04/15/2018","use feature check for changethelookpanel availability ")){var t="STS#3"===this._pageContext.webTemplateConfiguration,r=e===u.default.group||e===u.default.sitePagePublishing||t;return p.isFeatureEnabled(p.ModernTheming)&&b.PermissionMask.hasPermission(this._pageContext.webPermMasks,b.PermissionMask.applyThemeAndBorder)&&e!==u.default.mySite&&e!==u.default.mySiteHost&&r}return this._pageContext.modernThemingEnabled&&b.PermissionMask.hasPermission(this._pageContext.webPermMasks,b.PermissionMask.applyThemeAndBorder)&&e!==u.default.mySite&&e!==u.default.mySiteHost};y.prototype._updateSharepointUrl=function(e){if(e)for(var t=0,r=(e.AppsLinks||[]).concat(e.WorkloadLinks||[]);t<r.length;t++){var i=r[t];if("ShellSites"===i.Id){this._sharePointUrl(i.Url);break}}};y.prototype._fixData=function(t){t.CurrentMainLinkElementID=this._workloadId;t.ActionsMap={};var e=this._pageContext,r=e.isSPO;this._isTenantAdmin(t&&!!t.AdminLink);this._updateSharepointUrl(t);if(r&&e.isAnonymousGuestUser)try{var i={Text:e.userDisplayName||t.UserDisplayName||"",Url:null},n=JSON.parse(t.ClientData);n.SignInLink=i;t.ClientData=JSON.stringify(n);t.SignOutLink=null;t.AboutMeLink=null;t.IsAuthenticated=!1;t.O365SettingsLink=null;t.UserDisplayName=null}catch(e){}else{t.ActionsMap[_.default.SIGN_OUT]=function(){c.Engagement.logData({name:"SuiteNav.SignOut.Click"});try{delete localStorage["onedrive.autoredirect"]}catch(e){}return!0};if(r&&e.isEmailAuthenticationGuestUser){t.CurrentWorkloadSettingsSubLinks=null;t.LogoNavigationUrl=null}else t.CurrentWorkloadSettingsSubLinks=this.getSettingsLinks();this._isSiteInformationLinkEnabled()&&(t.ActionsMap[_.default.SITE_INFORMATION]=function(e){var t=e.consume(f.actionMap);new(e.injected(t.LaunchSiteSettingsPanelAction))({}).execute(null);return!1});this._isHubSettingsLinkEnabled()&&(t.ActionsMap[_.default.HUB_SETTINGS]=function(e){var t=e.consume(f.actionMap);new(e.injected(t.LaunchHubSettingsPanelAction))({}).execute(null);return!1});this._isChangeTheLookLinkEnabled()&&(t.ActionsMap[_.default.CHANGE_THE_LOOK]=function(e){var t=e.consume(f.actionMap);new(e.injected(t.LaunchChangeTheLookPanelAction))({}).execute(null);return!1});this._isSitePermissionsLinkEnabled()&&(t.ActionsMap[_.default.SITE_PERMISSIONS]=function(e){var t=e.consume(f.actionMap);new(e.injected(t.LaunchSitePermissionsPanelAction))({}).execute(null);return!1});if(t.SignOutLink||!r){t.SignOutLink.Url=s.getSafeWebServerRelativeUrl(e)+"/_layouts/15/SignOut.aspx";t.SignOutLink.Text||(t.SignOutLink.Text=v.strings.SignOut)}t.UserDisplayName=e.userDisplayName||t.UserDisplayName||e.webTitle||null}t.FeedbackLink=null;if(this._suiteNavDataSourceParams.firstRunScenarioType){t.CurrentWorkloadHelpSubLinks=[{Id:_.default.FIRSTRUN,Text:v.strings.ShowFirstRun,Url:"#"}];t.ActionsMap[_.default.FIRSTRUN]=function(e){new(e.injected(d.default))({}).execute(null);return!1}}if(!r){t.StringsOverride=t.StringsOverride||{};t.StringsOverride.l_ShellCore_O365_Text="SharePoint"}this._helpNamespace&&this._helpId?t.HelpLink.Url="https://o15.officeredir.microsoft.com/r/rlidOfficeWebHelp?p1="+this._helpNamespace+"&clid="+e.currentLanguage+"&ver=19&HelpId="+this._helpId:t.HelpLink.Url="https://support.microsoft.com";r||(t.ActionsMap[_.default.HELP]=function(){var e=window.open("","_blank","resizable=1,location=0,width=400,height=500");e.opener=null;e.location.href=t.HelpLink.Url;return!1});t.HelpLink.Text||(t.HelpLink.Text=v.strings.Help);var o=Number(e.webTemplate),a=o===u.default.mySite||o===u.default.mySiteHost;t.UseSPOBehaviors=!a;return t};y.dependencies=r.__assign({},n.default.dependencies,{dataRequestorType:o.typeResourceKey,pageContext:h.pageContext,isTenantAdmin:m.isTenantAdmin.optional,sharePointUrl:m.sharepointUrl.optional});y.siteSettingsPermissions=[b.PermissionMask.enumeratePermissions,b.PermissionMask.manageWeb,b.PermissionMask.manageSubwebs,b.PermissionMask.addAndCustomizePages,b.PermissionMask.applyThemeAndBorder,b.PermissionMask.manageAlerts,b.PermissionMask.manageLists,b.PermissionMask.viewUsageData];return y}(n.default);t.default=i});define("g5",["require","exports","c"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadFallbackShellThemableCss=function(){r.loadStyles(".o365cs-base .o365cs-nav-contextMenu {    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base-visibility{  visibility: visible;}\n.o365cs-base .ms-fcl-tdr,.o365cs-base .ms-fcl-tdr-h:hover,.o365cs-base .ms-fcl-tdr-f:focus{    color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bgc-tdr,.o365cs-base .ms-bgc-tdr-h:hover,.o365cs-base .ms-bgc-tdr-f:focus{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bcl-tdr,.o365cs-base .ms-bcl-tdr-h:hover,.o365cs-base .ms-bcl-tdr-f:focus{    border-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-fcl-td,.o365cs-base .ms-fcl-td-h:hover,.o365cs-base .ms-fcl-td-f:focus{    color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bgc-td,.o365cs-base .ms-bgc-td-h:hover,.o365cs-base .ms-bgc-td-f:focus{    background-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bcl-td,.o365cs-base .ms-bcl-td-h:hover,.o365cs-base .ms-bcl-td-f:focus{    border-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-fcl-tda,.o365cs-base .ms-fcl-tda-h:hover,.o365cs-base .ms-fcl-tda-f:focus{    color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bgc-tda,.o365cs-base .ms-bgc-tda-h:hover,.o365cs-base .ms-bgc-tda-f:focus{    background-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bcl-tda,.o365cs-base .ms-bcl-tda-h:hover,.o365cs-base .ms-bcl-tda-f:focus{    border-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-fcl-tp,.o365cs-base .ms-fcl-tp-h:hover,.o365cs-base .ms-fcl-tp-f:focus{    color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bgc-tp,.o365cs-base .ms-bgc-tp-h:hover,.o365cs-base .ms-bgc-tp-f:focus,.o365cs-base.ms-bgc-tp{    background-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bcl-tp,.o365cs-base .ms-bcl-tp-h:hover,.o365cs-base .ms-bcl-tp-f:focus{    border-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-fcl-ts,.o365cs-base .ms-fcl-ts-h:hover,.o365cs-base .ms-fcl-ts-f:focus{    color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bgc-ts,.o365cs-base .ms-bgc-ts-h:hover,.o365cs-base .ms-bgc-ts-f:focus{    background-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bcl-ts,.o365cs-base .ms-bcl-ts-h:hover,.o365cs-base .ms-bcl-ts-f:focus{    border-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-fcl-tt,.o365cs-base .ms-fcl-tt-h:hover,.o365cs-base .ms-fcl-tt-f:focus{    color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bgc-tt,.o365cs-base .ms-bgc-tt-h:hover,.o365cs-base .ms-bgc-tt-f:focus{    background-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bcl-tt,.o365cs-base .ms-bcl-tt-h:hover,.o365cs-base .ms-bcl-tt-f:focus{    border-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-fcl-tl,.o365cs-base .ms-fcl-tl-h:hover,.o365cs-base .ms-fcl-tl-f:focus{    color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bgc-tl,.o365cs-base .ms-bgc-tl-h:hover,.o365cs-base .ms-bgc-tl-f:focus{    background-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bcl-tl,.o365cs-base .ms-bcl-tl-h:hover,.o365cs-base .ms-bcl-tl-f:focus{    border-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-fcl-tlr,.o365cs-base .ms-fcl-tlr-h:hover,.o365cs-base .ms-fcl-tlr-f:focus{    color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bgc-tlr,.o365cs-base .ms-bgc-tlr-h:hover,.o365cs-base .ms-bgc-tlr-f:focus{    background-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bcl-tlr,.o365cs-base .ms-bcl-tlr-h:hover,.o365cs-base .ms-bcl-tlr-f:focus{    border-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-fcl-tlra,.o365cs-base .ms-fcl-tlra-h:hover,.o365cs-base .ms-fcl-tlra-f:focus{    color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bgc-tlra,.o365cs-base .ms-bgc-tlra-h:hover,.o365cs-base .ms-bgc-tlra-f:focus{    background-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bcl-tlra,.o365cs-base .ms-bcl-tlra-h:hover,.o365cs-base .ms-bcl-tlra-f:focus{    border-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-fcl-w,.o365cs-base .ms-fcl-w-h:hover,.o365cs-base .ms-fcl-w-f:focus{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bgc-w,.o365cs-base .ms-bgc-w-h:hover,.o365cs-base .ms-bgc-w-f:focus,.o365cs-base.ms-bgc-w{    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bcl-w,.o365cs-base .ms-bcl-w-h:hover,.o365cs-base .ms-bcl-w-f:focus{    border-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-fcl-b,.o365cs-base .ms-fcl-b-h:hover,.o365cs-base .ms-fcl-b-f:focus{    color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-b.o365cs-nav-closeButton{    color: #000000;}\n.o365cs-base .ms-bgc-b,.o365cs-base .ms-bgc-b-h:hover,.o365cs-base .ms-bgc-b-f:focus,.o365cs-base.ms-bgc-b{    background-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-bcl-b,.o365cs-base .ms-bcl-b-h:hover,.o365cs-base .ms-bcl-b-f:focus{    border-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-nd,.o365cs-base .ms-fcl-nd-h:hover,.o365cs-base .ms-fcl-nd-f:focus{    color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bgc-nd,.o365cs-base .ms-bgc-nd-h:hover,.o365cs-base .ms-bgc-nd-f:focus{    background-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bcl-nd,.o365cs-base .ms-bcl-nd-h:hover,.o365cs-base .ms-bcl-nd-f:focus{    border-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-fcl-np,.o365cs-base .ms-fcl-np-h:hover,.o365cs-base .ms-fcl-np-f:focus{    color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bgc-np,.o365cs-base .ms-bgc-np-h:hover,.o365cs-base .ms-bgc-np-f:focus{    background-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bcl-np,.o365cs-base .ms-bcl-np-h:hover,.o365cs-base .ms-bcl-np-f:focus{    border-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-fcl-ns,.o365cs-base .ms-fcl-ns-h:hover,.o365cs-base .ms-fcl-ns-f:focus{    color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-ns.o365cs-nav-moduleLabel{    color: #666666;}\n.o365cs-base .ms-bgc-ns,.o365cs-base .ms-bgc-ns-h:hover,.o365cs-base .ms-bgc-ns-f:focus{    background-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-bcl-ns,.o365cs-base .ms-bcl-ns-h:hover,.o365cs-base .ms-bcl-ns-f:focus{    border-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-nsa,.o365cs-base .ms-fcl-nsa-h:hover,.o365cs-base .ms-fcl-nsa-f:focus{    color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bgc-nsa,.o365cs-base .ms-bgc-nsa-h:hover,.o365cs-base .ms-bgc-nsa-f:focus{    background-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bcl-nsa,.o365cs-base .ms-bcl-nsa-h:hover,.o365cs-base .ms-bcl-nsa-f:focus{    border-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-fcl-nt,.o365cs-base .ms-fcl-nt-h:hover,.o365cs-base .ms-fcl-nt-f:focus{    color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bgc-nt,.o365cs-base .ms-bgc-nt-h:hover,.o365cs-base .ms-bgc-nt-f:focus{    background-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bcl-nt,.o365cs-base .ms-bcl-nt-h:hover,.o365cs-base .ms-bcl-nt-f:focus{    border-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-fcl-nta,.o365cs-base .ms-fcl-nta-h:hover,.o365cs-base .ms-fcl-nta-f:focus{    color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bgc-nta,.o365cs-base .ms-bgc-nta-h:hover,.o365cs-base .ms-bgc-nta-f:focus{    background-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bcl-nta,.o365cs-base .ms-bcl-nta-h:hover,.o365cs-base .ms-bcl-nta-f:focus{    border-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-fcl-nl,.o365cs-base .ms-fcl-nl-h:hover,.o365cs-base .ms-fcl-nl-f:focus{    color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bgc-nl,.o365cs-base .ms-bgc-nl-h:hover,.o365cs-base .ms-bgc-nl-f:focus{    background-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bcl-nl,.o365cs-base .ms-bcl-nl-h:hover,.o365cs-base .ms-bcl-nl-f:focus{    border-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-fcl-nlr,.o365cs-base .ms-fcl-nlr-h:hover,.o365cs-base .ms-fcl-nlr-f:focus{    color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bgc-nlr,.o365cs-base .ms-bgc-nlr-h:hover,.o365cs-base .ms-bgc-nlr-f:focus,.o365cs-base.ms-bgc-nlr{    background-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bcl-nlr,.o365cs-base .ms-bcl-nlr-h:hover,.o365cs-base .ms-bcl-nlr-f:focus{    border-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-fcl-nlra,.o365cs-base .ms-fcl-nlra-h:hover,.o365cs-base .ms-fcl-nlra-f:focus{    color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bgc-nlra,.o365cs-base .ms-bgc-nlra-h:hover,.o365cs-base .ms-bgc-nlra-f:focus,.o365cs-base.ms-bgc-nlra{    background-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bcl-nlra,.o365cs-base .ms-bcl-nlra-h:hover,.o365cs-base .ms-bcl-nlra-f:focus{    border-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .o365cs-topnavLinkBackground-2{    background-color: transparent;}\n.o365cs-base .o365cs-topnavText,.o365cs-base .o365cs-topnavText:hover{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base .o365cs-appLauncherBackground{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-nav-header16 .o365cs-navMenuButton{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .o365cs-navMenuButton{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base.o365cs-topnavBGImage{    background-position: center top;    background-repeat: repeat-x;    background-image: none;}\n.o365cs-base.o365cs-topnavBGColor-2{    background-color: '[theme:suiteBarBackground, default:#000000]';}\n")}});define("g3",["require","exports","ap","g4","aI","aC","bX"],function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.name="InvokeFirstRunExperience";return e}e.prototype.onExecute=function(e,t){var r=this.resources.consume(a.isFirstRunExperienceVisible);r(!r.peek());return o.default.wrap({resultType:n.ResultTypeEnum.Success})};return e}(i.default);t.default=s});define("g4",["require","exports","ap","fk","gz","bN","dZ","aC","aN","a9","dH","aI","d7","cE"],function(e,t,r,i,n,o,d,a,s,u,l,p,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(c){r.__extends(e,c);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=c.call(this,e,t)||this;r.name="BaseAction";var i=r,n=i.resources,o=i.observables,a=t.urlDataSource,s=void 0===a?n.consume(d.url.optional):a,u=t.instrumentationProvider,l=void 0===u?n.consume(f.instrumentation.optional):u;r._BaseAction_urlDataSource=s;r._BaseAction_instrumentationProvider=l;r.isQosLogged=!0;r.logStartEnd=!1;r._executingInstanceCount=o.create(0);r.isAvailable=o.pureCompute(r._computeIsAvailable);r.isToggled=o.pureCompute(r._computeIsToggled);r.isExecuting=o.pureCompute(r._computeIsExecuting);return r}e.prototype.execute=function(t){var e,r,i=this,n=this.isQosLogged?this.onCreateQosEvent(t):null;try{if(!(e=this.onExecute(t,n)))throw new Error("Action did not return a promise")}catch(e){s.default.log(e);r=e}if(r){n&&n.end(this.onCreateErrorEventArg(t,r,!0));e=a.default.wrapError(r)}else{this._executingInstanceCount(this._executingInstanceCount.peek()+1);e.done(function(e){i._executingInstanceCount(i._executingInstanceCount.peek()-1);if(n){i._logEngagementEvent(n.data.extraData);n.end(e)}},function(e){i._executingInstanceCount(i._executingInstanceCount.peek()-1);e&&!a.default.isCanceled(e)&&s.default.log(e);if(n){i._logEngagementEvent(n.data.extraData);n.end(i.onCreateErrorEventArg(t,e,!1))}})}return e};e.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new i.Action({name:this.name,pageType:t&&u.default[t.getPageType()]||"",queryType:t&&l.default[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};e.prototype.onCreateErrorEventArg=function(e,t,r){return t&&a.default.isCanceled(t)?{resultType:p.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:{resultType:p.ResultTypeEnum.Failure,resultCode:r?"NoPromiseReturned":"PromiseFailed"}};e.prototype.onExecute=function(e,t){var r={resultType:p.ResultTypeEnum.Failure};return a.default.wrap(r)};e.prototype.onIsAvailable=function(){return!0};e.prototype.onIsToggled=function(){return!1};e.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};e.prototype._computeIsToggled=function(){return!!this.onIsToggled()};e.prototype._computeIsExecuting=function(){return 0<this._executingInstanceCount()};e.prototype._logEngagementEvent=function(e){if(this.isQosLogged){var t=this._BaseAction_instrumentationProvider;this.resources.consume(h.resourceKey).logData({name:this.name,location:"NA",usageType:n.UsageType[n.UsageType.Click],currentPage:t&&t.currentPageName()||"NA",previousPage:t&&t.previousPageName()||"NA",extraData:r.__assign({},e||{},t&&t.getEngagementData()||{})})}};e.dependencies=r.__assign({},o.default.dependencies,{urlDataSource:d.url,instrumentationProvider:f.instrumentation});return e}(o.default);t.default=c});define("fk",["require","exports","aK","aI","aJ"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultTypeEnum=n.ResultTypeEnum;t.Action=r.createPairedEvent({eventName:"Action,Qos,",shortEventName:"Action",samplingFeature:{ODB:!0,ODC:"ActionEventLogging",Fallback:!1}},{pageType:1,queryType:1,logStartEnd:3},i.Qos);t.default=t.Action});define("gz",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Click=1]="Click";e[e.Tap=2]="Tap";e[e.Keyboard=3]="Keyboard"}(t.UsageType||(t.UsageType={}))});define("eC",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isTenantAdmin=new r.ResourceKey("app.admin");t.sharepointUrl=new r.ResourceKey("app.spourl")});define("gM",["require","exports","ap","bN","aM","aZ","fO","fZ","gl","iE"],function(e,t,i,r,n,o,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._pageContext=t.resources.consume(l.pageContext);t._dataRequestor=new(t.child(u.typeResourceKey))({qosName:"VersionControlDataSource"});t._itemUrlHelper=t.resources.consume(a.resourceKey);t._apiUrlHelper=t.resources.consume(s.resourceKey);return t}e.prototype.checkOutItem=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.item.key),r=this._apiUrlHelper.build().webByItemUrl(t);r=(r=r.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl})).segment("CheckOut");return this._dataRequestor.getData({url:r.toString(),qosName:"CheckOutItem"})};e.prototype.undoCheckOutItem=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.item.key),r=this._apiUrlHelper.build().webByItemUrl(t);r=(r=r.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl})).segment("UndoCheckOut");return this._dataRequestor.getData({url:r.toString(),qosName:"UndoCheckOutItem"})};e.prototype.checkInItem=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.item.key),r=this._apiUrlHelper.build().webByItemUrl(t);r=(r=r.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl})).methodWithAliases("CheckIn",{comment:e.comments,checkintype:0});return this._dataRequestor.getData({url:r.toString(),qosName:"CheckInItem"})};e.prototype.getVersionHistoryUrl=function(e,t){var r=[n.default.escapeUrlForCallback(this._pageContext.webAbsoluteUrl),"/",this._pageContext.layoutsUrl,"/Versions.aspx?FileName=",n.default.encodeURIComponent(e),"&IsDlg=1"];if(t){r.push("&list=");r.push(n.default.encodeURIComponent(o.default.normalizeUpper(t,!0)))}return r.join("")};return e}(r.default);t.default=c});define("gJ",["require","exports","ap","bN","aC","fO","fZ","gl","gK","cY"],function(e,t,i,r,n,o,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._dataRequestor=new(t.child(s.typeResourceKey))({qosName:"VersionHistoryDataSource"});t._itemUrlHelper=t.resources.consume(o.resourceKey);t._apiUrlHelper=t.resources.consume(a.resourceKey);return t}e.prototype.getVersionHistoryInfo=function(o){var a=this;return n.default.all({vh:this._getVersionHistory(o),cv:this._getCurrentVersion(o)}).then(function(e){var t=e.vh,r=e.cv,i=a._parseVersionHistory(t,o),n=a._parseCurrentVersion(r,o);i.push(n);return i.reverse()})};e.prototype.restoreVersionByLabel=function(e,t){return this._restoreVersion(e,t)};e.prototype.deleteVersionByLabel=function(e,t){return this._deleteVersion(e,t)};e.prototype.canRestoreVersions=function(e){return this.canDeleteVersions(e)};e.prototype.canDeleteVersions=function(e){var t=!1;e&&(t=l.PermissionMask.hasItemPermission(e,l.PermissionMask.deleteVersions));return t};e.prototype.showVersionLabel=function(){return!0};e.prototype._getApiUrlForItem=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(t).methodWithAliases("GetFileByServerRelativePath",{decodedUrl:t.serverRelativeItemUrl})};e.prototype._getVersionHistory=function(e){var t=this._getApiUrlForItem(e).segment("versions").oDataParameter("$expand","CreatedBy");return this._dataRequestor.getData({url:t.toString(),qosName:"getVersionHistory",method:"GET"}).then(function(e){return e.d})};e.prototype._getCurrentVersion=function(e){var t=this._getApiUrlForItem(e).oDataParameter("$expand","ModifiedBy");return this._dataRequestor.getData({url:t.toString(),qosName:"getCurrentVersion",method:"GET"}).then(function(e){return e.d})};e.prototype._restoreVersion=function(e,t){var r=this._getApiUrlForItem(e).segment("versions").methodWithAliases("RestoreByLabel",{versionLabel:t});return this._dataRequestor.getData({url:r.toString(),qosName:"restoreVersionByLabel",method:"POST"}).then(function(e){return!!e.d},function(e){alert(e.message.value);return!1})};e.prototype._deleteVersion=function(e,t){var r=this._getApiUrlForItem(e).segment("versions").methodWithAliases("RecycleByLabel",{versionLabel:t});return this._dataRequestor.getData({url:r.toString(),qosName:"deleteVersionByLabel",method:"POST"}).then(function(e){return!!e.d},function(e){alert(e.message.value);return!1})};e.prototype._parseCurrentVersion=function(e,t){return{created:new Date(e.TimeLastModified),id:e.UIVersion,isCurrentVersion:!0,size:Number(e.Length),url:e.LinkingUri||t.openUrl,versionLabel:e.UIVersionLabel,appMap:t.appMap,createdBy:e.ModifiedBy}};e.prototype._parseVersionHistory=function(e,t){var r=this;return e.results.map(function(e){return{created:new Date(e.Created),id:e.ID,isCurrentVersion:e.IsCurrentVersion,size:e.Size,url:r._getUrl(t,e.Url),versionLabel:e.VersionLabel,appMap:t.appMap,createdBy:e.CreatedBy}})};e.prototype._getUrl=function(e,t){var r=this._itemUrlHelper.getItemUrlParts(e.key);return u.encodePath(r.fullItemUrl.replace(r.webRelativeItemUrl,t))};return e}(r.default);t.default=c});define("gH",["require","exports","ap","aC","gI","iE","gl","fZ"],function(e,t,i,n,r,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._pageContext=t.resources.consume(o.pageContext);t._apiUrlHelper=t.resources.consume(s.resourceKey);t._dataRequestor=new(t.child(a.typeResourceKey))({qosName:"LanguageDataSource"});return t}e.prototype.getCurrentLanguageCode=function(){return this._pageContext.currentUICultureName};e.prototype.getLanguages=function(){return null};e.prototype.saveLanguage=function(e,t){return null};e.prototype.getLocalizedString=function(e,t){var r=parseInt(t,10);if(isNaN(r))return n.default.wrap(null);this._apiUrlHelper||(this._apiUrlHelper=this.resources.consume(s.resourceKey));var i=this._apiUrlHelper.build().methodWithAliases("SP.Utilities.Utility.GetLocalizedString",{source:e,language:r});return this._dataRequestor.getData({url:i.toString(),qosName:"GetLocalizedString",noRedirect:!0}).then(function(e){return e&&e.d?e.d.GetLocalizedString:null})};return e}(r.default);t.default=u});define("gI",["require","exports","ap","cL","bN"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){r.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.getCurrentLanguage=function(){return i.default.language};return e}(n.default);t.default=o});define("gG",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.prototype.getEncoding=function(){return null};return e}();t.default=r});define("gE",["require","exports","ap","bN","dZ","gF"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._languageDataSource=t.resources.consume(n.language);t._encodingDataSource=t.resources.consume(n.encoding);return t}e.prototype.getEncoding=function(){var e=this._encodingDataSource.getEncoding();if(!e){var t=this._languageDataSource.getCurrentLanguageCode();t=t.toLocaleLowerCase();e=o.default.encodingMap[t]}e||(e=o.default.defaultEncoding);return e};return e}(r.default);t.default=a});define("gF",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.defaultEncoding="windows-1252";e.encodingMap={af:"windows-1252","af-za":"windows-1252",ar:"windows-1256","ar-sa":"windows-1256","az-latn-az":"windows-1254",be:"windows-1251","be-by":"windows-1251",bg:"windows-1251","bg-bg":"windows-1251","bs-latn-ba":"windows-1250",ca:"windows-1252","ca-es":"windows-1252","ca-es-valencia":"windows-1252",cs:"windows-1250","cs-cz":"windows-1250","cy-gb":"windows-1252",da:"windows-1252","da-dk":"windows-1252",de:"windows-1252","de-at":"windows-1252","de-ch":"windows-1252","de-de":"windows-1252",el:"windows-1253","el-gr":"windows-1253",en:"windows-1252","en-au":"windows-1252","en-ca":"windows-1252","en-gb":"windows-1252","en-ie":"windows-1252","en-in":"windows-1252","en-my":"windows-1252","en-nz":"windows-1252","en-ph":"windows-1252","en-sg":"windows-1252","en-us":"windows-1252","en-za":"windows-1252",es:"windows-1252","es-ar":"windows-1252","es-cl":"windows-1252","es-co":"windows-1252","es-cr":"windows-1252","es-es":"windows-1252","es-mx":"windows-1252","es-pe":"windows-1252","es-us":"windows-1252","es-ve":"windows-1252",et:"windows-1257","et-ee":"windows-1257",eu:"windows-1252","eu-es":"windows-1252",fa:"windows-1256","fa-ir":"windows-1256",fi:"windows-1252","fi-fi":"windows-1252","fil-ph":"windows-1252",fr:"windows-1252","fr-be":"windows-1252","fr-ca":"windows-1252","fr-ch":"windows-1252","fr-fr":"windows-1252","ga-ie":"windows-1252","gd-gb":"windows-1252",gl:"windows-1252","gl-es":"windows-1252","ha-latn-ng":"windows-1252",he:"windows-1255","he-il":"windows-1255",hr:"windows-1250","hr-hr":"windows-1250",hu:"windows-1250","hu-hu":"windows-1250",id:"windows-1252","id-id":"windows-1252","ig-ng":"windows-1252",is:"windows-1252","is-is":"windows-1252",it:"windows-1252","it-it":"windows-1252","iu-latn-ca":"windows-1252",ja:"Shift_JIS","ja-ja":"Shift_JIS","ja-jp":"Shift_JIS","ku-arab":"windows-1256","ku-arab-iq":"windows-1256",ky:"windows-1251","ky-kg":"windows-1251","lb-lu":"windows-1252",lt:"windows-1257","lt-lt":"windows-1257",lv:"windows-1257","lv-lv":"windows-1257",mk:"windows-1251","mk-mk":"windows-1251",mn:"windows-1251","mn-mn":"windows-1251",ms:"windows-1252","ms-my":"windows-1252","nb-no":"windows-1252",nl:"windows-1252","nl-be":"windows-1252","nl-nl":"windows-1252","nn-no":"windows-1252","nso-za":"windows-1252","pa-arab":"windows-1256","pa-arab-pk":"windows-1256",pl:"windows-1250","pl-pl":"windows-1250","prs-af":"windows-1256","pt-br":"windows-1252","pt-pt":"windows-1252","qut-gt":"windows-1252","quz-pe":"windows-1252",ro:"windows-1250","ro-ro":"windows-1250",ru:"windows-1251","ru-ru":"windows-1251",rw:"windows-1252","rw-rw":"windows-1252","sd-arab":"windows-1256","sd-arab-pk":"windows-1256",sk:"windows-1250","sk-sk":"windows-1250",sl:"windows-1250","sl-si":"windows-1250",sq:"windows-1250","sq-al":"windows-1250","sr-cyrl-ba":"windows-1251","sr-cyrl-cs":"windows-1251","sr-cyrl-rs":"windows-1251","sr-latn":"windows-1250","sr-latn-rs":"windows-1250",sv:"windows-1252","sv-se":"windows-1252",sw:"windows-1252","sw-ke":"windows-1252","tg-cyrl":"windows-1251","tg-cyrl-tj":"windows-1251",th:"windows-874","th-th":"windows-874","tk-tm":"windows-1250","tn-za":"windows-1252",tr:"windows-1254","tr-tr":"windows-1254",tt:"windows-1251","tt-ru":"windows-1251","ug-cn":"windows-1256",uk:"windows-1251","uk-ua":"windows-1251",ur:"windows-1256","ur-pk":"windows-1256","uz-latn-uz":"windows-1254",vi:"windows-1258","vi-vn":"windows-1258",wo:"windows-1252","wo-sn":"windows-1252","xh-za":"windows-1252","yo-ng":"windows-1252","zu-za":"windows-1252"};return e}();t.default=r});define("gD",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.SetMaskIcon=function(e,t){var r=document.head;if(r){"#"!==(t=t.trim()).charAt(0)&&(t="#"+t);var i=document.createElement("link");i.setAttribute("rel","mask-icon");i.setAttribute("href",e);i.setAttribute("color",t);r.appendChild(i)}};return e}();t.default=r});define("gB",["require","exports","ap","b4","bN","jl","eA","gC","dH","eO","ba","iE"],function(e,t,r,n,i,o,a,s,u,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=[".docx",".xlsx",".pptx",".doc",".xls",".ppt",".pdf",".vsdx",".vsdm",".vsd",".vdx",".vdw",".vss",".vssm",".vssx",".vst",".vstm",".vstx",".vtx",".vsx",".odc",".ods",".odt",".odp"],f=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this,r=t.resources;t._isOLSQueryEnabled=r.consume(o.isOLSQueryEnabledResourceKey);t._itemParentHelper=r.consume(a.resourceKey);t._promiseDebouncer=new n.default;t._searchService=r.consume(o.resourceKey);t._pageContext=r.consume(d.pageContext);return t}e.prototype.getEngagementData=function(e){return(t={}).olsSearchSessionId=this.searchSessionId,t;var t};e.prototype.instrumentStartSearchSession=function(){this._isOLSQueryEnabled&&this._searchService.query("",{pageSize:5,startRow:0,clientFunction:"Warmup",qosName:"SearchDataSource",searchSessionId:this.searchSessionId})};e.prototype.userClickItem=function(t){var e=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"subsite")),r=e&&e.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl;t&&t.extension&&-1<p.indexOf(t.extension)&&t.queryType===u.default.Files&&!r&&c.isFeatureEnabled(c.ItemAnalytics)&&t.type!==l.default.Folder&&t.type!==l.default.OneNote&&this.resources.isDefined(s.resourceKey)&&this._promiseDebouncer.debounce(this.resources.consumeAsync(s.resourceKey).then(function(e){return e.getItemAnalytics(t,{shouldSkipStoreUpdate:!0})}))};return e}(i.default);t.default=f});define("gC",["require","exports","aC","bA","dZ","eT","bb","aZ"],function(e,t,i,r,n,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._itemAnalyticsDataSource=t.itemAnalyticsDataSource;this._itemTaskObserverType=t.itemTaskObserverType;this._graphDataSource=t.graphDataSource}e.prototype.getFilesAnalytics=function(e,t,r){return this._itemAnalyticsDataSource.getFilesAnalytics(e,t,r).then(function(e){return i.default.wrap(e)})};e.prototype.getItemAnalytics=function(e,t){return e.analytics?i.default.wrap(e.analytics):this._getItemAnalyticsAndUpdateItem(e,t)};e.prototype._getItemAnalyticsAndUpdateItem=function(r,i){var n=this,e=this._graphDataSource.getItemUrl(r,{useDirectEndpoint:!0}),t=this._graphDataSource.getAccessToken(r),o={itemId:r.itemId,graph:r.graph,graphItemUrl:e,getAccessToken:function(){return t}},a=this._graphDataSource.getItemUrl(r,{useDirectEndpoint:!0,apiVersion:"v2.1"}),s=this._graphDataSource.getAccessToken(r,{apiVersion:"v2.1"}),u={itemId:r.itemId,graphItemUrl:a,getAccessToken:function(){return s}},l=p.default.generate();d.default.isActivated("E3445ACB-0107-4B85-855E-B25D5CB9D35A","12/07/2017","Control itemAnalytics API v2.1")||this._itemAnalyticsDataSource.getItemAnalytics(u,{apiVersion:"v2.1",isShadowCall:!0,headers:{CallerId:l}});return this._itemAnalyticsDataSource.getItemAnalytics(o,{apiVersion:"v2.0",isShadowCall:!0,headers:{CallerId:l}}).then(function(e){if(e&&(!r.analytics||r.analytics.viewCount!==e.viewCount)&&(!i||!i.shouldSkipStoreUpdate)){var t=new n._itemTaskObserverType;t.update([new c.Task(r.key).succeed({item:{key:r.key,analytics:e}})]);t.flush()}return e})};return e}();t.default=o;t.resourceKey=r.createResolvedResourceKey(e("module").id,o,{itemAnalyticsDataSource:n.analytics,itemTaskObserverType:c.resourceKey,graphDataSource:n.graph})});define("gw",["require","exports","ap","bN","a3","a2","gA","gz","aI","aI","dZ","cE","fV","gy","dH","gx"],function(e,t,i,r,n,o,a,s,u,l,c,d,p,f,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g={".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},y=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._dataStore=new n.default("",o.default.session);t._instrumentationDataSource=t.resources.consume(c.instrumentation.optional);t._pageEvent=void 0;t._engagement=t.resources.consume(d.resourceKey);t._searchSession=t.resources.consume(m.resourceKey);t.initializeSearchSession();return t}e.prototype.onSearchFocus=function(){var e=this.searchSessionId;if(!e&&this._instrumentationDataSource){e=this._generateSearchSessionId();this._instrumentationDataSource.searchSessionId=e;this._instrumentationDataSource.instrumentStartSearchSession()}};e.prototype.logStartSearchOnSubmit=function(){if(!this.searchSessionStarted){var e={name:"StartSearchSession",location:"NA",usageType:s.UsageType[s.UsageType.Click],currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{searchSessionId:this.searchSessionId}};this._startSearchSession();this._engagement.logData(e)}};e.prototype.initializeSearchSession=function(){this.searchSessionId=null;this.searchSessionStarted=!1};e.prototype.currentPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.currentName};e.prototype.previousPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.previousName};e.prototype.userViewPage=function(e){var t=e.name,r="(none)";if(this._pageEvent){r=this._pageEvent.data.currentName;this._pageEvent.end()}this._pageEvent=new f.Page({currentName:t,previousName:r});this._engagement.logData({name:"Page.View",location:"NA",usageType:s.UsageType[s.UsageType.Click],currentPage:t,previousPage:r,extraData:this._getExtraData(t)})};e.prototype.userSeeItem=function(e){};e.prototype.userClickItem=function(t){var e=a.default[a.default.bingClickInstrumentation];if(t.queryType===h.default.Search&&t.urls&&t.urls[e]){var r=new u.Qos({name:"SearchResultClickItem"});p.request(t.urls[e]).done(function(){r.end({resultType:l.ResultTypeEnum.Success})},function(){r.end({resultType:l.ResultTypeEnum.Failure,extraData:{url:t.urls[e]}})})}this._instrumentationDataSource?this._instrumentationDataSource.userClickItem(t):this.resources.isDefined(c.shadowCall)&&this.resources.consumeAsync(c.shadowCall).then(function(e){return e&&e.userClickItem(t)});this._logOfficeDocAge(t)};e.prototype.userClickSuggestion=function(e){if(e){var t=new u.Qos({name:"SearchSuggestionClickItem"});p.request(e).done(function(){t.end({resultType:l.ResultTypeEnum.Success})},function(){t.end({resultType:l.ResultTypeEnum.Failure,extraData:{url:e}})})}};e.prototype.getEngagementData=function(){return this._getExtraData()};e.prototype._getExtraData=function(e){return this._instrumentationDataSource?this._instrumentationDataSource.getEngagementData(e||this.currentPageName()):null};e.prototype._generateSearchSessionId=function(){this.searchSessionId=this._searchSession;return this.searchSessionId};e.prototype._startSearchSession=function(){this.searchSessionStarted=!0};e.prototype._logOfficeDocAge=function(e){if(e&&e.dateModifiedValue)try{var t=e&&e.extension&&e.extension.toLowerCase();if(t){var r=this._engagement;r.logData({name:"File.Clicked",currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{extension:t,size:e.size}});"ms-word"===e.appMap||"ms-powerpoint"===e.appMap?this._dataStore.setValue("OfficeDocClickTime",new Date):this._dataStore.setValue("OfficeDocClickTime","");if(g[t]){var i=new Date(e.dateModifiedValue),n=Math.ceil(((new Date).getTime()-i.getTime())/1e3);0<n&&r.logData({name:"OfficeDocument.Clicked",extraData:{extension:t,age:n,dateModified:e.dateModifiedValue}})}}}catch(e){}};return e}(r.BaseModel);t.default=y});define("fV",["require","exports","bE"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.request=function(e){var t=new i.default,r=document.createElement("img");r.onload=function(){t.complete()};r.onerror=function(){t.error()};r.src=e;return t.getPromise()}});define("gy",["require","exports","aK"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Page=r.createPairedEvent({eventName:"Page,",shortEventName:"Page"},{previousName:1,currentName:1});t.default=t.Page});define("gx",["require","exports","aZ","bA"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(r.default.generate())})});define("gs",["require","exports","ap","aC","bE","bN","gv","dZ","b9","gu","a0","gt"],function(e,t,r,n,o,i,a,s,u,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.isPageLoaded=t.observables.create(!1);t.isPageRenderingComplete=t.observables.create(!1);t._queue=new a.default;t._pltSignal=new o.default;t._renderingCompleteSignal=new o.default;if(t.resources.isExposed(s.bundle)){var r=t.resources.consume(s.bundle);t._bundles=r.getBundles()}else t._bundles={};return t}e.prototype.pageLoaded=function(e){var t=this;if(!this._queue.hasStarted){this._queue.start();if(e){u.default.plt(e);c.default.logData({name:"PageLoad",scenario:"PageLoad",currentPage:e})}d.logSuccess();this.isPageLoaded(!0);this.async.setImmediate(function(){return t._pltSignal.complete()})}};e.prototype.pageRenderingIsComplete=function(e){var t=this;if(e){u.default.plt(e);c.default.logData({name:"PageRenderingIsComplete",scenario:"PageRenderingIsComplete",currentPage:e})}this.isPageRenderingComplete(!0);this.async.setImmediate(function(){return t._renderingCompleteSignal.complete()})};e.prototype.queueLoad=function(e,t){return this._queue.queueLoad(e,0,t)};e.prototype.queueBundle=function(e,t){var r=this.getBundleInfo(e);this.queueLoad(r.path,t).then(function(){r.isLoaded(!0)})};e.prototype.createDeferredContext=function(e){var t=this.getBundleInfo(e),r=new(this.managed(l.default))({});t.path&&this._queue.queueLoad(t.path,1,t.getModule).then(function(){r.finishedProcessing.then(function(){t.isLoaded(!0)});r.isLoaded(!0)});return r};e.prototype.waitFor=function(e,t){return this._queue.waitFor(e,t)};e.prototype.loadNow=function(e,t){return this._queue.loadNow(e,t)};e.prototype.getBundleInfo=function(e){if(e){var t=this._bundles[e];if(!t){t={path:"",getModule:function(){return n.default.as(void 0)},isLoaded:this.createObservable(!1)};this._bundles[e]=t}return t}};e.prototype.waitForPLT=function(){return this._pltSignal.getPromise()};e.prototype.waitForPageRenderingComplete=function(){return this._renderingCompleteSignal.getPromise()};return e}(i.default);t.default=p});define("gv",["require","exports","bS","bE","aC","c7","aI"],function(e,t,r,i,a,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=[1,0],s=new r.default,l=function(){function e(){this._started=!1;this._done=!1;this._bundleGroups={};this._queuedBundles=[]}Object.defineProperty(e.prototype,"hasStarted",{get:function(){return this._started},enumerable:!0,configurable:!0});e.prototype.start=function(){var e=this;if(!this._started){this._started=!0;s.setTimeout(function(){return e._next()},1e3)}};e.prototype.queueLoad=function(e,t,r){if("undefined"==typeof __webpack_public_path__){var i=this._getGroup(e,r),n=this._generateModuleRequest(i,e,t,r);this._queueBundle(i);return n.signal.getPromise()}return o.loadModule({path:e,getModule:r})};e.prototype.waitFor=function(e,t){if("undefined"==typeof __webpack_public_path__){var r=this._getGroup(e,t);return this._generateModuleRequest(r,e,0,t).signal.getPromise()}return o.loadModule({path:e,getModule:t})};e.prototype.loadNow=function(e,t){if("undefined"==typeof __webpack_public_path__){var r=this._getGroup(e,t),i=this._generateModuleRequest(r,e,0,t);r.isResolved||this._requestBundle(r).done();return i.signal.getPromise()}return o.loadModule({path:e,getModule:t})};e.prototype._getGroup=function(e,t){var r=window.require.toUrl(e),i=this._bundleGroups[r];if(!i){i=this._createGroup(e,r,t);this._bundleGroups[r]=i}return i};e.prototype._createGroup=function(e,t,r){var i=window.require.specified(t),n={bundleUrl:t,requestedPath:e,getModule:r,modules:i?null:{},isResolved:i,isQueued:!1};if(!i)for(var o=0,a=u;o<a.length;o++){var s=a[o];n.modules[s]=[]}return n};e.prototype._createModuleRequest=function(e,t){return{path:e,getModule:t,signal:new i.default,isResolved:!1}};e.prototype._addNewModule=function(e,t,r,i){var n=this._createModuleRequest(t,i);e.modules[r].push(n);return n};e.prototype._generateModuleRequest=function(e,t,r,i){var n;if(e.isResolved){n=this._createModuleRequest(t,i);this._resolveModule(n)}else n=this._addNewModule(e,t,r,i);return n};e.prototype._queueBundle=function(e){if(!e.isQueued){this._queuedBundles.push(e);e.isQueued=!0;if(this._done){this._done=!1;this._next()}}};e.prototype._next=function(){var e=this;if(this._started){var t=this._getNextGroup();if(t){var r=this._requestBundle(t);r&&r.then(function(){s.setTimeout(function(){return e._next()},500)}).done()}}};e.prototype._getNextGroup=function(){for(var e=this._queuedBundles.shift();e;){if(!e.isResolved)return e;e=this._queuedBundles.shift()}this._done=!0;return null};e.prototype._processBundlePriorityLevel=function(e,t){if(!e.modules)return a.default.wrap();for(var r=[],i=0,n=e.modules[t];i<n.length;i++){var o=n[i];this._resolveModule(o);r.push(o.signal.getPromise())}return a.default.all(r).then(function(e){return null},function(){return null})};e.prototype._processBundle=function(r){for(var i=this,e=function(e,t){return t.then(function(){return i._processBundlePriorityLevel(r,e)})},t=a.default.wrap(),n=0,o=u;n<o.length;n++){t=e(o[n],t)}return t.then(function(){r.isResolved=!0;r.modules=null})};e.prototype._requestBundle=function(t){var e=this,r=new n.Qos({name:"DeferredBundleLoad"});return o.loadModule({path:t.requestedPath,getModule:t.getModule}).then(function(){r.end({resultType:n.ResultTypeEnum.Success,extraData:{path:t.requestedPath,url:t.bundleUrl}});return e._processBundle(t)},function(e){r.end({resultType:n.ResultTypeEnum.Failure,error:e,extraData:{path:t.requestedPath,url:t.bundleUrl}})})};e.prototype._resolveModule=function(t){t.isResolved=!0;t.path&&o.loadModule({path:t.path,getModule:t.getModule}).then(function(e){t.signal.complete(e)})};return e}();t.default=l});define("gu",["require","exports","ap","bE","aC","bN","aN","c9"],function(e,t,i,n,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._resources=[];t._finished=new n.default;t.finishedProcessing=t._finished.getPromise();t.isLoaded=t.createObservable(!1);t.createBackgroundComputed(t._computeShouldProcess);return t}e.prototype.expose=function(e,t,r){this._resources.push({key:e,path:t,getModule:r});this.isLoaded.peek()&&this._processResources()};e.prototype._processResources=function(){for(var e=this,t=o.default.wrap(),r=0,i=this._resources;r<i.length;r++){var n=i[r];t=this._processResource(t,n)}t.then(function(){e._resources.length=0;e._finished.complete()})};e.prototype._processResource=function(e,r){var i=this;return e.then(function(){return s.loadModule({path:r.path,getModule:r.getModule}).then(function(t){try{var e=new(i.managed(t))({});i.resources.expose(r.key,e)}catch(e){a.default.logError(e,{rawResult:"("+typeof t+"): "+t,resourceKey:"("+r.key.id+"): "+r.key.name})}})})};e.prototype._computeShouldProcess=function(){this.isLoaded()&&this._processResources()};return e}(r.default);t.default=u});define("gq",["require","exports","ap","bN","cE","d7","ba","gr"],function(e,t,i,r,n,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._peopleToPrefetch={};t._debouncedPrefetch=t.async.debounce(function(){return t._prefetchPeopleCards()},50);return t}e.prototype.personRendered=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];i&&!this._peopleToPrefetch[i]&&(this._peopleToPrefetch[i]=!0)}this._debouncedPrefetch()};e.prototype.getPeopleCardData=function(e){if(a.isFeatureEnabled(a.PeopleCardsOnLoki)&&!a.isFeatureEnabled(a.PeopleCardsReactComponent)){this.resources.consume(n.resourceKey).logData({name:"PeopleCard.DataLoad"});this._peopleCardProvider||(this._peopleCardProvider=this.resources.consume(o.peopleCard));this._peopleCardProvider.getPeopleCard(e,!1)}};e.prototype._prefetchPeopleCards=function(){if(a.isFeatureEnabled(a.PeopleCardsOnLoki)&&!a.isFeatureEnabled(a.PeopleCardsReactComponent)){this._peopleCardProvider||(this._peopleCardProvider=this.resources.consume(o.peopleCard));var e=Object.keys(this._peopleToPrefetch);0<e.length&&this._peopleCardProvider.prefetchPeopleCards(e,s.default.Page)}this._peopleToPrefetch={}};return e}(r.default);t.default=u});define("gr",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.Page=0]="Page";e[e.Card=1]="Card"}(r=t.DisplayType||(t.DisplayType={}));t.default=r});define("gp",["require","exports","ap","bN"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._fileSystemItemIdMapping={};return t}e.prototype.getPathFromItemId=function(e){return this._fileSystemItemIdMapping[e]};e.prototype.setFileSystemIdMapping=function(e,t){this._fileSystemItemIdMapping[e]=t};return e}(r.default);t.default=n});define("go",["require","exports","ap","aq","a3"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){r.__extends(t,e);function t(){return e.call(this,"UserInfoStore")||this}t.prototype.getUserInfo=function(){var e=this.getValue("userInfo");if(!e){e=i.observable(null);this.setValue("userInfo",e)}return e};return t}(n.default);t.default=o});define("gn",["require","exports","ap","a3","a2"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(e,r);function e(e){var t=r.call(this,"UserSettingsStore",n.default.local)||this;t._defaultRootItemId=e&&e.defaultRootItemId||"";t._viewerId=e&&e.viewerId||"";return t}e.prototype.setAllPhotosUserSettings=function(e){this.setValue(this._getLocalStorageKey(),e)};e.prototype.getAllPhotosUserSettings=function(){var e=this.getValue(this._getLocalStorageKey());if(!e){e={isAscending:!1,rootId:this._defaultRootItemId};this.setAllPhotosUserSettings(e);e=this.getValue(this._getLocalStorageKey())}return e};e.prototype._getLocalStorageKey=function(){return"allPhotosUserSettings&viewerId="+this._viewerId};return e}(r.default);t.default=o});define("gd",["require","exports","ap","aC","gk","gf","ge","dc"],function(e,t,i,n,r,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u="guidedTour_oneDrive",l="teachingBubbles_oneDrive",c="upsells_oneDrive",d="optimizelyExperimentMap_oneDrive",p=[u,l,c,d],f="sharePointOneDriveBusinessFirstRun",h=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._vroomDataRequestor=t.resources.consume(o.resourceKey);t.userSettingsStoreKey="userinfo_odb_key";t._guidedTourDataHelper=new a.default;t._checkForParamOverrides();t._teachingBubbles={};t._upsells={};t._experimentMap={};return t}e.prototype.getGuidedTourCompleted=function(){var e=this;return this._populateCustomFacets().then(function(){return e._guidedTourDataHelper.getGuidedTourCompleted()},function(e){return!0})};e.prototype.getGuidedTourViewCount=function(){var e=this;return this._populateCustomFacets().then(function(){return e._guidedTourDataHelper.getGuidedTourViewCount()})};e.prototype.updateGuidedTourData=function(e,t){this._guidedTourDataHelper.updateGuidedTourData(e,t);return this._setCustomFacet(u,this._guidedTourDataHelper.getGuidedTourData())};e.prototype.completeGuidedTourAction=function(e){this._guidedTourDataHelper.completeGuidedTourAction(e);return this._setCustomFacet(u,this._guidedTourDataHelper.getGuidedTourData())};e.prototype.getCompletedGuidedTourActions=function(){var e=this;return this._populateCustomFacets().then(function(){return e._guidedTourDataHelper.getCompletedGuidedTourActions()})};e.prototype.resetGuidedTourUserFact=function(){var e=this;return this._populateCustomFacets().then(function(){e._guidedTourDataHelper.resetGuidedTourUserFact();return e._setCustomFacet(u,e._guidedTourDataHelper.getGuidedTourData())})};e.prototype.getFirstRunExperienceDismissed=function(){var e=this.dataStore.getValue(f);return void 0!==e?n.default.wrap(e):this.getUserFlagValue(f)};e.prototype.updateFirstRunExperienceData=function(e,t){return e?this.updateUserFlagValue(f,!0):n.default.wrap(!1)};e.prototype.getBubbleUserFact=function(e,t){var r=this;return this._populateCustomFacets().then(function(){return r._teachingBubbles[e.campaignGuid]||{d:!1,v:0}})};e.prototype.setBubbleUserFact=function(e,t){var r=this;return this._populateCustomFacets().then(function(){r._teachingBubbles[e.campaignGuid]=t;return r._setCustomFacet(l,r._teachingBubbles)})};e.prototype.getUpsellDismissedById=function(e,t){return this._getUpsellUserFact(e,t).then(function(e){return!!e.d})};e.prototype.getUpsellViewCountById=function(e,t){return this._getUpsellUserFact(e,t).then(function(e){return e.v})};e.prototype.markUpsellAsSeen=function(t){var r=this;return this._getUpsellUserFact(t).then(function(e){e.v++;return r._setUpsellUserFact(t,e)})};e.prototype.markUpsellAsDismissed=function(t){var r=this;return this._getUpsellUserFact(t).then(function(e){e.d=!0;return r._setUpsellUserFact(t,e)})};e.prototype.getOptimizelyVariation=function(e){var t=this;return this._populateCustomFacets().then(function(){return t._experimentMap&&t._experimentMap[e]?t._experimentMap[e]:0},function(e){return n.default.wrap(0)})};e.prototype.setOptimizelyVariation=function(e,t){var r=this;return this._populateCustomFacets().then(function(){r._experimentMap[e]=t;return r._setCustomFacet(d,r._experimentMap)},function(e){return n.default.wrap(!1)})};e.prototype.getEXPExperimentVariation=function(e){return n.default.wrap(0)};e.prototype.setEXPExperimentVariation=function(e,t){return n.default.wrap(!1)};e.prototype._getUpsellUserFact=function(e,t){var r=this;return this._populateCustomFacets().then(function(){return r._upsells[e]||{d:!1,v:0}})};e.prototype._setUpsellUserFact=function(e,t){var r=this;return this._populateCustomFacets().then(function(){r._upsells[e]=t;return r._setCustomFacet(c,r._upsells)})};e.prototype._populateCustomFacets=function(){var t=this;if(this._pendingRequest)return this._pendingRequest;var e=this._vroomDataRequestor.send({path:"/drive/root?$select="+p.join(","),apiName:"CustomFacets",apiVersion:"v2.1"}).then(function(e){t._updateCustomFacetCache(e)},function(e){delete t._pendingRequest;return n.default.wrapError(e)});return this._pendingRequest=e};e.prototype._setCustomFacet=function(e,t){var r,i=this,n=((r={})[e]=t,r);return this._vroomDataRequestor.send({path:"/drive/root",apiName:"CustomFacets",requestType:"PATCH",postData:JSON.stringify(n),apiVersion:"v2.1"}).then(function(e){i._updateCustomFacetCache(e);return!0},function(e){return!1})};e.prototype._updateCustomFacetCache=function(e){e[u]&&this._guidedTourDataHelper.setGuidedTourData(e[u]);e[l]&&(this._teachingBubbles=e[l]);e[c]&&(this._upsells=e[c]);e.optimizelyExperimentMap_oneDrive&&(this._experimentMap=e.optimizelyExperimentMap_oneDrive)};e.prototype._checkForParamOverrides=function(){var e=this.resources.consume(s.navigation).viewParams;e.resetGuidedTour&&this.resetGuidedTourUserFact();e.resetFre&&this.updateUserFlagValue(f,!1)};return e}(r.default);t.default=h});define("gk",["require","exports","ap","aC","aM","a3","bN","ep","a2","iF","gl","iE"],function(e,t,i,n,o,a,r,s,u,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.userSettingsStoreKey="userinfo_base_key";t.userSettingsStore=t.resources.isExposed(l.userSettingsStore)?t.resources.consume(l.userSettingsStore):null;t.dataStore=new a.default("UserInfo",u.default.local);t._pageContext=t.resources.consume(d.pageContext);t._dataRequestor=new(t.child(c.typeResourceKey))({qosName:"CurrentUserInfoDataSource"});return t}e.prototype.canPersistUserInfo=function(){var e=Number(this._pageContext.webTemplate)===s.default.mySite;return this._pageContext.isSiteAdmin&&e};e.prototype.getUpsellDismissedById=function(e,t){return n.default.wrap(void 0)};e.prototype.getUpsellViewCountById=function(e,t){return n.default.wrap(void 0)};e.prototype.markUpsellAsSeen=function(e){return n.default.wrap(void 0)};e.prototype.markUpsellAsDismissed=function(e){return n.default.wrap(void 0)};e.prototype.getAnid=function(){return null};e.prototype.getMarket=function(){return null};e.prototype.getLanguage=function(){return null};e.prototype.isNewUser=function(){return null};e.prototype.isAuthenticated=function(){return!0};e.prototype.getUserInfo=function(e){var t=this.userSettingsStore.getValue(this.userSettingsStoreKey);return n.default.wrap(t)};e.prototype.setUserInfo=function(e){var t=this.mergeUserInfo(e);this.userSettingsStore.setValue(this.userSettingsStoreKey,t);return n.default.wrap(!0)};e.prototype.setUserInfoWithUserFacts=function(e,t,r,i,n){var o={type:e,action:t};r&&(o.param=r);n&&(o.data=n);i&&(o.id=i);return this.setUserInfo(o)};e.prototype.sendShowUpsell=function(e,t,r){return n.default.wrap(!1)};e.prototype.sendCloseUpsell=function(e,t,r){return n.default.wrap(!1)};e.prototype.resetUpsellUserFact=function(){return n.default.wrap(!1)};e.prototype.updateUpsellData=function(e,t,r){return n.default.wrap(!1)};e.prototype.hasUserFact=function(e){return n.default.wrap(!1)};e.prototype.getIsPremium=function(e){return n.default.wrap(!1)};e.prototype.getUpsellToShow=function(e){return n.default.wrap(null)};e.prototype.getUpsellViewCount=function(e){return n.default.wrap(0)};e.prototype.getUpsellDismissed=function(e){return n.default.wrap(!1)};e.prototype.getUpsellIframeSrc=function(e,t){return n.default.wrap(null)};e.prototype.getFirstRunExperienceDismissed=function(){return n.default.wrap(!0)};e.prototype.getFirstRunExperienceViewCount=function(){return n.default.wrap(0)};e.prototype.updateFirstRunExperienceData=function(e,t){return n.default.wrap(!0)};e.prototype.hasPositioningBeenViewed=function(){return n.default.wrap(!0)};e.prototype.datePositioningViewed=function(){return n.default.wrap(new Date)};e.prototype.getPremiumUpsellsViewed=function(){return n.default.wrap({hasPositioningViewed:!0,hasNewFeaturesViewed:!0,hasWelcomeToPremiumViewed:!0})};e.prototype.getMostRecentNewFeaturesUpsellViewed=function(){return n.default.wrap(!0)};e.prototype.getWelcomeToPremiumViewed=function(){return n.default.wrap(!0)};e.prototype.setPositioningUserFactWithParams=function(e){return n.default.wrap(!0)};e.prototype.getGuidedTourCompleted=function(){return n.default.wrap(!0)};e.prototype.getGuidedTourViewCount=function(){return n.default.wrap(0)};e.prototype.updateGuidedTourData=function(e,t){return n.default.wrap(!1)};e.prototype.completeGuidedTourAction=function(e){return n.default.wrap(!1)};e.prototype.getCompletedGuidedTourActions=function(){return n.default.wrap([])};e.prototype.getExpiringSharingLinksSeen=function(){return n.default.wrap(!1)};e.prototype.setExpiringSharingLinksSeen=function(){};e.prototype.getOptimizelyVariation=function(e){return n.default.wrap(0)};e.prototype.setOptimizelyVariation=function(e,t){return n.default.wrap(!0)};e.prototype.getEXPExperimentVariation=function(e){return n.default.wrap(0)};e.prototype.setEXPExperimentVariation=function(e,t){return n.default.wrap(!0)};e.prototype.mergeUserInfo=function(e){var t=this.userSettingsStore.getValue(this.userSettingsStoreKey);if(t&&t.info&&0<t.info.length){for(var r=!1,i=0;i<t.info.length;i++){var n=t.info[i];if(n&&e&&n.type===e.type&&n.id===e.id){t.info[i]=e;r=!0;break}}r||t.info.push(e)}else t={info:[e]};return t};e.prototype.getUserFlagValue=function(r){var i=this;return this._dataRequestor.getData({url:this._getQueryUrl(r),qosName:"GetFirstRunFlag",method:"GET"}).then(function(e){if(e&&e.d&&void 0!==e.d[r]){var t=!!e.d[r];i.dataStore.setValue(r,t);return t}return!0})};e.prototype.updateUserFlagValue=function(e,t){this.dataStore.setValue(e,t);var r={};r[e]=t;return this._dataRequestor.getData({url:this._getUpdateUrl(),qosName:"SetFirstRunFlag",additionalPostData:JSON.stringify(r),method:"POST",additionalHeaders:{"X-HTTP-Method":"PATCH",Accept:"application/json; odata=minimalmetadata"},contentType:"application/json; odata=minimalmetadata"}).then(function(){return t})};e.prototype._getQueryUrl=function(e){return this._getUpdateUrl()+"?$select="+e};e.prototype._getUpdateUrl=function(){return o.default.escapeUrlForCallback(this._pageContext.webAbsoluteUrl)+"/_api/SP.Directory.DirectorySession/User(principalName='"+o.default.escapeUrlForCallback(this._pageContext.userLoginName)+"')"};return e}(r.default);t.BaseUserInfoDataSource=p;t.default=p});define("ge",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.resetGuidedTourUserFact()}e.prototype.getGuidedTourData=function(){return this._guidedTourData};e.prototype.setGuidedTourData=function(e){this._guidedTourData=e};e.prototype.getGuidedTourCompleted=function(){var e=this._guidedTourData;return!(!e||!e.c)};e.prototype.getGuidedTourViewCount=function(){var e=this._guidedTourData.v;return void 0===e?0:e};e.prototype.updateGuidedTourData=function(e,t){var r=this._guidedTourData;e&&(r.c=!0);t&&(r.v=(r.v||0)+1)};e.prototype.completeGuidedTourAction=function(e){var t=this._guidedTourData;switch(e){case 0:t.u=!0;break;case 1:t.m=!0;break;case 2:t.s=!0;break;case 3:t.sh=!0;break;case 4:t.f=!0;break;default:return}};e.prototype.getCompletedGuidedTourActions=function(){var e=this._guidedTourData,t=[];e.u&&t.push(0);e.m&&t.push(1);e.s&&t.push(2);e.sh&&t.push(3);e.f&&t.push(4);return t};e.prototype.resetGuidedTourUserFact=function(){this._guidedTourData={c:!1,v:0,u:!1,m:!1,s:!1,sh:!1,f:!1}};return e}();t.GuidedTourDataHelper=r;t.default=r});define("f9",["require","exports","ap","dZ","aC","bN","ga"],function(e,t,i,n,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.dataSource=t.resources.consume(n.userInfo);t.canPersistUserInfo=t.dataSource.canPersistUserInfo();return t}e.prototype.getAnid=function(){return this.dataSource.getAnid()};e.prototype.isAuthenticated=function(){return this.dataSource.isAuthenticated()};e.prototype.getUserInfo=function(e){var t=this;return e||!this._cachedUserInfo?this.isAuthenticated()?this.dataSource.getUserInfo(e).then(function(e){return t._cachedUserInfo=e},function(e){return o.default.wrapError(null)}):o.default.wrap(null):o.default.wrap(this._cachedUserInfo)};e.prototype.setUserInfo=function(e,t,r,i,n){return this.dataSource.setUserInfoWithUserFacts(e,t,r,i,n)};e.prototype.resetUpsellUserFact=function(){return this.dataSource.resetUpsellUserFact()};e.prototype.getBubbleUserFact=function(a,e){var s=this;return this.dataSource.getBubbleUserFact?this.dataSource.getBubbleUserFact(a,e):this.getUserInfo(e).then(function(e){if(e&&e.info)for(var t=0,r=e.info;t<r.length;t++){var i=r[t],n=s.peekUnwrapObservable(a),o=s.peekUnwrapObservable(n.campaignGuid);if(i.id&&i.id.toLowerCase()===o.toLowerCase())return JSON.parse(i.data)}return{d:!1,v:0}},function(e){return o.default.wrapError(null)})};e.prototype.setBubbleUserFact=function(e,t){return this.dataSource.setBubbleUserFact?this.dataSource.setBubbleUserFact(e,t):this.setUserInfo(17,3,null,e.campaignGuid,JSON.stringify(t))};e.prototype.getUpsellDismissedById=function(e,t){return this.dataSource.getUpsellDismissedById(e,t)};e.prototype.getUpsellViewCountById=function(e,t){return this.dataSource.getUpsellViewCountById(e,t)};e.prototype.markUpsellAsSeen=function(e){return this.dataSource.markUpsellAsSeen(e)};e.prototype.markUpsellAsDismissed=function(e){return this.dataSource.markUpsellAsDismissed(e)};e.prototype.updateUpsellData=function(e,t,r){return this.dataSource.updateUpsellData(e,t,r)};e.prototype.hasUserFact=function(e){return this.dataSource.hasUserFact(e)};e.prototype.getIsPremium=function(e){return this.dataSource.getIsPremium(e)};e.prototype.getUpsellToShow=function(e){return this.dataSource.getUpsellToShow(e)};e.prototype.getUpsellViewCount=function(e){return this.dataSource.getUpsellViewCount(e)};e.prototype.getUpsellDismissed=function(e){return this.dataSource.getUpsellDismissed(e)};e.prototype.getUpsellIframeSrc=function(e,t){return this.dataSource.getUpsellIframeSrc(e,t)};e.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?a.default[e.variation]:e};e.prototype.sendShowUpsell=function(e,t,r){return this.dataSource.sendShowUpsell(e,t,r)};e.prototype.sendCloseUpsell=function(e,t,r){return this.dataSource.sendCloseUpsell(e,t,r)};e.prototype.getMarket=function(){return this.dataSource.getMarket()};e.prototype.getFirstRunExperienceDismissed=function(){return this.dataSource.getFirstRunExperienceDismissed()};e.prototype.getFirstRunExperienceViewCount=function(){return this.dataSource.getFirstRunExperienceViewCount()};e.prototype.updateFirstRunExperienceData=function(e,t){return this.dataSource.updateFirstRunExperienceData(e,t)};e.prototype.hasPositioningBeenViewed=function(){return this.dataSource.hasPositioningBeenViewed()};e.prototype.datePositioningViewed=function(){return this.dataSource.datePositioningViewed()};e.prototype.getPremiumUpsellsViewed=function(){return this.dataSource.getPremiumUpsellsViewed()};e.prototype.getMostRecentNewFeaturesUpsellViewed=function(){return this.dataSource.getMostRecentNewFeaturesUpsellViewed()};e.prototype.setPositioningUserFactWithParams=function(e){return this.dataSource.setPositioningUserFactWithParams(e)};e.prototype.getGuidedTourCompleted=function(){return this.dataSource.getGuidedTourCompleted()};e.prototype.getGuidedTourViewCount=function(){return this.dataSource.getGuidedTourViewCount()};e.prototype.updateGuidedTourData=function(e,t){return this.dataSource.updateGuidedTourData(e,t)};e.prototype.completeGuidedTourAction=function(e){return this.dataSource.completeGuidedTourAction(e)};e.prototype.getCompletedGuidedTourActions=function(){return this.dataSource.getCompletedGuidedTourActions()};e.prototype.getExpiringSharingLinksSeen=function(){return this.dataSource.getExpiringSharingLinksSeen()};e.prototype.setExpiringSharingLinksSeen=function(){return this.dataSource.setExpiringSharingLinksSeen()};e.prototype.getOptimizelyVariation=function(e){return this.dataSource.getOptimizelyVariation(e)};e.prototype.setOptimizelyVariation=function(e,t){return this.dataSource.setOptimizelyVariation(e,t)};e.prototype.getEXPExperimentVariation=function(e){return this.dataSource.getEXPExperimentVariation(e)};e.prototype.setEXPExperimentVariation=function(e,t){return this.dataSource.setEXPExperimentVariation(e,t)};return e}(r.default);t.default=s});define("ga",["require","exports","gc","gb","ba"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=window.$Config&&window.$Config.isINT;t.intBaseUrl="https://messaging-int.msonerm.com/";t.baseUrl="https://dynmsg.modpim.com/";var a,s=((a={})[i.default.NewBrandFRE]={id:i.default.NewBrandFRE,type:r.default.FRE,checkThrottle:function(e){return e.viewCount<=2&&!e.didUserDismiss},getUpsellIframeUrl:function(e){return(o?t.intBaseUrl:t.baseUrl)+"api/v1/messaging/web/message?puid="+e.upsellUserId+"&locale="+e.market+"&Source=OneDriveFRE"},shouldSendMessageOnClose:!0,renderType:0},a[i.default.OneRmO365Upsell]={id:i.default.OneRmO365Upsell,type:r.default.ONEUNIT,ramp:n.OneRmO365UpsellEnabled,checkThrottle:function(e){return n.isFeatureEnabled(n.OneRmO365UpsellEnabled)},getUpsellIframeUrl:function(e){return(o?t.intBaseUrl:t.baseUrl)+"api/v1/messaging/web/message?puid="+e.upsellUserId+"&locale="+e.market+"&data="+encodeURIComponent(JSON.stringify({isO365:e.isO365,bytesUsed:e.bytesUsed,bytesAvailable:e.bytesAvailable}))+"&Source=OneDriveWebBanner"},shouldSendMessageOnClose:!0,renderType:1},a);t.default=s});define("gc",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.FRE=0]="FRE";e[e.ONEUNIT=1]="ONEUNIT"}(r||(r={}));t.default=r});define("gb",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.None=0]="None";e[e.NewBrandFRE=1]="NewBrandFRE";e[e.MusicFolderCreationOld=2]="MusicFolderCreationOld";e[e.MusicFolderCreation=3]="MusicFolderCreation";e[e.OneUnitUpsell=4]="OneUnitUpsell";e[e.OneDriveBusinessUpsell=5]="OneDriveBusinessUpsell";e[e.TenGigMaxFileSize=6]="TenGigMaxFileSize";e[e.PreviewTagsView=7]="PreviewTagsView";e[e.XboxMusic=8]="XboxMusic";e[e.O365Upsell1=9]="O365Upsell1";e[e.O365Upsell2=10]="O365Upsell2";e[e.O365Upsell3=11]="O365Upsell3";e[e.O365Upsell4=12]="O365Upsell4";e[e.OneRmO365Upsell=13]="OneRmO365Upsell";e[e.FirstRunExperienceDialog=14]="FirstRunExperienceDialog";e[e.ExpiringSharingLinks=15]="ExpiringSharingLinks";e[e.MobileUpsell=16]="MobileUpsell";e[e.WrsIntroduction=17]="WrsIntroduction"}(r||(r={}));t.default=r});define("f8",["require","exports","ap","aC","bN","dZ"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){r.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.getSubscriptions=function(t){return this._getSubscriptionsDataSource().then(function(e){return e.getSubscriptions(t)})};e.prototype.updateSubscription=function(t){return this._getSubscriptionsDataSource().then(function(e){return e.updateSubscription(t)})};e.prototype.getRootSubscriptions=function(){return this._getSubscriptionsDataSource().then(function(e){return e.getRootSubscriptions()})};e.prototype.createRootSubscription=function(t){return this._getSubscriptionsDataSource().then(function(e){return e.createRootSubscription(t)})};e.prototype.updateRootSubscription=function(t){return this._getSubscriptionsDataSource().then(function(e){return e.updateRootSubscription(t)})};e.prototype.deleteRootSubscription=function(t){return this._getSubscriptionsDataSource().then(function(e){return e.deleteRootSubscription(t)})};e.prototype._getSubscriptionsDataSource=function(){var t=this;if(this._subscriptionsDataSource)return i.default.wrap(this._subscriptionsDataSource);if(this.resources.isExposed(o.subscriptions)){this._subscriptionsDataSource=this.resources.consume(o.subscriptions);return i.default.wrap(this._subscriptionsDataSource)}return this.resources.consumeAsync(o.subscriptions).then(function(e){return t._subscriptionsDataSource=e})};return e}(n.default);t.default=a});define("f7",["require","exports","ap","aC","bN"],function(r,e,i,n,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getBundles=function(){return(e={})[1]={path:"Eo",getModule:function(){return new n.default(function(e,t){r(["Eo"],e,t)})},isLoaded:this.createObservable(!1)},e[2]={path:"ahl",getModule:function(){return new n.default(function(e,t){r(["ahl"],e,t)})},isLoaded:this.createObservable(!1)},e;var e};return t}(t.default);e.default=o});define("fQ",["require","exports","ap","bE","fR"],function(e,t,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r._baseInfoSetCallbacks=[];r._authDataSignalCompleted=!1;r._authDataSignal=new n.default;return r}e.prototype.getAuthData=function(){return this._authDataSignal.getPromise()};e.prototype.hasAuthData=function(){return!!this._processor.getCommonAuthData()};e.prototype.hasAuthDataExpired=function(){var e=new Date;e.setMinutes(e.getMinutes()-5);var t=this._processor.getCommonAuthData();return t&&t.expirationTime<=e};e.prototype.setBaseInfo=function(e){this._baseInfoSet=!0;var t=this._processor.parseCommonData(e);if(t.authData)if(this._authDataSignalCompleted){this._authDataSignal=new n.default;this._authDataSignal.complete(t.authData)}else{this._authDataSignalCompleted=!0;this._authDataSignal.complete(t.authData)}this._cookieHelper.checkCookies(t.mediaUrl,t.authData);for(var r=0,i=this._baseInfoSetCallbacks;r<i.length;r++){(0,i[r])()}};e.prototype.hasSetBaseInfo=function(){return this._baseInfoSet};e.prototype.registerSetBaseInfoCallback=function(e){this._baseInfoSetCallbacks.push(e)};e.dependencies=r.__assign({},o.default.dependencies);return e}(o.default);t.default=i});define("fR",["require","exports","ap","cL","dq","bN","bA","f6","f5","f4","ba","f2","fY","fT","fS","iE","bb"],function(e,t,r,n,a,o,i,s,u,l,d,c,p,f,h,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y={"ar-SA":!0,"he-IL":!0,"ja-JP":!0,"ko-KR":!0,"zh-CN":!0},v=/&(?:access_|proof)token=[^&]*/g,_=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r._processor=t.metaDataProcessor;r._cookieHelper=t.authCookieHelper;r._thumbnailHelper=t.thumbnailHelper;r._pageContext=t.pageContext;r._authTokenStore=t.authTokenStore;return r}e.prototype.getVideoUrl=function(e){if("False"!==e.item[".hasVideoManifest"]||e.item[".videoManifestUrl"]||"audio"===a.getIconNameFromExtension(e.fileExtension)||d.isFeatureEnabled(d.EnableAudioPlayer)){var t=this._processor.generateUrl(".videoManifestUrl",e.item);if(t){var r=e.mediaServiceMetadata,i=r&&r.video,n=i&&i.manifestMetadata;t+="&manifestMetadata="+(n?encodeURIComponent(n):"");var o=e.item[".ctag"];o&&(t+="&cTag="+encodeURIComponent(o))}return t}};e.prototype.getThumbnail=function(e){if(("False"!==e.item[".hasThumbnail"]||e.item[".thumbnailUrl"])&&this._thumbnailHelper.canProvideThumbnail(e.fileExtension)){var t=this._processor.generateUrl(".thumbnailUrl",e.item);t&&!g.default.isActivated("85775921-1245-4ee1-b35f-e06639cd255c","3/22/2018","Encode failures in thumbnail requests")&&(t+="&encodeFailures=1");var r=e.allowCookieAuth,i=void 0===r||r,n=e.itemKey,o=e.fileExtension,a=e.mediaServiceMetadata;if(t&&i&&this._cookieHelper.canUseCookies()){t=t.replace(v,"");e.item[".ctag"]&&(t+="&ctag="+encodeURIComponent(e.item[".ctag"]));this._cookieHelper.trackItem({itemKey:n,thumbnailUrl:t,fileExtension:o,mediaServiceMetadata:a})}else if(t&&!g.default.isActivated("2f97d187-dde1-40dd-84b5-90a7cdd623b3","2/14/2017","Store auth tokens in session storage when cookie auth is not available")){var s=this._processor.getCommonAuthData();if(s){var u=d.isFeatureEnabled(d.MediaTAUseVroomV21),l={authToken:u?s.authTokenV21:s.authToken,proofToken:u?s.proofTokenV21:s.proofToken},c=this._authTokenStore.getToken(this._processor.getUniqueKey(),l);c&&c!==l&&(t=t.replace(v,"&access_token="+c.authToken+(c.proofToken?"&prooftoken="+c.proofToken:"")))}}return t&&this._thumbnailHelper.getThumbnail({itemKey:n,fileExtension:o,baseUrl:t,mediaServiceMetadata:a})}};e.prototype.getDownloadAsZipUrl=function(e){var t=this._processor.getNormalUrl(".zipUrl",e);if(!t){e[".zipUrl"]=s.ZIP_URL;t=this._processor.getFallbackUrl(".zipUrl",e)}return t};e.prototype.getPdfConversionUrl=function(e,t){return(this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled&&!g.default.isActivated("37a36bc4-de0c-4a7f-af97-89bccb2a21fe","04/05/2018","Passthrough pdfs for all policy modes"))&&u.default.isPdfFile(e.fileExtension)?this._processor.generateUrl(".transformUrl",e.item,"passthrough"):y[n.default.language]||"False"===e.item[".hasPdf"]&&!e.item[".pdfConversionUrl"]?void 0:u.default.canProvidePdfUrl(e.fileExtension)||t?this._processor.generateUrl(".pdfConversionUrl",e.item):void 0};e.prototype.getFbxConversionUrl=function(e){return"True"===e.item[".hasBxf"]&&l.canConvertToFbx(e.fileExtension)?this._processor.generateUrl(".transformUrl",e.item,"bxf"):""};e.prototype.getHtmlConversionUrl=function(e){return this._processor.generateUrl(".transformUrl",e.item,"html")};e.prototype.getZipMetaDataUrl=function(e){return this._processor.generateUrl(".transformUrl",e.item,"zipmetadata")};e.prototype.getDownloadZipContentsUrl=function(e){return this._processor.generateUrl(".transformUrl",e,"zipcontent")};e.prototype.getOfficeBundleGenerateUrl=function(e){if("False"!==e.item[".hasOfficePreview"]||e.item[".officeBundleGenerate"]){var t=this._processor.generateUrl(".officeBundleGenerate",e.item),r=encodeURIComponent(e.item[".ctag"]);return t&&t.replace("Generate","")+"&minVersion={{minVersion}}&cTag="+r}};e.prototype.getOfficeBundleGetFragmentUrl=function(e){if("False"!==e.item[".hasOfficePreview"]||e.item[".officeBundleGetFragment"]){var t=this._processor.generateUrl(".officeBundleGetFragment",e.item);return t&&t.replace("Get","")+"&fragment={0}"}};e.prototype.getitemUrlWithToken=function(e){return 0<e.toLowerCase().indexOf("access_token")?e:e+(-1===e.indexOf("?")?"?":"&")+this._processor.getCommonProperty(".driveAccessToken")};e.prototype.getPushChannelUrl=function(){return this._processor.getCommonProperty(".pushChannelBaseUrl")};e.dependencies=r.__assign({},o.default.dependencies,{thumbnailHelper:p.resourceKey,metaDataProcessor:h.resourceKey,authCookieHelper:f.resourceKey,pageContext:m.pageContext,authTokenStore:c.resourceKey});return e}(o.default);t.default=_;t.resourceKey=i.createResolvedResourceKey(e("module").id,_)});define("f6",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ZIP_URL="{.mediaBaseUrl}/transform/zip?cs={.callerStack}";t.COMMON=[".accessToken",".callerStack",".mediaBaseUrl",".mediaBaseUrlSecondary",".pushChannelBaseUrl",".driveAccessToken",".driveUrl",".driveAccessTokenV21",".driveUrlV21",".zipUrl",".pdfConversionUrl",".thumbnailUrl",".transformUrl",".videoManifestUrl",".officeBundleGenerate",".officeBundleGetFragment"];t.FALLBACK_PROPERTIES=[".callerStack",".correlationId",".mediaBaseUrl",".spResourceUrl"]});define("f5",["require","exports","ba"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["msg","eml","epub","tif","tiff"],n=function(){function e(){}e.canProvidePdfUrl=function(e){if(!e)return!1;if(!r.isFeatureEnabled(r.UseWebPdfViewer))return!1;if(r.isFeatureEnabled(r.EnablePdfCoversionForAllTypes))return!0;"."===e[0]&&(e=e.substring(1));return 0<=i.indexOf(e.toLowerCase())};e.isPdfFile=function(e){if(!e)return!1;"."===e[0]&&(e=e.substring(1));return"pdf"===e.toLowerCase()};return e}();t.default=n});define("f2",["require","exports","a3","a2","bA","f3"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){void 0===e&&(e={});this._dataStore=new r.default("MediaAuthStore",i.default.session)}e.prototype.getToken=function(e,t){if(e){var r=this._dataStore.getValue(e);if(r&&!o.isTokenExpired(r,36e5))return r;this._dataStore.setValue(e,t)}return t};return e}();t.default=a;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:new n.SimpleResourceFactory(a)})});define("f3",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(e){try{return JSON.parse(atob(e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/")))}catch(e){}}t.parseToken=i;function n(e){try{return new Date(parseInt(e+"000",10))}catch(e){}}t.getDate=n;t.isTokenExpired=function(e,t){void 0===t&&(t=0);if(!e.expiry){var r=i(e.authToken);e.expiry=n(r.exp)}return(e.expiry||0)-Date.now()<t}});define("fY",["require","exports","ap","f0","dJ","bA","ba","fZ","fO"],function(e,t,m,s,u,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={".xls":!0,".xlsx":!0},l={".jpg":!0,".jpeg":!0,".png":!0,".gif":!0,".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},c=function(){function e(e,t){void 0===e&&(e={});this._apiUrlHelper=t.apiUrlHelper}e.prototype.getImageUrl=function(e){var t;if(e.isCrossDomain){var r=this._apiUrlHelper.build().webByItemUrl(e);t=(r=(r=r.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:e.serverRelativeItemUrl})).segment("OpenBinaryStream")).toString()}else t=e.fullItemUrl;return t};e.dependencies={apiUrlHelper:n.resourceKey};return e}();t.CrossDomainImageHelper=c;t.crossDomainImageHelperResourceKey=new r.ResourceKey({name:e("module").id+".crossDomainImageHelper",factory:new r.ResolvedResourceFactory(c)});var d=function(){function e(e,t){void 0===e&&(e={});this._itemUrlHelper=t.itemUrlHelper;this._crossDomainImageHelper=t.crossDomainImageHelper}e.prototype.getThumbnail=function(e){var r,i=this,t=e.fileExtension,n=void 0===t?"":t,o=e.itemKey,a=e.baseUrl,s=e.mediaServiceMetadata,u=s&&s.photo,l=s&&s.video;u?r={width:u.width,height:u.height}:l&&(r={width:l.frameWidth,height:l.frameHeight});var c={width:r&&r.width||0,height:r&&r.height||0};if(".gif"===n.toLowerCase()){var d=this._itemUrlHelper.getItemUrlParts(o),p=this._crossDomainImageHelper.getImageUrl(d),f=m.__assign({url:p},c);return m.__assign({},f,{getAligned:function(e,t){return f}})}if(a){var h=s&&s.lenses;h&&h.officeLens&&(a+="&lenses=OfficeLens");return m.__assign({url:this._getUrl({baseUrl:a})},c,{getAligned:function(e,t){return m.__assign({url:i._getUrl({baseUrl:a,desiredSize:e,alignment:t,size:r})},c)}})}};e.prototype.canProvideThumbnail=function(e){if(!e)return!1;"."===(e=e.toLowerCase())[0]&&(e=e.substring(1));return!a[e]&&(!!i.isFeatureEnabled(i.UseThumbnailService)||!!i.isFeatureEnabled(i.ExpandThumbnailSupport)&&(e&&!l[e]))};e.prototype._getUrl=function(e){var t=e.desiredSize,r=void 0===t?{width:1024,height:1024}:t,i=e.alignment,n=e.size,o=void 0===n?{width:"",height:""}:n,a={width:Math.ceil(r.width),height:Math.ceil(r.height),srcWidth:o.width,srcHeight:o.height};i&&(i.name===s.coverCenter.name?a.cropMode="fill":i.name===s.fitWidth.name+"-"+s.top.name&&(a.cropMode="dochead"));return e.baseUrl+"&"+u.serializeQuery(a)};e.dependencies={crossDomainImageHelper:t.crossDomainImageHelperResourceKey,itemUrlHelper:o.resourceKey};return e}();t.default=d;t.resourceKey=r.createResolvedResourceKey(e("module").id,d)});define("fT",["require","exports","ap","bE","aC","eU","fW","bN","by","bA","eS","ba","fV","fU","fY","eT"],function(e,t,r,n,s,l,o,a,u,i,c,d,p,f,h,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(i){r.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e)||this;r._platform=t.platformDetection;r._thumbnailHelper=t.thumbnailHelper;r._itemTaskObserverType=t.itemTaskObserverType;r._cookieState=0;r._haveCookies=new n.default;r._itemsWaitingForCookies=[];r._cookieAuthData={};f.default.registerCookieChecker({isApplicable:function(e){return!(0<e.indexOf("access_token")||e.indexOf(".svc.ms/transform/thumbnail")<0)},check:function(e){var t=new n.default;r._haveCookies.getPromise().done(function(e){return t.complete(e)},function(e){return t.error(e)});return t.getPromise()}});return r}e.prototype.canUseCookies=function(){return!(!this._cookieAuthData.active&&1!==this._cookieState)};e.prototype.trackItem=function(e){this._cookieAuthData.active||this._itemsWaitingForCookies.push(r.__assign({},e))};e.prototype.checkCookies=function(e,t){if(-1!==this._cookieState&&t&&t.supportsCookies){this._cookieAuthData.mostRecent=t;if(1!==this._cookieState)if(this._cookieAuthData.active){if(this._cookieAuthData.active!==t){var r=(new Date).getTime()-this._cookieAuthData.active.timeReceived.getTime();if(432e5<r){this._haveCookies=new n.default;this._cookieAuthData.active=void 0}72e5<r&&this._updateCookies(e,t)}}else this._updateCookies(e,t)}};e.prototype._updateCookies=function(e,t){var r=this,i=0===this._cookieState;this._cookieState=1;this._makeImageRequest(e,t,i).then(function(){r._cookieAuthData.active=t;r._cookieState=2;r._itemsWaitingForCookies.length=0;r._haveCookies.complete(!0)},function(){r._cookieState=-1;r._updateThumbnailUrls(t);r._haveCookies.error(!1)})};e.prototype._makeCorsRequest=function(t,e){var r,i=this;t+="/Auth/SetCookies?provider=spo";var n=d.isFeatureEnabled(d.MediaTAUseVroomV21),o=n?e.authTokenV21:e.authToken,a=n?e.proofTokenV21:e.proofToken;if(this._platform.isIE&&this._platform.browserMajor<=10){t+="&access_token="+o;t+="&prooftoken="+a}else r={spo_access_token:o,spo_prooftoken:a};return this.sendCorsRequest(t,r).then(function(e){if(!e.isOldCookiePresent)return i.sendCorsRequest(t,r).then(function(e){if(!e.isOldCookiePresent)return s.default.wrapError("Cookie request succeeded, but the cookies are not actually being set")})})};e.prototype.sendCorsRequest=function(e,t){return o.default.start({withCredentials:!0,url:e,headers:t,method:"POST"}).then(function(e){var t;try{t=JSON.parse(e.responseText)}catch(e){}return t||s.default.wrapError("Expected response object but received nothing")})};e.prototype._makeImageRequest=function(e,t,r){var i=d.isFeatureEnabled(d.MediaTAUseVroomV21),n=i?t.authTokenV21:t.authToken,o=i?t.proofTokenV21:t.proofToken;e+="/Auth/SetCookiesImg?provider=spo";e+="&access_token="+n;e+="&prooftoken="+o;return p.request(e).then(function(){if(r)return p.request(e+"&throwOnMissingCookies=true")})};e.prototype._updateThumbnailUrls=function(s){var u=this;if(this._itemsWaitingForCookies.length){var e=new this._itemTaskObserverType;e.update(this._itemsWaitingForCookies.map(function(e){var t=e.itemKey,r=d.isFeatureEnabled(d.MediaTAUseVroomV21),i=r?s.authTokenV21:s.authToken,n=r?s.proofTokenV21:s.proofToken,o=e.thumbnailUrl+"&access_token="+i+"&prooftoken="+n,a=u._thumbnailHelper.getThumbnail({baseUrl:o,itemKey:t,fileExtension:e.fileExtension,mediaServiceMetadata:e.mediaServiceMetadata});return new c.default(t).succeed({item:{key:t,thumbnail:l.replace(a)}})}));this._itemsWaitingForCookies.length=0;e.flush()}};e.dependencies=r.__assign({},a.default.dependencies,{thumbnailHelper:h.resourceKey,platformDetection:u.platformDetection,itemTaskObserverType:m.resourceKey});return e}(a.default);t.default=g;t.resourceKey=i.createResolvedResourceKey(e("module").id,g)});define("fU",["require","exports","aC","bE"],function(e,t,u,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[new RegExp("^http(?:s)?://(?:[A-Za-z0-9]*[.])*livefilestore(?:-int)?[.]com/","i"),new RegExp("^http(?:s)?://(?:[A-Za-z0-9-]*[.])*1drv(?:-int)?[.]com/","i")],n=window.$Config&&"UnAuth"!==window.$Config.cid?window.cookieToss:null,l=[],o=function(){function e(e,t,r){this.complete=!n;this.pending=!1;this.eventName="cookieToss";this._lastAttempt=0;this.domainRegex=e;this.iframeSrc=t;this.complete=r}e.authenticate=function(e){for(var t,r=0;r<l.length;r++){var i=l[r];if(i.requiresAuth(e)){t=i.authenticate(e);break}}for(var n=[t||u.default.wrap(!0)],o=0,a=this._cookieCheckers;o<a.length;o++){var s=a[o];s.isApplicable(e)&&n.push(s.check(e))}return u.default.all(n).then(function(e){return e.reduce(function(e,t){return e&&t})})};e.registerCookieChecker=function(e){this._cookieCheckers.push(e)};e.prototype.requiresAuth=function(e){return this.domainRegex.test(e)};e.prototype.authenticate=function(e){var t=(new Date).getTime();if(6e5<t-this._lastAttempt){this._authPromise=null;this._lastAttempt=t}if(!this._authPromise){this._authPromise=new i.default;var r=document.createElement("IFRAME");r.src=this.iframeSrc;r.style.display="none";document.body.appendChild(r)}return this._authPromise.getPromise()};e.prototype.onAuthComplete=function(){this._authPromise.complete(!0)};e._cookieCheckers=[];return e}();t.default=o;if(n)if($Config.aadClientId&&"live.com"===$Config.domain);else{for(var a=n.s,s=n.r,c=0;a&&c<a.length;c++)l.push(new o(r[c],a[c],!s[c]));n.c=function(e){l[e].onAuthComplete()};o.authenticate("https://livefilestore.com/");o.authenticate("https://1drv.com/")}});define("fS",["require","exports","dJ","by","bA","f6","iE"],function(e,t,r,i,n,u,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){void 0===e&&(e={});this._properties={};this._platform=t.platformDetection;this._pageContext=t.pageContext}e.prototype.getCommonAuthData=function(){return this._authData};e.prototype.getCommonProperty=function(e){return this._properties[e]};e.prototype.parseCommonData=function(e){this._properties[".zipUrl"]=u.ZIP_URL;for(var t=0,r=u.COMMON;t<r.length;t++){var i=r[t];e.data[i]&&(this._properties[i]=e.data[i])}this._properties[".mediaBaseUrl"]=this._fixMediaBaseUrl(this._properties[".mediaBaseUrl"]);var n=!this._platform.isSafari;this._authData=this._getCurrentAuthData(e.allowCookies&&n);return{authData:this._authData,mediaUrl:this._properties[".mediaBaseUrl"]}};e.prototype.getUniqueKey=function(){var e=this._properties[".driveUrl"]||this._properties[".driveUrlV21"];return this._pageContext.userEmail&&e?this._pageContext.userEmail+"-"+e:""};e.prototype.generateUrl=function(e,t,r){return this.getNormalUrl(e,t,r)||this.getFallbackUrl(e,t,r)};e.prototype.getNormalUrl=function(e,t,r){var i=this._properties[e];if(i){i=i.replace("{.method}",r);for(var n=/{[^}]*}/,o=n.exec(i);o&&o[0];){var a=o[0].substring(1,o[0].length-1),s=void 0;if(".spItemUrl"===a||".fileType"===a){s=t[a];".zipUrl"!==e||".fileType"!==a||s||(s="zipfile")}else s=this._properties[a];if(!s)return;if(".spItemUrl"===a){if(this._isUrlTooLong(s))return;s=encodeURIComponent(s)}i=i.replace("{"+a+"}",s);o=n.exec(i)}this._pageContext.viewOnlyExperienceEnabled&&(i+="&nocache=true");return i}};e.prototype.getFallbackUrl=function(e,t,r){var i=t[e];if(i){i=i.replace("{.method}",r);for(var n=0,o=u.FALLBACK_PROPERTIES;n<o.length;n++){var a=o[n],s=t[a];".mediaBaseUrl"===a&&(s=this._fixMediaBaseUrl(s));if(!s){if(".correlationId"===a){i=i.replace("&correlationId={.correlationId}","");continue}return}".spResourceUrl"===a&&(s=encodeURIComponent(s));i=i.replace("{"+a+"}",s)}this._pageContext.viewOnlyExperienceEnabled&&(i+="&nocache=true");return i}};e.prototype._fixMediaBaseUrl=function(e){return"https://media.cloudapp.net"===e?"edog"===this._pageContext.env?"https://centralus1-mediad.svc.ms":"https://northcentralus1-medias.svc.ms":e};e.prototype._getCurrentAuthData=function(e){var t=s(this._properties[".driveAccessToken"]),r=s(this._properties[".driveAccessTokenV21"]);if(r&&t){var i=new Date;return{authToken:t.authToken,proofToken:t.proofToken,tokenUrl:this._properties[".driveUrl"],authTokenV21:r.authToken,proofTokenV21:r.proofToken,tokenUrlV21:this._properties[".driveUrlV21"],timeReceived:i,expirationTime:new Date(i.getTime()+216e5),supportsCookies:e}}};e.prototype._isUrlTooLong=function(e){if(this._authData&&this._authData.supportsCookies)return!1;var t=e.indexOf("/",8);return 215<e.substring(t).length};e.dependencies={pageContext:o.pageContext,platformDetection:i.platformDetection};return e}();t.default=a;function s(e){if(e){var t=r.deserializeQuery(e);return t&&t.access_token?{authToken:t.access_token,proofToken:t.prooftoken}:void 0}}t.resourceKey=n.createResolvedResourceKey(e("module").id,a)});define("fP",["require","exports","ap","bN"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getMaxDisplayBubbleCount=function(){return 1};return t}(i.default);t.default=n});define("fN",["require","exports","ap","bN","dZ","eU","eA","eO","fO","eV","dH","iE"],function(e,t,i,r,n,s,o,u,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._urlDataSource=t.resources.consume(n.url);t._itemParentHelper=t.resources.consume(o.resourceKey);t._itemUrlHelper=t.resources.consume(a.resourceKey);t._pageContext=t.resources.consume(d.pageContext);return t}e.prototype.getRecycleBinItem=function(e){var t,r=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"subsite"));if(r&&r.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl){var i=this._urlDataSource.getKeyParams(r.key),n=this._itemUrlHelper.getItemUrlParts(r.key).fullItemUrl+"/_layouts/15/RecycleBin.aspx";t=this._urlDataSource.getKey(((a={}).id=i.id,a.view=c.default.RecycleBin,a));var o=new l.default(t);s.default(o,{key:t,openUrl:n,queryType:c.default.RecycleBin});return o}t=this._urlDataSource.getRootItemKey(c.default.RecycleBin);var a;o=new l.default(t);s.default(o,{key:t,queryType:c.default.RecycleBin,type:u.default.Folder,isRootFolder:!0});return o};return e}(r.default);t.default=p});define("fM",["require","exports","ap","dZ","bN"],function(e,t,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._dataSource=t.resources.consume(n.recycleBin);return t}e.prototype.getRecycleBinItem=function(e){return this._dataSource.getRecycleBinItem(e)};return e}(r.default);t.default=o});define("fG",["require","exports","ap","bN","fH"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){r.__extends(e,t);function e(e){void 0===e&&(e={});return t.call(this,e)||this}e.prototype.getGridHintComponent=function(e,t){return t()?{component:this._getDragAndDropHintComponent(e,t),aspectRatio:2}:null};e.prototype.getFooterHintComponent=function(e,t){return t()&&e()?null:this._getDragAndDropHintComponent(e,t)};e.prototype._getDragAndDropHintComponent=function(e,t){return{name:n.default.tagName,params:{isRobotVisible:t(),isGridView:e()}}};return e}(i.default);t.DragAndDropRobotProvider=o;t.default=o});define("fH",["require","exports","fK","b5","fJ","fI"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"od-drag-and-drop-hint",template:e("fJ"),viewModel:r.default});t.default=n});define("fK",["require","exports","ap","aC","bF","dG","dy","by","cE","ba","c7","iD","fL","bX","d7"],function(o,e,t,i,r,a,s,u,l,c,d,p,f,h,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var g="DragAndDropRobot",n=function(n){t.__extends(e,n);function e(e){var t=n.call(this,e)||this;t._actionMap=t.resources.consume(h.actionMap);t._isItemSetRendered=t.resources.consume(h.isItemSetRendered);t._platformDetection=t.resources.consume(u.platformDetection);t._bundleLoader=t.resources.consume(m.bundleLoader);t._experimentHelper=t.resources.consume(p.experimentHelper.optional);var r=t.resources.consume(l.resourceKey),i=new(t.managed(t._actionMap.UploadAction))({uploadProcessorType:a.UploadProcessorType.Html5file});t._isUploadAvailable=i.isAvailable;t._isFirstRunExperienceVisible=t.resources.consume(h.isFirstRunExperienceVisible);t.isGridView=e.isGridView;t.showDropHint=t.createPureComputed(t._computeShowDropHint);t.dropSuggestionText=t.isRobotVisible?s.strings.DragAndDropHintEmptyRobotText:s.strings.DragAndDropHintText;t.fileImageUrl="undefined"==typeof __webpack_public_path__?o.toUrl("odsp-media/images/odrobot/dragfilegrid.svg"):o("@ms/odsp-media/dist/media/images/odRobot/dragFileGrid.svg");t.isAnimationApplicable=!1;t.isAnimationClassApplicable=t.createObservable(!1);t.isReady=t.createObservable(!1);t.isRobotVisible=e.isRobotVisible;if(t.isRobotVisible){t.createBackgroundComputed(t._computeShowRobotAnimation);t.robotImageUrl=t.createPureComputed(t._computeRobotImageUrl)}else t.isReady(!0);t.createBackgroundComputed(function(){t.showDropHint()&&t.isRobotVisible&&r.logData({name:g+".Show",extraData:{isGridView:t.isGridView}})});return t}e.prototype._computeShowRobotAnimation=function(){var r=this;this._isBundleLoaded=this._bundleLoader.getBundleInfo(1).isLoaded();this.resources.consumeAsync(f.resourceKey).then(function(t){d.loadModuleExport({path:"Eq",getModule:function(){return new i.default(function(e,t){o(["Eq"],e,t)})},getExport:function(e){return e}}).then(function(e){if(r._isBundleLoaded)if(t.getInitialized()||!r.isRobotVisible||r._isFirstRunExperienceVisible()){if(t.getInitialized()&&8249797602===t.getOptimizelyVariationId()()){r.isAnimationApplicable=!0;r.isReady(!0);r._setAnimationTimer()}}else r._experimentHelper.activateExperimentBehindFeature(c.DragAndDropRobotAnimation,e.ANIMATION_EXPERIMENT_ID).then(function(e){if(e){t.setOptimizelyVariationId(e);t.setIsInitialized(!0);t.setExperimentSeen();t.setIntializeTime();if(8249797602===e){r.isAnimationApplicable=!0;r._setAnimationTimer()}}r.isReady(!0)})})})};e.prototype._computeShowDropHint=function(){return this._isUploadAvailable()&&!this._platformDetection.isMobile&&this._isItemSetRendered()&&this.isReady()};e.prototype._setAnimationTimer=function(){var e=this;this.async.setTimeout(function(){e.isAnimationClassApplicable(!0)},500)};e.prototype._computeRobotImageUrl=function(){if(this.isReady()){return"url('"+("undefined"==typeof __webpack_public_path__?o.toUrl("odsp-media/images/odrobot/"+(this.isAnimationApplicable?"robotlistv2.gif":"robotlistv2.svg")):o("@ms/odsp-media/dist/media/images/odRobot/"+(this.isAnimationApplicable?"RobotListV2.gif":"RobotListV2.svg")))+"')"}return""};return e}(r.default);e.default=n});define("fL",["require","exports","aC","bA","c7"],function(r,e,t,i,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new i.ResourceKey({name:r("module").id+".dragAndDropAnimationHelper",loader:new i.AliasResourceLoader(function(){return n.loadModuleExport({path:"Ep",getModule:function(){return new t.default(function(e,t){r(["Ep"],e,t)})},getExport:function(e){return e.resourceKey}})})});e.default=e.resourceKey});define("fJ",[],function(){return"\x3c!--ko if: showDropHint()--\x3e<div class=od-DragAndDropHint data-bind=\"css: { 'od-DragAndDropHint--grid': isGridView, 'ms-slideLeftIn40': isAnimationClassApplicable() && isGridView, 'ms-slideUpIn20': isAnimationClassApplicable() && !isGridView, 'is-animating': isReady() && (isAnimationApplicable && !isAnimationClassApplicable()) }\"><div class=od-DragAndDropHint-box data-bind=\"css: { 'od-DragAndDropHint-box--grid': isGridView, 'od-DragAndDropHint-box--robot': isRobotVisible }\">\x3c!--ko if: isGridView--\x3e<div class=od-DragAndDropHint-fileContainer><img class=od-DragAndDropHint-file data-bind=\"attr: { src: fileImageUrl }\"></div>\x3c!--/ko--\x3e<div class=od-DragAndDropHint-text data-bind=\"text: dropSuggestionText, css: { 'od-DragAndDropHint-text--grid': isGridView }\"></div></div>\x3c!--ko if: isRobotVisible--\x3e<div class=od-DragAndDropHint-robot data-bind=\"style: { 'background-image': robotImageUrl }, css: { 'od-DragAndDropHint-robot--grid': isGridView, 'od-DragAndDropHint-robotAnimation': isReady() && isAnimationApplicable }\"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e"});define("fI",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-DragAndDropHint-box{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";text-align:center;box-sizing:border-box}.od-DragAndDropHint-file{height:80%;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);position:absolute;width:100%}html[dir=ltr] .od-DragAndDropHint-file{left:50%}html[dir=rtl] .od-DragAndDropHint-file{right:50%}.od-DragAndDropHint-fileContainer{width:100%;height:74%;position:relative}.od-DragAndDropHint-robot{height:173px;width:100%;background-repeat:no-repeat;background-position:center center;background-size:auto 100%;margin-top:12px}.od-DragAndDropHint-box--robot{border:2px dashed "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-DragAndDropHint-robot--grid{display:inline-block;margin:0;background-position:-25px;background-size:auto 100%;width:45%;vertical-align:top}.od-DragAndDropHint--grid{height:100%;width:100%;position:relative}.od-DragAndDropHint-box--grid{height:100%;width:54%;display:inline-block;vertical-align:top}.od-DragAndDropHint-text--grid{padding:4px 5px;font-size:15px;overflow:hidden;width:100%;display:inline-block;box-sizing:border-box;text-overflow:ellipsis;height:40%}.od-DragAndDropHint.is-animating{opacity:0}.od-DragAndDropHint-robotAnimation.od-DragAndDropHint-robot--grid{background-size:auto 106%}"}])});define("fF",["require","exports","ap","bO","dZ"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(e,r);function e(e,t){return r.call(this,e,t)||this}e.prototype.initialize=function(){this._dataPromise=null};e.prototype.getCustomActionData=function(){this._dataPromise||(this._dataPromise=this.resources.consumeAsync(n.customAction).then(function(e){return e.getCustomActionData()}));return this._dataPromise};e.prototype.isGroup=function(e){return"children"in e};return e}(r.default);t.default=o});define("fD",["require","exports","ap","bN","c1","c3","eO","fE","aC","eX"],function(e,t,o,r,a,s,u,i,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){o.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.isUserInUploadFRE=t.createObservable(!1);t._visibleItems={};t._isFolder=!1;t._isFileTraversingComplete=t.createObservable(!1);t._itemProvider=t.resources.consume(l.resourceKey);return t}e.prototype.addBubbleToItem=function(e,t,r){this._isFolder=e.type===u.default.Folder;var i=o.__assign({},a.TEACHING_BUBBLE_FIRST_UPLOAD,{bodyCopy:this._getBodyCopy(e,t,r)}),n={campaign:this.createObservable(i),isVisible:this.createObservable(!0)};if(t.key===e.parentKey||this._chosenItemForBubble)if(this._chosenItemForBubble){n.isVisible(!1);n.campaign=void 0;this._visibleItems[e.key]=this.createObservable(n)}else{this._chosenItemForBubble=e.key;this._visibleItems[this._chosenItemForBubble]=this.createObservable(n)}else{this._chosenItemForBubble=e.parentKey;this._visibleItems[this._chosenItemForBubble]&&this._visibleItems[this._chosenItemForBubble](n)}};e.prototype.updateActiveBubble=function(e,t,r){var i=this._visibleItems[this._chosenItemForBubble];i&&i.peek().campaign(o.__assign({},a.TEACHING_BUBBLE_FIRST_UPLOAD,{bodyCopy:this._getBodyCopy(e,t,r)}))};e.prototype.checkIfTeachingBubbleIsApplicable=function(e,t){var r=this,i=t.content().items;if(0<i.length&&i.length<=3&&!this._isFileTraversingComplete.peek()){this._isFileTraversingComplete(!0);this._traverseItemChildren(e).done(function(e){r.isUserInUploadFRE(e)})}};e.prototype.getTeachingBubbleForKey=function(e){return this._visibleItems[e]||(this._visibleItems[e]=this.createObservable({isVisible:!1}))};e.prototype._getBodyCopy=function(e,t,r){var i;if(this._isFolder)i=s.strings.freUploadConfirmationBodyFolder;else if(t.key!==e.parentKey)i=1<r?s.strings.freUploadConfirmationBodyMultipleFolderPlural:s.strings.freUploadConfirmationBodyFileFolder;else{var n=this._fileExtensionExists(e);i=1<r?n?s.strings.freUploadConfirmationMultipleFilesOpen:s.strings.freUploadConfirmationMultipleFiles:n?s.strings.freUploadConfirmationBodyOpen:s.strings.freUploadConfirmationBody}return i};e.prototype._traverseItemChildren=function(e){var t,r={parentKey:e};return!(t=this._itemProvider.getItemSync(r))||t.isPlaceholder||t.isExpired?this.trackPromise(this._itemProvider.getItem(r).then(function(e){return e.content.peek().items.length<=4})):n.default.wrap(t.content.peek().items.length<=4)};e.prototype._fileExtensionExists=function(e){return-1<i.TeachingBubbleFileExtensions.indexOf((e.extension||"").toLowerCase())};return e}(r.default);t.default=c});define("fE",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TeachingBubbleFileExtensions=["doc","docx","odp","odt","pot","potm","potx","pps","ppsx","ppt","pptm","pptx","xls","xlsb","xlsm","xlsx","ods","arw","bmp","cr2","eps","erf","gif","jpg","mrw","nef","orf","pict","png","psd","jpeg"]});define("eX",["require","exports","ap","bN","dR","eV","iJ","aC","bX","dZ","iF","dY","dW","cg","eQ","e0","eZ","aL","bA","eS","bE","eW","eY","ba","bQ"],function(e,t,D,r,n,p,o,k,a,s,u,c,d,l,f,U,R,F,i,h,A,m,O,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(i){D.__extends(E,i);function E(e,t){var r=i.call(this,e,t)||this;r._registeredProjections={};r._pendingGetItemRequests={};r._store=t.itemsStore;r._operationProvider=t.operationProvider;r._itemDataSource=t.itemDataSource;r._getItemDataSource=t.getItemDataSource;r._schemaDataSource=t.schemaDataSource;r._updateQuota=t.updateQuota;L.isFeatureEnabled(L.GroupThrottleSupport)&&(r._groupThrottle=t.groupThrottle);r._smartFiltersStore=t.smartFiltersStore;return r}E.prototype.getItem=function(e){return this._getItem(e)};E.prototype.getItemSetKey=function(e,t){var r="";r+="parentKey="+e.parentKey;function i(e,t){t&&(r+="&"+e+"="+t)}i("ownerId",e.ownerId);i("groupingType",e.groupingType);r+="&sortField="+(e.sortField||"");r+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var n=e.filters;if(n)for(var o in n)r+="&"+o+"="+n[o];i("groupBy",e.groupBy);i("viewId",e.baseViewId);i("viewXml",e.viewXml);i("additionalFiltersXml",e.additionalFiltersXml);var a=!t&&e.itemSetProjections;if(a){var s="";for(var u in a)s+=u+"_"+a[u];r+="&projection="+s}e.supportsNestedGroups&&(r+="&ng=1");return r};E.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._itemDataSource.getSpecifiedItems(e)};E.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),r=e.parentKey,i=this._store.getItem(r),n=this._getItemSet(t,e);if(!i){var o=new p.default(r);o.queryType=e.queryType;this._store.setItem(o);i=this._store.getItem(r)}if(!n){var a=i.peek(),s=a&&a.folder,u=s&&s.childCount||0;(n=new U.default(t,e,u)).item=i;var l=e.needSchema;if(void 0===l||l){var c=this._schemaDataSource,d=c&&c.getColumns(a);d&&0<d.length&&n.schema(d)}this._store.setItemSet(t,n)}return n};E.prototype.invalidateItem=function(e,t){var r=void 0===t?{}:t,i=r.triggerFetch,n=void 0!==i&&i,o=r.emptyAllOtherSets,a=void 0!==o&&o,s=r.refreshSchema,u=void 0!==s&&s,l=r.updateGrouping,c=void 0!==l&&l;a&&this._store.emptyAllOtherSets([e]);if(u){(d=this._store.getItemSetFromItemKey(e))&&d.schema([])}c||this._store.invalidateItem(e);this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);if(n){var d=this._store.getItemSetFromItemKey(e);this._getItem(D.__assign({parentKey:e},d&&d.context||{},{skipCache:!0,updateGrouping:c}))}};E.prototype.removeFromRecent=function(t){var r=this;return this._itemDataSource.removeFromRecent(t).then(function(e){e&&r.invalidateItem(t.parentKey);return e})};E.prototype.removeMountPoint=function(t){var r=this;return this._itemDataSource.removeMountPoint(t).then(function(e){e&&r.invalidateItem(t.parentKey);return e})};E.prototype.createMountPoint=function(e){return this._itemDataSource.createMountPoint(e).then(function(e){return e},function(e){return k.default.wrapError(e)})};E.prototype.createDocument=function(t,e,r,i){var n=this;return this._itemDataSource.createDocument(t,e,r,i).then(function(e){n.invalidateItem(t);n._updateQuota(!0);return e})};E.prototype.createCustomDocument=function(e,t,r){var i=this;return this._itemDataSource.createCustomDocument(e,t,r).then(function(t){if(!t)return k.default.wrapError();i.invalidateItem(e);i._updateQuota(!0);return i.getItem({parentKey:e}).then(function(e){return i.peekUnwrapObservable(i._store.getItem(t))})})};E.prototype.updateBundle=function(r,i){var n=this,o=[new h.default(r.item.key,r.item)];i.update(o);return this._itemDataSource.updateBundle(r).then(function(){n.invalidateItem(r.item.parent?r.item.parent.key:r.item.key);o=o.map(function(e){return e.succeed()});i.update(o)},function(e){n.invalidateItem(r.item.parent?r.item.parent.key:r.item.key);var t=new Error(e);o=o.map(function(e){return e.fail(t)});i.update(o);return k.default.wrapError(t)})};E.prototype.removeFromSharedList=function(t){var r=this;return this._itemDataSource.removeFromSharedList(t).then(function(e){r.invalidateItem(t.parentKey);return e})};E.prototype.updateViewCount=function(e){return this._itemDataSource.updateViewCount(e)};E.prototype.reportAbuse=function(e){var t=new d.default,r=this._operationProvider.register({name:e.item.name,type:l.default.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),i=this._itemDataSource.reportAbuse(e);r.state(c.default.started);r.progress.maximum(1);return i.then(function(e){r.state(c.default.completed);r.progress.current(1);return e},function(e){r.state(c.default.failed);r.error(new f.default({message:e}));return k.default.wrapError(e)})};E.prototype.requestReview=function(n){for(var o=this,r=new d.default,a=n.items.map(function(e){var t=o._operationProvider.register({name:e.name,type:l.default.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:r});t.progress.maximum(1);t.progress.current(0);return t}),e=this._itemDataSource.requestReview(n),t=0,i=a;t<i.length;t++){i[t].state(c.default.started)}return e.then(function(e){for(var t=0,r=a;t<r.length;t++){var i=r[t];i.progress.current(1);i.state(c.default.completed)}o.invalidateItem(n.items[0].parent.key);return e},function(e){for(var t=0,r=a;t<r.length;t++){var i=r[t];i.error(new f.default({message:e}));i.state(c.default.failed)}return k.default.wrapError(e)})};E.prototype.saveSortOrder=function(e){return this._itemDataSource.saveSortOrder(e).then(function(e){return e},function(e){})};E.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,l.default.addCoverPhotos,this._addCoverPhotos)};E.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,l.default.removeCoverPhotos,this._removeCoverPhotos)};E.prototype.changeFolderType=function(t){var r=this;return this._itemDataSource.changeFolderType(t).then(function(e){r.invalidateItem(t.item.key,{triggerFetch:!0});return e})};E.prototype.updateItemProperty=function(t){var r=this;return this._itemDataSource.updateItemProperty(t).then(function(e){r.invalidateItem(t.item.key,{triggerFetch:!0});return e})};E.prototype.getOpenInClientDetails=function(e){return this._itemDataSource.getOpenInClientDetails(e).then(function(e){return e},function(e){})};E.prototype.getWorkProgress=function(e){return this._itemDataSource.getWorkProgress(e)};E.prototype.processReferral=function(e,t){return this._itemDataSource.processReferral(e,t)};E.prototype.getItemOcrTextContent=function(e){return this._itemDataSource.getItemOcrTextContent(e)};E.prototype.updateItemOcrInfo=function(t,e,r){var i=this;return this._itemDataSource.updateItemOcrInfo(t,e,r).then(function(e){i.invalidateItem(t.key,{triggerFetch:!0});return e},function(e){return e})};E.prototype.rotateItems=function(e,s){var u=this,l={},c=e.items.map(function(e){return l[e.key]=new h.default(e.key,e)});s.update(c);return this._itemDataSource.rotateItems(e).then(function(){c=c.map(function(e){return e.succeed()});s.update(c)},function(e){var t=e.data||[];c=[];for(var r=0,i=t;r<i.length;r++){var n=i[r],o=l[n.key];u._store.setItem(o.input);delete l[n.key];c.push(o.fail(n.error))}for(var a in l){o=l[a];delete l[a];c.push(o.succeed())}s.update(c)})};E.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};E.prototype.computeProjectedItemSet=function(e,t,r,i){var n=r.itemSetProjections,o=i?null:this._store.getItemSet(e);if(!o||o.isPlaceholder||o.isExpired||o.version!==t.version){if(!o){(o=new U.default(e,r)).item=t.item;o.isTokenBasedApi=t.isTokenBasedApi;o.isPlaceholder=t.isPlaceholder;o.isExpired=t.isExpired;o.version=t.version}for(var a in n){var s=this._registeredProjections[a];s&&s.projectItemSet(o,t,n[a])}i||this._store.setItemSet(e,o)}return o};E.prototype.redeemPermissionToken=function(e){return this._itemDataSource.redeemPermissionToken(e)};E.prototype._getItem=function(m){var g,y=this,v=F.deepCopy(m),_=this._store;if(m.keyAlias){g=this.getItemSync({parentKey:m.keyAlias}).item;m.parentKey=g.peek().key}else g=this.getItemSync(m).item;var e=m.skipCache,t=void 0!==e&&e,b=this.getItemSetKey(m),r=m.itemSetProjections?this.getItemSetKey(m,!0):b,i=this._getItemSet(b,m),n=i&&i.content.peek().items,S=m.isTokenBasedApi||i&&i.isTokenBasedApi,w=!t&&g&&!g.peek().revision&&i&&!i.isExpired&&!i.isPlaceholder&&(!m.requestAllChildren||R.resultSetHasData(n,{start:0,end:n.length})),o=m.startIndex,a=void 0===o?0:o,s=m.pageSize,u=void 0===s?100:s,l=m.endIndex||a+u;l=n&&0<n.length&&!S?Math.min(n.length,l):l;a=Math.max(0,Math.min(l,a));var c=_.getNextRequestToken(r);m.requestToken="end"===c?"":c;var T=new O.default(m,_,S,E.TOKEN_BASED_API_EXTRA_ITEMS);T.initialize(i,a);var d=!1,p=i&&i.content.peek();if(L.isFeatureEnabled(L.RenderLargeListPartialResult)&&p&&(1===p.partialResultStatus||2===p.partialResultStatus)){d=!0;1===p.partialResultStatus&&i.content({items:p.items,groupings:p.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(w&&!d&&T.isResultSetValid(n,{start:a,end:l}))return k.default.wrap(i);if(g&&g.peek().isStub){var f=m.startKey;if(f){if(_.getItem(f)){i.content.peek().items=[_.getItem(f)];i.isPlaceholder=!0;i.isExpired=!1;var h=this._schemaDataSource,C=h&&h.getColumns(g.peek());C&&0<C.length&&i.schema(C);i.content.valueHasMutated()}}return k.default.wrap(i)}var x=i&&!i.isExpired&&i.content.peek().groupings;x&&0<x.length&&(m.isGrouped=!0);this._normalizeContext(m,n,a,l,!w);var I=this._getRequestKey(m),P=this._pendingGetItemRequests[I];if(P)return m.itemSetProjections?P.getPromise().then(function(e){return y.computeProjectedItemSet(b,e,m)}):P.getPromise();S&&!c&&(m.startIndex=0);this._pendingGetItemRequests[I]=P=new A.default;this._getItemDataSource.getItem(D.__assign({},m,{itemSetKey:b})).then(function(e){if(v.updateContextBasedOnResult&&m.updateContextBasedOnResult){v.updateContextBasedOnResult(v,e);m.updateContextBasedOnResult(m,e);b=y.getItemSetKey(v)}var t=m.itemSetProjections?y.getItemSetKey(m,!0):b;g=_.getItem(m.parentKey);var r=_.getItemSet(t);w=!(!g||!r);var i=T.computeNewChildren(e,m,r,t,!!w),n=i.allChildren,o=i.hasNextRequestToken;o&&(S=o);if(e.item&&!m.ignoreChildren){if(!w){(r=new U.default(t,m)).item=_.getItem(m.parentKey);r.isTokenBasedApi=S;_.setItemSet(t,r)}var a=r.isExpired;r.sortField=e.sortField;r.isAscending=e.isAscending;r.isPlaceholder=!1;r.isExpired=!1;var s=m.needSchema;if(void 0===s||s){r.schema(e.schema&&(0<e.schema.length?e.schema:[]));e.customViewRenderer&&(r.customViewRenderer=y.observables.create(e.customViewRenderer))}var u=e.groupings;S&&m.mergeGroupings&&(u=T.computeNewGroupings(r.content.peek().groupings,e.groupings,n,m,a));e.contentTypes&&r.contentTypes(e.contentTypes);var l=r.content.peek(),c=l.partialResultStatus,d=l.partialResultRequestCount,p=u&&u.length&&!!u[0];if(L.isFeatureEnabled(L.RenderLargeListPartialResult)&&!p){if(o&&(e.children&&e.children.length<30||!e.children)){var f=d+1;f<=3?d=f:c=1}else void 0===c||0===c||o?2===c&&e.children&&30===e.children.length&&(c=0):c=3}r.content({items:n,groupings:u,partialResultRequestCount:d,partialResultStatus:c});r.version++}delete y._pendingGetItemRequests[I];if(m.requestAllChildren&&!R.resultSetHasData(n,{start:0,end:e.totalChildren})){var h=F.deepCopy(m);h.startIndex+=100;return y._getItem(h)}if(e.isFromBrowserCache){v.skipCache=!0;return y._getItem(v)}m.itemSetProjections&&(r=y.computeProjectedItemSet(b,r,m));return r},function(e){delete y._pendingGetItemRequests[I];return k.default.wrapError(e)}).then(function(e){P.complete(e)},function(e){y._groupThrottle&&!y._groupThrottle()&&e&&e.errorCode===Number(-2147024860)?y._groupThrottle(!0):P.error(e)});return P.getPromise()};E.prototype._normalizeContext=function(e,t,r,i,n){var o=e.pageSize||100;if(!e.avoidSeamSnapping){if(!n&&!(r-r%o==i-i%o)&&t)for(;r<i&&t[r];)r++;e.startIndex=r-r%o}"number"!=typeof e.pageSize&&(e.pageSize=100);for(;i-e.startIndex>e.pageSize;)e.pageSize+=100};E.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};E.prototype._getItemSet=function(e,t){var r=this._store,i=r.getItemSet(e);if(t.itemSetProjections){var n=this.getItemSetKey(t,!0),o=r.getItemSet(n);o&&(i=this.computeProjectedItemSet(e,o,t))}return i};E.prototype._updateCoverPhotos=function(e,r,t){for(var n=this,i=new d.default,o=e.target,a=e.items.map(function(e){var t=n._operationProvider.register({name:e.name,type:r,payloads:{coverPhotos:{parent:o,item:e}},iconName:e.iconName,batch:i});t.progress.maximum(1);t.progress.current(0);return t}),s=t.call(this,e),u=0,l=a;u<l.length;u++){l[u].state(c.default.started)}return s.then(function(e){n.invalidateItem(o.key);for(var t=0,r=a;t<r.length;t++){var i=r[t];i.progress.current(1);i.state(c.default.completed)}return e},function(){for(var e=0,t=a;e<t.length;e++){t[e].state(c.default.failed)}})};E.prototype._addCoverPhotos=function(e){return this._itemDataSource.addCoverPhotos(e)};E.prototype._removeCoverPhotos=function(e){return this._itemDataSource.removeCoverPhotos(e)};E.dependencies={groupThrottle:a.groupThrottle.optional,itemDataSource:s.items,getItemDataSource:s.getItem,schemaDataSource:s.schema.optional,itemsStore:o.resourceKey,operationProvider:n.resourceKey,smartFiltersStore:u.smartFiltersStore.optional,updateQuota:m.resourceKey};E.TOKEN_BASED_API_EXTRA_ITEMS=L.isFeatureEnabled(L.RenderLargeListPartialResult)?2:5;return E}(r.default);t.default=g;t.resourceKey=i.createResolvedResourceKey(e("module").id,g)});define("eQ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){this.errorType=e.errorType||0;this.message=e.message;this.payloads=e.payloads||{}};t.OperationError=r;t.default=r});define("e0",["require","exports","e1","aq","bR"],function(e,t,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,r){this.key=e||"";this.content=n.observable(new i.default(r));this.content.equalityComparer=o.objectStrictEquality;this.schema=n.observableArray([]);this.schema.equalityComparer=o.arrayStrictEquality;this.context=n.utils.extend({},t);this.contentTypes=n.observableArray([]);this.isPlaceholder=!0;this.version=0};t.default=r});define("e1",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0};t.default=r});define("eZ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resultSetHasData=function(e,t){for(var r=t.start,i=Math.min(t.end,e.length),n=r;n<i;n++)if(!e[n])return!1;return!0}});define("eW",["require","exports","bN","bA"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id+".updateQuota",factory:{dependencies:{observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})});define("eY",["require","exports","aq","eZ"],function(e,t,h,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m="__next__",r=function(){function e(e,t,r,i){this._context=e;this._store=t;this._isTokenBaseApi=r;this._tokenBasedExtraItemCount=i}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var r=e&&e.content.peek().groupings,i=r&&r.length&&r[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,i)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==m&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===m;var n=e&&e.content.peek().groupings;this._isAllCollapsedQuery=n&&0<n.length&&n[0].isAllCollapsed&&n[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var r=this._skipDataFetch;r||(r=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&i.resultSetHasData(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return r};e.prototype.computeNewChildren=function(e,t,r,i,n){var o,a=!1;this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken);o=n&&!r.isExpired?r.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&o.length>e.totalChildren&&(o[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,i,e.nextRequestToken);a=!0;r&&(r.isTokenBasedApi=a)}else this._store.setNextRequestToken(t.parentKey,i,"end");if(t.requestToken){t.startIndex=o.length-this._tokenBasedExtraItemCount;e.totalChildren+=o.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,u=e.startIndex+s;e.nextRequestToken&&(u+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(o.length,u))}if(e.item&&0<=e.totalChildren){this._isExpandingGroup||(0<o.length&&0===e.totalChildren?o=[]:o.length=e.totalChildren);var l=void 0;l=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var c=0,d=0;c<o.length;c++)if(l<=c&&d<e.children.length){o[c]=this._store.getItem(e.children[d].key);d++}}return{allChildren:o,hasNextRequestToken:a}};e.prototype.computeNewGroupings=function(e,t,r,i,n){var o=this._isExpandingGroup?i.group:null,a=i.itemsPerGroup,s=e&&0<e.length?e[0].itemGroups:null,u=null;s&&0<s.length&&s[s.length-1].isPlaceholder&&(u=s.pop());var l=this._mergeGroupings(e,t,n,r);if(o&&l){l[0].isAllCollapsed(!1);o.state({isCollapsed:!1})}if(r&&0<r.length&&!r[r.length-1]&&(s=l&&0<l.length?l[0].itemGroups:null)&&0<s.length){var c=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(c.hasMoreData=!0);var d=r[c.startIndex+(-1!==a?Math.min(c.count,a):c.count)-1]&&!(this._context.groupReplace&&c.count<a),p=l[0].isAllCollapsed.peek();if(d||this._isFetchingNextGroup||p){var f=c.startIndex+c.count;u?u.startIndex=f:u={groupingId:m,startIndex:f,count:1,isPlaceholder:!0,state:h.observable({isCollapsed:!1})};r.length<f&&(r.length=f+1);s.push(u)}}return l};e.prototype._mergeGroupings=function(e,t,r,i){var n=e;if(n&&0<n.length){if(t&&0<t.length)for(var o=0;o<t.length;o++){var a=n[o].isAllCollapsed.peek();n[o].itemGroups=r?this._retainItemGroupState(n[o].itemGroups,t[o].itemGroups):this._mergeItemGroups(n[o].itemGroups,t[o].itemGroups,a,null,i)}}else n=t;return n};e.prototype._mergeItemGroups=function(e,t,l,c,d){var p=e;if(e&&0<e.length){if(t&&0<t.length)for(var r=function(a){var s=!1;l&&a.state({isCollapsed:!0});for(var e=function(e){var t=p[e];if(a.groupingId===t.groupingId){if(f._context.noIndexBasedDataFetch||!f._context.isTokenBasedApi){if(f._context.groupReplace){t.count+=a.count;t.hasMoreData&&e<p.length-1&&(t.hasMoreData=!1)}else t.count=a.count;t.children=f._mergeItemGroups(t.children,a.children,l,t);if(0===e)t.startIndex=c?c.startIndex:0;else{var r=p[e-1],i=r.startIndex+r.count-t.startIndex;t.startIndex+=i;t.children&&t.children.forEach(function(e){e.startIndex+=i})}}else{var n=a.startIndex+f._context.startIndex,o=a.startIndex+f._context.startIndex+a.count;t.startIndex=Math.min(t.startIndex,n);t.count=Math.max(o,t.startIndex+t.count)-t.startIndex}s=!0;return"break"}},t=0;t<p.length;t++){if("break"===e(t))break}if(!s){var r=p[p.length-1],i=r.startIndex+r.count-a.startIndex;a.startIndex+=i;a.children&&a.children.forEach(function(e){e.startIndex+=i});for(var n=Math.min(a.count,30),o=0,u=a.startIndex;u<a.startIndex+n;u++)d[u]||o++;o&&(a.emptyItemCount=o);p.push(a)}},f=this,i=0,n=t;i<n.length;i++){r(n[i])}}else p=t;return p};e.prototype._retainItemGroupState=function(e,t,r){var i=t;if(t&&0<t.length&&e&&0<e.length){for(var n={},o=0,a=e;o<a.length;o++){var s=a[o];n[s.groupingId]=s}for(var u=0,l=i;u<l.length;u++){var c=l[u],d=n[c.groupingId];if(d){c.state(d.state.peek());c.children=this._retainItemGroupState(d.children,c.children,d)}}}return i};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&0<t.length)for(var r=0;r<t.length;r++){var i=t[r];if(!(i&&i.startIndex<=e))break;var n=i.startIndex+i.count-1;if(i.children){if(e<=n)return this._getGroupStartingOnIndex(e,i.children)}else{if(i.startIndex===e)return i.state.peek().isCollapsed?null:i;if(e<=n){var o=r<t.length-1?t[r+1]:null;if(o&&!o.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e}();t.default=r});define("fz",["require","exports","ap","fB","eq","aC","ej","fA"],function(e,t,i,r,n,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SiteReadOnlyState=a.SiteReadOnlyState;var s=function(t){i.__extends(r,t);function r(e){return t.call(this,e,r._dataSourceName+"("+(e?e.siteId:"")+")")||this}r.prototype.getDataSourceName=function(){return r._dataSourceName};r.prototype.getReadOnlyState=function(){var e=this,t=this.getFullSiteReadOnlyState();return-2===t?this.getDataUtilizingCache({getUrl:function(){return n.getSafeWebServerRelativeUrl(e._pageContext)+"/_api/Site/ReadOnly"},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.ReadOnly},qosName:"SiteReadOnly",method:"GET",noRedirect:!0}):o.default.resolve(-1!==t)};r.prototype.getFullSiteReadOnlyState=function(){return void 0===this._pageContext.readOnlyState?-2:null===this._pageContext.readOnlyState?-1:this._pageContext.readOnlyState};r.prototype.getStatusBarInfo=function(){var e=this;return this.getDataUtilizingCache({getUrl:function(){return n.getSafeWebServerRelativeUrl(e._pageContext)+"/_api/Site?$select=StatusBarLink,StatusBarText"},parseResponse:function(e){var t=JSON.parse(e);if(!t||!t.d)return{StatusBarText:void 0,StatusBarLinkText:void 0,StatusBarLinkTarget:void 0};var r=t.d.StatusBarLink,i=void 0,n=void 0;if(r){var o=r.split("|");i=o[0];var a=1===o.length?o[0]:o[1];if(0===a.lastIndexOf("http",0)){var s=new u.default(a);n=encodeURI(s.toString())}}return{StatusBarText:t.d.StatusBarText,StatusBarLinkText:i,StatusBarLinkTarget:n}},qosName:"SiteStatusBar",method:"GET",noRedirect:!0})};r._dataSourceName="SiteDataSource";return r}(r.default);t.SiteDataSource=s;t.default=s});define("fB",["require","exports","ap","ef","fC"],function(e,t,y,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(n){y.__extends(e,n);function e(e,t,r){void 0===r&&(r={});var i=n.call(this,e)||this;i._requestCache=new o.RequestCache({id:t,cacheTimeoutTime:r.cacheTimeoutTime||void 0,cacheType:r.cacheType},{pageContext:e,cacheIdPrefix:r.cacheIdPrefix||void 0});return i}e.prototype.getDataUtilizingCache=function(e){var t=this,r=e,i=r.getUrl,n=r.getAdditionalPostData,o=r.cacheRequestKey,a=r.useStale,s=void 0!==a&&a,u=r.bypassCache,l=void 0!==u&&u,c=r.onlyCache,d=void 0!==c&&c,p=r.checkForInvalidation,f=void 0!==p&&p,h=r.setInvalidated,m=void 0!==h&&h,g=y.__rest(r,["getUrl","getAdditionalPostData","cacheRequestKey","useStale","bypassCache","onlyCache","checkForInvalidation","setInvalidated"]);(g=y.__assign({url:i&&i(),additionalPostData:n&&n(),method:"POST",needsRequestDigest:!0},g)).url=g.url||i&&i();g.additionalPostData=g.additionalPostData||n&&n();o=o||this.getRequestKey(g.url,g.method,g.additionalPostData);return this._requestCache.getDataUtilizingCache({cacheRequestKey:o,useStale:s,bypassCache:l,onlyCache:d,checkForInvalidation:f,setInvalidated:m,getData:function(){return t.dataRequestor.getData(g)}})};e.prototype.isCachedDataInvalidated=function(e){return this._requestCache.isCachedDataInvalidated(e)};e.prototype.getRequestKey=function(e,t,r){return this._requestCache.getRequestKey(e,t,r)};Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._requestCache.cacheId},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._requestCache.cacheVersionId},enumerable:!0,configurable:!0});e.prototype.flushCache=function(e){this._requestCache.flushCache(e)};return e}(r.default);t.CachedDataSource=i;t.default=i});define("fC",["require","exports","aC","a3","a2"],function(e,t,m,c,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=3e5,p="odsp-ds-",r=function(){function e(e,t){var r=e.id,i=e.cacheType,n=void 0===i?g.default.session:i,o=e.cacheTimeoutTime,a=void 0===o?d:o,s=t.cacheIdPrefix,u=void 0===s?p:s,l=t.pageContext;this._cacheTimeoutTime=a;this._id=r;this._version=l?l.siteClientTag+"_"+l.userDisplayName:"";this._store=new c.default(u,n);this._storeDefaultCacheType=n;this._initCache()}e.prototype.getDataUtilizingCache=function(e){var r=this,i=e.cacheRequestKey,t=e.useStale,n=void 0!==t&&t,o=e.bypassCache,a=void 0!==o&&o,s=e.onlyCache,u=void 0!==s&&s,l=e.checkForInvalidation,c=e.setInvalidated,d=e.getData,p=this._cache,f=p[i];if(u)return f?m.default.resolve(f._value):m.default.resolve(void 0);l=l&&!a&&this._storeDefaultCacheType!==g.default.local;var h=f&&this._isCacheExpired(f,i,l);return a||!f||h&&!n?d().then(function(e){var t=(new Date).valueOf();p[i]={_fetched:t,_value:e};c&&r._store.setValue(i,t-1,g.default.local);r._updateCache();return e}):m.default.resolve(f._value)};e.prototype.getRequestKey=function(e,t,r){var i=[];i.push(e);i.push(t);r&&i.push(r.toString());return i.join(",")};e.prototype.isCachedDataInvalidated=function(e){var t=this._cache[e];return this._isCachedDataInvalidated(t,e)};Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0});e.prototype.flushCache=function(e){delete this._cache[e];this._updateCache()};e.prototype._initCache=function(){if(this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)){this._clearCache();this._store.setValue(this.cacheVersionId,this._version,void 0,!1)}else this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}};e.prototype._updateCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)};e.prototype._clearCache=function(){this._cache={};this._updateCache()};e.prototype._isCacheExpired=function(e,t,r){if(r&&this._isCachedDataInvalidated(e,t))return!0;var i=(new Date).valueOf()-this._cacheTimeoutTime;return e._fetched<=i};e.prototype._isCachedDataInvalidated=function(e,t){var r=Number(this._store.getValue(t,g.default.local));return!!(e&&r&&e._fetched<r)};return e}();t.RequestCache=r;t.default=r});define("fA",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.unknown=-2]="unknown";e[e.notReadOnly=-1]="notReadOnly";e[e.readOnly=0]="readOnly";e[e.siteMoveInProgress=1]="siteMoveInProgress";e[e.siteMoveComplete=2]="siteMoveComplete"}(t.SiteReadOnlyState||(t.SiteReadOnlyState={}))});define("fy",["require","exports","ap","bN","dZ","aC"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._siteDataSource=t.resources.consume(n.site);t.isReadOnly=t.createObservable(!1);t.readOnlyState=t.createObservable(-2);t._requestReadOnlyState();return t}e.prototype._requestReadOnlyState=function(){var t=this;o.default.all({isReadOnly:this._siteDataSource.getReadOnlyState(),readOnlyState:this._siteDataSource.getFullSiteReadOnlyState()}).then(function(e){t.isReadOnly(e.isReadOnly);t.readOnlyState(e.readOnlyState)})};return e}(r.default);t.default=a});var __extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){i(e,t);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();__assign=this&&this.__assign||Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};define("fw",["require","exports","bN","fx","fs","dJ"],function(e,t,r,o,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=window.history,n=window.applicationCache,h=i&&!!i.pushState&&(!n||n.status===n.UNCACHED),a=function(n){__extends(e,n);function e(e){void 0===e&&(e={});var t=n.call(this,e)||this;t._viewParamsString="";t._dontBlockNextNav=!1;var r=e.disableHashConversion,i=void 0!==r&&r;t._performHashConversion=!i;t.viewParams={};t.beforeUnload=new o.default;t.addDisposable(t.beforeUnload);t.events.declare("change");t.events.on(window,"hashchange",t._updateUrlState);t.events.on(window,"popstate",t._updateUrlState);t._updateUrlState(null);return t}e.prototype.navigateTo=function(e){var t=this;if(this.beforeUnload.allowHashNav(function(){return t.navigateTo(e)},null)){var r="string"==typeof e?{url:e}:e,i=r.url,n=e.hasOwnProperty("viewParams")?e.viewParams:null,o=void 0,a=void 0;if(n&&"#"===n[0]){o=n.substr(1);a=i}else{o="#"===i[0]?i.substr(1):null;a=null}if(o)r.ignoreHistory?this._replaceState(o,!1,a):this._pushState(o,a);else{var s=void 0,u=!1;if(r&&r.frameId&&"_self"!==r.frameId)try{s=window.open("",r.frameId);"_blank"===r.frameId&&(s.opener=null);s.location.href=i;u=!0}catch(e){}if(!s&&!u)try{window.location.href=i}catch(e){}}}};e.prototype.updateViewParams=function(e,t){void 0===t&&(t={});var r="string"==typeof e?f.deserializeQuery(e):e,i=__assign({},t.clearOtherParams?{}:this.viewParams,r);t.ignoreHistory?this._replaceState(i,t.clearPath):this._pushState(i)};e.prototype.reload=function(){window.location.reload()};e.prototype._updateUrlState=function(e){var t=this,r=!1,i=window.document.location,n=!1;if(this._dontBlockNextNav||this.beforeUnload.allowHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()})){this._dontBlockNextNav=!1;var o="";if(-1<i.href.indexOf("#")){o=i.hash.substr(1);n=!0}else i.search.length&&(o=i.search.substr(1));var a=this._tryGetViewParamsBasedOnState(e),s=f.deserializeQuery(o),u=f.deserializeQuery(a),l=u,c=a;for(var d in s)if(u[d]!==s[d]){l=s;c=o;break}if(c!==this._viewParamsString){this._viewParamsString=c||"";this.viewParams=l;r=!0}n&&this._performHashConversion&&h&&c&&this._replaceState(c);if(r){p.Nav.logData({url:i.href,viewParams:this.viewParams});this.events.raise("change")}this._prevHash=i.hash}else{r=!1;e&&e.preventDefault()}return r};e.prototype._tryGetViewParamsBasedOnState=function(e){var t=null;if(e&&"popstate"===e.type&&e.state){var r=e.state,i=r.useViewParamsFromState,n=r.viewParams;i&&n&&(t=this._getViewParamsString(n))}return t};e.prototype._resetBeforeNavBlock=function(){this._dontBlockNextNav=!0;if(h)try{history.forward()}catch(e){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)};e.prototype._pushState=function(e,t){var r=this._getViewParamsString(e);if(h)try{history.pushState({},null,this._getStateUrl(r))}catch(e){this._hashNav(r)}else this._hashNav(r);this._updateUrlState(null);t&&this._setMaskUrl(t)};e.prototype._replaceState=function(e,t,r){var i=this._getViewParamsString(e);if(h)try{history.replaceState({},null,this._getStateUrl(i,t))}catch(e){this._hashNav(i)}else this._hashNav(i);this._updateUrlState(null);r&&this._setMaskUrl(r)};e.prototype._setMaskUrl=function(e){if(e&&h){var t={useViewParamsFromState:!0,viewParams:this.viewParams};history.replaceState(t,null,e)}};e.prototype._getViewParamsString=function(e){return"string"==typeof e?e:f.serializeQuery(e)};e.prototype._getStateUrl=function(e,t){return(t?"/":document.location.pathname)+(0<e.length?"?":"")+e};e.prototype._hashNav=function(e){document.location.hash=e};return e}(r.default);t.Navigation=a;t.default=a});define("fs",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Nav=r.createSingleEvent({eventName:"Nav,",shortEventName:"Nav"},{viewParams:4,url:1});t.default=t.Nav});define("ft",["require","exports","ap","bN","aU","fi","fj","dZ","a9","dH","fv","el","en","iE","ey","fk","b9","fu","aL"],function(e,t,i,r,n,o,a,w,T,C,x,s,I,u,l,c,P,d,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SORT_ACTION="Sort";t.FILTER_ACTION="Filter";var h="ModifyProperty",D="ListViewUpdate.Start",p=function(){return P.default.now()},f="SdkLoadEnd",m=function(r){i.__extends(e,r);function e(e){var t=r.call(this)||this;t._listViewLogged=!1;t.logListViewStart=function(e){if((o.ListViewStartRender.isTypeOf(e)||c.Action.isTypeOf(e)&&e.data&&"Open"===e.data.name&&e.data.folder)&&t.rumone){t._reset();t.mark(D);t.rumone.addExpectedControl(t.scenarioPrefix+"ListView")}};t.logListViewEnd=function(e){a.ListViewRendered.isTypeOf(e)&&t.rumone.expectingControl(t.scenarioPrefix+"ListView")&&t.logRUMOneForListView(p())};n.Manager.addLogHandler(t.logListViewStart);n.Manager.addLogHandler(t.logListViewEnd);t.scenarioPrefix=e||"";t.rumone=s.default.getRUMOneLogger();window.fabricPerf=d.FabricPerformance.summary;return t}e.prototype.mark=function(e){this.rumone.mark(e)};e.prototype.isDocumentLibrary=function(){var e=this.resources.consume(u.listContext);return l.isDocumentLibrary(e.listTemplateType)};e.prototype.logPropertiesPaneLaunch=function(){this.logPropertiesPaneActions("Launch")};e.prototype.logPropertiesPaneUpdate=function(){this.logPropertiesPaneActions("Update")};e.prototype.logPropertiesPaneModifyProperty=function(){this.logPropertiesPaneActions(h)};e.prototype.logPropertiesPaneEnd=function(){var e=this;this.async.setTimeout(function(){e.logRUMOneForPropertiesPane(p())},0)};e.prototype.logPowerAppFormLaunch=function(){this.logPowerAppFormActions("Launch")};e.prototype.logPowerAppFormLoadSdkStart=function(){this.logPowerAppFormActions("SdkLoad")};e.prototype.logPowerAppFormLoadSdkEnd=function(){this.logPowerAppFormActions(f)};e.prototype.logPowerAppFormEnd=function(){var e=this;this.async.setTimeout(function(){e.logRUMOneForPowerAppForm(p())},0)};e.prototype.getControlRenderTime=function(t){var e=this.rumone.readControlPerformanceData().filter(function(e){return e.controlId===t})[0];return e&&e.renderTime||NaN};e.prototype.logOnePageNavigationStart=function(){var e=this.rumone;if(e){this._reset();e.mark(P.OnePageNavigationStartMarkerName);e.addExpectedControl(this.scenarioPrefix+"ListView")}};e.prototype.logFilterSort=function(e){var t=this.rumone;if(t){this._reset();t.mark(e+".Start");t.mark(D);var r="SPList"===this.scenarioPrefix?this.isDocumentLibrary()?".DocumentLibrary":".CustomList":"";t.writeScenarioId(this.scenarioPrefix+r+"."+e,!0);t.addExpectedControl(this.scenarioPrefix+"ListView")}};e.prototype.checkRenderTimeRequiredDataAvailable=function(e,t){return!(!e||!t)&&(!!t.startTime&&!!t.endTime)};e.prototype.computeRenderTime=function(e,t){return e&&t?t.endTime-t.startTime:0};e.prototype.logRUMOneForListView=function(e){var t=this.rumone;if(t&&t.isRunning()&&!this._listViewLogged){t.addExpectedControl(this.scenarioPrefix+"ListView");var r=this.resources.consume(w.url),i=T.default[r.getPageType()]+"-"+(C.default[r.getQueryType()]||"Default"),n="SPList"===this.scenarioPrefix?this.isDocumentLibrary()?".DocumentLibrary":".CustomList":"";t.writeScenarioId(this.scenarioPrefix+n+"."+i);var o=this._getPageTransitionTypeForListView();t.writePageTransitionType(o);t.collectW3CPerfTimings();o===I.default.fullPageLoad&&t.collectW3cResourceTimings();var a=window.applicationCache;t.writeAppCache(a&&a.status!==a.UNCACHED);void 0!==window.g_duration&&void 0!==window.g_iisLatency&&t.writeServerSideLatency(window.g_duration,window.g_iisLatency);window._spPageContextInfo&&t.writeServerCorrelationId(window._spPageContextInfo.CorrelationId);var s=void 0,u=t.readTempData("appDataFetchStart"),l=t.readTempData("appDataFetchEnd"),c=l-u,d=Number(t.getPerformanceDataPropertyValue("W3cNavigationStart"));this._CollectBreakDown();var p=function(e){return{data:e,needFlatten:!0}};if(o===I.default.fullPageLoad){t.addExpectedControl({controlId:"SuiteNav",ignoreForEUPL:!0});t.addExpectedControl({controlId:"TopLevelCommandBar",ignoreForEUPL:!0});P.HighResolutionTimingSupported&&(e+=d);s=d;var f=P.default.summary;E.extend(this.breakdown,{w3cResponseEnd:p(P.default.getResponseEnd()-d),appStart:p(f.appStart),dataFetch:p(f.dataFetch),render:p(f.render),prefetchStart:p(f.prefetchStart),deferredListDataRender:p(f.deferredListDataRender),preRender:p(f.preRender),postRender:p(f.postRender)})}else if(o===I.default.none){s=t.getMarkerTime(D);E.extend(this.breakdown,{dataFetch:p(c),render:p(e-s-(c||0)),preRender:p(u-s),postRender:p(e-l)})}else{s=t.getMarkerTime(P.OnePageNavigationStartMarkerName);var h=t.getMarkerTime("OnePage.Prefetch.Start"),m=t.getMarkerTime("OnePage.Prefetch.End"),g=t.getMarkerTime("AppStart"),y=t.getMarkerTime("OnePage.LoadRequireJS.Start"),v=t.getMarkerTime("OnePage.LoadRequireJS.End"),_=t.getMarkerTime("SPOAppBoot.Start"),b=t.getMarkerTime("EUPL.OnePage.requireConfig.Start");y?E.extend(this.breakdown,{appStart:p(g-s),dataFetch:p(m-h),render:p(e-_),requireJSLoad:p(v-y),requireConfigCost:p(g-b)}):E.extend(this.breakdown,{dataFetch:p(c),render:p(e-s-(c||0))})}t.mark("glass");t.writeEUPLBreakdown(JSON.stringify(this.breakdown));var S=new x.default(this.scenarioPrefix+"ListView",s,e,this.computeRenderTime,this.checkRenderTimeRequiredDataAvailable);t.writeControlPerformanceData(S);this._listViewLogged=!0}};e.prototype.logRUMOneForDeferredControl=function(e,t){var r=this._getPageTransitionTypeForListView(),i=Number(this.rumone.getPerformanceDataPropertyValue("W3cNavigationStart"));if(r===I.default.fullPageLoad){var n=new x.default(e,i,t,this.computeRenderTime,this.checkRenderTimeRequiredDataAvailable,!0,!0);this.rumone.isRunning()&&this.rumone.writeControlPerformanceData(n)}};e.prototype._CollectBreakDown=function(){var e=window.__themeState__.perf;this.breakdown||(this.breakdown={loadStyleDuration:{data:e?e.duration:NaN,needFlatten:!0},loadStyleCount:{data:e?e.count:NaN,needFlatten:!0}});window.tabperf=this.breakdown};e.prototype._requireFabricPerformance=function(){var e=window.require;if(e.defined("fu")){var t=e("fu");return t&&t.FabricPerformance}};e.prototype._reset=function(){this.rumone.resetLogger();var e=this._requireFabricPerformance();e&&e.reset();this.breakdown=void 0;this._listViewLogged=!1};e.prototype._getPageTransitionTypeForListView=function(){return this.rumone.getMarkerTime(P.OnePageNavigationStartMarkerName)?I.default.onePageAppNavigation:this.rumone.getMarkerTime(D)?I.default.none:I.default.fullPageLoad};e.prototype.logRUMOneForPropertiesPane=function(e){var t=this.rumone;if(t&&t.isRunning()){t.addExpectedControl(this.scenarioPrefix+"PropertiesPane");t.writePageTransitionType(I.default.none);t.collectW3CPerfTimings();var r=t.readAPICallPerformanceData();if(r&&0<r.length){for(var i=r[0],n=0;n<r.length;n++)if(r[n].url===t.readTempData("mainAPIUrl")){i=r[n];break}if(i){t.writeServerSideLatency(i.duration,0);t.writeServerCorrelationId(i.correlationId)}}var o="PropertiesPane.Start",a=t.getMarkerTime("Launch"+o),s=t.getMarkerTime(h+o),u=t.getMarkerTime("Update"+o),l=t.readTempData("appDataFetchStart"),c=t.readTempData("appDataFetchEnd"),d=c&&l;d&&t.writeDataFetchTime(c-l,!0);if(e){var p=a||s||u;if(p){var f=(d?e-c+l:e)-p;t.writeRenderTime(f,!0);this.reportControlData(p,e,"PropertiesPane")}}}};e.prototype.logPropertiesPaneActions=function(e){var t=this.rumone;if(t){this._reset();t.mark(e+"PropertiesPane.Start");var r="SPList"===this.scenarioPrefix?this.isDocumentLibrary()?".DocumentLibrary":".CustomList":"";t.writeScenarioId(this.scenarioPrefix+r+".PropertiesPane."+e)}};e.prototype.logPowerAppFormActions=function(e){var t=this.rumone;if(t){this._reset();t.mark(e+"PowerAppForm.Start");t.writeScenarioId(this.scenarioPrefix+".PowerAppForm."+e)}};e.prototype.logRUMOneForPowerAppForm=function(e){var t=this.rumone;if(t&&t.isRunning()){t.addExpectedControl(this.scenarioPrefix+"PowerAppForm");t.writePageTransitionType(I.default.none);t.collectW3CPerfTimings();var r="PowerAppForm.Start",i=t.getMarkerTime("Launch"+r),n=t.getMarkerTime("SdkLoad"+r),o=t.getMarkerTime(f+r);t.writeDataFetchTime(o-n,!0);if(e){var a=i;if(a){var s=e-o+n-a;t.writeRenderTime(s,!0);this.reportControlData(a,e,"PowerAppForm")}}}};e.prototype.reportControlData=function(e,t,r){var i=new x.default(this.scenarioPrefix+r,e,t,function(e,t){return t.endTime-t.startTime},function(){return!0});this.rumone.writeControlPerformanceData(i)};return e}(r.default);t.default=m});define("fi",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ListViewStartRender=r.createSingleEvent({eventName:"ListViewStartRender,",shortEventName:"ListViewStartRender",samplingFeature:{ODB:!0,ODC:"ListViewRenderLogging",Fallback:!1}},{});t.default=t.ListViewStartRender});define("fj",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ListViewRendered=r.createSingleEvent({eventName:"ListViewRendered,",shortEventName:"ListViewRendered",samplingFeature:{ODB:!0,ODC:"ListViewRenderLogging",Fallback:!1}},{});t.default=t.ListViewRendered});define("fv",["require","exports","el"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=r.ControlPerformanceData});define("fu",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()},r=function(){function a(){}a.measure=function(e,t){a._timeoutId&&a.setPeriodicReset();var r=s();t();var i=s(),n=a.summary[e]||{totalDuration:0,count:0,all:[]},o=i-r;n.totalDuration+=o;n.count++;n.all.push({duration:o,timeStamp:i});a.summary[e]=n};a.reset=function(){a.summary={};clearTimeout(a._timeoutId);a._timeoutId=NaN};a.setPeriodicReset=function(){a._timeoutId=setTimeout(function(){return a.reset()},18e4)};a.summary={};return a}();t.FabricPerformance=r});define("fh",["require","exports","fs","cc","aI","aV","fr","fn","fm","fl","fk","fj","fi"],function(e,t,r,n,o,a,s,u,l,c,d,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(){}i._getResultTypeSuffix=function(e){return e===o.ResultTypeEnum.Success?".Success":e===o.ResultTypeEnum.Failure?".Failure":e===o.ResultTypeEnum.ExpectedFailure?".ExpectedFailure":""};i._completeUploadEvent=function(e,t){t.extraData||(t.extraData={});void 0!==e.dragAndDrop&&(t.extraData.upload_DragAndDrop=e.dragAndDrop);void 0!==e.extension&&(t.extraData.upload_Extension=e.extension);void 0!==e.groupFolder&&(t.extraData.upload_GroupFolder=e.groupFolder);void 0!==e.size&&(t.extraData.upload_Size=e.size)};i._completeActionEvent=function(e,t){t.extraData||(t.extraData={});void 0!==e.pageType&&(t.extraData.action_PageType=e.pageType);void 0!==e.queryType&&(t.extraData.action_QueryType=e.queryType)};i._completeVideoLoadEvent=function(e,t){t.extraData||(t.extraData={});t.extraData.video_playbackType=e.playbackType;t.extraData.video_fileExtension=e.fileExtension};i._completeVideoSessionEvent=function(e,t){t.extraData||(t.extraData={});t.extraData.video_playbackType=e.playbackType;t.extraData.video_fileExtension=e.fileExtension;t.extraData.video_endReason=e.endReason};i._completeUploadOperationEvent=function(e,t){t.extraData||(t.extraData={});void 0!==e.abortCount&&(t.extraData.uploadOperation_AbortCount=e.abortCount);void 0!==e.count&&(t.extraData.uploadOperation_Count=e.count);void 0!==e.dragAndDrop&&(t.extraData.uploadOperation_DragAndDrop=e.dragAndDrop);void 0!==e.extension&&(t.extraData.uploadOperation_Extension=e.extension);void 0!==e.failCount&&(t.extraData.uploadOperation_FailCount=e.failCount);void 0!==e.size&&(t.extraData.uploadOperation_Size=e.size);void 0!==e.successCount&&(t.extraData.uploadOperation_SuccessCount=e.successCount);void 0!==e.uploadType&&(t.extraData.uploadOperation_UploadType=e.uploadType)};i.prototype.ignoredEventsHandler=function(e){return r.Nav.isTypeOf(e)||n.PLTHttpRequest.isTypeOf(e)||p.ListViewRendered.isTypeOf(e)||f.ListViewStartRender.isTypeOf(e)};i.prototype.qosEventNameHandler=function(e,t){var r=t;l.UploadOperation.isTypeOf(e)?r="Upload":c.Upload.isTypeOf(e)?r="SingleUpload":d.Action.isTypeOf(e)?r="Action."+r:s.VideoLoad.isTypeOf(e)?r="VideoLoad."+r:u.VideoSession.isTypeOf(e)&&(r="VideoSession."+r);if(e.data)if(e.eventType===a.ClonedEventType.Start)r+=".Start";else if(e.eventType===a.ClonedEventType.End){e.data.resultCode&&(r+="."+e.data.resultCode);r+=i._getResultTypeSuffix(e.data.resultType)}else r+=".no_EventType";return r};i.prototype.qosEventExtraDataHandler=function(e,t){l.UploadOperation.isTypeOf(e)?i._completeUploadOperationEvent(e.data,t):c.Upload.isTypeOf(e)?i._completeUploadEvent(e.data,t):d.Action.isTypeOf(e)?i._completeActionEvent(e.data,t):s.VideoLoad.isTypeOf(e)?i._completeVideoLoadEvent(e.data,t):u.VideoSession.isTypeOf(e)&&i._completeVideoSessionEvent(e.data,t)};return i}();t.default=i});define("fr",["require","exports","aK","aI","fq","fp","aJ"],function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VideoPlaybackType=n.VideoPlaybackType;t.VideoErrorType=o.VideoErrorType;t.ResultTypeEnum=a.ResultTypeEnum;t.VideoLoad=r.createPairedEvent({eventName:"VideoLoad,Qos,",shortEventName:"VideoLoad"},{playbackType:{typeRef:n.VideoPlaybackType,type:6},errorType:{typeRef:o.VideoErrorType,type:6},errorMessage:1,sequence:2,instance:2,fileExtension:1,fileDuration:2,fileBitrate:2,width:2,height:2,fourCC:1,audioFormat:1},i.Qos);t.default=t.VideoLoad});define("fq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.none=0]="none";e[e.flashDash=1]="flashDash";e[e.flashMp4=2]="flashMp4";e[e.htmlMp4=3]="htmlMp4";e[e.htmlDashling=4]="htmlDashling";e[e.htmlHls=5]="htmlHls"}(r=t.VideoPlaybackType||(t.VideoPlaybackType={}));t.default=r});define("fp",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.none=0]="none";e[e.unknown=1]="unknown";e[e.unsupportedFormat=2]="unsupportedFormat";e[e.unsupportedBrowser=3]="unsupportedBrowser";e[e.getDownloadUrlFailure=4]="getDownloadUrlFailure";e[e.htmlElementDecode=5]="htmlElementDecode";e[e.htmlElementNetwork=6]="htmlElementNetwork";e[e.htmlElementAborted=7]="htmlElementAborted";e[e.htmlElementSrcNotSupported=8]="htmlElementSrcNotSupported";e[e.htmlElementOther=9]="htmlElementOther";e[e.htmlDashlingMediaSourceInit=10]="htmlDashlingMediaSourceInit";e[e.htmlDashlingManifestDownload=11]="htmlDashlingManifestDownload";e[e.htmlDashlingInitSegmentDownload=12]="htmlDashlingInitSegmentDownload";e[e.htmlDashlingMediaSegmentDownload=13]="htmlDashlingMediaSegmentDownload";e[e.htmlDashlingManifestParse=14]="htmlDashlingManifestParse";e[e.htmlDashlingVideoElementError=15]="htmlDashlingVideoElementError";e[e.htmlDashlingSourceBufferInit=16]="htmlDashlingSourceBufferInit";e[e.htmlDashlingSourceBufferAppendException=17]="htmlDashlingSourceBufferAppendException";e[e.htmlDashlingSourceBufferAppendMissing=18]="htmlDashlingSourceBufferAppendMissing";e[e.htmlDashlingOther=19]="htmlDashlingOther";e[e.htmlOther=20]="htmlOther";e[e.flashLoadTimeout=21]="flashLoadTimeout";e[e.flashOther=22]="flashOther";e[e.throttled=23]="throttled";e[e.unsupportedCodec=24]="unsupportedCodec";e[e.emptyFile=25]="emptyFile"}(r=t.VideoErrorType||(t.VideoErrorType={}));t.default=r});define("fn",["require","exports","aK","aI","fq","fp","fo","aJ"],function(e,t,r,i,n,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VideoPlaybackType=n.VideoPlaybackType;t.VideoErrorType=o.VideoErrorType;t.VideoSessionEndReason=a.VideoSessionEndReason;t.ResultTypeEnum=s.ResultTypeEnum;t.VideoSession=r.createPairedEvent({eventName:"VideoSession,Qos,",shortEventName:"VideoSession"},{playbackType:{typeRef:n.VideoPlaybackType,type:6},errorType:{typeRef:o.VideoErrorType,type:6},errorMessage:1,sequence:2,instance:2,fileExtension:1,fileDuration:2,fileBitrate:2,cameraMake:1,cameraModel:1,quality:2,maxQuality:2,width:2,height:2,fourCC:1,audioFormat:1,endReason:{typeRef:a.VideoSessionEndReason,type:6}},i.Qos);t.default=t.VideoSession});define("fo",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.unknown=0]="unknown";e[e.closed=1]="closed";e[e.paused=2]="paused";e[e.ended=3]="ended";e[e.failed=4]="failed"}(r=t.VideoSessionEndReason||(t.VideoSessionEndReason={}));t.default=r});define("fm",["require","exports","aK","aI","aJ"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultTypeEnum=n.ResultTypeEnum;t.UploadOperation=r.createPairedEvent({eventName:"UploadOperation,Qos,",shortEventName:"UploadOperation"},{dragAndDrop:3,size:2,count:2,failCount:2,abortCount:2,successCount:2,extension:1,uploadType:1,errorType:1},i.Qos);t.default=t.UploadOperation});define("fl",["require","exports","aK","aI","aJ"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultTypeEnum=n.ResultTypeEnum;t.Upload=r.createPairedEvent({eventName:"Upload,Qos,",shortEventName:"Upload"},{dragAndDrop:3,size:2,extension:1,folderUpload:3,groupFolder:3},i.Qos);t.default=t.Upload});define("fb",["require","exports","a3","a2","aU","fc"],function(e,t,n,a,s,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(o){var i=new n.default(u.default.STORE_KEY,a.default.session);o.eventNamePrefix="";o.instance=null;o.handlers=null;0;var r=function(){function e(e,t){var r=this;o.eventNamePrefix=e;o.handlers=t;for(var i=s.Manager.addLogHandler(function(e){r.addEvent(e)}),n=0;n<i.length;n++)this.addEvent(i[n])}e.prototype.addEvent=function(e){e.enabled&&u.default.processAndLogEvent({event:e,logFunc:function(e,t){var r=i.getValue(u.default.STORE_SIZE_KEY);r||(r=0);i.setValue(r.toString(),{name:e,props:t});i.setValue(u.default.STORE_SIZE_KEY,++r)},eventNamePrefix:o.eventNamePrefix,handlers:o.handlers})};return e}();o.addToLoggingManager=function(e,t){if(o.instance)throw new Error("The beaconCache has already been added to the logging manager with event name prefix "+e+".");o.instance=new r(e,t)}}(r||(r={}));t.default=r});define("fc",["require","exports","aI","cd","fg","ff","db","aT","aS","aP","a0","aV","em","fe","fd"],function(e,t,C,x,I,P,E,D,k,U,R,F,A,O,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e.STORE_KEY="SPCacheLogger";e.STORE_SIZE_KEY="Size";var u,f,h,m,g,y="ClientV2Engagement",l="ReliabilityLog",c="UserEngagement",d="ClientV2Reliability",p=/[^a-z0-9\.\_\-\+]+/gi,t=window._spModuleLink,v=t?t.buildNumber:"",_=!1;e.processAndLogEvent=function(e){if(!e.handlers.ignoredEventsHandler||!e.handlers.ignoredEventsHandler(e.event)){if(!_){_=!0;if(null!=(u=window._spPageContextInfo)){f=u.siteId?u.siteId.replace(p,""):"";h=u.webId?u.webId.replace(p,""):"";m=u.listId?u.listId.replace(p,""):"";g=u.groupId?u.groupId.replace(p,""):""}else g=m=h=f=""}var t,r,i=R.Engagement.isTypeOf(e.event)?function(e){var t,r,i=[],n="no_EngagementName",o="",a=f,s=h,u=m,l=g;if(e.data){var c=e.data;a=c.siteId||a;s=c.webId||s;u=c.listId||u;l=c.groupId||l;n=c.name||n;if(c.experiment){var d=c.experiment,p=d.GetExperimentData();i.push({userEngagementData:{EngagementName:(t=p,r=d.IsExperimentOn(),(t.name?t.name:"noExperimentData")+".Experiment"+(r?"Treatment":"Control")),Properties:JSON.stringify(p),Duration:0,LogType:0,ClientTime:e.startTime,Source:y,SiteId:a,WebId:s,ListId:u,GroupId:l}})}o=c.extraData?JSON.stringify(c.extraData):""}i.push({userEngagementData:{EngagementName:n,Properties:o,Duration:0,LogType:0,ClientTime:e.startTime,Source:y,SiteId:a,WebId:s,ListId:u,GroupId:l}});return i}(e.event):C.Qos.isTypeOf(e.event)?function(e,t,r){var i,n={},o="no_QosName",a=e.data?e.data:null;if(a){a.name&&(o=a.name);null!=t&&(o=t(e,o));a.extraData=a.extraData||{};null!=r&&r(e,a);a.extraData.appver=v}i=e.eventType===F.ClonedEventType.End&&e.startTime&&e.endTime?e.endTime-e.startTime:0;n.userEngagementData={EngagementName:o,Properties:a&&a.extraData?JSON.stringify(a.extraData):"",Duration:i,LogType:0,ClientTime:e.eventType===F.ClonedEventType.End?e.endTime:e.startTime,Source:d};return[n]}(e.event,e.handlers.qosEventNameHandler||null,e.handlers.qosEventExtraDataHandler||null):x.PLT.isTypeOf(e.event)?function(e){if(!e.data)return[{userEngagementData:{EngagementName:"PLT.no_EventData",Duration:0,LogType:0,ClientTime:e.startTime,Source:y}}];for(var t=[],r=e.data,i="PLT."+r.name.replace(" ",""),n=JSON.stringify(r).split(","),o=0,a=0;a<n.length;a++){var s=w(n[a]),u=s.split(":");if(w(u[1])!==r.name){o="true"===u[1]?1:"false"===u[1]||"null"===u[1]?0:parseInt(u[1],10);t.push({userEngagementData:{EngagementName:i+"."+u[0],Properties:"appCacheHit"===u[0]?JSON.stringify(e.data):"",Duration:o,LogType:0,ClientTime:e.startTime,Source:y}})}}return t}(e.event):P.UnhandledError.isTypeOf(e.event)?[{userEngagementData:{EngagementName:"UnhandledError",Duration:0,LogType:0,ClientTime:(r=e.event).startTime,Source:y},debugData:{Tag:"UnhandledError",Level:L.default.Normal,Message:r.data?JSON.stringify(r.data):"no_EventData",Misc:"",ClientTime:r.startTime}}]:E.RequireJSError.isTypeOf(e.event)?function(e){var t,r,i={},n="RequireJSError";if(e.data){t={};for(var o in e.data)"message"!==o?t[o]=e.data[o]:r=e.data[o]}i.userEngagementData={EngagementName:n,Duration:0,LogType:0,ClientTime:e.startTime,Source:y};i.debugData={Tag:n,Level:L.default.Normal,Message:r||"no_ErrorMessage",Misc:t?JSON.stringify(t):"no_ErrorData",ClientTime:e.startTime};return[i]}(e.event):D.CaughtError.isTypeOf(e.event)?function(e){var t,r={},i="CaughtError";if(k.QosError.isTypeOf(e))if(e.data){var n=e.data;i=n.name;n.resultCode&&(i+="."+n.resultCode);i+=(t=n.resultType)===C.ResultTypeEnum.Success?".Success":t===C.ResultTypeEnum.Failure?".Failure":t===C.ResultTypeEnum.ExpectedFailure?".ExpectedFailure":""}else i="QosErrorEvent.no_EventData";else r.userEngagementData={EngagementName:i,Duration:0,LogType:0,ClientTime:e.startTime,Source:y};var o=e.data?e.data:null;r.debugData={Tag:i,Level:L.default.Normal,Message:o&&o.message?o.message:"",Misc:o&&o.stack?JSON.stringify(o.stack):"",ClientTime:e.startTime};return[r]}(e.event):U.Verbose.isTypeOf(e.event)?function(e){var t={},r="Verbose";if(e.data){var i=e.data;i.name&&(r=i.name+".Verbose")}else r+=".no_EventData";t.debugData={Tag:r,Level:L.default.Low,Message:i.message,Misc:"",ClientTime:e.startTime};return[t]}(e.event):I.Beacon.isTypeOf(e.event)?function(e){var t,r={};t=e.eventType===F.ClonedEventType.End&&e.startTime&&e.endTime?e.endTime-e.startTime:0;r.userEngagementData={EngagementName:"Beacon",Properties:e.data?JSON.stringify(e.data):"no_EventData",Duration:t,LogType:0,ClientTime:e.eventType===F.ClonedEventType.End?e.endTime:e.startTime,Source:d};return[r]}(e.event):A.RUMOneDataUpload.isTypeOf(e.event)?function(e){if(!e.data)return[{userEngagementData:{EngagementName:"RUMOne.no_EventData",Duration:0,LogType:0,ClientTime:e.startTime,Source:y}}];var t=e.data;return[{rumOneData:{streamName:t.streamName,dictionary:t.dictionary}}]}(e.event):O.PageInit.isTypeOf(e.event)?[{userEngagementData:{EngagementName:"PageInit",Properties:(t=e.event).data?JSON.stringify(t.data):"",Duration:0,LogType:0,ClientTime:t.startTime,Source:y}}]:null;i||(i=[{userEngagementData:{EngagementName:"UnknownEvent",Duration:0,LogType:0,Properties:JSON.stringify({name:e.event.eventName}),ClientTime:e.event.eventType===F.ClonedEventType.End?e.event.endTime:e.event.startTime,Source:y}}]);for(var n=0,o=i.length;n<o;n++){var a=i[n];if(a.debugData){a.debugData.Tag=T(a.debugData.Tag,e.eventNamePrefix).replace(p,"");e.logFunc(l,a.debugData)}if(a.userEngagementData){var s=e.eventNamePrefix;R.Engagement.isTypeOf(e.event)&&"SPList"===s&&(s=S());a.userEngagementData.EngagementName=T(a.userEngagementData.EngagementName,s).replace(p,"");C.Qos.isTypeOf(e.event)&&"SPList"===e.eventNamePrefix&&(e.event.data.extraData.ListBaseTemplate=b());e.logFunc(c,a.userEngagementData)}a.rumOneData&&e.logFunc(a.rumOneData.streamName,a.rumOneData.dictionary)}}};function b(){var e=-1,t=window._spPageContextInfo;null!=t&&(e=t.listBaseTemplate);return e}function S(){var e="";switch(b()){case 100:e="ListNext";break;case 101:e="DocsNext";break;case 102:e="SurveyNext";break;case 103:e="LinksNext";break;case 104:e="AnnouncementsNext";break;case 107:e="TasksNext";break;case 109:e="PicLibNext";break;default:e="SPList"}return e}function w(e){var t=e;return t=(t=(t=t.replace("{","")).replace(/\"/gi,"")).replace("}","")}function T(e,t){return t?t+"."+e:e}}(r||(r={}));t.default=r});define("fd",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.Low=0]="Low";e[e.Normal=1]="Normal"}(r||(r={}));t.default=r});define("e6",["require","exports","ap","cE","aI","aI","bN","dZ","ba","aZ","aC","d7","c7","bE","fa","e9","iD","e7"],function(i,e,t,o,a,s,r,u,l,n,c,d,p,f,h,m,g,y){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var v=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._map={};t.version=3;t._experimentHelper=t.resources.consume(g.experimentHelper.optional);return t}e.prototype.anchorToName=function(e,t){var r=this._map[e];if(r&&null==r.referenceString){r.referenceString=n.default.generate();r.callback=t;r.signal.complete()}else if(r){r.callback(null);r.referenceString=n.default.generate();r.callback=t;r.isAnchored=!1;r.signal&&r.signal.complete()}else{r={referenceString:n.default.generate(),signal:null,callback:t,isAnchored:!1};this._map[e]=r}};e.prototype.getReferenceStrings=function(e,t){this.recursiveGetReferences({},e,0,t)};e.prototype.initializeNewFeatureExperience=function(){var r=this,i=new a.Qos({name:"NewFeatureExperience.Initialize"}),n=this.resources.consume(o.resourceKey);i.setTimeout(5e3,{resultType:s.ResultTypeEnum.Failure,resultCode:"Timeout"});this.resources.consumeAsync(y.resourceKey.optional).then(function(e){e?e.getO365Shell().done(function(e){e.OnHasMember("FlexPane",function(){r.async.setTimeout(function(){var t=new h.default;r.loadNewFeatureData(t);i.end({resultType:s.ResultTypeEnum.Success,extraData:{behavior:"LazyLoad"}});e.FlexPane.OnFlexPaneVisibilityChanged(function(e){if(e){n.logData({name:"NewFeatureExperience.Visible"});t.firstVisit=!1;t.lastSeenVersion=r.version;t.save()}else n.logData({name:"NewFeatureExperience.Hidden"})})},500)})}):i.end({resultType:s.ResultTypeEnum.Failure,resultCode:"SuiteNavProviderNotFound"})})};e.prototype.loadNewFeatureData=function(o){var a=this;this.resources.consume(y.resourceKey).getO365Shell().done(function(n){p.loadModule({path:"St",getModule:function(){return new c.default(function(e,t){i(["St"],e,t)})}}).done(function(t){var r=a.resources.consume(u.settings).mediaBaseUrl,i=a.resources.consume(d.newFeatureExperience);a._experimentHelper.activateExperimentBehindFeature(l.HelpPanelImprovements,m.EXPERIMENT_ID).then(function(e){t.run(n,o,a.version,r,a,i,e)})})})};e.prototype.recursiveGetReferences=function(t,r,i,n){var o=this;if(i>=r.length)n(t);else{var a=r[i];this.getRefernceAsync(a).done(function(e){t[a]=e;o.recursiveGetReferences(t,r,i+1,n)})}};e.prototype.getRefernceAsync=function(e){var t=this,r=this._map[e];if(r&&null!==r.referenceString){if(!r.isAnchored){r.callback(r.referenceString);r.isAnchored=!0}return c.default.wrap(r.referenceString)}r={referenceString:null,signal:new f.default,callback:null,isAnchored:!1};return(this._map[e]=r).signal.getPromise().then(function(){return t.getRefernceAsync(e)})};return e}(r.default);e.default=v});define("fa",["require","exports","ap","a3","a2"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="lastSeenVersion",a=function(t){i.__extends(r,t);function r(){var e=t.call(this,"NewFeatureExperienceUser",n.default.local)||this;if(e.containsUserData()){e.lastSeenVersion=e.getValue(o);e.firstVisit=!1}else{e.lastSeenVersion=-1;e.firstVisit=r.isLocalStorageSupported()}return e}r.isLocalStorageSupported=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}};r.prototype.save=function(){this.setValue(o,this.lastSeenVersion)};r.prototype.containsUserData=function(){return void 0!==this.getValue(o)};return r}(r.default);t.default=a});define("e9",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EXPERIMENT_ID=8180860491});define("e7",["require","exports","aC","e8"],function(r,e,t,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=i.createResolvedAliasResourceKey(r("module").id,"yk",function(){return new t.default(function(e,t){r(["yk"],e,t)})})});define("e8",["require","exports","c7","bA"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e){return e.resourceKey}t.getResourceKeyExport=o;t.createDefaultAliasResourceKey=function(e,t){return new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({require:e,path:t,getExport:o})})})};t.createResolvedAliasResourceKey=function(e,t,r){return new n.ResourceKey({name:e,loader:new n.AliasResourceLoader(function(){return i.loadModuleExport({path:t,getExport:o,getModule:r})})})}});define("e3",["require","exports","ap","e5","bN","e4","ba"],function(r,e,i,n,t,o,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){i.__extends(e,t);function e(){var e=t.call(this)||this;new(e.resources.injected(o.default));return e}e.prototype.getNewUserFeatureSetData=function(){return[{engagementName:"WelcomeToOneDrive",title:n.strings.NewWelcomeNextTitle,description:n.strings.NewWelcomeNextDescription,body:[n.strings.NewWelcomeNextBodyFirstParagraph],imageUrl:"undefined"==typeof __webpack_public_path__?r.toUrl("odsp-media/images/gettingstarted/gettingstarted-welcomeweb.png"):r("@ms/odsp-media/dist/media/images/gettingStarted/gettingStarted-welcomeWeb.png"),imageText:n.strings.NewWelcomeNextDescription},{engagementName:"InfoPane",title:n.strings.NewRightClickTitle,description:n.strings.NewRightClickDescription,body:[n.strings.NewRightClickBodyFirstParagraph],imageUrl:"undefined"==typeof __webpack_public_path__?r.toUrl("odsp-media/images/gettingstarted/gettingstarted-rightclick.gif"):r("@ms/odsp-media/dist/media/images/gettingStarted/gettingStarted-rightClick.gif"),imageText:n.strings.NewRightClickDescription},{engagementName:"GetApps",title:n.strings.GetAppsTitle,description:n.strings.GetAppsDescription,imageUrl:"undefined"==typeof __webpack_public_path__?r.toUrl("odsp-media/images/gettingstarted/gettingstarted-downloadapp.png"):r("@ms/odsp-media/dist/media/images/gettingStarted/gettingStarted-downloadApp.png"),imageText:n.strings.GetAppsDescription,linkUrl:"http://onedrive.live.com/about/download",linkText:n.strings.GetAppsLinkText}]};e.prototype.getFeatureData=function(){return[null,[],[],[{engagementName:"DiscoverView",title:n.strings.DiscoverViewTitle,description:null,body:[n.strings.DiscoverViewBody],linkText:n.strings.LearnMore,linkUrl:"https://go.microsoft.com/fwlink/p/?LinkId=785788",feature:a.DiscoverViewODB},{engagementName:"ImprovedSearch",title:n.strings.ODBSearchTitle,description:null,body:[n.strings.ODBSearchBody1],callout:{calloutDivId:"od-Search-div",calloutTitle:n.strings.ODBSearchCalloutTitle,calloutBody:n.strings.ODBSearchBody2,calloutAnchorAlignment:2,calloutArrowType:1}}]]};e.prototype.getExperimentFeatureData=function(){return[null,[],[],[]]};return e}(t.default);e.default=s});define("e4",["require","exports","ap","bN","cE","dc"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="__GlobalLinkNavigator_navigateTo",s=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this,r=t.resources.consume(o.navigation);window[a]=function(e){r.navigateTo(e)};return t}e.prototype.getNavigationFunction=function(e){this.resources.consume(n.resourceKey).logData({name:"NewFeatureExperience.DirectLinkClicked",isIntentional:!0,extraData:{featureQueryString:e}});return"javascript:"+a+'("'+e+'")'};return e}(i.default);t.default=s});define("e2",["require","exports","ap","bN","dZ"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._dataSource=t.resources.consume(n.newFeatureExperience);return t}e.prototype.getNewUserFeatureSetData=function(){return this._dataSource.getNewUserFeatureSetData()};e.prototype.getFeatureData=function(){return this._dataSource.getFeatureData()};e.prototype.getExperimentFeatureData=function(){return this._dataSource.getExperimentFeatureData()};return e}(r.default);t.default=o});define("eK",["require","exports","ap","aC","bA","bN","eX","eW","dZ","eT","dY","dW","cg","cE","dR","eS","eL"],function(e,t,r,u,i,n,o,a,s,l,c,d,p,f,h,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r._itemDataSource=t.itemDataSource;r._itemProvider=t.itemProvider;r._itemTaskObserver=r.scope.attach(new t.itemTaskObserverType);r._moveCopyHelper=new(r.managed(g.default))({moveCopyProvider:r});r._operationProvider=t.operationProvider;r._updateQuota=t.updateQuota;r._engagement=t.engagement;return r}e.prototype.copyItemsAsync=function(e){return this._handleMoveCopyItemsAsync(e)};e.prototype.moveItemsAsync=function(e){return this._handleMoveCopyItemsAsync(e)};e.prototype.copyItems=function(e){return this._handleMoveCopyItems(e)};e.prototype.moveItems=function(l){var c=this;return this._handleMoveCopyItems(l).then(function(e){for(var t=[],r={},i=0,n=e.items;i<n.length;i++){(s=n[i]).error||(r[s.id]=!0)}for(var o=0,a=l.items;o<a.length;o++){var s;r[(s=a[o]).id]&&t.push(new m.default(s.key).succeed({item:{key:s.key,parentKey:l.targetKey}}))}if(t.length){var u=c._itemTaskObserver;u.update(t);u.flush()}return e})};e.prototype.moveCopyOperationSuccess=function(e,t,r){for(var i=0,n=t.length;i<n;i++){var o=t[i],a=e.items[i],s=a&&a.error;if(s)this._moveCopyHelper.handleMoveCopyError(s,o);else{if(!e.items)throw new Error("No items returned from MoveCopy API");o.progress.current(1);o.state(c.default.completed)}}this._itemProvider.invalidateItem(r.parentKey);this._itemProvider.invalidateItem(r.targetKey);r.isMove||this._updateQuota(!0);return e};e.prototype._getContext=function(e){return{parentKey:e.targetKey,ignoreListContext:!0,webId:e.webId,siteId:e.siteId}};e.prototype._handleMoveCopyItemsAsync=function(n){var o=this;return this._itemProvider.getItem(this._getContext(n)).then(function(e){var t=new d.default,r=e.item,i=n.items.map(function(e){return o._moveCopyHelper.registerOperation(e,n,r.peek(),null,t)});return o._moveCopyHelper.handleMoveCopyAsyncItems(n,i)})};e.prototype._handleMoveCopyItems=function(o){var a=this,s=this.observables;return this._itemProvider.getItem(this._getContext(o)).then(function(e){var i=new d.default,n=e.item,t=o.items.map(function(e){var t,r={items:[e],parentKey:o.parentKey,targetId:o.targetId,targetKey:o.targetKey,cid:o.cid,group:o.group,isMove:o.isMove,nameConflict:o.nameConflict,taskId:o.taskId,deleteSource:o.deleteSource,isAsync:o.isAsync,overrideLock:o.overrideLock};return t=a._operationProvider.register({name:e.name,type:o.isMove?p.default.moveItems:p.default.copyItems,iconName:e.iconName,payloads:{moveItems:{item:e,destination:n.peek(),source:e.parent},copyItems:{item:e,destination:n.peek(),source:e.parent}},batch:i,actions:{rename:{isAvailable:s.create(!1),execute:function(){a._engagement.logData({name:"MoveCopyItems.Rename.Click"});r.nameConflict=2;t.actions().rename.isAvailable(!1);t.actions().overwrite.isAvailable(!1);t.state(c.default.started);return r.isAsync?a._moveCopyHelper.handleMoveCopyAsyncItems(r,[t]):a._moveCopyItems(r,[t])}},overwrite:{isAvailable:s.create(!1),execute:function(){a._engagement.logData({name:"MoveCopyItems.Overwrite.Click"});r.nameConflict=1;t.actions().rename.isAvailable(!1);t.actions().overwrite.isAvailable(!1);t.state(c.default.started);return r.isAsync?a._moveCopyHelper.handleMoveCopyAsyncItems(r,[t]):a._moveCopyItems(r,[t])}},cancel:{isAvailable:s.create(!1),execute:function(){t.actions().rename.isAvailable(!1);t.actions().overwrite.isAvailable(!1);t.state(c.default.canceled);return u.default.wrap(null)}},moveAnyway:{isAvailable:s.create(!1),execute:function(){r.deleteSource=!0;r.isMove=!1;r.isAsync=!0;t.actions().moveAnyway.isAvailable(!1);t.actions().rename.isAvailable(!1);t.actions().overwrite.isAvailable(!1);t.state(c.default.started);return a._moveCopyHelper.handleMoveCopyAsyncItems(r,[t])}},moveLockedFile:{isAvailable:s.create(!1),execute:function(){r.overrideLock=!0;t.actions().moveLockedFile.isAvailable(!1);return a.moveItems(r)}}},progress:{minimum:0,maximum:1,current:0}})});a._moveCopyHelper.markAllOperationsAsStarted(t);return a._moveCopyItems(o,t)})};e.prototype._executeMoveCopy=function(e){var t=this._itemDataSource;return e.isMove?t.moveItems(e):t.copyItems(e)};e.prototype._moveCopyItems=function(t,r){var i=this;return this._executeMoveCopy(t).then(function(e){return i.moveCopyOperationSuccess(e,r,t)},function(e){return u.default.wrapError(i._moveCopyHelper.moveCopyOperationFailure(e,r,t))})};e.dependencies=r.__assign({},n.default.dependencies,{itemDataSource:s.items,itemProvider:o.resourceKey,itemTaskObserverType:l.resourceKey,operationProvider:h.resourceKey,updateQuota:a.resourceKey,engagement:f.resourceKey});return e}(n.default);t.default=y;t.resourceKey=new i.ResourceKey({name:e("module").id})});define("eL",["require","exports","ap","cg","dY","dW","eR","aC","dR","eX","cE","eK","eQ","dm","eP","eO","eN","eM","bN","d7","dZ","eW"],function(r,e,t,c,g,d,p,i,o,a,s,u,l,f,h,y,v,_,n,b,S,w){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var T=8,C="InsufficientSpaceAvailable",m=function(n){t.__extends(m,n);function m(e){void 0===e&&(e={});var t=n.call(this,e)||this,r=t.resources;t._itemDataSource=r.consume(S.items);var i=t._moveCopyDataSource=r.consume(S.copy.optional);t._itemProvider=r.consume(a.resourceKey);t._moveCopyProvider=e.moveCopyProvider||r.consume(u.resourceKey);t._operationProvider=r.consume(o.resourceKey);t._bundleLoader=t.resources.consume(b.bundleLoader);t._updateQuota=r.consume(w.resourceKey);t._engagement=t.resources.consume(s.resourceKey);t._pollsForProgressSinceCancel={};t._cancelPromises={};t._cachePromises={};i&&i.getCapabilities().supportsProgressCaching&&t._resumePendingProgress();return t}m.prototype.registerOperation=function(e,t,r,i,n){var o=this;n||(n=new d.default);var a={items:[e],parentKey:t.parentKey,targetId:t.targetId,targetKey:t.targetKey,cid:t.cid,group:t.group,isMove:t.isMove,nameConflict:t.nameConflict,taskId:t.taskId,deleteSource:t.deleteSource,isAsync:t.isAsync},s=this._getKey(t),u=this.observables,l=this._operationProvider.register({name:e.name,type:t.isMove?c.default.moveItems:c.default.copyItems,iconName:e.iconName,payloads:{moveItems:{item:e,destination:r,source:e.parent},copyItems:{item:e,destination:r,source:e.parent,taskId:i}},batch:n,actions:{rename:{isAvailable:u.create(!1),execute:function(){a.nameConflict=2;l.actions().rename.isAvailable(!1);l.actions().overwrite.isAvailable(!1);l.actions().cancel.isAvailable(!0);l.state(g.default.started);return o.handleMoveCopyAsyncItems(a,[l],i)}},overwrite:{isAvailable:u.create(!1),execute:function(){a.nameConflict=1;l.actions().rename.isAvailable(!1);l.actions().overwrite.isAvailable(!1);l.actions().cancel.isAvailable(!0);l.state(g.default.started);return o.handleMoveCopyAsyncItems(a,[l],i)}},cancel:{isAvailable:u.create(!0),execute:function(){l.actions().rename.isAvailable(!1);l.actions().overwrite.isAvailable(!1);var e=o._getKey(a),t=o._cachePromises[e]||o._cachePromises[s];return t?t.then(function(e){return o.cancelAsyncOperation(a,l,e.id)}):o.cancelAsyncOperation(a,l,i)}},moveAnyway:{isAvailable:u.create(!1),execute:function(){a.deleteSource=!0;a.isMove=!1;a.isAsync=!0;l.actions().moveAnyway.isAvailable(!1);l.actions().rename.isAvailable(!1);l.actions().overwrite.isAvailable(!1);l.actions().cancel.isAvailable(!0);l.state(g.default.started);return o.handleMoveCopyAsyncItems(a,[l],i)}},moveLockedFile:{isAvailable:u.create(!1),execute:function(){a.overrideLock=!0;l.actions().moveLockedFile.isAvailable(!1);return o._moveCopyProvider.moveItems(a)}},moveAnywaySchemaMismatch:{isAvailable:u.create(!1),execute:function(){o._engagement.logData({name:"MoveItemsAsync.MoveAnyway.Click"});a.allowSchemaMismatch=!0;l.actions().moveAnywaySchemaMismatch.isAvailable(!1);l.actions().cancel.isAvailable(!0);l.state(g.default.started);return o.handleMoveCopyAsyncItems(a,[l],i)}},moveAnywayVersionLimit:{isAvailable:u.create(!1),execute:function(){o._engagement.logData({name:"MoveItemsAsync.MoveAnywayVersionLimit.Click"});a.allowSmallerVersionLimit=!0;l.actions().moveAnywayVersionLimit.isAvailable(!1);l.actions().cancel.isAvailable(!1);l.state(g.default.started);return o.handleMoveCopyAsyncItems(a,[l],i)}}},progress:{minimum:0,maximum:1,current:0}});l.state(g.default.started);return l};m.prototype.moveCopyOperationFailure=function(e,t,r){if(t)for(var i=0,n=t;i<n.length;i++){var o=n[i];this.handleMoveCopyError(e,o)}return e};m.prototype.handleMoveCopyAsyncItems=function(e,t,r){var a=this;this.markAllOperationsAsStarted(t);return function(r,i,e){if(e){var t={id:e,progress:null,pageStats:null,targetId:null};r.taskId||(r.taskId=e);return a.pollForProgress(t,r,i)}m._activeAsyncTasks[a._getKey(r)]=null;var n,o=a._getKey(r);a._cachePromises[o]=(n=r,a._moveCopyDataSource.copyItemsAsync(n));return a._cachePromises[o].then(function(e){var t=r.items.map(function(e){return e.key});a._progressCache&&a._progressCache.saveJobState(e,t,r.targetKey,r.isMove);r.taskId=e.id;a.pollForProgress(e,r,i);return e},function(e){return a.moveCopyOperationFailure(e,i,r)})}(e,t,r)};m.prototype.pollForProgress=function(e,r,i,n,t){var o=this;if(!e)return null;var a={workItemIds:[e.id],jobInfo:e.jobInfo,type:p.IGetWorkProgressTypes.itemCopy,items:r.items,lastProcessedTime:t};this._progressCache&&(a.progressCache=this._progressCache);var s=function(t){o._itemDataSource.getWorkProgress(t).then(function(e){n&&n(i,e);o._handleGetWorkProgressSuccess(e,i,r,t,s)})};if(i)for(var u=0;u<i.length;u++){var l=i[u];!l.payloads.peek().copyItems.taskId&&e&&e.progress&&(e.progress[u]?l.payloads.peek().copyItems.taskId=e.progress[u]&&e.progress[u].id:l.payloads.peek().copyItems.taskId=e.progress[0]&&e.progress[0].id)}if(e.progress){n&&n(i,e);this._handleGetWorkProgressSuccess(e,i,r,a,s)}else{var c=this.async.setTimeout(function(){s(a)},2e3);m._activeAsyncTasks[this._getKey(r)]=c}};m.prototype.handleMoveCopyError=function(e,t){var r=e.code;t.actions().cancel.isAvailable(!1);t.payloads.peek().copyItems.taskId="";if(1e3===r){t.actions().rename.isAvailable(!0);var i=!0,n=t.payloads.peek();(n.moveItems&&n.moveItems.item||n.copyItems&&n.copyItems.item).type===y.default.Folder&&(i=!1);t.actions().overwrite.isAvailable(i);t.error(new l.default({message:i?h.strings.conflictUploadErrorText:h.strings.conflictUploadFolderWithRenameErrorText}))}else if(-2130575257===r)if(t.payloads().moveItems.item.parentKey===t.payloads().moveItems.destination.key)t.error(new l.default({message:h.strings.sameLocationMoveCopyErrorText}));else{this._engagement.logData({name:"MoveCopyItems.NameConflictError"});if(t.payloads().moveItems.item.type===y.default.Folder){t.actions().rename.isAvailable(!0);t.error(new l.default({message:h.strings.conflictUploadFolderWithRenameErrorText}))}else{t.actions().overwrite.isAvailable(!0);t.actions().rename.isAvailable(!0);t.error(new l.default({message:h.strings.conflictUploadErrorText}))}}else if(-2147213282===r){this._engagement.logData({name:"MoveItemsAsync.SchemaMismatchError"});t.actions().moveAnywaySchemaMismatch.isAvailable(!0);t.error(new l.default({message:h.strings.moveFileFolderSchemaMismatch}))}else if(-2147213278===r){this._engagement.logData({name:"MoveItemsAsync.VersionLimitError"});t.actions().moveAnywayVersionLimit.isAvailable(!0);t.error(new l.default({message:h.strings.moveFileFolderVersionLimit}))}else if(-2147018894===r)e.message&&t.error(new l.default({message:e.message}));else if(2028===r){t.actions().moveAnyway.isAvailable(!0);t.error(new l.default({message:f.strings.moveItemCannotMoveOwnItemIntoMountPointError}))}else if(2029===r){t.actions().moveAnyway.isAvailable(!0);t.error(new l.default({message:f.strings.moveItemCannotMoveSharedItemIntoOwnFolderError}))}else if(9001===r){t.actions().moveLockedFile.isAvailable(!0);t.error(new l.default({message:e.message}))}else if(-2130247142===r){var o=e.message;t.payloads().moveItems.item.type===y.default.Folder&&(t.payloads().moveItems.item.key===t.payloads().moveItems.destination.key?o=h.strings.moveFolderToSameLocationErrorText:0===t.payloads().moveItems.destination.key.indexOf(t.payloads().moveItems.item.key)&&(o=h.strings.moveFolderToOwnSubfolderErrorText));t.error(new l.default({message:o}))}else{var a=h.strings,s=void 0;switch(r){case 3e3:s=_.strings.ItemNotFoundSubText;break;case 1007:s=a.moveFolderToSameLocationErrorText;break;case T:s=a.overQuotaCreateItemErrorText;break;case-2147024816:s=a.conflictCopyFileErrorText;break;case-2147024713:s=a.conflictMoveFileFolderErrorText;break;case-2147213295:s=a.moveCopyIRMNotSupported;break;case-2147213288:s=a.moveCopyObjectsNotSameLevel;break;case-2147213287:s=a.moveCopyTargetIsSubfolder;break;case-2147213294:case-2147213293:s=a.moveFolderDeleteFail;break;case-2147213291:case-2147024684:case-2147213290:s=a.moveFileDeleteFail;break;case-2147213285:s=a.moveCopyPermissionsFail;break;case-2147213284:s=a.moveCopyNoScriptSourceFail;break;case-2147213283:s=a.moveCopyNoScriptTargetFail;break;case-2147213292:case-2147024809:s=a.moveCopyFatalErrorText;break;default:s=e.message}t.error(new l.default({message:"string"==typeof s?s:void 0}))}t.state(g.default.failed)};m.prototype.markAllOperationsAsStarted=function(e){if(e)for(var t=0,r=e;t<r.length;t++){r[t].state(g.default.started)}};m.prototype._handleGetWorkProgressSuccess=function(c,e,t,r,i){var d=!1,p=!1,f=t.taskId;void 0!==this._pollsForProgressSinceCancel[f]&&(this._pollsForProgressSinceCancel[f]+=1);if(e&&c&&c.progress)for(var n=function(e){for(var t=void 0,r=e.payloads.peek(),i=0,n=c.progress;i<n.length;i++){var o=n[i];if(r.copyItems&&o.id===e.payloads.peek().copyItems.taskId&&h._hasMatchingItemIds(e,o)&&e.state.peek()!==g.default.completed&&e.state.peek()!==g.default.failed){t=o;break}}var a=function(){e.progress.current(1);e.actions().cancel&&e.actions().cancel.isAvailable(!1);e.state(g.default.completed);p=!0};if(t){var s=t.error,u=v.ITaskStatuses[t.status];if(u===v.ITaskStatuses.Cancelled||3<=h._pollsForProgressSinceCancel[f]){e.actions().cancel.isAvailable(!1);e.state(g.default.canceled);p=!0}else if(s){t.errorCode===C&&(s.code=T);if(h._progressCache){e.progress.current(0);e.state()!==g.default.failed&&h.handleMoveCopyError(s,e)}else h.handleMoveCopyError(s,e)}else if(u===v.ITaskStatuses.Completed)a();else{var l=e.progress.current.peek();if(t.completedBytes>l){e.progress.current(t.completedBytes);e.progress.maximum(t.totalBytes)}d=!0}h._progressCache&&h._progressCache.updateJobState(f,e,t)}else e.state()!==g.default.failed&&a()},h=this,o=0,a=e;o<a.length;o++){n(a[o])}if(p){this._itemProvider.invalidateItem(t.parentKey);this._itemProvider.invalidateItem(t.targetKey);this._updateQuota()}if(d){var s=this.async.setTimeout(function(){i(r)},2e3);m._activeAsyncTasks[this._getKey(t)]=s}else if(this._progressCache){this._pollsForProgressSinceCancel={};this._progressCache.purgeJobState(f)}};m.prototype._hasMatchingItemIds=function(e,t){var r=e.payloads.peek().copyItems&&e.payloads.peek().copyItems.item;return!t.sourceResourceId||this._moveCopyDataSource.hasMatchingId(t.sourceResourceId,r)};m.prototype.cancelAsyncOperation=function(e,i,t){var n=this,o=t||e.taskId,a=m._activeAsyncTasks[this._getKey(e)];if(!this._cancelPromises[o]){var r={workItemIds:[o]};this._progressCache&&(r.progressCache=this._progressCache);this._cancelPromises[o]=this._itemDataSource.cancelWork(r)}return this._cancelPromises[o].then(function(e){if(n._progressCache){var t=n._progressCache.getCacheData(),r=t&&t[o];if(e||!r){i.state(g.default.canceled);n._progressCache.cancelJobs(o);a&&n.async.clearTimeout(a)}else n._pollsForProgressSinceCancel[o]=0}i.actions().cancel.isAvailable(!1);n._cancelPromises[o]=void 0},function(e){n._cancelPromises[o]=void 0})};m.prototype._getKey=function(e){return e.items.map(function(e){return e.key}).join(",")+e.targetKey};m.prototype._resumePendingProgress=function(){var t=this;this._bundleLoader.queueLoad("VF",function(){return new i.default(function(e,t){r(["VF"],e,t)})}).then(function(e){t._progressCache=new(t.managed(e))({moveCopyHelper:t});t._progressCache.resumePendingProgress()})};m._activeAsyncTasks={};return m}(n.default);e.default=m});define("eR",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IGetWorkProgressTypes={itemCopy:"itemCopy",albumFolderExtraction:"albumFolderExtraction"}});define("eI",["require","exports","ap","eJ","bN","by"],function(e,t,n,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="OfflineClientInstalled",u="SharePoint.OfflineClient",l="application/x-sharepoint-webkit",c="macSharePointPlugin",i=function(r){n.__extends(i,r);function i(e){var t=r.call(this,e)||this;t._platform=t.resources.consume(a.platformDetection);return t}i.IsBrowserPluginInstalled=function(e){var t=navigator.mimeTypes&&navigator.mimeTypes[e];return!!t&&!!t.enabledPlugin};i.prototype.TryUseOfflineClient=function(e,t,r,i,n,o,a){if(this._initOfflineClient()){try{if(!this._isOfflineAllowedByClient(e,t,i,n))return!1;this._offlineClient.TakeOffline(e,t,r,i,n,o,a)}catch(e){return!1}return!0}return!1};i.prototype._isOfflineAllowedByClient=function(e,t,r,i){return this._offlineClient.IsOfflineAllowed(e,t,r,i)};i.prototype._initOfflineClient=function(){try{if(!this._platform.isWindows7)return!1;if(!this._offlineClient)if(-1===document.cookie.indexOf(s)){this._isSupportedMacBrowser()?this._offlineClient=this._createMacPlugin():this._offlineClient=new ActiveXObject(u);o.set(s,"1")}else{if("1"!==o.get(s))return!1;this._isSupportedMacBrowser()?this._offlineClient=this._createMacPlugin():this._offlineClient=new ActiveXObject(u)}if(this._offlineClient&&void 0!==this._offlineClient&&void 0!==this._offlineClient.IsOfflineAllowed&&void 0!==this._offlineClient.TakeOffline)return!0}catch(e){o.set(s,"0");this._offlineClient=null}return!1};i.prototype._isSupportedMacBrowser=function(){return this._platform.isMac&&(this._platform.isFirefox||this._platform.isSafari||this._platform.isChrome)};i.prototype._createMacPlugin=function(){var e=null;if(this._isSupportedMacBrowser()&&!this._platform.isChrome&&null===(e=document.getElementById(c))&&this._isMacPluginInstalled()){var t=null;t=this._platform.isSafari&&i.IsBrowserPluginInstalled(l)?l:i.MAC_PLUGIN_MIME_TYPE;var r=document.createElement("object");r.id=c;r.type=t;r.width="0";r.height="0";r.style.visibility="hidden";document.body.appendChild(r);e=document.getElementById(c)}return e};i.prototype._isMacPluginInstalled=function(){var e=i.IsBrowserPluginInstalled(l),t=i.IsBrowserPluginInstalled(i.MAC_PLUGIN_MIME_TYPE);return!(!this._platform.isSafari||!e)||t};i.MAC_PLUGIN_MIME_TYPE="application/x-sharepoint";return i}(r.default);t.SyncActiveXClient=i;t.default=i});!function(e,o){"use strict";var t=function(e){if("object"!=typeof e.document)throw Error("Cookies.js requires a `window` with a `document` object");var n=function(e,t,r){return 1===arguments.length?n.get(e):n.set(e,t,r)};n._document=e.document;n._cacheKeyPrefix="cookey.";n._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC");n.defaults={path:"/",secure:!1};n.get=function(e){n._cachedDocumentCookie!==n._document.cookie&&n._renewCache();return n._cache[n._cacheKeyPrefix+e]};n.set=function(e,t,r){(r=n._getExtendedOptions(r)).expires=n._getExpiresDate(t===o?-1:r.expires);n._document.cookie=n._generateCookieString(e,t,r);return n};n.expire=function(e,t){return n.set(e,o,t)};n._getExtendedOptions=function(e){return{path:e&&e.path||n.defaults.path,domain:e&&e.domain||n.defaults.domain,expires:e&&e.expires||n.defaults.expires,secure:e&&e.secure!==o?e.secure:n.defaults.secure}};n._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())};n._getExpiresDate=function(e,t){t=t||new Date;"number"==typeof e?e=1/0===e?n._maxExpireDate:new Date(t.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e));if(e&&!n._isValidDate(e))throw Error("`expires` parameter cannot be converted to a valid Date instance");return e};n._generateCookieString=function(e,t,r){e=(e=(e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent)).replace(/\(/g,"%28").replace(/\)/g,"%29"))+"="+(t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent))+((r=r||{}).path?";path="+r.path:"");e+=r.domain?";domain="+r.domain:"";return(e+=r.expires?";expires="+r.expires.toUTCString():"")+(r.secure?";secure":"")};n._getCacheFromString=function(e){var t={};e=e?e.split("; "):[];for(var r=0;r<e.length;r++){var i=n._getKeyValuePairFromCookieString(e[r]);t[n._cacheKeyPrefix+i.key]===o&&(t[n._cacheKeyPrefix+i.key]=i.value)}return t};n._getKeyValuePairFromCookieString=function(e){var t=(t=e.indexOf("="))<0?e.length:t;return{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}};n._renewCache=function(){n._cache=n._getCacheFromString(n._document.cookie);n._cachedDocumentCookie=n._document.cookie};n._areEnabled=function(){var e="1"===n.set("cookies.js",1).get("cookies.js");n.expire("cookies.js");return e};n.enabled=n._areEnabled();return n},r="object"==typeof e.document?t(e):t;"function"==typeof define&&define.amd?define("eJ",[],function(){return r}):"object"==typeof exports?("object"==typeof module&&"object"==typeof module.exports&&(exports=module.exports=r),exports.Cookies=r):e.Cookies=r}("undefined"==typeof window?this:window);define("eD",["require","exports","ap","aC","ba","eE","ev","bN","dc","d7","dZ"],function(e,t,i,l,c,o,d,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._navigation=t.resources.consume(n.navigation);t._userInfoProvider=t.resources.consume(a.userInfo);t._shouldSkipOptimizely=t.determineShouldSkipOptimizely();return t}e.prototype.activateExperimentBehindFeature=function(i,n,e){var t=this;return c.isFeatureEnabled(i)?this._shouldSkipOptimizely?l.default.wrap(0):o.OptimizelyHelper.activateExperiment(n).then(function(){return t.getVariationIdsMapForExperiment(n)}).then(function(e){if(e){var t=window.optimizely,r=t&&t.data;d.default.logData({name:i.ODC?String(i.ODC):String(i.ODB),isInRamp:!0,experiment:r&&r.experiments[n]&&r.experiments[n].name,variant:r&&r.variations[e]&&r.variations[e].name})}return e},function(e){return l.default.wrap(0)}):l.default.wrap(0)};e.prototype.activateSRMProneExperimentBehindFeature=function(t,r,i){var n=this;return c.isFeatureEnabled(t)?this._shouldSkipOptimizely?l.default.wrap(0):this._userInfoProvider.getOptimizelyVariation(r).then(function(e){if(e){if(!window.optimizely)return e;window.optimizely.push(["bucketVisitor",r,e])}return n.activateExperimentBehindFeature(t,r,i).then(function(e){n._userInfoProvider.setOptimizelyVariation(r,e);return e})}):l.default.wrap(0)};e.prototype.getVariationIdsMapForExperiment=function(e){return this._shouldSkipOptimizely?l.default.wrap(0):o.OptimizelyHelper.GetVariationIdsMapForExperiment(e).then(function(e){return e&&e.length?parseInt(e[0],10):0})};e.prototype.determineShouldSkipOptimizely=function(){for(var e=this._navigation.viewParams,t=!1,r=0,i=Object.keys(e);r<i.length;r++){if(i[r].match("optimizely_x")){t=!0;break}}return!t&&this.isInapplicableEnvironment()};e.prototype.isExperimentManualTest=function(e){return!!this._navigation.viewParams["EXPExperimentTest_e"+e]};e.prototype.isInapplicableEnvironment=function(){var e="edog"===(window._spPageContextInfo&&window._spPageContextInfo.env);return!(!window.$Config||!window.$Config.isINT)||e};e.prototype.startEXPExperimentBehindFeature=function(t,e){var r=this,i=e.experimentId,n=e.experimentName,o=e.variationMap,a=e.getVariationFunction;if(c.isFeatureEnabled(t)){if(this.isExperimentManualTest(i)){var s=this._navigation.viewParams["EXPExperimentTest_e"+i],u=Number(s);return isNaN(u)||!o[u]?l.default.wrap(0):l.default.wrap(u)}return this.getExperimentVariation(i,a).then(function(e){e&&!r.isInapplicableEnvironment()&&d.default.logData({name:t.ODC?String(t.ODC):String(t.ODB),isInRamp:!0,experiment:n,variant:o[e]&&o[e].name});return e})}return l.default.wrap(0)};e.prototype.getExperimentVariation=function(i,n){var o=this;return this._userInfoProvider.getEXPExperimentVariation(i).then(function(e){if(e)return l.default.wrap(e);var t=o.resources.consume(s.identity.optional).getIdentity().id,r=n(t);return o._userInfoProvider.setEXPExperimentVariation(i,r).then(function(e){return e?l.default.wrap(r):l.default.wrap(0)})})};return e}(r.default);t.default=u});define("eE",["require","exports","eF"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function n(){}n.init=function(e,t,r){window.optimizely=window.optimizely||[];window.optimizely.push(["setCookieExpiration",365]);window.optimizely.push(["skipPageTracking"]);var i=window.location.href.replace(n.AUTHKEY_REGEX,"$1$2");window.optimizely.push(["trackEvent",i]);return o.default.init(e,t,r).then(function(){var e=window.location.search;e&&(0<e.indexOf("su=1")?n.trackEvent(n.SIGN_INUP_EXPERIMENT_ID,"SignUpCompletedODC"):0<e.indexOf("gologin=1")&&n.trackEvent(n.SIGN_INUP_EXPERIMENT_ID,"SignInCompletedODC"))},function(){})};n.trackEvent=function(e,t,r){void 0===r&&(r=!1);o.default.trackEvent(e,t,r)};n.activateExperiment=function(e){return o.default.activateExperiment(e)};n.SetDimensionValue=function(e,t){o.default.SetDimensionValue(e,t)};n.GetVariationIdsMapForExperiment=function(e){return o.default.GetVariationIdsMapForExperiment(e)};n.LogShareInvokedAction=function(e){var t="";if(2===e){n._anyShareExecutedCount++;n._linkExecutedCount++;t=n.EVENTS.getLinkClicked;10<=n._linkExecutedCount?t=n.EVENTS.getLinkClickedTenPlus:5<=n._linkExecutedCount?t=n.EVENTS.getLinkClickedFivePlus:2<=n._linkExecutedCount&&(t=n.EVENTS.getLinkClickedTwoPlus)}else if(1===e){n._anyShareExecutedCount++;n._inviteExecutedCount++;t=n.EVENTS.inviteClicked;10<=n._inviteExecutedCount?t=n.EVENTS.inviteClickedTenPlus:5<=n._inviteExecutedCount?t=n.EVENTS.inviteClickedFivePlus:2<=n._inviteExecutedCount&&(t=n.EVENTS.inviteClickedTwoPlus)}if(t){n.trackEvent(n.EXPERIMENTS.share,t);t=n.EVENTS.anyShareClicked;10<=n._anyShareExecutedCount?t=n.EVENTS.anyShareClickedTenPlus:5<=n._anyShareExecutedCount?t=n.EVENTS.anyShareClickedFivePlus:2<=n._anyShareExecutedCount&&(t=n.EVENTS.anyShareClickedTwoPlus);n.trackEvent(n.EXPERIMENTS.share,t)}};n.AUTHKEY_REGEX=/(\?|&)authkey=[^&]+&?(.*)?$/;n.LEFT_NAV_EXPERIMENT_ID=2623860133;n.LEFT_NAV_VARIATION_ID="2621120483";n.SIGN_INUP_EXPERIMENT_ID=5221551250;n.SEARCHBOX_GLYPH_EXPERIMENT_ID=3354310012;n.SEARCHBOX_GLYPH_VARIATION_NONE_ID=3319860271;n.SEARCHBOX_GLYPH_VARIATION_LEFT_ID=3330500084;n.SEARCHBOX_GLYPH_VARIATION_RIGHT_ID=3363121932;n.SHARE_EXPERIMENT_ID=3643121303;n.SHARE_VARIATION_LINK_ID=3657201057;n.SHARE_VARIATION_SHARE_LINK_ID=3668330022;n.SHARE_VARIATION_EMAIL_ID=3659890065;n.SHARE_VARIATION_INVITE_ID=3666460021;n.PHOTOSSEARCH_BUBBLE_EXPERIMENT_ID=5249240265;n.PHOTOSSEARCH_BUBBLE_VARIATION_OFF_ID=5238290484;n.PHOTOSSEARCH_BUBBLE_VARIATION_BLUE_ID=5240870725;n.PHOTOSSEARCH_BUBBLE_VARIATION_WHITE_ID=5323411530;n.STORAGEOPTIONS_EXPERIMENT_ID=5136502086;n.STORAGEOPTIONS_ORIGINAL=5139232409;n.STORAGEOPTIONS_VARIATION_BESTDEAL_NOTRIAL=5131802173;n.STORAGEOPTIONS_VARIATION_BESTDEAL_TRIAL=5138372118;n.STORAGEOPTIONS_VARIATION_1TB_NOTRIAL=5139232410;n.STORAGEOPTIONS_VARIATION_1TB_TRIAL=5131021992;n.EXPERIMENTS={searchBoxGlyph:n.SEARCHBOX_GLYPH_EXPERIMENT_ID,share:n.SHARE_EXPERIMENT_ID,photosSearchBubble:n.PHOTOSSEARCH_BUBBLE_EXPERIMENT_ID,storageOptions:n.STORAGEOPTIONS_EXPERIMENT_ID};n.EVENTS={UpsellClickCloseButton:"Upsell.ClickCloseButton",searchExecuted:"searchExecuted",searchExecutedTwice:"searchExecutedTwice",searchExecutedThreePlus:"searchExecutedThreePlus",searchBoxClicked:"searchboxClicked",inviteClicked:"shareClicked",inviteClickedTwoPlus:"inviteClickedTwoPlus",inviteClickedFivePlus:"inviteClickedFivePlus",inviteClickedTenPlus:"inviteClickedTenPlus",getLinkClicked:"getLinkClicked",getLinkClickedTwoPlus:"getLinkClickedTwoPlus",getLinkClickedFivePlus:"getLinkClickedFivePlus",getLinkClickedTenPlus:"getLinkClickedTenPlus",anyShareClicked:"anyShareClicked",anyShareClickedTwoPlus:"anyShareClickedTwoPlus",anyShareClickedFivePlus:"anyShareClickedFivePlus",anyShareClickedTenPlus:"anyShareClickedTenPlus",photosSearchExecuted1:"PhotoSearchExecutedOnce",photosSearchExecuted2:"PhotoSearchExecutedTwice",photosSearchExecuted3:"PhotoSearchExecutedThree",photosSearchExecuted4:"PhotoSearchExecutedThreePlus",photosSearchBoxClicked:"PhotoSearchboxClicked",selectedLeftNav:"selectedLeftNav"};n.EVENT_TO_API_ID={ClickGetTheApps:"SkyDriveWeb_ABTest_LeftNav_GetApps"};n.IS_OPTIMIZELY_ENABLED=n.IS_OPTIMIZELY_ENABLED;n._anyShareExecutedCount=0;n._inviteExecutedCount=0;n._linkExecutedCount=0;return n}();t.OptimizelyHelper=r});define("eF",["require","exports","bS","aC","bc","eH","eG","c9"],function(e,t,r,i,n,a,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function u(){}u.init=function(e,s,t){e&&(u._id=e);if(u.requirePromise)return u.requirePromise;if(u.IS_OPTIMIZELY_ENABLED&&u._id&&!t){window.optimizely=window.optimizely||[];window.optimizely.push(["setCookieExpiration",365]);return u.requirePromise=o.loadModuleIdentity({path:"optimizely",require:window.require}).then(function(){if(window.optimizely&&optimizely.push){optimizely.push(["setDimensionValue","ODLocale",s]);optimizely.push(["setDimensionValue","ODCID",u._id]);optimizely.push(["setDimensionValue","webAuthState","UnAuth"!==u._id]);var e=optimizely.data&&optimizely.data.state;if(e&&e.activeExperiments&&e.activeExperiments.length){for(var t=[],r=[],i=0;i<e.activeExperiments.length;i++){var n=e.activeExperiments[i],o=e.variationIdsMap[n]||"0";t.push(n);r.push(o)}var a={experiments:t.join(","),variations:r.join(","),unid:u._id};l.OptimizelyState.logData(a)}}},function(){})}return u.requirePromise=i.default.resolve()};u.trackEvent=function(i,n,o){void 0===o&&(o=!1);u.init().done(function(){if(window.optimizely&&optimizely.push){o?optimizely.push(["trackEvent",n,{revenue:1}]):optimizely.push(["trackEvent",n]);var e=optimizely.data&&optimizely.data.state;if(e){var t=u._id,r={eventName:n,experimentId:i,variationId:e.variationIdsMap[i]&&e.variationIdsMap[i][0],unid:t};a.Optimizely.logData(r)}}})};u.activateExperiment=function(e){return u._activatedExperiments[e]?i.default.resolve(null):u.init().then(function(){if(window.optimizely&&optimizely.push){optimizely.push(["activate",e]);u._activatedExperiments[e]=!0}})};u.SetDimensionValue=function(e,t){u.init().done(function(){window.optimizely&&optimizely.push&&optimizely.push(["setDimensionValue",e,t])})};u.GetVariationIdsMapForExperiment=function(e){return u.init().then(function(){return window.optimizely&&optimizely.data&&optimizely.data.state&&optimizely.data.state.variationIdsMap&&optimizely.data.state.variationIdsMap[e]})};u.OptimizelyEnabled={ODB:803,ODC:"OptimizelyEnabled",Fallback:!1};u.IS_OPTIMIZELY_ENABLED=n.default.isFeatureEnabled(u.OptimizelyEnabled);u.async=new r.default;u._activatedExperiments={};return u}();t.default=s});define("eH",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Optimizely=r.createSingleEvent({eventName:"Optimizely,",shortEventName:"Optimizely"},{eventName:1,experimentId:1,variationId:1,unid:1});t.default=t.Optimizely});define("eG",["require","exports","aR"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OptimizelyState=r.createSingleEvent({eventName:"OptimizelyState,",shortEventName:"OptimizelyState"},{experiments:1,variations:1,unid:1});t.default=t.OptimizelyState});define("eB",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.ConstantResourceFactory({postProcessSchema:function(e,t){return t}})})});define("es",["require","exports","ap","bN","eA","ez","ey","ew","et","dH","iE","aG","bA"],function(e,t,r,i,n,o,a,s,u,l,c,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r._itemParentHelper=t.itemParentHelper;r._activityColumnBuilder=t.activityColumnBuilder;r._isActivityFieldEnabled=t.isActivityFieldEnabled;r._isActivityFieldVisible=t.isActivityFieldVisible;r._pageContext=t.pageContext;return r}e.prototype.postProcessSchema=function(e,t){var r=this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));r&&r.list.isDocumentLibrary&&e.queryType===l.default.Files&&(o.isOutOfTheBoxList(t)||r.list.templateType===a.default.mySiteDocumentLibrary||Number(this._pageContext.webTemplate)===d.default.mySite)&&this._isActivityFieldEnabled&&this._isActivityFieldVisible()&&(t=t.concat([this._activityColumnBuilder.createActivityColumn()]));return t};return e}(i.default);t.DetailsListSchemaDataSource=f;t.resourceKey=p.createResolvedResourceKey(e("module").id,f,r.__assign({},i.default.dependencies,{itemParentHelper:n.resourceKey,activityColumnBuilder:s.resourceKey,isActivityFieldEnabled:u.isActivityFieldEnabledResourceKey,isActivityFieldVisible:u.isActivityFieldVisibleResourceKey.lazy,pageContext:c.pageContext}))});define("ez",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["DocIcon","LinkFilename","_shareHeroCommand","_calloutInvoker","Modified","Editor"];t.isOutOfTheBoxList=function(e){if(e.length===r.length){for(var t=0;t<r.length;t++)if(e[t].internalName!==r[t])return!1;return!0}return!1}});define("ew",["require","exports","ap","bN","ex","bA"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e,t){return r.call(this,e,t)||this}e.prototype.createActivityColumn=function(){return{key:"activity",name:"Activity",fieldType:n.default.Activity,width:400,isVisible:!0,isVisibleMobile:!0,isCollapsable:!1,isIcon:!1,sortable:!1,filterable:!1,isSorted:!1,isFocused:this.observables.create(!1),isAscending:!1}};return e}(r.default);t.ActivityColumnBuilder=a;t.resourceKey=o.createResolvedResourceKey(e("module").id,a,i.__assign({},r.default.dependencies))});define("er",["require","exports","aq"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function n(){this._originalProvider=new o.bindingProvider;this._bindingHandlers={};this._bindingContexts=[]}n.getInstance=function(){return n._instance};n.prototype.nodeHasBindings=function(e){return this._originalProvider.nodeHasBindings(e)};n.prototype.getBindings=function(e,t){try{this._bindingContexts.push(t);var r=this._originalProvider.getBindings(e,t);return r&&this._remapKeys(r,t)}finally{this._bindingContexts.pop()}};n.prototype.getBindingAccessors=function(e,t){try{this._bindingContexts.push(t);var r=this._originalProvider.getBindingAccessors(e,t);return r&&this._remapKeys(r,t)}finally{this._bindingContexts.pop()}};n.prototype.getBindingHandler=function(e){var t=this._bindingContexts.slice(-1)[0];if(t){var r=this._getLocalBindingHandlers(t);if(r){var i=r[e];e=i&&this.getUniqueKeyForBindingHandler(i,e)||e}}return this._bindingHandlers[e]||o.bindingHandlers[e]};n.prototype.getUniqueKeyForBindingHandler=function(e,t){var r=n._BINDING_PROVIDER_UNIQUE_KEY,i=e[r]=e[r]||t+"-local-"+ ++n._lastUniqueKeyOrdinal;this._bindingHandlers[i]={init:e.init&&e.init.bind(e),update:e.update&&e.update.bind(e),options:e.options,preprocess:e.preprocess&&e.preprocess.bind(e)};this._bindingHandlers[i].after=e.after;e.supportsVirtualElements&&(o.virtualElements.allowedBindings[i]=!0);return i};n.prototype._remapKeys=function(e,t){var r=e,i=this._getLocalBindingHandlers(t);if(i){r={};for(var n in e){var o=i[n];r[o&&this.getUniqueKeyForBindingHandler(o,n)||n]=e[n]}}return r};n.prototype._getLocalBindingHandlers=function(e){for(var t;!(t="object"==typeof e.$data&&e.$data.bindingHandlers)&&e.$parentContext;)e=e.$parentContext;return t};n._instance=new n;n._BINDING_PROVIDER_UNIQUE_KEY="__localBindingProvider__uniqueKey";n._lastUniqueKeyOrdinal=0;return n}(),i=r.getInstance();o.getBindingHandler=i.getBindingHandler.bind(i);o.bindingProvider.instance=i;t.default=r});define("d9",["require","exports","ea"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=r.default});define("ea",["require","exports","ap","eq","ep","ef","aC","ec","aF","eb"],function(e,t,i,o,n,r,a,s,u,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._pageContext=e;return t}e.prototype.getCacheToken=function(){var e="",t=this._pageContext;if(t){var r=Number(t.webTemplate),i=r!==n.default.mySite&&r!==n.default.mySiteHost?t.groupColor:null;e=t.themedCssFolderUrl||i||null}return e};e.prototype.loadTheme=function(e){if(!e&&this._dataPromise)return this._dataPromise;if(!this.getCacheToken())return this._dataPromise=a.default.resolve();this._dataPromise=this._pageContext.themedCssFolderUrl?this.loadServerTheme():this.loadGeneratedTheme();return this._dataPromise};e.prototype.getDataSourceName=function(){return"WebThemeDataSource"};e.prototype.needsRequestDigest=function(e){return!1};e.prototype.loadGeneratedTheme=function(){var e=this._pageContext.groupColor,t=u.default.fromHtmlColor(e);if(t){var r={backgroundImageUri:null,cacheToken:e,isDefault:!1,isInverted:!1,palette:s.default.generateFabricColors(t),version:"1"};return a.default.resolve(r)}return a.default.resolve()};e.prototype.loadServerTheme=function(){var t=this,e=o.getSafeWebServerRelativeUrl(this._pageContext),r=this._pageContext.currentUICultureName,i=l.default.makeWebThemeRestUrl(e,r),n=this.getData(function(){return i},function(e){t._data=l.default.processWebThemeRestResponse(e);return t._data},this.getDataSourceName()+".LoadData",null,"GET");n.done(null,function(){t._dataPromise=null});return n};return e}(r.DataSource);t.default=c});define("ec",["require","exports","ee","aF","ed"],function(e,t,s,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function c(){}c.generateFabricColors=function(e,t){void 0===t&&(t=!1);var r={themeDarker:p.Shades.Darkest,themeDark:p.Shades.Darker,themeDarkAlt:p.Shades.Darker,themeLight:p.Shades.Lighter,themeLightAlt:p.Shades.Lighter,themeLighter:p.Shades.Lightest,themeLighterAlt:p.Shades.Lightest,themePrimary:p.Shades.Unshaded,themeAccent:p.Shades.Unshaded,themeSecondary:p.Shades.Medium,themeTertiary:p.Shades.Lighter,themeTertiaryAlt:p.Shades.Lighter},i=c._getDefaultThemeTokenMap(),n=d.default.fromRgba(e.R,e.G,e.B);for(var o in r){var a=r[o];t&&a!==p.Shades.Unshaded&&(a=p.Shades.Darkest+p.Shades.Lightest-a);i[o]=p.getShade(n,a)}var s=i.themeAccent;i.themeAccentTranslucent10=s?d.default.fromRgba(s.R,s.G,s.B,.1*d.default.maxComponent):null;if(t){var u={black:"#fff",blackTranslucent40:"#66ffffff",neutralDark:"#fff",neutralPrimary:"#f8f8f8",neutralPrimaryTranslucent50:"#7ff8f8f8",neutralPrimaryAlt:"#f4f4f4",neutralSecondary:"#eaeaea",neutralSecondaryAlt:"#c8c8c8",neutralTertiary:"#a6a6a6",neutralTertiaryAlt:"#767676",neutralQuaternary:"#6b6b6b",neutralQuaternaryAlt:"#707070",cmdbarSelected:"#6b6b6b",cmdbarSelectedHover:"#707070",neutralLight:"#666666",neutralLighter:"#333",neutralLighterAlt:"#212121",primaryText:"#f8f8f8",primaryBackground:"#000",white:"#000",whiteTranslucent40:"#66000000",error:"#f00",errorBackground:"#7e3333"};for(var l in u)u.hasOwnProperty(l)&&(i[l]=d.default.fromHtmlColor(u[l]))}return i};c.applyHslDelta=function(e,t,r,i){var n=e.hue-t;(1<n||n<0)&&(n-=Math.floor(n));var o=e.sat-r;1<o?o=1:o<0&&(o=0);var a=e.lum-i;1<a?a=1:a<0&&(a=0);return new s.default(n,o,a)};c._getDefaultThemeTokenMap=function(){return{backgroundOverlay:null,primaryBackground:null,primaryText:null,themeDarker:null,themeDark:null,themeDarkAlt:null,themePrimary:null,themeSecondary:null,themeTertiary:null,themeLight:null,themeLighter:null,themeLighterAlt:null,black:null,cmdbarSelected:null,cmdbarSelectedHover:null,neutralDark:null,neutralPrimary:null,neutralPrimaryAlt:null,neutralPrimaryTranslucent50:null,neutralSecondary:null,neutralSecondaryAlt:null,neutralTertiary:null,neutralTertiaryAlt:null,neutralQuaternary:null,neutralQuaternaryAlt:null,neutralLight:null,neutralLighter:null,neutralLighterAlt:null,white:null,blackTranslucent40:null,whiteTranslucent40:null,yellow:null,yellowLight:null,orange:null,orangeLight:null,redDark:null,red:null,magentaDark:null,magenta:null,magentaLight:null,purpleDark:null,purple:null,purpleLight:null,blueDark:null,blueMid:null,blue:null,blueLight:null,tealDark:null,teal:null,tealLight:null,greenDark:null,green:null,greenLight:null,error:null,errorBackground:null,success:null,successBackground:null,alert:null,alertBackground:null,infoBackground:null,info:null,orangeLighter:null}};return c}();t.default=r});define("ee",["require","exports","aF"],function(e,t,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function m(e,t,r,i){function n(e){return Math.min(1,Math.max(0,e))}this.hue=n(e);this.sat=n(t);this.lum=n(r);this.alpha=null==i?g.default.maxComponent:i}m.fromRgba=function(e){var t=g.default.maxComponent,r=0,i=0,n=e.R,o=e.G,a=e.B,s=Math.max(Math.max(n,o),a),u=Math.min(Math.min(n,o),a),l=s+u;if(s===u){i=0;r=-1}else{var c=s-u,d=s+u;i=l<=1*t?c/d:c/(2*t-d);var p=1/6*(s-n)/c,f=1/6*(s-o)/c,h=1/6*(s-a)/c;(r=n===s?h-f:o===s?1/3+p-h:2/3+f-p)<0&&(r+=1);1<r&&(r-=1)}return new m(r,i,l/(2*t),e.A)};m._hslComponentToByte=function(e){var t=g.default.maxComponent,r=Math.round(t*e);return Math.min(t,Math.max(0,r))};m._hueToRgbComponent=function(e,t,r){r<0&&(r+=1);1<r&&(r-=1);return m._hslComponentToByte(r<1/6?e+(t-e)*r*6:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e)};m.prototype.darken=function(e){this.lum*=e};m.prototype.lighten=function(e){this.lum=this.lum*e+(1-e)};m.prototype.toRgbaColor=function(){var e,t,r,i=this.hue,n=this.sat,o=this.lum;if(0===Math.round(n*g.default.maxComponent))e=t=r=m._hslComponentToByte(o);else{var a,s;e=m._hueToRgbComponent(a=2*o-(s=o<=.5?o*(1+n):o+n-o*n),s,i+1/3);t=m._hueToRgbComponent(a,s,i);r=m._hueToRgbComponent(a,s,i-1/3)}return g.default.fromRgba(e,t,r,this.alpha)};return m}();t.default=r});define("ed",["require","exports","ee","aF"],function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u,l=[.95,.85,.75,.65,.5],c=[.5,.65,.75,.85,.95],d=[.2,.4,.6],p=[.75,.5],f=[.1,.25,.5,.75,.9],h=[.9,.75,.5,.25,.1],m=.2,g=.8,r=s.default.maxComponent,y=s.default.fromRgba(r,r,r),v=s.default.fromRgba(0,0,0);!function(e){e[e.Unshaded=0]="Unshaded";e[e.Lightest=1]="Lightest";e[e.Lighter=2]="Lighter";e[e.Medium=3]="Medium";e[e.Darker=4]="Darker";e[e.Darkest=5]="Darkest"}(u=t.Shades||(t.Shades={}));t.getShade=function(e,t){if(!e)return null;if(t===u.Unshaded||!((r=t)>=u.Unshaded&&r<=u.Darkest))return s.default.fromRgba(e.R,e.G,e.B,e.A);var r,i=a.default.fromRgba(e),n=i.lum,o=t-1;s.default.equals(e,y)?i.darken(l[o]):s.default.equals(e,v)?i.lighten(c[o]):n<m?i.lighten(f[o]):g<n?i.darken(h[o]):o<d.length?i.lighten(d[o]):i.darken(p[o-d.length]);return e=i.toRgbaColor()}});define("eb",["require","exports","ec","aF","aM"],function(e,t,d,p,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function c(){}c.makeWebThemeRestUrl=function(e,t,r){var i=e;i&&"/"===i[i.length-1]&&(i=i.substring(0,i.length-1));i=o.default.escapeUrlForCallback(i);var n=o.default.escapeUrlForCallback(i)+"/_api/SP.Web.GetContextWebThemeData?noImages=true&lcid="+o.default.encodeURIComponent(t);r&&(n+="&ThemeOverride="+o.default.encodeURIComponent(r));return n};c.processWebThemeRestResponse=function(e){var t,r=JSON.parse(e);r&&r.d&&r.d.GetContextWebThemeData&&(t=JSON.parse(r.d.GetContextWebThemeData));return c.processRawThemeData(t)};c.processRawThemeData=function(e){if(e){var t,r=c.coerceToColor,i=c.SetColorIfMissing,n=e.Palette?e.Palette.Colors:{};t=c.convertColorsToRgba(n);var o=d.default.generateFabricColors(t.ContentAccent1,e.IsInverted),a=r(t.PageBackground)||null,s=r(t.BackgroundOverlay)||null,u=Math.round(.4*p.default.maxComponent);for(var l in o)i(t,l,o[l]);i(t,"white",a);i(t,"primaryBackground",p.default.clone(a));i(t,"primaryText",o.primaryText||r("#333"));i(t,"whiteTranslucent40",a&&p.default.fromRgba(a.R,a.G,a.B,u));i(t,"backgroundOverlay",s);i(t,"suiteBarBackground",r(t.SuiteBarBackground)||null);i(t,"suiteBarText",r(t.SuiteBarText)||null);i(t,"suiteBarDisabledText",r(t.SuiteBarDisabledText)||null);i(t,"topBarBackground",r(t.TopBarBackground)||null);i(t,"topBarText",r(t.TopBarText)||null);i(t,"topBarHoverText",r(t.TopBarHoverText)||null);i(t,"dialogBorder",r(t.DialogBorder)||null);return{backgroundImageUri:e.BackgroundImageUri,cacheToken:e.ThemeCacheToken,isDefault:e.IsDefault,isInverted:e.IsInverted,palette:t,version:e.Version}}return{backgroundImageUri:"",cacheToken:"",isDefault:!0,isInverted:!1,palette:{},version:""}};c.convertColorsToRgba=function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var i=c.coerceToColor(e[r]);i&&(t[r]=i)}return t};c.coerceToColor=function(e){var t;e?"string"==typeof e||e instanceof String?t=p.default.fromHtmlColor(String(e)):"DefaultColor"in e?t=c.coerceToColor(e.DefaultColor):"R"in e&&"G"in e&&"B"in e&&(t=p.default.fromRgba(e.R,e.G,e.B,e.A)):t=null;return t};c.SetColorIfMissing=function(e,t,r){e[t]||(e[t]=r)};return c}();t.default=r});