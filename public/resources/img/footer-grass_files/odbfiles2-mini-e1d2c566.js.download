define("afZ",["require","exports","b5","af1","af0"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"od-business-files-2",template:e("af0"),viewModel:o.default,synchronous:!0});t.default=n});define("af1",["require","exports","ap","bF","agn","te","af2"],function(e,t,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.filesTagName=n.default.tagName;t.filesParams={};return t}return e}(i.default);t.default=r});define("agn",["require","exports","agt","b5","ags","agr","pD","pG","zR","ago"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.registerComponent({tagName:"od-files",template:e("ags"),viewModel:i.default,synchronous:!0});t.default=n});define("agt",["require","exports","ap","aC","aq","ahe","d7","dZ","jG","ahb","dc","eX","ag6","ag1","cY","eO","agX","agW","dH","lb","a9","bX","iD","ba","agV","gb","dG","cE","agU","agT","oj","b3","oq","qs","qm","pP","cq","agI","a3","a2","agu"],function(n,e,t,r,s,i,l,u,o,d,c,p,m,g,f,h,y,w,_,b,v,S,x,C,I,D,k,T,A,M,R,P,E,F,L,O,V,U,N,B){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var H="SignInDialog",W="SignedIn",q=36e5,a=function(a){t.__extends(e,a);function e(e){var t=a.call(this,e)||this;t.listFooterTagName=L.default.tagName;t.oneUpOverlayTagName=O.default.tagName;t.transclusionContentTagName=V.default.tagName;t.unauthenticatedBannerTagName=U.default.tagName;t.addBindingHandlers({react:E.default,control:P.default});t._identity=t.resources.consume(u.identity).getIdentity();t._navigation=t.resources.consume(c.navigation);t._userInfoProvider=t.resources.consume(l.userInfo);t._bundleLoader=t.resources.consume(l.bundleLoader);t._experimentHelper=t.resources.consume(x.experimentHelper);t._dragAndDropRobotProvider=t.resources.consume(l.dragAndDropRobot);t._storageOptionsProvider=t.resources.consume(l.storageOptions);t._isExistingUserPremiumUpsellEligible=t.observables.create(!1);t._isFirstRunExperienceVisible=t.resources.consume(S.isFirstRunExperienceVisible);t._educationAndUpsells=t.resources.consume(I.resourceKey);t._dialogDataStore=new N.default("SignInDialogCounter",B.default.local);t._engagement=t.resources.consume(T.resourceKey);t.showUnauthBanner=t.createObservable(!t._userInfoProvider.isAuthenticated());t.infoPaneSpecification=P.toSpecification(F.resourceKey,{});t._actionMap=t.resources.consume(S.actionMap);var i=new(t.managed(t._actionMap.UploadAction))({uploadProcessorType:k.UploadProcessorType.Html5file});t._isUploadAvailable=i.isAvailable;var o=t._navigation.viewParams;t.isEmptyView=t.createPureComputed(t._computeIsEmptyView);t._robotRootOverride=o.robotMimicRoot;t.isGridBasedView=t.createPureComputed(t._computeIsGridBasedView);t._iosMobilePathDataSource=t.resources.isExposed(u.iosMobileAppPath)?t.resources.consume(u.iosMobileAppPath):null;var n=t.responsiveUI;t._isMobileAtStart=n.compareSize(n.formFactorSize.peek(),"Medium")<=0;if(t._dragAndDropRobotProvider&&!t._isMobileAtStart){t.isDragAndDropRobotApplicable=t.createPureComputed(t._computeIsRobotApplicable);t.dragAndDropGridHintComponent=t.createPureComputed(function(){return t._dragAndDropRobotProvider.getGridHintComponent(t.isGridBasedView,t.isDragAndDropRobotApplicable)});t.dragAndDropFooterHintComponent=t.createPureComputed(function(){return t.isEmptyView()?null:t._dragAndDropRobotProvider.getFooterHintComponent(t.isGridBasedView,t.isDragAndDropRobotApplicable)})}else{t.dragAndDropGridHintComponent=void 0;t.dragAndDropFooterHintComponent=void 0}t.dragAndDrop=new(t.managed(m.default))({});t._uploadTeachingBubbleProvider=t.resources.consume(l.uploadTeachingBubble);t.itemProvider=t.resources.consume(p.resourceKey);t._isGuidedTourVisible=t.createObservable(!1);t._guidedTourUploadTimerStartTime=0;if(t._userInfoProvider.isAuthenticated()){t.createComputed(t._computeUploadTeachingBubble);var r=t._dialogDataStore.getValue(U.LAST_SIGN_IN_DIALOG);r&&r+q<=Date.now()&&t._engagement.logData({name:H+"."+W})}t.upsellComponent=t.createObservable();t.upsell=s.observable(null);t.upsellParams={upsell:t.upsell,item:t.item};t.isUpsellApplicable=t.createObservable(!1);t.createBackgroundComputed(t._determineIfUpsellIsApplicable);t.createBackgroundComputed(t._initializeUpsellComponent);t._freOverride=o.showNewFre;t._guidedTourOverride=o.showGuidedTour;t._basicPositioningOverride=o.showPremiumPositioning;t._newFeaturesOverride=o.showNewFeaturesExperience;t._welcomeOverride=o.showWelcomeExperience;t.firstRunComponent=t.createObservable();t.createBackgroundComputed(t._initializeFirstRunComponent);t.guidedTourComponent=t.createObservable();t.createBackgroundComputed(t._initializeGuidedTourComponent);t.createBackgroundComputed(t._configureAreOverrideParamsAvailable);t.createBackgroundComputed(t._configureIsFirstRunExperienceVisible);t.createBackgroundComputed(t._configureIsPremiumUpsellVisible);t.createBackgroundComputed(t._configureIsGuidedTourVisible);t.showSmartBanner=t.createObservable(!1);t.showMobileWebToAppUpsellV2=t.createObservable(!1);t.createBackgroundComputed(t._initializeMobileWebToAppUpsell);t._mobileWebToAppUpsellDismissed=t.resources.consume(S.mobileUpsellDismissedThisSession.optional);t.createBackgroundComputed(t._activateUpdatedListViewExperiment);t._setupCommandSets();t.hideLeftNav(!1);t._checkForNotifications();t.createBackgroundComputed(function(){!t.isLeftNavVisible()&&t.isLeftNavVisible()||t.async.setTimeout(function(){window.dispatchEvent(new Event("resize"))},300)});return t}e.prototype.onDismissMobileWebToAppUpsellV2=function(){this.showMobileWebToAppUpsellV2(!1);this._mobileWebToAppUpsellDismissed(!0)};e.prototype.onMobileWebToAppUpsellGetAppClick=function(e){this.onDismissMobileWebToAppUpsellV2();this._navigation.navigateTo(e)};e.prototype.onMobileWebToAppUpsellOpenAppClick=function(e){var t=this;this.showMobileWebToAppUpsellV2(!1);var i=Date.now();if(this.platform.isIOS)this._navigation.navigateTo(e);else{this.async.setTimeout(function(){Date.now()-i<750&&t._navigation.navigateTo(e)},250);this._navigation.navigateTo(this._iosMobilePathDataSource.getPath())}};e.prototype.dispose=function(){a.prototype.dispose.call(this);this.contextMenuHelper(null);this.commandSet(null)};e.prototype.computeCurrentPageName=function(){var e,t=this.item.peek(),i=this.urlDataSource.getKeyParams(t.key);switch(this.urlDataSource.getQueryType(i)){case _.default.RecycleBin:e="RecycleBin";break;case _.default.Recent:e="Recent";break;case _.default.SharedWithMe:e="Shared";break;case _.default.Search:e="Search";break;default:e="Folder"}return"Files-"+e};e.prototype.computeContentControl=function(){var e=a.prototype.computeContentControl.call(this);if(e)return e;var t=this.item(),i=this.layoutType(),o=this._getFooterHostContentControlParams();return t.type===h.default.Folder?i===b.SingleAlbum?P.toSpecification(w.resourceKey,o):P.toSpecification(y.resourceKey,o):void 0};e.prototype.computeCreateDataManager=function(){return this._createFilesDataManager};e.prototype._getFooterHostContentControlParams=function(){var e={footerItem:this.dragAndDropGridHintComponent};this._getFooterHostContentControlParams=function(){return e};return e};e.prototype._computeIsGridBasedView=function(){var e=this.layoutType();return e===b.Grid||e===b.SingleAlbum};e.prototype._computeIsEmptyView=function(){return 0===this.itemSet().content().items.length};e.prototype._computeIsRobotApplicable=function(){var e=this.itemSet(),t=e.item(),i=e.content().items;return!(t.key!==this.urlDataSource.getRootItemKey()&&!this._robotRootOverride||e.isPlaceholder||e.isExpired||!(i.length<=3)||!this._educationAndUpsells.getAreNoFilesAdded(e))};e.prototype._computeUploadTeachingBubble=function(){this._uploadTeachingBubbleProvider.checkIfTeachingBubbleIsApplicable(this.urlDataSource.getRootItemKey(),this.itemSet())};e.prototype._createFilesDataManager=function(){return new(this.managed(d.default))({requiredPageType:v.default.Files})};e.prototype._setupCommandSets=function(){var e=new(this.managed(g.default))({}),t=new(this.managed(g.default))({});this.resources.expose(o.listViewContextMenuHelper,new(this.managed(R.default))({items:t.commands.peek(),rootElementClass:"List",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0}));var i=new(this.managed(R.default))({items:t.commands.peek(),rootElementClass:"od-BasePage-content",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0});this.contextMenuHelper(i);this.commandSet(e)};e.prototype._checkForNotifications=function(){var t=this;this.createBackgroundComputed(function(){if(t._bundleLoader.getBundleInfo(2).isLoaded()){var e=n("aho").default;new(t.managed(e))({isPageLevel:!0}).createNotificationHandlers(function(e){return new(t.managed(e))})}});this._userInfoProvider&&this._userInfoProvider.isAuthenticated()&&this.createBackgroundComputed(function(){var e=t.item();if(!e.isPlaceholder&&!t._hasConfiguredUpsell){t._hasConfiguredUpsell=!0;t._getUpsellToShow(e)}})};e.prototype._getUpsellToShow=function(e){var t=this;this._userInfoProvider&&this._userInfoProvider.isAuthenticated()&&this._userInfoProvider.getUpsellToShow(e).then(function(e){e&&t.upsell(e)})};e.prototype._determineIfUpsellIsApplicable=function(){var e=this.item(),t=this.upsell();this._bundleLoader.getBundleInfo(5).isLoaded()&&e&&!this._isMobileAtStart&&this._identity.type===f.IdentityType.msa&&e.key===this.urlDataSource.getRootItemKey()&&t?this.isUpsellApplicable(t.id!==D.default.NewBrandFRE):this.isUpsellApplicable(!1)};e.prototype._configureIsGuidedTourVisible=function(){var t=this;this._guidedTourOverride?this._activateGuidedTourExperimentWithoutLightbox():this._isUploadAvailable()?this._userInfoProvider.getGuidedTourCompleted().then(function(e){e||t._userInfoProvider.getGuidedTourViewCount().then(function(e){0<e&&e<3&&t._activateGuidedTourExperimentWithoutLightbox()})}):this._isGuidedTourVisible(!1)};e.prototype._activateGuidedTourExperimentWithoutLightbox=function(){this._isMobileAtStart||this._isGuidedTourVisible(!0)};e.prototype._configureAreOverrideParamsAvailable=function(){var e=this._storageOptionsProvider.isReady();if(this._freOverride)this._isFirstRunExperienceVisible(!0);else if(e)if(this._basicPositioningOverride){this._premiumUpsellType=1;this._isExistingUserPremiumUpsellEligible(!0)}else if(this._welcomeOverride){this._premiumUpsellType=3;this._isExistingUserPremiumUpsellEligible(!0)}else if(this._newFeaturesOverride){this._premiumUpsellType=5;this._isExistingUserPremiumUpsellEligible(!0)}};e.prototype._configureIsPremiumUpsellVisible=function(){this.itemSet.peek().content();this._storageOptionsProvider.isReady();this._isMobileAtStart||this._activatePremiumUpsell(this.item(),this.itemSet(),!1)};e.prototype._activatePremiumUpsell=function(e,t,i){var o=this;this._educationAndUpsells.getExistingUserTypeOfPremiumUpsell(e,t,i).then(function(e){null==e||o._freOverride||5!==(o._premiumUpsellType=e)&&6!==e&&1!==e&&3!==e||o._isExistingUserPremiumUpsellEligible(!0)})};e.prototype._configureIsFirstRunExperienceVisible=function(){var t=this,e=this.item(),i=this.resources.consume(S.isFirstRunExperienceVisible),o=this.itemSet();o.content();this._isMobileAtStart||this._educationAndUpsells.getIsNewUser(e,o).then(function(e){if(e){t._guidedTourUploadTimerStartTime=Date.now();t.createBackgroundComputed(function(){var e=t._bundleLoader.getBundleInfo(5).isLoaded();t._bundleLoader.loadNow("ET",function(){return new r.default(function(e,t){n(["ET"],e,t)})}).then(function(){if(e){t.resources.consume(l.guidedTour).setUploadTimerStartTime(t._guidedTourUploadTimerStartTime)}})});i(!0);t._isGuidedTourVisible(!0)}})};e.prototype._initializeFirstRunComponent=function(){var t=this,i=this._bundleLoader.getBundleInfo(5).isLoaded();this._isFirstRunExperienceVisible()?this._bundleLoader.loadNow("Fi",function(){return new r.default(function(e,t){n(["Fi"],e,t)})}).then(function(e){i&&t.firstRunComponent({name:e.tagName,params:{}})}):this._isExistingUserPremiumUpsellEligible()?this._bundleLoader.loadNow("aq1",function(){return new r.default(function(e,t){n(["aq1"],e,t)})}).then(function(e){i&&t.firstRunComponent({name:e.tagName,params:{upsellType:t._premiumUpsellType}})}):this.firstRunComponent(null)};e.prototype._initializeUpsellComponent=function(){var t=this,i=this._bundleLoader.getBundleInfo(5).isLoaded();this.isUpsellApplicable()&&this.upsell()?this._bundleLoader.loadNow("aqX",function(){return new r.default(function(e,t){n(["aqX"],e,t)})}).then(function(e){i&&t.upsellComponent({name:e.tagName,params:t.upsellParams})}):this.upsellComponent(null)};e.prototype._initializeGuidedTourComponent=function(){var t=this,i=this._bundleLoader.getBundleInfo(5).isLoaded();this._isGuidedTourVisible()?this._bundleLoader.loadNow("EZ",function(){return new r.default(function(e,t){n(["EZ"],e,t)})}).then(function(e){if(i){t.resources.consume(l.guidedTour).getDismissedThisSession()||t.guidedTourComponent({name:e.tagName,params:{onClose:t._onCloseGuidedTour.bind(t)}})}}):this.guidedTourComponent(null)};e.prototype._onCloseGuidedTour=function(){this.guidedTourComponent(null)};e.prototype._initializeMobileWebToAppUpsell=function(){this.isBannerApplicable&&(C.isFeatureEnabled(C.MobileWebToAppUpsellV2)?this._mobileWebToAppUpsellDismissed.peek()||this._initializeMobileWebToAppUpsellV2():this._initalizeSmartBanner())};e.prototype._initalizeSmartBanner=function(){var t=this,i=this._bundleLoader.getBundleInfo(1).isLoaded();this._bundleLoader.loadNow("Ew",function(){return new r.default(function(e,t){n(["Ew"],e,t)})}).then(function(e){if(i){t.smartBannerTagName=e.tagName;t.showSmartBanner(!0)}})};e.prototype._initializeMobileWebToAppUpsellV2=function(){if(this._bundleLoader.getBundleInfo(1).isLoaded()){this.mobileWebToAppUpsellV2={componentPath:"Es",getModule:function(){return new r.default(function(e,t){n(["Es"],e,t)})},props:{mobileWebToAppUpsellV2IsUseDialog:0<this.responsiveUI.compareSize(this.responsiveUI.formFactorSize.peek(),"Small"),mobileWebToAppUpsellV2ODBVersion:!1,mobileWebToAppUpsellV2OnClose:this.onDismissMobileWebToAppUpsellV2.bind(this),mobileWebToAppUpsellV2OnGetAppClick:this.onMobileWebToAppUpsellGetAppClick.bind(this),mobileWebToAppUpsellV2OnOpenAppClick:this.onMobileWebToAppUpsellOpenAppClick.bind(this)}};this.showMobileWebToAppUpsellV2(!0)}};e.prototype._activateUpdatedListViewExperiment=function(){var i=this,o=this.layoutType();this.trackPromise(this._bundleLoader.waitForPLT().then(function(){var e=window.optimizely,t=void 0===e?[]:e;if(o!==b.Details&&o!==b.CompactDetails||!C.isFeatureEnabled(C.EnableUpdatedFilesListView)){if(o===b.Grid&&C.isFeatureEnabled(C.UseTilesList)){t.push(["bucketVisitor",M.EXPERIMENT_ID,C.isFeatureEnabled(C.FlipOnNewGridAndListExperiment)?9183670501:9189200675]);i._experimentHelper.activateExperimentBehindFeature(C.UseTilesList,M.EXPERIMENT_ID).done()}}else{t.push(["bucketVisitor",A.EXPERIMENT_ID,C.isFeatureEnabled(C.FlipOnNewGridAndListExperiment)?9179970565:9186560432]);i._experimentHelper.activateExperimentBehindFeature(C.EnableUpdatedFilesListView,A.EXPERIMENT_ID).done()}}))};return e}(i.default);e.default=a});define("ahe",["require","exports","ap","bX","jG","dZ","afY","by","aC","qx","eL","dW","DP","jh","V","ahk","eO","aL","bR","Ei","ahh","ok","jH","eX","eR","eN","le","ahg","cY","ahf","b3","ru","jN"],function(e,t,i,u,d,c,o,p,m,n,g,r,f,a,s,h,y,w,_,b,v,S,x,C,I,D,k,l,T,A,M,R,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=function(l){i.__extends(t,l);function t(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=l.call(this,e,t)||this;i.addBindingHandlers({contextMenu:S.default,control:M.default});var o=i,n=o.resources,r=o.observables;i.loadingPromiseTracker=n.isExposed(u.promiseTracker)?n.consume(u.promiseTracker):n.expose(u.promiseTracker,new(i.managed(f.default)));i.itemProvider=n.consume(C.resourceKey);i._identityDataSource=n.consume(c.identity);i.urlDataSource=n.consume(c.url);i.viewParams=n.consume(u.viewParams);i.platform=n.consume(p.platformDetection);i._moveCopyHelper=new(i.managed(g.default));i.autoScrollEnabled=r.create(!1);i.autoScrollYPosition=r.create(0);i._createDataManager=i.createPureComputed(i._computeCreateDataManager);i._createDataManager.equalityComparer=_.objectStrictEquality;i.dataManager=i.createPureComputed(i._computeDataManager);i.dataManager.equalityComparer=_.objectStrictEquality;n.expose(d.sortManager,{updateSort:function(e,t){return i.dataManager.peek().updateSort(e,t)}});i.item=n.expose(u.currentItem,i.createPureComputed(i._computeItem));i.item.equalityComparer=_.objectStrictEquality;i.unmappedItemSet=i.createPureComputed(i._computeUnmappedItemSet);i.unmappedItemSet.equalityComparer=_.objectStrictEquality;i.dataManagerMapper=i.createObservable(new(i.managed(A.default))({itemSet:i.unmappedItemSet,requiredRange:i.createPureComputed(function(){return i.dataManager().requiredRange()})}));i.dataManagerMapper.equalityComparer=_.objectStrictEquality;i.createBackgroundComputed(i._computeUpdateDataManagerMapper);n.expose(u.currentDataManagerMapper,i.dataManagerMapper);i.itemSet=i.createPureComputed(i._computeItemSet);i.itemSet.equalityComparer=_.objectStrictEquality;n.expose(u.currentItemSet,i.itemSet);i.focusItem=i.createPureComputed(i._computeFocusItem);i.focusItem.equalityComparer=_.objectStrictEquality;i.error=n.expose(d.error,i.createPureComputed(i._computeError));i.error.equalityComparer=w.deepCompare;i._initializeRedirectAction();i._initializeAutoExecuteAction();i.isOneUp=i.createPureComputed(i.computeIsOneUp);i._initializeRange();i._initializeLayoutType();n.expose(d.files.layoutType,i.layoutType);i._indexResolver=n.expose(u.selectionIndexResolver,{isItemResolved:function(e){return i.dataManager.peek().isItemResolved(e)},resolveIndices:function(e){return i.dataManager.peek().resolveIndices(e)}});i._initializeItemSelectionModel(e);i.createBackgroundComputed(i._computeCollapseLeftNavOnViewChange);var a=n.consume(R.hasSelectionResourceKey);i.hasSelectionState=a;i.scope.attach(a.register(n.consume(P.hasSelectionResourceKey)));i.title=i.createPureComputed(i._computeTitle);i.isTitleVisible=i.createPureComputed(i._computeIsTitleVisible);i.createBackgroundComputed(i._computeSetDocumentTitle);var s=i._identityDataSource.getIdentity();s&&s.type!==T.IdentityType.anonymous&&i._checkForPendingOperations(I.IGetWorkProgressTypes.itemCopy);i._initializeFocusItemHelper();i.createBackgroundComputed(i._computeOneUpItemViewed).extend({rateLimit:{timeout:1e3,method:"notifyWhenChangesStop"}});i.isSmartBannerVisible=n.isExposed(d.base.isSmartBannerVisible)?n.consume(d.base.isSmartBannerVisible):n.expose(d.base.isSmartBannerVisible,r.create(!1));i._setUpSmartBanner();i._initializeOneUpParams();i.contentControl=i.createPureComputed(i._computeContentControl);i.hasContent=i.createPureComputed(function(){return!!i.contentControl()});return i}t.prototype.computeShouldSelectFocusItem=function(){return!this.isOneUp()&&-1<this.dataManager().focusItemIndexInItemSet()};t.prototype.computeCurrentPageName=function(){return"Default"};t.prototype.computeFocusPageName=function(){return"OneUp"};t.prototype.computeIsOneUp=function(){var e=this.focusItem(),t=(e||this.itemSet().item)(),i=!!this.error()||t.type===y.default.Error;return!(!this.urlDataSource.getFocusItemKey(this.viewParams())||!e||i||this.urlDataSource.getAutoActionType(this.viewParams()))};t.prototype.computeContentControl=function(){var e=this.error(),t=this.item();return t&&t.error&&4===t.error.type?M.toSpecification(v.resourceKey,this.getContentControlParams()):e?M.toSpecification(n.resourceKey,this._getErrorParams()()):void 0};t.prototype.getSelectionOptions=function(e){void 0===e&&(e={});return{}};t.prototype.computeReportPageView=function(){if(this.isOneUp()){var e=this.focusItem();e&&(e.peek().isPlaceholder?e():this.instrumentationProvider.userViewPage({viewParams:this.viewParams.peek(),item:e.peek(),name:this.computeCurrentPageName()+"-"+this.computeFocusPageName()}))}else{var t=this.itemSet(),i=t.item;i.peek().isPlaceholder?i():t.isPlaceholder?t.content():this.instrumentationProvider.userViewPage({viewParams:this.viewParams.peek(),item:i.peek(),name:this.computeCurrentPageName()})}};t.prototype.computeDataManagerMapper=function(){return new(this.managed(A.default))({itemSet:this.unmappedItemSet,requiredRange:this.dataManager().requiredRange})};t.prototype.getContentControlParams=function(){var e={};this.getContentControlParams=function(){return e};return e};t.prototype._getErrorParams=function(){var e=this,t=this.observables.pureCompute(function(){return{error:e.error()}});this._getErrorParams=function(){return t};return t};t.prototype._computeUpdateDataManagerMapper=function(){this.dataManagerMapper(this.computeDataManagerMapper())};t.prototype._initializeFocusItemHelper=function(){var e=this;return new(this.managed(b.default))({focusItem:this.focusItem,canSelect:function(){return e.computeShouldSelectFocusItem()}})};t.prototype._setUpSmartBanner=function(){this.isBannerApplicable=this.platform.isIOS||this.platform.isAndroid||this.platform.isWinPhone};t.prototype._computeContentControl=function(){var e=!this.item().isPlaceholder&&this._redirectAction.isAvailable();if(!this.dataManager().isActive()||e){return this.contentControl.peek()}return this.computeContentControl()};t.prototype._computeCreateDataManager=function(){var e=this.computeCreateDataManager();return e||this._createDataManager.peek()};t.prototype._computeDataManager=function(){var e=this._createDataManager(),t=this.dataManager.peek();t&&t.dispose();return e.call(this)};t.prototype._checkForPendingOperations=function(e){var d=this;return this.itemProvider.getWorkProgress({type:e}).then(function(e){if(e.progress){var u=new r.default;e.progress.map(function(a){if(a.status===D.ITaskStatuses[D.ITaskStatuses.InProgress]||a.status===D.ITaskStatuses[D.ITaskStatuses.NotStarted]){var s=d._extractCidFromResId(a.sourceResourceId),l=d._extractCidFromResId(a.targetResourceId);t._getWorkProgressQueue.enqueue(function(){var e,t,i={parentKey:d.urlDataSource.getKey((e={},e.id=a.sourceResourceId,e.cid=s,e))},o=d.itemProvider.getItem(i),n={parentKey:d.urlDataSource.getKey((t={},t.id=a.targetResourceId,t.cid=l,t))},r=d.itemProvider.getItem(n);return m.default.all([o,r]).then(function(e){if(e&&!(e&&e.length<2)){var t=e[0].item.peek(),i=e[1].item.peek();if(t&&i){var o={items:[t],parentKey:i.parent.key,targetId:i.id,targetKey:i.key,cid:l,group:t.isGroup?1:0,isMove:!1},n=d._moveCopyHelper.registerOperation(t,o,i,a.id,u);return d._moveCopyHelper.handleMoveCopyAsyncItems(o,[n],a.id)}}})})}})}},function(e){})};t.prototype._extractCidFromResId=function(e){return e.split("!")[0]};t.prototype._computeTitle=function(){var e=this.itemSet().item();return e.displayName||e.name||""};t.prototype._computeIsTitleVisible=function(){var e=this.itemSet().item(),t=!1;switch(e.virtualItemType){case h.default.AlbumRoot:case h.default.Tag:case h.default.Album:t=!0}return(!!e.displayName||!!e.name)&&(!e.parent||t)};t.prototype._computeSetDocumentTitle=function(){var e=this.focusItem()&&this.focusItem()()||this.itemSet().item(),t=e.displayName||e.name||"";document.title=t?s.format(o.strings.pageTitleFormat,t):o.strings.pageTitleDefault};t.prototype._computeItemSet=function(){return this.dataManagerMapper().mappedItemSet()};t.prototype._computeUnmappedItemSet=function(){return this.dataManager().itemSet()};t.prototype._computeItem=function(){return this.dataManager().item()};t.prototype._computeFocusItem=function(){return this.dataManager().focusItem()};t.prototype._computeError=function(){return this.dataManager().error()};t.prototype._computeOneUpItemViewed=function(){if(this.isOneUp()&&this.focusItem()&&!this.focusItem()().isPlaceholder){var e=this.focusItem.peek().peek();if(e.type!==y.default.Media)return;this.itemProvider.updateViewCount({items:[e]})}};t.prototype._initializeRange=function(){var t=this,e=this.observables;this.listRange=e.create({start:0,end:0});this.listRange.equalityComparer=w.deepCompare;this.resources.expose(d.contentRange,this.listRange);this.focusRange=e.create({start:0,end:0});this.focusRange.equalityComparer=w.deepCompare;this.createBackgroundComputed(function(){var e;if(t.item().isPlaceholder)e={start:0,end:0};else if(t.isOneUp()){e=t.focusRange();t.focusItem.peek()||(e=t.dataManagerMapper.peek().mappedRequiredRange.peek())}else e=t.listRange();t.dataManagerMapper().mappedRequiredRange(e)})};t.prototype._initializeLayoutType=function(){var t=this;this.layoutType=this.createComputed({read:function(){return t.dataManager().layoutType()},write:function(e){return t.dataManager.peek().layoutType(e)},pure:!0})};t.prototype._computeCollapseLeftNavOnViewChange=function(){this.dataManager().queryType();this.isLeftNavUserExpanded(!1)};t.prototype._initializeItemSelectionModel=function(e){var t=this;void 0===e&&(e={});var i=this.getSelectionOptions(e),o=this.createObservable();this.createBackgroundComputed(function(){o(t.itemSet())});this.itemSelectionModel=this.resources.expose(u.itemsSelection,new(this.managed(x.default))({itemSet:o,mode:i.mode,maximumSelectedCount:i.maximumSelectedCount,canSelectItem:i.canSelectItem,indexResolver:this._indexResolver}))};t.prototype._initializeAutoExecuteAction=function(){this._autoExecuteAction=new(this.managed(this.actionMap.AutoExecuteAction))({focusItem:this.focusItem});this.createBackgroundComputed(this._computeAutoExecuteAction).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}})};t.prototype._initializeRedirectAction=function(){var e=this;this._redirectAction=new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.createPureComputed(function(){return(e.focusItem()||e.itemSet().item)()}),itemSet:this.itemSet,preserveAction:!0,focusUrl:this.createPureComputed(function(){return!!e.urlDataSource.getAutoActionType(e.viewParams())||!!e.focusItem()}),ignoreHistory:!0,openLocal:!0});this.createBackgroundComputed(this._computeAttemptRedirectForItem).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})};t.prototype._computeAutoExecuteAction=function(){var e=this.itemSet().item;if(e.peek().isPlaceholder||this._redirectAction.isAvailable())e();else{if(!this.focusItem()||-1<this.dataManager().focusItemIndexInItemSet()){var t=this._autoExecuteAction;t.isAvailable.peek()?t.execute(null).done(function(){},function(){}):t.isAvailable()}}};t.prototype._computeAttemptRedirectForItem=function(){var e=this.focusItem()||this.itemSet().item;if(e.peek().isPlaceholder||this.itemSet().item.peek().isPlaceholder){e();e!==this.itemSet().item&&this.itemSet().item()}else{var t=this._redirectAction;if(t.isAvailable.peek()){this.viewParams();this.async.setTimeout(function(){t.isAvailable.peek()&&t.execute(null).done(function(){},function(){})},0)}}};t.prototype._initializeOneUpParams=function(){var t,i=this;t=this.createPureComputed(function(){var e=i.focusItem();return!e&&t?t.peek():e});this.resources.expose(u.focusItem,t);this.isOneUpSlideshow=this.createObservable(!1);this.oneUpSpecification=M.toSpecification(k.resourceKey,{requiredRange:this.focusRange,isSlideshow:this.isOneUpSlideshow})};t.MAX_CONCURRENT_GET_WORK_PROGRESS=4;t._getWorkProgressQueue=new a.default(t.MAX_CONCURRENT_GET_WORK_PROGRESS);return t}(l.default);t.default=E});define("ahk",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.AlbumRoot=0]="AlbumRoot";e[e.TagsRoot=1]="TagsRoot";e[e.Album=2]="Album";e[e.Tag=3]="Tag";e[e.FaceRoot=4]="FaceRoot"}(i||(i={}));t.default=i});define("ahh",["require","exports","ahj","b5","b3","ahi"],function(e,t,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o.registerComponent({tagName:"od-locked-page",template:e("ahi"),viewModel:i.default,synchronous:!0});t.resourceKey=n.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"od-locked-page",template:e("ahi"),viewModelType:i.default});t.default=r});define("ahj",["require","exports","ap","aC","bE","bF","c7","bX","d7"],function(i,e,t,o,r,n,a,s,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(n){t.__extends(e,n);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=n.call(this,e,t)||this;i._bundleLoader=i.resources.consume(l.bundleLoader);var o=i.resources.consume(s.promiseTracker);i._loaded=new r.default;o.registerPromise(i._loaded.getPromise());i.createComputed(i._compute);return i}e.prototype._compute=function(){var t=this;this._bundleLoader.getBundleInfo(3).isLoaded()&&a.loadModule({path:"ark",getModule:function(){return new o.default(function(e,t){i(["ark"],e,t)})}}).then(function(e){new(t.managed(e));t._loaded.complete()})};return e}(n.default);e.default=u});define("ahi",[],function(){return"<div class=od-LockedPage></div>"});define("ahg",["require","exports","ap","aq","bF","bX","jG","d5","a9","d7","by","ru"],function(e,t,i,r,o,a,s,l,u,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e,t){var i=n.call(this,e,t)||this;i.actionMap=i.resources.consume(a.actionMap);i.commandSet=i._exposeIfNeeded(s.base.commandBar.commandSet,r.observable(null));i.isTopBarHamburgerVisible=i._exposeIfNeeded(s.base.suiteNav.isTopBarHamburgerVisible,r.observable(!1));i.isTopBarVisible=i._exposeIfNeeded(s.base.suiteNav.isTopBarVisible,r.observable(!0));i.isTopBarVisible(!0);i.isLeftNavUserExpanded=i._exposeIfNeeded(s.base.leftNav.isLeftNavUserExpanded,r.observable(!1));i.isSuiteNavHamburgerVisible=i._exposeIfNeeded(s.base.suiteNav.isSuiteNavHamburgerVisible,r.observable(!1));i.supportHamburgerInSuiteNav=i._exposeIfNeeded(s.base.suiteNav.supportHamburgerInSuiteNav,!1);i.toggleIsLeftNavUserExpanded=i._exposeIfNeeded(s.base.leftNav.toggleIsLeftNavUserExpanded,function(){return null});i.hideLeftNav=i._exposeIfNeeded(s.base.leftNav.hideLeftNav,r.observable(!1));i.hideLeftNav(!1);i.isLeftNavVisible=i._exposeIfNeeded(s.base.leftNav.isLeftNavVisible,r.observable(!1));i.infoPane=i._exposeIfNeeded(s.base.infoPane.infoPane,null);i.hasSelectionState=i.resources.consume(p.hasSelectionResourceKey);i.pageType=i.resources.consume(a.currentPage);i.isInfoPaneExpanded=i._exposeIfNeeded(s.base.infoPane.isInfoPaneExpanded,r.observable(!1));i.isRetrievingData=i._exposeIfNeeded(s.base.isRetrievingData,r.observable(!1));i.responsiveUI=i.resources.consume(l.resourceKey);i.platform=i.resources.consume(c.platformDetection);i.isCommandBarDarkTheme=i._exposeIfNeeded(s.base.commandBar.isDarkTheme,r.observable(!1));i.isSuiteNavHidden=i._exposeIfNeeded(s.base.suiteNav.isSuiteNavHidden,r.observable(!0));var o=i.resources.consume(a.isWebViewHosted);i.isSuiteNavHidden(o);i.contextMenuHelper=i._exposeIfNeeded(s.base.contextMenuHelper,r.observable(null));i.viewParams=i.resources.consume(a.viewParams);i.isSearchHidden=i._exposeIfNeeded(s.base.commandBar.isSearchHidden,r.observable(!1));i.isSearchHidden(!1);i.instrumentationProvider=i.resources.consume(d.instrumentation);i.createBackgroundComputed(i.computeReportPageView).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}});i.infoPaneTransclusionContentParams={provider:i.infoPane};return i}e.prototype.computeReportPageView=function(){this.instrumentationProvider.userViewPage({viewParams:this.viewParams.peek(),name:this.computeCurrentPageName()})};e.prototype.computeCurrentPageName=function(){return u.default[this.pageType.peek()]};e.prototype._exposeIfNeeded=function(e,t){return this.resources.isExposed(e)?this.resources.consume(e):this.resources.expose(e,t)};return e}(o.default);t.default=n});define("ahf",["require","exports","ap","bN"],function(e,t,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.itemSet=e.itemSet;t.mappedItemSet=e.itemSet;t.mappedRequiredRange=e.requiredRange;t.refreshedItemSetFlag=t.createObservable(!1);return t}e.prototype.getOriginalItemIndexByMappedIndex=function(e){return e};e.prototype.getNewMappedIndexByOldIndex=function(e){return e};return e}(i.default);t.IdentityDataManagerMapper=n;t.default=n});define("ahb",["require","exports","ap","Bh","aC","dH","lb","jh","ahd","ahc","b9"],function(e,t,o,i,l,n,r,u,d,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._contextHelper=new(t.resources.injected(a.default));t._groupingType=t.createPureComputed(t._computeGroupingType,{deferEvaluation:!0});return t}e.prototype.resolveIndices=function(e){for(var t=this,i=new u.default(4),o=[],n=function(e){return function(){return t._resolveRange(e)}},r=0,a=d.createRanges(d.groupIndices(e,1e3));r<a.length;r++){var s=a[r];o.push(i.enqueue(n(s)))}return l.default.all(o).then(function(){})};e.prototype.amendCurrentContext=function(e){var t=this.itemSet.peek();t.schema.peek()&&t.schema.peek().length||(e.needSchema=!0)};e.prototype.getCurrentItemSetSync=function(e){return this.itemProvider.getItemSync(e)};e.prototype.getFocusItemSet=function(e){return this.getCurrentItemSet(e)};e.prototype.getCurrentItemSet=function(e){s.default.mark("DataManager.GetData.Started");return this.itemProvider.getItem(e)};e.prototype.computeCurrentContext=function(){var e,t=this.focusItemKey();t&&this.focusItemIndexInItemSet()<0&&(e=t);var i=this.requiredRange();return this._createGetItemContext(i,e)};e.prototype._computeGroupingType=function(){var e,t=this.queryType();if(t===n.default.Search||t===n.default.RecycleBin)e=0;else{switch(this.layoutType()){case r.Grid:case r.SingleAlbum:e=1;break;default:e=0}}return e};e.prototype._createGetItemContext=function(e,t){var i=this._contextHelper.getDefaultGetItemContext(this.viewParams());i.sortField=this.sortConfiguration().field;i.isAscending=this.sortConfiguration().isAscending;i.startIndex=e.start;i.endIndex=e.end;i.startKey=t;i.groupingType=this._groupingType();i.revision=this.referenceRevision();i.resultSetOptions=this.itemResultSetOptions;return i};e.prototype._resolveRange=function(e){var t=this._createGetItemContext(e);return this.getCurrentItemSet(t)};return e}(i.default);t.default=c});define("Bh",["require","exports","ap","aq","bX","d7","iJ","dZ","dc","by","aC","aL","aN","lb","dH","a9","a2","Bi","ba","eX","bR","bN","b9"],function(e,t,i,o,l,u,d,c,p,m,g,f,h,n,y,w,r,_,a,b,v,s,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x={timeout:0,method:"notifyWhenChangesStop"},C=a.isFeatureEnabled(a.CompactListViewInFiles),I=function(s){i.__extends(e,s);function e(e){void 0===e&&(e={});var t=s.call(this,e)||this,i=e.itemResultSetOptions,o=t,n=o.observables,r=o.resources;t.itemProvider=r.consume(b.resourceKey);t._itemsStore=r.consume(d.resourceKey);t.viewParams=r.consume(l.viewParams);t.urlDataSource=r.consume(c.url);t.platform=r.consume(m.platformDetection);t.navigation=r.consume(p.navigation);t.promiseTracker=r.consume(l.promiseTracker);t._loaderProvider=r.consume(u.bundleLoader);t.referenceItemSet=t._getReferenceItemSet();t.defaultLayoutType=_.GRID;t.itemResultSetOptions=i;t._pageType=r.consume(l.currentPage);t.isActive=n.pureCompute(t._computeIsActive);t.focusItemKey=n.pureCompute(t._computeFocusItemKey);t.currentItemKey=n.pureCompute(t._computeCurrentItemKey);t.itemSet=n.pureCompute(t._computeItemSet);t.itemSet.equalityComparer=v.objectStrictEquality;t.item=n.pureCompute(t._computeItem);t.item.equalityComparer=v.objectStrictEquality;t.error=n.create(null);var a=e.requiredPageType;t._requiredPageType=a;t._setupContextualQueryType();t.queryType=n.pureCompute(t._computeQueryType);t._layoutTypeTrigger=n.create({});t.layoutType=n.compute({read:t._computeLayoutType,write:t.updateLayoutType,deferEvaluation:!0,pure:!0});t._initializeRange();t.focusItemContext=n.pureCompute(t._computeFocusItemContext);t.focusItemContext.equalityComparer=f.deepCompare;t.focusItemIndexInItemSet=n.pureCompute(t._computeFocusItemIndexInItemSet);t.focusItemSet=n.pureCompute(t._computeFocusItemSet);t.focusItemSet.equalityComparer=v.objectStrictEquality;t.focusItem=n.pureCompute(t._computeFocusItem);t.focusItem.equalityComparer=v.objectStrictEquality;t._isFocusItemResolved=n.pureCompute(t._computeIsFocusItemResolved);t._temporarySortConfiguration=n.create();t._temporarySortConfiguration.equalityComparer=f.deepCompare;t.sortConfiguration=n.compute({read:t._computeSortConfiguration,write:t._temporarySortConfiguration,deferEvaluation:!0,pure:!0});t.sortConfiguration.equalityComparer=f.deepCompare;n.backgroundCompute(t._computeClearSortConfiguration);t.currentContext=n.pureCompute(t.computeCurrentContext);t.currentContext.equalityComparer=f.deepCompare;n.backgroundCompute(t._computeRefreshItemSet).extend({rateLimit:x});t.referenceRevision=n.pureCompute(t._computeReferenceRevision);return t}e.prototype.updateSort=function(e,t){this.sortConfiguration({field:e,isAscending:t})};e.prototype.getDefaultLayoutForView=function(){var e=this.queryType(),t=this.viewParams.peek(),i=this.urlDataSource.getLayoutContentType(t)||this._contextualQueryTypes[y.default[e]]||this.defaultLayoutType,o=e===y.default.Search&&this._pageType.peek()===w.default.Photos;return this.currentItemKey()===this.urlDataSource.getRootItemKey(y.default.SharedWithMe)?n.SharedGrid:i===_.GRID||o?n.Grid:i===_.LIST?n.Details:i===_.COMPACT_LIST?C?n.CompactDetails:n.Details:i===_.PHOTO?n.SingleAlbum:n.Details};e.prototype.isItemResolved=function(e){return e&&e.peek()&&!e.peek().isPlaceholder};e.prototype.resolveIndices=function(e){return g.default.wrap()};e.prototype.computeFocusContext=function(e){var t=this.urlDataSource.getKeyParams(e);return{parentKey:e,ownerId:this.urlDataSource.getOwnerId(e),queryType:this.urlDataSource.getQueryType(t),resultSetOptions:this.itemResultSetOptions,ignoreChildren:!0}};e.prototype.computeCurrentContext=function(){return null};e.prototype.getFocusItemSetSync=function(e){return this.itemProvider.getItemSync(e)};e.prototype.getCurrentItemSetSync=function(e){return null};e.prototype.getFocusItemSet=function(e){return this.itemProvider.getItem(e)};e.prototype.getCurrentItemSet=function(e){return g.default.wrap(null)};e.prototype.updateLayoutType=function(e,t){var i;switch(e){case n.Details:i=_.LIST;break;case n.CompactDetails:i=_.COMPACT_LIST;break;case n.SingleAlbum:i=_.PHOTO;break;default:i=_.GRID}t=t||this.queryType.peek();if(this.currentItemKey.peek()!==this.urlDataSource.getRootItemKey(y.default.SharedWithMe)){this._contextualQueryTypes[y.default[t]]=i;this._itemsStore.setValue(this._getSetViewLocalStorageKey(),this._contextualQueryTypes,r.default.local);this._layoutTypeTrigger({})}};e.prototype.amendCurrentContext=function(e){};e.prototype._computeItemSet=function(){var e=f.deepCopy(this.currentContext());if(this.isActive.peek()){return this.getCurrentItemSetSync(e)}return this.itemSet.peek()};e.prototype._computeItem=function(){var e=this.itemSet();return e&&e.item()};e.prototype._computeRefreshItemSet=function(){var t,i=this,e=this.itemSet(),o=f.deepCopy(this.currentContext()),n=e.item.peek();o.skipInMemoryCache=n.key!==this._lastRequestKey;this._lastRequestKey=n.key;o.revision&&(o.skipCache=!0);this.amendCurrentContext(o);if(this.isActive.peek())if(n.isPlaceholder&&!this._isFocusItemResolved()){var r=f.deepCopy(this.focusItemContext());t=this.getFocusItemSet(r)}else t=this.getCurrentItemSet(o);else t=null;var a=this.urlDataSource.getKeyParams(n.key),s=this.urlDataSource.getQueryType(a),l=this.focusItem.peek()?w.default[w.default.OneUp]:w.default[w.default.Files]+"-"+(y.default[s]||"Default");this._getItemPromise=t;if(this._getItemPromise){this.promiseTracker.registerPromise(t);this.error(null);this.trackPromise(t.then(function(e){if(t===i._getItemPromise){i._getItemPromise=null;S.default.mark("DataManager.GetData.Done")}},function(e){e.errorTitle||h.default.log(e);g.default.isCanceled(e)||i.error(e)}).then(function(){i.async.setTimeout(function(){i._loaderProvider.pageLoaded(l)},0)}))}};e.prototype._computeFocusItemContext=function(){var e=this.focusItemKey();return e?this.computeFocusContext(e):null};e.prototype._computeLayoutType=function(){this._layoutTypeTrigger();return this.getDefaultLayoutForView()};e.prototype._computeReferenceRevision=function(){var e=this.referenceItemSet(),t=e&&e.item&&this.itemProvider.getItemSync({parentKey:this.currentItemKey()}).item;return t&&t().revision||0};e.prototype._computeSortConfiguration=function(){var e=this._temporarySortConfiguration();if(e)return e;this.queryType();return{}};e.prototype._computeClearSortConfiguration=function(){this.currentItemKey();this._temporarySortConfiguration(void 0)};e.prototype._computeQueryType=function(){var e=this.referenceItemSet(),t=e&&e.item||this.itemProvider.getItemSync({parentKey:this.currentItemKey()}).item;return t?t().isPlaceholder?this.urlDataSource.getQueryType(this.urlDataSource.getKeyParams(t().key)):t().displayType:this.urlDataSource.getQueryType(this.urlDataSource.getKeyParams(this.currentItemKey()))};e.prototype._getSetViewLocalStorageKey=function(){return"OneDrive.Web.Files.FilesQueryType."+this.urlDataSource.getOwnerId("",this.viewParams.peek())};e.prototype._setupContextualQueryType=function(){this._contextualQueryTypes=i.__assign(((e={})[y.default[y.default.Photos]]=_.GRID,e[y.default[y.default.Files]]=_.GRID,e[y.default[y.default.Search]]=_.GRID,e[y.default[y.default.Recent]]=_.LIST,e[y.default[y.default.RecycleBin]]=_.LIST,e),this._itemsStore.getValue(this._getSetViewLocalStorageKey(),r.default.local)||{},((t={})[y.default[y.default.SharedWithMe]]=_.GRID,t));var e,t};e.prototype._computeFocusItemKey=function(){return this.urlDataSource.getFocusItemKey(this.viewParams())};e.prototype._computeCurrentItemKey=function(){return this.urlDataSource.getCurrentItemKey(this.viewParams())};e.prototype._computeFocusItemIndexInItemSet=function(){var e=this.focusItemContext();if(e)for(var t=this.referenceItemSet(),i=t&&t.content(),o=i&&i.items||[],n=0,r=Object.keys(o);n<r.length;n++){var a=r[n],s=Number(a),l=o[s],u=l&&l.peek();if(u&&this.urlDataSource.areKeysEqual(u.key,e.parentKey))return s}return-1};e.prototype._computeFocusItem=function(){if(!this.isActive())return this.focusItem.peek();var e=this.focusItemSet();if(e){var t=this.focusItemIndexInItemSet();if(-1<t){var i=e&&e.content();return(i&&i.items||[])[t]}return e.item}return null};e.prototype._computeFocusItemSet=function(){if(!this.isActive())return this.focusItemSet.peek();var e=this.focusItemContext();if(e){return-1<this.focusItemIndexInItemSet()?this.referenceItemSet():this.getFocusItemSetSync(e)}};e.prototype._computeIsFocusItemResolved=function(){var e=this.focusItem();return!e||!e().isPlaceholder&&!e().error};e.prototype._initializeRange=function(){this.requiredRange=o.observable({start:0,end:0});this.requiredRange.equalityComparer=f.deepCompare};e.prototype._computeIsActive=function(){var e=this.viewParams(),t=this.urlDataSource.getPageType(e);return!this._requiredPageType||t===this._requiredPageType};e.prototype._getReferenceItemSet=function(){var e,t=this,i=this.observables,o=i.create();i.backgroundCompute(function(){t.itemSet();e&&t.async.clearImmediate(e);e=t.async.setImmediate(function(){o(t.itemSet.peek());e=void 0})});return i.pureCompute(function(){var e=o();if(!e||e.item().key===t.currentItemKey())return e})};return e}(s.default);t.default=I});define("Bi",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LIST="List";t.COMPACT_LIST="CompactList";t.GRID="Grid";t.TILES="Tiles";t.PHOTO="Album"});define("ahd",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.groupIndices=function(e,t){void 0===t&&(t=1e3);for(var i=[],o=0,n=e;o<n.length;o++){var r=n[o],a=i[i.length-1];if(!a||r-a[0]>=t){a=[];i.push(a)}a.push(r)}return i};t.createRanges=function(e){for(var t=[],i=0,o=e;i<o.length;i++){var n=o[i],r={start:n[0],end:n[n.length-1]+1};t.push(r)}return t}});define("ahc",["require","exports","dH","Bi","dZ"],function(e,t,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._urlDataSource=this.resources.consume(i.url)}e.prototype.getDefaultGetItemContext=function(e){var t=this._urlDataSource.getCurrentItemKey(e),i=this._urlDataSource.getKeyParams(t),o=this._urlDataSource.getOwnerId(t,e),n=this._urlDataSource.getQueryType(i);return{groupingType:this._getGroupingType(o),isAscending:void 0,pageSize:this._getPageSize(n),ownerId:o,parentKey:t,queryType:n,resultSetOptions:void 0,revision:0,sortField:void 0,startIndex:0,startKey:void 0}};e.prototype._getPageSize=function(e){switch(e){case o.default.Search:return 50;default:return 100}};e.prototype._getGroupingType=function(e){var t=this._getLocalStorageValue("ItemsStoreonedrive.web.files.filesquerytype."+e.toLowerCase()),i=JSON.parse(t||"{}");return t&&i[o.default[o.default.Files]]!==n.GRID?0:1};e.prototype._getLocalStorageValue=function(e){try{return window.localStorage[e]}catch(e){return""}};return e}();t.default=r});define("ag6",["require","exports","ap","bN","FF","ou","afX","bX","d7","fH","dy","ag7","b3"],function(e,t,o,i,n,r,a,s,l,u,d,c,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._dropHelper=t.resources.consume(r.resourceKey);t._currentItem=t.resources.consume(s.currentItem);t._bundleLoader=t.resources.consume(l.bundleLoader);t._isDroppingTarget=t.createObservable(!1);t._quotaLoaded=t.createComputed(t._computeQuotaLoaded);t.events.on(window,a.DragAndDropEvents.onDragging,t._onDragging);t.events.on(window,a.DragAndDropEvents.onReceiveDrop,t._onReceiveDrop);t.events.on(window,a.DragAndDropEvents.onMayReceiveDrop,t._onMayReceiveDrop);t.hintComponent=t.createComputed(t._computeHintComponent);t.decorationComponent=t.createComputed(t._computeDecorationComponent);return t}e.prototype.getOptions=function(){return{mayReceiveDrop:this._onMayReceiveDrop,isDragging:this._onDragging,receiveDrop:this._onReceiveDrop}};e.prototype._onDragging=function(e){var t=e.args,i=t&&t.value,o=t&&t.data,n=i&&o&&0===o.dragData.type;this._isDroppingTarget(n)};e.prototype._onReceiveDrop=function(e){var t=e.args;return this._dropHelper.processDrop(t,this._currentItem.peek())};e.prototype._onMayReceiveDrop=function(e){var t=e.args,i=this._currentItem&&this._currentItem.peek&&this._currentItem.peek();return i&&t&&0===t.type?{targetName:i.name}:null};e.prototype._computeQuotaLoaded=function(){if(this._bundleLoader.getBundleInfo(3).isLoaded()){this._userStateProvider||(this._userStateProvider=this.resources.consume(l.quota));return!0}return!1};e.prototype._computeHintComponent=function(){return this._quotaLoaded()&&this._userStateProvider.status()>=n.default.full?null:{name:u.default.tagName,params:{}}};e.prototype._computeDecorationComponent=function(){if(!this._isDroppingTarget())return null;var e={message:d.strings.TargetFrameMessage,isError:!1};if(this._quotaLoaded()){var t=this._userStateProvider.accountState();if(2===t||3===t)return null;var i=this._userStateProvider.status();i===n.default.outOfSpace?e={message:d.strings.genericOverlayMessage,isError:!0}:i===n.default.full?e={message:d.strings.fullOverlayMessage,isError:!0}:i===n.default.overQuota&&(e={message:d.strings.exceedingOverlayMessage,isError:!0})}return p.toSpecification(c.resourceKey,e)};return e}(i.default);t.default=m});define("ag7",["require","exports","aha","b3","ag9","ag8"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-drag-and-drop-target-frame",name:e("module").id,template:e("ag9"),viewModelType:i.default});t.default=t.resourceKey});define("aha",["require","exports","ap","bF","cp","dy"],function(e,t,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this,o=e.message,n=void 0===o?s.strings.TargetFrameMessage:o;i.message=n;i.overlayComponent={name:a.default.tagName,params:{animation:{afterAdd:1,beforeRemove:300}}};i.classes={"od-DragAndDropTargetFrame-hasError":e.isError};return i}return e}(o.default);t.default=n});define("ag9",[],function(){return'\x3c!--ko component: overlayComponent--\x3e<div class=od-DragAndDropTargetFrame data-bind="css: classes"><div class=od-DragAndDropTargetFrame-header><div class=od-DragAndDropTargetFrame-message data-bind="text: message"></div></div></div>\x3c!--/ko--\x3e'});define("ag8",["c","az"],function(e,t){e.loadStyles([{rawString:".od-DragAndDropTargetFrame{position:absolute;box-sizing:border-box;top:0;left:0;right:0;bottom:0;border:3px solid "},{theme:"themeAccent",defaultValue:"#3a96dd"},{rawString:";border-top:none;pointer-events:none;transition:visibility 0s linear 167ms,opacity 167ms ease-out}.od-DragAndDropTargetFrame-hasError.od-DragAndDropTargetFrame{border:3px solid "},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-DragAndDropTargetFrame-header{height:50px;background-color:"},{theme:"themeAccent",defaultValue:"#3a96dd"},{rawString:";transition:transform 167ms cubic-bezier(.1,.25,.75,.9)}.od-DragAndDropTargetFrame-hasError .od-DragAndDropTargetFrame-header{background-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:'}.od-DragAndDropTargetFrame-message{text-align:center;line-height:45px;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-OverlayHost-overlay .od-DragAndDropTargetFrame{opacity:0;visibility:hidden}.od-OverlayHost-overlay .od-DragAndDropTargetFrame-header{-ms-transform:translate(0,-20px);transform:translate(0,-20px)}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-DragAndDropTargetFrame{opacity:.9;visibility:inherit;transition-delay:0s,0s}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-DragAndDropTargetFrame-header{-ms-transform:none;transform:none;transition-timing-function:ease-out}"}])});define("ag1",["require","exports","ap","aq","M5","M6","M7","dI","lb","dG","bX","rs","dm","M4","ag5","ag3","s5","ba","A5","dn","eE","sX","ae0","ag2"],function(e,t,o,P,E,F,i,L,O,V,U,N,n,B,H,W,q,K,G,z,r,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var j=n.strings,Q=K.isFeatureEnabled(K.CompactListViewInFiles),u=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._parentNavigation=!e.disableParentNavigation;t.resources.consumeAsync(l.resourceKey).then(function(e){t._officeUpsellLogger=e});t._initOptimizelyExperiments();t.filesCommandSetHelper=new(t.managed(G.default))({showLabels:t.responsiveUI.showLabels});t.buildCommands();return t}e.prototype.buildCommands=function(){var t=this,e=this.actionMap,i=this.resources,o=i.consume(U.currentItemSet),n=this.createPureComputed(function(){return t.filesCommandSetHelper.computeOpenInOfficeOnlineText()}),r=this.createPureComputed(function(){return t.filesCommandSetHelper.computeOpenInOfficeClientText()}),a=this.createPureComputed(function(){return t.filesCommandSetHelper.computeOfficeIcon()}),s=this.createPureComputed(function(){return t.filesCommandSetHelper.computeOfficeClass()}),l=[new(this.managed(N.CommandViewModel))({text:j.Create,tooltip:j.CreateCommandTooltip,icon:new L.default("Add"),renderLabel:2,isHidden:this.selectionModeOn,requiredChildren:1,automationId:"create",callback:function(){t._officeUpsellLogger&&t._officeUpsellLogger.logOptimizelyEvent("newCommandBar")},children:P.observableArray([new(this.managed(N.CommandViewModel))({text:j.CreateFolder,iconUrl:z.getIconUrl(i,"folder",16),hasLineBreakAfter:!0,action:new(this.managed(e.CreateFolderAction)),automationId:"createFolder"}),new(this.managed(N.CommandViewModel))({text:j.CreateWord,iconUrl:z.getIconUrl(i,"docx",16),action:new(this.managed(e.CreateDocumentAction))({docType:E.DocumentType.Word})}),new(this.managed(N.CommandViewModel))({text:j.CreateExcel,iconUrl:z.getIconUrl(i,"xlsx",16),action:new(this.managed(e.CreateDocumentAction))({docType:E.DocumentType.Excel})}),new(this.managed(N.CommandViewModel))({text:j.CreatePowerPoint,iconUrl:z.getIconUrl(i,"pptx",16),action:new(this.managed(e.CreateDocumentAction))({docType:E.DocumentType.PowerPoint})}),new(this.managed(N.CommandViewModel))({text:j.CreateOneNote,iconUrl:z.getIconUrl(i,"onetoc",16),action:new(this.managed(e.CreateDocumentAction))({docType:E.DocumentType.OneNote})}),new(this.managed(N.CommandViewModel))({text:j.CreateExcelSurvey,iconUrl:z.getIconUrl(i,"xlsx",16),action:new(this.managed(e.CreateDocumentAction))({docType:E.DocumentType.ExcelSurvey})}),new(this.managed(N.CommandViewModel))({text:j.CreateText,iconUrl:z.getIconUrl(i,"txt",16),action:new(this.managed(e.CreateDocumentAction))({docType:E.DocumentType.Text}),automationId:"createTextFile"}),new(this.managed(N.CommandViewModel))({text:j.downloadOffice,icon:new L.default("ThisPC"),action:new(this.managed(e.DownloadOfficeAction)),automationId:"downloadOffice",hasLineBreakBefore:!0})])}),new(this.managed(N.CommandViewModel))({text:j.Upload,tooltip:j.UploadCommandTooltip,icon:new L.default("Upload"),renderLabel:2,isHidden:this.selectionModeOn,requiredChildren:1,children:P.observableArray([new(this.managed(N.CommandViewModel))({text:j.UploadFile,collapsedText:P.observable(j.Upload),action:new(this.managed(e.UploadAction))({uploadProcessorType:V.UploadProcessorType.Html5file})}),new(this.managed(N.CommandViewModel))({text:j.UploadFolder,action:new(this.managed(e.UploadAction))({uploadProcessorType:V.UploadProcessorType.Folder})})])}),new(this.managed(N.CommandViewModel))({text:j.survey,icon:a,classSuffix:s,renderLabel:2,requiredChildren:1,children:P.observableArray([new(this.managed(N.CommandViewModel))({text:j.shareSurvey,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.SurveyAction))({actionType:1})}),new(this.managed(N.CommandViewModel))({text:j.viewSurvey,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.SurveyAction))({actionType:2})}),new(this.managed(N.CommandViewModel))({text:j.editSurvey,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.SurveyAction))({actionType:3})})])}),new(this.managed(N.CommandViewModel))({text:j.selectItems,renderLabel:2,icon:new L.default("CheckboxComposite"),action:new(this.managed(e.ToggleSelectionModeAction))}),new(this.managed(N.CommandViewModel))({text:j.Open,icon:a,classSuffix:s,renderLabel:2,requiredChildren:1,location:3,children:P.observableArray([new(this.managed(N.CommandViewModel))({text:n,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.OpenInOfficeOnlineAction))}),new(this.managed(N.CommandViewModel))({text:r,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.OpenInOfficeClientAction))}),new(this.managed(N.CommandViewModel))({text:j.OpenInBrowser,renderLabel:2,icon:new L.default("PDF"),action:new(this.managed(e.OpenPdfInBrowserAction))})])}),new(this.managed(N.CommandViewModel))({text:n,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.OpenInOfficeOnlineAction)),location:8}),new(this.managed(N.CommandViewModel))({text:r,renderLabel:2,icon:a,classSuffix:s,action:new(this.managed(e.OpenInOfficeClientAction)),location:8}),new(this.managed(N.CommandViewModel))({text:j.OpenInBrowser,renderLabel:2,icon:new L.default("PDF"),action:new(this.managed(e.OpenPdfInBrowserAction)),location:8}),new(this.managed(N.CommandViewModel))({text:j.OpenInTextEditor,renderLabel:2,icon:new L.default("Edit"),automationId:"textEditor",action:new(this.managed(e.OpenInTextEditorAction))}),new(this.managed(N.CommandViewModel))({text:j.Edit,icon:new L.default("EditNote"),renderLabel:2,action:new(this.managed(e.RedeemAction))}),new(this.managed(N.CommandViewModel))({text:j.SaveViewCommit,icon:new L.default("Save"),automationId:"save",renderLabel:2,action:new(this.managed(e.SaveAction))}),new(this.managed(N.CommandViewModel))({text:j.Preview,location:8,renderLabel:2,engagementName:"Preview",action:new(this.managed(e.PreviewAction))({})}),new(this.managed(N.CommandViewModel))({text:this._shareText,isHidden:this._shareHidden,tooltip:j.ShareCommandTooltipV3,renderLabel:2,icon:this._shareIcon,automationId:"share",keys:["S"],action:K.isFeatureEnabled(K.SharingDialogRedux)?new(this.managed(e.ShareByLinkAction)):new(this.managed(e.ShareAction))({activeTab:2})}),new(this.managed(N.CommandViewModel))({text:j.copyLink,isHidden:this._getALinkHidden,tooltip:j.CopyLinkCommandTooltipV3,renderLabel:2,iconUrl:z.getIconUrl(i,"link",16),action:K.isFeatureEnabled(K.SharingDialogRedux)?new(this.managed(e.ShareByLinkAction)):new(this.managed(e.ShareAction))({activeTab:2})})],u=[new(this.managed(N.CommandViewModel))({text:j.Download,renderLabel:2,icon:new L.default("Download"),action:new(this.managed(e.DownloadAction))}),new(this.managed(N.CommandViewModel))({text:j.emptyRecycleBin,renderLabel:2,icon:new L.default("Delete"),action:new(this.managed(e.EmptyRecycleBinAction))}),new(this.managed(N.CommandViewModel))({text:j.DeleteItem,renderLabel:2,icon:new L.default("Delete"),action:new(this.managed(e.DeleteAction)),keys:["MetaBackspace","Delete"],automationId:"delete"}),new(this.managed(N.CommandViewModel))({text:j.CreateMountPoint,renderLabel:2,icon:new L.default("OneDriveAdd"),action:new(this.managed(e.CreateMountPointAction)),automationId:"createMountPoint",resources:i}),new(this.managed(N.CommandViewModel))({text:j.RemoveMountPoint,renderLabel:2,icon:new L.default("Cancel"),action:new(this.managed(e.RemoveMountPointAction))}),new(this.managed(N.CommandViewModel))({text:j.Remove,icon:new L.default("Cancel"),renderLabel:2,action:new(this.managed(e.RemoveFromRecentAction))}),new(this.managed(N.CommandViewModel))({text:j.restoreAll,renderLabel:2,icon:new L.default("RevToggleKey"),action:new(this.managed(e.RestoreAllAction))}),new(this.managed(N.CommandViewModel))({text:j.restore,renderLabel:2,icon:new L.default("RevToggleKey"),action:new(this.managed(e.RestoreAction))}),new(this.managed(N.CommandViewModel))({text:j.Move,renderLabel:2,icon:new L.default("FabricMovetoFolder"),action:new(this.managed(e.LaunchMoveCopyPanelAction))({isMove:!0})}),new(this.managed(N.CommandViewModel))({text:j.Copy,renderLabel:2,icon:new L.default("Copy"),automationId:"copy",action:new(this.managed(e.LaunchMoveCopyPanelAction))({isMove:!1})}),new(this.managed(N.CommandViewModel))({text:j.Rename,renderLabel:2,icon:new L.default("Edit"),action:new(this.managed(e.RenameAction)),keys:["F2"],automationId:"rename"})],d=[new(this.managed(N.CommandViewModel))({text:j.addToSharedList,renderLabel:2,icon:new L.default("Add"),action:new(this.managed(e.AddToSharedListAction))}),new(this.managed(N.CommandViewModel))({text:j.removeFromSharedList,renderLabel:2,icon:new L.default("Cancel"),action:new(this.managed(e.RemoveFromSharedListAction))}),new(this.managed(N.CommandViewModel))({text:j.Play,renderLabel:2,icon:new L.default("Play"),action:new(this.managed(e.PlayAudioAction))}),new(this.managed(N.CommandViewModel))({text:j.createAlbumFromFolder,renderLabel:2,icon:new L.default("Picture"),action:new(this.managed(e.CreateAlbumFromFolderAction))}),new(this.managed(N.CommandViewModel))({text:j.AddToAlbum,renderLabel:2,icon:new L.default("Photo2Add"),action:new(this.managed(e.AddToAlbumAction))}),new(this.managed(N.CommandViewModel))({text:j.addAsCover,renderLabel:2,icon:new L.default("Picture"),action:new(this.managed(e.AddCoverPhotoAction))}),new(this.managed(N.CommandViewModel))({text:j.removeAsCover,renderLabel:2,icon:new L.default("Picture"),action:new(this.managed(e.RemoveCoverPhotoAction))}),new(this.managed(N.CommandViewModel))({text:j.editTags,renderLabel:2,icon:new L.default("Tag"),keys:["T"],action:new(this.managed(e.EditTagsAction))}),new(this.managed(N.CommandViewModel))({text:j.rotate,renderLabel:2,icon:new L.default("rotate"),action:new(this.managed(e.RotateAction))}),new(this.managed(N.CommandViewModel))({text:j.OrderPrints,icon:new L.default("Print"),renderLabel:2,action:new(this.managed(e.OrderPrintsAction))}),new(this.managed(N.CommandViewModel))({text:j.addToBundle,icon:new L.default("Add"),renderLabel:2,action:new(this.managed(e.AddToBundleAction))({})}),new(this.managed(N.CommandViewModel))({text:j.removeFromBundle,icon:new L.default("Cancel"),renderLabel:2,action:new(this.managed(e.RemoveFromBundleAction))({})}),new(this.managed(N.CommandViewModel))({text:j.Embed,icon:new L.default("Embed"),renderLabel:2,automationId:"embed",action:new(this.managed(e.EmbedAction))}),new(this.managed(N.CommandViewModel))({text:j.versionHistory,icon:new L.default("StackIndicator"),renderLabel:2,action:new(this.managed(e.ShowVersionHistoryAction))({})}),new(this.managed(N.CommandViewModel))({text:j.reportAbuse,icon:new L.default("EditNote"),renderLabel:2,action:new(this.managed(e.ReportAbuseAction))({})}),new(this.managed(N.CommandViewModel))({text:j.requestReview,icon:new L.default("EditNote"),renderLabel:2,action:new(this.managed(e.RequestReviewAction))({})}),new(this.managed(N.CommandViewModel))({text:j.viewInFolder,iconUrl:z.getIconUrl(i,"folder",16),action:new(this.managed(e.ViewInFolderAction)),renderLabel:2,automationId:"viewInFolder"}),this.overflowHostCommand,new(this.managed(q.default))({renderLabel:2}).command],c=new(this.managed(B.default))({currentItemSet:o,itemsToAppend:[new(this.managed(N.CommandViewModel))({text:j.SortAscending,isToggleable:!0,action:new(this.managed(e.OneDriveSortAction))({mode:F.default.Order,ascending:!0})}),new(this.managed(N.CommandViewModel))({text:j.SortDescending,isToggleable:!0,hasLineBreakAfter:!0,action:new(this.managed(e.OneDriveSortAction))({mode:F.default.Order,ascending:!1})}),new(this.managed(N.CommandViewModel))({text:j.Rearrange,isToggleable:!1,hasLineBreakAfter:!0,action:new(this.managed(e.RearrangeAction))({})}),new(this.managed(N.CommandViewModel))({text:j.SaveSortOrder,isToggleable:!1,action:new(this.managed(e.SaveSortOrderAction))})]}),p=new(this.managed(N.CommandViewModel))({text:j.Sort,renderLabel:2,icon:new L.default("SortLines"),isHidden:this.selectionModeOn,requiredChildren:1,children:c.sortItems,location:4}),m=P.observable(!1),g=new(this.managed(H.default))({showCurrentView:m}),f=new(this.managed(N.CommandViewModel))({text:j.Type,renderLabel:2,isHidden:this.selectionModeOn,icon:this.createPureComputed(function(){return t.responsiveUI.showLabels()?void 0:new L.default("Filter")}),isCurrentView:m,requiredChildren:1,children:g&&g.filterItems}),h=P.observable(!1),y=new(this.managed(W.default))({showCurrentView:h}),w=new(this.managed(N.CommandViewModel))({text:j.date,renderLabel:2,isHidden:this.selectionModeOn,icon:this.createPureComputed(function(){return t.responsiveUI.showLabels()?void 0:new L.default("Clock")}),isCurrentView:h,requiredChildren:1,children:y&&y.filterItems});l.push(f);l.push(w);var _=this.createPureComputed(function(){return t.filesCommandSetHelper.showSelectionActionText()}),b=new(this.managed(N.CommandViewModel))({text:j.ViewList,tooltip:j.ViewListCommandTooltip,icon:new L.default(G.default.detailsIcon),isToggleable:!0,location:4,isHidden:this.selectionModeOn,action:new(this.managed(e.ToggleListLayoutAction))({layoutType:O.Details}),automationId:"switchLayout",engagementName:"ViewList"}),v=new(this.managed(N.CommandViewModel))({text:j.ViewCompactList,tooltip:j.ViewCompactListCommandTooltip,icon:new L.default(G.default.compactDetailsIcon),isToggleable:!0,location:4,isHidden:this.selectionModeOn,action:new(this.managed(e.ToggleListLayoutAction))({layoutType:O.CompactDetails}),automationId:"switchLayout",engagementName:"ViewCompactList"}),S=new(this.managed(N.CommandViewModel))({text:j.ViewGrid,tooltip:j.ViewGridCommandTooltip,icon:new L.default(G.default.gridIcon),isToggleable:!0,isHidden:this.selectionModeOn,action:new(this.managed(e.ToggleListLayoutAction))({layoutType:O.Grid}),automationId:"switchLayout",location:4,engagementName:"ViewGrid"}),x=new(this.managed(N.CommandViewModel))({text:j.ViewPhoto,tooltip:j.ViewPhotoCommandTooltip,icon:new L.default(G.default.singleAlbumIcon),isToggleable:!0,isHidden:this.selectionModeOn,action:new(this.managed(e.ToggleListLayoutAction))({layoutType:O.SingleAlbum}),automationId:"switchLayout",location:4}),C=new(this.managed(N.CommandViewModel))({renderLabel:0,icon:this.createComputed(function(){return t.filesCommandSetHelper.computeViewSelectorIcon()}),isHidden:this.selectionModeOn,hasIconOnly:!0,location:4,requiredChildren:2,children:P.observableArray([b].concat(Q?[v]:[],[S],[x])),automationId:"switchLayoutSwitcher",text:j.Views,tooltip:j.ViewsCommandTooltip}),I=new(this.managed(N.CommandViewModel))({text:_,tooltip:j.showSelection,isHidden:this.selectionModeOff,icon:new L.default("Cancel"),location:4,positionIconRight:!0,action:new(this.managed(e.ShowSelectionAction)),keys:["CtrlD","MetaD"],automationId:"deselectAll"}),D=new(this.managed(N.CommandViewModel))({text:j.Details,icon:new L.default("Info"),location:12,action:new(this.managed(e.ShowPropertiesAction))({useToggleBehavior:!0}),renderLabel:0,hasIconOnly:!0,keys:["I"],automationId:"showProperties"}),k=new(this.managed(N.CommandViewModel))({location:0,action:new(this.managed(e.OpenAction))({openRelation:3}),keys:["AltUp"]}),T=new(this.managed(N.CommandViewModel))({location:0,action:new(this.managed(e.ShowKeyboardMapAction)),keys:["Shift/"]}),A=new(this.managed(N.CommandViewModel))({location:0,action:new(this.managed(e.SetFocusAction))({selector:".od-SearchBox-input"}),keys:["/"]}),M=new(this.managed(N.CommandViewModel))({location:0,action:new(this.managed(e.SelectAllAction)),keys:["CtrlA","MetaA"]}),R=[l,u,d,[p].concat([C],[I,D],this._parentNavigation?[k]:[],[T,A,M])].map(function(e){return t.createObservable(e)});this.commandSets(R)};e.prototype._initOptimizelyExperiments=function(){var i=this;this._shareIcon=P.observable(new L.default("Share"));this._shareText=P.observable(j.Share);this._shareHidden=P.observable(!1);this._getALinkHidden=P.observable(!0);r.OptimizelyHelper.GetVariationIdsMapForExperiment(r.OptimizelyHelper.SHARE_EXPERIMENT_ID).done(function(e){if(e&&e.length){var t=parseInt(e[0],10);if(t===r.OptimizelyHelper.SHARE_VARIATION_LINK_ID){i._shareHidden(!0);i._getALinkHidden(!1)}else if(t===r.OptimizelyHelper.SHARE_VARIATION_SHARE_LINK_ID)i._getALinkHidden(!1);else if(t===r.OptimizelyHelper.SHARE_VARIATION_EMAIL_ID){i._shareIcon(new L.default("Mail"));i._shareText(a.strings.extractedTextEmailTypeName);i._getALinkHidden(!1)}else if(t===r.OptimizelyHelper.SHARE_VARIATION_INVITE_ID){i._shareIcon(new L.default("PeopleAdd"));i._shareText(s.strings.AddEditors);i._getALinkHidden(!1)}}})};return e}(i.default);t.default=u});define("ag5",["require","exports","ap","bF","p3","aq","bX","dm","dI","ag4"],function(e,t,i,o,s,l,u,n,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=n.strings,r=function(a){i.__extends(e,a);function e(e){var t=a.call(this,e)||this;t._filterTypes=[{type:c.SearchFilterType.all,icon:void 0},{type:c.SearchFilterType.photos,icon:new d.default("Picture")},{type:c.SearchFilterType.documents,icon:new d.default("Documentation")},{type:c.SearchFilterType.music,icon:new d.default("MusicInCollection")},{type:c.SearchFilterType.folders,icon:new d.default("Folder")}];t._actionMap=t.resources.consume(u.actionMap);t.filterItems=l.observableArray();for(var i=[],o=0,n=t._filterTypes;o<n.length;o++){var r=n[o];i.push(new s.default({text:p[c.SearchFilterType[r.type].replace(/(\w)(\w*)/g,function(e,t,i){return t.toUpperCase()+i.toLowerCase()})],isToggleable:!0,icon:r.icon,action:new(t.managed(t._actionMap.FilterSearchAction))({filter:r.type,showCurrentView:e.showCurrentView}),hasLineBreakAfter:!1}))}t.filterItems(i);return t}return e}(o.default);t.default=r});define("ag4",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.all=0]="all";e[e.folders=1]="folders";e[e.photos=2]="photos";e[e.documents=3]="documents";e[e.music=4]="music"}(t.SearchFilterType||(t.SearchFilterType={}));!function(e){e[e.anyDate=0]="anyDate";e[e.oneDay=1]="oneDay";e[e.oneWeek=2]="oneWeek";e[e.oneMonth=3]="oneMonth";e[e.oneYear=4]="oneYear"}(t.SearchFilterDateType||(t.SearchFilterDateType={}))});define("ag3",["require","exports","ap","bN","p3","aq","bX","dm","ag4"],function(e,t,i,o,s,l,u,n,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=n.strings,r=function(a){i.__extends(e,a);function e(e){var t=a.call(this,e)||this;t._actionMap=t.resources.consume(u.actionMap);t.filterItems=l.observableArray();for(var i=[],o=0,n=Object.keys(d.SearchFilterDateType).filter(function(e){return isNaN(parseInt(e,10))});o<n.length;o++){var r=n[o];i.push(new s.default({text:c[r],isToggleable:!0,action:new(t.managed(t._actionMap.FilterSearchByDateAction))({filter:d.SearchFilterDateType[r],showCurrentView:e.showCurrentView}),hasLineBreakAfter:!1}))}t.filterItems(i);return t}return e}(o.default);t.default=r});define("ag2",["require","exports","aC","bA","c7"],function(i,e,t,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:i("module").id,loader:new o.AliasResourceLoader(function(){return n.loadModuleExport({path:"arL",getModule:function(){return new t.default(function(e,t){i(["arL"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("agX",["require","exports","ag0","b3","agZ","agY","pD","pG","zR"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"od-folder-item-content",template:e("agZ"),viewModelType:i.default})});define("ag0",["require","exports","ap","bF","bX","jG","zQ","b3","pX","qg","qq","dG","dZ","d7","ij","Lk","ba"],function(e,t,i,o,a,s,l,u,d,c,p,m,g,f,n,h,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i.addBindingHandlers({control:u.default});i._urlDataSource=i.resources.consume(g.url);i.breadcrumbBarTagName=d.default.tagName;i.emptyFolderControl=u.toSpecification(l.resourceKey,{isViewOnly:i.createPureComputed(i._computeIsViewOnly,{deferEvaluation:!0})});i.isQuotaBarVisible=i.createObservable(!1);var o=i.resources.consume(a.actionMap);i._uploadAction=new(i.managed(o.UploadAction))({uploadProcessorType:m.UploadProcessorType.Html5file});i.sharedIndicatorTagName=c.default.tagName;i.isShowSharedIndicator=i.createPureComputed(i._computeIsShowSharedIndicator);i._itemSetMonitor=i.resources.consume(p.resourceKey);i.footerItem=e.footerItem;i.itemSet=i._itemSetMonitor.itemSet;i.itemSetSelectionModel=i.resources.consume(a.itemsSelection);i.contentRange=i.resources.consume(s.contentRange);i.layoutType=i.resources.consume(h.resolvedLayoutTypeResourceKey);i.listViewContextMenuHelper=i.resources.isExposed(s.listViewContextMenuHelper)?i.resources.consume(s.listViewContextMenuHelper):void 0;i.title=i._itemSetMonitor.name;i.showBreadcrumb=i._itemSetMonitor.hasParent;i.showEmpty=i._itemSetMonitor.isEmpty;i.showList=i.observables.pureCompute(i._computeShowList);i.item=i._itemSetMonitor.item;i.showTitle=i.createPureComputed(i._computeShowTitle,{deferEvaluation:!0});var n=i.resources.consume(f.bundleLoader);i.createComputed(function(){var e=n&&n.getBundleInfo(3);e&&e.isLoaded()&&(i.itemSet()&&i._urlDataSource.isSearchPassThrough()?i.isQuotaBarVisible(!0):i.isQuotaBarVisible(!1))});return i}e.prototype._computeShowList=function(){return!!this.layoutType()&&this._itemSetMonitor.hasItems()};e.prototype._computeShowTitle=function(){return this._itemSetMonitor.hasName()&&!this._itemSetMonitor.hasParent()};e.prototype._computeIsViewOnly=function(){return!this._uploadAction.isAvailable()};e.prototype._computeIsShowSharedIndicator=function(){if(y.isFeatureEnabled(y.EnableFolderShareAccessHint)){var e=this.item().sharingType;return e===n.default.Shared||e===n.default.Public||e===n.default.PublicUnlisted}return!1};return e}(o.default);t.default=r});define("zQ",["require","exports","qN","b3","qK","qJ"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"ms-empty-folder",name:e("module").id,template:e("qK"),viewModelType:i.default});t.default=t.resourceKey});define("agZ",[],function(){return'<div class="od-FolderItemContent od-ItemContent">\x3c!--ko if: showTitle() || showBreadcrumb()--\x3e<div class="od-FolderItemContent-header od-ItemContent-header">\x3c!--ko if: showTitle--\x3e<h2 class="od-FolderItemContent-title od-ItemContent-title" data-bind="text: title"></h2>\x3c!--/ko--\x3e\x3c!--ko if: showBreadcrumb--\x3e<div class="od-FolderItemContent-breadcrumb od-ItemContent-breadcrumb" data-bind="component: { name: breadcrumbBarTagName, params: { item: item } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: isShowSharedIndicator--\x3e<div class=od-ItemContent-header-sharedIndicator data-bind="component: { name: sharedIndicatorTagName, params: { item: item } }"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: isQuotaBarVisible--\x3e<div class=od-ItemContent-progress data-bind="component: { name: \'od-quota-progress-bar\' }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showList--\x3e<div class="od-FolderItemContent-list od-ItemContent-list" data-bind="component: { name: layoutType, params: { itemSet: itemSet, selectionModel: itemSetSelectionModel, requiredRange: contentRange, enableMarqueeSelection: true, contextMenuHelper: listViewContextMenuHelper, footerItem: footerItem } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showEmpty--\x3e<div class="od-FolderItemContent-empty od-ItemContent-empty" data-bind="control: emptyFolderControl"></div>\x3c!--/ko--\x3e</div>'});define("agY",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-ItemContent-header{box-sizing:border-box;padding-top:10px;padding-bottom:10px}.xlg .od-ItemContent-header,.xxlg .od-ItemContent-header,.xxxlg .od-ItemContent-header,.xxxxlg .od-ItemContent-header{padding-top:23px;padding-bottom:0}.od-ItemContent-progress{height:31px;padding-top:10px;padding-bottom:10px}[dir=ltr] .od-ItemContent-progress{padding-left:32px}[dir=rtl] .od-ItemContent-progress{padding-right:32px}[dir=ltr] .od-ItemContent-progress{padding-right:32px}[dir=rtl] .od-ItemContent-progress{padding-left:32px}[dir=ltr] .md .od-ItemContent-progress,[dir=ltr] .sm .od-ItemContent-progress{padding-left:16px}[dir=rtl] .md .od-ItemContent-progress,[dir=rtl] .sm .od-ItemContent-progress{padding-right:16px}[dir=ltr] .md .od-ItemContent-progress,[dir=ltr] .sm .od-ItemContent-progress{padding-right:16px}[dir=rtl] .md .od-ItemContent-progress,[dir=rtl] .sm .od-ItemContent-progress{padding-left:16px}.od-ItemContent-title{margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400}.lg .od-ItemContent-title,.md .od-ItemContent-title,.sm .od-ItemContent-title{font-weight:300}.xlg .od-ItemContent-title,.xxlg .od-ItemContent-title,.xxxlg .od-ItemContent-title,.xxxxlg .od-ItemContent-title{font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:28px;font-weight:400}.od-ItemContent-breadcrumb{font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;font-weight:400;display:inline-block}.md .od-ItemContent-breadcrumb,.sm .od-ItemContent-breadcrumb{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}.xlg .od-ItemContent-breadcrumb,.xxlg .od-ItemContent-breadcrumb,.xxxlg .od-ItemContent-breadcrumb,.xxxxlg .od-ItemContent-breadcrumb{font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400;margin-bottom:1px}.xlg .od-ItemContent-list,.xxlg .od-ItemContent-list,.xxxlg .od-ItemContent-list,.xxxxlg .od-ItemContent-list{padding-top:20px}[dir=ltr] .od-ItemContent-header,[dir=ltr] .od-ItemContent-list{padding-left:32px}[dir=rtl] .od-ItemContent-header,[dir=rtl] .od-ItemContent-list{padding-right:32px}[dir=ltr] .od-ItemContent-header,[dir=ltr] .od-ItemContent-list{padding-right:32px}[dir=rtl] .od-ItemContent-header,[dir=rtl] .od-ItemContent-list{padding-left:32px}[dir=ltr] .xlg .od-ItemContent-header,[dir=ltr] .xlg .od-ItemContent-list,[dir=ltr] .xxlg .od-ItemContent-header,[dir=ltr] .xxlg .od-ItemContent-list,[dir=ltr] .xxxlg .od-ItemContent-header,[dir=ltr] .xxxlg .od-ItemContent-list,[dir=ltr] .xxxxlg .od-ItemContent-header,[dir=ltr] .xxxxlg .od-ItemContent-list{padding-left:32px}[dir=rtl] .xlg .od-ItemContent-header,[dir=rtl] .xlg .od-ItemContent-list,[dir=rtl] .xxlg .od-ItemContent-header,[dir=rtl] .xxlg .od-ItemContent-list,[dir=rtl] .xxxlg .od-ItemContent-header,[dir=rtl] .xxxlg .od-ItemContent-list,[dir=rtl] .xxxxlg .od-ItemContent-header,[dir=rtl] .xxxxlg .od-ItemContent-list{padding-right:32px}[dir=ltr] .xlg .od-ItemContent-header,[dir=ltr] .xlg .od-ItemContent-list,[dir=ltr] .xxlg .od-ItemContent-header,[dir=ltr] .xxlg .od-ItemContent-list,[dir=ltr] .xxxlg .od-ItemContent-header,[dir=ltr] .xxxlg .od-ItemContent-list,[dir=ltr] .xxxxlg .od-ItemContent-header,[dir=ltr] .xxxxlg .od-ItemContent-list{padding-right:32px}[dir=rtl] .xlg .od-ItemContent-header,[dir=rtl] .xlg .od-ItemContent-list,[dir=rtl] .xxlg .od-ItemContent-header,[dir=rtl] .xxlg .od-ItemContent-list,[dir=rtl] .xxxlg .od-ItemContent-header,[dir=rtl] .xxxlg .od-ItemContent-list,[dir=rtl] .xxxxlg .od-ItemContent-header,[dir=rtl] .xxxxlg .od-ItemContent-list{padding-left:32px}[dir=ltr] .md .od-ItemContent-header,[dir=ltr] .md .od-ItemContent-list,[dir=ltr] .sm .od-ItemContent-header,[dir=ltr] .sm .od-ItemContent-list{padding-left:16px}[dir=rtl] .md .od-ItemContent-header,[dir=rtl] .md .od-ItemContent-list,[dir=rtl] .sm .od-ItemContent-header,[dir=rtl] .sm .od-ItemContent-list{padding-right:16px}[dir=ltr] .md .od-ItemContent-header,[dir=ltr] .md .od-ItemContent-list,[dir=ltr] .sm .od-ItemContent-header,[dir=ltr] .sm .od-ItemContent-list{padding-right:16px}[dir=rtl] .md .od-ItemContent-header,[dir=rtl] .md .od-ItemContent-list,[dir=rtl] .sm .od-ItemContent-header,[dir=rtl] .sm .od-ItemContent-list{padding-left:16px}.od-ItemContent-header-sharedIndicator{display:inline-block;position:relative}.xlg .od-ItemContent-header-sharedIndicator,.xxlg .od-ItemContent-header-sharedIndicator,.xxxlg .od-ItemContent-header-sharedIndicator,.xxxxlg .od-ItemContent-header-sharedIndicator{top:-5px}.md .od-ItemContent-header-sharedIndicator,.sm .od-ItemContent-header-sharedIndicator{top:-6px}.lg .od-ItemContent-header-sharedIndicator{top:-4px}'}])});define("zR",["require","exports","aq","zS","aC","ba","on","yq","pE","yQ"],function(i,e,t,o,n,r,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=window._spPageContextInfo,l=!s||"21"===s.webTemplate,u=r.isFeatureEnabled(r.UseReactGridList)&&!l?a.createComponent("ms-grid-list","azv",function(){return new n.default(function(e,t){i(["azv"],e,t)})}):{tagName:"ms-grid-list",template:i("yq"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(o.default))(e,t)}},synchronous:!0};t.components.isRegistered(u.tagName)||t.components.register(u.tagName,u);e.default=u});define("zS",["require","exports","ap","y8","yF"],function(e,t,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i.initialize(new(i.managed(n.default))(e));return i}return e}(o.default);t.default=r});define("agW",["require","exports","aC","c7","bA"],function(i,e,t,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new n.ResourceKey({name:i("module").id,loader:new n.AliasResourceLoader(function(){return o.loadModuleExport({path:"amm",getModule:function(){return new t.default(function(e,t){i(["amm"],e,t)})},getExport:function(e){return e.resourceKey.local}})})})});define("agV",["require","exports","ap","bN","gb","ga","bA","dc","d7","dZ","aC","ba"],function(e,t,i,o,n,r,a,s,l,u,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new a.ResourceKey("EducationAndUpsells");var p=function(o){i.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this;t._userInfoProvider=t.resources.consume(l.userInfo);t._storageOptionsProvider=t.resources.consume(l.storageOptions);t._urlDataSource=t.resources.consume(u.url);var i=t.resources.consume(s.navigation);t._newUserOverride=i.viewParams.forceNewUser;return t}e.prototype.getExistingUserTypeOfPremiumUpsell=function(e,t,i){var o=this;void 0===i&&(i=!1);return e.key!==this._urlDataSource.getRootItemKey()||t.isExpired||t.isPlaceholder||!i&&this._determineIfNewlyCreatedAccount(!0,t)?d.default.wrap():this._userInfoProvider.getPremiumUpsellsViewed().then(function(e){if(o._storageOptionsProvider.isReady())if(o._storageOptionsProvider.isEligibleForPremium()){if(!e.hasPositioningViewed)return 1;if(!e.hasNewFeaturesViewed)return 5}else{if(!e.hasPositioningViewed)return 3;if(c.isFeatureEnabled(c.EnableSecurityMomentLightbox)&&!e.hasNewFeaturesViewed)return 6}})};e.prototype.getAreNoFilesAdded=function(e){if(this._newUserOverride)return!0;for(var t=0,i=0,o=0,n=e.content().items;o<n.length;o++){var r=n[o];if(void 0===r)return!1;if(r().folder){t++;if(0<r().childCount)return!1}else i++;if(2<t||1<i)return!1}return!0};e.prototype.getIsNewUser=function(e,t){var i=this._userInfoProvider;return this._newUserOverride?i.getUserInfo(!1).then(function(){return!0}):e.key===this._urlDataSource.getRootItemKey()&&e.childCount<=3&&!t.isPlaceholder&&!t.isExpired&&this.getAreNoFilesAdded(t)&&this._determineIfNewlyCreatedAccount(!1,t)?d.default.all([i.getUpsellViewCount(r.default[n.default.NewBrandFRE]),i.getFirstRunExperienceViewCount(),i.getGuidedTourViewCount()]).then(function(e){return e.every(function(e){return 0===e})}):d.default.wrap(!1)};e.prototype._determineIfNewlyCreatedAccount=function(e,t){if(this._newUserOverride)return!0;var i=t.content().items,o=Date.now();if(0===i.length)return e;for(var n=0,r=i;n<r.length;n++){var a=r[n];if(void 0===a)return e;var s=a().dateCreatedTime;if(!s)return e;if(864e5<o-s.getTime())return!1}return!0};return e}(o.default);t.default=p});define("agU",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EXPERIMENT_ID=9187370220});define("agT",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EXPERIMENT_ID=9177020308});define("agI",["require","exports","b5","agL","agK","agJ"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LAST_SIGN_IN_DIALOG=o.LAST_SIGN_IN_DIALOG;var n=i.registerComponent({tagName:"od-unauthenticated-banner",template:e("agK"),viewModel:o.default,synchronous:!0});t.default=n});define("agL",["require","exports","ap","bF","dc","bX","agS","a3","a2","agN","agM","d5","ba"],function(e,l,t,i,u,d,c,p,m,g,o,f,h){"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.LAST_SIGN_IN_DIALOG="lastSignInDialog";var y=864e5,n=function(s){t.__extends(e,s);function e(e){void 0===e&&(e={});var t=s.call(this,e)||this;t.signUpURL="https://go.microsoft.com/fwlink/?linkid=853248";var i=encodeURIComponent(window.location.href);t.signInURL="https://login.live.com/login.srf?wa=wsignin1.0&wreply="+i;t.homePageURL="https://go.microsoft.com/fwlink/?linkid=853503";t.brandingString=c.strings.brandingString;t.signIn=c.strings.signIn;t.signInDialogTagName=g.default.tagName;t.signUp=c.strings.signUp;t._actionMap=t.resources.consume(d.actionMap);t._responsiveUI=t.resources.consume(f.resourceKey);t._navigation=t.resources.consume(u.navigation);t._onClickSignUpAction=new(t.managed(t._actionMap.NavigationAction))({url:t.signUpURL});t._onClickSignInAction=new(t.managed(t._actionMap.NavigationAction))({url:t.signInURL});t._onClickOneDriveAction=new(t.managed(t._actionMap.NavigationAction))({url:t.homePageURL});t.showCloseButton=t.createObservable(!0);t.onClickClose=t.onClickClose.bind(t);t._dataStore=new p.default("SignInDialogCounter",m.default.local);var o=t._dataStore.getValue(l.LAST_SIGN_IN_DIALOG),n=0<t._responsiveUI.compareSize(t._responsiveUI.formFactorSize.peek(),"Small"),r=t.resources.consume(d.didUserEnterPasswordForFile),a=!1;if(h.isFeatureEnabled(h.EnableAnonymousSigninDialog)){a=n&&!r.peek();o&&(a=a&&o+y<=Date.now());a&&t._dataStore.setValue(l.LAST_SIGN_IN_DIALOG,Date.now())}t.showSignIn=t.createObservable(a);return t}e.prototype.onClickSignUp=function(e,t){this._onClickSignUpAction.execute(t);o.logOptimizelyEvent("clickedSignUp");o.logOptimizelyEvent("clickedSignUpBanner")};e.prototype.onClickSignIn=function(e,t){var i="1"===this._navigation.viewParams.expectsBusiness;h.isFeatureEnabled(h.UnauthenticatedBannerUseSigninDialog)||i?this.showSignIn(!0):this._onClickSignInAction.execute(t);o.logOptimizelyEvent("clickedSignIn");o.logOptimizelyEvent("clickedSignInBanner")};e.prototype.onClickOneDrive=function(e,t){this._onClickOneDriveAction.execute(t)};e.prototype.onClickClose=function(e){this.showSignIn(!1)};return e}(i.default);l.default=n});define("agN",["require","exports","b5","agQ","agP","agO"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"od-SignInDialog",template:e("agP"),viewModel:o.default,synchronous:!0});t.default=n});define("agQ",["require","exports","ap","eJ","fW","aI","bF","dc","cp","cI","qH","agR","cR","cT","V","cV","cJ","bX","cl","dZ","cE","ba"],function(i,n,t,r,a,s,e,l,u,d,c,p,m,g,f,h,y,w,_,b,v,S){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.MSAccountInfoURL="https://go.microsoft.com/fwlink/?linkid=853223";n.MSASignUpURL="https://go.microsoft.com/fwlink/?linkid=853248";var x;!function(e){e.INVALID_EMAIL="Error.Invalid Email";e.API_TIMEOUT="Error.API Timeout";e.MS_ACCOUNT="MSAccount";e.ORG_ID_PLACEHOLDER="OrgId,Placeholder";e.NEITHER="Neither";e.BOTH="Both"}(x||(x={}));var o=function(o){t.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this;t.addBindingHandlers({dismiss:d.default,focusTrap:m.default,bindableHtml:c.default,keyboard:y.default,recoverFocus:g.default,preserveFocus:h.default,interactionScope:_.default});var i=t.resources.consume(w.actionMap);t._identityDataSource=t.resources.consume(b.identity);t._engagement=t.resources.consume(v.resourceKey);t._navigation=t.resources.consume(l.navigation);t._setUpDialogStrings();t._setUpMSAVariation();t._onClickSignUpAction=new(t.managed(i.NavigationAction))({url:t.signUpURL});t._onClickSignInAction=new(t.managed(i.NavigationAction))({url:t._signInURL});t._onCancel=e.onCancel;t.overlayComponent={name:u.default.tagName,params:{animation:{},alignToParent:!1}};t._engagement.logData({name:"Display.SignInDialog"});return t}e.prototype.dismissedDialog=function(e,t){this._onCancel&&this._onCancel(t)};e.prototype.onClickOutCancel=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.OutsideDialog.Click",isIntentional:!0});this.dismissedDialog(e,t)};e.prototype.onClickCancelX=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.XButton.Click",isIntentional:!0});this.dismissedDialog(e,t)};e.prototype.onClickCancelFooter=function(e,t){this._engagement.logData({name:"Dismiss.SignInDialog.CancelFooter.Click",isIntentional:!0});this.dismissedDialog(e,t)};e.prototype.onClickSignUpDialog=function(e,t){this._onClickSignUpAction.execute(t);this._engagement.logData({name:"SignUp.SignInDialog.CreateOneLink.Click",isIntentional:!0})};e.prototype.onClickSignInDialog=function(e,t){var i=this,o=encodeURIComponent(this.username.peek());this._signInURL=this._signInURL+"&username="+o;var n="1"===this._navigation.viewParams.expectsBusiness;if(S.isFeatureEnabled(S.SigninDialogSupportBusinessAccounts)||n){var r=new s.default({name:"SignInDialog.GetIdentityProvider"});a.default.start({url:"https://odc.officeapps.live.com/odc/emailhrd/getidp?hm=0&emailAddress="+o+"&_="+Date.now(),method:"GET",requestTimeoutInMS:3e3}).then(function(e){if(200<=e.status&&e.status<400){var t=e.responseText;r.end({resultType:s.ResultTypeEnum.Success,extraData:{identityProviderResponse:t}});switch(t){case x.ORG_ID_PLACEHOLDER:i._continueBusinessSignin(o);break;default:i._continueSignin()}}else{r.end({resultType:s.ResultTypeEnum.Failure,resultCode:"ErrorResponse",error:e.status+" - "+e.responseText});i._continueSignin()}},function(e){r.end({resultType:s.ResultTypeEnum.Failure,resultCode:"Generic",error:e.status+" - "+e.responseText});i._continueSignin()})}else this._continueSignin();this._engagement.logData({name:"SignIn.SignInDialog.NextButton.Click",isIntentional:!0})};e.prototype._continueSignin=function(){var e=this.resources.consume(w.actionMap);this._onClickSignInAction=new(this.managed(e.NavigationAction))({url:this._signInURL});this._onClickSignInAction.execute(event)};e.prototype._continueBusinessSignin=function(e){r.set("aad_redirect_url",window.location.href);this._signInURL="https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47/oauth2/authorize?response_type=id_token+code&redirect_uri=https%3a%2f%2fonedrive.live.com%2fbusiness&client_id=6a9b9266-8161-4a7b-913a-a9eda19da220&scope=openid&response_mode=form_post&nonce=01F08DF7-CA7E-4BB6-A2D1-AAE2E2F1BF44&msafed=0&state=aad_redirect_url&domain_hint=organizations&login_hint="+e;this._continueSignin()};e.prototype._setUpDialogStrings=function(){this.logoLabelString=p.strings.MicrosoftLogoLabel;this.closeLabel=p.strings.closeLabel;this.upsellText=p.strings.upsellString;this.signUpText=p.strings.signUp;this.dismissText=p.strings.dismiss;this.logoURL="undefined"==typeof __webpack_public_path__?i.toUrl("@ms/odsp-media/lib/images/signindialog/microsoft_logo.svg"):i("@ms/odsp-media/dist/media/images/signInDialog/microsoft_logo.svg");this.cloudsURL="undefined"==typeof __webpack_public_path__?i.toUrl("@ms/odsp-media/lib/images/signindialog/clouds.png"):i("@ms/odsp-media/dist/media/images/signInDialog/clouds.png");var e=encodeURIComponent(window.location.href);this._signInURL=this._identityDataSource.getSignInUrl()+e;this.signUpText=p.strings.signUp;this.signUpURL=n.MSASignUpURL;this.username=this.createObservable("");this.usernameLabel=p.strings.usernameLabelString;this.usernameInputPlaceholder=p.strings.MSAInputPlaceholder;var t=this.resources.consume(w.focusItem);this.dialogLabel=this.createPureComputed(function(){return(t()().displayName||"")+". "+p.strings.dialogLabelString});this.MSAupsellText=p.strings.MSAVarUpsell};e.prototype._setUpMSAVariation=function(){var e="<a href='"+n.MSAccountInfoURL+"'>";this.useMSAccount=f.format(p.strings.UseMSA,e,"</a>");var t='<a data-bind="click: onClickSignUpDialog" href=\''+this.signUpURL+"'>";this.createAccountString=f.format(p.strings.CreateMSA,t,"</a>");this.nextString=p.strings.MSANext;this.nextLabel=p.strings.MSANextLabel};return e}(e.default);n.default=o});define("agP",[],function(){return'\x3c!--ko component: overlayComponent--\x3e<div class=od-SignInDialog-modal><div class=ms-ModalOverlay></div>\x3c!--ko focusTrap: {}--\x3e<div tabindex=-1 role=dialog class=od-SignInDialogMSAVar data-bind="preserveFocus: true, interactionScope: { isScope: true }, dismiss: { close: onClickOutCancel }, recoverFocus: { isEnabled: true }, attr: { \'aria-labelledby\': \'signInDialog\', \'aria-describedby\': \'od-SignInDialog-content\' }"><div id=signInDialog class=ms-accessible data-bind="text: dialogLabel"></div><div id=od-SignInDialog-content><div class=od-SignInDialogMSAVar-header><img data-bind="attr: { src: logoURL, alt: logoLabelString }"></div><div class=od-SignInDialogMSAVar-content><div class=od-SignInDialogMSAVar-upsell data-bind="text: MSAupsellText"></div><div class=od-SignInDialogMSAVar-useMSA data-bind="bindableHtml: useMSAccount"></div><input type=text class=od-SignInDialogMSAVar-input data-bind="textInput: username, keyboard: { allowButtonEvents: true, mappings: { \'Enter\': onClickSignInDialog } }, attr: { \'aria-label\': usernameLabel, \'placeholder\': usernameInputPlaceholder }"><div id=signInDialog class=ms-accessible data-bind="text: usernameLabel"></div><button class="od-SignInDialogMSAVar-next od-button" data-bind="text: nextString, click: onClickSignInDialog, attr: { \'aria-label\': nextLabel }"></button><div class=od-SignInDialogMSAVar-createMSA data-bind="bindableHtml: createAccountString"></div><div class=od-SignInDialogMSAVar-line></div><button class="od-Button od-SignInDialogMSAVar-dismiss" data-bind="text: dismissText, click: onClickCancelFooter"></button> <button class=od-SignInDialog-close data-bind="attr: { \'aria-label\': closeLabel, title: closeLabel }, click: onClickCancelX"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});define("agO",["c","az"],function(e,t){e.loadStyles([{rawString:".od-SignInDialog-modal{top:0;bottom:0;right:0;left:0;position:absolute;display:-ms-flexbox;display:flex}.sm .od-SignInDialog-modal{display:none}.od-SignInDialog-modal .ms-ModalOverlay{background-color:rgba(51,51,51,.8)}.od-SignInDialogMSAVar{width:410px;height:315px;position:relative;-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center;margin:auto;outline:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SignInDialogMSAVar-header{height:65px;padding-top:22px;box-sizing:border-box}html[dir=ltr] .od-SignInDialogMSAVar-header{padding-left:32px}html[dir=rtl] .od-SignInDialogMSAVar-header{padding-right:32px}.od-SignInDialogMSAVar-header img{height:41px;display:inline-block;margin:0}.od-SignInDialogMSAVar-content{padding:5px 36px;height:135px;background-repeat:no-repeat;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SignInDialogMSAVar-upsell{font-size:21px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-SignInDialogMSAVar-useMSA{font-size:15px;margin:16px 0}.od-SignInDialogMSAVar-useMSA a{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-SignInDialogMSAVar-useMSA a:hover{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SignInDialogMSAVar-next{margin:auto;background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";height:34px;width:342px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:';font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:15px;border:2px;border-color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SignInDialogMSAVar-next:focus{border-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-SignInDialogMSAVar-next:hover{background-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-SignInDialogMSAVar-input{height:34px;width:342px;margin-bottom:12px;font-size:15px;padding:0 4px;box-sizing:border-box}.od-SignInDialogMSAVar-createMSA{font-size:13px;margin:16px 0}.od-SignInDialogMSAVar-createMSA a{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-SignInDialogMSAVar-createMSA a:hover{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SignInDialogMSAVar-line{width:410px;height:1px;background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";position:absolute;left:0;right:0}.od-SignInDialogMSAVar-dismiss{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';font-size:12px;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;width:410px;height:35px;cursor:pointer;border:none;position:absolute;left:0;right:0;bottom:0}.od-SignInDialog-close{position:absolute;top:0;background:0 0;border:0;padding:16px;cursor:pointer}html[dir=ltr] .od-SignInDialog-close{right:0}html[dir=rtl] .od-SignInDialog-close{left:0}.od-SignInDialog-close .ms-Icon.ms-Icon--Cancel{font-size:16px;color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}"}])});define("agM",["require","exports","eE"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SIGN_IN_EXPERIMENT_ID=8425126308;t.logOptimizelyEvent=function(e){i.OptimizelyHelper.trackEvent(t.SIGN_IN_EXPERIMENT_ID,e)}});define("agK",[],function(){return'<div class=od-unauthenticatedBanner><button class=od-unauthenticatedBanner-OneDrive data-bind="text:brandingString, attr:{href: homePageURL, alt: brandingString}, click: onClickOneDrive"></button><div class=od-unauthenticatedBanner-AccountBox><button class="od-unauthenticatedBanner-button od-unauthenticatedBanner-SignIn" data-bind="attr: { href: signInURL }, text: signIn, click: onClickSignIn"></button> <button class="od-unauthenticatedBanner-button od-unauthenticatedBanner-SignUp" data-bind="attr: { href: signUpURL }, text: signUp, click: onClickSignUp"></button></div></div>\x3c!--ko if:showSignIn--\x3e\x3c!--ko component: {\r\n name: signInDialogTagName,\r\n params: {\r\n onCancel: onClickClose\r\n }\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("agJ",["c","az"],function(e,t){e.loadStyles([{rawString:".od-unauthenticatedBanner{position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-unauthenticatedBanner-OneDrive{position:absolute;top:0;bottom:0;border:none;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:';line-height:48px;display:inline-block;font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:';font-size:22px;-webkit-font-smoothing:antialiased;cursor:pointer}html[dir=ltr] .od-unauthenticatedBanner-OneDrive{left:10px}html[dir=rtl] .od-unauthenticatedBanner-OneDrive{right:10px}.od-unauthenticatedBanner-AccountBox{position:absolute;top:0;bottom:0}html[dir=ltr] .od-unauthenticatedBanner-AccountBox{right:0}html[dir=rtl] .od-unauthenticatedBanner-AccountBox{left:0}html[dir=ltr] .od-unauthenticatedBanner-AccountBox{padding-right:8px}html[dir=rtl] .od-unauthenticatedBanner-AccountBox{padding-left:8px}.od-unauthenticatedBanner-button{display:inline-block;padding:6px;font-family:"Segoe UI Semibold WestEuropean","Segoe UI Semibold","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;border:none;margin:8px;padding-left:16px;padding-right:16px;cursor:pointer}.od-unauthenticatedBanner-SignIn{background-color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding-bottom:6px;padding-top:6px}.od-unauthenticatedBanner-SignIn:hover{background-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-unauthenticatedBanner-SignUp{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding-bottom:7px;padding-top:7px;display:none}.od-unauthenticatedBanner-SignUp:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.lg .od-unauthenticatedBanner-SignUp,.md .od-unauthenticatedBanner-SignUp,.xlg .od-unauthenticatedBanner-SignUp,.xxlg .od-unauthenticatedBanner-SignUp,.xxxlg .od-unauthenticatedBanner-SignUp,.xxxxlg .od-unauthenticatedBanner-SignUp{display:inline}"}])});define("agu",["require","exports","ap","y8","agH","agG","bX","by","yq","agA","agv"],function(e,t,i,o,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this,o=i.resources.consume(u.platformDetection),n=new(i.managed(o.isMobile&&i.resources.isExposed(l.useMobileList)&&i.resources.consume(l.useMobileList)?s.default:a.default))(e);i.initialize(n);return i}return e}(o.default);t.default=n});define("agH",["require","exports","ap","aq","y7","jN","bX","agA","by"],function(e,t,o,r,i,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._platform=t.resources.consume(l.platformDetection);t._selectionModel=t.resources.consume(a.itemsSelection);t._isSelectionModal=t.resources.consume(n.isSelectionModalResourceKey);t.cellLocations=r.observable([]);t._checkShown=t.createComputed(function(){return t.isCheckSupported()&&(!t._platform.isMobile||t._isSelectionModal()||0<t._selectionModel.selection().length)});t.rowCheckWidth=t.createComputed(function(){return t._checkShown()?40:0});t.createComputed(function(){t._checksOld!==t._checkShown()&&t.evaluateLayout(!0);t._checksOld=t._checkShown()});return t}e.prototype.isCheckSupported=function(){return!0};e.prototype.getSettings=function(){return{headerHeight:32,rowHeight:36,outerPadding:0,innerPadding:8}};e.prototype.getHeaderCell=function(){var e=this.getSettings();return{key:"details-header",index:0,cellIndex:-1,left:e.outerPadding,top:0,width:this.viewport.width-2*e.outerPadding,height:e.headerHeight,viewType:"ms-details-header",viewData:{itemSet:this._itemSet,resources:this.resources,cellLocations:this.cellLocations}}};e.prototype.getSurfaceSize=function(){return{width:this.viewport.width,height:this.getSettings().rowHeight*this._itemSet.peek().content.peek().items.length}};e.prototype.getVisibleRange=function(){var e=this.viewport,t=this.getSettings();return{start:Math.max(0,Math.floor(e.visibleTop/t.rowHeight)),end:Math.min(this._itemSet.peek().content.peek().items.length-1,Math.floor(e.visibleBottom/t.rowHeight))}};e.prototype.getMaterializedRange=function(){var e=this.getVisibleRange(),t=this.viewport,i=this.getSettings(),o=Math.ceil(t.height/i.rowHeight),n=Math.max(3*o,4),r=Math.max(5*o,4);return{start:Math.max(0,e.start-n),end:Math.min(this._itemSet.peek().content.peek().items.length-1,e.end+r)}};e.prototype.evaluateLayout=function(e){var t=this,i=this._itemSet.peek().schema.peek();if(e||Math.round(this.viewport.width)!==Math.round(this._lastViewportWidth)||this._lastColumnCount!==i.length){this._lastColumnCount=i.length;this._lastViewportWidth=this.viewport.width;this.cellLocations(this.calculateCellLocations(i.filter(function(e){return e.isVisible&&!t._platform.isMobile||t._platform.isMobile&&e.isVisibleMobile})))}return!0};e.prototype.calculateCellLocations=function(e){var t,i,o,n=[],r=0,a=this.viewport,s=this.getSettings(),l=a.width-2*s.outerPadding-this.rowCheckWidth.peek();for(i=0;i<e.length;i++){t=e[i];var u=0<i?s.innerPadding:0,d=t.minWidth||t.width;t.isCollapsable&&l<r+u+d?u=d=0:o=i;r+=d+u;n.push({left:0,width:d})}for(;r<l&&0<=o;){if(void 0!==(t=e[o]).minWidth){var c=l-r,p=Math.min(c,t.width-t.minWidth);n[o].width+=p;r+=p}o--}var m=this.rowCheckWidth.peek();for(i=0;i<e.length;i++){n[i].left=m;m+=n[i].width+s.innerPadding}return n};e.prototype.getCellCount=function(){return this._itemSet.peek().content.peek().items.length};e.prototype.getCellAt=function(e){var t=this._itemSet.peek().content.peek().items[e],i=t?s.default.tagName:null,o=this.getSettings();return{key:t?t.peek().key:"item-"+e,item:t,index:e,cellIndex:e,viewType:i,viewData:{item:t,itemSet:this._itemSet,resources:this.resources,cellLocations:this.cellLocations,onInvoke:this.onRowInvoke},left:o.outerPadding,top:o.rowHeight*e,width:this.viewport.width-2*o.outerPadding,height:o.rowHeight}};e.prototype.onRowInvoke=function(e){return!0};e.prototype.getCellByKey=function(e){for(var t,i=this._itemSet.peek().content.peek().items,o=0;o<i.length;o++){var n=r.utils.unwrapObservable(i[o]);if(n&&n.key===e){t=this.getCellAt(o);break}}return t};e.prototype.getItemIndexAbove=function(e){var t=this._itemSet.peek().content.peek().items;return Math.min(t.length-1,Math.max(0,e-1))};e.prototype.getItemIndexBelow=function(e){var t=this._itemSet.peek().content.peek().items;return Math.min(t.length-1,Math.max(0,e+1))};e.prototype.getItemIndexLeft=function(e){return e};e.prototype.getItemIndexRight=function(e){return e};e.prototype.getItemIndicesInRegion=function(e){var t=[],i=this.getSurfaceSize();if(e.x+e.width>this.getSettings().outerPadding&&e.x<i.width-this.getSettings().outerPadding&&0<e.y+e.height&&e.y<i.height)for(var o=this.getSettings(),n=Math.max(0,Math.floor(e.y/o.rowHeight)),r=Math.min(this._itemSet().content().items.length-1,Math.floor((e.y+e.height)/o.rowHeight)),a=n;a<=r;a++)t.push(a);return t};e.prototype.getToggleClass=function(){return"DetailsRow-check"};e.prototype.supportsLazyBinding=function(){return!0};return e}(i.default);t.default=u});define("agA",["require","exports","aq","agD","agC","agB"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={tagName:"ms-details-row",template:e("agC"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(o.default))(e,t)}},synchronous:!0};i.components.isRegistered(n.tagName)||i.components.register(n.tagName,n);t.default=n});define("agD",["require","exports","ap","aq","bF","Wr","ou","bX","d7","cL","jN","cJ","ze","p2","Wv","agF","oy","bW","agE","ob","ex","by","lS","kq"],function(e,t,i,l,o,n,u,d,c,r,p,m,g,f,a,h,y,w,_,b,v,S,x,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=167,s=function(s){i.__extends(e,s);function e(e,t){var i=s.call(this,e)||this;i.draggable=!0;i.isBasePage=!1;i.isSelected=l.observable(!1);i.focusState=i.createObservable(0);i.isFocused=i.createPureComputed(function(){return!!i.focusState()});i.isDroppingTarget=l.observable(!1);i.targetDropped=l.observable(!1);i.selectionModel=i.resources.consume(d.itemsSelection);i._selectionHelper=i.resources.consume(C.resourceKey);i.ignoreClickTime=l.observable(0);i.isReceivingDrop=l.observable(!1);i._isSelectionModal=i.resources.consume(p.isSelectionModalResourceKey);i._platform=i.resources.consume(S.platformDetection);i._fieldRenderers={};i.item=i.resources.expose(d.currentItem,e.item);i._instrumentationProvider=i.resources.consume(c.instrumentation);var o=e.itemSet.peek().schema;i.columns=i.createComputed(function(){return o().filter(function(e){return e.isVisible&&!i._platform.isMobile||i._platform.isMobile&&e.isVisibleMobile})});i._cellLocations=e.cellLocations;i._onInvoke=e.onInvoke;i._dropHelper=i.resources.consume(u.resourceKey);i.longestRenderedCells=e.longestRenderedCells;var n=i.resources.consume(d.actionMap);i._action=new(i.child(n.DefaultClickAction))({item:i.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"});i.isDroppable=i.createComputed(function(){return i.item().isDropEnabled&&!i.isSelected()});i.isMobile=i._platform.isMobile;i.isCheckVisible=i.createComputed(function(){return i._isSelectionModal()||0<i.selectionModel.selection().length});i._currentFocusColumnIndex=l.observable(-1);i._createFocusObservables();i.subscribe(i._currentFocusColumnIndex,function(e){0<=e&&0<i.columns.peek().length&&i.focusedObservables[e](!1)},!0);i.subscribe(i._currentFocusColumnIndex,function(e){0<=e&&0<i.columns.peek().length&&i.focusedObservables[e](!0)});i._itemKey=i.createComputed(function(){return i.item().key});i.subscribe(i._itemKey,function(){i._updateSelectionSubscription(i.item)});i._updateSelectionSubscription(i.item);i.tabindex=i.createPureComputed(function(){return i.selectionModel.focusedItem()===i.item?0:-1});i._rowRenderer=new h.default({rowViewModel:i,rootElement:t.element});i._rowRenderer.renderRow();i.subscribe(i.item,function(){i._rowRenderer.refreshRow()});i.subscribe(i._cellLocations,function(){i._rowRenderer.refreshRow()});i.subscribe(i.columns,function(){i._createFocusObservables();i._rowRenderer.refreshRow()});i.createComputed(function(){i.isReceivingDrop()&&i.isReceivingDrop(!1)}).extend({rateLimit:{timeout:I,method:"notifyWhenChangesStop"}});i.isSelectable=i.createComputed(i._computeIsSelectable);i.isInvokable=i.createComputed(i._computeIsInvokable);i.isMobileRow=i._platform.isMobile&&i.resources.isExposed(d.useMobileList)&&i.resources.consume(d.useMobileList);i.createBackgroundComputed(function(){var e=i.item();e&&!e.isPlaceholder&&i._instrumentationProvider.userSeeItem(e)});var r={dragAndDrop:f.default,keyboard:m.default,customRender:g.default,delayedHasFocus:y.default,longTap:_.default,teachingBubble:x.default,element:w.default};i.addBindingHandlers(r);var a=i.resources.consume(c.uploadTeachingBubble.optional);a&&(i.teachingBubbleOptions=a.getTeachingBubbleForKey(i.item.peek().key));return i}e.prototype.dispose=function(){s.prototype.dispose.call(this);this._updateSelectionSubscription(null)};e.prototype.activateBindings=function(){this._rowRenderer.activateBindings()};e.prototype.getCellFocusObservable=function(e){return this.focusedObservables[e]};e.prototype.getCellTabindex=function(e){var t=-1;this.focusedObservables[e]()&&(t=0);return t};e.prototype.getCellAriaLabel=function(e){return null};e.prototype.getDragData=function(){var e=this,t=this.item.peek(),i=null,o=this.selectionModel;t.isDraggable&&o.isItemSelected(this.item)&&(i={type:1,item:t,itemSet:o.itemSet.peek(),selection:{resolve:function(){return e._selectionHelper.resolveSelection()},length:o.selectedCount.peek(),resources:o.resources}});return i};e.prototype.onMayReceiveDrop=function(e){if(!this.isDroppable.peek())return null;var t=this.item&&this.item.peek&&this.item.peek();return!t||1!==e.type&&0!==e.type?null:{targetName:t.name}};e.prototype.onReceiveDrop=function(e){if(!this.isDroppable.peek())return!1;var t=this._dropHelper.processDrop(e,this.item.peek());t&&this.targetDropped(!0);return t};e.prototype.onSelectableItemClick=function(e,t,i){var o=this.ignoreClickTime(),n=(new Date).getTime();if(o&&n-o<=1e3){i.stopPropagation();i.preventDefault();return!1}var r=t.columns.peek()[e];if(!this.isCheckVisible()&&"type"!==r.key)return t.onClick(r,i,!0);this.onItemCheckClick(t,i)};e.prototype.onItemCheckClick=function(e,t){var i=this.resources.consume(d.itemsSelection);if(t.shiftKey)i.selectToItem(this.item);else{i.toggleItemSelected(this.item);i.setItemFocus(this.item)}t.cancelBubble=!0;t.preventDefault();return!1};e.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1)};e.prototype.getClass=function(e){return"DetailsRow-cell "+e.key};e.prototype.getStyle=function(e,t){var i=this._cellLocations()[t()];return i&&i.width?"width: "+i.width+"px; "+r.default.safeLeft+": "+i.left+"px;":"display: none"};e.prototype.getTextValue=function(e){var t=this.item(),i="";if(t&&e&&!e.isIcon){void 0===(i=t[e.key])&&(i=t.properties[e.key]);if(i&&e.fieldType===v.ColumnFieldType.User){for(var o="",n=0,r=Array.isArray(i)?i:[i];n<r.length;n++){o&&(o+=", ");o+=r[n].title}i=o}else i=void 0===i?"":Array.isArray(i)?i.join(", "):i}return i};e.prototype.getHtmlValue=function(e){return n.default.RenderFieldByType(this,this.item.peek(),e)};e.prototype.getEmptyAriaLabel=function(e){return e.isRequired?a.strings.RequiredEmptyFieldAriaLabel:a.strings.EmptyFieldAriaLabel};e.prototype.registerFieldRenderer=function(e,t){this._fieldRenderers[e]=t};e.prototype.getFieldRenderer=function(e){return this._fieldRenderers[e]};e.prototype.getItem=function(){return this.item};e.prototype.getRowAriaLabel=function(){return b.getRowAriaLabel(this.item())};e.prototype.getRowAriaSelected=function(){return this.isSelected().toString()};e.prototype.onClick=function(e,t,i){var o=this.ignoreClickTime.peek(),n=(new Date).getTime();if(o&&n-o<=50){t.stopPropagation();t.preventDefault();return!1}var r=e;if(!e||e===this&&this._platform.isMobile||"displayName"===r.key||"name"===r.key||r.fieldType===v.ColumnFieldType.Custom){if(this._action.isAvailable.peek()){this.onInvoke(t);t.stopPropagation();t.preventDefault();return!1}}else if(i){var a=this.getFieldRenderer(r.key);a&&"function"==typeof a.onClick&&a.onClick(t,this.item,this.resources);t.stopPropagation();t.preventDefault();return!1}};e.prototype.onLongTap=function(e){if(!this.isCheckVisible()){this.ignoreClickTime((new Date).getTime());this.onItemCheckClick(this,e)}};e.prototype.onMouseDown=function(e,t){if(!t.shiftKey&&!t.ctrlKey&&!t.metaKey){this.selectionModel.isItemSelected(this.item)||this.selectionModel.clear();this.selectionModel.setItemSelected(this.item,!0);this.selectionModel.setItemFocus(this.item)}};e.prototype.onInvoke=function(e){if(!1!==this._onInvoke.call(this,e)&&this._action.isAvailable.peek()){this._action.execute(e);e.stopPropagation();e.preventDefault();return!1}};e.prototype.onEnter=function(e,t,i){return t.onClick(t.columns.peek()[e],i,!0)};e.prototype.onLeft=function(e){var t=Math.max(e._currentFocusColumnIndex()-1,0);e._currentFocusColumnIndex(t);return!1};e.prototype.onRight=function(e){var t=Math.min(e._currentFocusColumnIndex()+1,e.columns.peek().length-1);e._currentFocusColumnIndex(t);return!1};e.prototype.detailsRowOnRight=function(e){e._currentFocusColumnIndex(-1);e._currentFocusColumnIndex(0);return!1};e.prototype._computeIsSelectable=function(){return this.item()&&this.selectionModel.canSelectItem(this.item)};e.prototype._computeIsInvokable=function(){return this._action.isAvailable()};e.prototype._updateSelectionSubscription=function(e){var t=this;if(this._selectionSubscription){this._selectionSubscription.dispose();this._selectionSubscription=null}this.selectionModel&&e&&(this._selectionSubscription=this.selectionModel.registerSelectable(e,{focusState:this.focusState,isSelected:this.isSelected,isFocused:this.createObservable(!1),onInvoke:function(e){return t.onInvoke(e)}}))};e.prototype._createFocusObservables=function(){this.focusedObservables=[];for(var e=0;e<this.columns.peek().length;e++)this.focusedObservables.push(l.observable(!1))};return e}(o.default);t.default=s});define("agF",["require","exports","aq","V","U"],function(e,t,g,f,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._detailsRowViewModel=e.rowViewModel;this._rootElement=e.rootElement.getElementsByClassName("DetailsRow")[0];this._bindingsActive=!1}e.prototype.activateBindings=function(){if(!this._bindingsActive){g.applyBindingsToDescendants(this._detailsRowViewModel,this._rootElement);this._bindingsActive=!0}};e.prototype.refreshRow=function(){this.renderRow();this.activateBindings()};e.prototype.renderRow=function(){this._rootElement.innerHTML=this._getRowHtml();this._bindingsActive=!1};e.prototype._getCustomColumnHtmlValue=function(e){for(var t="",i=0,o=0,n=e;o<n.length;o++){var r=n[o];t+='<span class="DetailsRow-cellItem '+(i!==r.customRowNumber?"DetailsRow-cellItem--isLastRowItem":"")+'">'+this._detailsRowViewModel.getHtmlValue(r)+"</span>";i=r.customRowNumber}return t};e.prototype._getRowHtml=function(){for(var e=this._detailsRowViewModel.columns.peek(),t=!1,i=0,o=e;i<o.length;i++){if((l=o[i]).customFields){t=!0;break}}for(var n='<span role="{6}" class="{0}" {5} style="{1}" {2}data-bind="'+(t?"click: $data.onSelectableItemClick.bind($data, {3}), longTap: { callback: $data.onLongTap.bind($data) },":"")+'attr: { tabindex: $data.getCellTabindex({3}) }, hasFocus: $data.getCellFocusObservable({3}),keyboard: { mappings: { Enter: $data.onEnter.bind($data, {3}), Left: $data.onLeft.bind($data), Right: $data.onRight.bind($data) }}">{4}</span>',r=!this._detailsRowViewModel.isMobile||this._detailsRowViewModel.isCheckVisible?'<div class="DetailsRow-check" data-bind="click: onItemCheckClick"><div class="ItemCheck"><div class="ItemCheck-background"></div><div class="ItemCheck-check"></div></div></div>':"",a="",s=0;s<e.length;s++){var l=e[s],u=g.observable(s),d=this._detailsRowViewModel.getCellAriaLabel(u),c=this._detailsRowViewModel.getTextValue(l),p=this._detailsRowViewModel.getHtmlValue(l);if(l.canAutoResize&&this._detailsRowViewModel.longestRenderedCells&&c){var m=this._detailsRowViewModel.longestRenderedCells[l.internalName];(!m||m.text.length<c.length)&&(this._detailsRowViewModel.longestRenderedCells[l.internalName]={text:c,html:p})}a+=f.format(n,this._detailsRowViewModel.getClass(l),this._detailsRowViewModel.getStyle(l,u),d?'aria-label="'+h.default.encodeText(d)+'"':"",s,l.customFields?this._getCustomColumnHtmlValue(l.customFields):p,l.showTooltip?'title="'+h.default.encodeText(c)+'"':"",l.isRowHeader?"rowheader":"gridcell")}return r+'<span class="DetailsRow-columns">'+a+"<span>"};return e}();t.default=i});define("agE",["require","exports","ap","bH"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this,i=e.valueAccessor();t._callback=i.callback;t._delay=i.delay||1e3;t.events.on(t.element,"mousedown",t._onTouchStart);t.events.on(t.element,"touchstart",t._onTouchStart);t.events.on(t.element,"mouseup",t._onTouchEnd);t.events.on(t.element,"touchend",t._onTouchEnd);return t}e.prototype._clearTimer=function(){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=null}};e.prototype._onTouchStart=function(e){this._clearTimer();this._timerID=this.async.setTimeout(this._onLongTap.bind(this,e),this._delay)};e.prototype._onTouchEnd=function(e){this._clearTimer()};e.prototype._onLongTap=function(e){this._timerID=null;this._callback&&this._callback(e)};return e}(o.default);t.default=n});define("agC",[],function(){return"<div class=DetailsRow role=row data-bind=\"click: onClick, delayedHasFocus: { focusState: focusState }, css: { 'dropping': isDroppingTarget, 'is-selected': isSelected, 'is-focused': isFocused, 'is-checkVisible': isMobile && isCheckVisible, 'is-receivingDrop': isReceivingDrop, 'can-select': isSelectable, 'od-DetailsRow--isInvokable': isInvokable, 'od-DetailsRow--isMobile': isMobileRow }, attr: { tabindex: tabindex, 'aria-label': getRowAriaLabel(), 'aria-selected': getRowAriaSelected() }, keyboard: { mappings: { Right: detailsRowOnRight }, context: $data }, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }, customRender: true, teachingBubble: teachingBubbleOptions\"></div>"});define("agB",["c","az"],function(e,t){e.loadStyles([{rawString:".DetailsRow{overflow:hidden;height:100%;line-height:34px;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.DetailsRow.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#dadada"},{rawString:"}@media screen and (-ms-high-contrast:active){.DetailsRow.is-selected{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.DetailsRow.is-selected{background:#00c0ff}}.DetailsRow:focus{outline:1px solid transparent}.od--isNonMobile .DetailsRow.dropping,.od--isNonMobile .DetailsRow:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#d0d0d0"},{rawString:";outline:1px solid transparent}.od--isNonMobile .DetailsRow:hover.can-select .DetailsRow-check,.od--isNonMobile .DetailsRow:hover.is-selected .DetailsRow-check{opacity:1}.od--isNonMobile .DetailsRow:hover.can-select{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od--isNonMobile .DetailsRow:hover.is-selected{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#d0d0d0"},{rawString:"}.od-focus--enabled .DetailsRow.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.DetailsRow-check{display:inline-block;vertical-align:top;padding:7px 8px;opacity:0}.od-Browser--edge .DetailsRow-check,.od-Browser--ie .DetailsRow-check{padding:8px}.DetailsRow.is-checkVisible .DetailsRow-check,.DetailsRow.is-selected .DetailsRow-check{opacity:1}.DetailsRow.dropping .DetailsRow-cell.type .FileTypeIcon-icon{-ms-transform:scale(1.5,1.5);transform:scale(1.5,1.5)}.DetailsRow.is-receivingDrop .DetailsRow-cell.type .FileTypeIcon-icon{-ms-transform:scale(1.6,1.6);transform:scale(1.6,1.6);transition-duration:.1s;transition-timing-function:cubic-bezier(.075,.82,.165,1)}.od-DetailsRow--isMobile .DetailsRow-check{padding:14px 0 17px 8px}html[dir=rtl] .od-DetailsRow--isMobile .DetailsRow-check{padding:14px 8px 17px 0}.od-DetailsRow--isMobile .DetailsRow-check .ItemCheck{vertical-align:baseline}.DetailsRow-cell.type .FileTypeIcon-icon{transition:transform 267ms cubic-bezier(.075,.82,.165,1)}.DetailsRow-cell{cursor:default;padding:0 8px;display:inline-block;vertical-align:top;position:absolute;height:auto;top:50%;-ms-transform:translateY(-50%);transform:translateY(-50%);outline:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:12px;transition:width 367ms cubic-bezier(.1,.9,.2,1),left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.DetailsRow-cell.type{line-height:30px;overflow:visible}.DetailsRow-cell.type .FileTypeIcon{line-height:16px}.DetailsRow-cell>a,.DetailsRow-cell>a:visited{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px}.DetailsRow-cell>a:hover,.DetailsRow-cell>a:visited:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.DetailsRow-cell:focus{outline:1px solid transparent}.DetailsRow-cell.custom a{font-size:17px;line-height:20px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.DetailsRow-cell.custom .ms-Icon{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.DetailsRow-cell.custom .DetailsRow-cellItem{font-size:12px;line-height:16px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}html[dir=ltr] .DetailsRow-cell.custom .DetailsRow-cellItem{float:left}html[dir=rtl] .DetailsRow-cell.custom .DetailsRow-cellItem{float:right}[dir=ltr] .DetailsRow-cell.custom .DetailsRow-cellItem{margin-right:10px}[dir=rtl] .DetailsRow-cell.custom .DetailsRow-cellItem{margin-left:10px}.DetailsRow-cell.custom .DetailsRow-cellItem.DetailsRow-cellItem--isLastRowItem{clear:both}.od-focus--enabled .DetailsRow-cell:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.DetailsRow.is-checkVisible .DetailsRow-cell{padding:0}"}])});define("agG",["require","exports","ap","agH"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getSettings=function(){return{headerHeight:0,rowHeight:54,outerPadding:0,innerPadding:15}};t.prototype.getHeaderCell=function(){return null};return t}(o.default);t.default=n});define("agv",["require","exports","agy","b5","agx","agw","yB"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.registerComponent({tagName:"ms-details-header",template:e("agx"),viewModel:i.default,synchronous:!0});t.default=n});define("agy",["require","exports","ap","aq","bX","dZ","jG","bF","cL","ok","oj","cE","lU","V","agz","jN","cJ","fk","aI","a9","dH","dJ","c7","aC","dc","by","iG"],function(c,e,t,r,a,p,s,i,o,m,g,l,f,u,d,h,y,w,_,b,v,S,x,C,I,D,k){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(n){t.__extends(i,n);function i(e){var t=n.call(this,e)||this;t.addBindingHandlers({keyboard:y.default});var i=e.itemSet,o=e.cellLocations;t.navigation=t.resources.consume(I.navigation);t.sortManager=t.resources.consume(s.sortManager);t._selectionModel=t.resources.consume(a.itemsSelection);t._isSelectionModal=t.resources.consume(h.isSelectionModalResourceKey);t._platform=t.resources.consume(D.platformDetection);t._urlDataSource=t.resources.consume(p.url);t._currentView=t.resources.isExposed(a.currentView)?t.resources.consume(a.currentView):r.observable(null);t._engagement=t.resources.consume(l.resourceKey);t._itemSet=i;t._cellLocations=o;t.isAllSelected=t._selectionModel.isAllSelected;t.isSelectionActive=t._selectionModel.isActive;t.isMobile=t._platform.isMobile;t._currentFocusColumnIndex=r.observable(-1);t.isItemCheckFocused=r.observable(!1);t.isFilterMenuFocused=r.observable(!1);t.columns=t.createPureComputed(t._computeColumns);t.isCheckVisible=t.createPureComputed(t._computeIsCheckVisible);t.isSelectAllAvailable=t.createPureComputed(t._computeIsSelectAllAvailable);t.checkBoxAriaLabel=t.createPureComputed(t._computeCheckBoxAriaLabel);t.subscribe(t._currentFocusColumnIndex,function(e){0<=e&&0<t.columns().length&&t.columns()[e].isFocused(!1)},!0);t.subscribe(t._currentFocusColumnIndex,function(e){0<=e&&0<t.columns().length&&t.columns()[e].isFocused(!0)});return t}i.prototype.dispose=function(){n.prototype.dispose.call(this);this.columns.dispose()};i.prototype.getStyle=function(e,t){var i=this._cellLocations()[t()];return i&&i.width?"width: "+i.width+"px; "+o.default.safeLeft+": "+i.left+"px;":"display: none"};i.prototype.getClass=function(e){return"DetailsHeader-cell "+e.key+(e.sortable?" isSortable":"")};i.prototype.getCellClass=function(e){return"cellContainer"+(e.filterable?" isFilterable":"")+(!e.isFocused||!e.isFocused()||e.filterable&&this.isFilterMenuFocused()?"":" is-focused")};i.prototype.getSortClass=function(e){return"cellSort"+(e.isSorted?" isSorted":"")+(e.isAscending?" isAscending":"")};i.prototype.getMenuClass=function(e){return"cellMenuLink"+(e.isFiltered()?" isFiltered":"")+(e.isFocused&&e.isFocused()&&this.isFilterMenuFocused()?" is-focused":"")};i.prototype.onClick=function(e,t){if(e.sortable){if(this.resources.isExposed(k.rumOneHelper)){this.resources.consume(k.rumOneHelper).logFilterSort("Sort")}if(e.internalName){var i=[f.capitalizeFirstLetter(e.internalName),"Header","Click"].join(".");this._engagement.logData({name:i,isIntentional:!0})}var o=e.internalName||e.key,n=e.isSorted?!e.isAscending:!e.sortDescFirst,r=new w.Action({name:"ColumnHeaderSort",pageType:b.default[this._urlDataSource.getPageType()],queryType:v.default[this._urlDataSource.getQueryType()]}),a={sortMode:e.isSorted?"Column":"Order",sortColumn:o,sortAscending:n?"Ascending":"Descending"};r.end({resultType:_.ResultTypeEnum.Success,extraData:a});this.sortManager.updateSort(o,n);t.stopPropagation();t.preventDefault();return!1}};i.prototype.onMenuClick=function(r,a){var s=this;if(r.filterable){var e=[f.capitalizeFirstLetter(r.name),"HeaderGlyph",f.ClickName].join(".");this._engagement.logData({name:e,isIntentional:!0,extraData:{action:f.capitalizeFirstLetter(a.type)}});var l=r.internalName||r.key,t=this.resources.consume(p.items),u=S.serializeQuery(this.navigation.viewParams),i=this._currentView&&this._currentView.peek(),o=i&&i.id,n=t.getFilterData(l,u,o),d=x.loadModule({path:"Sw",getModule:function(){return new C.default(function(e,t){c(["Sw"],e,t)})}});C.default.all({filterData:n,type:d}).then(function(e){var t=e.filterData,i=e.type,o=t?i.getFilterMenuItems(s.resources,r,t,u,l):[],n=new g.default({items:o,rootElementClass:"List",boundingElementClass:"Files-content"});m.default.createContextMenu(a,n,s)});a.stopPropagation();a.preventDefault();return!1}};i.prototype.toggleAllSelected=function(e,t){this._selectionModel.setIsActive(!0);this._selectionModel.toggleSelectAll();t.stopPropagation();t.preventDefault();return!1};i.prototype.onLeft=function(e){if(e.filterable&&this.isFilterMenuFocused())this.isFilterMenuFocused(!1);else{var t=this.getLeftFocusColumnIndex();this._currentFocusColumnIndex(t);-1===t&&this.isItemCheckFocused(!0);this.isFilterMenuFocused(!0)}return!1};i.prototype.onRight=function(e){if(!e.filterable||this.isFilterMenuFocused()){this.isFilterMenuFocused(!1);this._currentFocusColumnIndex(this.getRightFocusColumnIndex())}else this.isFilterMenuFocused(!0);return!1};i.prototype.onDown=function(e,t){if(e.filterable&&this.isFilterMenuFocused()){this.onMenuClick(e,t);return!1}};i.prototype.onEnter=function(e,t){e.filterable&&this.isFilterMenuFocused()?this.onMenuClick(e,t):this.onClick(e,t);return!1};i.prototype.headerContainerOnRight=function(){this.isItemCheckFocused(!0);this._currentFocusColumnIndex(-1);return!1};i.prototype.getColumnAriaSort=function(e){var t="none";e.isSorted&&(t=e.isAscending?i._ascendingAriaSort:i._descendingAriaSort);return t};i.prototype.getColumnFilterAriaLabel=function(e){var t=null;e.isFiltered()&&(t=u.format(d.strings.columnFilterAriaLabel,e.name,e.filterValues()));return t};i.prototype.getRightFocusColumnIndex=function(){for(var e=this._currentFocusColumnIndex(),t=this.columns(),i=e+1;i<t.length;i++)if(t[i].name){e=i;break}return e};i.prototype.getLeftFocusColumnIndex=function(){for(var e=this._currentFocusColumnIndex(),t=this.columns(),i=!1,o=e-1;0<=o;o--)if(t[o].name){e=o;i=!0;break}i||(e=-1);return e};i.prototype._computeIsSelectAllAvailable=function(){return 0===this._selectionModel.mode||0<this._selectionModel.selection().length};i.prototype._computeIsCheckVisible=function(){return!this._platform.isMobile||this._isSelectionModal()||0<this._selectionModel.selection().length};i.prototype._computeColumns=function(){var t=this;return this._itemSet().schema().filter(function(e){return e.isVisible&&!t._platform.isMobile||t._platform.isMobile&&e.isVisibleMobile})};i.prototype._computeCheckBoxAriaLabel=function(){return this._selectionModel.isAllSelected()?d.strings.deselectAllAriaLabel:d.strings.selectAllAriaLabel};i._ascendingAriaSort="ascending";i._descendingAriaSort="descending";return i}(i.default);e.default=n});define("agx",[],function(){return"<div class=DetailsHeaderContainer data-bind=\"if: !isMobile\"><div class=DetailsHeader role=row tabindex=0 data-bind=\"keyboard: { mappings: { Right: $component.headerContainerOnRight.bind($component) }, context: $data }\">\x3c!--ko if: isCheckVisible--\x3e<ms-item-check class=DetailsHeader-check data-bind=\"click: $component.toggleAllSelected.bind($component), css: { 'can-select': isSelectAllAvailable, 'is-selected': isAllSelected, 'is-selection-active': isSelectionActive, 'is-focused': $data.isItemCheckFocused }, hasFocus: $data.isItemCheckFocused, keyboard: { mappings: { Enter: $component.toggleAllSelected.bind($component), Right: $component.onRight.bind($component) }, context: $data }, attr: { tabindex: $data.isItemCheckFocused() ? 0 : -1, 'aria-label': checkBoxAriaLabel }\"></ms-item-check>\x3c!--/ko--\x3e<div class=DetailsHeader-columns data-bind=\"foreach: columns\"><div role=columnheader data-bind=\"if: $data.name, class: $component.getClass($data), attr: { 'style': $component.getStyle($data, $index), 'aria-sort': $component.getColumnAriaSort($data), tabindex: $data.isFocused() ? 0 : -1 }, hasFocus: $data.isFocused, keyboard: { mappings: { Enter: $component.onEnter.bind($component), Space: $component.onEnter.bind($component), Left: $component.onLeft.bind($component), Right: $component.onRight.bind($component), Down: $component.onDown.bind($component) }, context: $data }\"><div data-bind=\"click: $component.onClick.bind($component), class: $component.getCellClass($data)\"><div class=cellBuffer><div data-bind=\"class: $component.getSortClass($data)\"></div><div class=cellText data-bind=\"text: $data.name\"></div></div></div>\x3c!--ko if: $data.filterable--\x3e<div data-bind=\"click: $component.onMenuClick.bind($component), class: $component.getMenuClass($data), attr: { 'aria-label': $component.getColumnFilterAriaLabel($data), role: $data.isFiltered()? 'button': null }\"></div>\x3c!--/ko--\x3e</div></div></div></div>"});define("agw",["c","az"],function(e,t){e.loadStyles([{rawString:'@charset "UTF-8";.DetailsHeader{overflow:hidden;height:30px;border-bottom:1px solid '},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.DetailsHeader:focus{outline:1px solid transparent}.od-focus--enabled .DetailsHeader:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.DetailsHeader-check{position:absolute;z-index:1;display:inline-block;height:22px;padding:4px 8px;vertical-align:top}.DetailsHeader-check:hover .ItemCheck-background{display:inline-block}.DetailsHeader-check:hover .ItemCheck-check:after{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.DetailsHeader-check .ItemCheck-background{display:none}.DetailsHeader-check .ItemCheck-check{display:inline-block}.DetailsHeader-check .ItemCheck-check:after{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.DetailsHeader-check:focus{outline:1px solid transparent}.od-focus--enabled .DetailsHeader-check.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.DetailsHeader-check.can-select.is-selected:hover .ItemCheck-check:after{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.DetailsHeader-check.can-select.is-selected .ItemCheck-background{display:inline-block}.DetailsHeader-columns{position:absolute;left:0;right:0;height:30px;overflow:hidden;white-space:nowrap}.DetailsHeader-cell{display:inline-block;vertical-align:top;position:absolute;overflow:hidden;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";outline:0;transition:width 367ms cubic-bezier(.1,.9,.2,1),left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.DetailsHeader-cell.isSortable{cursor:pointer;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}@media screen and (-ms-high-contrast:active){.DetailsHeader-cell.isSortable{border-left:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-right:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-top:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.DetailsHeader-cell.isSortable{border-left:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-right:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}.DetailsHeader-cell.isSortable .cellContainer.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{border-left:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-right:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.DetailsHeader-cell.isSortable:focus,.DetailsHeader-cell.isSortable:hover{border-left:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-right:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";border-top:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.DetailsHeader-cell.isSortable:active{background:"},{theme:"neutralQuaternary",defaultValue:"#dadada"},{rawString:'}.DetailsHeader-cell .cellContainer{height:30px;display:inline-block;width:100%}.DetailsHeader-cell .cellContainer.isFilterable{width:calc(100% - 21px)}.DetailsHeader-cell .cellBuffer{position:relative;padding-top:4px}[dir=ltr] .DetailsHeader-cell .cellBuffer{padding-left:4px}[dir=rtl] .DetailsHeader-cell .cellBuffer{padding-right:4px}.DetailsHeader-cell .cellText{display:inline-block;font-size:11px;text-overflow:ellipsis;padding-top:4px}[dir=ltr] .DetailsHeader-cell .cellText{padding-left:4px}[dir=rtl] .DetailsHeader-cell .cellText{padding-right:4px}.DetailsHeader-cell .cellSort{display:none}[dir=ltr] .DetailsHeader-cell .cellSort{padding-left:2px}[dir=rtl] .DetailsHeader-cell .cellSort{padding-right:2px}.DetailsHeader-cell .cellSort.isSorted{display:inline-block}.DetailsHeader-cell .cellSort:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:"";color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';font-size:10px}.DetailsHeader-cell .cellSort.isAscending:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:""}.DetailsHeader-cell .cellMenuLink{position:absolute;top:0;height:30px;width:21px}[dir=ltr] .DetailsHeader-cell .cellMenuLink{right:0}[dir=rtl] .DetailsHeader-cell .cellMenuLink{left:0}.DetailsHeader-cell .cellMenuLink:after{position:relative;top:3px}[dir=ltr] .DetailsHeader-cell .cellMenuLink:after{left:2px}[dir=rtl] .DetailsHeader-cell .cellMenuLink:after{right:2px}.DetailsHeader-cell .cellMenuLink.isFiltered:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:"";color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-weight:900}.DetailsHeader-cell .cellMenuLink.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:' inset;outline:1px solid transparent}.DetailsHeader-cell.DetailsHeader-cell:focus .cellMenuLink:not(.isFiltered):after,.DetailsHeader-cell:hover .cellMenuLink:not(.isFiltered):after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:""}.od-focus--enabled .DetailsHeader-cell.isSortable .cellContainer.is-focused{box-shadow:0 0 0 1px '},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}"}])});define("ags",[],function(){return'<div class="od-Files od-Files-dragAndDrop" data-bind="dragAndDrop: dragAndDrop.getOptions">\x3c!--ko if: showMobileWebToAppUpsellV2()--\x3e<div class=od-files-mobileWebToAppUpsellV2 data-bind="react: mobileWebToAppUpsellV2"></div>\x3c!--/ko--\x3e\x3c!--ko if: showSmartBanner()--\x3e<div class=Files-smartBanner data-bind="component: { name: smartBannerTagName, params: { isVisible: isSmartBannerVisible, useODCAdjustLink: true } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: !!upsellComponent()--\x3e<div class=SetView-firstRunBanner data-bind="component: upsellComponent()"></div>\x3c!--/ko--\x3e\x3c!--ko with: guidedTourComponent--\x3e\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko control: contentControl--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !isEmptyView()--\x3e\x3c!--ko component: {\r\n name: listFooterTagName,\r\n params: {\r\n dragAndDropHintComponent: dragAndDropFooterHintComponent\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isInfoPaneExpanded() && !isOneUp()--\x3e\x3c!--ko component: { name: transclusionContentTagName, params: infoPaneTransclusionContentParams }--\x3e<div class=od-BasePage-infoPane data-bind="control: infoPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isOneUp--\x3e\x3c!--ko component: {\r\n name: oneUpOverlayTagName\r\n }--\x3e\x3c!--ko if: showUnauthBanner--\x3e<div class=od-Files-unauthBanner data-bind="component: unauthenticatedBannerTagName"></div>\x3c!--/ko--\x3e<div class=od-Files-oneUp data-bind="control: oneUpSpecification, css: { \'od-Files-OneUp--showUnauthBanner\': showUnauthBanner() && !isOneUpSlideshow() }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko with: dragAndDrop.decorationComponent()--\x3e\x3c!--ko control: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko with: firstRunComponent--\x3e\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});define("agr",["c","az"],function(e,t){e.loadStyles([{rawString:".NotificationHost{z-index:295}.od-BasePage:not(.od-BasePage--hasSmartBanner) .Files-smartBanner{display:none}.Files-loadingBar{opacity:1}.SetView-firstRunBanner .FirstRunBanner--isContentLoaded{margin-top:20px}.md .SetView-firstRunBanner,.sm .SetView-firstRunBanner{display:none}.od-Files--isReceiving .Files-listView{box-shadow:inset 0 0 0 3px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.od-Files-dragAndDropHint{text-align:center;margin-top:33px;margin-bottom:24px}.od-Files-unauthBanner{position:absolute;top:0;left:0;right:0;height:50px}.od-Files-oneUp{position:absolute;top:0;left:0;right:0;bottom:0}.od-Files-oneUp.od-Files-OneUp--showUnauthBanner{top:50px}.od-Share{width:320px}"}])});define("ago",["require","exports","aq","agp","lb","yq","pE","yQ"],function(e,t,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={tagName:n.SingleAlbum,template:e("yq"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(o.default))(e,t)}},synchronous:!0};i.components.isRegistered(r.tagName)||i.components.register(r.tagName,r);t.default=r});define("agp",["require","exports","ap","y8","agq"],function(e,t,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i.initialize(new(i.managed(n.default))(e));return i}return e}(o.default);t.default=r});define("agq",["require","exports","ap","yP"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={Small:130,Medium:130,Large:210,XLarge:300,XXLarge:300,XXXLarge:300,XXXXLarge:300},r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getInnerMargin=function(){return 12};t.prototype.getHeader=function(e,t,i){var o=null,n=t&&t.peek&&t.peek(),r=this.getGroup(i,n);if(r&&this.currentGroup!==r){this.nextGroup=r;var a=this.getHeaderDetails(r,i);0!==i||a.viewType||(a.headerHeight=0);var s=a.key?a.key:n?n.key+"_header":null;s&&(o={key:s,index:-1,cellIndex:this.cells.length,left:0,top:0,width:0,height:a.headerHeight,viewType:a.viewType,viewData:a.viewData})}return o};t.prototype.getGroup=function(e,t){var i,o=this._itemSet().content.peek().groupings||[];if(o&&o.length&&o[0].itemGroups)for(var n=0,r=o[0].itemGroups;n<r.length;n++){var a=r[n];if(a){var s=a.startIndex+a.count-1;if(a.startIndex<=e&&e<=s){i=a;break}}}return i};t.prototype.getMinRowHeight=function(){var e=this.responsiveHelper.formFactorSize();return this.currentGroup&&"folder"===this.currentGroup.groupingId?o.MinRowHeights.folder[e]:this.currentGroup&&"document"===this.currentGroup.groupingId?o.MinRowHeights.documents[e]:n[e]};t.prototype.getHeaderDetails=function(e,t){return{viewType:"",viewData:{},headerHeight:20}};return t}(o.default);t.default=r});define("af2",["require","exports","agl","MY","MM","MA","Mz","My","agg","Mx","Ml","L1","L0","LX","LW","Ll","LV","LU","LR","LS","Lj","LP","LO","LI","LG","LE","agf","age","LD","agd","kS","LC","kN","Lx","Lw","Lv","Lu","Lg","agc","agb","LA","Ly","aga","af9","af8","af7","af4","af3","La"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={}});define("agl",["require","exports","ap","Mr","kx","aI","agm","aC","ci","iE","dN"],function(e,t,o,n,i,r,a,s,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="AuthenticationPolicyWarning";t._pageContext=t.resources.consume(u.pageContext);return t}e.prototype.onExecute=function(e,t){return this._pageContext.blockDownloadsExperienceEnabled?this._LaunchPolicyDialog(n.strings.DownloadBlockedDialogTitle,a.strings.authenticationPolicyActive):s.default.wrap({resultType:r.ResultTypeEnum.Failure})};e.prototype.onIsAvailable=function(){return this._pageContext.blockDownloadsExperienceEnabled};e.prototype._LaunchPolicyDialog=function(e,t){return this.resources.consume(l.resourceKey).requestDialog({title:e,component:{name:d.default.tagName,params:{text:t}}}).wait().then(function(){return{resultType:r.ResultTypeEnum.Success}})};return e}(i.default);t.default=c});define("agg",["require","exports","ap","aC","by","aI","sq","g4","agh","cE","kv","bX"],function(e,t,i,l,r,u,o,n,d,a,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.name="DownloadZipContents";var i=t.resources;t._engagement=i.consume(a.resourceKey);t._hiddenDomProvider=i.consume(s.resourceKey);t._useWindow=i.consume(r.platformDetection).isIE;t._downloadUrl=e.url;t._selection=e.selection;var o=i.consume(c.actionMap);t._downloadAction=new(t.managed(o.DownloadAction));return t}e.prototype.onExecute=function(e,t){var i=this;this._engagement.logData({name:"OneUpZipPreviewer.SelectiveDownload",isIntentional:!0});var o=this._selection.peek(),n={url:this._downloadUrl.peek(),postdata:{relativeFilePath:o.map(function(e){return e.path}).join(",")}};if(this._useWindow)this._downloadInWindow("od-download-tab",n);else{var r=this._hiddenDomProvider.requestControl({name:d.default.tagName,params:n}),a=this.addDisposable({dispose:function(){i._hiddenDomProvider.disposeControl(r)}});this.async.setTimeout(function(){a.dispose()},2e4)}var s={resultType:u.ResultTypeEnum.Success,extraMetrics:{count:o.length}};return l.default.resolve(s)};e.prototype.onIsAvailable=function(){return this._downloadAction.isAvailable()};e.prototype._downloadInWindow=function(e,t){var i=window.open("",e);o.navigateViaPost({url:t.url,postdata:t.postdata,document:i.document});this.async.setTimeout(function(){i.close()},5e3)};return e}(n.default);t.default=p});define("agh",["require","exports","agk","b5","agj","agi"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.registerComponent({tagName:"od-downloadzipcontents",template:e("agj"),viewModel:i.default,synchronous:!0});t.default=n});define("agk",["require","exports","ap","bF","sp"],function(e,t,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({iframe:n.default});t.iframeOptions={url:e.url,postdata:e.postdata,type:"post"};return t}return e}(i.default);t.default=r});define("agj",[],function(){return'<div class=od-DownloadZipContents data-bind="iframe: iframeOptions"></div>'});define("agi",["c","az"],function(e,t){e.loadStyles([{rawString:".od-DownloadZipContents{visibility:hidden}"}])});define("agf",["require","exports","ap","g4","aC","aI","dc","dJ","bX","im"],function(e,t,o,i,n,r,a,s,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="ClearFilter";t._navigation=t.resources.consume(a.navigation);t._viewParams=t.resources.consume(l.viewParams);t.field=e.field[0];return t}e.prototype.onExecute=function(e,t){var i=s.serializeQuery(this._viewParams.peek());this._navigation.updateViewParams(u.default.addFilterInfo(i,this.field,"",!0),{clearOtherParams:!0});return n.default.wrap({resultType:r.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){var e=s.serializeQuery(this._viewParams());return!!u.default.getFilterFieldByName(e,this.field)};return e}(i.default);t.default=d});define("age",["require","exports","ap","g4","aC","aI","dc","dJ"],function(r,e,t,i,a,s,o,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="Filter";t._navigation=t.resources.consume(o.navigation);t.field=e.field;t.value=e.value;t.isFilterOn=e.isFilterOn;t.clearExistingFilters=e.clearExistingFilters;return t}e.prototype.onExecute=function(e,t){var i=this,o=this._navigation,n=l.serializeQuery(o.viewParams);r(["hE","im"],function(e,t){i.clearExistingFilters&&(n=e.clearFilterInfo(n));n=t.default.addMultipleFilterInfo(n,i.field,i.value);o.updateViewParams(n,{clearOtherParams:!0})});return a.default.wrap({resultType:s.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){return!0};e.prototype.onIsToggled=function(){return this.isFilterOn};return e}(i.default);e.default=n});define("agd",["require","exports","ap","aC","Lm","jc"],function(o,e,t,n,i,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="Pin";t._overrideItem=e.overrideItem;return t}e.prototype.getExecutorPath=function(){return"aeO"};e.prototype.getModuleFactory=function(){return function(){return new n.default(function(e,t){o(["aeO"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,overrideItem:this._overrideItem}};e.prototype.onIsAvailable=function(){var e=this._overrideItem?this._overrideItem:this.selectionHelper.firstItem();return this.itemCommandHelper.isCommandSupported(e,r.pinToMru)&&e&&void 0!==e.mruState};return e}(i.default);e.default=a});define("agc",["require","exports","ap","by","dc","aC","aI","ba","kz","dZ","gA","cY"],function(e,t,o,n,r,a,s,l,i,u,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="PrintPdf";t.isSingleSelectAction=!0;t._platform=t.resources.consume(n.platformDetection);t._navigation=t.resources.consume(r.navigation);return t}e.prototype.onSelectionExecute=function(t,e,i){var o=t[0];if(!this._platform.isIE){var n="printPdf_"+Math.random(),r=window.open("",n);return(o.officeBundle&&("ms-powerpoint"===o.appMap||"ms-word"===o.appMap)&&o.urls&&o.urls[d.default.viewInBrowser]?a.default.wrap(o.urls[d.default.viewInBrowser]):this.resources.consumeAsync(u.download).then(function(e){return e.getDownloadUrl(t[0],{downloadType:1})})).then(function(e){r.location.assign(e);return a.default.wrap({resultType:s.ResultTypeEnum.Success})},function(){r&&r.close();return a.default.wrap({resultType:s.ResultTypeEnum.Failure})})}this._navigation.navigateTo({url:o.openUrl,frameId:"_blank"})};e.prototype.onSelectionIsAvailable=function(e,t){return t&&(".pdf"===t.extension||t.officeBundle&&("ms-powerpoint"===t.appMap||"ms-word"===t.appMap)&&t.urls[d.default.viewInBrowser]&&!this._platform.isEdge&&!this._platform.isIE)&&!this._platform.isMobile&&l.isFeatureEnabled(l.UseWebPdfViewer)&&4!==this.item().itemStatus&&3!==this.item().itemStatus&&c.PermissionMask.hasItemPermission(t,c.PermissionMask.openItems)};return e}(i.default);t.default=p});define("agb",["require","exports","ap","g4","aI","cE","kp","bX","dZ"],function(e,t,i,o,a,s,r,l,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.name="CustomActionNavigation";var i=e.customAction,o=e.item;t._customAction=i;t._itemSelectionHelper=new(t.managed(r.default))({overrideItem:o,allowMultiSelect:i.allowMultiSelect,canFallback:!1,useCurrentSelectionGroup:!!i.clientSideCommandAdapter});t._customActionDataSource=t.resources.consume(u.customAction);return t}e.prototype.onIsAvailable=function(){var r=this._customAction,e=this._itemSelectionHelper.selection(),t=e[0];if(r.clientSideCommandAdapter){if(1===e.length){var i=!0;if(t){var o;"function"==typeof(o=r.isEnabled)&&(i=o(t()))}if(!i)return!1}var n=r.clientSideCommandAdapter,a=e,s=new Array;a&&0<a.length&&a.forEach(function(e,t,i){var o={values:e.peek().properties},n=r.clientSideCommandAdapter.listViewAdapter.createRowAdapter(o);s.push(n)});n.refresh(s);r.text=n.title;r.iconUrl=n.iconUrl;return n.visible}return!!r.allowMultiSelect||!!t&&("function"==typeof(o=r.isEnabled)?o(t()):!!o)};e.prototype.onExecute=function(o){var n=this,r=this._customAction;this.resources.consume(s.resourceKey).logData({name:"CustomAction.Click",isIntentional:!0,extraData:{action:r.action}});return this._itemSelectionHelper.resolveSelection().then(function(e){if(r.clientSideCommandAdapter)return r.clientSideCommandAdapter.execute();var t=n._customActionDataSource.prepareAction(r.action,e);if("javascript:"!==t.substring(0,11).toLowerCase()){var i=n.resources.consume(l.actionMap);return new(n.managed(i.NavigationAction))({url:t,target:"_blank"}).execute(o)}return n._customActionDataSource.invokeScriptAction(t,r.clientSideComponentId,r.clientSideComponentProperties,e).then(function(){return{resultType:a.ResultTypeEnum.Success}},function(){return{resultType:a.ResultTypeEnum.Failure}})})};return e}(o.default);t.CustomActionNavigationAction=n;t.default=n});define("aga",["require","exports","ap","ba","aI","dZ","g4","kp","aC","g9","fO","kL","aL","kG","i9","iE"],function(e,t,i,o,r,a,n,s,l,u,d,c,p,m,g,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this,i=e.overrideItem;t._itemBeingShared=t.resources.consume(e.focusItemResourceKey);t._selectionHelper=new(t.managed(s.default))({overrideItem:i?t.createObservable(e.overrideItem):null,allowMultiSelect:!1,canFallback:!0});t._sharingDataSourceHelper=new(t.managed(u.default));t._urlDataSource=t.resources.consume(a.url);t._itemCommandHelper=t.resources.consume(m.resourceKey);t._itemUrlHelper=t.resources.consume(d.resourceKey);t._pageContext=t.resources.consume(f.pageContext);t.name="ShowShareAction";return t}e.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!this._itemCommandHelper.isCommandSupported(e,g.share))return!1;var t=e&&this._itemUrlHelper.getItemUrlParts(e.key);if(t&&t.siteRelation===d.SiteRelation.crossSite&&!this._pageContext.isNoScriptEnabled)return!1;var i=e&&!!this._sharingDataSourceHelper.getParentListId(e),o=e&&e.properties&&(!!e.properties.ID||!!e.properties.uniqueId);return!!this._itemBeingShared()||n.prototype.onIsAvailable.call(this)&&e&&!this._urlDataSource.isRecycleBin(e.queryType)&&!e.isRootFolder&&!e.list&&i&&o&&!(e.lifeCycleStatus&&e.lifeCycleStatus.isExternal)};e.prototype.onExecute=function(e,t){var i=this._selectionHelper.firstItem.peek();t.data.extraData||(t.data.extraData={});p.extend(t.data.extraData,{uniqueId:i.properties?i.properties.uniqueId:void 0});o.isOneDrive&&this.trackPromise(this.resources.consumeAsync(c.resourceKey).then(function(e){e.fireShareEvent(i)}));this._itemBeingShared(i);return l.default.wrap({resultType:r.ResultTypeEnum.Success})};return e}(n.default);t.default=h});define("af9",["require","exports","ap","g4","aC","aI","jG","iE","dc"],function(e,t,o,i,r,a,n,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="Group";t._navigation=t.resources.consume(l.navigation);t._column=e.column;t._field=t._column?t._column.internalName||t._column.key:null;return t}e.prototype.onExecute=function(e,t){var i=this.onIsToggled(),o=i?"":this._field,n=this.resources.consume(s.listContext.optional);n&&!n.groupByOverride&&n.groupBy&&2===n.groupBy.length&&i&&(n.groupBy[0]===this._field?o=n.groupBy[1]:n.groupBy[1]===this._field&&(o=n.groupBy[0]));this._setGroupByField(o);return r.default.wrap({resultType:a.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){return!!this._column.groupable};e.prototype.onIsToggled=function(){return!!this._column.isGrouped};e.prototype._setGroupByField=function(e){var t;this.resources.consume(n.dataManager).requiredGroup(null);this._navigation.updateViewParams(((t={}).groupBy=e,t))};return e}(i.default);t.default=u});define("af8",["require","exports","ap","c7","qY","kx","aC","aI","cE","EJ","a0","EP","EG"],function(o,e,t,n,r,i,a,s,l,u,d,c,p){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var m="AddFlowPanel",g=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="AddFlow";t._flowActionHelper=t.resources.consume(u.resourceKey);return t}e.prototype.onExecute=function(e,t){var i=this;return n.loadModule({path:"ED",getModule:function(){return new a.default(function(e,t){o(["ED"],e,t)})}}).then(function(e){var t=i.resources.consume(r.resourceKey).requestPanel({includePadding:!1,title:c.strings.AddFlowPanelTitle,elementDescribedBy:p.ADD_FLOW_PANEL_DESCRIBEDBY,noTitle:!0,component:{name:e.tagName,params:{closeFlowPanel:function(){return t.state(1)},engagementPrefix:m}}});return t.wait().then(function(){d.Engagement.logData({name:m+".ClosePanel.Click"});return{resultType:s.ResultTypeEnum.Success}})})};e.prototype.onIsAvailable=function(){var e=this.item(),t=i.prototype.onIsAvailable.call(this)&&this._flowActionHelper.checkBaseAvailability(e);if(t&&!this._visibilityLogged){this.resources.consume(l.resourceKey).logData({name:"AddFlowAction.IsVisible"});this._visibilityLogged=!0}return t};return e}(i.default);e.default=g});define("EG",["require","exports","ap","bF","a0","d","bX","V","kU","EP","EO","EN","cJ","p7","lB","EJ","EH"],function(e,r,t,i,a,o,s,l,u,d,c,p,m,g,f,h,y){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var w="https://go.microsoft.com/fwlink/?LinkId=821320";r.ADD_FLOW_PANEL_DESCRIBEDBY="od-AddFlowPanel-description";var n=function(n){t.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.addBindingHandlers({keyboard:m.default,tooltip:g.default});t.loadingSpinnerTagName=f.default.tagName;t.resx=d.strings;t.stringHelper=l;t.closeFlowPanel=e.closeFlowPanel;t._engagementPrefix=e.engagementPrefix;t.flowPanelDescribedBy=r.ADD_FLOW_PANEL_DESCRIBEDBY;t.learnMoreUrl=w;t.isLoading=t.createObservable(!0);t.isExpanded=t.createObservable(!1);t.displayedTemplates=t.createObservable([]);t.expandText=t.createPureComputed(t._computeExpandText);t.expandIcon=t.createPureComputed(t._computeExpandIcon);var i=t.resources.consume(s.currentItem).peek();new(t.child(y.typeResourceKey))({item:i}).getFlowConfiguration().done(function(e){t._flowConfig=e;t._templates=t._flowConfig.templates;t.displayedTemplates(t._templates.slice(0,5));t.userFlowsUrl=t._flowConfig.userFlowsUrl;t.moreTemplatesUrl=t._flowConfig.moreTemplatesUrl;t.isLoading(!1);t._truncateTemplateDescriptions()});var o=t.resources.consume(h.resourceKey);t.flowPanelDescription=o.checkIsODB(i)?t.resx.ODBAddFlowPanelDescription:t.resx.AddFlowPanelDescription1;return t}e.prototype.onTemplateClick=function(e,t,i){if(e){a.Engagement.logData({name:"FlowTemplate.Click",isIntentional:!0,extraData:{templateId:t}});new(this.managed(u.default))({url:e,target:"_blank"}).execute(i);this.closeFlowPanel()}};e.prototype.onToggleTemplateExpansionClick=function(e){var t=this.isExpanded.peek()?this._templates.slice(0,5):this._templates;this.isExpanded(!this.isExpanded.peek());this.displayedTemplates(t)};e.prototype.onSeeMoreTemplatesClick=function(e){this._onPanelClick(e,"SeeMoreTemplates",this.moreTemplatesUrl)};e.prototype.onSeeMyFlowsClick=function(e){this._onPanelClick(e,"SeeMyFlows",this.userFlowsUrl)};e.prototype.onLearnMoreClick=function(e){this._onPanelClick(e,"LearnMore",w)};e.prototype._computeExpandText=function(){return this.isExpanded()?c.strings.ShowLessAlbums:p.strings.showMore};e.prototype._computeExpandIcon=function(){return o.getIconClassName(this.isExpanded()?"ChevronUpSmall":"ChevronDownSmall")};e.prototype._onPanelClick=function(e,t,i,o){void 0===o&&(o="");a.Engagement.logData({name:this._engagementPrefix+"."+t+".Click",isIntentional:!0});new(this.managed(u.default))({url:i,target:"_blank"}).execute(e)};e.prototype._truncateTemplateDescriptions=function(){for(var e=document.querySelectorAll(".od-AddFlowPanel-descriptionContainer"),t=0;t<e.length;t++)for(var i=e[t],o=i.querySelector(".od-AddFlowPanel-templateDescription"),n=i.clientHeight;o.offsetHeight>n;)o.textContent=o.textContent.replace(/\W*\s(\S)*$/,"...")};return e}(i.default);r.default=n});define("af7",["require","exports","ap","kx","kU","cE","EJ"],function(e,t,i,o,n,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(o){i.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this;t.name="ShowExistingFlows";t._flowActionHelper=t.resources.consume(a.resourceKey);var i=t._flowActionHelper.getFlowConfiguration(t.item.peek());t._navigationAction=new(t.managed(n.default))({url:i.userFlowsUrl,target:"_blank"});return t}e.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};e.prototype.onIsAvailable=function(){var e=this.item(),t=o.prototype.onIsAvailable.call(this)&&this._flowActionHelper.checkBaseAvailability(e);if(t&&!this._visibilityLogged){this.resources.consume(r.resourceKey).logData({name:"ShowExistingFlowsAction.IsVisible"});this._visibilityLogged=!0}return t};return e}(o.default);t.default=s});define("af4",["require","exports","ap","bX","dZ","iE","kz","dR","cg","eQ","dY","aC","bE","fW","kq","aI","ba","eq","MZ","ey","af5","af5","EJ","qO","EH","fO","a0"],function(e,t,i,a,o,n,r,s,l,u,d,c,p,m,g,f,h,y,w,_,b,v,S,x,C,I,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k="x-ms-correlation-id",T="x-ms-workflow-name",A="x-ms-workflow-run-id",M="x-ms-client-request-id",R=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="TriggerFlow";t.isSingleSelectAction=!0;t.flow=e.flow;t.operationProvider=t.resources.consume(s.resourceKey);t.pageContext=t.resources.consume(n.pageContext);t._flowActionHelper=t.resources.consume(S.resourceKey);t._itemUrlHelper=t.resources.consume(I.resourceKey);t._isWidgetRequired=x.isWidgetRequired(t.flow);t._itemSelectionHelper=t.resources.consume(g.resourceKey);t._urlDataSource=t.resources.consume(o.url);if(x.isEmbeddedFlowsEnabled()){t._useReactFlowPanel=h.isFeatureEnabled(h.UseReactFlowPanel);t._flowWidgetProvider=t._useReactFlowPanel?t.resources.consume(v.resourceKey_ref):t.resources.consume(b.resourceKey)}t.setupWidgetData();return t}e.prototype.onSelectionExecute=function(t,e,i){var o=this;D.Engagement.logData({name:this.name+".Click",isIntentional:!0,extraData:{flowId:this.flow.id}});return this.onFlowTriggerInitialization(t).then(function(e){return e.resultType!==f.ResultTypeEnum.Success?c.default.wrap({resultType:f.ResultTypeEnum.Failure}):o._isWidgetRequired?x.isEmbeddedFlowsEnabled()?o._launchFlowPanel(t):c.default.wrap({resultType:f.ResultTypeEnum.ExpectedFailure}):o._triggerFlow(t)},function(e){return c.default.wrap({resultType:f.ResultTypeEnum.Failure})})};e.prototype.onSelectionIsAvailable=function(e,t){var i=!this._flowActionHelper.checkIsODB(t),o=h.isFeatureEnabled(h.SPOFlowIntegration)||_.isDocumentLibrary(this._flowActionHelper.getTemplateType(this.item.peek())),n=!x.isEmbeddedFlowsEnabled()&&this._isWidgetRequired;return r.prototype.onSelectionIsAvailable.call(this,e,t)&&(!i||o)&&!n&&this._flowActionHelper.checkBaseAvailability(t)&&!w.default.isFolder(t,!1)};e.prototype.onFlowCreationSucceeded=function(e,t){if(t&&t.flowId){this.flow.id=t.flowId;this.setupWidgetData()}};e.prototype.onRunFlowCompleted=function(e){var t=this;this._itemSelectionHelper.resolveSelection().then(function(e){t.onFlowTriggerComplete(e).then(function(e){t._widgetSignal.complete(e||{resultType:f.ResultTypeEnum.Failure})},function(e){t._widgetSignal.error({resultType:f.ResultTypeEnum.Failure})})})};e.prototype.onWidgetError=function(e){this._widgetSignal.error({resultType:f.ResultTypeEnum.Failure,extraData:e?{message:e.message}:void 0})};e.prototype.onFlowTriggerInitialization=function(e){return c.default.wrap({resultType:f.ResultTypeEnum.Success})};e.prototype.onFlowTriggerComplete=function(e){return c.default.wrap({resultType:f.ResultTypeEnum.Success})};e.prototype.setupWidgetData=function(){this.widgetDefaultParams={"parameters.sharepoint.site":this.pageContext.webAbsoluteUrl,"parameters.sharepoint.list":this.pageContext.listId.replace("{","").replace("}","")};this.widgetType="flowsRuntime";this.widgetActionName="triggerFlow";this.widgetActionData={flowName:this.flow.id}};e.prototype._launchFlowPanel=function(e){var t=this;if(x.isEmbeddedFlowsEnabled()){var i=e[0],o={flow:this.flow,widgetType:this.widgetType,actionName:this.widgetActionName,actionData:this.widgetActionData,widgetDefaultParams:this.widgetDefaultParams,onWidgetActionCallback:function(e){"FLOW_CREATION_SUCCEEDED"===e.type?t.onFlowCreationSucceeded(o,e.data):"RUN_FLOW_COMPLETED"===e.type?t.onRunFlowCompleted(o):t.onWidgetError(e.data)}};this.widgetActionData.implicitData=[JSON.parse(this.computeJsonBody(i))];this._widgetSignal=new p.default;this._useReactFlowPanel&&this._flowWidgetProvider.addListener(this);this._flowWidgetProvider.launchFlowWidget(o);return this._widgetSignal.getPromise().then(function(e){t._useReactFlowPanel&&t._flowWidgetProvider.removeListener(t);return c.default.wrap(e)})}return c.default.wrap({resultType:f.ResultTypeEnum.Failure})};e.prototype._triggerFlow=function(r){var a=this;this._flowOperation=this.operationProvider.register({name:this.flow.displayName,type:l.default.triggerFlow,payloads:{triggerFlow:{flowDisplayName:this.flow.displayName}}});this._flowOperation.progress.maximum(1);this._flowOperation.progress.current(0);return new(this.child(C.typeResourceKey))({item:this.item.peek()}).getFlowCallbackUrl(this.flow.id).then(function(e){if(!e){a._flowOperation.state(d.default.failed);return c.default.wrap({resultType:f.ResultTypeEnum.Failure})}var t={Accept:"application/json","Content-Type":"application/json"},i=null,o=a._flowActionHelper.getTemplateType(a.item.peek());if(_.isDocumentLibrary(o)||h.isFeatureEnabled(h.SPOFlowIntegration)){var n=r[0];n&&(i=a.computeJsonBody(n))}return m.default.start({url:e,method:"POST",headers:t,json:i}).then(function(e){var t,i=((t={})[a.formatQosData(k)]=e.getResponseHeader(k),t[a.formatQosData(T)]=e.getResponseHeader(T),t[a.formatQosData(A)]=e.getResponseHeader(A),t[a.formatQosData(M)]=e.getResponseHeader(M),t);if(202!==e.status){a._flowOperation.error(new u.default({message:e.responseText}));return c.default.wrap({resultType:f.ResultTypeEnum.Failure,extraData:i})}a._flowOperation.progress.current(1);a._flowOperation.state(d.default.completed);return c.default.wrap({resultType:f.ResultTypeEnum.Success,extraData:i})},function(e){a._flowOperation.error(new u.default({message:e}));return c.default.wrap({resultType:f.ResultTypeEnum.Failure})})},function(e){a._flowOperation.error(new u.default({message:e}));return c.default.wrap({resultType:f.ResultTypeEnum.Failure})})};e.prototype.computeJsonBody=function(e){var t=null,i=this.resources.consume(a.currentItemSet),o=this._urlDataSource.getDefaultClickUrl(e,{preferCurrentView:!0,itemSet:i()});o=0===(o=0===o.indexOf("#")?window.location.pathname+o:o).indexOf("/")?y.getServerUrl(this.pageContext)+o:o;if(this._flowActionHelper.checkIsODB(e)){var n="/"+this._itemUrlHelper.getItemUrlParts(e.key).listRelativeItemUrl;t=JSON.stringify({filePath:n,fileUrl:o})}else t=JSON.stringify({ID:e.properties.ID,itemURL:o,fileName:e.displayName});return t};e.prototype.formatQosData=function(e){return e?e.replace(/-/g,"_"):e};return e}(r.default);t.default=R});define("af5",["require","exports","ap","aC","bN","bX","ba","cL","cg","dY","aZ","aI","cE","bA","i0","dR","af6"],function(n,e,t,r,i,a,s,l,u,d,c,p,m,o,g,f,h){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var y="od-Flow-iframeContainer-",w="FlowWidgetPanel.",_=function(o){t.__extends(e,o);function e(e,t){void 0===e&&(e={});var i=o.call(this,e,t)||this;i._operationProvider=t.operationProvider;i._engagement=t.engagement;i._widgetData=t.widgetData;i.isWidgetReady=i.createObservable(!1);i.isWidgetRendered=i.createObservable(!1);i.showWidget=i.createObservable(!1);i.containerId=y+c.default.generate();return i}e.prototype.launchFlowWidget=function(t){var i=this;this._engagement.logData({name:w+".PanelOpened",extraData:{flowId:t.flow.id}});if(!this._createWidgetPromise||"triggerFlowByTemplate"===t.actionName){if(this._widget){this._widget.dispose();this._widget=null}this._createWidgetPromise=this._createWidget(t)}if(this._widget){this._notifyWidget(t);return r.default.wrap()}return this._createWidgetPromise.then(function(){},function(e){i._createWidgetPromise=null;i.showWidget(!0);i._onWidgetError(e,t)})};e.prototype.closePanel=function(e){this.showWidget(!1);this._operation&&void 0!==e&&this._operation.state(e);this._operation=null;this._widgetData().onClose()};e.prototype._createWidget=function(o){var n=this;return new r.default(function(t,i){return n._ensureWidgetData().then(function(e){n.showWidget(!0);n._renderWidget(e,o).then(function(e){t()},function(e){i(e)})})})};e.prototype._registerListeners=function(t){var i=this;if(this._widget){this._activateTimeout("WIDGET_READY",t);this._widget.listen("GET_ACCESS_TOKEN",function(e,t){i._getToken(i._widgetData()).then(function(e){t(null,{token:e})})});this._widget.listen("WIDGET_READY",function(){i._notifyWidget(t);i.isWidgetReady(!0);i._activateTimeout("WIDGET_RENDERED",t)});this._widget.listen("WIDGET_RENDERED",function(){i.isWidgetRendered(!0);i._renderWidgetQos.end({resultType:p.ResultTypeEnum.Success})});this._widget.listen("RUN_FLOW_COMPLETED",function(){i._onRunFlowCompleted(t)});this._widget.listen("RUN_FLOW_CANCEL_BUTTON_CLICKED",function(){i._onRunFlowCanceled(t)});this._widget.listen("FLOW_CREATION_SUCCEEDED",function(e){i._onFlowCreated(t,e)})}};e.prototype._activateTimeout=function(e,t){var i,o,n=this;switch(e){case"WIDGET_READY":i=this.isWidgetReady;break;case"WIDGET_RENDERED":i=this.isWidgetRendered;break;default:return}var r=this.async.setTimeout(function(){n._onWidgetError(new Error("Timeout: Widget timed out waiting for: "+e),t);o&&o.dispose()},15e3);o=this.subscribe(i,function(e){if(e){n.async.clearTimeout(r);o.dispose()}})};e.prototype._notifyWidget=function(t){var e=this;if(this._widget){this.showWidget(!0);this._widget.callbacks.RUN_FLOW_STARTED=function(){e._onRunFlowStarted(t);e._engagement.logData({name:w+".RunFlowClicked",extraData:{flowId:t.flow.id}})};var i=new p.Qos({name:w+"NotifyWidget"});this._widget.notify(t.actionName,t.actionData).then(function(){i.end({resultType:p.ResultTypeEnum.Success,extraData:{flowId:t.flow.id}})}).catch(function(e){i.end({resultType:p.ResultTypeEnum.Failure,extraData:{flowId:t.flow.id,message:e.code}})})}};e.prototype._onRunFlowStarted=function(e){this._operation=this._operationProvider.register({name:e.flow.displayName,type:u.default.triggerFlow,payloads:{triggerFlow:{flowDisplayName:e.flow.displayName}}});this._operation.progress.maximum(1);this._operation.progress.current(0)};e.prototype._onRunFlowCompleted=function(e){this._operation&&this._operation.progress.current(1);this.closePanel(d.default.completed);e.onWidgetActionCallback&&e.onWidgetActionCallback({type:"RUN_FLOW_COMPLETED"})};e.prototype._onRunFlowCanceled=function(e){this._engagement.logData({name:w+".CancelClicked",extraData:{flowId:e.flow.id}});this.closePanel(d.default.canceled);e.onWidgetActionCallback&&e.onWidgetActionCallback({type:"RUN_FLOW_CANCEL_BUTTON_CLICKED"})};e.prototype._onFlowCreated=function(e,t){e&&e.onWidgetActionCallback&&e.onWidgetActionCallback({type:"FLOW_CREATION_SUCCEEDED",data:t?t.data:void 0})};e.prototype._onWidgetError=function(e,t){this._widgetData().onWidgetError(e);this._renderWidgetQos.end({resultType:p.ResultTypeEnum.Failure,extraData:{message:e.message}});t.onWidgetActionCallback&&t.onWidgetActionCallback({type:"ERROR",data:e})};e.prototype._renderWidget=function(i,o){var n=this,e=this._loadSdk(),t=this._ensureIframeContainerElement(i);return r.default.all([e,t]).then(function(e){if(!n._widget){var t={container:e[1].id,environmentId:o.flow.environmentId,enableOnBehalfOfTokens:!0,widgetStyleSettings:i.widgetStyleSettings};o.widgetDefaultParams&&(t.templatesSettings={useServerSideProvisioning:!0,defaultParams:o.widgetDefaultParams});n._renderWidgetQos=new p.Qos({name:w+"RenderWidget"});try{n._widget=n._sdk.renderWidget(o.widgetType,t);n._registerListeners(o)}catch(e){n._onWidgetError(e,o);return r.default.wrapError(e)}}return n._widget})};e.prototype._loadSdk=function(){var i=this;return new r.default(function(t){i._sdk?t():n(["msflowsdk"],function(e){i._sdk=new MsFlowSdk({hostName:s.isFeatureEnabled(s.PowerAppsAndAndProcessSimpleTestEnvironment)?"https://tip1.flow.microsoft.com":"https://flow.microsoft.com",locale:l.default.language});t()})})};e.prototype._ensureIframeContainerElement=function(o){var n=this;return new r.default(function(t){var e=o.iframeContainerElement;if(e())t(e());else var i=n.subscribe(e,function(e){if(e){i.dispose();t(e)}})})};e.prototype._ensureWidgetData=function(){var o=this;return new r.default(function(t){var e=o._widgetData;if(e&&e())t(e());else var i=o.subscribe(e,function(e){if(e){i.dispose();t(e)}})})};e.prototype._getToken=function(o){var e=this;return new r.default(function(t){var i=new p.Qos({name:w+"GetToken"});e.resources.consume(g.resourceKey).getToken("https://service.flow.microsoft.com/").then(function(e){t(e);i.end({resultType:p.ResultTypeEnum.Success})},function(e){o.onTokenError&&o.onTokenError(e);i.end({resultType:p.ResultTypeEnum.Failure,extraData:{serverErrorCode:e._serverErrorCode,message:e.message}});t(null)})})};e.dependencies=t.__assign({},i.default.dependencies,{operationProvider:f.resourceKey,engagement:m.resourceKey,widgetData:a.widgetData.optional});return e}(i.default);e.default=_;e.resourceKey=o.createResolvedResourceKey(n("module").id,_);e.resourceKey_ref=o.createResolvedResourceKey(n("module").id,h.default,{widgetData:a.widgetDataSignal,oAuthTokenProvider:g.resourceKey})});define("af6",["require","exports","aC","bS","aW","cL","a0","gm","aZ","aI","bf","ax"],function(o,e,r,i,n,a,s,l,u,d,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c={ODB:751},p="od-Flow-iframeContainer-",m="FlowWidgetPanel.",g=function(){function e(e,t){void 0===e&&(e={});this._widgetData=t.widgetData;this._oAuthTokenProvider=t.oAuthTokenProvider;this.containerId=p+u.default.generate();this._listeners=new Array;this._async=new i.default;this._isWidgetReady=!1}e.prototype.addListener=function(e){this._listeners.push(e)};e.prototype.removeListener=function(e){var t=this._listeners.indexOf(e);0<=t&&this._listeners.splice(t)};e.prototype.launchFlowWidget=function(t){var i=this;s.default.logData({name:m+".PanelOpened",extraData:{flowId:t.flow.id}});this._onLaunchWidget();return this._getWidget(t).then(function(e){i._widget=e;i._notifyWidget(t)},function(e){i._onWidgetError(e,t)})};e.prototype.onDismiss=function(){this._notifyWidgetQos||this._notifyWidgetQos.end({resultType:d.ResultTypeEnum.Success,extraData:{message:"onDismiss"}});this._onRunFlowCanceled(void 0)};e.prototype.closeWidget=function(){this._listeners.forEach(function(e){e.onCloseWidget&&e.onCloseWidget()})};e.prototype._getWidget=function(e){var t=this;if(!this._createWidgetPromise||"triggerFlowByTemplate"===e.actionName||e.widgetType!==(this._widget&&this._widget.getWidgetType())){if(this._widget){this._widget.dispose();this._widget=null;this._isWidgetReady=!1}this._createWidgetPromise=this._createWidget(e)}return this._widget?r.default.wrap(this._widget):this._createWidgetPromise.then(function(e){return e},function(e){t._createWidgetPromise=null;return r.default.wrapError(e)})};e.prototype._createWidget=function(o){var n=this;return new r.default(function(t,i){n._widgetData.getPromise().then(function(e){n._renderWidget(e,o).then(function(e){t(e)},function(e){i(e)})})})};e.prototype._registerListeners=function(t){var i=this;if(this._widget){var e,o=this._activateTimeout("WIDGET_READY",t);this._widget.listen("GET_ACCESS_TOKEN",function(e,t){i._getToken().then(function(e){t(null,{token:e})})});this._widget.listen("WIDGET_READY",function(){i._isWidgetReady=!0;i._notifyWidget(t);i._async.clearTimeout(o);e=i._activateTimeout("WIDGET_RENDERED",t)});this._widget.listen("WIDGET_RENDERED",function(){i._onWidgetRendered();i._async.clearTimeout(e)});this._widget.listen("RUN_FLOW_COMPLETED",function(){i._onRunFlowCompleted(t)});this._widget.listen("RUN_FLOW_CANCEL_BUTTON_CLICKED",function(){i._onRunFlowCanceled(t)});this._widget.listen("FLOW_CREATION_SUCCEEDED",function(e){i._onFlowCreated(t,e)});this._widget.listen("RECEIVED_APPROVAL_STATUS_CHANGED",function(e){i._onApprovalStatusChanged(e)})}};e.prototype._activateTimeout=function(e,t){var i=this;return this._async.setTimeout(function(){i._onWidgetError(new Error("Timeout: Widget timed out waiting for: "+e),t)},15e3)};e.prototype._notifyWidget=function(i){var o=this,e=!!this._widget;t.Killswitch.isActivated("7F471D6A-BFA2-4F72-BE2C-6601BA0A50E6","3/8/2018","Check isWidgetReady in notifyWidget")||(e=!!this._widget&&this._isWidgetReady);if(e){this._widget.callbacks.RUN_FLOW_STARTED=function(){o._onRunFlowStarted(i);s.default.logData({name:m+".RunFlowClicked",extraData:{flowId:i.flow.id}})};this._notifyWidgetQos=new d.Qos({name:m+"NotifyWidget"});this._widget.notify(i.actionName,i.actionData).then(function(){o._notifyWidgetQos.end({resultType:d.ResultTypeEnum.Success,extraData:{flowId:i.flow.id}})}).catch(function(e){if(e){var t="runFlowWidgetCancelled"===e.code?d.ResultTypeEnum.Success:d.ResultTypeEnum.Failure;o._notifyWidgetQos.end({resultType:t,extraData:{flowId:i.flow.id,message:e.code}})}else o._notifyWidgetQos.end({resultType:d.ResultTypeEnum.Failure,extraData:{flowId:i.flow.id,message:"Error unknown: no error returned in the notifyWidget promise catch clause."}})})}};e.prototype._onRunFlowStarted=function(t){this._listeners.forEach(function(e){e.onRunFlowStarted&&e.onRunFlowStarted(t)})};e.prototype._onWidgetRendered=function(){this._getRenderWidgetQos().end({resultType:d.ResultTypeEnum.Success});this._listeners.forEach(function(e){e.onWidgetRendered&&e.onWidgetRendered()})};e.prototype._onRunFlowCompleted=function(t){this._listeners.forEach(function(e){e.onRunFlowCompleted&&e.onRunFlowCompleted(t)})};e.prototype._onRunFlowCanceled=function(t){var e=t?{flowId:t.flow.id}:{};s.default.logData({name:m+".CancelClicked",extraData:e});this._listeners.forEach(function(e){e.onRunFlowCanceled&&e.onRunFlowCanceled(t)})};e.prototype._onFlowCreated=function(t,e){var i=e?e.data:void 0;this._listeners.forEach(function(e){e.onFlowCreationSucceeded&&e.onFlowCreationSucceeded(t,i)})};e.prototype._onApprovalStatusChanged=function(t){this._listeners.forEach(function(e){e.onApprovalStatusChanged&&e.onApprovalStatusChanged(t)})};e.prototype._onWidgetError=function(t,e){this._getRenderWidgetQos().end({resultType:d.ResultTypeEnum.Failure,extraData:{message:t.message}});this._listeners.forEach(function(e){e.onWidgetError&&e.onWidgetError(t)})};e.prototype._onTokenError=function(t){this._listeners.forEach(function(e){e.onTokenError&&e.onTokenError(t)})};e.prototype._onLaunchWidget=function(){this._listeners.forEach(function(e){e.onLaunchWidget&&e.onLaunchWidget()})};e.prototype._renderWidget=function(i,o){var n=this,e=this._loadSdk(),t=i.iframePromise;return r.default.all([e,t]).then(function(e){if(!n._widget){var t={container:e[1].id,environmentId:o.flow.environmentId,enableOnBehalfOfTokens:!0,enableRegionalPortal:!0,widgetStyleSettings:i.widgetStyleSettings,approvalCenterSettings:o.approvalCenterSettings};o.widgetDefaultParams&&(t.templatesSettings={useServerSideProvisioning:!0,defaultParams:o.widgetDefaultParams});n._renderWidgetQos=new d.Qos({name:m+"RenderWidget"});try{n._widget=n._sdk.renderWidget(o.widgetType,t);n._registerListeners(o)}catch(e){return r.default.wrapError(e)}}return n._widget})};e.prototype._loadSdk=function(){var i=this;return new r.default(function(t){if(i._sdk)t();else{"undefined"==typeof __webpack_require__&&l.default.addConfig({paths:{"@ms/msflowsdk":"msflowsdk"},enforceDefine:!1,shim:{msflowsdk:{exports:"MsFlowSdk"}}});new Promise(function(e,t){o(["@ms/msflowsdk"],e,t)}).then(function(e){i._sdk=new MsFlowSdk({hostName:n.default.isFeatureEnabled(c)?"https://tip1.flow.microsoft.com":"https://flow.microsoft.com",locale:a.default.language});t()})}})};e.prototype._getToken=function(){var o=this;return new r.default(function(t){var i=new d.Qos({name:m+"GetToken"});o._oAuthTokenProvider.getToken("https://service.flow.microsoft.com/").then(function(e){t(e);i.end({resultType:d.ResultTypeEnum.Success})},function(e){o._onTokenError(e);i.end({resultType:d.ResultTypeEnum.Failure,extraData:{serverErrorCode:e._serverErrorCode,message:e.message}});t(null)})})};e.prototype._getRenderWidgetQos=function(){this._renderWidgetQos||(this._renderWidgetQos=new d.Qos({name:m+"RenderWidget"}));return this._renderWidgetQos};return e}();e.default=g});define("af3",["require","exports","ap","kz","aC","af4","EH"],function(e,t,o,i,l,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="TriggerFlowById";t.isSingleSelectAction=!0;t._flowId=e.flow.id;return t}e.prototype.onSelectionExecute=function(n,r,e){var a=this,t=new(this.child(d.typeResourceKey))({item:this.item.peek()}),s=this._flowId;return new l.default(function(i,o){t.getFlowInstance(s).done(function(e){var t=new(a.child(u.default))({flow:e});null!==n&&0<n.length&&t.isAvailable()?t.execute(r).done(function(e){i(e)},function(e){o(e)}):o(null)},function(e){o(e)})})};return e}(i.default);t.default=n});define("af0",[],function(){return"\x3c!--ko component: {\r\n name: filesTagName,\r\n params: filesParams\r\n}--\x3e\x3c!--/ko--\x3e"});