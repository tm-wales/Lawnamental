define("u7",["require","exports","u9","b5","u8"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n.registerComponent({tagName:"od-embed",template:e("u8"),viewModel:r.default,synchronous:!0});t.default=a});define("u9",["require","exports","ap","bF","dc","b3","d0","va","eX","bX","dZ","te"],function(e,t,r,n,v,g,y,b,h,w,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(m){r.__extends(e,m);function e(e,t){var r=m.call(this,e,t)||this;r.addBindingHandlers({control:g.default});var n=r,a=n.observables,i=n.resources,o=i.consume(v.navigation).viewParams,s=i.consume(_.url),d=i.consume(h.resourceKey),u=s.getFocusItemKey(o)||s.getCurrentItemKey(o),c=s.getKeyParams(u),l={parentKey:u,ownerId:s.getOwnerId(u),queryType:s.getQueryType(c),ignoreChildren:!0},f=d.getItemSync(l);d.getItem(l);var p=f.item;i.expose(w.currentItemSet,a.create(f));r.controlBindingOptions={specification:g.toSpecification(b.default,{item:p}),placeholder:g.toSpecification(y.resourceKey,{})};return r}return e}(n.default);t.default=a});define("va",["require","exports","vc","b3","vb"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedControlDefinitionResourceKey({automationName:"od-embed-internal",name:e("module").id,template:e("vb"),viewModelType:r.default});t.default=t.resourceKey});define("vc",["require","exports","ap","bF","bP","dc","aI","a3","a2","k6","vj","b3","cJ","vf","d0","q0","re","qT","cF","dL","bX","d7","iE","ve","vd","te"],function(e,x,t,r,I,P,S,C,M,O,k,E,B,D,T,K,R,F,q,A,z,N,j,H,L){"use strict";Object.defineProperty(x,"__esModule",{value:!0});x.EMBED_PARAM_KEY="embed";var U="Embed",V="PageContext"in window?"OneDrive-Embed":"Embed",J="OfficeDocClickTime",X=new q.EngagementPart("Embed",3),n=function(_){t.__extends(e,_);function e(e,t){var r=_.call(this,e,t)||this;r.addBindingHandlers({control:E.default,keyboard:B.default});var n=r,a=n.observables,i=n.resources,o={clientId:e.clientId,CorrelationId:i.consume(j.pageContext).CorrelationId};i.expose(q.engagementSourceResourceKey,i.consume(q.engagementSourceResourceKey).withPart(X,{extraData:o}));var s=new S.Qos({name:V+"-Load",extraData:o}),d=i.consume(P.navigation).viewParams,u=e.item,c=e.options,l=void 0===c?function(e){var t=e[x.EMBED_PARAM_KEY];if(t)try{return JSON.parse(t)}catch(e){}}(d)||{}:c,f=e.overrideUrl,p=e.viewer;"number"==typeof l.ct&&new C.default("",M.default.session).setValue(J,new Date(l.ct));var m=e.onLoad,v={mappings:{}};if(!m&&l.o&&l.id){var g=r.scope.attach(new(i.consume(H.typeResourceKey))({id:l.id,origin:l.o,scenario:U}));e.useHostDownload&&i.expose(L.resourceKey,g);m=function(e){g.sendMessage(e)};v={target:document,mappings:{Esc:function(){g.sendMessage({type:"close"});return!1}}}}var y=new O.default;y.DownloadAction=k.default;i.expose(z.actionMap,y);var b=i.consume(N.bundleLoader);i.exposeFactory(N.overlay,A.factory);var h={viewer:p,url:f};i.expose(z.currentItem,u);r.keyboardBindingOptions=v;var w=a.createCallback(I.forSingleValue());a.backgroundCompute(function(){var t=w.peek();t?r.async.setImmediate(function(){b.pageLoaded(V);if(m){var e=t.resultType;m(e===S.ResultTypeEnum.Success?{type:"success",previewType:"content"}:{type:"error",isExpected:e===S.ResultTypeEnum.ExpectedFailure,error:{code:t.resultCode,message:t.error}})}}):w()});"number"==typeof l.p&&(h.page=l.p);"number"==typeof l.z?h.zoom=l.z:"contain"===l.z?h.zoom="page-fit":"width"===l.z&&(h.zoom="page-width");"boolean"!=typeof l.af&&"number"!=typeof l.af||(h.autofocus=!!l.af);h.qosEvent=s;r.controlBindingOptions={specification:E.toSpecification(D.default,{item:u,loadResult:w,renderOptions:h}),placeholder:E.toSpecification(T.resourceKey,{})};r.components=a.createArray([{name:K.default.tagName,params:{}},{name:R.default.tagName,params:{}},{name:F.default.tagName,params:{}}]);return r}return e}(r.default);x.default=n});define("vj",["require","exports","ap","vk","dc","aI","g4","eA","eO","dZ","gO","vd","cY"],function(e,t,r,n,p,s,a,m,d,v,i,g,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(f){r.__extends(e,f);function e(e,t){void 0===t&&(t={});var r=f.call(this,e)||this,n=r.resources,a=t.embedMessenger,i=void 0===a?n.consume(g.resourceKey.optional):a,o=t.graphDataSource,s=void 0===o?n.consume(v.graph):o,d=t.itemParentHelper,u=void 0===d?n.consume(m.resourceKey):d,c=t.navigation,l=void 0===c?n.consume(p.navigation):c;r._graphDataSource=s;r._item=e.item;r._itemParentHelper=u;r._messenger=i;r._navigation=l;return r}e.prototype.onExecute=function(e,t){var r=this,n=this._item.peek(),a={fileType:d.default[n.type],extension:n.extension||""},i={resultType:s.ResultTypeEnum.Success,extraData:a,extraMetrics:{count:1}},o=this._messenger;return o?o.sendMessage({type:"download"}).then(function(){return i},function(){return{resultType:s.ResultTypeEnum.Failure,resultCode:"AcknowledgeTimeout",error:"Message timed out"}}):this._graphDataSource.getDownloadUrl(n,{useDirectEndpoint:!0}).then(function(e){r._navigation.navigateTo(e);return i})};e.prototype.onIsAvailable=function(){var e=this._item();if(!e)return!1;if(3===e.itemStatus||4===e.itemStatus)return!1;if(!o.PermissionMask.hasItemPermission(e,o.PermissionMask.openItems))return!1;if(e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected)return!1;var t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return n.canDownloadItem(i.convertToISPListItem(e),i.convertToISPListItem(t),!1)};return e}(a.default);t.default=u});define("vk",["require","exports","gA","dp","aW","ey"],function(e,t,n,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.canDownloadItem=function(e,t,r){return!(e.type===a.default.OneNote||e.list||e.subsite||(!i.default.isFeatureEnabled({ODB:831,ODC:"UseDownloadMicroservice"})||r||!e.urls[n.UrlType.downloadAsZip]||!e.urls[n.UrlType.itemUrl]||0===e.childCount||e.type!==a.default.Folder)&&(e.isRootFolder||!t||t&&t.list&&t.list.templateType===o.default.webPageLibrary||e.type!==a.default.File&&e.type!==a.default.Media&&e.type!==a.default.Unknown))}});define("vd",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey("messenger")});define("vf",["require","exports","vi","b3","vh","vg"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedControlDefinitionResourceKey({automationName:"od-itemPreview",name:e("module").id,template:e("vh"),viewModelType:r.default});t.default=t.resourceKey});define("vi",["require","exports","ap","bF","bP","cL","qS","cm","bU","r8","rX","rY","pH","d5"],function(e,t,r,n,p,m,v,g,y,b,a,h,w,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(f){r.__extends(e,f);function e(e,t){var r=f.call(this,e,t)||this,n=r.observables;r.resources.expose(h.default,n.create(!1));r.addBindingHandlers({childFocus:g.default,clientRect:v.default,idle:y.default});var a=r.isIdle=n.create(!1),i=r.isDetailsFocused=n.create(!1),o=r.size=n.create({width:0,height:0}),s=n.create(),d=n.createCallback(p.forSingleValue());r.scope.attach(e.loadResult.register(d));var u={slide:{item:e.item,loadState:n.create(0),offset:n.create(0)},loadResult:d,oneUp:{isCommandBarVisible:n.create(!1),isInfoPaneExpanded:n.create(!1),enableSlideControls:n.create(!1),isRotating:n.create(!1),size:o,slide:s},renderOptions:e.renderOptions},c=r.isIdleEnabled=n.pureCompute(function(){var e=s();return!!e&&e.isIdleEnabled()});r.isAwake=n.pureCompute(function(){return i()||!a()||!c()});r.detailsBarStyle=n.pureCompute(function(){var e,t=_.default.getScrollbarWidth(),r=s(),n=r&&r.hasHorizontalScrollbar()?t:0,a=r&&r.hasVerticalScrollbar()?t:0;return(e={bottom:n+"px"})[m.default.safeRight]=a+"px",e});r.contentComponent={name:b.default.tagName,params:u};var l=t.agentProvider;r.detailsComponent={name:w.default.tagName,params:{provider:l}};r.showDetails=n.pureCompute(function(){return 0<l.contexts().length});return r}e.dependencies=r.__assign({},n.default.dependencies,{agentProvider:a.resourceKey});return e}(n.default);t.default=i});define("vh",[],function(){return'<div class=ItemPreview data-bind="css: { \'ItemPreview--awake\': isAwake }, clientRect: { size: size }, idle: { isIdle: isIdle, isEnabled: isIdleEnabled }">\x3c!--ko component: contentComponent--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showDetails--\x3e<div class=ItemPreview-detailsBar data-bind="component: detailsComponent, style: detailsBarStyle, childFocus: isDetailsFocused"></div>\x3c!--/ko--\x3e</div>'});define("vg",["c","az"],function(e,t){e.loadStyles([{rawString:".ItemPreview{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;outline:0;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.ItemPreview-detailsBar{visibility:hidden;opacity:0;transition:visibility 0s linear 267ms,opacity 267ms linear,bottom 267ms linear;position:absolute;left:0;right:0;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";z-index:1}html[dir=ltr] .ItemPreview-detailsBar .CommandBarItem{margin-right:0}html[dir=rtl] .ItemPreview-detailsBar .CommandBarItem{margin-left:0}.ItemPreview-detailsBar .CommandBarItem .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.ItemPreview-detailsBar .CommandBarItem.is-toggled,.ItemPreview-detailsBar .CommandBarItem.is-toggled:hover,.ItemPreview-detailsBar .CommandBarItem:hover{background-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.ItemPreview--awake .ItemPreview-detailsBar{visibility:inherit;opacity:1;transition-delay:0s,0s,0s}"}])});define("ve",["require","exports","ap","bN","aC","bE","bi","bA"],function(e,t,n,r,d,c,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=0;function l(e,t){return"[OneDrive:"+e+":"+t.scenario+":"+t.id+"]"}var s=function(u){n.__extends(e,u);function e(e,t){var r=u.call(this,e,t)||this,n=t.currentWindow,a=void 0===n?window:n;r._params=e;var i=r._postMessageTargetSignal=new c.default,o=e.origin,s=a.parent!==a&&a.parent||a.opener;r._responseSignals={};if(s){var d=r._getOrigin(s,o).origin;i.complete({window:s,origin:d})}else i.complete({window:{postMessage:function(e){var t=e.slice(e.indexOf("]")+1);try{window.external.messageToHost(t)}catch(e){console.error("Error messaging host!")}}},origin:o});r.events.on(a,"message",r._onMessage);return r}e.prototype.sendMessage=function(e){var t=o++,r=n.__assign({},e,{conversationId:t});return this._sendRequest(r)};e.prototype._getOrigin=function(e,t){var r;try{r=new a.default(e.location.href).authority}catch(e){t===this._params.origin&&(r=t)}return{origin:r}};e.prototype._sendRequest=function(o){var s=this;return this._postMessageTargetSignal.getPromise().then(function(e){var t=e.window,r=e.origin,n=o.conversationId,a=""+l("From",s._params)+JSON.stringify(o),i=new c.default;s._responseSignals[n]=i;try{t.postMessage(a,r)}catch(e){return d.default.wrapError(e)}return i.getPromise().then(function(e){delete s._responseSignals[n];return e})})};e.prototype._onMessage=function(r){var n=this,e=""+(r.data||""),t=l("To",this._params);if(0===e.indexOf(t))try{var a=JSON.parse(e.slice(t.length));this._postMessageTargetSignal.getPromise().done(function(e){if(r.origin===e.origin){var t=n._responseSignals[a.conversationId];t&&t.complete(a)}})}catch(e){}};e.dependencies=n.__assign({},r.default.dependencies);return e}(r.default);t.default=s;t.typeResourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:s.dependencies,create:function(r){return{instance:function(t){n.__extends(e,t);function e(e){return t.call(this,e,r)||this}return e}(s)}}}})});define("vb",[],function(){return'<div class=Embed data-bind="keyboard: keyboardBindingOptions">\x3c!--ko control: controlBindingOptions--\x3e\x3c!--/ko--\x3e\x3c!--ko foreach: components--\x3e\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});define("u8",[],function(){return"\x3c!--ko control: controlBindingOptions--\x3e\x3c!--/ko--\x3e"});