define("K8",["require","exports","te"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});define("K9",["require","exports","ap","M7","M6","dI","dG","bX","dZ","M5","rs","dm","M4","s5","rZ","EH","M3","ba","bb","M2","A5","M1","iE","tx","M0","dH","MZ","dn","bD","eX","MY","MM","MA","Mz","My","Mx","Ml","L1","L0","LZ","kD","LX","LW","LV","LU","LT","LR","LP","LO","LI","LG","LF","LE","LD","kS","LC","kN","LA","Ly","Lx","Lw","Lv","Lu","Lo","Ll","Lj","Lg","La","te"],function(e,t,r,i,I,T,w,o,n,a,E,D,A,M,F,s,L,R,l,d,c,u,p,m,N,O,h,B,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var V=16,y=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.sourceNameEngagement=e.sourceNameEngagement;t._parentNavigation=!e.disableParentNavigation;t._urlDataSource=t.resources.consume(n.url);t._currentItemSet=t.resources.consume(o.currentItemSet);t._currentItem=t.resources.consume(o.currentItem);t._pageContext=t.resources.consume(p.pageContext);t._itemProvider=t.resources.consume(g.resourceKey);t.commandSetHelper=new(t.managed(d.default));t.filesCommandSetHelper=new(t.managed(c.default))({showLabels:t.responsiveUI.showLabels});t._viewCommandBuilder=new(t.managed(u.default))({isHidden:t.selectionModeOn});t._fileHandlerCommands=t.scope.attach(new(t.resources.consume(m.typeResourceKey.local))({sourceEngagementName:t.sourceNameEngagement,includeLegacyActions:!0}));t._urlDataSource=t.resources.consume(n.url);t._viewParams=t.resources.consume(o.viewParams);t._contentTypeCommands=t.createPureComputed(t._computeContentTypeCommands);t._newCommands=t.createPureComputed(t._computeNewCommands);t._staticFlows=t.commandSetHelper.getStaticFlowCommands(t.sourceNameEngagement);t._flowCommands=t.observables.createArray(t._staticFlows);t._originalFlows=[];t.buildCommands();return t}e.prototype.buildCommands=function(){var e=this,t=this.createPureComputed(function(){return e.filesCommandSetHelper.computeOpenInOfficeOnlineText()}),i=this.createPureComputed(function(){return e.filesCommandSetHelper.computeOpenInOfficeClientText()}),r=this.createPureComputed(function(){return e.filesCommandSetHelper.computeOfficeIcon()}),o=this.createPureComputed(function(){return e.filesCommandSetHelper.computeOfficeClass()}),n=this.observables.createArray();this.createBackgroundComputed(function(){n.splice.apply(n,[0,n.peek().length].concat(e._newCommands()))});var a=new(this.managed(E.CommandViewModel))({text:D.strings.SortAscending,isToggleable:!0,action:new(this.managed(this.actionMap.OneDriveSortAction))({mode:I.default.Order,ascending:!0}),engagementName:"SortAsc"+this.sourceNameEngagement}),s=new(this.managed(E.CommandViewModel))({text:D.strings.SortDescending,isToggleable:!0,hasLineBreakAfter:!0,action:new(this.managed(this.actionMap.OneDriveSortAction))({mode:I.default.Order,ascending:!1}),engagementName:"SortDesc"+this.sourceNameEngagement}),l=new(this.managed(A.default))({currentItemSet:this._currentItemSet,itemsToAppend:[a,s]}),d=new(this.managed(E.CommandViewModel))({newFeatureAnchorName:L.default.TopBarNew,text:D.strings.Create,tooltip:D.strings.CreateCommandTooltip,icon:new T.default("Add"),renderLabel:2,isHidden:this.selectionModeOn,requiredChildren:1,resources:this.resources,engagementName:"New"+this.sourceNameEngagement,children:n}),c=[new(this.managed(E.CommandViewModel))({classSuffix:o,text:t,renderLabel:2,icon:r,action:new(this.managed(this.actionMap.OpenInOfficeOnlineAction)),engagementName:"OpenOnline"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({classSuffix:o,text:i,renderLabel:2,icon:r,action:new(this.managed(this.actionMap.OpenInOfficeClientAction)),engagementName:"OpenIn"+this.sourceNameEngagement})],u=[new(this.managed(E.CommandViewModel))({classSuffix:"pdf",text:D.strings.OpenInBrowser,renderLabel:2,icon:new T.default("PDF"),action:new(this.managed(this.actionMap.OpenPdfInBrowserAction)),engagementName:"OpenInBrowser"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.OpenInTextEditor,renderLabel:2,icon:new T.default("Edit"),action:new(this.managed(this.actionMap.OpenInTextEditorAction)),engagementName:"OpenInTextEditor"+this.sourceNameEngagement})],p=this.observables.createArray([]);this.createBackgroundComputed(function(){p.splice.apply(p,[0,1/0].concat(c,e._fileHandlerCommands.openWithCommands(),u))});var m=this.createPureComputed(function(){for(var e={},t=0,i=p();t<i.length;t++){var r=i[t];if(r.isVisible()){var o=r.icon(),n=r.iconUrl();if(o&&"Page"!==o.toString()||n){e.icon=o;e.iconUrl=n;return e}}}e.icon=new T.default("Page");return e}),h=this.createPureComputed(function(){return m().icon}),f=this.createPureComputed(function(){return m().iconUrl}),g=this.createObservable([d,new(this.managed(E.CommandViewModel))({text:D.strings.Upload,tooltip:D.strings.UploadCommandTooltip,icon:new T.default("Upload"),renderLabel:2,isHidden:this.selectionModeOn,requiredChildren:1,engagementName:"Upload"+this.sourceNameEngagement,children:this.observables.createArray([new(this.managed(E.CommandViewModel))({text:D.strings.UploadFile,collapsedText:this.observables.create(D.strings.Upload),action:new(this.managed(this.actionMap.UploadAction))({uploadProcessorType:w.UploadProcessorType.Html5file}),engagementName:"UploadFiles"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.UploadFolder,action:new(this.managed(this.actionMap.UploadAction))({uploadProcessorType:w.UploadProcessorType.Folder}),engagementName:"UploadFolder"+this.sourceNameEngagement})])}),new(this.managed(E.CommandViewModel))({text:D.strings.selectItems,renderLabel:2,icon:new T.default("CheckboxComposite"),action:new(this.managed(this.actionMap.ToggleSelectionModeAction))}),new(this.managed(E.CommandViewModel))({classSuffix:o,text:D.strings.Open,tooltip:D.strings.Open,icon:h,iconUrl:f,renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!1,keys:["O"],children:p}),new(this.managed(E.CommandViewModel))({text:D.strings.Preview,location:8,renderLabel:2,engagementName:"Preview",action:new(this.managed(this.actionMap.PreviewAction))({})}),new(this.managed(E.CommandViewModel))({text:D.strings.SaveViewCommit,icon:new T.default("Save"),renderLabel:2,action:new(this.managed(this.actionMap.SaveAction))}),new(this.managed(E.CommandViewModel))({text:D.strings.viewInFolder,iconUrl:B.getIconUrl(this.resources,"folder",V),renderLabel:2,automationId:"viewInFolder",action:new(this.managed(this.actionMap.ViewInFolderAction))}),new(this.managed(F.default))({renderLabel:2,mode:0}).command,new(this.managed(F.default))({renderLabel:2,mode:1}).command]),y=new(this.managed(E.CommandViewModel))({text:D.strings.Download,renderLabel:2,icon:new T.default("Download"),action:new(this.managed(this.actionMap.DownloadAction)),engagementName:"Download"+this.sourceNameEngagement}),v=this.createObservable([y,new(this.managed(E.CommandViewModel))({text:D.strings.emptyRecycleBin,renderLabel:2,icon:new T.default("Delete"),action:new(this.managed(this.actionMap.EmptyRecycleBinAction)),engagementName:"EmptyRecycleBin"+this.sourceNameEngagement,keys:["E"]}),new(this.managed(E.CommandViewModel))({text:D.strings.DeleteItem,renderLabel:2,icon:new T.default("Delete"),action:new(this.managed(this.actionMap.DeleteAction)),engagementName:"Delete"+this.sourceNameEngagement,keys:["MetaBackspace","Delete"]}),new(this.managed(E.CommandViewModel))({text:D.strings.restore,renderLabel:2,icon:new T.default("RevToggleKey"),action:new(this.managed(this.actionMap.RestoreAction)),engagementName:"Restore"+this.sourceNameEngagement,keys:["R"]}),new(this.managed(E.CommandViewModel))({text:D.strings.Move,renderLabel:2,icon:new T.default("FabricMovetoFolder"),action:new(this.managed(this.actionMap.LaunchMoveCopyPanelAction))({isMove:!0}),engagementName:"Move"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.Copy,renderLabel:2,icon:new T.default("Copy"),action:new(this.managed(this.actionMap.LaunchMoveCopyPanelAction))({isMove:!1}),engagementName:"Copy"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.Rename,renderLabel:2,icon:new T.default("Edit"),action:new(this.managed(this.actionMap.RenameAction)),engagementName:"Rename"+this.sourceNameEngagement,keys:["F2"]})].concat(this._pageContext.allowInfectedDownload?[new(this.managed(E.CommandViewModel))({text:D.strings.Download,renderLabel:2,icon:new T.default("Download"),action:new(this.managed(this.actionMap.ShowMalwareDetectedAction))({})})]:[])),_=this.createObservable([new(this.managed(E.CommandViewModel))({text:D.strings.goToSharePointHome,tooltip:D.strings.goToSharePointHomeCommandTooltip,renderLabel:2,isHidden:this.selectionModeOn,icon:new T.default("SharepointLogo"),action:new(this.managed(this.actionMap.NavigateToSharePointHomeAction)),engagementName:"NavigateToSharePointHome"+this.sourceNameEngagement}),this._getFlowCommand(),new(this.managed(E.CommandViewModel))({text:D.strings.Sync,tooltip:D.strings.SyncCommandTooltip,renderLabel:2,isHidden:this.selectionModeOn,icon:new T.default("SyncToPC"),action:new(this.managed(this.actionMap.SyncAction)),engagementName:"Sync"+this.sourceNameEngagement,automationId:"syncCommand"}),new(this.managed(E.CommandViewModel))({text:D.strings.Edit,tooltip:D.strings.EditCommandTooltip,renderLabel:2,isHidden:this.selectionModeOn,icon:new T.default("Edit"),action:new(this.managed(this.actionMap.EditAction)),engagementName:"Edit"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.removeFromSharedList,icon:new T.default("Cancel"),renderLabel:2,action:new(this.managed(this.actionMap.RemoveFromSharedListAction))({}),engagementName:"RemoveFromSharedList"+this.sourceNameEngagement}),new(this.managed(M.default))({renderLabel:2}).command,new(this.managed(E.CommandViewModel))({text:D.strings.ShowVersionHistory,icon:new T.default("StackIndicator"),renderLabel:2,action:new(this.managed(this.actionMap.ShowVersionHistoryAction)),engagementName:"Version"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.UndoCheckOut,icon:new T.default("ArrowDownRight8"),action:new(this.managed(this.actionMap.UndoCheckOutAction)),engagementName:"Discard"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.CheckIn,icon:new T.default("ArrowDownRight8"),action:new(this.managed(this.actionMap.CheckInAction)),engagementName:"CheckIn"+this.sourceNameEngagement}),this._fileHandlerCommands.actionsCommand,this.overflowHostCommand]),b=new(this.managed(this.actionMap.ShowFiltersAction));this.addDisposable(new(this.resources.injected(N.default))({action:b,isEnabled:function(){if(e._urlDataSource.isCurrentQuery(O.default.Search))return e.responsiveUI.showLabels.peek()}}));var x=this.createObservable([new(this.managed(E.CommandViewModel))({text:D.strings.Sort,renderLabel:2,isHidden:this.selectionModeOn,icon:new T.default("SortLines"),location:4,requiredChildren:1,children:l.sortItems,engagementName:"Sort"+this.sourceNameEngagement})].concat(this._viewCommandBuilder.commands,[new(this.managed(E.CommandViewModel))({text:this.createPureComputed(function(){return e.filesCommandSetHelper.showSelectionActionText()}),tooltip:D.strings.showSelection,accessibleLabel:D.strings.showSelectionAccessibleLabel,icon:new T.default("Cancel"),location:4,positionIconRight:!0,action:new(this.managed(this.actionMap.ShowSelectionAction)),engagementName:"ShowSelection"+this.sourceNameEngagement,keys:["CtrlD","MetaD"]}),new(this.managed(E.CommandViewModel))({text:D.strings.FiltersPane,tooltip:D.strings.FiltersPaneCommandTooltip,icon:new T.default("Filter"),location:12,hasIconOnly:!0,renderLabel:0,action:b,engagementName:"SmartFilters"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({newFeatureAnchorName:L.default.TopBarRightInfoPane,resources:this.resources,text:D.strings.Details,icon:new T.default("Info"),location:4,hasIconOnly:!0,renderLabel:0,action:new(this.managed(this.actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),engagementName:"DetailsSide"+this.sourceNameEngagement,keys:["I"]}),new(this.managed(E.CommandViewModel))({newFeatureAnchorName:L.default.TopBarRightInfoPane,resources:this.resources,text:D.strings.Details,icon:new T.default("Info"),location:8,hasIconOnly:!0,renderLabel:0,action:new(this.managed(this.actionMap.ShowPropertiesAction))({useToggleBehavior:!1}),engagementName:"DetailsSide"+this.sourceNameEngagement})])),S=this._parentNavigation?[new(this.managed(E.CommandViewModel))({location:0,action:new(this.managed(this.actionMap.OpenAction))({openRelation:3}),keys:["AltUp"]})]:[],C=this.createObservable(S.concat([new(this.managed(E.CommandViewModel))({location:0,action:new(this.managed(this.actionMap.ShowKeyboardMapAction)),keys:["Shift/"]}),new(this.managed(E.CommandViewModel))({location:0,action:new(this.managed(this.actionMap.SetFocusAction))({selector:".od-SearchBox-input"}),keys:["/"]}),new(this.managed(E.CommandViewModel))({location:0,action:new(this.managed(this.actionMap.SelectAllAction)),keys:["CtrlA","MetaA"]})])),P=R.isFeatureEnabled(R.SharedByMe)?[this._getManagedAccessCommand()]:[],k=R.isFeatureEnabled(R.SharedByMe)?[this._getSharedCommands()]:[];this.commandSets(k.concat([g,v],P,[_,x,C]))};e.prototype._createCommandObservables=function(o,n){var a,s=this;return this.createPureComputed(function(){if(o()){var e=n();a=s.scope.attach(new f.default);for(var t=0,i=e;t<i.length;t++){var r=i[t];a.attach(r)}return e}if(a){a.dispose();a=void 0}return[]})};e.prototype._getManagedAccessCommand=function(){var e=this,t=this.createPureComputed(function(){return e._urlDataSource.isCurrentQuery(O.default.SharedByMe,e._viewParams())});return this._createCommandObservables(t,function(){return[new(e.managed(E.CommandViewModel))({text:D.strings.ManageAccess,renderLabel:2,icon:new T.default("PlayerSettings"),action:new(e.managed(e.actionMap.ShowPermissionsAction)),engagementName:"ManageAccess"+e.sourceNameEngagement})]})};e.prototype._getSharedCommands=function(){var e=this,t=this.createPureComputed(function(){return e._urlDataSource.isCurrentQuery(O.default.SharedWithMe,e._viewParams())||e._urlDataSource.isCurrentQuery(O.default.SharedByMe,e._viewParams())});return this._createCommandObservables(t,function(){return[new(e.managed(E.CommandViewModel))({text:D.strings.SharedWithMe,renderLabel:1,action:new(e.managed(e.actionMap.OpenAction))({item:e._itemProvider.getItemSync({parentKey:e._urlDataSource.getRootItemKey(O.default.SharedWithMe)}).item,openRelation:2}),location:3,isHidden:e.selectionModeOn,isCurrentView:e._isCurrentViewShared(O.default.SharedWithMe),isPermanent:!0,engagementName:"SharedWithMe"+e.sourceNameEngagement}),new(e.managed(E.CommandViewModel))({text:D.strings.SharedByMe,renderLabel:1,action:new(e.managed(e.actionMap.OpenAction))({item:e._itemProvider.getItemSync({parentKey:e._urlDataSource.getRootItemKey(O.default.SharedByMe)}).item,openRelation:2}),location:3,isHidden:e.selectionModeOn,isCurrentView:e._isCurrentViewShared(O.default.SharedByMe),isPermanent:!0,engagementName:"SharedByMe"+e.sourceNameEngagement})]})};e.prototype._isCurrentViewShared=function(e){var t=this;return this.createPureComputed(function(){return t._urlDataSource.getQueryType(t._viewParams())===e})};e.prototype._computeNewCommands=function(){var e=[],t=this._contentTypeCommands();t?e.push.apply(e,[this._getNewFolderCommand()].concat(t,[this._getNewLinkCommand()])):e.push.apply(e,this._getBasicNewCommands());e.push.apply(e,this._fileHandlerCommands.newFileCommands());return e};e.prototype._getNewFolderCommand=function(){var e=new(this.managed(E.CommandViewModel))({text:D.strings.CreateFolder,iconUrl:B.getIconUrl(this.resources,"folder",V),hasLineBreakAfter:!0,action:new(this.managed(this.actionMap.CreateFolderAction)),engagementName:"NewFolder"+this.sourceNameEngagement,collapsedText:this.createObservable(D.strings.newFolder)});this._getNewFolderCommand=function(){return e};return e};e.prototype._getNewLinkCommand=function(){var e=new(this.managed(E.CommandViewModel))({text:D.strings.CreateShortcut,iconUrl:B.getIconUrl(this.resources,"link",V),action:new(this.managed(this.actionMap.LaunchCreateShortcutPanel)),engagementName:"Link"+this.sourceNameEngagement});this._getNewLinkCommand=function(){return e};return e};e.prototype._getBasicNewCommands=function(){var e=[];e.push(this._getNewFolderCommand(),new(this.managed(E.CommandViewModel))({text:D.strings.CreateWord,iconUrl:B.getIconUrl(this.resources,"docx",V),action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:a.DocumentType.Word}),engagementName:"NewDOC"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.CreateExcel,iconUrl:B.getIconUrl(this.resources,"xlsx",V),action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:a.DocumentType.Excel}),engagementName:"NewXSL"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.CreatePowerPoint,iconUrl:B.getIconUrl(this.resources,"pptx",V),action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:a.DocumentType.PowerPoint}),engagementName:"NewPPT"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.CreateOneNote,iconUrl:B.getIconUrl(this.resources,"onetoc",V),action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:a.DocumentType.OneNote}),engagementName:"NewONE"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.CreateExcelSurvey,iconUrl:B.getIconUrl(this.resources,"xlsx",V),action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:a.DocumentType.ExcelSurvey}),engagementName:"NewXSLSurvey"+this.sourceNameEngagement}),new(this.managed(E.CommandViewModel))({text:D.strings.CreateFormForExcel,iconUrl:B.getIconUrl(this.resources,"xlsx",V),action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:a.DocumentType.ExcelForm}),engagementName:"NewXSLForm"+this.sourceNameEngagement}));(!l.default.isActivated("D75200B0-4F07-464B-851E-AEB3CA8101F0","06/18/2017","KillSwitchVisioEditFakeLicense")||this._pageContext.isSPO&&R.isFeatureEnabled(R.VisioDrawingCreation))&&e.push(new(this.managed(E.CommandViewModel))({text:D.strings.CreateVisio,iconUrl:B.getIconUrl(this.resources,"vsdx",V),action:new(this.managed(this.actionMap.CreateDocumentAction))({docType:a.DocumentType.Visio}),engagementName:"NewVSDX"+this.sourceNameEngagement}));e.push(this._getNewLinkCommand());this._getBasicNewCommands=function(){return e};return e};e.prototype._computeContentTypeCommands=function(){var e=this._contentTypeCommands.peek();if(e)for(var t=0,i=e;t<i.length;t++){i[t].dispose()}var r=this._currentItemSet().contentTypes();return this.commandSetHelper.isCustomContentTypesDisabled(r)?void 0:this.commandSetHelper.getContentTypeCommands(r,this.sourceNameEngagement)};e.prototype._getFlowCommand=function(){var r=this,o=R.isFeatureEnabled(R.ODBFlow);return new(this.managed(E.CommandViewModel))({text:D.strings.FlowCommandLabel,tooltip:D.strings.FlowCommandLabel,collapseSingleChildCommands:!1,renderLabel:2,isHidden:this.createPureComputed(function(){var e=r.selection.selection(),t=e.length,i=e[0];return!o||1<t||0<t&&h.default.isFolder(i.peek(),!1)||0<t&&i.peek().lifeCycleStatus&&i.peek().lifeCycleStatus.isMalwareDetected}),icon:new T.default("Flow"),callback:this._loadFlows.bind(this),requiredChildren:1,engagementName:"Flow",source:this.sourceNameEngagement,children:this._flowCommands})};e.prototype._loadFlows=function(e){var i=this,r=function(e){return new(i.managed(E.CommandViewModel))({text:e.displayName,tooltip:e.displayName,action:new(i.managed(i.actionMap.TriggerFlowAction))({flow:e}),engagementName:"ExecuteFlow",source:i.sourceNameEngagement})};new(this.child(s.typeResourceKey))({item:this._currentItem.peek()}).getFlowInstances("Request",e).then(function(e){var t=i.commandSetHelper.processFlowInstances(r,i._staticFlows.length,e,i._originalFlows,i._flowCommands.peek());i._originalFlows=e;i._flowCommands(t.concat(i._staticFlows))},function(e){})};return e}(i.default);t.default=y});define("M7",["require","exports","ap","rt","bX","jN"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.selection=t.resources.consume(o.itemsSelection);t.actionMap=t.resources.consume(o.actionMap);t._isSelectionModal=t.resources.consume(n.isSelectionModalResourceKey);t.commandSets=t.createObservable([]);t.selectionModeOn=t.createPureComputed(t._computeSelectionModeOn);t.selectionModeOff=t.createPureComputed(t._computeSelectionModeOff);var i=t.createPureComputed(t._computeCommands);t.createComputed(function(){(e=t.commands).splice.apply(e,[0,t.commands.peek().length].concat(i()));var e});t.createComputed(t._computeSeparators).extend({rateLimit:0});return t}e.prototype._computeCommands=function(){var e=this.commandSets()||[];return[].concat.apply([],e.map(function(e){return e()}))};e.prototype._computeSeparators=function(){this.selection.selection();var e=this.commandSets();if(e.length){for(var t=!1,i=[],r=0,o=e;r<o.length;r++){for(var n=(0,o[r])(),a=!1,s=0,l=n.length-1;0<=l&&s<2;l--){if((u=n[l])&&u.isVisible.peek()){u.hasLineBreakAfter(!a);if(!a){a=!0;i.push(u)}s++}}1<s&&(t=!0)}if(!t)for(var d=0,c=i;d<c.length;d++){var u;(u=c[d]).hasLineBreakAfter(!1)}}};e.prototype._computeSelectionModeOn=function(){return this.selection&&0<this.selection.selection().length||this._isSelectionModal()};e.prototype._computeSelectionModeOff=function(){return!this.selectionModeOn()};return e}(r.default);t.default=a});define("M6",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Column=0]="Column";e[e.Order=1]="Order"}(i||(i={}));t.default=i});define("M5",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Word=1]="Word";e[e.Excel=2]="Excel";e[e.PowerPoint=3]="PowerPoint";e[e.OneNote=4]="OneNote";e[e.ExcelSurvey=5]="ExcelSurvey";e[e.Text=6]="Text";e[e.ExcelForm=7]="ExcelForm";e[e.Visio=8]="Visio"}(i=t.DocumentType||(t.DocumentType={}));t.default=i});define("M4",["require","exports","ap","bN","p3","aq","LR","M6"],function(e,t,i,r,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){i.__extends(e,t);function e(e){var o=t.call(this,e)||this;o.sortItems=s.observableArray();o._commands=[];var n=e.itemsToAppend,i=e.currentItemSet;o.createComputed(function(){o._commands.map(function(e){return e.dispose()});o._commands=[];var e=(i().schema()||[]).filter(function(e){return!(!e.sortable||!e.name)}),t=[];0<e.length&&(t=e.map(function(e,t,i){var r=new(o.managed(a.default))({text:e.name,isToggleable:!0,action:new(o.managed(l.default))({mode:d.default.Column,column:e}),hasLineBreakAfter:n&&t===i.length-1});o._commands.push(r);return r}).concat(n||[]));o.sortItems(t)});return o}return e}(r.default);t.default=o});define("LR",["require","exports","ap","g4","aC","aI","LS","bX","jG","M6"],function(e,t,r,i,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="Sort";t._sortManager=t.resources.consume(l.sortManager);t._currentItemSet=t.resources.consume(s.currentItemSet);t._mode=e.mode;t._column=e.column;t._ascending=e.ascending;return t}e.prototype.onExecute=function(e,t){var i=a.default.getSortedColumn(this._currentItemSet().schema);this._column||(this._column=i);var r={sortMode:d.default[this._mode],sortAscending:"Ascending"};this._column&&(r.sortColumn=this._column.internalName||this._column.key);if(this._mode===d.default.Column)this.updateCurrentSort(this._column,i.isAscending);else if(this._mode===d.default.Order){if(this._currentItemSet&&this._currentItemSet().schema){r.sortAscending=this._ascending?"Ascending":"Descending";this.updateCurrentSort(i,this._ascending)}}else o.default.wrap({resultType:n.ResultTypeEnum.Failure});return o.default.wrap({resultType:n.ResultTypeEnum.Success,extraData:r})};e.prototype.onIsAvailable=function(){return!!this._currentItemSet&&!!a.default.getSortedColumn(this._currentItemSet().schema)};e.prototype.onIsToggled=function(){var e=!1;if(this._mode===d.default.Column&&this._column)e=this._column.isSorted;else if(this._mode===d.default.Order&&this._currentItemSet&&this._currentItemSet().schema){var t=a.default.getSortedColumn(this._currentItemSet().schema);e=t&&t.isAscending===this._ascending}return e};e.prototype.updateCurrentSort=function(e,t){if(e){var i=e.internalName||e.key;this._sortManager.updateSort(i,t)}};return e}(i.default);t.default=c});define("LS",["require","exports","ap","g4","aC","aI","jG"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="SortAction";t._sortManager=t.resources.consume(a.sortManager);t._column=e.column;t._ascending=e.ascending;return t}e.getSortedColumn=function(e){var t,i=e();if(i)for(var r=0;r<i.length;r++)if(i[r]&&i[r].isSorted){t=i[r];break}return t};e.prototype.onExecute=function(e,t){this._updateCurrentSort(this._column,this._ascending);return o.default.wrap({resultType:n.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){return!0};e.prototype.onIsToggled=function(){var e=!1;this._column&&(e=this._column.isSorted&&this._column.isAscending===this._ascending);return e};e.prototype._updateCurrentSort=function(e,t){if(e){var i=e.internalName||e.key;this._sortManager.updateSort(i,t)}};return e}(i.default);t.default=s});define("EH",["require","exports","ap","bA","bN","qO","EI","l1","eA","fO","V","aZ","aC","ba","hD","ey","EJ","iE","bX","l2","bb"],function(e,t,i,r,o,d,c,n,a,s,u,l,p,m,h,f,g,y,v,_,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x,S,C,P="spolibraries",k={filterMap:(x={},x[2]="odbmanualtrigger",x[1]="odbautomatictrigger",x),filterKeys:[2,1],image:"onedriveforbusiness.png",connectionReferenceName:"shared_onedriveforbusiness",priorityProperty:"odbwebpriority",flowComponent:c.oneDrive},I={filterMap:(S={},S[2]="spomanualtrigger",S[4]="spomanualtrigger_hybrid",S[1]="spoautomatictrigger",S),filterKeys:[2,4,1],image:"sharepointonline.png",connectionReferenceName:d.SHAREPOINT_CONNECTION_REFERENCE_NAME,priorityProperty:"SPOListsPriority",flowComponent:c.sharePoint},T={outOfBoxTemplateMap:(C={},C["0c4e00f8ad7b4a3f9a59717c0f504640"]=n.outOfBoxSignoffTemplate,C)},w=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._flowConfigurationPromiseMap={};i._flowInstancePrefetchPromiseMap={};i._flowTrustedTemplatePromiseMap={};i._templateBasedFlowMap={};i._item=e.item;i._pageContext=t.pageContext;i._flowActionHelper=t.flowActionHelper;i._listDataSource=t.listDataSource;i._itemParentHelper=t.itemParentHelper;i._itemUrlHelper=t.itemUrlHelper;i._actionMap=t.actionMap;i._isODB=i._flowActionHelper.checkIsODB(i._item);i._flowConstants=i._isODB?k:I;i._effectiveConfiguration=i._flowActionHelper.getFlowConfiguration(i._item);i._isTemplateVersioningEnabled=m.isFeatureEnabled(m.FlowTemplateVersioning);return i}e.prototype.getFlowConfiguration=function(){var r=this,t=this.getFolderPath();this._flowConfigurationPromiseMap[t]||(this._flowConfigurationPromiseMap[t]=new p.default(function(i,e){r._listDataSource.getFlowTemplates(t).done(function(e){var t;0===e.synchronizationStatus&&(t=JSON.parse(e.synchronizationDataObject.SynchronizationData));i(t?r.getFlowTemplatesFromFlowData(t):[])},function(e){i([])})}));return this._flowConfigurationPromiseMap[t].then(function(e){return r.getFlowConfigurationFromTemplates(e)})};e.prototype.getFlowInstances=function(e,t){var i=this.getListFullUrl(),r=this._isTemplateVersioningEnabled?this._getFlowInstancesInternal(e,i):this.getFlowInstancesInternal(e,i);if(t){var o=e+i;this._flowInstancePrefetchPromiseMap[o]||(this._flowInstancePrefetchPromiseMap[o]=r);return this._flowInstancePrefetchPromiseMap[o]}return r};e.prototype.getFlowInstance=function(e){var t=this.getListFullUrl();return this.getFlowInstanceInternal(e,t)};e.prototype.getFlowCallbackUrl=function(t){var r=this,o=this.getListFullUrl();return new p.default(function(i,e){r._listDataSource.getFlowCallbackUrl(t,o).done(function(e){var t=null;0===e.synchronizationStatus&&(t=JSON.parse(e.synchronizationDataObject.SynchronizationData));t&&"OK"===t.httpStatusCode&&t.response&&t.response.value?i(t.response.value):i(null)},function(e){i(null)})})};e.prototype.getAction=function(e){var t=this._actionMap.TriggerFlowAction;e&&e.categoryNames&&-1<e.categoryNames.indexOf("OOB_SHAREPOINT_REQUESTSIGNOFF")&&(t=this._actionMap.TriggerSignoffFlowAction);return t};e.prototype.getListFullUrl=function(){return this._itemUrlHelper.getItemUrlParts(this._item.key).fullListUrl};e.prototype.getListId=function(){return this._itemParentHelper.getFacetedAncestorOrSelf(this._item,"list").peek().list.id};e.prototype.getFolderPath=function(){return this._itemUrlHelper.getItemUrlParts(this._item.key).normalizedItemUrl};e.prototype.getFlowInstancesInternal=function(o,t){var n=this;return new p.default(function(r,e){n._listDataSource.getFlowInstances(t).done(function(e){if(0===e.synchronizationStatus){var t=[];try{var i=JSON.parse(e.synchronizationDataObject.SynchronizationData);if(i&&i.value){t=i.value.filter(function(e){return"Started"===e.properties.state}).filter(function(e){return!!n.getTriggerComponent(e,o)}).map(function(e){return{id:e.name,displayName:e.properties.displayName,createdTime:e.properties.createdTime,trigger:n.getFlowTrigger(e),environmentId:e.properties.environment.name,templateName:e.properties.templateName}});n._isODB||(t=n.processOutOfBoxFlows(t))}}catch(e){}r(t)}},function(e){r([])})})};e.prototype.getFlowInstanceInternal=function(t,i){var o=this;return new p.default(function(r,e){o._listDataSource.getFlowInstance(t,i).done(function(e){if(0===e.synchronizationStatus){var t=[];try{var i=JSON.parse(e.synchronizationDataObject.SynchronizationData);i&&!o._isODB&&(t=[{id:i.name,displayName:i.properties.displayName,createdTime:i.properties.createdTime,trigger:o.getFlowTrigger(i),environmentId:i.properties.environment.name,templateName:i.properties.templateName}])}catch(e){}1===t.length?r(t[0]):r(null)}},function(e){r(null)})})};e.prototype.processOutOfBoxFlows=function(e){if(!e)return null;var t=n.outOfBoxSignoffTemplate.templateId,i=T.outOfBoxTemplateMap[t],r={};e=e.sort(function(e,t){return Date.parse(e.createdTime)-Date.parse(t.createdTime)}).filter(function(e){if(e.templateName&&"0c4e00f8ad7b4a3f9a59717c0f504640"===e.templateName){if(!m.isFeatureEnabled(m.ApprovalFlows)||r[i.templateId])return!1;e.displayName=i.displayName;r[i.templateId]=e}return!0});m.isFeatureEnabled(m.ApprovalFlows)&&!r[i.templateId]&&e.push({id:"",displayName:i.displayName,createdTime:"",trigger:d.getOutOfBoxHybridTrigger(),templateName:"0c4e00f8ad7b4a3f9a59717c0f504640"});return e};e.prototype.getFlowConfigurationFromTemplates=function(e){var n=this,t=this._flowActionHelper.getTemplateType(this._item),i=f.isDocumentLibrary(t),a=this._isODB?"odbintegration":i?P:"spolists",s=1,r=!this._isODB&&d.isEmbeddedFlowsEnabled();s|=r?4:2;e&&e.length&&(e=e.filter(function(e){if(-1!==e.categoryNames.indexOf(a)){for(var t=0,i=n._flowConstants.filterKeys;t<i.length;t++){var r=i[t],o=n._flowConstants.filterMap;if(-1!==e.categoryNames.indexOf(o[r])&&r&s)return!0}return!1}return!1}));return{templates:e,userFlowsUrl:this._effectiveConfiguration.userFlowsUrl,moreTemplatesUrl:this._effectiveConfiguration.moreTemplatesUrl}};e.prototype.getFlowTemplatesFromFlowData=function(e){var n=this,t=[],a=this._flowConstants.filterMap;if(e){var i=e.value.sort(function(e,t){return e&&t?n.getDisplayPriority(e)-n.getDisplayPriority(t):Number(!t)-Number(!e)}),s=this.getListId(),l=this.getFolderPath();t=i.map(function(e){var t=n.getTriggerComponent(e),i=n.getActionComponent(e),r=n.normalizeCategoryNames(e.properties.categoryNames),o=!!r&&-1!==r.indexOf(a[1])&&-1!==r.indexOf(P);if(t&&i)return{templateId:e.name,description:e.properties.displayName,ariaLabel:u.format(_.strings.ariaLabelFlowTemplates,e.properties.displayName),triggerComponent:t,actionComponent:i,navigationUrl:n.getNavigationUrl(e,s,o?l:null),categoryNames:r}}).filter(function(e){return!!e})}return t};e.prototype.normalizeCategoryNames=function(e){return e?e.map(function(e){return e&&e.toLowerCase()}):[]};e.prototype.getDisplayPriority=function(e){var t=Number.MAX_VALUE,i=this._flowConstants.priorityProperty,r=e&&e.properties&&e.properties.metadata&&e.properties.metadata[i];if(r){t=parseInt(r,10);isNaN(t)&&(t=Number.MAX_VALUE)}return t};e.prototype.getTriggerComponent=function(e,t){void 0===t&&(t="");var i,r=this.getFlowTrigger(e);if(r){if(t&&r.type!==t)return null;if("ApiConnection"===r.type){var o=r.api.name;i=this.getConnectionReferenceProperties(e,o)}else d.isRequestTrigger(r)&&(i=this._flowConstants.flowComponent)}return i};e.prototype.getActionComponent=function(e){var t=null,i=e.properties.definitionSummary.actions;if(e.properties.definitionSummary.triggers.some(d.isRequestTrigger))for(var r=0,o=i;r<o.length;r++){var n=o[r],a=this._flowConstants.connectionReferenceName;if(n.api&&n.api.name!==a)return this.getConnectionReferenceProperties(e,n.api.name)}else{if(1===i.length)return this.getConnectionReferenceProperties(e,i[0].api.name);for(var s=0,l=i;s<l.length;s++){if((n=l[s]).api&&-1!==(t=this.getConnectionReferenceProperties(e,n.api.name)).imageSourceFileName.indexOf(this._flowConstants.image))return t}}return t||c.customAction};e.prototype.getConnectionReferenceProperties=function(e,t){var i,r="",o="",n="";for(var a in e.properties.connectionReferences){var s=e.properties.connectionReferences[a];if(a===t||s.api&&s.api.name===t){i=s;break}}if(i){var l=i.api&&i.api.properties?i.api.properties:i;r=l.displayName;o=l.iconUri;n=l.metadata?l.metadata.brandColor:l.brandColor}return{serviceName:r,imageSourceFileName:o,imageContainerStyle:{"background-color":n}}};e.prototype.getFlowTrigger=function(e){var t=e.properties.definitionSummary.triggers;return 0<t.length?t[t.length-1]:null};e.prototype.getNavigationUrl=function(e,t,i){var r="";if(e.name)if(this._isODB){var o="/"+this._itemUrlHelper.getItemUrlParts(this._item.key).listRelativeItemUrl;r=u.format(this._effectiveConfiguration.flowUrlTemplate,e.name,encodeURIComponent(o))}else{r=u.format(this._effectiveConfiguration.flowUrlTemplate,e.name,encodeURIComponent(this._pageContext.webAbsoluteUrl),l.default.normalizeLower(t));i&&(r+="&parameters.sharepoint.folderPath="+encodeURIComponent(i.replace(this._pageContext.webServerRelativeUrl,"")))}return r};e.prototype._getFlowInstancesInternal=function(r,e){var o=this;if(!this._isTemplateVersioningEnabled)return p.default.wrap([]);var t=this._listDataSource.getFlowInstances(e);if(this._isODB)return t.then(function(e){return o._processFlowInstances(e,r)});var i=this.getFolderPath(),n=this._flowActionHelper.getTemplateType(this._item),a=f.isDocumentLibrary(n),s=f.isGenericList(n),l=a?"OOB_SHAREPOINT_LIBRARY":s?"OOB_SHAREPOINT_LIST":void 0,d=i+l;this._flowTrustedTemplatePromiseMap[d]||(this._flowTrustedTemplatePromiseMap[d]=this._listDataSource.getFlowTemplates(i,l));return p.default.all([t,this._flowTrustedTemplatePromiseMap[d]]).then(function(e){var t=o._processFlowInstances(e[0],r),i=o._processTrustedTemplates(e[1]);return t=o._buildDisplayedFlowsInstances(t,i)})};e.prototype._processFlowInstances=function(e,t){var i=this,r=[];if(0===e.synchronizationStatus)try{var o=JSON.parse(e.synchronizationDataObject.SynchronizationData);o&&o.value&&(r=o.value.filter(function(e){return"Started"===e.properties.state}).filter(function(e){return!!i.getTriggerComponent(e,t)}).map(function(e){return{id:e.name,displayName:e.properties.displayName,createdTime:e.properties.createdTime,trigger:i.getFlowTrigger(e),environmentId:e.properties.environment.name,templateName:e.properties.templateName,provisioningMethod:e.properties.provisioningMethod}}))}catch(e){}return r};e.prototype._processTrustedTemplates=function(e){var t=this,i=[];if(e&&0===e.synchronizationStatus){var r=JSON.parse(e.synchronizationDataObject.SynchronizationData);r&&r.value&&(i=r.value.filter(function(e){return-1<e.properties.categoryNames.indexOf("OOB_CURRENT")}).map(function(e){return t._getManagedTemplate(e)}).filter(function(e){return!!e}))}return i};e.prototype._buildDisplayedFlowsInstances=function(e,r){var o=this,t=e.sort(function(e,t){return Date.parse(e.createdTime)-Date.parse(t.createdTime)}).filter(function(e){var t=!0;if(e.templateName&&"FromTemplate"===e.provisioningMethod){var i=o._getAssociatedTemplate(e,r);if(i){e.displayName=i.displayName;e.categoryNames=i.categoryNames}else t=!1}return t}),i=this._getPlaceholderTrustedFlows(r);return t.concat(i)};e.prototype._getManagedTemplate=function(e){var t;-1<e.properties.categoryNames.indexOf("OOB_SHAREPOINT_REQUESTSIGNOFF")&&(t={templateId:e.name,displayName:n.outOfBoxSignoffTemplate.displayName,feature:n.outOfBoxSignoffTemplate.feature,data:n.outOfBoxSignoffTemplate.data,categoryNames:e.properties.categoryNames});return t};e.prototype._getPlaceholderTrustedFlows=function(e){var t=this;return e.filter(function(e){return!t._templateBasedFlowMap[e.templateId]}).map(function(e){return{id:"",templateName:e.templateId,displayName:e.displayName,createdTime:"",trigger:d.getOutOfBoxHybridTrigger(),categoryNames:e.categoryNames}})};e.prototype._getAssociatedTemplate=function(e,t){var i;if(b.default.isActivated("EBA3511E-7F9E-4472-B8A5-C016A62B3275","03/08/2018","AssociatedTemplate map check"))for(var r=0,o=t;r<o.length;r++){l=(s=o[r]).templateId;if(!this._templateBasedFlowMap[l]&&e.templateName===l){i=s;this._templateBasedFlowMap[l]=e;break}}else for(var n=0,a=t;n<a.length;n++){var s,l=(s=a[n]).templateId;if(e.templateName===l){i=s;this._templateBasedFlowMap[l]=e;break}}return i};e.dependencies=i.__assign({},o.default.dependencies,{listDataSource:h.resourceKey,itemParentHelper:a.resourceKey,itemUrlHelper:s.resourceKey,flowActionHelper:g.resourceKey,pageContext:y.pageContext,actionMap:v.actionMap});return e}(o.default);t.default=w;t.typeResourceKey=r.createResolvedTypeResourceKey(e("module").id,w,i.__assign({},o.default.dependencies,{listDataSource:h.resourceKey,itemParentHelper:a.resourceKey,itemUrlHelper:s.resourceKey,flowActionHelper:g.resourceKey,pageContext:y.pageContext,actionMap:v.actionMap}))});define("EI",["require","exports","l2"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.oneDrive={serviceName:"OneDrive",imageSourceFileName:"undefined"==typeof __webpack_public_path__?e.toUrl("@ms/odsp-media/lib/images/processsimple/onedriveforbusiness.png"):e("@ms/odsp-media/dist/media/images/processSimple/onedriveforbusiness.png"),imageContainerStyle:{"background-color":"#2151a3"}};t.sharePoint={serviceName:"SharePoint",imageSourceFileName:"undefined"==typeof __webpack_public_path__?e.toUrl("@ms/odsp-media/lib/images/processsimple/sharepoint.png"):e("@ms/odsp-media/dist/media/images/processSimple/sharepoint.png"),imageContainerStyle:{"background-color":"#1B75BC"}};t.office365={serviceName:"Office 365",imageSourceFileName:"undefined"==typeof __webpack_public_path__?e.toUrl("@ms/odsp-media/lib/images/processsimple/office365.png"):e("@ms/odsp-media/dist/media/images/processSimple/office365.png"),imageContainerStyle:{"background-color":"#EB3C00"}};t.salesforce={serviceName:"Salesforce",imageSourceFileName:"undefined"==typeof __webpack_public_path__?e.toUrl("@ms/odsp-media/lib/images/processsimple/salesforce.png"):e("@ms/odsp-media/dist/media/images/processSimple/salesforce.png"),imageContainerStyle:{"background-color":"#1EB8EB"}};t.sql={serviceName:"SQL",imageSourceFileName:"undefined"==typeof __webpack_public_path__?e.toUrl("@ms/odsp-media/lib/images/processsimple/sqlserver.png"):e("@ms/odsp-media/dist/media/images/processSimple/sqlserver.png"),imageContainerStyle:{"background-color":"#BA141A"}};t.customAction={serviceName:i.strings.SharePointCustomActionComponentName,imageSourceFileName:"undefined"==typeof __webpack_public_path__?e.toUrl("@ms/odsp-media/lib/images/processsimple/gear.svg"):e("@ms/odsp-media/dist/media/images/processSimple/gear.svg"),imageContainerStyle:{"background-color":"#333333",padding:"5px 0"}};t.mailChimp={serviceName:"MailChimp",imageSourceFileName:"undefined"==typeof __webpack_public_path__?e.toUrl("@ms/odsp-media/lib/images/processsimple/mailchimp.png"):e("@ms/odsp-media/dist/media/images/processSimple/mailchimp.png"),imageContainerStyle:{"background-color":"#249AB9",padding:"12px 0"}};t.dynamics={serviceName:"Dynamics CRM",imageSourceFileName:"undefined"==typeof __webpack_public_path__?e.toUrl("@ms/odsp-media/lib/images/processsimple/dynamics.svg"):e("@ms/odsp-media/dist/media/images/processSimple/dynamics.svg"),imageContainerStyle:{"background-color":"#002050",padding:"16px 0"}};t.manualTrigger={serviceName:i.strings.ManualFlowTriggerComponentName,imageSourceFileName:"undefined"==typeof __webpack_public_path__?e.toUrl("@ms/odsp-media/lib/images/processsimple/manual.svg"):e("@ms/odsp-media/dist/media/images/processSimple/manual.svg"),imageContainerStyle:{color:"#FFF","background-color":"#0077FF",padding:"6px 0"}}});define("EJ",["require","exports","iE","dZ","ey","cY","dH","a9","eA","ba","bA","EM","EL","EK","kG","jd"],function(e,t,i,r,o,n,a,s,l,d,c,u,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(){function e(e,t){this._pageContext=t.pageContext;this._itemParentHelper=t.itemParentHelper;this._itemCommandHelper=t.itemCommandHelper;this._urlDataSource=t.urlDataSource}e.prototype.checkBaseAvailability=function(e){return this._itemCommandHelper.isCommandSupported(e,f.baseFlow)&&this._urlDataSource.getPageType()!==s.default.TextFileEditor&&d.isFeatureEnabled(d.ProcessSimple)&&(!this.checkIsODB(e)||d.isFeatureEnabled(d.ODBFlow))&&!this._pageContext.disableFlows&&e.queryType===a.default.Files&&n.PermissionMask.hasItemPermission(e,n.PermissionMask.editListItems)};e.prototype.checkIsODB=function(e){return this._getListTemplateType(e)===o.default.mySiteDocumentLibrary};e.prototype.getTemplateType=function(e){return this._getListTemplateType(e)};e.prototype.getFlowConfiguration=function(e){return e&&this.checkIsODB(e)?m:d.isFeatureEnabled(d.PowerAppsAndAndProcessSimpleTestEnvironment)?p:u};e.prototype._getListTemplateType=function(e){var t=this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"),i=t&&t().list;return i&&i.templateType};e.dependencies={pageContext:i.pageContext,itemParentHelper:l.resourceKey,itemCommandHelper:h.resourceKey,urlDataSource:r.url};return e}();t.default=g;t.resourceKey=c.createResolvedResourceKey(e("module").id,g)});define("EM",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.templates=[];t.userFlowsUrl="https://flow.microsoft.com/manage/flows?utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration";t.moreTemplatesUrl="https://flow.microsoft.com/search?q=SharePoint&utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration";t.flowUrlTemplate="https://flow.microsoft.com/galleries/public/templates/{0}/?parameters.sharepoint.site={1}&parameters.sharepoint.list={2}&ExpandConnectionWizard=true&environment=~default&utm_source=0766EADB51FC40678EF404BEDB2F7F39&utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration"});define("EL",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.templates=[];t.userFlowsUrl="https://tip1.flow.microsoft.com/manage/flows?utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration";t.moreTemplatesUrl="https://tip1.flow.microsoft.com/search?q=SharePoint&utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration";t.flowUrlTemplate="https://tip1.flow.microsoft.com/galleries/public/templates/{0}/?parameters.sharepoint.site={1}&parameters.sharepoint.list={2}&ExpandConnectionWizard=true&environment=~default&utm_source=17FEC2C8DF8A44D79CE51B0286370706&utm_medium=custom.sharepoint&utm_campaign=sharepoint.integration"});define("EK",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.templates=[];t.userFlowsUrl="https://flow.microsoft.com/manage/flows?utm_source=one_drive_for_business&utm_medium=odb_web&utm_campaign=odb.doclibintegration";t.moreTemplatesUrl="https://flow.microsoft.com/search?q=OneDrive+for+Business&utm_source=one_drive_for_business&utm_medium=odb_web&utm_campaign=odb.doclibintegration";t.flowUrlTemplate="https://flow.microsoft.com/galleries/public/templates/{0}/?parameters.odb.folderPath={1}&ExpandConnectionWizard=true&utm_source=one_drive_for_business&utm_medium=odb_web&utm_campaign=odb.doclibintegration"});define("M3",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.TopBarNew=1]="TopBarNew";e[e.TopBarLeftInfoPane=2]="TopBarLeftInfoPane";e[e.TopBarRightInfoPane=3]="TopBarRightInfoPane"}(i||(i={}));t.default=i});define("M2",["require","exports","ap","bN","rs","dm","bX","dI","iE","ej","eA","fO","bR","aL","LY"],function(e,t,r,i,m,o,n,h,a,f,s,l,d,c,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._actionMap=t.resources.consume(n.actionMap);t._pageContext=t.resources.consume(a.pageContext);t._currentItem=t.resources.consume(n.currentItem);t._itemUrlHelper=t.resources.consume(l.resourceKey);t._itemParentHelper=t.resources.consume(s.resourceKey);t._currentItemKey=t.createPureComputed(t._computeCurrentItemKey);t._listRootItem=t.createPureComputed(t._computeListRootItem);t._listRootItem.equalityComparer=d.objectStrictEquality;t._listProperties=t.createPureComputed(t._computeListProperties);t._listProperties.equalityComparer=c.deepCompare;return t}e.prototype.isCustomContentTypesDisabled=function(e){var t=e&&e.length;if(!t)return!0;var i=e[0],r=i.templateUrl,o=r&&-1<r.indexOf("/Forms/template.do");return!(1!==t||(r||i.docSetUrl)&&!o)||(!this._listProperties.peek()||!this._listProperties.peek().contentTypesEnabled)&&(!r||o)};e.prototype.getContentTypeCommands=function(e,d){var c=this,t=this._listProperties();if(!t)return[];var u=t.openInClient,p=t.newWOPIDocumentEnabled;return e.map(function(e){var t,i=e.templateUrl,r=e.cTypeId,o="CreateNewDocument.aspx?id=",n=i?i.indexOf(o):0,a=e.iconUrl;if(a)-1===a.indexOf("/")&&(a="/"+c._pageContext.layoutsUrl+"/images/"+a);else{t=""===e.templateUrl&&e.docSetUrl?new h.default("DocumentSet"):new h.default("Page")}if(0<n&&!u&&p){i=i.substring(n+o.length);return new(c.managed(m.CommandViewModel))({text:e.displayName,iconUrl:a,icon:t,action:new(c.managed(c._actionMap.CreateDocumentAction))({docType:g.GetDocumentTypeFromExtension(i),templateUrl:i}),engagementName:"NewDOC",source:d})}if(!i)if(i=e.docSetUrl){var s=new f.default(i),l=c._itemUrlHelper.getItemUrlParts(c._currentItemKey()).serverRelativeItemUrl;s.setQueryParameter("RootFolder",l);i=s.toString()}else r&&(i=r);return new(c.managed(m.CommandViewModel))({text:e.displayName,iconUrl:a,icon:t,action:new(c.managed(c._actionMap.ContentTypeNavigationAction))({url:i,appMap:e.appMap,contentTypeId:r,openInClient:!!e.appMap}),engagementName:"NewCustomType"+d})})};e.prototype.getKeyboardMapCommand=function(){return new(this.managed(m.CommandViewModel))({location:0,action:new(this.managed(this._actionMap.ShowKeyboardMapAction)),keys:["Shift/"]})};e.prototype.getSearchCommand=function(){return new(this.managed(m.CommandViewModel))({location:0,action:new(this.managed(this._actionMap.SetFocusAction))({selector:".od-SearchBox-input"}),keys:["/"]})};e.prototype.getStaticFlowCommands=function(e){return[new(this.managed(m.CommandViewModel))({text:o.strings.AddFlow,hasLineBreakBefore:!0,renderLabel:2,action:new(this.managed(this._actionMap.AddFlowAction))({}),engagementName:"AddFlow",source:e}),new(this.managed(m.CommandViewModel))({text:o.strings.ExistingFlows,renderLabel:2,action:new(this.managed(this._actionMap.ShowExistingFlowsAction))({}),engagementName:"ExistingFlows",source:e}),new(this.managed(m.CommandViewModel))({text:o.strings.setUpApprovalFlow,renderLabel:2,action:new(this.managed(this._actionMap.SetUpApprovalFlowAction))({}),engagementName:"SetUpApprovalFlow",source:e})]};e.prototype.processFlowInstances=function(e,t,i,r,o){var n=[],a={};i.forEach(function(e){a[e.id]=e});for(var s=0,l=0,d=o.length-t;s<i.length&&l<d;){var c=o[l],u=r[l],p=i[s],m=null;if(p.id===u.id&&p.displayName===c.text()){m=c;p.displayName!==u.displayName&&m.text(p.displayName);s++;l++}else if(a[u.id]){m=e(p);s++}else{c.dispose();l++}m&&n.push(m)}for(;s<i.length;s++)n.push(e(i[s]));return n};e.prototype._computeListProperties=function(){var e,t=this._listRootItem();if(t){var i=t.list;e={openInClient:i.openInClient,newWOPIDocumentEnabled:i.newWOPIDocumentEnabled,contentTypesEnabled:i.contentTypesEnabled}}else e=this._listProperties.peek();return e};e.prototype._computeListRootItem=function(){return this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._currentItem(),"list"))};e.prototype._computeCurrentItemKey=function(){return this._currentItem().key};return e}(i.default);t.default=u});define("LY",["require","exports","eO","oc","V","M5"],function(e,t,s,i,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=i.strings,o=["docx","doc","docm","dotm","dotx","xlsx","xlsb","xls","xlsm","pptx","ppsx","ppt","pps","pptm","potm","ppam","potx","ppsm","pdf"],n="Doc",a="One",c="Ppt",u="Xls",p="Vsd",m="Lib",h={WinDocuments:m,WinLibrary:m,WinMusic:m,WinPictures:m,WinPodcastLibrary:m,WinVideos:m,WinDrive:"Drive",CDDrive:"CDDrive",GenericDrive:"Drive",UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:n,Docm:n,Docx:n,Dot:n,Dotm:n,Dotx:n,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:c,Ods:u,Odt:n,One:a,Onepkg:a,Onetoc2:a,Notebook:"OneNotebook",Pot:c,Potm:c,Potx:c,Ppa:c,Ppam:c,Pps:c,Ppsm:c,Ppsx:c,Ppt:c,Pptm:c,Pptx:c,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:p,Vsd:p,Vsdm:p,Vsdx:p,Vsl:p,Vss:p,Vssm:p,Vssx:p,Vst:p,Vstm:p,Vstx:p,Xaml:"Xaml",Xla:u,Xlam:u,Xll:u,Xls:u,Xlsb:u,Xlsm:u,Xlsx:u,Xlt:u,Xltm:u,Xltx:u,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"};t.getFriendlyItemType=function(e,t,i){var r=e.extension,o=r&&r.slice("."===r[0]?1:0),n=o&&o.toUpperCase(),a=f(e.itemFromServer&&e.itemFromServer.iconType||o);return a||e.type!==s.default.Folder?i||(e.panorama?d.fileTypePanorama:e.photo&&!e.video?l.format(d.fileTypeImage,n||"").trim():a?d["fileType"+a]:n?l.format(d.fileTypeUnknown,n):t?d.listItemType:d.fileTypeNoExtension):d.fileTypeFolder};t.getShortcutFileType=function(e){var t=e.slice(e.lastIndexOf(".")+1);return l.format(d.shortcutFileTypeFormat,t.length!==e.length?this.getShortcutFileTypeFromExtension(t):d.fileTypeNoExtension)};t.getShortcutFileTypeFromExtension=function(e){var t=d.fileTypeNoExtension;if(!e)return t;var i=f(l.capitalize(e));if(i)return d["fileType"+i];var r=e.toUpperCase();return r?l.format(d.fileTypeUnknown,r):t};function f(e){return h[e]}t.getNormalizedExtension=f;t.isOfficeDoc=function(e){return e&&-1!==o.indexOf(e)};t.getItemRoot=function(e){for(var t=e;t&&!t.isRootFolder;)t=t.parent;return t};t.isAutoAlbum=function(e){return this.hasAutoAlbumTag(e)&&!!e.properties.newTag};t.hasAutoAlbumTag=function(e){return!!e.properties&&!!e.properties.autoAlbumTag};t.GetDocumentTypeFromExtension=function(e){if(!e)return r.DocumentType.Word;var t=f(l.capitalize(e.split(".").pop()));return t===a?r.DocumentType.OneNote:t===c?r.DocumentType.PowerPoint:t===u?r.DocumentType.Excel:t===p?r.DocumentType.Visio:r.DocumentType.Word}});define("A5",["require","exports","ap","bF","bX","jG","dm","lb","V","dk","kq","dI"],function(e,t,r,i,o,n,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(i){r.__extends(t,i);function t(e){var t=i.call(this,e)||this;t.selection=t.resources.consume(o.itemsSelection);t.showLabels=e.showLabels;t.layoutType=t.resources.consume(n.files.layoutType);return t}t.prototype.showSelectionActionText=function(){var e=this.selection&&this.selection.selection().length||0;return this.showLabels()?l.format(a.strings.NumberSelected,e):e.toString()};t.prototype.computeOpenInOfficeOnlineText=function(){return d.getOfficeOnlineStringMap(c.getSelectedItemApp(this.selection))||a.strings.Open};t.prototype.computeOpenInOfficeClientText=function(){return d.getOfficeStringMap(c.getSelectedItemApp(this.selection))};t.prototype.computeOfficeIcon=function(){var e,t=c.getSelectedItemApp(this.selection);t&&(e=d.getOfficeIconMap(t));return e||new u.default("Page")};t.prototype.computeOfficeClass=function(){return d.getAppName(c.getSelectedItemApp(this.selection))};t.prototype.computeViewSelectorIcon=function(){return new u.default(this.computeViewSelectorIconName())};t.prototype.computeViewSelectorIconName=function(){var e=this.layoutType();return e===s.SingleAlbum?t.singleAlbumIcon:e===s.CompactDetails?t.compactDetailsIcon:e===s.Grid||e===s.CustomGridList?t.gridIcon:t.detailsIcon};t.compactDetailsIcon="AlignLeft";t.detailsIcon="List";t.gridIcon="ViewAll";t.tilesIcon="Tiles";t.singleAlbumIcon="LargeGrid";return t}(i.default);t.default=p});define("M1",["require","exports","ap","aq","dI","bN","ba","lb","jG","bX","dm","rs","by","A5","dm"],function(e,t,r,o,n,i,a,s,l,d,c,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._actionMap=t.resources.consume(d.actionMap);t._layoutType=t.resources.consume(l.files.layoutType);t._platformDetection=t.resources.consume(p.platformDetection);t._isHidden=e.isHidden;t._isDropDown=t._getIsDropDown();t.commands=t._getCommands();return t}e.prototype._getIsDropDown=function(){return a.isFeatureEnabled(a.ODBOpenInExplorer)&&this._platformDetection.isIE||a.isFeatureEnabled(a.CompactListViewInFiles)};e.prototype._generateCommand=function(e){e.isHidden=this._isHidden;e.hasIconOnly=!0;e.renderLabel=1;e.location=4;if(this._isDropDown)e.isToggleable=!0;else{e.keys=["V"];e.automationId="switchLayout"}return new(this.managed(u.CommandViewModel))(e)};e.prototype._getListViewCommand=function(){var e=new(this.managed(this._actionMap.ToggleListLayoutAction))({layoutType:s.Details,strictAvailability:!this._isDropDown}),t={text:c.strings.ViewList,tooltip:c.strings.ViewListCommandTooltip,icon:new n.default(m.default.detailsIcon),action:e,engagementName:"ViewList"};return this._generateCommand(t)};e.prototype._getCompactListViewCommand=function(){var e=new(this.managed(this._actionMap.ToggleListLayoutAction))({layoutType:s.CompactDetails,strictAvailability:!this._isDropDown}),t={text:c.strings.ViewCompactList,tooltip:c.strings.ViewCompactListCommandTooltip,icon:new n.default(m.default.compactDetailsIcon),action:e,engagementName:"ViewCompactList"};return this._generateCommand(t)};e.prototype._getGridViewCommand=function(){var e=new(this.managed(this._actionMap.ToggleListLayoutAction))({layoutType:s.Grid,strictAvailability:!this._isDropDown}),t={text:c.strings.ViewGrid,tooltip:c.strings.ViewGridCommandTooltip,icon:new n.default(m.default.gridIcon),action:e,engagementName:"ViewGrid"};return this._generateCommand(t)};e.prototype._getExplorerViewCommand=function(){var e=new(this.managed(this._actionMap.OpenInExplorerAction)),t={text:c.strings.OpenInExplorer,tooltip:c.strings.OpenInExplorerTooltip,icon:new n.default("Folder"),action:e,engagementName:"ViewExplorer"};return this._generateCommand(t)};e.prototype._getToggleIcon=function(){var t=this;return this.createComputed(function(){var e=t._layoutType();return e===s.CompactDetails?new n.default(m.default.compactDetailsIcon):e===s.Grid?new n.default(m.default.gridIcon):new n.default(m.default.detailsIcon)})};e.prototype._getToggleViewCommand=function(){var e=[this._getListViewCommand(),this._getCompactListViewCommand(),this._getGridViewCommand(),this._getExplorerViewCommand()];return new(this.managed(u.CommandViewModel))({text:h.strings.Views,tooltip:h.strings.ViewsCommandTooltip,renderLabel:0,icon:this._getToggleIcon(),location:4,requiredChildren:1,isHidden:this._isHidden,hasIconOnly:!0,children:o.observableArray(e)})};e.prototype._getCommands=function(){return this._isDropDown?[this._getToggleViewCommand()]:[this._getListViewCommand(),this._getGridViewCommand()]};return e}(i.default);t.default=f});define("M0",["require","exports","ap","bN"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.createBackgroundComputed(function(){!e.action.isAvailable()||e.isEnabled&&!e.isEnabled()||e.action.execute(void 0)});return t}return e}(i.default);t.default=o});define("MZ",["require","exports","Mr","dm","dI","aI","eO","cY","aC","gU","dN"],function(e,t,i,o,n,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function r(){}r.isFolder=function(e,t){return t?e&&(e.type===s.default.Folder||e.type===s.default.OneNote):e&&e.type===s.default.Folder};r.isCheckedOut=function(e){return c.isCheckedOut(e)};r.isCheckedOutByUser=function(e,t){return c.isCheckedOutByUser(e,t)};r.isCheckedOutByOther=function(e,t){return r.isCheckedOut(e)&&!r.isCheckedOutByUser(e,t)};r.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:i.strings.FileCheckedoutOrLockedWarningTitle,component:{name:u.default.tagName,params:{text:i.strings.FileCheckedoutOrLockedWarning}},actions:[{name:o.strings.cancelActionText,execute:function(){return d.default.wrap(2)},icon:new n.default("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:a.ResultTypeEnum.Success}})};r.isPublished=function(e,t){return t.isModerated?e.properties[r.PublishProperty]&&"3"!==e.properties[r.PublishProperty]&&"1"!==e.properties[r.PublishProperty]:0===r.getVersionNoModeration(e,t).minor&&0!==r.getVersionNoModeration(e,t).major};r.isPublishingRelevant=function(e,t){return l.PermissionMask.hasItemPermission(e,l.PermissionMask.editListItems)&&t.enableMinorVersions&&!r.isCheckedOut(e)&&!r.isFolder(e,!0)};r.getVersionNoModeration=function(e,t){if(!t.isModerated&&e&&e.properties&&e.properties[r.VersionProperty]){var i=Number(e.properties[r.VersionProperty])%512;return{major:Math.floor(Number(e.properties[r.VersionProperty])/512),minor:i}}return{major:0,minor:0}};r.isApprovalRelevant=function(e,t){return t&&t.isModerated&&!r.isCheckedOut(e)&&l.PermissionMask.hasItemPermission(e,l.PermissionMask.editListItems)&&l.PermissionMask.hasItemPermission(e,l.PermissionMask.approveItems)};r.FileTypeProperty="FSObjType";r.PublishProperty="_ModerationStatus.";r.VersionProperty="_UIVersion";return r}();t.default=r});define("MY",["require","exports","ap","aC","dH","cY","Lm","bX","eA"],function(r,e,t,o,i,n,a,s,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="CreateFolder";e.item?t._currentItem=e.item:t._currentItem=t.resources.consume(s.currentItem);t._itemParentHelper=t.resources.consume(l.resourceKey);return t}e.prototype.getExecutorPath=function(){return"afL"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){r(["afL"],e,t)})}};e.prototype.getExecutorParameters=function(){return{currentItem:this._currentItem.peek()}};e.prototype.onIsAvailable=function(){var e=this._currentItem();return c(e,this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")))};return e}(a.default);e.default=d;function c(e,t){return!!e&&e.queryType===i.default.Files&&(!t||t.list.allowCreateFolder&&!t.list.isExternal)&&n.PermissionMask.hasItemPermission(e,n.PermissionMask.insertListItems)}e.isSpoCreateFolderAvailable=c});define("Lm",["require","exports","ap","Li","Ln"],function(e,t,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._loader=new(t.managed(o.default))({path:t.getExecutorPath(),getModule:t.getModuleFactory(),getExecutorParams:function(){return t.selectionHelper.resolveSelection().then(function(e){return t.getExecutorParameters({selection:e})})}});return t}e.prototype.onExecute=function(e,t){return this._loader.execute(e,t)};return e}(i.default);t.default=n});define("Li",["require","exports","ap","aC","bN","d7"],function(e,t,r,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._getModule=e.getModule;t._path=e.path;t._getExecutorParams=e.getExecutorParams;t._bundleLoader=t.resources.consume(o.bundleLoader);t._bundleLoader.queueLoad(t._path,t._getModule).done();return t}e.prototype.execute=function(r,o){var n=this;return this._path?this._loadExecutorType().then(function(i){return"function"!=typeof i?a.default.wrapError(new Error("Cannot create action from "+i+": "+n._path)):a.default.as(n._getExecutorParams()).then(function(e){var t=new(n.resources.injected(i))(e);return a.default.as(t.execute(r,o))})}):a.default.wrapError(new Error("Cannot create action from nothing: "+this._path))};e.prototype._loadExecutorType=function(){var e=this._bundleLoader.loadNow(this._path,this._getModule);this._loadExecutorType=function(){return e};return e};return e}(i.default);t.default=n});define("Ln",["require","exports","ap","g4","kG","kp"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.itemCommandHelper=new(t.managed(o.default));t.selectionHelper=new(t.managed(n.default))(r.__assign({},t.getSelectionOptions(),{overrideItem:e.item}));return t}e.prototype.getSelectionOptions=function(){return{}};return e}(i.default);t.default=a});define("MM",["require","exports","ap","MS","M5","aC","ci","d7","dZ","dN","Mr","dm","dI","ba","aI","gV","fO","dk","gK","iE","bX","MN","gO","sq","eh","aN","gR","eA"],function(e,t,i,r,n,a,s,l,d,c,u,p,m,h,f,g,y,v,_,b,x,S,C,P,k,I,T,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._didUserCreateOfficeFile=t.resources.consume(x.didUserCreateOfficeFile.optional);t._itemParentHelper=t.resources.consume(w.resourceKey);t.askForFileName=t.docType===n.DocumentType.OneNote||t.docType===n.DocumentType.ExcelSurvey||t.docType===n.DocumentType.ExcelForm;t._itemUrlHelper=t.resources.consume(y.resourceKey);if(t.templateUrl){t._templateExtension=_.getFileExtension(t.templateUrl,!0).toLowerCase();t._templateAppMapString=v.OfficeIconFileTypeMap[t._templateExtension]}t._pageContext=t.resources.consume(b.pageContext);t.openInNewTab=!1;return t}e.prototype.isCommandSupported=function(){var e=this.getParent(this.item(),"list");return S.isSupported(C.convertToISPListItem(e),this.docType,this._pageContext,this.resources.consume(l.shareByLink),this._shareByLinkNotSupported,this.onExecuteCore.bind(this))};e.prototype.onIsAvailable=function(){var e=this.getParent(this.item(),"list"),t=e&&e.list,i=this._itemParentHelper.getAncestorOrSelf(this.item(),function(e){return"boolean"==typeof e.newWOPIDocumentEnabled}),r=i&&i.peek().newWOPIDocumentEnabled;return o.prototype.onIsAvailable.call(this)&&S.isAvailable(C.convertToISPListItem(this.item()),C.convertToISPListItem(e),t,this.docType,this._pageContext,this.platformDetection,r)};e.prototype.onExecute=function(e,t){if(this.isCommandSupported()){this._didUserCreateOfficeFile&&this._didUserCreateOfficeFile(!0);var i=this.item.peek().key;if(S.shouldCreateInOfficeClient(this.docType,this.templateUrl,this._templateExtension)){var r=this._itemUrlHelper.getItemUrlParts(i),o=g.createProtocolHandlerUrl(this._templateAppMapString,this.templateUrl,g.protocolCommand.New,r.fullItemUrl,this.platformDetection.isChrome&&this.platformDetection.isMac,this._pageContext.isSPO);this.navigation.navigateTo({url:o,frameId:null});return a.default.wrap({resultType:f.ResultTypeEnum.Success})}return!this.templateUrl&&(h.isFeatureEnabled(h.DocAspxCreateNewWord)&&this.docType===n.DocumentType.Word||h.isFeatureEnabled(h.WopiJsApiFrame)&&this.docType===n.DocumentType.PowerPoint)?a.default.wrap(this._createDocumentByDocAspx(i)):this.onExecuteCore()}return a.default.wrap({resultType:f.ResultTypeEnum.Success})};e.prototype._createDocumentByDocAspx=function(e,t){var i,r=this,o=this.resources.consume(d.url),n=S.getCreateDocumentByDocAspxUrl(e,this.docType,this._itemUrlHelper,o.getWopiDocUrl(),t),a=(new Date).getTime().toString();T.WopiHelper.AddWopiPerfMarkToTargetUrl(a,"DocLib",n);var s=window.open("","_blank");new k.default({webAbsoluteUrl:this._pageContext.webAbsoluteUrl}).ensureRequestDigest(function(e){i=e;r.openInNewTab=!0;n&&r.async.setImmediate(function(){return P.navigateViaPost({postdata:(e={},e.__REQUESTDIGEST=i,e),url:n,document:s.document});var e});return{resultType:f.ResultTypeEnum.Success}},function(e){var t,i=e.getErrorResponseText();t="string"==typeof i?i:JSON.stringify(i);I.default.logError("CreateDocumentByDocAspx: "+t);return{resultType:f.ResultTypeEnum.Failure}});return{resultType:f.ResultTypeEnum.Success}};e.prototype._shareByLinkNotSupported=function(){this.resources.consume(s.resourceKey).requestDialog({title:u.strings.CreateExcelSurveyTitle,component:{name:c.default.tagName,params:{text:u.strings.CreateExcelSurveyError}},actions:[{name:p.strings.ok,execute:function(){return a.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new m.default("Cancel"),isDefault:!0}]}).wait().then(function(){})};return e}(r.default);t.default=o});define("MS",["require","exports","ap","kx","dc","aI","M5","MT","aC","dm","dH","dI","eX","ci","by","kL","ba","c7","bX","bA","MO"],function(i,t,r,e,o,u,p,m,s,h,n,f,a,l,d,c,g,y,v,_,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemOperatorAsyncTypeResourceKey=new _.ResourceKey({name:i("module").id+".createItemOperator",loader:new _.AliasResourceLoader(function(){return y.loadModuleExport({path:"Sp",getModule:function(){return new s.default(function(e,t){i(["Sp"],e,t)})},getExport:function(e){return e.typeResourceKey}})})});var x=h.strings,S=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.docType=e.docType;t.templateUrl=e.templateUrl;t.name="Create"+(p.DocumentType[t.docType]||"")+"DocumentAction";t.navigation=t.resources.consume(o.navigation);t._itemProvider=t.resources.consume(a.resourceKey);t._dialogProvider=t.resources.consume(l.resourceKey);t.platformDetection=t.resources.consume(d.platformDetection);t.redirect=!0;t.openInNewTab=!1;t.askForFileName=t.docType===p.DocumentType.OneNote;t._didUserUploadCreateFile=t.resources.consume(v.didUserUploadOrCreateFile.optional);return t}e.prototype.onIsAvailable=function(){return!(this.platformDetection.isMobile&&!this.platformDetection.isIPad)&&this.item().queryType===n.default.Files};e.prototype.isCommandSupported=function(){return!0};e.prototype.onExecute=function(e,t){return this.isCommandSupported()?this.onExecuteCore():s.default.wrap({resultType:u.ResultTypeEnum.Success})};e.prototype.onExecuteCore=function(){if(!this._isCreatingFile){g.isOneDrive&&this.trackPromise(this.resources.consumeAsync(c.resourceKey).then(function(e){e.fireUploadEvents()}));this._didUserUploadCreateFile&&this._didUserUploadCreateFile(!0);var e=this.item.peek();return this.askForFileName?this._createDocumentWithDialog(e):this._createDocument(e)}};e.prototype.createNewFile=function(i,e){var r=this;return this.resources.consumeAsync(t.createItemOperatorAsyncTypeResourceKey).then(function(e){var t=new e({fileName:i,parentItem:r.item.peek()});return r.trackPromise(t.start())})};e.prototype._createDocumentWithDialog=function(t){var i=this,e=this._dialogProvider,r=this.observables.create(""),o=this.observables.create(""),n=this.observables.create(!1),a=this.observables.create(!0),s=null,l=b.getDocExtension(this.docType);this._isCreatingFile=!0;var d=function(e){n(!0);a(!0);o(e);return 1},c=e.requestDialog({title:b.getDialogTitle(this.docType,x),isDismissable:this.docType!==p.DocumentType.Text,component:{name:m.default.tagName,params:{name:r,automationId:"createDocumentDialog",extension:l,status:o,hasError:n,isEnabled:a}},actions:[{name:x.CreateCommit,execute:function(){o(h.strings.Saving);a(!1);n(!1);return e=i.docType===p.DocumentType.OneNote||i.docType===p.DocumentType.ExcelSurvey||i.docType===p.DocumentType.ExcelForm?r.peek():r.peek()+l,i.redirect?i._itemProvider.createDocument(t.key,i.docType,e,i.templateUrl).then(function(e){s=e;return 2},d):i.createNewFile(e,t).then(function(){return 2},d);var e},isAvailable:this.observables.pureCompute(function(){return i._isCreateAvailable(a,r)}),isDefault:!0,icon:new f.default("Save"),automationId:"createDocumentDialogCommit"}]}).wait().then(function(){return{resultType:u.ResultTypeEnum.Success}},function(){return{resultType:u.ResultTypeEnum.ExpectedFailure}});c.done(function(){i._isCreatingFile=!1;if(s){var e=i.navigation;i.async.setImmediate(function(){return e.navigateTo({url:s,frameId:i.openInNewTab?"_blank":null})})}});return c};e.prototype._isCreateAvailable=function(e,t){if(!e())return!1;var i=t();return!!i&&" "!==i[0]};e.prototype._createDocument=function(e,t){var i=this,r=this.navigation,o=this._itemProvider,n=null,a=o.createDocument(e.key,this.docType,t,this.templateUrl).then(function(e){e&&(n=e);return s.default.wrap({resultType:u.ResultTypeEnum.Success})});a.done(function(e){n&&!window._isRunningTABTest&&i.async.setImmediate(function(){return r.navigateTo({url:n,frameId:i.openInNewTab?"_blank":null})})});return a};return e}(e.default);t.default=S});define("MT",["require","exports","MW","b5","MV","MU"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-item-name-editor",template:e("MV"),viewModel:i.default,synchronous:!0});t.default=o});define("MW",["require","exports","ap","aq","bF","MX","uA"],function(e,t,r,o,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.namePlaceholder=n.strings.NewNamePlaceholder;t.nameLabel=n.strings.NewNameLabel;t.name=e.name;t.extension=e.extension;t.status=e.status||o.observable("");t.hasError=e.hasError||o.observable(!1);t.isEnabled=e.isEnabled||o.observable(!0);t.hasFocus=e.hasFocus||o.observable(!0);t.addBindingHandlers({selectOnFocus:a.default});return t}return e}(i.default);t.default=s});define("MV",[],function(){return"<div class=od-ItemNameEditor data-bind=\"css: { 'od-ItemNameEditor--noExtension': !extension, 'is-focused': hasFocus, 'is-error': hasError }\"><div class=od-TextField><label class=\"od-ItemNameEditor-nameLabel ms-Label\" for=ItemNameEditor-input data-bind=\"text: nameLabel\"></label> <span class=od-ItemNameEditor-input><input class=od-TextField-field id=ItemNameEditor-input type=text data-bind=\"textInput: name, hasFocus: hasFocus, selectOnFocus, attr: { placeholder: namePlaceholder }, css: { 'od-ItemNameEditor-input--error': hasError }, enable: isEnabled, automation: 'itemNameEditor-Input'\"></span> <span class=od-ItemNameEditor-extension data-bind=\"text: extension\"></span></div>\x3c!--ko if: hasError--\x3e<div class=od-ItemNameEditor-status aria-live=assertive role=status data-bind=\"text: status, css: { 'od-ItemNameEditor-status--error': hasError }\"></div>\x3c!--/ko--\x3e</div>"});define("MU",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-ItemNameEditor-nameLabel.ms-Label{display:none}.od-ItemNameEditor-input{display:table-cell;width:100%}.od-ItemNameEditor-extension{direction:ltr;display:table-cell}[dir=ltr] .od-ItemNameEditor-extension{padding-left:8px}[dir=rtl] .od-ItemNameEditor-extension{padding-right:8px}.od-ItemNameEditor--noExtension .od-ItemNameEditor-input{display:block;width:auto}.od-ItemNameEditor--noExtension .od-ItemNameEditor-extension{display:none}.od-ItemNameEditor-status{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";word-wrap:break-word}.od-ItemNameEditor-status--error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-ItemNameEditor-input--error{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"!important}"}])});define("MO",["require","exports","ap","MP"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("MP",["require","exports","MQ"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDocExtension=function(e){switch(e){case r.DocumentType.Word:return".docx";case r.DocumentType.Excel:case r.DocumentType.ExcelSurvey:case r.DocumentType.ExcelForm:return".xlsx";case r.DocumentType.PowerPoint:return".pptx";case r.DocumentType.OneNote:return"";case r.DocumentType.Text:return".txt";case r.DocumentType.Visio:return".vsdx"}};t.getDialogTitle=function(e,t){var i="";switch(e){case r.DocumentType.Word:i=t.CreateWord;break;case r.DocumentType.Excel:i=t.CreateExcel;break;case r.DocumentType.PowerPoint:i=t.CreatePowerPoint;break;case r.DocumentType.OneNote:i=t.CreateOneNote;break;case r.DocumentType.ExcelSurvey:i=t.CreateExcelSurvey;break;case r.DocumentType.Text:i=t.CreateText;break;case r.DocumentType.ExcelForm:i=t.CreateFormForExcel;break;case r.DocumentType.Visio:i=t.CreateVisio}return i}});define("MQ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Word=1]="Word";e[e.Excel=2]="Excel";e[e.PowerPoint=3]="PowerPoint";e[e.OneNote=4]="OneNote";e[e.ExcelSurvey=5]="ExcelSurvey";e[e.Text=6]="Text";e[e.ExcelForm=7]="ExcelForm";e[e.Visio=8]="Visio"}(t.DocumentType||(t.DocumentType={}))});define("MN",["require","exports","ap","cY","ey","aX","ej","M5","gR","eh","aN","aI","MR","MO"],function(e,t,s,c,u,p,l,m,h,f,g,y,v,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ODB:973},_={ODB:211};s.__exportStar(i,t);t.isAvailable=function(e,t,i,r,o,n,a){return d(e,s.__assign({},i,{canShareLinkForNewDocument:x(t)}),r,o,n,a)};function d(e,t,i,r,o,n){var a=t&&t.canShareLinkForNewDocument,s=S(r),l=C(r),d=!0;p.isSPFeatureEnabled(_,r.ExpFeatures)&&t&&(d=function(e,t,i){if(p.isSPFeatureEnabled(_,i)){var r=void 0;!function(e){e[e.Invalid=0]="Invalid";e[e.Word=1]="Word";e[e.Excel=2]="Excel";e[e.PowerPoint=3]="PowerPoint";e[e.OneNote=4]="OneNote";e[e.ExcelForm=5]="ExcelForm";e[e.Visio=8]="Visio";e[e.Max=9]="Max"}(r||(r={}));switch(e){case m.DocumentType.Word:case m.DocumentType.Excel:case m.DocumentType.PowerPoint:case m.DocumentType.OneNote:case m.DocumentType.Visio:return Boolean(t&1<<Number(e));case m.DocumentType.ExcelForm:case m.DocumentType.ExcelSurvey:return Boolean(t&1<<Number(5));default:return!0}}return!0}(i,t.newWOPIDocumentTypes,r.ExpFeatures));n=void 0!==n?n:t&&t.newWOPIDocumentEnabled;return(!o.isMobile||o.isIPad)&&!!t&&i!==m.DocumentType.Text&&c.PermissionMask.hasItemPermission(e,c.PermissionMask.insertListItems)&&n&&d&&(i!==m.DocumentType.ExcelSurvey||a&&!s)&&(i!==m.DocumentType.ExcelForm||s&&(t.templateType!==u.default.documentLibrary||!!t.canUserCreateMicrosoftForm))&&(i!==m.DocumentType.Visio||l)}t.isAvailableBasic=d;t.isSupported=function(t,e,i,r,o,n){if(e===m.DocumentType.ExcelForm){if(S(i)){n();return!1}r&&r.getShareByLinkInfo().then(function(e){Boolean(e)&&e.isExternalSharingTipEnabled&&x(t)?n():o()},function(e){o()});return!1}return e!==m.DocumentType.Visio||C(i)};t.shouldCreateInOfficeClient=function(e,t,i){return!(!t||e!==m.DocumentType.Word||"dot"!==i)};function b(e,t,i,r,o){var n=i.getItemUrlParts(e).fullItemUrl;if(null===t||t!==m.DocumentType.Word&&t!==m.DocumentType.PowerPoint)throw new Error("document type is not valid, doc.aspx createNew only support type: 1 - Word, 3 - PowerPoint for the time being.");var a=new l.default(r);a.setQueryParameter("docliburl",encodeURI(n));a.setQueryParameter("doctype",t.toString());a.setQueryParameter("action","editnew");a.setQueryParameter("odsp","1");return a.toString()}t.getCreateDocumentByDocAspxUrl=b;t.createDocumentByDocAspx=function(e,t,i,r,o,n,a){var s,l=b(e,t,i,r),d=(new Date).getTime().toString();l=h.WopiHelper.AddWopiPerfMarkToTargetUrl(d,"DocLib",l);new f.default({webAbsoluteUrl:o}).ensureRequestDigest(function(e){s=e;if(l){var t=window.open("","_blank");n.setImmediate(function(){return v.navigateViaPost({postdata:(e={},e.__REQUESTDIGEST=s,e),url:l,document:t.document});var e})}return{resultType:y.ResultTypeEnum.Success}},function(e){var t,i=e.getErrorResponseText();t="string"==typeof i?i:JSON.stringify(i);g.default.logError("CreateDocumentByDocAspx: "+t);return{resultType:y.ResultTypeEnum.Failure}})};function x(e){return!!(e&&e.properties&&e.properties.commandsSupported&&e.properties.commandsSupported.canShareLinkForNewDocument)}function S(e){return!!e.canUserCreateMicrosoftForm}function C(e){return!!p.isSPFeatureEnabled(_,e.ExpFeatures)||e.isSPO&&(p.isSPFeatureEnabled(r,e.ExpFeatures)||!!e.PreviewFeaturesEnabled)}});define("MR",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.navigateViaPost=function(e){var t=e.document;t.body||t.createElement("body");var i=t.createElement("form");i.action=e.url;i.method="POST";i.style.visibility="hidden";i.target="_self";var r=e.postdata;for(var o in r)if(r.hasOwnProperty(o)){var n=t.createElement("input");n.type="hidden";n.name=o;n.value=r[o];i.appendChild(n)}t.body.appendChild(i);i.submit()}});define("MA",["require","exports","ap","kx","cY","aC","aI","dm","MC","kE","qY","MB","ba","dH","kG","jc"],function(e,t,r,i,o,n,a,s,l,d,c,u,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=u.strings,y=s.strings,v=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="LaunchCreateShortcutPanel";t._panelProvider=t.resources.consume(c.resourceKey);t._shortcutProvider=t.resources.consume(d.resourceKey.optional);t._itemCommandHelper=t.resources.consume(h.resourceKey);return t}e.prototype.onIsAvailable=function(){if(!this._shortcutProvider)return!1;if(!this._itemCommandHelper.isCommandSupported(this.item(),f.createShortcut))return!1;var e=p.isFeatureEnabled(p.ShortcutLink)&&p.isFeatureEnabled(p.SpListNext);return i.prototype.onIsAvailable.call(this)&&this.item().queryType===m.default.Files&&e&&o.PermissionMask.hasItemPermission(this.item(),o.PermissionMask.insertListItems)};e.prototype.onExecute=function(e,t){if(!this._shortcutProvider)return n.default.wrap({resultType:a.ResultTypeEnum.ExpectedFailure});var i=this._panelProvider.requestPanel({hasCommandBar:!1,title:g.CreateShortcutLabel,noTitle:!0,component:{name:l.default.tagName,params:{onComplete:function(){i.state(1)},title:y.CreateShortcut,resources:this.resources}}});return i.wait().then(function(){return{resultType:a.ResultTypeEnum.Success}})};return e}(i.default);t.default=v});define("MC",["require","exports","aq","MJ","b5","MI","MH","MD","df"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.registerComponent({tagName:"ms-createShortcut-pane",template:e("MI"),viewModel:r.default,synchronous:!0});i.components.isRegistered(n.tagName)||i.components.register(n.tagName,n);t.default=n});define("MJ",["require","exports","ap","aq","ML","MB","cE","aZ","kE","cJ","jg","ig","V","ej","bF","zg","MK","jJ","LY"],function(e,t,i,a,o,r,s,n,l,d,c,u,p,m,h,f,g,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=r.strings,b="PastedUrl.ShortcutPanel.Click",x="RecentLink.ShortcutPanel.Click",S=function(t){i.__extends(e,t);function e(e){var o=t.call(this,e)||this;o.urlLabel=_.CreateShortcutLabel;o.createLabel=_.CreateButtonLabel;o.namePlaceholder=_.CreateShortcutPlaceholder;o.enterAddressTextboxAriaLabel=_.EnterAddressTextboxAriaLabel;o.recentHeadingAriaLabel=_.RecentHeadingAriaLabel;o.recentLabel=_.Recent;o.fileNameLabel=_.FileNameLabel;o.fileExtension=".url";o.typingTimeout=100;o.urlFieldFocus=a.observable(!0);o.fileNameFieldFocus=a.observable(!1);o.statusText=a.observable("");o.statusIsInErrorState=a.observable(!1);o.isCreating=a.observable(!1);o.isStatusTextVisible=a.observable(!1);o.statusTextFocus=a.observable(!1);o.filenameInvalid=a.observable(!1);o.createEnabled=o._computeCreateEnabled();o._oldUrlValue="";o.url=a.observable("");o.filename=a.observable("");o.isActive=a.observable(!0);o.onComplete=e.onComplete;o.addBindingHandlers({key:d.default,selection:f.default});var n=o._engagement=o.resources.consume(s.resourceKey);o.recentItemOnClick=function(e,t){var i=e.openUrl?e.openUrl:e.key;o.url(i);var r=e.name.lastIndexOf(".");-1<r?o.filename(e.name.slice(0,r)):o.filename(e.name);n.logData({name:x,isIntentional:!0});o._createShortcutItem(t)};o.subscribe(o.url,function(e){var t=o._shouldPrependHttp(e),i=o._shouldPrependHttp(o._oldUrlValue);1<e.length-o._oldUrlValue.length&&(!i||t)&&n.logData({name:b,isIntentional:!0});o._oldUrlValue=e;t&&o.url("http://"+e.trim());o.typingTimestamp=Date.now();o.async.setTimeout(function(){o.typingTimestamp+o.typingTimeout<=Date.now()&&o._getPreview()},o.typingTimeout)});o._shortcutDataSource=o.resources.consume(c.resourceKey);o._isSharePointUrl=o.createPureComputed(function(){return c.default.isSharePointUrl(o.url())});o._shortcutProvider=o.resources.consume(l.resourceKey);o.recentItems=a.observableArray();o.selectionModel=new y.default({getItemKey:function(e){return e&&e.key||null},maximumSelectedCount:1,mode:1});o.selectionModel.setItems([],!0);o.subscribe(o.recentItems,function(e){o.selectionModel.setItems(e,!1)});o._shortcutProvider.getRecentFiles().then(function(e){o.recentItems(e.content().items.map(function(e){return e.peek()}))});o.layout=a.observable(new g.default({recentItems:o.recentItems}));o.displayRecent=o._computeDisplayRecent();return o}e.prototype.createBtnClick=function(e,t){this._engagement.logData({name:"CreateButton.ShortcutPanel.Click",isIntentional:!0});this._createShortcutItem(t)};e.prototype.itemAriaLabel=function(e){return this.itemType(e)+", "+e.displayName+", "+e.defaultSubText};e.prototype.itemType=function(e){return v.getFriendlyItemType(e)};e.prototype._createShortcutItem=function(e){var t=this;this.url().match(/DocIdRedir\.aspx/i)&&this._engagement.logData({name:"DocIdRedirShortcut.ShortcutPanel.Create"});this.isStatusTextVisible(!1);var i={tasks:null};a.utils.extend(i,a);i.tasks.runEarly();this.statusTextFocus(!0);this.isCreating(!0);this.filenameInvalid(!1);this.statusText(_.CreatingProgressText);this.isStatusTextVisible(!0);this.statusIsInErrorState()&&this.statusIsInErrorState(!1);var r=this.filename()+this.fileExtension;new(this.managed(o.default))({filename:function(){return r},url:a.observable(this.url()),onComplete:this.onComplete,onError:function(e){t.statusIsInErrorState(!0);t.isStatusTextVisible(!1);if(e===u.default.ShortcutErrors.NewFileCreationFileAlreadyExistsError){t.filenameInvalid(!0);t.statusText(_.FileAlreadyExistsError)}else if(e===u.default.ShortcutErrors.InvalidCharacterError){t.filenameInvalid(!0);t.statusText(p.format(_.InvalidCharacterError,r))}else t.statusText(_.UnknownError);t.isCreating(!1);t.async.setTimeout(function(){t.isStatusTextVisible(!0);t.fileNameFieldFocus(!0)},200)}}).execute(e)};e.prototype._shouldPrependHttp=function(e){return!/^\s*(h(t(t(ps?(:(\/(\/.*)?)?)?)?)?)?)?$/i.test(e)};e.prototype._getPreview=function(){var t=this;if(this._isSharePointUrl()&&this._shortcutDataSource.isInternal(this.url(),n.default.Empty))this._shortcutProvider.getFileByUrl(this.url()).then(function(e){t.filename(e.Name)});else{var e=new m.default(this.url());this.filename(e.getHost())}};e.prototype._computeDisplayRecent=function(){var e=this;return this.createPureComputed(function(){return""===e.url()})};e.prototype._computeCreateEnabled=function(){var e=this;return this.createPureComputed(function(){return""!==e.url()&&!e.isCreating()&&""!==e.filename()})};return e}(h.default);t.default=S});define("ML",["require","exports","ap","kx","aC","kE","aI","ba"],function(e,t,r,i,n,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="CreateShortcut";t.filename=e.filename;t.url=e.url;t.onComplete=e.onComplete;t.onError=e.onError;t._shortcutProvider=t.resources.consume(o.resourceKey.optional);return t}e.prototype.onExecute=function(e,t){var i=this,r=this._shortcutProvider;if(!r)return n.default.wrap({resultType:a.ResultTypeEnum.ExpectedFailure});var o=this.item.peek();return r.createShortcut(o.key,this.filename(),this.url.peek()).then(function(e){i.onComplete();return{resultType:a.ResultTypeEnum.Success}},function(e){i.onError&&i.onError(e);return{resultType:a.ResultTypeEnum.Failure}})};e.prototype.onIsAvailable=function(){if(!this._shortcutProvider)return!1;var e=this.getParent(this.item(),"list");return i.prototype.onIsAvailable.call(this)&&s.isFeatureEnabled(s.ShortcutLink)&&(!e||e.list.isDocumentLibrary)};return e}(i.default);t.default=l});define("MK",["require","exports","ap","bN"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._items=e.recentItems;return t}e.prototype.getItemIndexAbove=function(e){var t=this._items.peek();return Math.min(t.length-1,Math.max(0,e-1))};e.prototype.getItemIndexBelow=function(e){var t=this._items.peek();return Math.min(t.length-1,Math.max(0,e+1))};e.prototype.getItemIndexLeft=function(e){return e};e.prototype.getItemIndexRight=function(e){return e};e.prototype.getItemIndicesInRegion=function(e){return[]};e.prototype.getToggleClass=function(){return""};return e}(i.default);t.default=o});define("MI",[],function(){return'<div class=od-CreateShortcut><div class=od-CreateShortcut-url><div class=od-TextField><label class="od-CreateShortcut-label ms-font-xl ms-fontWeight-semilight" data-bind="text: urlLabel" for=od-CreateShortcut-urlField></label> <span class=od-CreateShortcut-url-Input><input id=od-CreateShortcut-urlField class=od-TextField-field type=text data-bind="textInput: url, attr: { \'aria-label\': enterAddressTextboxAriaLabel, placeholder: namePlaceholder, title: namePlaceholder }, hasFocus: urlFieldFocus"></span></div></div><div class=od-CreateShortcut-recentContainer data-bind="css: { \'od-CreateShortcut-notVisible\': !displayRecent() }"><div data-bind="selection: { items: recentItems, layout: layout, selectionModel: selectionModel }"><div class=od-CreateShortcut-recentHeading role=listbox data-bind="attr: { \'aria-label\': recentHeadingAriaLabel }, text: recentLabel" tabindex=0></div><div class=od-CreateShortcut-recentItemContainer data-bind="foreach: { data: recentItems, as: \'item\' }"><div class=od-CreateShortcut-recentItem role=listitem data-bind="if: $data.displayName, click: $component.recentItemOnClick, attr: {\'aria-label\': $component.itemAriaLabel($data)}, key: { mappings: { Enter: $component.recentItemOnClick, Space: $component.recentItemOnClick }}, hasFocus: $component.selectionModel.focusedItem() === $data" tabindex=-1><div class=od-CreateShortcut-recentItemIcon data-bind="component: { name: \'ms-file-type-icon\', params: { iconName: iconName, desiredSize: 48 } }"></div><div class=od-CreateShortcut-recentItemDetails><div class=od-CreateShortcut-recentItemTitle data-bind="text: displayName"></div>\x3c!--ko if: $data.defaultSubText--\x3e<div class=od-CreateShortcut-recentItemSubText data-bind="text: defaultSubText"></div>\x3c!--/ko--\x3e</div></div></div></div></div><div class=od-CreateShortcut-fileName data-bind="css: { \'od-CreateShortcut-notVisible\': displayRecent() }"><div class=od-TextField><label id=od-fileNameLabel class=od-CreateShortcut-label data-bind="text: fileNameLabel" for=od-CreateShortcut-fileName-input></label> <span class=od-CreateShortcut-fileName-input><input id=od-CreateShortcut-fileName-input class=od-TextField-field type=text data-bind="hasFocus: fileNameFieldFocus, attr: { \'aria-invalid\': filenameInvalid }, textInput: filename" aria-labelledby=od-fileNameLabel></span> <span data-bind="text: fileExtension"></span></div><div class="od-CreateShortcut-createStatus ms-font-s" role=alert aria-relevant=all aria-atomic=true data-bind="css: { \'od-CreateShortcut-error\': statusIsInErrorState }, text: statusText, visible: isStatusTextVisible, hasFocus: statusTextFocus" tabindex=-1></div><div class=od-CreateShortcut-createButton><button class="od-Button od-Button--primary" id=od-CreateShortcut-createButton data-bind="enable: createEnabled, click: createBtnClick"><span class=od-Button-label data-bind="text: createLabel"></span></button></div></div></div>'});define("MH",["c","az"],function(e,t){e.loadStyles([{rawString:".od-CreateShortcut{box-sizing:border-box}.od-CreateShortcut::after,.od-CreateShortcut::before{display:table;content:'';line-height:0}.od-CreateShortcut::after{clear:both}.od-CreateShortcut-label{display:block;margin-top:10px;margin-bottom:10px}.od-CreateShortcut-fileName{transition-delay:0s;transition:opacity .25s ease-in-out}.od-CreateShortcut-fileName-input{display:inline-block;width:90%}.od-CreateShortcut-recentContainer{position:absolute;width:80%;margin-top:20px;transition-delay:0s;transition:opacity .25s ease-in-out}.od-CreateShortcut-notVisible{opacity:0;visibility:hidden;transition:opacity .25s ease-in-out,visibility 0s linear .25s}.od-CreateShortcut-recentHeading{margin-bottom:8px}.od-CreateShortcut-recentItemSubText{font-size:12px}.od-CreateShortcut-recentItem{position:relative;height:64px;cursor:pointer}.od-CreateShortcut-recentItem:focus,.od-CreateShortcut-recentItem:hover{background-color:"},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:'}.od-CreateShortcut-recentItemDetails,.od-CreateShortcut-recentItemIcon{position:absolute;margin:auto;top:0;bottom:0}.od-CreateShortcut-recentItemIcon{height:48px;left:8px}.od-CreateShortcut-recentItemDetails{left:0;right:0;height:40px}.od-CreateShortcut-recentItemSubText,.od-CreateShortcut-recentItemTitle{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}[dir=ltr] .od-CreateShortcut-recentItemSubText,[dir=ltr] .od-CreateShortcut-recentItemTitle{margin-left:64px}[dir=rtl] .od-CreateShortcut-recentItemSubText,[dir=rtl] .od-CreateShortcut-recentItemTitle{margin-right:64px}[dir=ltr] .od-CreateShortcut-recentItemSubText,[dir=ltr] .od-CreateShortcut-recentItemTitle{margin-right:5px}[dir=rtl] .od-CreateShortcut-recentItemSubText,[dir=rtl] .od-CreateShortcut-recentItemTitle{margin-left:5px}.od-CreateShortcut-recentItemTitle{font-size:14px}.od-CreateShortcut-recentItemSubText{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;opacity:.7}.od-CreateShortcut-createStatus{margin-top:12px;color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-CreateShortcut-error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-CreateShortcut-createButton{margin-top:24px;text-align:right}"}])});define("MD",["require","exports","MG","b5","MF","ME"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-iframe",template:e("MF"),viewModel:i.default,synchronous:!0});t.default=o});define("MG",["require","exports","ap","bF"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(i){var r=o.call(this,i)||this,e=r.observables;r.url=e.wrap(i.url);r.title=e.wrap(i.title);var t=i.isExcludeFromScreenReader;r.tabindex=t?"-1":null;r.role=t?"presentation":null;r._isEmailAttestationPage=e.create(!1);r.isVisible=e.pureCompute(r._computeIsVisible);r.isTitleVisible=e.pureCompute(r._computeIsTitleVisible);r.iframeOnLoad=function(e,t){try{-1<t.target.contentWindow.location.href.toLowerCase().indexOf("emailattestation.aspx")&&r._isEmailAttestationPage(!0)}catch(t){}i.onload&&i.onload(t)};return r}e.prototype._computeIsVisible=function(){return!!this.url()&&!this._isEmailAttestationPage()};e.prototype._computeIsTitleVisible=function(){return!!this.title()};return e}(r.default);t.default=o});define("MF",[],function(){return'\x3c!--ko if: isVisible--\x3e<div class=IFrame>\x3c!--ko if: title--\x3e<div class=ms-IFrameCtrl-title data-bind="text: title"></div>\x3c!--/ko--\x3e<iframe class=ms-IFrameCtrl-iFrame data-bind="attr: {src: url, role: role, tabindex: tabindex}, event: {load: iframeOnLoad}"></iframe></div>\x3c!--/ko--\x3e'});define("ME",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-IFrameCtrl-title{font-size:17px}.ms-IFrameCtrl-iFrame{width:100%;border:0;min-height:200px}"}])});define("Mz",["require","exports","ap","aC","cY","Lm","bX"],function(r,e,t,o,n,i,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="Delete";t._currentItem=t.resources.consume(a.currentItem);return t}e.prototype.getExecutorPath=function(){return"afI"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){r(["afI"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};e.prototype.onIsAvailable=function(){return this._currentItem()&&this.selectionHelper.filterItems(function(e){return!e.list&&n.PermissionMask.hasItemPermission(e,n.PermissionMask.deleteListItems)})};return e}(i.default);e.default=s});define("My",["require","exports","ap","aC","Lm","bX","ba","eA","eO","gA","dZ","vk","kG","i7","gO","cY"],function(r,e,t,o,i,n,d,a,c,u,s,l,p,m,h,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var g=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="Download";t._urlDataSource=t.resources.consume(s.url);t._currentItem=t.resources.consume(n.currentItem);t._itemParentHelper=t.resources.consume(a.resourceKey);t._itemCommandHelper=t.resources.consume(p.resourceKey);return t}e.prototype.getExecutorPath=function(){return"afG"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){r(["afG"],e,t)})}};e.prototype.getSelectionOptions=function(){var e=d.isFeatureEnabled(d.DownloadAsZip);return{allowMultiSelect:e,canFallback:e}};e.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),actionName:this.name}};e.prototype.onIsAvailable=function(){var t=this,e=this._currentItem();if(!e)return!1;var i=this._urlDataSource.getKeyParams(e.key),r=this._urlDataSource.getQueryType(i);if(this._urlDataSource.isRecycleBin(r))return!1;var o=this.selectionHelper.selection(),n=o&&1<o.length;if(n&&(!d.isFeatureEnabled(d.DownloadAsZip)||o[0]&&o[0]&&o[0].peek()&&!o[0].peek().urls[u.default.itemUrl]||!o[0].peek().urls[u.default.downloadAsZip]))return!1;var a=o.filter(function(e){return e&&t._canDownloadItem(e)}),s=a.length,l=a.filter(function(e){return e&&e.peek().urls[u.default.itemUrl]&&e.peek().urls[u.default.itemUrl]});return!(n&&l&&s>l.length)&&(1<s||s&&(!!this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(a[0].peek(),"list"))||a[0].peek().type===c.default.Folder))};e.prototype._canDownloadItem=function(e){var t=e();if(3===t.itemStatus||4===t.itemStatus)return!1;if(!f.PermissionMask.hasItemPermission(t,f.PermissionMask.openItems))return!1;var i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list"));return this._itemCommandHelper.isCommandSupported(t,m.download)&&l.canDownloadItem(h.convertToISPListItem(t),h.convertToISPListItem(i),!1)};return e}(i.default);e.default=g});define("Mx",["require","exports","ap","aC","kx","Li","kp","dZ","dH","ey","eX","kG","i9"],function(a,e,t,s,i,l,d,c,r,o,u,p,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(n){t.__extends(e,n);function e(e){void 0===e&&(e={});var t,i=n.call(this,e)||this;i.name="Share";i._urlDataSource=i.resources.consume(c.url);if(e.itemKey){var r=i.resources.consume(u.resourceKey);t=r.getSpecifiedItems({itemKeys:[e.itemKey],recurseInFolders:!0}).then(function(e){return e.children})}i._selectionHelper=new(i.managed(d.default))({canFallback:!0,overrideItem:e.item,allowMultiSelect:!1});i._itemCommandHelper=i.resources.consume(p.resourceKey);var o=e.activeTab||1;i._loader=new(i.managed(l.default))({path:"aek",getModule:function(){return new s.default(function(e,t){a(["aek"],e,t)})},getExecutorParams:function(){return{selectionHelper:i._selectionHelper,activeTab:i.observables.create(o),deferredItems:t,initialTab:o}}});return i}e.prototype.onIsAvailable=function(){var e=this.item();if(!this._itemCommandHelper.isCommandSupported(e,m.share))return!1;if(!e||e.queryType===r.default.Discover||e.queryType===r.default.RecycleBin||e.queryType===r.default.SecondStageRecycleBin)return!1;var t=this.getParent(e,"list");if(!t)return!1;if(t&&t.list.templateType===o.default.webPageLibrary)return!1;if(this._urlDataSource.isCurrentQuery(r.default.DocumentLibraries))return!1;var i=this._selectionHelper.firstItem();return!!i&&this._itemCommandHelper.isCommandSupported(i,m.share)&&!i.isPlaceholder&&!i.isRootFolder&&!i.list&&!i.subsite};e.prototype.onExecute=function(e){return this._loader.execute(e)};return e}(i.default);e.default=n});define("Ml",["require","exports","ap","kz","aC","bX","aI","Ms","dH","cY","Mr","Mo","ba","V","dZ","iE","ci","Mn","by","ey","ep","dJ","Mm","kG","i7","bb","aN"],function(e,t,x,i,l,r,d,c,a,s,u,p,m,h,S,o,n,C,f,g,y,P,v,_,b,k,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=function(i){x.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="Sync";t._dialogProvider=t.resources.consume(n.resourceKey);t._currentItem=t.resources.consume(r.currentItem);t._platformDetection=t.resources.consume(f.platformDetection);t._pageContext=t.resources.consume(o.pageContext);t._urlDataSource=t.resources.consume(S.url);t._itemCommandHelper=t.resources.consume(_.resourceKey);t._viewParams=t.resources.consume(r.viewParams);t._syncMode=t.createPureComputed(t._computeSyncMode);t._syncDataSource=t.resources.consume(v.resourceKey);return t}e.prototype.onExecute=function(e,t){var i,r,o=this._dialogProvider,n="https://go.microsoft.com/fwlink/?LinkID=708540";this._platformDetection.isMac?n="https://go.microsoft.com/fwlink/p/?LinkId=248255":this._platformDetection.isWindows&&(n="https://go.microsoft.com/fwlink/p/?LinkId=248256");if(2===this._syncMode.peek()){this.name="SyncNGSC";this._constructNGSCProtocolHandlerUrl().then(function(e){if(e){(r=document.createElement("iframe")).setAttribute("src",e);r.style.display="none";r.style.width="1px";r.style.height="1px";document.documentElement.appendChild(r)}});i=o.requestDialog({title:u.strings.NGSCSyncDialogTitle,automationId:"ngscDialog",component:{name:p.default.tagName,params:{html:h.format(u.strings.NGSCSyncDialogBody1)+"<br><br />"+h.format(u.strings.NGSCSyncDialogBody2,this._pageContext.userLoginName)+"<br><br />"+h.format(u.strings.NGSCSyncDialogBody3,"<a href='"+n+"' target='_blank'>","</a>")}}})}else{var a=this._currentItem;i=o.requestDialog({title:"",component:{name:c.default.tagName,params:{item:a,resources:this.resources}},actions:[]})}var s=function(){r&&document.documentElement.removeChild(r)};i.wait().then(s,s);return l.default.wrap({resultType:d.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){var e=this._viewParams();return 0!==this._syncMode()&&!e.needsAttentionView};e.prototype._constructNGSCProtocolHandlerUrl=function(){var i=this,r=this._pageContext,o=r.siteId,n=r.webId,a=r.webTitle,s=r.userLoginName,l=r.webAbsoluteUrl,d=r.webLogoUrl,c=r.isSiteAdmin,u=Number(r.webTemplate),p=this.item.peek(),e=this.getParent(p,"list",!0),t=this.getParent(p,"subsite",!0);t&&t.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl&&(m=t.subsite,n=m.id,o=m.siteCollectionId,u=m.webTemplateId,l=m.serverRelativeUrl,a=m.title,d=m.icon);var m,h=this._urlDataSource.getKeyParams(p.key),f=e.name,g=e.list,y=g.id,v=g.templateType,_=p.name,b=h.id;return this._getUserIdQueryParam().then(function(e){var t=x.__assign({},e,{siteId:o,webId:n,webTitle:a,listId:y,listTitle:f,userEmail:r.isSPO?s:r.userEmail,listTemplateTypeId:v,webUrl:encodeURI(l),webLogoUrl:encodeURI(d),isSiteAdmin:c?1:0,webTemplate:u,onPrem:r.isSPO?0:1});return _&&!p.list?i.resources.consumeAsync(S.folder).then(function(e){return e.getFolderId(p)}).then(function(e){return e?x.__assign({},t,{folderId:e,folderName:_,folderUrl:b,scope:C.FOLDER}):null}):x.__assign({},t,{scope:C.LIST})}).then(function(e){return e?"odopen://sync?"+P.serializeQuery(e):null})};e.prototype._getUserIdQueryParam=function(){return k.default.isActivated("C63D1AC2-81DF-4AE2-BE68-2A7FFF72310D","Append SID to NGSC URL")?l.default.resolve({}):this._syncDataSource.getUserId().then(function(e){return{userId:e}},function(e){I.default.log(e,"Error retrieving user profile info for Sync");return{}})};e.prototype._computeSyncMode=function(){if(!this._itemCommandHelper.isCommandSupported(this.item(),b.sync))return 0;if(m.isFeatureEnabled(m.HideSyncButton)||this._platformDetection.isMobile)return 0;var e=Number(this._pageContext.webTemplate);if(e===y.default.mySite&&this._pageContext.hideSyncButtonOnODB)return 0;var t=this.item();if(t.queryType!==a.default.Files||!s.PermissionMask.hasItemPermission(t,s.PermissionMask.openItems)||3===t.itemStatus||4===t.itemStatus)return 0;var i=this.getParent(t,"list");if(!i)return 0;var r=i.list,o=r.templateType;if(r.excludeFromOfflineClient||o===g.default.webPageLibrary)return 0;if(this._platformDetection.isMac)return 2;var n=this.getParent(t,"subsite");n&&n.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl&&(e=n.subsite.webTemplateId);if(!this._pageContext.isSPO&&!k.default.isActivated("4627E04F-471D-4384-A608-8B4DD842F2E5","1/4/2017","Force NGSC for on-prem Sync."))return 2;if(!this._pageContext.isSPO)return 1;switch(e){case y.default.mySite:return m.isFeatureEnabled(m.ODBSyncButtonDefaultNGSC)||this._pageContext.showNGSCDialogForSyncOnODB?2:1;default:case y.default.teamSite:case y.default.group:return this._pageContext.showNGSCDialogForSyncOnTS?2:1}};return e}(i.default);t.default=T});define("Ms",["require","exports","Mv","b5","Mu","Mt"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-sync-dialog-builder",template:e("Mu"),viewModel:i.default,synchronous:!0});t.default=o});define("Mv",["require","exports","ap","bF","Mw","ej","iE","ci","iD","cE","dZ","ba","fO","eA","aC","dJ"],function(e,t,r,i,o,_,n,b,x,S,a,C,s,l,d,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){r.__extends(v,i);function v(e){var t=i.call(this,e)||this;t.syncLabel=o.strings.SyncLabel;t.syncNow=o.strings.SyncNow;t.getSync=o.strings.GetSync;t._item=e.item;t._syncActiveXClient=null;t._pageContext=t.resources.consume(n.pageContext);t._itemUrlHelper=t.resources.consume(s.resourceKey);t._itemParentHelper=t.resources.consume(l.resourceKey);return t}v.stringToASCIIAlnum=function(e){for(var t="",i=0;i<e.length;i++){var r=e[i];if(v.isWAsciiAlnum(r))t+=r;else{t+="_";var o=r.charCodeAt(0);if(o<=99)t+=o.toString();else{t+=String.fromCharCode(97+Math.floor(o/4096));t+=String.fromCharCode(97+Math.floor(o/256)%16);t+=String.fromCharCode(97+Math.floor(o/16)%16);t+=String.fromCharCode(97+o%16)}}}return t};v.isWAsciiAlnum=function(e){return"a"<=e&&e<="z"||"A"<=e&&e<="Z"||"0"<=e&&e<="9"};v.getScopeName=function(e){switch(e){case 1:return"OPENSITE";case 2:return"OPENLIST";case 3:return"OPENFOLDER";default:throw"ArgumentException: Incorrect offline scope value"}};v.prototype.onClick=function(e,t){C.isFeatureEnabled(C.GrooveNewProtocol)?this._doModifiedOpenGrooveProtocol(e,t):this._doOpenGrooveProtocol(e,t)};v.prototype._getNormalizedFolderUrl=function(){var e=this._item(),t=this._itemUrlHelper.getItemUrlParts(e.key),i=t.serverRelativeItemUrl;return t.serverRelativeListUrl!==i?i:""};v.prototype._doModifiedOpenGrooveProtocol=function(t,i){var r=this;(this._getNormalizedFolderUrl()?this.resources.consumeAsync(a.folder).then(function(e){return e.getFolderId(r._item.peek())}):d.default.wrap()).done(function(e){r._doOpenGrooveProtocol(t,i,e)})};v.prototype._doOpenGrooveProtocol=function(e,t,i){var r=[];r.push("/");var o=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._item.peek(),"list")),n=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._item.peek(),"subsite")),a=this._pageContext.webAbsoluteUrl,s=Number(this._pageContext.webTemplate);n&&n.subsite.serverRelativeUrl!==a&&(a=(g=n.subsite).serverRelativeUrl,s=g.webTemplateId);var l=o.list.id;this.resources.consume(S.resourceKey).logData({name:"SyncDialog.SyncNow.Click",isIntentional:!0});var d=this._item.peek(),c=this._itemUrlHelper.getItemUrlParts(d.key).listRelativeItemUrl,u=0<c.length?3:2;this._syncActiveXClient||(this._syncActiveXClient=this.resources.consume(x.syncActiveXClient.optional));if(!this._syncActiveXClient||!this._syncActiveXClient.TryUseOfflineClient(u,s,a,1,700,l,c)){if(l){r.push(v.stringToASCIIAlnum(a));r.push(v.stringToASCIIAlnum(l));r.push(v.stringToASCIIAlnum("700"));0<c.length&&r.push(v.stringToASCIIAlnum(c))}var p=new _.default(r.join("/"));p.setScheme("grvopen");var m=p.toString()+"?"+v.getScopeName(0<c.length?3:2);C.isFeatureEnabled(C.GrooveNewProtocol)&&(m+=this._getExtraGrooveParameters(i));var h=window.location.href;try{window.location.assign(m)}catch(e){var f=!1;if(e)if(2147500037===e.result)f=!0;else if("NS_ERROR_UNKNOWN_PROTOCOL"===e.name){window.location.assign(h);f=!0}if(!f)throw e}}var g,y=this.resources.consume(b.resourceKey).currentDialog();y&&y.complete()};v.prototype._getExtraGrooveParameters=function(e){var t=this._pageContext,i=t.siteId,r=t.webId,o=t.webTitle,n=t.userLoginName,a=t.webAbsoluteUrl,s=t.webLogoUrl,l=t.webTemplate,d=t.isSiteAdmin,c=this._getNormalizedFolderUrl(),u=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._item.peek(),"subsite")),p=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._item.peek(),"list"));if(u&&u.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl){i=(m=u.subsite).siteCollectionId,r=m.id,o=m.title,s=m.icon,a=m.serverRelativeUrl;d=!1}var m,h=p.list,f=h.id,g=h.templateType,y=p.name,v=this._item.peek().name,_={siteId:i,webId:r,webTitle:o,listId:f,listTitle:y,userEmail:n,listTemplateTypeId:g,webUrl:a,webLogoUrl:s,webTemplate:l,isSiteAdmin:d?1:0};if(e&&c){_.folderId=e;_.folderName=v;_.folderUrl=c}return"&"+P.serializeQuery(_)};return v}(i.default);t.default=c});define("Mu",[],function(){return'<p class=od-Dialog-title data-bind="text: syncLabel"></p><br><a data-bind="click: onClick" href=javascript:; class="od-SyncDialog-syncButton od-Dialog-content"><span class=od-syncButtonIconParent><i class="ms-Icon ms-Icon--SyncToPC" data-bind="icon: true"></i></span>&nbsp;\x3c!--ko text: syncNow--\x3e\x3c!--/ko--\x3e</a><br><a href="http://go.microsoft.com/fwlink/?LinkID=398035" class=od-Dialog-content target=_blank data-bind="text: getSync"></a>'});define("Mt",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-syncButtonIconParent{font-size:16px;position:relative;display:inline-block;overflow:hidden;vertical-align:middle;padding-right:5px}.od-syncButtonIcon{position:absolute;left:-200px;top:-66px}.od-SyncDialog-syncButton{display:block}.od-SyncDialog-syncButton:hover{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}"}])});define("Mo",["require","exports","Mq","b5","Mp"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-html-container",template:e("Mp"),viewModel:i.default});t.default=o});define("Mq",["require","exports","ap","bF"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.html=e.html;return t}return e}(i.default);t.default=o});define("Mp",[],function(){return'<div class=HTMLContainer data-bind="html: html"></div>'});define("Mn",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FOLDER="OPENFOLDER";t.LIST="OPENLIST";t.SITE="OPENSITE"});define("Mm",["require","exports","gl","fZ","iE","bA"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){void 0===e&&(e={});this._apiUrlHelper=t.apiUrlHelper;this._pageContext=t.pageContext;this._dataRequestor=new t.dataRequestorType({qosName:"SyncDataSource"})}e.prototype.getUserId=function(){if(this._pageContext.isSPO){var e=this._apiUrlHelper.build().segments("sp.userprofiles.peoplemanager","getmyproperties");return this._dataRequestor.getData({url:e.toString(),method:"GET",qosName:"GetMyProperties"}).then(function(e){var t=e.d.UserProfileProperties.results.filter(function(e){return"msOnline-ObjectId"===e.Key})[0];return t&&t.Value})}e=this._apiUrlHelper.build().segments("web","currentuser");return this._dataRequestor.getData({url:e.toString(),method:"GET",qosName:"GetCurrentUser"}).then(function(e){return e.d.UserId.NameId})};return e}();t.SyncDataSource=a;t.resourceKey=n.createResolvedResourceKey(e("module").id,a,{dataRequestorType:i.typeResourceKey,apiUrlHelper:r.resourceKey,pageContext:o.pageContext})});define("L1",["require","exports","ap","aC","kx","iE","dH","dc","bX","cY","hH","aI","eX","cE","jG","hE","by","Mb","dZ","dJ","kG","jb","ez","L2"],function(e,t,r,o,i,s,l,n,a,d,u,c,p,m,h,f,g,y,v,_,b,x,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="EditList";t._navigation=t.resources.consume(n.navigation);t._itemProvider=t.resources.consume(p.resourceKey);t._currentView=t.resources.consume(a.currentView);t._viewParams=t.resources.consume(a.viewParams);t._pageContext=t.resources.consume(s.pageContext);t._itemSet=t.resources.consume(a.currentItemSet);t._platformDetection=t.resources.consume(g.platformDetection);t._urlDataSource=t.resources.consume(v.url);t._itemCommandHelper=t.resources.consume(b.resourceKey);t._element=null;void 0!==window.addEventListener&&t.events.on(window,"message",t._onReceiveMessage);return t}e.prototype.refreshItemSet=function(){this._element&&this._element.parentNode&&this._element.parentNode.removeChild(this._element);var e=this._itemProvider,t=this.item();e.invalidateItem(t.key)};e.prototype.onIsAvailable=function(){if(this._platformDetection.isMobile)return!1;if(this._isOOTBDoclib())return!1;var e=this.item(),t=this.resources.isExposed(s.inplaceEditorUrl)?this.resources.consume(s.inplaceEditorUrl):null,i=this._currentView(),r=this._viewParams(),o=this._itemSet().content.peek().groupings,n=o&&0<o.length,a=this.getParent(e,"list");return!!this._itemCommandHelper.isCommandSupported(e,x.quickEdit)&&(this.item().queryType===l.default.Files&&!n&&!!a&&a.list.allowGridMode&&i&&i.id&&!r.needsAttentionView&&d.PermissionMask.hasItemPermission(e,d.PermissionMask.editListItems)&&(!t||!t()))};e.prototype.onExecute=function(e,t){this.resources.consume(m.resourceKey).logData({name:"InPlaceEdit.Click",isIntentional:!0});this.resources.consume(s.inplaceEditorUrl)(this.getIPEUrl());this.resources.consume(h.base.infoPane.isInfoPaneExpanded)(!1);this.resources.consume(h.base.filtersPane.isFiltersPaneExpanded)(!1);return o.default.wrap({resultType:c.ResultTypeEnum.Success})};e.prototype.getIPEUrl=function(){var e,t,i=this._urlDataSource.getKeyParams(this._itemSet.peek().item.peek().key),r="&"+_.serializeQuery({RootFolder:i.id}),o=this._currentView.peek();if(o){e=o.serverRelativeUrl;t=o.id}else{t=this._pageContext.viewId;e=window.location.pathname}var n=window.location.protocol+"//"+window.location.host+e;n+="?Minimized=TRUE"+r;o.isPersonal&&(n+="&PageView=Personal&ShowWebPart="+o.id.toUpperCase());for(var a={ShowInGrid:"True"},s=this._navigation.viewParams,l=0,d=Object.keys(s);l<d.length;l++){var c=d[l];u.filterKeyRegex.test(c)?a[c]=s[c]:"sortField"===c?a.SortField=s[c]:"isAscending"===c&&(a.SortDir="false"===s[c]?"Desc":"Asc")}a.SortField&&!a.SortDir&&(a.SortDir="Asc");return n+=f.default.getInplviewHash(t,a)};e.prototype._onReceiveMessage=function(e){"ExitGrid"===e.data?y.default.closeIPE(this.resources,this.async,this._itemProvider):"ClosingGrid"===e.data&&y.default.closingIPE(this.resources)};e.prototype._isOOTBDoclib=function(){var e=this.getParent(this.item(),"list"),t=this._itemSet(),i=t&&t.schema();return!!(e&&e.list.isDocumentLibrary&&S.isOutOfTheBoxList(i))};return e}(i.default);t.default=C});define("Mb",["require","exports","ap","g4","Mc","aC","aI","iE","jG"],function(e,t,r,i,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(t){r.__extends(i,t);function i(){var e=null!==t&&t.apply(this,arguments)||this;e.name="CancelEditAction";return e}i.closeIPE=function(e,t,i){e.isExposed(s.inplaceEditorUrl)&&t.setTimeout(function(){e.consume(s.inplaceEditorUrl)("");if(e.isExposed(l.base.infoPane.isInfoPaneAvailable)){e.consume(l.base.infoPane.isInfoPaneAvailable)(!0)}e.consume(o.resourceKey).invalidateSchema()},250)};i.closingIPE=function(e){if(e.isExposed(s.inplaceEditorClosing)){var t=e.consume(s.inplaceEditorClosing);t(!0);t(!1)}};i.prototype.onIsAvailable=function(){var e=this.resources.consume(s.inplaceEditorUrl.optional);return!(!e||!e())};i.prototype.onExecute=function(e,t){i.closingIPE(this.resources);return n.default.wrap({resultType:a.ResultTypeEnum.Success})};return i}(i.default);t.default=d});define("Mc",["require","exports","Mk","Mg","hH","Mf","Md","k9","ci","eX","bX","iE","aC","dI","aI","bA"],function(e,t,i,r,o,a,s,n,l,d,c,u,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(){function e(e,t){this._currentView=t.currentView;this._viewParams=t.viewParams;this._dialogProvider=t.dialogProvider;this._listProvider=t.listProvider;this._listContext=t.listContext;this._currentItem=t.currentItem;this._itemProvider=t.itemProvider}e.prototype.showDialog=function(t){t.listFields&&this._listProvider.getFields(!0).then(function(e){t.listFields(e)});return this._dialogProvider.requestDialog({title:t.title,component:{name:r.default.tagName,params:{state:t.promptState}},actions:[{name:t.confirmButtonText||i.strings.columnNameSave,execute:t.onConfirmClick,isDefault:!0,isAvailable:t.promptState.isEnabled,icon:new m.default("Save"),automationId:"ColumnPropertyOK"},{name:i.strings.columnNameCancel,execute:function(){return p.default.wrap(3)},isAvailable:t.promptState.isEnabled,icon:new m.default("Cancel"),automationId:"ColumnPropertyCancel"}]}).wait().then(function(){return{resultType:h.ResultTypeEnum.Success}})};e.prototype.isColumnNameTaken=function(t,e){if(!e)return!1;t=t.toLocaleLowerCase();return e.some(function(e){return t===e.title.toLocaleLowerCase()})};e.prototype.isColumnStaticNameTaken=function(t,e){if(!e)return!1;t=t.toLocaleLowerCase();return e.some(function(e){return e.staticName&&t===e.staticName.toLocaleLowerCase()})};e.prototype.getAddToViewAction=function(e,t){var i;if(this.hasViewBeenModified())i={action:a.ModifyColumnAction,params:{action:1,fieldToActOn:e,fieldToAddAfter:t}};else{var r=this._currentView.peek(),o=r.getEffectiveFieldNames(),n=void 0;t&&(n=o.indexOf(t)+1);n=n||o.length;r.updateField(e,n);i={action:s.default,params:{skipDialog:!0}}}return i};e.prototype.getRemoveFromViewAction=function(e){var t;if(this.hasViewBeenModified())t={action:a.ModifyColumnAction,params:{action:0,fieldToActOn:e}};else{this._currentView.peek().updateField(e);t={action:s.default,params:{skipDialog:!0}}}return t};e.prototype.invalidateSchema=function(){this._listContext.listSchema=null;this._listContext.rawListSchema=null;this._listContext.needContentTypes=!0;this._itemProvider.invalidateItem(this._currentItem.peek().key,{triggerFetch:!0,emptyAllOtherSets:!0,refreshSchema:!0});this.invalidateInfoPaneCache()};e.prototype.invalidateInfoPaneCache=function(){this._listContext.refreshClientForm=!0};e.prototype.hasViewBeenModified=function(){if(this._currentView.peek().isDirty())return!0;var e=this._viewParams.peek();return Object.keys(e).some(function(e){return o.sortGroupKeyRegex.test(e)||o.filterKeyRegex.test(e)})};e.dependencies={currentView:c.currentView,viewParams:c.viewParams,dialogProvider:l.resourceKey,listProvider:n.resourceKey,listContext:u.listContext,currentItem:c.currentItem,itemProvider:d.resourceKey};return e}();t.default=g;t.resourceKey=new f.ResourceKey({name:e("module").id,factory:new f.ResolvedResourceFactory(g)})});define("Mg",["require","exports","Mj","b5","Mi","Mh"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-prompt",template:e("Mi"),viewModel:i.default,synchronous:!0});t.default=o});define("Mj",["require","exports","ap","bF","uA"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=e.state;t.text=i.text;t.isEnabled=i.isEnabled;t.explanation=i.explanation;t.status=i.status;t.checkbox=i.checkbox;t.hasFocus=t.createPureComputed(function(){return t.isEnabled()});t.inputFocused=t.createObservable(!1);t.subscribe(t.status,function(e){e.isError&&t.async.setTimeout(function(){return t.isEnabled(!0)},100);t._shouldClearError=e.isError});t.subscribe(t.text,function(){if(t._shouldClearError){t._shouldClearError=!1;t.status.peek().isError&&i.clearStatus()}});t.addBindingHandlers({selectOnFocus:o.default});return t}return e}(r.default);t.default=n});define("Mi",[],function(){return'<div class=od-Prompt><div class=od-TextField><label class=ms-Label for=Prompt-input data-bind="text: explanation"></label> <span class=od-Prompt-input><input class=od-TextField-field id=Prompt-input type=text maxlength=255 data-bind="textInput: text, enable: isEnabled, hasFocus: hasFocus, selectOnFocus, css: { \'od-Prompt-input--error\': status().isError }, automation: \'Prompt-input\'"></span></div><div class=od-Prompt-status aria-live=assertive role=status data-bind="text: status().message, css: { \'od-Prompt-status--error\': status().isError }"></div>\x3c!--ko if: checkbox--\x3e<div class=ms-CheckBox data-bind="with: checkbox"><label class=ms-CheckBox-field data-bind="css: { \'is-checked\': isChecked, \'is-disabled\': !isEnabled(), \'in-focus\': $parent.inputFocused() }"><input class=ms-CheckBox-input type=checkbox data-bind="checked: isChecked, enable: isEnabled, hasFocus: $parent.inputFocused"> <span class=ms-Label data-bind="text: label"></span></label></div>\x3c!--/ko--\x3e</div>'});define("Mh",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-Prompt-input{width:100%;display:block}.od-Prompt-status{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";word-wrap:break-word}.od-Prompt-status--error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-Prompt-input--error{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"!important}"}])});define("Mf",["require","exports","ap","g4","aC","aI","bX","iE"],function(e,t,r,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="ModifyColumn";t._action=e.action;t._fieldToActOn=e.fieldToActOn;t._fieldToAddAfter=e.fieldToAddAfter;t._listContext=t.resources.consume(s.listContext);t._currentView=t.resources.consume(a.currentView);return t}e.prototype.onExecute=function(e,t){switch(this._action){case 1:this._unhideColumn();break;case 0:this._hideColumn();break;case 2:case 3:this._moveField()}return o.default.wrap({resultType:n.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){var e=this._currentView();if(!e||!e.baseViewXml)return!1;if(2===this._action||3===this._action){var t=e.getEffectiveFieldNames();if(t&&t.length){var i=t.indexOf(this._fieldToActOn),r=this._listContext.isGrouped?1:0;return 2===this._action?r+1<i:r<=i&&i<t.length-1}return!1}return!0};e.prototype._moveField=function(){var e,t=this._currentView.peek(),i=t.getEffectiveFieldNames().indexOf(this._fieldToActOn);e=2===this._action?i-1:i+1;t.updateField(this._fieldToActOn,e);this._currentView.valueHasMutated()};e.prototype._hideColumn=function(){this._currentView.peek().updateField(this._fieldToActOn);this._currentView.valueHasMutated()};e.prototype._unhideColumn=function(){var e=this._currentView.peek(),t=e.getEffectiveFieldNames(),i=t.indexOf(this._fieldToAddAfter);-1===i?e.updateField(this._fieldToActOn,t.length):e.updateField(this._fieldToActOn,i+1);this._currentView.valueHasMutated()};return e}(i.default);t.ModifyColumnAction=l;t.default=l});define("Md",["require","exports","ap","g4","dm","Mg","Me","dH","ci","eX","k9","bX","iE","dI","V","aC","aI"],function(e,t,r,i,o,d,c,n,a,s,l,u,p,m,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=o.strings,v=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="SaveView";t._skipDialog=e.skipDialog;t._viewParams=t.resources.consume(u.viewParams);t._currentView=t.resources.consume(u.currentView);t._currentItem=t.resources.consume(u.currentItem);t._dialogProvider=t.resources.consume(a.resourceKey);t._itemProvider=t.resources.consume(s.resourceKey);t._listProvider=t.resources.consume(l.resourceKey);t._listContext=t.resources.consume(p.listContext);return t}e.prototype.onExecute=function(r,e){var o=this;delete this._result;delete this._switchTo;var t,n,i=this._currentView.peek();if(!i)return f.default.wrap({resultType:g.ResultTypeEnum.Failure});if(this._skipDialog){t=this._doSaveView(i.title,!1);n={resultType:g.ResultTypeEnum.Failure}}else{this._viewsPromise=this._listProvider.getViews(!0);var a,s,l=this.observables.create(!1);if(this._listContext.permissions&&this._listContext.permissions.manageLists){a=this.observables.create(i.title||"");s=this.observables.create(!i.isPersonal);this.subscribe(a,function(e){if(e===i.title){l(!1);s(!i.isPersonal)}else l(!0)})}else{s=this.observables.create(!1);a=this.observables.create(i.isPersonal&&i.title||"")}i.isReadOnly&&a("");this._promptState=new c.default({text:a,explanation:y.SaveViewExplanation,checkbox:{label:y.SaveViewMakePublic,isChecked:s,isEnabled:l}});t=this._dialogProvider.requestDialog({title:y.SaveAs,component:{name:d.default.tagName,params:{state:this._promptState}},actions:[{name:y.SaveViewCommit,execute:this._saveViewFromDialog.bind(this),isDefault:!0,isAvailable:this.createPureComputed(function(){return o._promptState.isEnabled()&&!!a()}),icon:new m.default("Save"),automationId:"saveViewDialogCommit"},{name:y.cancelActionText,execute:function(){return f.default.wrap(3)},isAvailable:this._promptState.isEnabled,icon:new m.default("Cancel"),automationId:"saveViewDialogCancel"}]}).wait();n={resultType:g.ResultTypeEnum.ExpectedFailure}}return t.then(function(){var e=o._result||n;if(e.resultType===g.ResultTypeEnum.Success){o._itemProvider.invalidateItem(o._currentItem.peek().key,{triggerFetch:!1,emptyAllOtherSets:!0});var t=o.resources.consume(u.actionMap),i=function(){o._listContext.listSchema=null;o._listContext.needContentTypes=!0;o._itemProvider.invalidateItem(o._currentItem.peek().key,{triggerFetch:!0,emptyAllOtherSets:!0,refreshSchema:!0});return e};return new(o.managed(t.SwitchViewAction))({newView:o._switchTo}).execute(r).then(i,i)}return e})};e.prototype.onIsAvailable=function(){var e=this._currentItem(),t=this._currentView(),i=this._listContext&&this._listContext.permissions,r=this._viewParams();return t&&134217728!==t.viewType&&e&&e.queryType===n.default.Files&&i&&(i.managePersonalViews||i.manageLists)&&!r.needsAttentionView};e.prototype._saveViewFromDialog=function(){var t=this,i=this._promptState.text.peek(),r=i!==this._currentView.peek().title;if(r){i=i.trim();this._promptState.text(i);if(!i){this._promptState.setErrorStatus(y.SaveViewErrorNoName);return f.default.wrap(1)}}this._promptState.isEnabled(!1);return this._isViewNameValid(i,r).then(function(e){if(e)return t._doSaveView(i,r);t._promptState.setErrorStatus(h.format(y.SaveViewErrorCannotOverwrite,i));return f.default.wrap(1)})};e.prototype._isViewNameValid=function(i,e){var r=this,t=this._currentView.peek();return e?new f.default(function(t){r._viewsPromise.done(function(e){t(!e.some(function(e){return e.title===i}))},function(){t(!0)})}):i!==t.title||t.canUserEdit(this._listContext&&this._listContext.permissions)&&!t.isReadOnly?f.default.wrap(!0):f.default.wrap(!1)};e.prototype._doSaveView=function(e,t){var i=this,r=this._currentView.peek(),o=this._viewParams.peek();if(t){var n={title:e,viewParams:o,sourceView:r,isPublic:this._promptState?this._promptState.checkbox.isChecked.peek():!r.isPersonal};return this._listProvider.createView(n).then(function(e){return i._onComplete(e)},function(e){return i._onError("CreatingView",e)})}n={sourceView:r,viewParams:o,updateViewXml:!0};return this._listProvider.saveView(n).then(function(){return i._onComplete(r)},function(e){return i._onError("SavingView",e)})};e.prototype._onComplete=function(e){this._switchTo=e;this._result={resultType:g.ResultTypeEnum.Success};return 2};e.prototype._onError=function(e,t){this._promptState&&this._promptState.setErrorStatus(y.SaveViewError);this._result={resultType:g.ResultTypeEnum.Failure,resultCode:e,error:t};return 1};return e}(i.default);t.SaveViewAction=v;t.default=v});define("Me",["require","exports","aq"],function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){void 0===e&&(e={});var t=e.text,i=void 0===t?l.observable(""):t,r=e.explanation,o=void 0===r?"":r,n=e.status,a=void 0===n?l.observable({message:"",isError:!1}):n,s=e.checkbox;this.text=i;this.explanation=o;this.status=a;this.checkbox=s;this.isEnabled=l.observable(!0)}e.prototype.setWaitingStatus=function(e){this.status({message:e,isError:!1});this.isEnabled(!1)};e.prototype.setErrorStatus=function(e){this.status({message:e,isError:!0})};e.prototype.clearStatus=function(){this.status({message:"",isError:!1})};return e}();t.PromptState=i;t.default=i});define("L2",["require","exports","L5","b5","L4","L3","zk"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-inpageeditor",template:e("L4"),viewModel:i.default});t.default=o});define("L5",["require","exports","ap","bF","aq","L6"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.isOpen=o.observable(!0);t.isLoading=o.observable(!0);t.onClose=e.onClose;t.iframeLoaderParams={url:e.inPageEditorUrl,showLoadingLabel:!0,onload:t.iframeOnLoad.bind(t),isLoading:t.isLoading,isInFullPage:!0};return t}e.prototype.iframeOnLoad=function(e){var t=e.target;if(t&&t.contentWindow){this._setupIframeElementFunctions(t);this.isLoading(!1)}};e.prototype._setupIframeElementFunctions=function(e){var t=this;e.cancelPopUp=function(){t.isOpen(!1)}};return e}(i.default);t.default=n});define("L6",["require","exports","L9","b5","L8","L7","pP"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-listfocus-editorhost",template:e("L8"),viewModel:i.default,synchronous:!0});t.default=o});define("L9",["require","exports","ap","aq","qS","cA","Ma","bF","qe","b3"],function(e,t,i,o,n,a,s,r,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(t){var e=r.call(this,t)||this;e.isOpen=t.isOpen||o.observable(!0);e.size=t.size||o.observable({width:0,height:0});var i=t.commandSet?t.commandSet:new(e.managed(s.default))({isOpen:t.isOpen});e.commandBarSpecification=d.toSpecification(l.resourceKey,{commandSet:i,isMobile:!1});e.addBindingHandlers({clientRect:n.default,host:a.default,control:d.default});e.isOpen.subscribe(function(e){!e&&t.onClose&&t.onClose()});return e}return e}(r.default);t.default=c});define("Ma",["require","exports","ap","bN","rs","dI","aq"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;e.isOpen&&(t.commands=a.observableArray([new(t.managed(o.CommandViewModel))({icon:new n.default("Cancel"),callback:function(){e.isOpen(!1)},keys:["Esc"],location:12})]));return t}return e}(i.default);t.default=s});define("L8",[],function(){return'\x3c!--ko if: isOpen--\x3e<div data-bind="component: { name: \'od-one-up-overlay\' }"><div class="od-ListFocusEditorHost-container od-theme--darkTransparent" data-bind="clientRect: { size: size }">\x3c!--ko if: commandSet--\x3e<div class=od-ListFocusEditorHost-commandBar data-bind="control: commandBarSpecification"></div>\x3c!--/ko--\x3e\x3c!--ko host: {}--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e'});define("L7",["c","az"],function(e,t){e.loadStyles([{rawString:".od-ListFocusEditorHost-container{height:100%;width:100%;position:absolute;background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-ListFocusEditorHost-commandBar{visibility:inherit;opacity:1;position:absolute;left:0;right:0;top:0;z-index:2;padding:0 8px;height:40px;transition:visibility 0s linear 267ms,opacity 267ms linear,top 267ms linear;background-color:rgba(0,0,0,.7)}.od-ListFocusEditorHost-commandBar .CommandBar{height:40px}[dir=ltr] .od-ListFocusEditorHost-commandBar .CommandBar-sideArea .CommandBarItem:last-child{margin-right:0}[dir=rtl] .od-ListFocusEditorHost-commandBar .CommandBar-sideArea .CommandBarItem:last-child{margin-left:0}"}])});define("L4",[],function(){return"<div data-bind=\"component: { name: 'od-listfocus-editorhost' , params: { isOpen: isOpen, onClose: onClose } }\"><div class=od-InPageEditor-iframe>\x3c!--ko component: { name: 'ms-iframe-loader', params: iframeLoaderParams }--\x3e\x3c!--/ko--\x3e</div></div>"});define("L3",["c","az"],function(e,t){e.loadStyles([{rawString:".od-InPageEditor-iframe{position:absolute;top:10%;left:10%;height:80%;width:80%}"}])});define("zk",["require","exports","zn","b5","zm","zl"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-iframe-loader",template:e("zm"),viewModel:i.default,synchronous:!0});t.default=o});define("zn",["require","exports","ap","bF","aq","d0","zp","bW","zo"],function(e,t,i,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(i){var r=o.call(this)||this;r.loadingLabel=s.strings.IframeLoadingLabel;r._isIframeAvailable=!0;var e=i.url,t=i.title||"";r.url="string"==typeof e?n.observable(e):e;r.title="string"==typeof t?n.observable(t):t;r.isExcludeFromScreenReader=i.isExcludeFromScreenReader||!1;r.isLoading=i.isLoading?i.isLoading:n.observable(!0);r.loadingLabelHasMargins=i.loadingLabelHasMargins;r.progressSpinnerFlatTagName=a.default.tagName;r.showLoadingLabel=i.showLoadingLabel;r.iframeElement=i.iframeElement||n.observable(null);r.tabindex=r.isExcludeFromScreenReader?"-1":null;r.role=r.isExcludeFromScreenReader?"presentation":null;r.isVisible=r.createComputed(r._computeIsVisible);r.isTitleVisible=r.createComputed(r._computeIsTitleVisible);r.addBindingHandlers({element:l.default});r.iframeOnLoad=function(e,t){r._isIframeAvailable&&i.onload&&i.onload(t);r.isLoading(!1)};r.addDisposable({dispose:function(){d.disposeIframe(r.iframeElement(),function(){r._isIframeAvailable=!1})}});return r}e.prototype._computeIsVisible=function(){return!!this.url()};e.prototype._computeIsTitleVisible=function(){return!!this.title()};return e}(r.default);t.default=o});define("zo",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.disposeIframe=function(e,t){if(e){e.src="";t&&t()}}});define("zm",[],function(){return"<div class=ms-IframeLoader data-bind=\"css:{ 'ms-IframeLoader--visible': isVisible }\"><div class=ms-IframeLoader-title data-bind=\"css:{ 'ms-IframeLoader-title--visible': isTitleVisible }, text: title()\"></div><iframe class=ms-IframeLoader-iframe data-bind=\"attr: { src: url(), role: role, tabindex: tabindex }, event: { load: iframeOnLoad }, css: { 'ms-IframeLoader-iframe--visible': !isLoading() }, element: iframeElement\"></iframe>\x3c!--ko if: showLoadingLabel--\x3e<span class=ms-IframeLoader-loadingLabel data-bind=\"text: loadingLabel, css: { 'ms-IframeLoader-loadingLabel--visible': isLoading, 'ms-IFrameLoader-LoadingWithMargin': loadingLabelHasMargins }\"></span>\x3c!--/ko--\x3e<div class=ms-IframeLoader-progressContainer data-bind=\"css: { 'ms-IframeLoader-progressContainer--visible': isLoading }\"><div class=ms-IframeLoader-progress data-bind=\"component: { name: progressSpinnerFlatTagName }\"></div></div></div>"});define("zl",["c","az"],function(e,t){e.loadStyles([{rawString:'.ms-IframeLoader{display:none;width:100%;height:100%}.ms-IframeLoader-loadingLabel{padding-bottom:15px;margin:0 0 20px 0;font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";display:none}.ms-IframeLoader-loadingLabel.od-Dialog-subText--s{font-size:12px}.ms-IframeLoader-loadingLabel.od-Dialog-subText--m{font-size:14px}.ms-IframeLoader-loadingLabel.od-Dialog-subText--l{font-size:17px}.ms-IFrameLoader-LoadingWithMargin.ms-IframeLoader-loadingLabel{margin:15px 15px 15px 30px}.ms-IframeLoader-title{font-size:17px;display:none}.ms-IframeLoader-iframe{width:100%;height:100%;border:none;display:none}.ms-IframeLoader-progressContainer{display:none}.ms-IframeLoader--visible,.ms-IframeLoader-iframe--visible,.ms-IframeLoader-loadingLabel--visible,.ms-IframeLoader-progressContainer--visible,.ms-IframeLoader-title--visible{display:block}"}])});define("L0",["require","exports","ap","aC","aI","dc","dH","dm","cY","iE","dJ","nH","kz","dZ","fO","ci","b3","kG","i9"],function(e,t,i,a,s,o,n,l,d,c,u,p,r,m,h,f,g,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="Alert";t.isSingleSelectAction=!0;t.canFallbackToParent=!0;var i=e.manageAlerts;t._pageContext=t.resources.consume(c.pageContext);t._manageAlerts=i;t._navigation=t.resources.consume(o.navigation);t._inplaceEditorUrl=t.resources.consume(c.inplaceEditorUrl.optional);t._itemUrlHelper=t.resources.consume(h.resourceKey);t._folderDataSource=t.resources.consume(m.folder.optional);t._itemCommandHelper=t.resources.consume(y.resourceKey);return t}e.prototype.onSelectionExecute=function(e,t,i){var r=this,o=e[0];if(!this._manageAlerts){if(o.isRootFolder||!this._folderDataSource||o.properties.ID){var n=o.isRootFolder?this.getAlertUrl():this.getItemAlertUrl(o.properties.ID);return this._LaunchAlertDialog(n)}this._folderDataSource.getFolderItemId(o).then(function(e){return r._LaunchAlertDialog(r.getItemAlertUrl(e))});return a.default.wrap({resultType:s.ResultTypeEnum.Success})}this._navigation.navigateTo({url:this.getManageAlertUrl(),frameId:"_blank"})};e.prototype.onSelectionIsAvailable=function(e,t){if(!this._itemCommandHelper.isCommandSupported(t,v.alertItem))return!1;var i=this.getParent(t,"list"),r=this.unwrapObservable(this._inplaceEditorUrl);return t.queryType===n.default.Files&&!r&&!!i&&d.PermissionMask.hasItemPermission(t,d.PermissionMask.createAlerts)};e.prototype.getAlertUrl=function(){var e=this.getParent(this.item.peek(),"list",!0);return this._pageContext.webAbsoluteUrl+"/"+this._pageContext.layoutsUrl+"/SubNew.aspx?"+u.serializeQuery({List:e.list.id,IsDlg:1})};e.prototype.getManageAlertUrl=function(){return this._pageContext.webAbsoluteUrl+"/"+this._pageContext.layoutsUrl+"/mysubs.aspx"};e.prototype.getItemAlertUrl=function(e){var t=this.getParent(this.item.peek(),"list",!0),i=this._itemUrlHelper.getItemUrlParts(t.key);return this._pageContext.webAbsoluteUrl+"/"+this._pageContext.layoutsUrl+"/SubNew.aspx?"+u.serializeQuery({List:t.list.id,ID:e,Source:i.normalizedItemUrl,IsDlg:1})};e.prototype._LaunchAlertDialog=function(e){return this.resources.consume(f.resourceKey).requestDialog({title:l.strings.AlertMe,size:"XLarge",control:g.toSpecification(p.default,{componentUrl:e,showInDialog:!0,heightOffset:.75,forceSharePointScrollbar:!0}),actions:[]}).wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})};return e}(r.default);t.default=_});define("LZ",["require","exports","ap","g4","kp","dZ","dH","bX","yk"],function(e,t,i,r,s,l,o,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){i.__extends(e,a);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=a.call(this,e,t)||this;i._urlDataSource=i.resources.consume(l.url);i._suiteNavProvider=i.resources.consume(c.resourceKey);var r=t.ItemSelectionHelper,o=void 0===r?s.default:r;i._itemSelectionHelper=new(i.managed(o))({canFallback:!0,allowMultiSelect:!1});i._sitesNavUrl=i.createObservable();i._url=i.createPureComputed(i._computeUrl);var n=i.resources.consume(d.actionMap);i._navigationAction=new(i.managed(n.NavigationAction))({url:i._url,target:"_blank"});i.createBackgroundComputed(i._computeLoadSitesNavUrl);return i}e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&(this._urlDataSource.isCurrentQuery(o.default.Subsites,this._urlDataSource.getKeyParams(e.key))&&this._navigationAction.isAvailable())};e.prototype.onExecute=function(e){return this._navigationAction.execute(e)};e.prototype._computeLoadSitesNavUrl=function(){var t=this;this.trackPromise(this._getSitesNavUrl()).done(function(e){t._sitesNavUrl(e)})};e.prototype._computeUrl=function(){return this._sitesNavUrl()||""};e.prototype._getSitesNavUrl=function(){return this._suiteNavProvider.loadData().then(function(e){return(e.WorkloadLinks||[]).filter(function(e){return"ShellSites"===e.Id}).map(function(e){return e.Url})[0]})};return e}(r.default);t.default=n});define("yk",["require","exports","bE","a3","a2","bA","ym","is","dZ","ba","aA","aC","b6","a0","aI","gm","yl"],function(e,t,o,u,p,i,n,a,r,m,h,f,s,g,y,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=5,v=12,_="Data",b="CacheDate",x="CacheVersion",S="CachedThisSession",C=new u.default("odSuiteNav",p.default.local),P=function(){function e(e,t){this._dataSource=t.dataSource;this._capabilities=this._dataSource.getCapabilities();this._cssLoaded=!1}e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.clearCachedPromise=function(){this._modelPromise=void 0};e.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})};e.prototype.getO365Shell=function(){if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var e=this._shellSignal;if(!e){e=new o.default;var t=new y.Qos({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(e);e.getPromise().then(function(){t.end({resultType:y.ResultTypeEnum.Success})},function(e){t.end(E({error:e}))});this._shellSignal=e}return e.getPromise()};e.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o&&o.Id===a.default.MAIL)return o.Url}})};e.prototype._getSuiteNavShell=function(r,o){var n=this;this._loadModel().then(function(e){if(!n._cssLoaded&&e.cssUrl){s.default.loadStylesheet(e.cssUrl);n._dataSource.onCssLoad&&n._dataSource.onCssLoad(e);n._cssLoaded=!0}var t=e.requireConfig,i=t&&t.paths;o&&i&&(i.shellcore+=".js?odb_cb="+(new Date).toISOString());l.default.addConfig(e.requireConfig);n._requestShellCore().then(function(e){r.complete(e)},function(e){if((e=E({error:e}))&&"RequireError"===e.resultCode&&n._isDataFromCache){g.Engagement.logData({name:"SuiteNavProvider.O365ShellCacheFailed"});n._getSuiteNavShell(r)}else if(n._hasRetriedShell)r.error(e);else{n._hasRetriedShell=!0;n._cssLoaded=!1;g.Engagement.logData({name:"SuiteNavProvider.O365ShellRetry"});n._getSuiteNavShell(r,!0)}})})};e.prototype._requestShellCore=function(){var t=this,i=new o.default,r=requirejs.toUrl("shellcore");window.require(["shellcore"],function(){!function(){var e=window._o365su;if(!e||!e.b)return;for(var t=0,i=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<i.length;t++){var r=i[t];w(e.b,r)}}();var e=new n.default;e.Exists()?i.complete(e):i.error(E({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:r}}))},function(e){t._capabilities.supportsCaching&&k();requirejs.undef("shellcore");t._modelPromise=void 0;i.error(E({error:e,resultCode:"RequireError",extraData:{shellUrl:r}}))});return i.getPromise()};e.prototype._loadModel=function(n){var a=this;if(!n&&this._modelPromise)return this._modelPromise;var s,e,l=this._capabilities.supportsCaching,d=this._dataSource,c=y.ResultTypeEnum.Failure,t=y.Qos.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new f.default(function(t,i){var e,r,o;!n&&l&&a._isCacheValid()&&(e=C.getValue(_));if(e&&e.data){g.Engagement.logData({name:"SuiteNavProvider.DataFromCache"});d.updateDataForCurrentPage&&d.updateDataForCurrentPage(e.data);if(l&&(r=C.getValue(S,p.default.session),o=Date.parse(C.getValue(b)),u.default.hasStorageType(p.default.session)&&!r||Date.now()-o>=60*v*60*1e3)){g.Engagement.logData({name:"SuiteNavProvider.RefreshCache"});d.loadData().done(T)}a._isDataFromCache=!0;t(e)}else{a._isDataFromCache=!1;n&&g.Engagement.logData({name:"SuiteNavProvider.ForceUpdateData"});g.Engagement.logData({name:"SuiteNavProvider.DataFromServer"});d.loadData().done(function(e){if(e)if(e.data){l&&!I(e)&&T(e);t(e)}else{s="NoModelData";i("Model with no data returned")}else{s="NoModel";i("No model returned")}},function(e){if(f.default.isCanceled(i)){s="Canceled";c=y.ResultTypeEnum.ExpectedFailure}else s="ServerLoadFailure";i(e)})}})},null,function(e){if(f.default.isCanceled(e)){c=y.ResultTypeEnum.ExpectedFailure;s="Canceled"}return{resultType:c,resultCode:s||"Other",error:e}});(e=h.getThemeProvider(h.defaultThemeFactoryProvider))?this._modelPromise=f.default.all({suiteNavModel:t,theme:e.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,i=e.theme,r=t&&t.data,o=t&&t.hasCobranding,n=r&&r.UseSPOBehaviors,a=m.isFeatureEnabled(m.SuiteNavPrefersTenantTheme),s=i&&i.suiteBarBackground;!(s&&r&&n)||o&&a||(r.ThemeColors=[s,i.primaryText,s,i.suiteBarText,i.suiteBarDisabledText,i.topBarBackground,i.topBarText,i.topBarHoverText,i.primaryBackground,i.themeLighterAlt,i.dialogBorder]);return t}):this._modelPromise=t;return this._modelPromise};e.prototype._isCacheValid=function(){var e=C.getValue(_),t=C.getValue(x),i=Date.parse(C.getValue(b)),r=this._capabilities.supportsRealSuiteNav,o=this._dataSource,n=e&&e.data&&(!r||e.requireConfig)&&t===c&&e.userIdentifier===o.getUserIdentifier()&&e.cacheToken===o.getCacheToken()&&!isNaN(i)&&Date.now()-i<864e5;if(!n){var a={model:!!e,"model.data":e&&!!e.data,"model.requireConfig":e&&!!e.requireConfig,supportsRealSuiteNav:r,oldVersion:t,CACHE_VERSION:c,userIsIdentical:e&&e.userIdentifier===o.getUserIdentifier(),cacheToken:e&&e.cacheToken,dataSourceCacheToken:o.getCacheToken(),cacheDate:!isNaN(i),expired:864e5<=Date.now()-i};g.Engagement.logData({name:"SuiteNavCacheDataInvalid",extraData:a})}return n};return e}();t.default=P;t.resourceKey=i.createResolvedResourceKey(e("module").id,P,{dataSource:r.suiteNav});function k(){C.remove(_);C.remove(b);C.remove(x);C.remove(S,p.default.session)}t.clearCache=k;function I(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})}t.isProvisioning=I;function T(e){C.setValue(_,e);C.setValue(b,new Date);C.setValue(x,c);C.setValue(S,!0,p.default.session)}function w(e,i){var r=e[i];"function"==typeof r&&(e[i]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return r.apply(this,e)}catch(e){d.default.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:i})}})}function E(e){var t=e.error;if(t&&t.resultCode)return t;var i=y.ResultTypeEnum.Failure;if(f.default.isCanceled(t)){i=y.ResultTypeEnum.ExpectedFailure;e.resultCode="Canceled"}return{resultType:i,resultCode:e.resultCode||"Other",error:t,extraData:e.extraData}}});define("ym",["require","exports","yo","yn","bE"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.FlexPane=new i.default;this.Navigation=new r.default;this._PostRenderSignal=new o.default}e.prototype.SetData=function(e){O365Shell.SetData(e)};e.prototype.Render=function(e,t){var i=this;O365Shell.Render(e,function(){return i._SignalAction(t)})};e.prototype.RenderAsync=function(e,t,i){var r=this;O365Shell.RenderAsync(e,function(){return r._SignalAction(t)},function(){return r._SignalAction(i)})};e.prototype.OnDataChanged=function(e){return O365Shell.OnDataChanged(e)};e.prototype.OnSuiteAPILoaded=function(e){return O365Shell.OnSuiteAPILoaded(e)};e.prototype.LoadShellPlus=function(){O365Shell.LoadShellPlus()};e.prototype.Exists=function(){return"undefined"!=typeof O365Shell};e.prototype.HasMember=function(e){return this.Exists()&&!!O365Shell[e]};e.prototype.OnHasMember=function(e,t){var i=this;this.HasMember(e)?t():this._PostRenderSignal.getPromise().done(function(){return i.OnHasMember(e,t)})};e.prototype._SignalAction=function(e){e();var t=this._PostRenderSignal;this._PostRenderSignal=new o.default;t.complete()};return e}();t.default=n});define("yo",["require","exports","aN"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.prototype.OnFlexPaneVisibilityChanged=function(e){try{return O365Shell.FlexPane.OnFlexPaneVisibilityChanged(e)}catch(e){i.default.log(e,"FlexPaneWrapper","OnFlexPaneVisibilityChanged")}};e.prototype.OpenFlexPaneForProvider=function(e){try{O365Shell.FlexPane.OpenFlexPaneForProvider(e)}catch(e){i.default.log(e,"FlexPaneWrapper","OpenFlexPaneForProvider")}};e.prototype.CloseFlexPaneForProvider=function(e){try{O365Shell.FlexPane.CloseFlexPaneForProvider(e)}catch(e){i.default.log(e,"FlexPaneWrapper","CloseFlexPaneForProvider")}};return e}();t.default=r});define("yn",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.prototype.OnLinkClick=function(e){return O365Shell.Navigation.OnLinkClick(e)};e.prototype.OnHamburgerButtonClick=function(e){return O365Shell.Navigation.OnHamburgerButtonClick(e)};return e}();t.default=i});define("yl",["require","exports","aR"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SuiteNavError=i.createSingleEvent({eventName:"SuiteNavError,",shortEventName:"SuiteNavError",requiresParent:!1},{message:1,stack:1,type:1});t.default=t.SuiteNavError});define("LX",["require","exports","ap","kx","kU","dZ","bX","iE","dH","ej","cY","MM","aL","ey","eA","LY"],function(e,t,i,r,l,m,h,d,o,f,n,g,c,y,u,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this;t.name="ContentTypeNavigation";var i=e.url,r=e.appMap,o=e.contentTypeId,n=e.openInClient;t._viewParams=t.resources.consume(h.viewParams);t._urlDataSource=t.resources.consume(m.url);t._pageContext=t.resources.consume(d.pageContext);t._itemParentHelper=t.resources.consume(u.resourceKey);t._appMap=r;t._contentTypeId=o;t._url=t.wrapObservable(i);t._openInClient=n;var a=c.extend(c.extend({},e),{url:t._url,target:"_blank"});t._actionMap=t.resources.consume(h.actionMap);t._navigationAction=new(t.managed(l.default))(a);return t}e.prototype.onExecute=function(e,t){var i=this,r=this.item.peek(),o=this.getParent(r,"list",!0);this._adjustUrlForCurrentRootFolder();var n=new f.default(this._url.peek()),a=this._url.peek(),s=n.getQueryParameter("id"),l=function(){i._createDocumentAction=new(i.managed(g.default))({docType:v.GetDocumentTypeFromExtension(s),templateUrl:s});return i._createDocumentAction.execute(e)};if(!s){var d=n.getPath();if(o.list.templateType===y.default.xmlFormLibrary&&d&&".xml"===d.substring(d.length-4)){this._openInClient=!0;this._appMap="infopath";"/"===(s=a)[0]&&(s=this._pageContext.webAbsoluteUrl+s)}else"wopiframe.aspx"===n.getLastPathSegment().toLowerCase()?s=n.getQueryParameter("sourcedoc"):this._openInClient&&(s=a)}if(s){"/"!==s[0]&&((n=new f.default(s)).getAuthority()||(s=this._pageContext.webAbsoluteUrl+"/"+s));if(o.list.openInClient||this._openInClient){var c=this.resources.consume(h.actionMap),u=this._itemParentHelper.getAncestorOrSelf(r,function(e){return"boolean"==typeof e.newWOPIDocumentEnabled}),p=!!u&&u.peek().newWOPIDocumentEnabled;return new(this.managed(c.OpenInOfficeClientAction))({retryWithWac:"infopath"!==this._appMap,callback:p?void 0:l,url:s,appMap:this._appMap}).execute(e)}return l()}if(this._contentTypeId){a=this.resources.consume(m.url).getNewFormUrl(this._contentTypeId)}return new(this.managed(this._actionMap.LaunchListFormAction))({item:this.item.peek(),type:2,contentTypeId:this._contentTypeId,url:a}).execute(e)};e.prototype.onIsAvailable=function(){var e=this._viewParams(),t=this.item(),i=this.getParent(t,"list");return!!this._url.peek()&&!!i&&this._urlDataSource.getQueryType(e)===o.default.Files&&this._navigationAction.isAvailable()&&n.PermissionMask.hasItemPermission(t,n.PermissionMask.insertListItems)};e.prototype._adjustUrlForCurrentRootFolder=function(){var e=this.item.peek(),t=new f.default(this._url.peek()),i=this._urlDataSource.getKeyParams(e.key).id;t.setQueryParameter("RootFolder",i);this._url(t.toString())};return e}(r.default);t.default=a});define("LW",["require","exports","ap","aC","dZ","Lm","dH","g9","i9"],function(i,e,t,r,s,o,n,l,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(a){t.__extends(e,a);function e(e){void 0===e&&(e={});var t=a.call(this,e)||this,i=e.sharingMethod,r=void 0===i?null:i,o=e.alreadyRedeemed,n=void 0===o?null:o;t.sharingMethod=r;t._alreadyRedeemed=n;t.name="ShareByLink";t._sharingDataSourceHelper=new(t.managed(l.default));t._urlDataSource=t.resources.consume(s.url);return t}e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();if(!this.itemCommandHelper.isCommandSupported(e,d.share))return!1;var t=e&&!!this._sharingDataSourceHelper.getParentListId(e);return a.prototype.onIsAvailable.call(this)&&e&&!this._urlDataSource.isRecycleBin(e.queryType)&&!e.isRootFolder&&e.queryType!==n.default.Discover&&!e.list&&t};e.prototype.getExecutorPath=function(){return"acu"};e.prototype.getModuleFactory=function(){return function(){return new r.default(function(e,t){i(["acu"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,alreadyRedeemed:this._alreadyRedeemed,sharingMethod:this.sharingMethod}};return e}(o.default);e.default=a});define("LV",["require","exports","ap","g4","aC","kp","jG","bX","iG","aI","bT","dH"],function(e,t,i,r,o,d,c,u,p,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(l){i.__extends(e,l);function e(e){void 0===e&&(e={});var t=l.call(this,e)||this;t.name="ShowProperties";var i=e.useToggleBehavior,r=void 0!==i&&i,o=e.isSharingSectionExpanded,n=void 0!==o&&o,a=e.allowMultiSelect,s=void 0!==a&&a;t._isInfoPaneExpanded=t.resources.consume(c.base.infoPane.isInfoPaneExpanded);t._isSharingSectionExpanded=t.resources.consume(u.isSharingSectionExpanded.optional);t._isInfoPaneAvailable=t.resources.consume(c.base.infoPane.isInfoPaneAvailable.optional)||t.observables.create(!0);t._isFiltersPaneExpanded=t.resources.consume(c.base.filtersPane.isFiltersPaneExpanded.optional);t._isColumnCustomizationPaneExpanded=t.resources.consume(c.base.columnCustomizationPane.isColumnCustomizationPaneExpanded.optional);t._rumOneHelper=t.resources.consume(p.rumOneHelper.optional);t._useToggleBehavior=r;t._allowMultiSelect=s;t._shouldExpandSharingSection=n;t._itemSelectionHelper=new(t.child(d.default))({allowMultiSelect:t._allowMultiSelect,canFallback:!0,useCurrentSelectionGroup:!0});return t}e.prototype.onExecute=function(e){if(!this.isToggled.peek()){this._rumOneHelper&&this._rumOneHelper.logPropertiesPaneLaunch();this._isFiltersPaneExpanded&&this._isFiltersPaneExpanded(!1);this._isColumnCustomizationPaneExpanded&&this._isColumnCustomizationPaneExpanded(!1)}this._isSharingSectionExpanded&&this._isSharingSectionExpanded(this._shouldExpandSharingSection);this._isInfoPaneExpanded(!this._useToggleBehavior||!this._isInfoPaneExpanded.peek());a.default.raise(document.body,"resize",void 0,!0);return o.default.wrap({resultType:n.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){if(!this._isInfoPaneAvailable())return!1;var e=this._itemSelectionHelper.firstItem;if(!e())return!1;var t=[e];this._allowMultiSelect&&(t=this._itemSelectionHelper.selection());for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o){var n=o();if(n&&(n.error||n.isPlaceholder&&n.queryType!==s.default.Search))return!1}}return!0};e.prototype.onIsToggled=function(){return this._isInfoPaneExpanded()};return e}(r.default);t.default=l});define("LU",["require","exports","ap","kz","aC","aI","dZ","a9","jN"],function(e,t,r,i,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="ShowSelection";t._urlDataSource=t.resources.consume(a.url);t._isSelectionModal=t.resources.consume(l.isSelectionModalResourceKey);return t}e.prototype.onIsAvailable=function(){return(0<this.selectionModel.selection().length||this._isSelectionModal())&&this._urlDataSource.getPageType()!==s.default.TextFileEditor};e.prototype.onExecute=function(e,t){this.selectionModel.clear();this._isSelectionModal(!1);return o.default.wrap({resultType:n.ResultTypeEnum.Success})};return e}(i.default);t.default=d});define("LT",["require","exports","ap","bN","kt","bX","dH","gN","dZ","bA","aq","g4","aC","ba","d7"],function(i,r,o,e,t,n,a,s,l,d,c,u,p,m,h){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.isFilterPaneOpenResourceKey=new d.ResourceKey({name:i("module").id+".isFilterPaneVisible",factory:{dependencies:{},create:function(){return{instance:c.observable(!1)}}}});var f=function(i){o.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._bundleLoader=t.resources.consume(h.bundleLoader);t.state=t.createPureComputed(t._computeState);t._urlDataSource=t.resources.consume(l.url);t._currentItem=t.resources.consume(n.currentItem);return t}e.prototype._computeState=function(){return{isAvailable:this._computeAvailability()}};e.prototype._computeAvailability=function(){var e=s.default.getKeyParams(this._currentItem().key);return this._bundleLoader.getBundleInfo(1).isLoaded()&&(m.isFeatureEnabled(m.FiltersInODB)&&this._urlDataSource.isCurrentQuery(a.default.Search,e)||m.isFeatureEnabled(m.ODBVroomSharedWithMe)&&this._urlDataSource.isCurrentQuery(a.default.SharedWithMe,e))};return e}(e.default);r.ShowFiltersHandler=f;var g=t.create({name:"ShowFilters",source:{moduleDefinition:{path:"adg",getModule:function(){return new p.default(function(e,t){i(["adg"],e,t)})}}},handlerType:f}),y=function(t){o.__extends(e,t);function e(){var e=t.call(this)||this;e._action=new(e.managed(g));e._isFiltersPaneVisible=e.resources.consume(r.isFilterPaneOpenResourceKey);return e}e.prototype.onIsAvailable=function(){return this._action.isAvailable()};e.prototype.onIsToggled=function(){return this._isFiltersPaneVisible()};e.prototype.onExecute=function(){if(this._isFiltersPaneVisible.peek()){this._isFiltersPaneVisible(!1);return p.default.wrap(null)}this._isFiltersPaneVisible(!0);return this._action.execute(null)};return e}(u.default);r.default=y});define("LP",["require","exports","ap","LQ","cY","ey","ba"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.skipInvalidation=!1;return t}e.prototype.onIsAvailable=function(){var e=this.item(),t=this.getParent(e,"list");return i.prototype.onIsAvailable.call(this)&&o.PermissionMask.hasItemPermission(e,o.PermissionMask.insertListItems)&&!!t&&(!t.list.isExternal||a.isFeatureEnabled(a.UseVroomUpload))&&t.list.isDocumentLibrary&&t.list.templateType!==n.default.webPageLibrary&&3!==e.itemStatus};return e}(i.default);t.default=s});define("LQ",["require","exports","ap","kx","aC","bX","dG","aI","dH","ow","cE","k5","kG","i7","by","kL","ba"],function(e,t,r,i,a,s,o,l,n,d,c,u,p,m,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="Upload";t.platform=t.resources.consume(h.platformDetection);t.uploadProcessorType=e.uploadProcessorType;t.inputType=t.createObservable(t._getInputType(t.uploadProcessorType));t._itemCommandHelper=t.resources.consume(p.resourceKey);t.skipInvalidation=!1;return t}e.prototype.onExecute=function(e,t){var i=this,r=e.target,o=Array.prototype.slice.call(r&&(r["test-files"]||r.files)||[]);this.resources.consume(c.resourceKey).logData({name:"Upload.TopMenu.Click",isIntentional:!0});g.isOneDrive&&this.trackPromise(this.resources.consumeAsync(f.resourceKey).then(function(e){e.fireUploadEvents()}));if(o){var n=this.resources.consume(s.currentItemSet);return this.resources.consumeAsync(d.asyncTypeResourceKey).then(function(e){var t=new e({files:o,parentItem:i.item.peek(),wasDragAndDropped:!1,type:i.uploadProcessorType,itemSet:n.peek(),skipInvalidation:i.skipInvalidation});i.trackPromise(t.start());return t.wait()}).then(function(){return{resultType:l.ResultTypeEnum.Success}})}return a.default.wrap({resultType:l.ResultTypeEnum.ExpectedFailure})};e.prototype.onIsAvailable=function(){var e=!1,t=this.item();if(!this._itemCommandHelper.isCommandSupported(t,m.upload))return!1;switch(this.uploadProcessorType){case o.UploadProcessorType.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case o.UploadProcessorType.Folder:e=this.platform.isFolderUploadSupported}return e&&!t.isPlaceholder&&t.queryType===n.default.Files};e.prototype._getInputType=function(e){switch(e){case o.UploadProcessorType.Html5file:return u.default.htmlFileUpload;case o.UploadProcessorType.Folder:return u.default.folderUpload;default:return u.default.none}};return e}(i.default);t.default=y});define("LO",["require","exports","ap","kz","aC","aI","ci","LH","MZ","dm","dN","iE","cY","dI"],function(e,t,r,i,l,d,c,u,o,p,m,n,a,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="UndoCheckOut";t.isSingleSelectAction=!0;t._pageContext=t.resources.consume(n.pageContext);return t}e.prototype.onSelectionIsAvailable=function(e,t){return!o.default.isFolder(t,!0)&&o.default.isCheckedOut(t)&&a.PermissionMask.hasItemPermission(t,a.PermissionMask.editListItems)&&(a.PermissionMask.hasItemPermission(t,a.PermissionMask.cancelCheckout)||t.properties.CheckedOutUserId===this._pageContext.userId.toString())};e.prototype.onSelectionExecute=function(e,t,i){var r=this.resources.consume(u.resourceKey),o=this.item(),n=e[0],a=p.strings.undoCheckoutConfirmText,s=p.strings.undoCheckoutConfirmTitle;return this.resources.consume(c.resourceKey).requestDialog({title:s,component:{name:m.default.tagName,params:{text:a}},actions:[{name:p.strings.UndoCheckOut,execute:function(){return l.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new h.default("Cancel"),isDefault:!0}]}).wait().then(function(){return r.undoCheckOutItem({parentKey:o.key,item:n}).then(function(){return{resultType:d.ResultTypeEnum.Success}},function(){return{resultType:d.ResultTypeEnum.Failure}})})};return e}(i.default);t.default=s});define("LH",["require","exports","ap","bN","dZ","dR","cg","eQ","dY","iJ","eX","bA"],function(e,t,i,o,n,a,s,l,d,c,u,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._itemProvider=t.itemProvider;i._dataSource=t.versionControlDataSource;i._store=t.itemsStore;i._operationProvider=t.operationProvider;return i}e.prototype.checkOutItem=function(e){var t,i=this,r=e.item,o=this._store.getItem(e.parentKey),n=this._operationProvider.register({name:r.name,type:s.default.checkOutItem,payloads:{checkOutItem:{parent:o.peek(),item:r}},iconName:r.iconName});n.progress.maximum(1);n.progress.current(0);t=this._dataSource.checkOutItem(e);n.state(d.default.started);return t.then(function(){i._itemProvider.invalidateItem(e.parentKey);n.progress.current(1);n.state(d.default.completed)},function(){n.state(d.default.failed)})};e.prototype.undoCheckOutItem=function(e){var t,i=this,r=e.item,o=this._store.getItem(e.parentKey),n=this._operationProvider.register({name:r.name,type:s.default.undoCheckOutItem,payloads:{undoCheckOutItem:{parent:o.peek(),item:r}},iconName:r.iconName});n.progress.maximum(1);n.progress.current(0);t=this._dataSource.undoCheckOutItem(e);n.state(d.default.started);return t.then(function(){i._itemProvider.invalidateItem(e.parentKey);n.progress.current(1);n.state(d.default.completed)},function(){n.state(d.default.failed)})};e.prototype.checkInItem=function(e){var t,i=this,r=e.item,o=this._store.getItem(e.parentKey),n=this._operationProvider.register({name:r.name,type:s.default.checkInItem,payloads:{checkInItem:{parent:o.peek(),item:r}},iconName:r.iconName});n.progress.maximum(1);n.progress.current(0);t=this._dataSource.checkInItem(e);n.state(d.default.started);return t.then(function(){i._itemProvider.invalidateItem(e.parentKey);n.progress.current(1);n.state(d.default.completed)},function(e){n.state(d.default.failed);try{n.error(new l.default({message:e.message.value}))}catch(e){}})};e.prototype.getVersionHistoryUrl=function(e,t){return this._dataSource.getVersionHistoryUrl(e,t)};e.dependencies=i.__assign({},o.default.dependencies,{itemProvider:u.resourceKey,versionControlDataSource:n.versionControl,itemsStore:c.resourceKey,operationProvider:a.resourceKey});return e}(o.default);t.default=p;t.resourceKey=r.createResolvedResourceKey(e("module").id,p)});define("LI",["require","exports","ap","MZ","kz","LJ","dm","dI","nH","b3","aI","cY","aC","ci","LH","iE","dJ","eX"],function(e,t,r,o,i,u,p,m,h,f,g,n,y,v,_,a,s,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="CheckIn";t.isSingleSelectAction=!0;t._pageContext=t.resources.consume(a.pageContext);return t}e.prototype.onIsAvailable=function(){if(!i.prototype.onIsAvailable.call(this))return!1;var e=this.item(),t=this.getParent(e,"list");return!(this._shouldUseOldCheckInDialog(e)&&t&&!t.isRootFolder)};e.prototype.onSelectionIsAvailable=function(e,t){return!o.default.isFolder(t,!0)&&!o.default.isCheckedOutByOther(t,this._pageContext.userId)&&o.default.isCheckedOut(t)&&n.PermissionMask.hasItemPermission(t,n.PermissionMask.editListItems)};e.prototype.onSelectionExecute=function(e,t,i){var r=this,o=e[0],n=this.resources.consume(v.resourceKey);if(this._shouldUseOldCheckInDialog(o,!0)){var a=this._getCheckInDialogUrl(o.id),s=this.resources.consume(b.resourceKey);return n.requestDialog({title:p.strings.CheckIn,size:"XLarge",control:f.toSpecification(h.default,{componentUrl:a,showInDialog:!0,heightOffset:.75}),actions:[]}).wait().then(function(){s.invalidateItem(r.item.peek().key);return{resultType:g.ResultTypeEnum.Success}},function(){return{resultType:g.ResultTypeEnum.Failure}})}var l=this.resources.consume(_.resourceKey),d=this.item(),c=this.observables.create("");return n.requestDialog({title:p.strings.CheckIn,component:{name:u.default.tagName,params:{comments:c}},actions:[{name:p.strings.CheckInCommit,execute:function(){return y.default.wrap(2)},isAvailable:this.observables.create(!0),isDefault:!0,icon:new m.default("Save"),automationId:"checkInDialogCommit"}]}).wait().then(function(){return l.checkInItem({parentKey:d.key,item:o,comments:c()}).then(function(){return{resultType:g.ResultTypeEnum.Success}},function(){return{resultType:g.ResultTypeEnum.Success}})})};e.prototype._shouldUseOldCheckInDialog=function(e,t){var i=this.getParent(e,"list",t);return!!i&&i.list.enableMinorVersions};e.prototype._getCheckInDialogUrl=function(e){var t=this.getParent(this.item.peek(),"list",!0),i=this.resources.consume(a.pageContext);return i.webAbsoluteUrl+"/"+i.layoutsUrl+"/checkin.aspx?"+s.serializeQuery({List:t.list.id,FileName:e,IsDlg:1})};return e}(i.default);t.default=l});define("LJ",["require","exports","LM","b5","LL","LK"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-checkin-dialog-builder",template:e("LL"),viewModel:i.default});t.default=o});define("LM",["require","exports","ap","bF","LN"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.commentsPlaceholder=o.strings.CommentsPlaceholder;t.commentsLabel=o.strings.CommentsLabel;t.comments=e.comments;return t}return e}(i.default);t.default=n});define("LL",[],function(){return'<div class=CheckInEditor><div class="od-TextField od-TextField--multiline"><label class=ms-Label for=CheckInEditorTextArea data-bind="text: commentsLabel"></label> <textarea id=CheckInEditorTextArea class="CheckInEditor-textarea od-TextField-field" rows=5 cols=45 title=commentsLabel data-bind="value: comments, textInput: comments, hasFocus: true, attr: { placeholder: commentsPlaceholder }"></textarea></div></div>'});define("LK",["c","az"],function(e,t){e.loadStyles([{rawString:".CheckInEditor-textarea{overflow:auto;width:100%;border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:';border-radius:0;font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.CheckInEditor-textarea:hover{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.CheckInEditor-textarea:focus{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}])});define("LG",["require","exports","ap","MZ","kz","dm","dZ","nH","b3","aI","a9","cY","ci","LH","fO","eX","kG","jb"],function(e,t,r,o,i,c,n,u,p,m,a,s,h,f,l,g,d,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="VersionHistory";t.isSingleSelectAction=!0;t._urlDataSource=t.resources.consume(n.url);t._itemUrlHelper=t.resources.consume(l.resourceKey);t._itemCommandHelper=t.resources.consume(d.resourceKey);return t}e.prototype.onIsAvailable=function(){var e=this.getParent(this.item(),"list");return i.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(this.item(),y.versionHistory)&&this._urlDataSource.getPageType()!==a.default.TextFileEditor&&!!e&&!this._isRemoteWeb(e)&&(e.list.enableVersions||e.list.isModerated)&&3!==this.item().itemStatus&&4!==this.item().itemStatus};e.prototype.onSelectionIsAvailable=function(e,t){return!o.default.isFolder(t,!0)&&this._itemCommandHelper.isCommandSupported(t,y.versionHistory)&&s.PermissionMask.hasItemPermission(t,s.PermissionMask.viewVersions)};e.prototype.onSelectionExecute=function(e,t,i){var r=this.resources.consume(h.resourceKey),o=this.resources.consume(g.resourceKey),n=this.resources.consume(f.resourceKey),a=this.item(),s=e[0],l=this.getParent(s,"list",!0),d=l.list.isDocumentLibrary?"":l.list.id;return r.requestDialog({title:c.strings.ShowVersionHistory,size:"XLarge",control:p.toSpecification(u.default,{componentUrl:n.getVersionHistoryUrl(s.id,d),showInDialog:!0,heightOffset:.5,forceSharePointScrollbar:!0}),actions:[]}).wait().then(function(){o.invalidateItem(a.key);return{resultType:m.ResultTypeEnum.Success}})};e.prototype._isRemoteWeb=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).isCrossDomain};return e}(i.default);t.default=v});define("LF",["require","exports","ap","aC","bN","MZ","cY","kt","kp","eA","dZ","a9","kG","jb","LB"],function(i,e,t,r,o,n,a,s,l,d,c,u,p,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var h=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.state=t.createPureComputed(t._computeState);t._urlDataSource=t.resources.consume(c.url);t._itemParentHelper=t.resources.consume(d.resourceKey);t._itemCommandHelper=t.resources.consume(p.resourceKey);t._itemSelectionHelper=new(t.managed(l.default))({allowMultiSelect:!1,canFallback:!1});return t}e.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem}};e.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),i=!n.default.isFolder(e,!0)&&a.PermissionMask.hasItemPermission(e,a.PermissionMask.viewVersions);return{isAvailable:this._urlDataSource.getPageType()!==u.default.TextFileEditor&&!!t&&(t.list.enableVersions||t.list.isModerated)&&this._itemCommandHelper.isCommandSupported(e,m.versionHistory)&&3!==e.itemStatus&&4!==e.itemStatus&&i}};return e}(o.default);e.ShowReactVersionHistoryHandler=h;var f=s.create({name:"ShowReactVersionHistory",source:{moduleDefinition:{path:"adM",getModule:function(){return new r.default(function(e,t){i(["adM"],e,t)})}}},handlerType:h});e.default=f});define("LB",["c","az"],function(e,t){e.loadStyles([{rawString:".InfoPane-sharing{margin-top:8px}.SharingSection-shareLink{line-height:26px;font-size:12px}html[dir=ltr] .SharingSection-shareLink{float:right}html[dir=rtl] .SharingSection-shareLink{float:left}.SharingSection-entity{padding:8px 0;font-size:12px}.SharingSection-entity .ms-Persona{white-space:nowrap}.SharingSection-entity .ms-Persona .ms-Persona-details{display:inline-block;max-width:170px;padding:0}.SharingSection-addPeople{font-size:17px;font-weight:300;min-height:50px;margin-top:10px}.SharingSection-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:20px;border-radius:50%;width:50px;height:50px}[dir=ltr] .SharingSection-addPeople-icon{margin-right:10px}[dir=rtl] .SharingSection-addPeople-icon{margin-left:10px}.SharingSection-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:12px}[dir=ltr] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{left:15px}[dir=rtl] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{right:15px}.SharingSection-addPeople-text{display:inline-block;vertical-align:top;line-height:50px}.SharingSection-linksBox a{display:inline-block;margin-top:5px}.SharingSection-link,.od-PermissionsPanel-link{padding-top:8px}.od-alert{display:none}.od-alert.od-PermissionsPanel-alert{display:block}div.ms-ContextualMenu.is-open{z-index:299}.od-PermissionsPanel{height:100%;overflow-y:auto;overflow-x:hidden}.od-PermissionsPanel .od-SharingLink-linkSwitcher{font-size:12px}.od-PermissionPile-FacePile{display:inline-block}.od-PermissionsPanel-shareLink{line-height:26px;font-size:12px}html[dir=ltr] .od-PermissionsPanel-shareLink{float:right}html[dir=rtl] .od-PermissionsPanel-shareLink{float:left}.od-PermissionsPanel-entity{padding:8px 0;font-size:12px}.od-PermissionsPanel-entity .od-Persona{white-space:nowrap}.od-PermissionsPanel-entity .od-Persona .od-Persona-details{display:inline-block;max-width:200px;padding:0}.od-PermissionsPanel-addPeople{font-size:17px;font-weight:300;min-height:50px;padding-bottom:10px}.od-PermissionsPanel-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:20px;border-radius:50%;width:50px;height:50px}[dir=ltr] .od-PermissionsPanel-addPeople-icon{margin-right:10px}[dir=rtl] .od-PermissionsPanel-addPeople-icon{margin-left:10px}.od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:12px}[dir=ltr] .od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{left:15px}[dir=rtl] .od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{right:15px}.od-PermissionsPanel-addPeople-text{display:inline-block;vertical-align:top;line-height:50px}.od-PermissionsPanel-linksBox a{display:inline-block;margin-top:5px}.od-PermissionsPanel-link{padding-top:8px}.od-PermissionsPanel-container{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-PermissionsPanel-container-withCommandbar{top:40px}.od-PermissionsPanel-head{font-size:21px;font-weight:100}.od-PermissionsPanel-fileName{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:25px}[dir=ltr] .od-PermissionsPanel-fileName{padding-right:40px}[dir=rtl] .od-PermissionsPanel-fileName{padding-left:40px}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path{padding:3px;display:inline-block;vertical-align:middle}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element{display:inline;word-break:break-all}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:0 5px;font-size:8px;font-weight:800;content:'\\E76C'}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:last-child:after{content:'';display:none}html[dir=rtl] .od-PermissionsPanel-Path-Element:after{content:'\\E76B'}.od-PermissionsPanel-titleBar{padding-top:15px;padding-bottom:10px;border-bottom:solid 1px "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-PermissionsPanel-titleBar{padding-left:40px}[dir=rtl] .od-PermissionsPanel-titleBar{padding-right:40px}.od-PermissionsPanel-content{padding-top:15px;width:300px;height:calc(100% - 110px)}[dir=ltr] .od-PermissionsPanel-content{padding-left:40px}[dir=rtl] .od-PermissionsPanel-content{padding-right:40px}.od-PermissionsPanel-linksBox{padding-bottom:10px}.od-SharingSection-PermissionsPile{width:320px;padding:16px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;margin-bottom:16px}.od-SharingSection-PermissionsPile .InfoPane-sectionHeader{padding-bottom:10px;cursor:default}.od-SharingSection-PermissionsPile-personas{margin-bottom:4px}.od-SharingSection-PermissionsPile-personas .od-Persona{display:inline-block;width:32px;height:32px;box-sizing:border-box;cursor:pointer;vertical-align:top}[dir=ltr] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-right:4px}[dir=rtl] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-left:4px}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs{border:1px solid transparent}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs .od-Persona-initials{font-size:15px}.od-SharingSection-PermissionsPile-personas .od-Persona-presence{box-sizing:border-box;border:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SharingSection-PermissionsPile-personas .od-PersonaTile{outline:0}.od-focus--enabled .od-Persona--xs:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset}.od-SharingSection-PermissionsPile-addFriend{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:100%;border-radius:50%;position:relative;font-size:17px}.od-SharingSection-PermissionsPile-numberText{font-size:10px;font-weight:600;padding-top:16px;text-align:center;pointer-events:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";line-height:normal}.od-SharingSection-PermissionsPile-personaBorder{box-sizing:border-box}.od-SharingSection-PermissionsPile-personaBorder:focus{outline:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-SharingSection-PermissionsPile-personaIcon{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:100%;pointer-events:none;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";border-radius:50%}.od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{position:absolute;top:4px;-ms-transform:translateX(-50%);transform:translateX(-50%);color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font-size:12px;line-height:normal}[dir=ltr] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{right:50%}.od-SharingSection-PermissionsPile-personaMore{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:100%}.od-SharingSection-PermissionsPile-moreNumber{position:absolute;font-size:10px;font-weight:600;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir=ltr] .od-SharingSection-PermissionsPile-moreNumber{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-moreNumber{right:50%}.od-SharingSection-PermissionsPile-description{margin-bottom:4px;padding:2px}.od-SharingSection-PermissionsPile-description .ms-Icon{font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharingSection-PermissionsPile-descriptionText{display:inline-block;font-size:11px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";vertical-align:top;padding:3px}.od-Persona .od-Persona--xs{display:inline-block}.od-SharingSection-PermissionsPile-personas .od-Persona .od-Persona-details{display:none}.od-ShowPermissions-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:0;width:100%;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .ms-CommandBar{animation:none}}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button i{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}.od-ShowPermissions-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .CommandBar{animation:none}}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:12px;padding-right:12px}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:1px solid "},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";margin:2px -8px}"}])});define("LE",["require","exports","ap","kz","aC","aI","dZ"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="ClearSelection";t._urlDataSource=t.resources.consume(a.url);return t}e.prototype.onSelectionIsAvailable=function(e,t){return 0<e};e.prototype.onIsAvailable=function(){return i.prototype.onIsAvailable.call(this)&&!this._urlDataSource.isRecycleBin(this.item().queryType)};e.prototype.onExecute=function(e,t){this.selectionModel.clear();return o.default.wrap({resultType:n.ResultTypeEnum.Success})};return e}(i.default);t.default=s});define("LD",["require","exports","ap","aC","a9","cY","Lm","dZ","jc"],function(r,e,t,o,n,a,i,s,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="Rename";t._urlDataSource=t.resources.consume(s.url);return t}e.prototype.getExecutorPath=function(){return"aeP"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){r(["aeP"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return!!this.itemCommandHelper.isCommandSupported(e,l.rename)&&(e&&!e.list&&a.PermissionMask.hasItemPermission(e,a.PermissionMask.editListItems)&&this._urlDataSource.getPageType()!==n.default.TextFileEditor)};return e}(i.default);e.default=d});define("LC",["require","exports","ap","g4","bX","kp","ba"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="ViewInFolderAction";var i=t.resources;t._actionMap=i.consume(o.actionMap);t._itemSelectionHelper=new(t.managed(n.default))({allowMultiSelect:!1,canFallback:!1});t._navigationAction=new(t.managed(t._actionMap.NavigationAction))({url:t.createPureComputed(function(){return t._itemSelectionHelper.firstItem()&&t._itemSelectionHelper.firstItem().parentLink})});return t}e.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};e.prototype.onIsAvailable=function(){return a.isFeatureEnabled(a.EnableViewInFolder)&&this._navigationAction.isAvailable()};return e}(r.default);t.default=s});define("LA",["require","exports","ap","aC","bN","kt","kp","LB"],function(i,e,t,r,o,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.state=t.createPureComputed(t._computeState);t._itemSelectionHelper=new(t.managed(a.default))({allowMultiSelect:!1,canFallback:!1,overrideItem:e.item});t.engagementSource=e.engagementSource;return t}e.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem.peek(),engagementSource:this.engagementSource}};e.prototype._computeState=function(){return{isAvailable:!!this._itemSelectionHelper.firstItem()}};return e}(o.default);e.ShowPermissionsHandler=s;var l=n.create({name:"ShowPermissions",source:{moduleDefinition:{path:"ad2",getModule:function(){return new r.default(function(e,t){i(["ad2"],e,t)})}}},handlerType:s});e.default=l});define("Ly",["require","exports","ap","aC","bN","kt","kp","iE","ep","ba","eA","dH","Lz"],function(i,e,t,r,o,n,a,s,l,d,c,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var p=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._itemSelectionHelper=new(t.managed(a.default))({allowMultiSelect:!1,canFallback:!1});t.state=t.createPureComputed(t._computeState);t._pageContext=t.resources.consume(s.pageContext);t._itemParentHelper=t.resources.consume(c.resourceKey);t.item=e.item;return t}e.prototype.getParams=function(){return{item:this.item||this._itemSelectionHelper.firstItem}};e.prototype._computeState=function(){var e=this.item()||this._itemSelectionHelper.firstItem(),t=Number(this._pageContext.webTemplate)===l.default.mySite,i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"subsite")),r=i&&i.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl;return{isAvailable:!!e&&t&&!r&&e.queryType===u.default.Files&&d.isFeatureEnabled(d.ItemAnalyticsUX)&&d.isFeatureEnabled(d.ItemAnalytics)}};return e}(o.default);e.ShowItemAnalyticsHandler=p;var m=n.create({name:"ShowItemAnalytics",source:{moduleDefinition:{path:"adT",getModule:function(){return new r.default(function(e,t){i(["adT"],e,t)})}}},handlerType:p});e.default=m});define("Lz",["c","az"],function(e,t){e.loadStyles([{rawString:".od-ItemAnalytics-viewCounts,.od-ItemAnalytics-viewerCounts{display:inline-block;padding:10px}.od-ItemAnalytics-countsDetails{font-size:15px;padding-top:20px}.od-ItemAnalytics-titleBar{padding-top:15px;padding-bottom:10px;border-bottom:solid 1px "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=ltr] .od-ItemAnalytics-titleBar{padding-left:40px}html[dir=rtl] .od-ItemAnalytics-titleBar{padding-right:40px}.od-ItemAnalytics-container{position:absolute;top:0;left:0;right:0;bottom:0;overflow-x:hidden}.od-ItemAnalytics-activities{margin:20px 40px}"}])});define("Lx",["require","exports","ap","g4","aC","Li"],function(r,e,t,i,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="ShowKeymap";t._executorLoader=new(t.managed(n.default))({path:"ada",getModule:function(){return new o.default(function(e,t){r(["ada"],e,t)})},getExecutorParams:function(){return{}}});return t}e.prototype.onIsAvailable=function(){return!0};e.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return e}(i.default);e.default=a});define("Lw",["require","exports","ap","aC","a9","cY","Lm","dZ","iE","eA","eO","ey","jc","jc"],function(r,e,t,o,n,a,i,s,l,d,c,u,p,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var h=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._isMove=e.isMove;t.name="LaunchMoveCopyPanel";t._urlDataSource=t.resources.consume(s.url);t._moveCopyDataSource=t.resources.consume(s.copy);t._itemParentHelper=t.resources.consume(d.resourceKey);t._capabilities=t._moveCopyDataSource.getCapabilities();t._pageContext=t.resources.consume(l.pageContext);return t}e.prototype.getExecutorPath=function(){return"aeS"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){r(["aeS"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,isMove:this._isMove,selectionHelper:this.selectionHelper}};e.prototype.onIsAvailable=function(){var i=this;return!(!this._capabilities.supportsMoveCopy||this._urlDataSource.getPageType()===n.default.TextFileEditor)&&this.selectionHelper.filterItems(function(e){if(!i._canCopyItem(e))return!1;if(i._isMove){if(!i.itemCommandHelper.isCommandSupported(e,p.moveTo))return!1;if(i._pageContext&&i._pageContext.listBaseTemplate===u.default.webPageLibrary)return!1;var t=i.unwrapObservable(i._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return!(t&&!t.list.isDocumentLibrary&&!t.list.allowCreateFolder)&&(a.PermissionMask.hasItemPermission(e,a.PermissionMask.editListItems)&&a.PermissionMask.hasItemPermission(e,a.PermissionMask.deleteListItems))}return!!i.itemCommandHelper.isCommandSupported(e,m.copyTo)})};e.prototype._canCopyItem=function(e){if(e.list)return!1;if(3===e.itemStatus||4===e.itemStatus)return!1;if(!a.PermissionMask.hasItemPermission(e,a.PermissionMask.openItems))return!1;var t=this._urlDataSource.getKeyParams(e.key),i=this._urlDataSource.getQueryType(t);return!this._urlDataSource.isRecycleBin(i)&&(!!this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"))&&(e.type===c.default.File||e.type===c.default.Folder||e.type===c.default.OneNote||e.type===c.default.Media||e.type===c.default.Unknown||e.type===c.default.Shortcut))};return e}(i.default);e.default=h});define("Lv",["require","exports","ap","aC","Lm","bX","dZ"],function(r,e,t,o,i,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.name="EmptyRecycleBin";t._urlDataSource=t.resources.consume(a.url);t._currentItem=t.resources.consume(n.currentItem);return t}e.prototype.getExecutorPath=function(){return"afD"};e.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){r(["afD"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};e.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};e.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection(),t=this._currentItem();return t&&this._urlDataSource.isRecycleBin(t.queryType)&&0<t.childCount&&0===e.length};return e}(i.default);e.default=s});define("Lu",["require","exports","ap","g4","kp","aI","aC","kG","dZ","jc","bA","c7"],function(i,t,r,e,o,n,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.restoreItemsOperatorTypeResourceKey=new c.ResourceKey({name:i("module").id+".restoreItemsOperator",loader:new c.AliasResourceLoader(function(){return u.loadModuleExport({path:"Sg",getModule:function(){return new a.default(function(e,t){i(["Sg"],e,t)})},getExport:function(e){return e.typeResourceKey}})})});var p=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._urlDataSource=t.resources.consume(l.url);t._itemSelectionHelper=new(t.managed(o.default))({allowMultiSelect:!0,overrideItem:e.item});t._itemCommandHelper=new(t.managed(s.default));return t}e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this._itemSelectionHelper.currentItem(),i=this._urlDataSource.getKeyParams(t.key);return!!this._urlDataSource.isRecycleBin(this._urlDataSource.getQueryType(i))&&this._itemCommandHelper.isCommandSupported(e,d.restoreItem)};e.prototype.onExecute=function(e){var r=this,o=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(i){return r.resources.consumeAsync(t.restoreItemsOperatorTypeResourceKey).then(function(e){var t=new e({parentKey:o,items:i});r.trackPromise(t.start());return t.wait()})}).then(function(){return{resultType:n.ResultTypeEnum.Success}})};return e}(e.default);t.RestoreAction=p;t.default=p});define("Lo",["require","exports","ap","kz","aC","ci","dR","cg","eQ","dY","dW","aI","Lq","Lp","V","eO","dH","ba","dI","cE","eX","dZ"],function(e,t,r,i,d,c,o,u,n,a,p,m,h,s,f,g,y,l,v,_,b,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=s.strings,C=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="RemoveFromSharedList";t.MAX_ITEMS_ALLOWED=14;t._operationProvider=t.resources.consume(o.resourceKey);t._urlDataSource=t.resources.consume(x.url);return t}e.prototype.onSelectionIsAvailable=function(e,t){return l.isFeatureEnabled(l.RemoveFromSharedList)&&t.queryType===y.default.SharedWithMe};e.prototype.onSelectionExecute=function(i,e,t){var o=this,n=this.resources.consume(b.resourceKey),r=this.resources.consume(c.resourceKey),a=this.observables.create(""),s=this.observables.create(!1),l=this.observables.create(!0);if(i.length>this.MAX_ITEMS_ALLOWED){!function(e){s(!0);a(e);d.default.wrap(1)}(f.format(S.errorTooManyItems,this.MAX_ITEMS_ALLOWED));l(!1);this.resources.consume(_.resourceKey).logData({name:"RemoveFromSharedList.TooManyItems",extraData:{itemCount:i.length}})}return r.requestDialog({title:1<i.length?S.itemsTitleWithAccess:i[0].type===g.default.File||i[0].type===g.default.Media?S.fileTitleWithAccess:S.folderTitleWithAccess,component:{name:h.default.tagName,params:{isSpam:null,selection:i,removeAccess:!1,hasError:s,status:a}},actions:[{name:S.actionText,execute:function(){var t=new p.default,r=i.map(function(e){return o._operationProvider.register({name:e.displayName,type:u.default.removeFromSharedList,batch:t})}),e={items:i,markAsSpam:!1,parentKey:o._urlDataSource.getRootItemKey(y.default.SharedWithMe)};n.removeFromSharedList(e).then(function(e){if(e)for(var t=0;t<e.length;t++){var i=e[t];o.setOperationStatus(i,r[t])}},function(e){for(var t=0;t<r.length;t++)o.setOperationStatus(S.errorText,r[t])});return d.default.wrap(2)},isAvailable:l,isDefault:!0,icon:new v.default("Cancel"),automationId:"removeFromSharedListConfirm"}]}).wait().then(function(){return{resultType:m.ResultTypeEnum.Success}})};e.prototype.setOperationStatus=function(e,t){if(e){t.error(new n.default({message:e}));t.state(a.default.failed)}else t.state(a.default.completed)};return e}(i.default);t.default=C});define("Lq",["require","exports","Lt","b5","Ls","Lr"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-remove-from-sharedlist",template:e("Ls"),viewModel:i.default,synchronous:!0});t.default=o});define("Lt",["require","exports","ap","bF","Lp","eO"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.strings,s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,{})||this;t.allowSpam=!!e.isSpam;t.isSpam=e.isSpam;t.status=e.status;t.hasError=e.hasError;var i=e.selection;e.hasError()?t.subText="":e.removeAccess?t.subText=1<i.length?a.itemsSubText:i[0].type===n.default.File?a.fileSubText:a.folderSubText:t.subText=1<i.length?a.itemsSubTextWithAccess:i[0].type===n.default.File?a.fileSubTextWithAccess:a.folderSubTextWithAccess;t.spamText=1<i.length?a.itemsSpamText:i[0].type===n.default.File?a.fileSpamText:a.folderSpamText;return t}return e}(r.default);t.default=s});define("Ls",[],function(){return'<div class=od-RemoveFromSharedList><div class=od-RemoveFromSharedList-SubText data-bind="text: subText"></div><span data-bind="if: allowSpam"><input id=RemoveFromSharedList-isSpam type=checkbox name=isSpam class=od-isSpam data-bind="checked: isSpam"> <label for=RemoveFromSharedList-isSpam class=spamText data-bind="text: spamText"></label></span><div class=od-RemoveFromSharedList-Status data-bind="text: status, css: { \'od-RemoveFromSharedList-Status--error\': hasError }"></div></div>'});define("Lr",["c","az"],function(e,t){e.loadStyles([{rawString:".od-RemoveFromSharedList-Status{padding-top:5px}.od-RemoveFromSharedList-Status--error{color:#a80000}"}])});define("Ll",["require","exports","ap","aC","dZ","Lm","ba","g9","dH","i9"],function(i,e,t,r,n,o,a,s,l,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c=function(o){t.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this,i=e.useOldSharingDialog,r=void 0!==i&&i;t.name="GetLink";t._sharingDataSourceHelper=new(t.managed(s.default));t._urlDataSource=t.resources.consume(n.url);t._useNewSharingDialog=a.isFeatureEnabled(a.UseNewSharingDialog)&&!r;return t}e.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem(),t=e&&!!this._sharingDataSourceHelper.getParentListId(e);return!!this.itemCommandHelper.isCommandSupported(e,d.share)&&(o.prototype.onIsAvailable.call(this)&&e&&!this._urlDataSource.isRecycleBin(e.queryType)&&e.queryType!==l.default.Discover&&e.queryType!==l.default.DocumentLibraries&&!e.list&&!e.isRootFolder&&t&&!(e.lifeCycleStatus&&e.lifeCycleStatus.isExternal))};e.prototype.getExecutorPath=function(){return"act"};e.prototype.getModuleFactory=function(){return function(){return new r.default(function(e,t){i(["act"],e,t)})}};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};e.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,useNewSharingDialog:this._useNewSharingDialog}};return e}(o.default);e.default=c});define("Lj",["require","exports","ap","g4","dH","bX","Lk","ep","ey","iE","lb","eA","ba"],function(e,t,r,i,o,n,a,s,l,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="ToggleListLayout";t._currentItem=t.resources.consume(n.currentItem);t._itemParentHelper=t.resources.consume(u.resourceKey);t._strictAvailability=e.strictAvailability;t._layoutType=t._getEffectiveLayoutType(e.layoutType);t._pageContext=t.resources.consume(d.pageContext);t._helper=new(t.managed(a.default));return t}e.prototype.onIsAvailable=function(){return(!this._strictAvailability||!this.isToggled())&&this._layoutChangingEnabledForQueryType()};e.prototype.onIsToggled=function(){return this._layoutChangingEnabledForQueryType()&&this._layoutType()===this._helper.pageLayoutType()};e.prototype.onExecute=function(e,t){return this._helper.changeLayout(this._layoutType.peek())};e.prototype._getEffectiveLayoutType=function(r){var o=this,n=this.observables;return n.pureCompute(function(){var e=n.unwrap(o._itemParentHelper.getFacetedAncestorOrSelf(o._currentItem(),"list")),t=e&&e.list,i=Number(o._pageContext.webTemplate)===s.default.mySite||t&&t.templateType===l.default.mySiteDocumentLibrary;return c.getValidLayout(r,{isCustomList:t&&t.isDocumentLibrary&&!i})})};e.prototype._layoutChangingEnabledForQueryType=function(){var e=this._currentItem();if(!e)return!1;switch(e.queryType){case o.default.SharedWithMe:return!p.isFeatureEnabled(p.ODBVroomSharedWithMe);case o.default.Recent:var t=this.resources.consume(n.isInNewRecentView.optional);return!(t&&t());case o.default.Discover:case o.default.Subsites:case o.default.DocumentLibraries:return!1;default:return!0}};return e}(i.default);t.default=m});define("Lk",["require","exports","ap","bN","c7","aI","lb","jG","aC","b4","bA"],function(o,e,t,i,n,r,a,s,l,d,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(r){t.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._pageLayoutType=t.pageLayoutType;i.layoutType=i._getLayoutType();i._debouncer=i.scope.attach(new d.default);return i}e.prototype._getLayoutType=function(){var t=this,e=this.observables,r=e.create("");e.backgroundCompute(function(){var e=t._pageLayoutType(),i=a.Path[e];t._debouncer.debounce(i?n.loadModule({path:i,getModule:function(){return new l.default(function(e,t){o([i],e,t)})}}).then(function(e){return e.tagName}):l.default.wrap("")).then(function(e){r(e)})});return r};e.dependencies=t.__assign({},i.default.dependencies,{pageLayoutType:s.files.layoutType});return e}(i.default);e.LayoutTypeResolver=u;e.layoutTypeResolverKey=new c.ResourceKey({name:o("module").id+".layoutTypeResolver",factory:new c.ResolvedResourceFactory(u)});e.resolvedLayoutTypeResourceKey=new c.ResourceKey({name:o("module").id+".resolvedLayoutType",factory:{dependencies:{layoutTypeResolver:e.layoutTypeResolverKey},create:function(e){return{instance:e.layoutTypeResolver.layoutType}}}});var p=function(i){t.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.pageLayoutType=t.resources.consume(s.files.layoutType);return t}e.prototype.changeLayout=function(i){var t=this;return n.loadModule({path:a.Path[i],getModule:function(){return new l.default(function(e,t){o([a.Path[i]],e,t)})}}).then(function(e){t.pageLayoutType(e.tagName);return l.default.wrap({resultType:r.ResultTypeEnum.Success,extraData:{layout:i}})})};return e}(i.default);e.default=p});define("Lg",["require","exports","ap","aC","Lh"],function(i,e,r,o,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getExecutorPath=function(){return"aeM"};t.prototype.getModuleFactory=function(){return function(){return new o.default(function(e,t){i(["aeM"],e,t)})}};return t}(t.default);e.default=n});define("Lh",["require","exports","ap","g4","Li","kp","bX","Em"],function(e,t,i,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="Save";t._itemContentsProvider=t.resources.consume(s.resourceKey);var i=t.resources.consume(a.currentItem);t._selectionHelper=new(t.managed(n.default))({overrideItem:e.item,allowMultiSelect:!1,canFallback:!1});t._loader=new(t.managed(o.default))({path:t.getExecutorPath(),getModule:t.getModuleFactory(),getExecutorParams:function(){return{selectionHelper:t._selectionHelper,currentItem:i.peek()}}});return t}e.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._itemContentsProvider.getItemContent(e);return!!t.isEditable()&&(!!t.memoryContent()&&(!t.hasConflict()&&(!t.hasPendingSave()&&t.hasChanges())))};e.prototype.onExecute=function(e){return this._loader.execute(e)};return e}(r.default);t.SaveAction=l;t.default=l});define("Em",["require","exports","En","bB","bA"],function(e,t,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._itemContents={}}e.prototype.getItemContent=function(e){var t=e.key,i=this._itemContents,r=i[t];if(!r){r=new o.default;n.hook(r,function(){delete i[t]});i[t]=r}return r};e.prototype.dispose=function(){this._itemContents={}};return e}();t.default=r;t.resourceKey=i.createResolvedResourceKey(e("module").id,r,{})});define("En",["require","exports","ap","aq","bN"],function(e,t,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.memoryContent=o.observable(null);t.serverContent=o.observable(null);t.outDated=o.observable(!1);t.isEditable=o.observable(!1);t.hasConflict=t.createPureComputed(t._computeHasConflict);t.hasPendingSave=t.createPureComputed(t._computeHasPendingSave);t.hasChanges=t.createPureComputed(t._computeHasChanges);t._lastSaved=o.observable(null);t._pendingSave=o.observable(null);return t}e.prototype.startingSave=function(){this.hasPendingSave.peek()||this._pendingSave(this.memoryContent.peek().text)};e.prototype.saveFailed=function(){this.hasPendingSave.peek()&&this._pendingSave(null)};e.prototype.saveSucceded=function(){if(this.hasPendingSave.peek()){this.updateETag=!0;this._lastSaved(this._pendingSave.peek());this._pendingSave(null)}};e.prototype._computeHasPendingSave=function(){return!!this._pendingSave()};e.prototype._computeHasChanges=function(){var e=this.memoryContent();if(!e||"string"!=typeof e.text)return!1;var t=this._lastSaved();if(null===t){this._lastSaved(e.text);return!1}return e.text!==t};e.prototype._computeHasConflict=function(){return!!this.serverContent()};return e}(i.default);t.default=n});define("La",["require","exports","ap","kx","kp","dI","aC","dm","aI","ci","Lb","fO","d5","iE","dc"],function(e,t,r,i,o,n,a,s,l,d,c,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="malwareDetected";t.dialogProvider=t.resources.consume(d.resourceKey);t._itemSelectionHelper=new(t.managed(o.default))({overrideItem:e.item});t._responsiveUI=t.resources.consume(p.resourceKey);t._pageContext=t.resources.consume(m.pageContext);t._navigation=t.resources.consume(h.navigation);t._itemUrlHelper=t.resources.consume(u.resourceKey);return t}e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};e.prototype.onExecute=function(e,t){this._getMalwareDetectedDialog();return a.default.wrap({resultType:l.ResultTypeEnum.Failure})};e.prototype._getMalwareDetectedDialog=function(){var e=this,t=this._pageContext.allowInfectedDownload,i=[];t&&i.push({name:s.strings.Download,execute:function(){e._downloadInfectedItemViaClassic();return a.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new n.default("Download"),isDefault:!0});i.push({name:t?s.strings.declineInfectedDownload:s.strings.ok,execute:function(){return a.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new n.default("Cancel"),isDefault:!0});this.dialogProvider.requestDialog({component:{name:c.default.tagName,params:{allowInfectedDownload:t}},size:"Medium",actions:i,focusOnPrimaryAction:!0,isDismissable:!(this._responsiveUI.compareSize(this._responsiveUI.formFactorSize(),"Small")<=0)})};e.prototype._getItemClassicDownloadLink=function(){var e=this._itemSelectionHelper.firstItem();return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl+"?avcmd=1"};e.prototype._downloadInfectedItemViaClassic=function(){var e=this._getItemClassicDownloadLink();e&&this._navigation.navigateTo({url:e,frameId:"_blank"})};return e}(i.default);t.default=f});define("Lb",["require","exports","Le","b5","Ld","Lc"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-malwareDetected",template:e("Lc"),viewModel:i.default});t.default=o});define("Le",["require","exports","ap","bF","V","Lf"],function(r,e,t,i,o,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a='<a href="https://go.microsoft.com/fwlink/?linkid=862871" target="_blank">'+n.strings.malwareDetectedMessageLearnMore+"</a>",s=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.allowInfectedDownload=e.allowInfectedDownload;t.malwareDetectedIconUrl="undefined"==typeof __webpack_public_path__?r.toUrl("@ms/odsp-media/lib/images/atp/malware_icon_168x168.svg"):r("@ms/odsp-media/dist/media/images/atp/malware_icon_168x168.svg");t.malwareDetectedMessageHeader=n.strings.malwareDetectedDialogHeader;t.malwareDetectedMessage=o.format(n.strings.malwareDetectedMessage,a);t.malwareDetectedAllowDownloadMessage=o.format(n.strings.malwareDetectedAllowDownloadMessage,a);return t}return e}(i.default);e.default=s});define("Ld",["c","az"],function(e,t){e.loadStyles([{rawString:".od-MalwareDetected-dialog-header{color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:";font-size:21px;margin-bottom:15px}"}])});define("Lc",[],function(){return'<div class=od-MalwareDetected-dialog-content><div class=od-MalwareDetected-dialog-header data-bind="text: malwareDetectedMessageHeader"></div><div>\x3c!--ko if: allowInfectedDownload--\x3e<span data-bind="html: malwareDetectedAllowDownloadMessage"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot: allowInfectedDownload--\x3e<span data-bind="html: malwareDetectedMessage"></span>\x3c!--/ko--\x3e</div></div>'});define("M8",["require","exports","bA","dZ","M9"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedResourceKey(e("module").id,o.FileHoverCardStore,{itemAnalyticsDataSource:r.analytics})});define("M9",["require","exports","ap","Nx","Nw","Nu","Nl","Ng","Nc","Nb","Na"],function(e,t,i,r,o,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t);i.__exportStar(d,t);i.__exportStar(c,t)});define("Nx",["require","exports","ap","at","j8","Nz","mo","jP","yg","d","Nw","Ne","Nc","Nl","Ng","Na","a0","Ny"],function(e,t,i,l,o,s,n,a,d,c,u,p,m,h,f,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._store=t.fileHoverCardStore;i.state={itemAnalyticsResult:i._store.getItemAnalytics(i.props.item),expandCardHeight:i._getCardHeight()};return i}e.prototype.componentWillReceiveProps=function(e){e.item!==this.props.item&&this._setHightAndAnalyticsResult(e.item)};e.prototype.componentDidMount=function(){var e=this,t=this.props.item,i=this._store;this._storeListener=i.addListener(function(){e._setHightAndAnalyticsResult(t)},t)};e.prototype.componentWillUnmount=function(){this._store.removeListener(this._storeListener,this.props.item)};e.prototype.render=function(){var e=this.props,t=e.responsiveMode,i=e.cardDismissDelay,r=e.directionalHint,o=e.gapSpace,n=this.state.expandCardHeight,a={onRenderCompactCard:this._onRenderCompactContent,onRenderExpandedCard:this._onRenderExpandedContent,compactCardHeight:176,expandedCardHeight:n,directionalHint:r,directionalHintFixed:!1,gapSpace:o,styles:{expandedCardScroll:"ms-FileHoverCard-expandedCard-hostScroll"}};return t>d.ResponsiveMode.medium?l.createElement(s.HoverCard,{expandingCardProps:a,expandedCardOpenDelay:1500,cardDismissDelay:i,target:this.props.target,onCardVisible:this._onCardOpen}):l.createElement("div",null," ",this.props.children," ")};e.prototype._setHightAndAnalyticsResult=function(e){this.setState({itemAnalyticsResult:this._store.getItemAnalytics(this.props.item),expandCardHeight:this._getCardHeight()})};e.prototype._onCardOpen=function(){this._setHightAndAnalyticsResult(this.props.item);y.Engagement.logData({name:"FileHoverCard.CompactCardOpen"})};e.prototype._getCardHeight=function(){var e=this.props.showViewers,t=this._store.getItemAnalytics(this.props.item);if(g.isSupported(this.props.item.extension)&&t&&t.status===u.AnalyticsResultStatus.succeed&&t.data){if(e&&(1<t.data.activities.length||1===t.data.activities.length&&t.data.activities[0].actor.user.email!==this.props.loginUserEmail))return 340;if(t.data.isTrending)return 40}return 1};e.prototype._onRenderCompactContent=function(){var e=this.props,t=e.itemTitle,i=e.currentUserActivity,r=e.actionBarItems,o=e.showViewers,n=f.getFileHoverCardStrings(),a=this.state.itemAnalyticsResult;return l.createElement("div",{ref:this._onCompactCardRef,className:"ms-FileHoverCard-compactCard"},l.createElement("div",{className:"ms-FileHoverCard-compactCard--title"},t),l.createElement("div",{className:"ms-FileHoverCard-compactCard--activity"},l.createElement(p.AnalyticsActivity,{activity:i,loginUserEmail:this.props.loginUserEmail})),l.createElement("div",{className:"ms-FileHoverCard-compactCard--actionBar"},l.createElement(h.AnalyticsActionBar,{analyticsStats:{itemAnalytics:a&&a.data,onClick:this._onView,disableViewerCount:o,status:a&&a.status,isNotSupported:!g.isSupported(this.props.item.extension)},items:r,withFacePile:o,farItems:[{key:"details",title:n.details,name:n.details,ariaLabel:n.details,onClick:this._onDetails}]})))};e.prototype._onRenderExpandedContent=function(e){var t=this,i=f.getFileHoverCardStrings();if(this.state.itemAnalyticsResult){var r=this.state.itemAnalyticsResult,o=r.data,n=r.skipToken,a=r.status,s=c.getTheme();return l.createElement("div",{className:"ms-FileHoverCard-expandedCard"},a===u.AnalyticsResultStatus.failed&&l.createElement("div",{className:"ms-FileHoverCard-expandedCard-LoadError"},i.apiError,l.createElement("div",{className:"ms-FileHoverCard-expandedCard-Suggestion"},i.suggestion)),o&&o.isTrending&&this._getMessageSection("Market",i.trendingItem,{color:s.palette.green}),this._shouldShowActivities()&&l.createElement("div",{className:"ms-FileHoverCard-expandedCardSection"},l.createElement(m.AnalyticsActivityList,{itemAnalytics:o,moreActivities:!!n,onLoadMoreActivities:function(){return t._store.fetchItemAnalytics(t.props.item,n)},loginUserEmail:this.props.loginUserEmail})))}};e.prototype._getMessageSection=function(e,t,i){return l.createElement("div",{className:"ms-FileHoverCard-expandedCardSection"},l.createElement(n.Icon,{iconName:e,styles:{root:c.mergeStyles([{paddingRight:"8px",position:"relative",top:"3px"},i])}}),t)};e.prototype._shouldShowActivities=function(){var e=this.state.itemAnalyticsResult;return this.props.showViewers&&e&&e.data&&0!==e.data.activities.length};e.prototype._onCompactCardRef=function(e){e&&this._store.fetchItemAnalytics(this.props.item)};e.prototype._onView=function(e){y.Engagement.logData({name:"FileHoverCard.ViewCountClick"});this.props.onView(e,this.props);e.stopPropagation();e.preventDefault()};e.prototype._onDetails=function(e){y.Engagement.logData({name:"FileHoverCard.SeeDetailsClick"});this.props.onDetails(e,this.props);e.stopPropagation();e.preventDefault()};e.contextTypes={fileHoverCardStore:o.object.isRequired};e.defaultProps={directionalHint:11,cardDismissDelay:300,gapSpace:0};i.__decorate([a.autobind],e.prototype,"_setHightAndAnalyticsResult",null);i.__decorate([a.autobind],e.prototype,"_onCardOpen",null);i.__decorate([a.autobind],e.prototype,"_getCardHeight",null);i.__decorate([a.autobind],e.prototype,"_onRenderCompactContent",null);i.__decorate([a.autobind],e.prototype,"_onRenderExpandedContent",null);i.__decorate([a.autobind],e.prototype,"_getMessageSection",null);i.__decorate([a.autobind],e.prototype,"_shouldShowActivities",null);i.__decorate([a.autobind],e.prototype,"_onCompactCardRef",null);i.__decorate([a.autobind],e.prototype,"_onView",null);i.__decorate([a.autobind],e.prototype,"_onDetails",null);return e=i.__decorate([d.withResponsiveMode],e)}(a.BaseComponent);t.FileHoverCard=r});define("Nz",["require","exports","ap","NA"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("NA",["require","exports","ap","NE","ND","NB","wh"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t)});define("NE",["require","exports","ap","at","jP","ND","wE","d","BM","NF"],function(e,t,d,c,u,r,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){d.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._callout=u.createRef();t._expandedElem=u.createRef();t._onKeyDown=function(e){27===e.which&&t.props.onLeave&&t.props.onLeave(e)};t._onRenderCompactCard=function(){return c.createElement("div",{className:m.mergeStyles(t._styles.compactCard,{height:t.props.compactCardHeight+"px"})},t.props.onRenderCompactCard(t.props.renderData))};t._onRenderExpandedCard=function(){!t.state.firstFrameRendered&&t._async.requestAnimationFrame(function(){t.setState({firstFrameRendered:!0})});return c.createElement("div",{className:m.mergeStyles(t._styles.expandedCard,t.props.mode===r.ExpandingCardMode.expanded&&t.state.firstFrameRendered&&{height:t.props.expandedCardHeight+"px"}),ref:t._expandedElem},c.createElement("div",{className:m.mergeStyles(t.state.needsScroll&&t._styles.expandedCardScroll)},t.props.onRenderExpandedCard&&t.props.onRenderExpandedCard(t.props.renderData)))};t._checkNeedsScroll=function(){t._expandedElem.current&&t._async.requestAnimationFrame(function(){t._expandedElem.current&&t._expandedElem.current.scrollHeight>=t.props.expandedCardHeight&&t.setState({needsScroll:!0})})};t.state={firstFrameRendered:!1,needsScroll:!1};return t}e.prototype.componentDidMount=function(){this._checkNeedsScroll()};e.prototype.componentWillUnmount=function(){this._async.dispose()};e.prototype.render=function(){var e=this.props,t=e.targetElement,i=e.theme,r=e.styles,o=e.compactCardHeight,n=e.directionalHintFixed,a=e.firstFocus,s=e.expandedCardHeight;this._styles=f.getStyles(i,r);var l=c.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this._onRenderCompactCard(),this._onRenderExpandedCard());return c.createElement(p.Callout,d.__assign({},u.getNativeProps(this.props,u.divProperties),{componentRef:this._callout,className:m.mergeStyles(m.AnimationStyles.scaleUpIn100,this._styles.root),target:t,isBeakVisible:!1,directionalHint:this.props.directionalHint,directionalHintFixed:n,finalHeight:o+s,minPagePadding:24,onDismiss:this.props.onLeave,gapSpace:this.props.gapSpace}),this.props.trapFocus?c.createElement(h.FocusTrapZone,{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!a},l):l)};e.defaultProps={compactCardHeight:156,expandedCardHeight:384,directionalHint:4,directionalHintFixed:!0,gapSpace:0};return e=d.__decorate([u.customizable("ExpandingCard",["theme"])],e)}(u.BaseComponent);t.ExpandingCard=i});define("ND",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.compact=0]="compact";e[e.expanded=1]="expanded"}(t.ExpandingCardMode||(t.ExpandingCardMode={}));!function(e){e[e.hover=0]="hover";e[e.hotKey=1]="hotKey"}(t.OpenCardMode||(t.OpenCardMode={}))});define("BM",["require","exports","ap","x0"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("x0",["require","exports","ap","x1"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("x1",["require","exports","ap","at","jP"],function(e,t,n,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(o,e);function o(){var r=null!==e&&e.apply(this,arguments)||this;r._root=l.createRef();r._isInFocusStack=!1;r._isInClickStack=!1;r._onKeyboardHandler=function(e){r.props.onKeyDown&&r.props.onKeyDown(e);if(!e.isDefaultPrevented()&&9===e.which&&r._root.current){var t=l.getFirstFocusable(r._root.current,r._root.current.firstChild,!0),i=l.getLastTabbable(r._root.current,r._root.current.lastChild,!0);if(e.shiftKey&&t===e.target){l.focusAsync(i);e.preventDefault();e.stopPropagation()}else if(!e.shiftKey&&i===e.target){l.focusAsync(t);e.preventDefault();e.stopPropagation()}}};return r}o.prototype.componentWillMount=function(){var e=this.props,t=e.isClickableOutsideFocusTrap,i=void 0!==t&&t,r=e.forceFocusInsideTrap;if(void 0===r||r){this._isInFocusStack=!0;o._focusStack.push(this)}if(!i){this._isInClickStack=!0;o._clickStack.push(this)}};o.prototype.componentDidMount=function(){var e=this.props,t=e.isClickableOutsideFocusTrap,i=void 0!==t&&t,r=e.forceFocusInsideTrap,o=void 0===r||r,n=e.elementToFocusOnDismiss,a=e.disableFirstFocus,s=void 0!==a&&a;this._previouslyFocusedElement=n||document.activeElement;l.elementContains(this._root.current,this._previouslyFocusedElement)||s||this.focus();o&&this._events.on(window,"focus",this._forceFocusInTrap,!0);i||this._events.on(window,"click",this._forceClickInTrap,!0)};o.prototype.componentWillReceiveProps=function(e){var t=e.elementToFocusOnDismiss;t&&this._previouslyFocusedElement!==t&&(this._previouslyFocusedElement=t)};o.prototype.componentWillUnmount=function(){var t=this,e=this.props.ignoreExternalFocusing;this._events.dispose();if(this._isInFocusStack||this._isInClickStack){var i=function(e){return t!==e};this._isInFocusStack&&(o._focusStack=o._focusStack.filter(i));this._isInClickStack&&(o._clickStack=o._clickStack.filter(i))}var r=document.activeElement;!e&&this._previouslyFocusedElement&&"function"==typeof this._previouslyFocusedElement.focus&&l.elementContains(this._root.value,r)&&l.focusAsync(this._previouslyFocusedElement)};o.prototype.render=function(){var e=this.props,t=e.className,i=e.ariaLabelledBy,r=l.getNativeProps(this.props,l.divProperties);return a.createElement("div",n.__assign({},r,{className:t,ref:this._root,"aria-labelledby":i,onKeyDown:this._onKeyboardHandler}),this.props.children)};o.prototype.focus=function(){var e,t=this.props.firstFocusableSelector,i="string"==typeof t?t:t&&t();this._root.current&&(e=i?this._root.current.querySelector("."+i):l.getNextElement(this._root.current,this._root.current.firstChild,!0,!1,!1,!0));e&&l.focusAsync(e)};o.prototype._forceFocusInTrap=function(e){if(o._focusStack.length&&this===o._focusStack[o._focusStack.length-1]){var t=document.activeElement;if(!l.elementContains(this._root.current,t)){this.focus();e.preventDefault();e.stopPropagation()}}};o.prototype._forceClickInTrap=function(e){if(o._clickStack.length&&this===o._clickStack[o._clickStack.length-1]){var t=e.target;if(t&&!l.elementContains(this._root.current,t)){this.focus();e.preventDefault();e.stopPropagation()}}};o._focusStack=[];o._clickStack=[];return o}(l.BaseComponent);t.FocusTrapZone=i});define("NF",["require","exports","jP","d"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=i.memoizeFunction(function(e,t){var i,r={root:{width:"340px",pointerEvents:"none",selectors:{".ms-Callout":{boxShadow:"0 0 20px rgba(0, 0, 0, .2)",border:"none",selectors:(i={},i[o.HighContrastSelector]={border:"1px solid WindowText"},i)}}},compactCard:{pointerEvents:"auto",position:"relative"},expandedCard:[{height:"1px",overflowY:"hidden",pointerEvents:"auto",transition:"height 0.467s cubic-bezier(0.5, 0, 0, 1)",selectors:{":before":{content:'""',position:"relative",display:"block",top:"0",left:"24px",width:"292px",height:"1px",backgroundColor:e.palette.neutralLighter}}}],expandedCardScroll:{height:"100%",boxSizing:"border-box",overflowY:"auto"}};return o.concatStyleSets(r,t)})});define("NB",["require","exports","ap","at","jP","d","NE","ND","NC"],function(e,t,p,m,h,f,g,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){p.__extends(e,t);function e(e){var i=t.call(this,e)||this;i._hoverCard=h.createRef();i._cardOpen=function(e){if(!(i._shouldBlockHoverCard()||"keydown"===e.type&&67!==e.which)){i._async.clearTimeout(i._dismissTimerId);"mouseenter"===e.type&&(i._currentMouseTarget=e.currentTarget);i._executeCardOpen(e)}};i._executeCardOpen=function(t){i._async.clearTimeout(i._openTimerId);i._openTimerId=i._async.setTimeout(function(){i.setState(function(e){return e.isHoverCardVisible?e:{isHoverCardVisible:!0,mode:y.ExpandingCardMode.compact,openMode:"keydown"===t.type?y.OpenCardMode.hotKey:y.OpenCardMode.hover}})},i.props.cardOpenDelay)};i._cardDismiss=function(e){"keydown"===e.type&&27!==e.which||i.props.sticky||i._currentMouseTarget!==e.currentTarget&&27!==e.which||i._executeCardDimiss()};i._executeCardDimiss=function(){i._async.clearTimeout(i._openTimerId);i._async.clearTimeout(i._dismissTimerId);i._dismissTimerId=i._async.setTimeout(function(){i.setState({isHoverCardVisible:!1,mode:y.ExpandingCardMode.compact,openMode:y.OpenCardMode.hover})},i.props.cardDismissDelay)};i._instantOpenAsExpanded=function(e){i._async.clearTimeout(i._dismissTimerId);i.setState(function(e){return e.isHoverCardVisible?e:{isHoverCardVisible:!0,mode:y.ExpandingCardMode.expanded}})};i.state={isHoverCardVisible:!1,mode:y.ExpandingCardMode.compact,openMode:y.OpenCardMode.hover};return i}e.prototype.componentDidMount=function(){var e=this._getTargetElement();this._events.on(e,"mouseenter",this._cardOpen);this._events.on(e,"mouseleave",this._cardDismiss);if(this.props.trapFocus)this._events.on(e,"keydown",this._cardOpen);else{this._events.on(e,"focus",this._cardOpen);this._events.on(e,"blur",this._cardDismiss)}if(this.props.instantOpenOnClick)this._events.on(e,"click",this._instantOpenAsExpanded);else{this._events.on(e,"mousedown",this._cardDismiss);this._events.on(e,"keydown",this._cardDismiss)}};e.prototype.componentDidUpdate=function(e,t){var i=this;if(t.isHoverCardVisible!==this.state.isHoverCardVisible)if(this.state.isHoverCardVisible){this._async.setTimeout(function(){i.setState({mode:y.ExpandingCardMode.expanded})},this.props.expandedCardOpenDelay);this.props.onCardVisible&&this.props.onCardVisible()}else{this.setState({mode:y.ExpandingCardMode.compact});this.props.onCardHide&&this.props.onCardHide()}};e.prototype.render=function(){var e=this.props,t=e.expandingCardProps,i=e.children,r=e.id,o=e.setAriaDescribedBy,n=void 0===o||o,a=e.styles,s=this.state,l=s.isHoverCardVisible,d=s.mode,c=s.openMode,u=r||h.getId("hoverCard");this._styles=v.getStyles(a);return m.createElement("div",{className:f.mergeStyles(this._styles.host),ref:this._hoverCard,"aria-describedby":n&&l?u:void 0},i,l&&m.createElement(g.ExpandingCard,p.__assign({},h.getNativeProps(this.props,h.divProperties),{id:u,trapFocus:!!this.props.trapFocus,firstFocus:c===y.OpenCardMode.hotKey,targetElement:this._getTargetElement(),onEnter:this._cardOpen,onLeave:this._executeCardDimiss,mode:d},t)))};e.prototype._getTargetElement=function(){var e=this.props.target;switch(typeof e){case"string":return h.getDocument().querySelector(e);case"object":return e;default:return this._hoverCard.current||void 0}};e.prototype._shouldBlockHoverCard=function(){return!(!this.props.shouldBlockHoverCard||!this.props.shouldBlockHoverCard())};e.defaultProps={cardOpenDelay:500,cardDismissDelay:100,expandedCardOpenDelay:1500,instantOpenOnClick:!1};return e}(h.BaseComponent);t.HoverCard=i});define("NC",["require","exports","jP","d"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=i.memoizeFunction(function(e){return r.mergeStyleSets({host:{}},e)})});define("yg",["require","exports","ap","at","pi","jP"],function(e,t,r,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a;!function(e){e[e.small=0]="small";e[e.medium=1]="medium";e[e.large=2]="large";e[e.xLarge=3]="xLarge";e[e.xxLarge=4]="xxLarge";e[e.xxxLarge=5]="xxxLarge"}(a=t.ResponsiveMode||(t.ResponsiveMode={}));var s,l=[479,639,1023,1365,1919,99999999];t.setResponsiveMode=function(e){s=e};t.withResponsiveMode=function(t){var e=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._updateComposedComponentRef=t._updateComposedComponentRef.bind(t);t.state={responsiveMode:t._getResponsiveMode()};return t}e.prototype.componentDidMount=function(){var t=this;this._events.on(window,"resize",function(){var e=t._getResponsiveMode();e!==t.state.responsiveMode&&t.setState({responsiveMode:e})})};e.prototype.componentWillUnmount=function(){this._events.dispose()};e.prototype.render=function(){var e=this.state.responsiveMode;return o.createElement(t,r.__assign({ref:this._updateComposedComponentRef,responsiveMode:e},this.props))};e.prototype._getResponsiveMode=function(){var t=a.small,e=n.getWindow();if(void 0!==e)try{for(;e.innerWidth>l[t];)t++}catch(e){t=a.large}else{if(void 0===s)throw new Error("Content was rendered in a server environment without providing a default responsive mode. Call setResponsiveMode to define what the responsive mode is.");t=s}return t};return e}(i.BaseDecorator);return n.hoistStatics(t,e)}});define("Nw",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.succeed=0]="succeed";e[e.unsupport=1]="unsupport";e[e.failed=2]="failed"}(t.AnalyticsResultStatus||(t.AnalyticsResultStatus={}))});define("Ne",["require","exports","at","Kz","V","Ng","Nf"],function(e,t,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AnalyticsActivity=function(e,t){var i=e.activity,r=e.loginUserEmail,o=m.getFileHoverCardStrings(),n="";"Access"===i.activityType?n=o.accessActivity:"Modified"===i.activityType&&(n=o.modifiedActivity);var a=i.actor.user.email===r?o.loginUserYou:i.actor.user.displayName,s=c.createElement("div",{className:"ms-AnalyticsActivity-UserName"},a),l=c.createElement("div",{className:"ms-AnalyticsActivity-UserAction"},n),d=p.formatToArray(o.activityTemplate,s,l);return c.createElement(u.ActivityItem,{activityPersonas:[{imageUrl:i.actor.user.image}],onRenderActivityDescription:function(){return c.createElement("div",{className:"ms-AnalyticsActivity"},d)},timeStamp:i.activityDateTime})}});define("Ng",["require","exports","at","mh","Kz","Nw","mo","d","Nj","Ni","xs","Nh"],function(e,t,P,k,I,T,w,E,D,A,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var F=new Date("0001-01-01T00:00:00-08:00");t.AnalyticsStats=function(e){var t,i=e.itemAnalytics,r=e.onClick,o=e.withFacePile,n=e.status,a=e.isCompact,s=e.disableViewerCount,l=void 0===s||s,d=e.ODBOptOutViewerList,c=void 0!==d&&d,u=R();if(n===T.AnalyticsResultStatus.failed){var p=E.getTheme();t=L("ErrorBadge",u.apiError,{color:p.palette.redDark})}var m=P.createElement("div",{className:"ms-AnalyticsStats--errorMessage"},t);if(t)return m;if(!(i&&i.activities&&i.viewCount&&i.viewerCount))return P.createElement(I.ActivityItem,{className:"ms-AnalyticsStats--stats",isCompact:!0});var h=i.viewCount,f=i.viewerCount,g=i.activities,y=i.incompleteData&&i.incompleteData.missingDataBeforeDateTime&&new Date(i.incompleteData.missingDataBeforeDateTime).getTime()!==F.getTime(),v=i.incompleteData&&i.incompleteData.wasThrottled,_=y?A.default.inCompleteMessage:v?A.default.throttledStateMessage:"",b=l?c?A.default.odbTeachingMessage:"":A.default.spoTeachingMessage,x=_||b,S=1<h?u.views:u.view,C=1<f?u.viewers:u.viewer;return a?o&&g&&0!==g.length?P.createElement(k.Link,{className:"ms-AnalyticsStats--stats--statsLink",onClick:r},P.createElement(I.ActivityItem,{activityPersonas:0!==g.length?g.slice(0,3).map(function(e){return{imageUrl:e&&e.actor&&e.actor.user&&e.actor.user.image}}).reverse():function(e){var t=Math.min(3,e);if(0===t)return;for(var i=[],r=0;r<t;r++)i.push({imageUrl:D.IMAGE_LINK});return i}(f),activityDescriptionText:h+" "+S,isCompact:!0})):P.createElement("div",{className:"ms-AnalyticsStats-views-noLink"},h+" "+S,P.createElement("span",{className:"ms-AnalyticsStats--viewsDivider-noDot"}),f+" "+C,x&&P.createElement(M.TooltipHost,{content:x},P.createElement(w.Icon,{className:"ms-AnalyticsStats--TeachingMessage",iconName:"Info","aria-describedby":x}))):P.createElement("div",{className:"ms-AnalyticsStats--views"},h+" "+S,P.createElement("span",{className:"ms-AnalyticsStats--viewsDivider"}),f+" "+C,_&&P.createElement(M.TooltipHost,{content:_},P.createElement(w.Icon,{className:"ms-AnalyticsStats--Info",iconName:"Info","aria-describedby":_})))};t.AnalyticsStats.defaultProps={withFacePile:!1};function L(e,t,i){return P.createElement("div",{className:"ms-FileHoverCard-ErrorMessage"},P.createElement(w.Icon,{iconName:e,className:"ms-FileHoverCard-ErrorIcon",styles:{root:E.mergeStyles([{paddingRight:"8px",position:"relative"},i])}}),t)}t.getMessageSection=L;function R(){return{details:A.default.seeDetails,viewer:A.default.viewer,viewers:A.default.viewers,view:A.default.view,views:A.default.views,apiError:A.default.apiError,suggestion:A.default.suggestion,unsupportMessage:A.default.unsupportMessage,accessActivity:A.default.accessActivity,modifiedActivity:A.default.modifiedActivity,activityTemplate:A.default.activityTemplate,inCompleteDataMessage:A.default.inCompleteDataMessage,throttledMessage:A.default.throttledMessage,trendingItem:A.default.trendingItem,loginUserYou:A.default.you}}t.getFileHoverCardStrings=R});define("Nj",["require","exports","ap","Nk"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Nk",["require","exports","ap","aC","hs","bf"],function(e,a,s,p,l,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.IMAGE_LINK="/_layouts/15/userphoto.aspx?size=S&accountname=";var m=t.Killswitch.isActivated("1B23F399-20D5-4D78-9FE5-7FAC542E706E","1/30/2018","ItemAnalytics API transfer to vroom 2.1")?"v2.0":"v2.1",i=function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor}e.prototype.getItemAnalytics=function(e,t){void 0===t&&(t={});var i=t.apiVersion,r=void 0===i?m:i,o=t.skipToken,n=void 0===o?"":o,a=t.headers,s=void 0===a?{}:a,l=n?";$skiptoken="+n:"",d="GetItemAnalytics"+r,c=this._getBaseUrl(e);if(!c)return p.default.resolve();var u=""+(c+"/analytics/allTime?$expand=activities")+("v2.1"===r?"($filter=access%20ne%20null)":"($filter=ActivityType%20eq%20%27Access%27)")+l;return this._getAnalytics(d,u,e.getAccessToken&&e.getAccessToken(),s,r)};e.prototype.getLastSevenDaysItemAnalytics=function(e){var t=this._getBaseUrl(e);if(!t)return p.default.resolve();var i=t+"/analytics/lastSevenDays?$expand=activities($filter=ActivityType%20eq%20%27Access%27)";return this._getAnalytics("GetLastSevenDaysItemAnalytics",i,e.getAccessToken&&e.getAccessToken())};e.prototype.getItemAnalyticsByInterval=function(e,t,i,r){var o=m,n=t.toISOString(),a=i.toISOString();r=r||"day";var s=this._getBaseUrl(e)+"/"+("v2.1"===o?"oneDrive.getActivitiesByInterval":"getanalyticsbyinterval")+"?"+("v2.1"===o?"startDateTime="+n+"&endDateTime="+a+"&interval="+r:"startDateTime='"+n+"'&endDateTime='"+a+"'&interval='"+r+"'");return this._getAnalyticsByInterval("GetDailyItemAnalytics",s,e.getAccessToken&&e.getAccessToken(),o)};e.prototype._getAnalytics=function(e,t,i,r,o){var n=this;return this._dataRequestor.send({apiName:e,path:t,accessToken:i,headers:r,timeout:6e3}).then(function(e){"string"==typeof e.isTrending&&"True"===e.isTrending||"boolean"==typeof e.isTrending&&!0===e.isTrending?e.isTrending=!0:e.isTrending=!1;return"v2.1"===o?n._parseResponseV21(e):n._parseResponse(e)})};e.prototype._getAnalyticsByInterval=function(e,t,i,r){return this._dataRequestor.send({apiName:e,path:t,accessToken:i,timeout:6e3}).then(function(e){var t;"v2.1"===r?(e=e)&&e.value&&(t=e.value.map(o)):t=(e=e).Items;return t})};e.prototype._getBaseUrl=function(e){return e&&e.graphItemUrl?""+e.graphItemUrl:null};e.prototype.getFilesAnalytics=function(e,t,i){var r=this;return e&&t?this._dataRequestor.send({apiName:"getFilesAnalytics",useAuthorizationHeaders:!0,accessToken:i,apiVersion:"v2.1",path:t+"/oneDrive.search?$expand=analytics($expand=lastSevenDays)&$filter=(sharepointIds/listItemUniqueId eq '"+e.join("' or sharepointIds/listItemUniqueId eq '")+"')"}).then(function(e){return r._parseFilesAnalyticsResponse(e)}):p.default.resolve()};e.prototype._parseResponseV21=function(e){var t=e.activities,i=e.access,r=e.endDateTime,o=s.__rest(e,["activities","access","endDateTime"]),n=t&&t.map(function(e){var t=s.__rest(e,[]);return s.__assign({},t,{activityDateTime:l.getFriendlyDateTimeStringPast(l.iso8601DateTimeToJsDate(t.activityDateTime)),actor:s.__assign({},t.actor,{user:s.__assign({},t.actor.user,{image:a.IMAGE_LINK+t.actor.user.email})}),activityType:"Access"})});return s.__assign({},o,{activities:n,viewCount:i&&i.actionCount,viewerCount:i&&i.actorCount,lastActivityDateTime:r})};e.prototype._parseResponse=function(e){e.activities;var t=s.__rest(e,["activities"]),i=e.activities&&e.activities.map(function(e){var t=s.__rest(e,[]);t.activityDateTime=l.getFriendlyDateTimeStringPast(l.iso8601DateTimeToJsDate(t.activityDateTime));t.actor.user.image=a.IMAGE_LINK+t.actor.user.email;return t});return s.__assign({},t,{activities:i})};e.prototype._parseFilesAnalyticsResponse=function(e){var r=this,t=(e.value,s.__rest(e,["value"])),i=e.value.map(function(e){var t=e.analytics,i=s.__rest(e,["analytics"]);return s.__assign({},i,{analytics:{lastSevenDays:r._parseResponse(t.lastSevenDays)}})});return s.__assign({},t,{value:i})};return e}();a.ItemAnalyticsService=i;function o(e){return e&&{activity:{},incompleteData:{missingDataBeforeDateTime:e.endDateTime,wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},interval:void 0,isTrending:e.isTrending,startDateTime:e.startDateTime,viewCount:e.access&&e.access.actionCount,viewerCount:e.access&&e.access.actorCount}}});define("Nh",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:'@charset "UTF-8";.ms-AnalyticsStats--stats,.ms-AnalyticsStats--stats--statsLink{padding:8px 0 4px 0;height:28px;width:100%}.ms-AnalyticsStats--stats .ms-Link,.ms-AnalyticsStats--stats--statsLink .ms-Link{font-size:12px;font-weight:400;color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}html[dir=ltr] .ms-AnalyticsStats--stats .ms-ActivityItem-activityTypeIcon,html[dir=ltr] .ms-AnalyticsStats--stats--statsLink .ms-ActivityItem-activityTypeIcon{padding-right:2px}html[dir=rtl] .ms-AnalyticsStats--stats .ms-ActivityItem-activityTypeIcon,html[dir=rtl] .ms-AnalyticsStats--stats--statsLink .ms-ActivityItem-activityTypeIcon{padding-left:2px}.ms-AnalyticsStats--stats .ms-ActivityItem-activityContent,.ms-AnalyticsStats--stats--statsLink .ms-ActivityItem-activityContent{font-weight:600}html[dir=ltr] .ms-AnalyticsStats--stats .ms-ActivityItem-activityContent,html[dir=ltr] .ms-AnalyticsStats--stats--statsLink .ms-ActivityItem-activityContent{padding-left:8px}html[dir=rtl] .ms-AnalyticsStats--stats .ms-ActivityItem-activityContent,html[dir=rtl] .ms-AnalyticsStats--stats--statsLink .ms-ActivityItem-activityContent{padding-right:8px}.ms-AnalyticsStats--stats--statsLink :hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-Fabric .ms-AnalyticsStats--stats--statsLink::-moz-focus-inner{border:0}.ms-Fabric .ms-AnalyticsStats--stats--statsLink{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .ms-AnalyticsStats--stats--statsLink:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .ms-AnalyticsStats--stats--statsLink:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .ms-AnalyticsStats--stats--statsLink:focus:after{border-color:#37006e}}.ms-AnalyticsStats-views-noLink{padding:8px 0 4px 0;font-weight:400;font-size:12px}.ms-AnalyticsStats--views{padding-bottom:8px}.ms-AnalyticsStats--viewsDivider:before{content:' · '}.ms-AnalyticsStats--viewsDivider-noDot:before{content:'   ';padding:0 4px}.ms-AnalyticsStats--errorMessage{font-size:12px;font-weight:400;line-height:28px}.ms-FileHoverCard-ErrorIcon{vertical-align:bottom}.ms-AnalyticsStats--Info,.ms-AnalyticsStats--TeachingMessage{vertical-align:sub;padding:0 8px}"}])});define("Nf",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-AnalyticsActivity{width:240px;height:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.ms-AnalyticsActivity .ms-AnalyticsActivity-UserAction,.ms-AnalyticsActivity .ms-AnalyticsActivity-UserName{display:inline-block;content:attr(data-analytics-activity-start)}.ms-AnalyticsActivity .ms-AnalyticsActivity-UserName{content:attr(data-analytics-activity-start);color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:600}.ms-AnalyticsActivity .ms-AnalyticsActivity-UserAction{content:attr(data-analytics-activity-end)}.ms-ActivityItem-timeStamp{height:16px}"}])});define("Nc",["require","exports","ap","at","oR","o1","jP","Ne","Ng","Ng","Nd"],function(e,t,i,r,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentWillMount=function(){this._updateActivities(this.props)};t.prototype.componentWillUpdate=function(e){this._updateActivities(e)};t.prototype.render=function(){var e,t=this.props.itemAnalytics,i=d.getFileHoverCardStrings();t&&t.incompleteData&&t.incompleteData.wasThrottled&&(e=i.throttledMessage);return t?r.createElement("div",null,r.createElement(l.AnalyticsStats,{itemAnalytics:t,inComplete:!!e}),r.createElement(o.List,{items:this._activities,onRenderCell:this._onRenderCell})):r.createElement(u,null)};t.prototype._updateActivities=function(e){var t=d.getFileHoverCardStrings(),i=e.itemAnalytics;this._activities=i&&i.activities.map(function(e){return{activity:e,locStrings:t}})};t.prototype._onRenderCell=function(e,t){return r.createElement("div",{className:"ms-AnalyticsActivityList--activity"},r.createElement(s.AnalyticsActivity,{activity:e.activity,loginUserEmail:this.props.loginUserEmail}),this.props.moreActivities&&t===this._activities.length-1?r.createElement(u,{onLoaded:this.props.onLoadMoreActivities}):void 0)};i.__decorate([a.autobind],t.prototype,"_updateActivities",null);i.__decorate([a.autobind],t.prototype,"_onRenderCell",null);return t}(r.Component);t.AnalyticsActivityList=c;var u=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.componentDidMount=function(){this.props.onLoaded&&this.props.onLoaded()};e.prototype.render=function(){return r.createElement(n.Spinner,{size:n.SpinnerSize.large})};return e}(r.Component)});define("Nd",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-AnalyticsActivityList--activity{padding:8px 0}"}])});define("Nl",["require","exports","ap","at","Nt","Ng","Nn","Nm"],function(e,t,l,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AnalyticsActionBar=function(e){var t=e.items,i=e.farItems,r=e.analyticsStats,o=e.withFacePile,n=e.showActionBar,a=void 0===n||n,s=!(!r||!r.itemAnalytics&&!r.isNotSupported);return d.createElement("div",null,d.createElement("div",{className:"ms-AnalyticsActionBar--stats"},d.createElement(p.Shimmer,{width:o?35:50,isDataLoaded:s,lineElements:[{type:"line",height:8}]},d.createElement(u.AnalyticsStats,l.__assign({withFacePile:o,isCompact:!0},r)))),a&&d.createElement(c.CommandBar,{className:"ms-AnalyticsActionBar--bar",items:t,farItems:i}))}});define("Nt",["require","exports","ap","GE"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("GE",["require","exports","ap","GF"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("GF",["require","exports","ap","at","jP","o7","wt","ww","mo","d","xs","GG","jP"],function(e,t,y,v,_,b,x,m,S,C,h,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=i,k="overflow",r=function(t){y.__extends(e,t);function e(e){var r=t.call(this,e)||this;r._searchSurface=o.createRef();r._commandSurface=o.createRef();r._commandBarRegion=o.createRef();r._farCommandSurface=o.createRef();r._focusZone=o.createRef();r._overflow=o.createRef();r._onOverflowClick=function(e){r.state.expandedMenuItemKey===k?r._onContextMenuDismiss():r.setState({expandedMenuId:e.currentTarget.id,expandedMenuItemKey:k,contextualMenuProps:{items:r.state.renderedOverflowItems},contextualMenuTarget:e.currentTarget})};r._onContextMenuDismiss=function(e){var t=r._commandSurface.current;if(!e||!e.relatedTarget||t&&!t.contains(e.relatedTarget)){var i=r.state.contextualMenuProps;i&&i.onDismiss&&r.state.contextualMenuProps.onDismiss(e);r.setState({expandedMenuItemKey:void 0,contextualMenuProps:void 0,contextualMenuTarget:void 0})}else{e.stopPropagation();e.preventDefault()}};r.state=r._getStateFromProps(e);r._id=_.getId("CommandBar");return r}e.prototype.componentDidMount=function(){this._asyncMeasure();this._events.on(window,"resize",this._updateRenderedItems)};e.prototype.componentWillReceiveProps=function(e){this.setState(this._getStateFromProps(e));this._commandItemWidths=null};e.prototype.componentDidUpdate=function(e,t){this._commandItemWidths||this._asyncMeasure()};e.prototype.render=function(){var e,t=this,i=this.props,r=i.isSearchBoxVisible,o=i.searchPlaceholderText,n=i.className,a=this.state,s=a.renderedItems,l=a.contextualMenuProps,d=a.expandedMenuItemKey,c=a.expandedMenuId,u=a.renderedOverflowItems,p=a.contextualMenuTarget,m=a.renderedFarItems;r&&(e=v.createElement("div",{className:_.css("ms-CommandBarSearch",P.search),ref:this._searchSurface},v.createElement("input",{className:_.css("ms-CommandBarSearch-input",P.searchInput),type:"text",placeholder:o}),v.createElement("div",{className:_.css("ms-CommandBarSearch-iconWrapper ms-CommandBarSearch-iconSearchWrapper",P.searchIconWrapper,P.searchIconSearchWrapper)},v.createElement(S.Icon,{iconName:"Search"})),v.createElement("div",{className:_.css("ms-CommandBarSearch-iconWrapper ms-CommandBarSearch-iconClearWrapper",C.FontClassNames.small,P.searchIconWrapper,P.searchIconClearWrapper)},v.createElement(S.Icon,{iconName:"cancel"}))));var h,f=s.length+m.length+(u&&0<u.length?1:0),g=1;return v.createElement("div",{className:_.css("ms-CommandBar",P.root,n),ref:this._commandBarRegion},e,v.createElement(b.FocusZone,{componentRef:this._focusZone,className:P.container,direction:b.FocusZoneDirection.horizontal,role:"menubar"},v.createElement("div",{className:_.css("ms-CommandBar-primaryCommands",P.primaryCommands),ref:this._commandSurface},s.map(function(e){return t._renderItemInCommandBar(e,g++,f,d)}).concat(u&&u.length?[v.createElement("div",{className:_.css("ms-CommandBarItem",P.item),key:k,ref:this._overflow},v.createElement("button",{type:"button",id:this._id+k,className:_.css("ms-CommandBarItem-link",P.itemLink,(h={},h["is-expanded "+P.itemLinkIsExpanded]=d===k,h)),onClick:this._onOverflowClick,role:"menuitem","aria-expanded":this.state.expandedMenuItemKey===k,"aria-label":this.props.elipisisAriaLabel||"","aria-haspopup":!0,"aria-setsize":f,"aria-posinset":g++,"data-automation-id":"commandBarOverflow"},v.createElement(S.Icon,{className:_.css("ms-CommandBarItem-overflow",P.itemOverflow),iconName:"more"})))]:[])),v.createElement("div",{className:_.css("ms-CommandBar-sideCommands",P.sideCommands),ref:this._farCommandSurface},m.map(function(e){return t._renderItemInCommandBar(e,g++,f,d,!0)}))),l?v.createElement(x.ContextualMenu,y.__assign({className:_.css("ms-CommandBar-menuHost"),directionalHint:7},l,{target:p,labelElementId:c,onDismiss:this._onContextMenuDismiss})):null)};e.prototype.focus=function(){var e=this._focusZone.current;e&&e.focus()};e.prototype._renderItemInCommandBar=function(e,t,i,r,o){if(e.onRender)return v.createElement("div",{className:_.css("ms-CommandBarItem",P.item,e.className),key:e.key,ref:e.key},e.onRender(e,this._onContextMenuDismiss));var n=e.key||String(t),a=e.onClick||m.hasSubmenu(e),s=_.css(a?"ms-CommandBarItem-link "+P.itemLink:"ms-CommandBarItem-text "+P.itemText,!e.name&&"ms-CommandBarItem--noName "+P.itemLinkIsNoName,r===e.key&&"is-expanded "+P.itemLinkIsExpanded,e.inactive?P.inactive:""),l="";e.title&&(l=e.title);var d,c=!!e.icon||!!e.iconProps,u=!!e.name&&!e.iconOnly,p=e.ariaLabel||(e.iconOnly?e.name:void 0);d=e.href?v.createElement("a",y.__assign({},_.getNativeProps(e,_.anchorProperties.concat(["disabled"])),{id:this._id+e.key,className:s,href:e.disabled?void 0:e.href,onClick:this._onItemClick(e),title:"","aria-disabled":e.inactive,"data-command-key":n,"aria-haspopup":m.hasSubmenu(e),role:"menuitem","aria-label":p,"aria-setsize":i,"aria-posinset":t}),c?this._renderIcon(e):null,u&&v.createElement("span",{className:_.css("ms-CommandBarItem-commandText",P.itemCommandText)},e.name)):a?v.createElement("button",y.__assign({},_.getNativeProps(e,_.buttonProperties),{id:this._id+e.key,className:s,onClick:this._onItemClick(e),title:"","aria-disabled":e.inactive,"data-command-key":n,"aria-haspopup":m.hasSubmenu(e),"aria-expanded":m.hasSubmenu(e)?r===e.key:void 0,role:"menuitem","aria-label":p,"aria-setsize":i,"aria-posinset":t}),c?this._renderIcon(e):null,u&&v.createElement("span",{className:_.css("ms-CommandBarItem-commandText",P.itemCommandText)},e.name),m.hasSubmenu(e)?v.createElement(S.Icon,{className:_.css("ms-CommandBarItem-chevronDown",P.itemChevronDown),iconName:"ChevronDown"}):null):v.createElement("div",y.__assign({},_.getNativeProps(e,_.divProperties.concat(["disabled"])),{id:this._id+e.key,className:s,title:"","aria-disabled":e.inactive,"data-command-key":n,"aria-haspopup":m.hasSubmenu(e),"aria-label":p,"aria-setsize":i,"aria-posinset":t}),c?this._renderIcon(e):null,u&&v.createElement("span",{className:_.css("ms-CommandBarItem-commandText",P.itemCommandText),"aria-hidden":"true",role:"presentation"},e.name));e.iconOnly&&e.name?d=v.createElement(h.TooltipHost,{content:e.name},d):l&&(d=v.createElement(h.TooltipHost,{content:l},d));return v.createElement("div",{className:_.css("ms-CommandBarItem",P.item,e.className),key:n,ref:n},d)};e.prototype._renderIcon=function(e){var t=e.iconProps?e.iconProps:{iconName:e.icon},i="None"===t.iconName?"":"ms-CommandBarItem-iconColor "+P.itemIconColor,r=_.css("ms-CommandBarItem-icon",P.itemIcon,i,t.className);return v.createElement(S.Icon,y.__assign({},t,{className:r}))};e.prototype._asyncMeasure=function(){var e=this;this._async.requestAnimationFrame(function(){e._updateItemMeasurements();e._updateRenderedItems()})};e.prototype._updateItemMeasurements=function(){this._overflow.current||this.props.overflowItems&&this.props.overflowItems.length?this._overflowWidth=41.5:this._overflowWidth=0;this._commandItemWidths||(this._commandItemWidths={});for(var e=0;e<this.props.items.length;e++){var t=this.props.items[e];if(!this._commandItemWidths[t.key]){var i=this.refs[t.key];i&&(this._commandItemWidths[t.key]=i.getBoundingClientRect().width)}}};e.prototype._updateRenderedItems=function(){var e=this.props,t=e.items,i=e.overflowItems,r=this._commandSurface.current,o=this._farCommandSurface.current,n=this._commandBarRegion.current,a=this._searchSurface.current,s=t.slice(),l=i,d=0,c=i&&i.length;if(r&&n){var u=window.getComputedStyle(r),p=n.clientWidth-parseInt(u.marginLeft,10)-parseInt(u.marginRight,10);a&&(p-=a.getBoundingClientRect().width);o&&(p-=o.getBoundingClientRect().width);c&&(p-=this._overflowWidth);if(this._commandItemWidths){for(var m=0;m<s.length;m++){var h=s[m],f=this._commandItemWidths[h.key];if(p<=d+f){0<m&&!c&&p-d<41.5&&m--;l=s.splice(m).concat(i);break}d+=f}var g=this._getContextualMenuPropsAfterUpdate(s.concat(this.state.renderedFarItems),l);this.setState({renderedItems:s,renderedOverflowItems:l,expandedMenuItemKey:g?this.state.expandedMenuItemKey:void 0,contextualMenuProps:g,contextualMenuTarget:g?this.state.contextualMenuTarget:void 0})}else this._asyncMeasure()}};e.prototype._onItemClick=function(t){var i=this;return function(e){if(!t.inactive){t.key!==i.state.expandedMenuItemKey&&m.hasSubmenu(t)?i.setState({expandedMenuId:e.currentTarget.id,expandedMenuItemKey:t.key,contextualMenuProps:i._getContextualMenuPropsFromItem(t),contextualMenuTarget:e.currentTarget}):i._onContextMenuDismiss();t.onClick&&t.onClick(e,t)}}};e.prototype._getStateFromProps=function(e){return{renderedItems:e.items||[],contextualMenuProps:this._getContextualMenuPropsAfterUpdate(e.items.concat(e.farItems),e.overflowItems),renderedFarItems:e.farItems||void 0}};e.prototype._getContextualMenuPropsAfterUpdate=function(e,t){var i=this;if(this.state&&this.state.expandedMenuItemKey){if(this.state.expandedMenuItemKey===k)return{items:t};var r=e.filter(function(e){return e.key===i.state.expandedMenuItemKey});if(1===r.length)return this._getContextualMenuPropsFromItem(r[0])}};e.prototype._getContextualMenuPropsFromItem=function(e){return e.subMenuProps||e.items&&{items:e.items}};e.defaultProps={items:[],overflowItems:[],farItems:[]};return e}(_.BaseComponent);t.CommandBar=r});define("wt",["require","exports","ap","wu"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("wu",["require","exports","ap","wz","wy","wv"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t)});define("wz",["require","exports","ap","at","wy","o7","wF","jP","ww","yg","wE","wA","wv"],function(e,t,H,q,j,W,K,z,v,G,Q,r,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e){return e.subMenuProps?e.subMenuProps.items:e.items}t.getSubmenuItems=n;function Y(e){return e.some(function(e){return!!e.canCheck||!(!e.sectionProps||!e.sectionProps.items.some(function(e){return!0===e.canCheck}))})}t.canAnyMenuItemsCheck=Y;var i=function(t){H.__extends(e,t);function e(e){var r=t.call(this,e)||this;r._navigationIdleDelay=250;r.dismiss=function(e,t){var i=r.props.onDismiss;i&&i(e,t)};r._onKeyDown=function(e){if(27===e.which||e.altKey||e.metaKey||r._shouldCloseSubMenu(e)){r._isFocusingPreviousElement=!0;e.preventDefault();e.stopPropagation();r.dismiss(e)}};r._shouldCloseSubMenu=function(e){var t=z.getRTL()?39:37;return!(e.which!==t||!r.props.isSubMenu)&&(r._adjustedFocusZoneProps.direction===W.FocusZoneDirection.vertical||!!r._adjustedFocusZoneProps.checkForNoWrap&&!z.shouldWrapFocus(e.target,"data-no-horizontal-wrap"))};r._onMenuKeyDown=function(e){if(27===e.which||e.altKey||e.metaKey){r._isFocusingPreviousElement=!0;e.preventDefault();e.stopPropagation();r.dismiss(e)}else if(r._host){var t=38===e.which?z.getLastFocusable(r._host,r._host.lastChild,!0):40===e.which?z.getFirstFocusable(r._host,r._host.firstChild,!0):null;if(t){t.focus();e.preventDefault();e.stopPropagation()}}};r._onScroll=function(){if(r._isScrollIdle||void 0===r._scrollIdleTimeoutId)r._isScrollIdle=!1;else{r._async.clearTimeout(r._scrollIdleTimeoutId);r._scrollIdleTimeoutId=void 0}r._scrollIdleTimeoutId=r._async.setTimeout(function(){r._isScrollIdle=!0},r._navigationIdleDelay)};r._onMouseItemLeave=function(e,t){if(r._isScrollIdle){if(void 0!==r._enterTimerId){r._async.clearTimeout(r._enterTimerId);r._enterTimerId=void 0}void 0===r.state.expandedMenuItemKey&&(r._host.setActive?r._host.setActive():r._host.focus())}};r._onSubMenuDismiss=function(e,t){t?r.dismiss(e,t):r.setState({dismissedMenuItemKey:r.state.expandedMenuItemKey,expandedMenuItemKey:void 0,submenuTarget:void 0})};r.state={contextualMenuItems:void 0,subMenuId:z.getId("ContextualMenu")};r._warnDeprecations({targetPoint:"target",useTargetPoint:"target",arrowDirection:"focusZoneProps"});r._isFocusingPreviousElement=!1;r._isScrollIdle=!0;r._splitButtonContainers=new Map;return r}(i=e).prototype.componentWillUpdate=function(e){if(e.target!==this.props.target){var t=e.target;this._setTargetWindowAndElement(t)}if(e.hidden!==this.props.hidden)if(e.hidden)this._onMenuClosed();else{this._onMenuOpened();this._previousActiveElement=this._targetWindow?this._targetWindow.document.activeElement:null}};e.prototype.componentWillMount=function(){var e=this.props.target;this._setTargetWindowAndElement(e);this.props.hidden||(this._previousActiveElement=this._targetWindow?this._targetWindow.document.activeElement:null)};e.prototype.componentDidMount=function(){this.props.hidden||this._onMenuOpened()};e.prototype.componentWillUnmount=function(){var e=this;this._isFocusingPreviousElement&&this._previousActiveElement&&setTimeout(function(){e._previousActiveElement&&e._previousActiveElement.focus()},0);this.props.onMenuDismissed&&this.props.onMenuDismissed(this.props);this._events.dispose();this._async.dispose()};e.prototype.render=function(){var o=this,e=this.props.isBeakVisible,t=this.props,i=t.className,r=t.items,n=t.labelElementId,a=t.id,s=t.targetPoint,l=t.useTargetPoint,d=t.beakWidth,c=t.directionalHint,u=t.directionalHintForRTL,p=t.gapSpace,m=t.coverTarget,h=t.ariaLabel,f=t.doNotLayer,g=t.target,y=t.bounds,v=t.useTargetWidth,_=t.useTargetAsMinWidth,b=t.directionalHintFixed,x=t.shouldFocusOnMount,S=t.title,C=t.theme,P=t.calloutProps,k=t.onRenderSubMenu,I=void 0===k?this._onRenderSubMenu:k,T=t.focusZoneProps,w=this.props.getMenuClassNames||K.getContextualMenuClassNames;this._classNames=w(C,i);var E=function e(t){for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o.icon||o.iconProps)return!0;if(o.itemType===j.ContextualMenuItemType.Section&&o.sectionProps&&e(o.sectionProps.items))return!0}return!1}(r);this._adjustedFocusZoneProps=H.__assign({},T,{direction:this._getFocusZoneDirection()});var D,A=Y(r),M=this.state.expandedMenuItemKey?this._getSubmenuProps():null;e=void 0===e?this.props.responsiveMode<=G.ResponsiveMode.medium:e;var F=this._target;if((v||_)&&F&&F.offsetWidth){var L=F.getBoundingClientRect().width-2;v?D={width:L}:_&&(D={minWidth:L})}if(r&&0<r.length){for(var R=0,N=0,O=0,B=r;O<B.length;O++){var V=B[O];if(V.itemType!==j.ContextualMenuItemType.Divider&&V.itemType!==j.ContextualMenuItemType.Header){var U=V.customOnRenderListLength?V.customOnRenderListLength:1;N+=U}}return q.createElement(Q.Callout,H.__assign({},P,{target:l?s:g,isBeakVisible:e,beakWidth:d,directionalHint:c,directionalHintForRTL:u,gapSpace:p,coverTarget:m,doNotLayer:f,className:z.css("ms-ContextualMenu-Callout",P?P.className:void 0),setInitialFocus:x,onDismiss:this.props.onDismiss,onScroll:this._onScroll,bounds:y,directionalHintFixed:b,hidden:this.props.hidden}),q.createElement("div",{role:"menu","aria-label":h,"aria-labelledby":n,style:D,ref:function(e){return o._host=e},id:a,className:this._classNames.container,tabIndex:0,onKeyDown:this._onMenuKeyDown},S&&q.createElement("div",{className:this._classNames.title,role:"heading","aria-level":1}," ",S," "),r&&r.length?q.createElement(W.FocusZone,H.__assign({},this._adjustedFocusZoneProps,{className:this._classNames.root,isCircularNavigation:!0,handleTabKey:1}),q.createElement("ul",{role:"presentation",className:this._classNames.list,onKeyDown:this._onKeyDown},r.map(function(e,t){var i=o._renderMenuItem(e,t,R,N,A,E);if(e.itemType!==j.ContextualMenuItemType.Divider&&e.itemType!==j.ContextualMenuItemType.Header){var r=e.customOnRenderListLength?e.customOnRenderListLength:1;R+=r}return i}))):null,M&&I(M,this._onRenderSubMenu)))}return null};e.prototype._onMenuOpened=function(){this._events.on(this._targetWindow,"resize",this.dismiss);this.props.onMenuOpened&&this.props.onMenuOpened(this.props)};e.prototype._onMenuClosed=function(){var e=this;this._events.off(this._targetWindow,"resize",this.dismiss);this._previousActiveElement&&this._async.setTimeout(function(){e._previousActiveElement&&e._previousActiveElement.focus()},0)};e.prototype._getFocusZoneDirection=function(){var e=this.props,t=e.arrowDirection,i=e.focusZoneProps;return void 0!==t?t:i&&void 0!==i.direction?i.direction:W.FocusZoneDirection.vertical};e.prototype._onRenderSubMenu=function(e){return q.createElement(i,H.__assign({},e))};e.prototype._renderMenuItem=function(e,t,i,r,o,n){var a=[],s=this._getIconProps(e),l=e.itemType===j.ContextualMenuItemType.Divider?e.className:void 0,d=e.submenuIconProps?e.submenuIconProps.className:"",c=(e.getItemClassNames||K.getItemClassNames)(this.props.theme,this._isItemDisabled(e),this.state.expandedMenuItemKey===e.key,!!v.getIsChecked(e),!!e.href,"None"!==s.iconName,e.className,l,s.className,d);"-"===e.name&&(e.itemType=j.ContextualMenuItemType.Divider);switch(e.itemType){case j.ContextualMenuItemType.Divider:a.push(this._renderSeparator(t,c));break;case j.ContextualMenuItemType.Header:a.push(this._renderSeparator(t,c));var u=this._renderHeaderMenuItem(e,c,t,o,n);a.push(this._renderListItem(u,e.key||t,c,e.title));break;case j.ContextualMenuItemType.Section:a.push(this._renderSectionItem(e,c,t,o,n));break;default:var p=this._renderNormalItem(e,c,t,i,r,o,n);a.push(this._renderListItem(p,e.key||t,c,e.title))}return a};e.prototype._renderSectionItem=function(e,t,i,r,o){var n=this,a=e.sectionProps;if(a){var s;if(a.title){var l={key:"section-"+a.title+"-title",itemType:j.ContextualMenuItemType.Header,name:a.title};s=this._renderHeaderMenuItem(l,t,i,r,o)}return a.items&&0<a.items.length?q.createElement("li",{role:"presentation",key:a.key},q.createElement("div",{role:"group"},q.createElement("ul",{className:this._classNames.list},a.topDivider&&this._renderSeparator(i,t,!0,!0),s&&this._renderListItem(s,e.key||i,t,e.title),a.items.map(function(e,t){return n._renderMenuItem(e,t,t,a.items.length,r,o)}),a.bottomDivider&&this._renderSeparator(i,t,!1,!0)))):void 0}};e.prototype._renderListItem=function(e,t,i,r){return q.createElement("li",{role:"presentation",title:r,key:t,className:i.item},e)};e.prototype._renderSeparator=function(e,t,i,r){return r||0<e?q.createElement("li",{role:"separator",key:"separator-"+e+(void 0===i?"":i?"-top":"-bottom"),className:t.divider}):null};e.prototype._renderNormalItem=function(e,t,i,r,o,n,a){return e.onRender?[e.onRender(H.__assign({"aria-posinset":r+1,"aria-setsize":o},e),this.dismiss)]:e.href?this._renderAnchorMenuItem(e,t,i,r,o,n,a):e.split&&v.hasSubmenu(e)?this._renderSplitButton(e,t,i,r,o,n,a):this._renderButtonItem(e,t,i,r,o,n,a)};e.prototype._renderHeaderMenuItem=function(e,t,i,r,o){var n=this.props.contextualMenuItemAs,a=void 0===n?_.ContextualMenuItem:n;return q.createElement("div",{className:this._classNames.header,style:e.style,role:"heading","aria-level":this.props.title?2:1},q.createElement(a,{item:e,classNames:t,index:i,onCheckmarkClick:r?this._onItemClick:void 0,hasIcons:o}))};e.prototype._renderAnchorMenuItem=function(e,t,i,r,o,n,a){var s=this.state.expandedMenuItemKey,l=this.props.contextualMenuItemAs,d=void 0===l?_.ContextualMenuItem:l,c=e.rel;e.target&&"_blank"===e.target.toLowerCase()&&(c=c||"nofollow noopener noreferrer");var u=this._getSubMenuId(e),p=v.hasSubmenu(e);return q.createElement("div",null,q.createElement("a",H.__assign({},z.getNativeProps(e,z.anchorProperties),{href:e.href,target:e.target,rel:c,className:t.root,role:"menuitem","aria-owns":e.key===s?u:void 0,"aria-haspopup":p||void 0,"aria-expanded":p?e.key===s:void 0,"aria-posinset":r+1,"aria-setsize":o,"aria-disabled":this._isItemDisabled(e),style:e.style,onClick:this._onAnchorClick.bind(this,e),onMouseEnter:this._onItemMouseEnter.bind(this,e),onMouseLeave:this._onMouseItemLeave.bind(this,e),onKeyDown:p?this._onItemKeyDown.bind(this,e):null}),q.createElement(d,{item:e,classNames:t,index:i,onCheckmarkClick:n?this._onItemClick:void 0,hasIcons:a})))};e.prototype._renderButtonItem=function(t,e,i,r,o,n,a){var s=this,l=this.state.expandedMenuItemKey,d=this.props.contextualMenuItemAs,c=void 0===d?_.ContextualMenuItem:d,u=this._getSubMenuId(t),p="";t.ariaLabel?p=t.ariaLabel:t.name&&(p=t.name);var m=v.getIsChecked(t),h=null!==m?"menuitemcheckbox":"menuitem",f=v.hasSubmenu(t),g=z.getNativeProps(t,z.buttonProperties);delete g.disabled;var y={className:e.root,onClick:this._onItemClick.bind(this,t),onKeyDown:f?this._onItemKeyDown.bind(this,t):null,onMouseEnter:this._onItemMouseEnter.bind(this,t),onMouseLeave:this._onMouseItemLeave.bind(this,t),onMouseDown:function(e){return s._onItemMouseDown(t,e)},onMouseMove:this._onItemMouseMove.bind(this,t),href:t.href,title:t.title,"aria-label":p,"aria-haspopup":f||void 0,"aria-owns":t.key===l?u:void 0,"aria-expanded":f?t.key===l:void 0,"aria-checked":!!m,"aria-posinset":r+1,"aria-setsize":o,"aria-disabled":this._isItemDisabled(t),role:t.role||h,style:t.style};return q.createElement("button",H.__assign({},g,y),q.createElement(c,{item:t,classNames:e,index:i,onCheckmarkClick:n?this._onItemClick:void 0,hasIcons:a}))};e.prototype._renderSplitButton=function(t,e,i,r,o,n,a){var s=this;return q.createElement("div",{ref:function(e){return s._splitButtonContainers.set(t.key,e)},role:"button","aria-labelledby":t.ariaLabel,className:e.splitContainer,"aria-disabled":this._isItemDisabled(t),"aria-haspopup":!0,"aria-describedby":t.ariaDescription,"aria-checked":t.isChecked||t.checked,"aria-posinset":r+1,"aria-setsize":o,onMouseEnter:this._onItemMouseEnter.bind(this,H.__assign({},t,{subMenuProps:null,items:null})),onMouseLeave:this._onMouseItemLeave.bind(this,H.__assign({},t,{subMenuProps:null,items:null})),onMouseMove:this._onItemMouseMove.bind(this,H.__assign({},t,{subMenuProps:null,items:null})),onKeyDown:this._onSplitContainerItemKeyDown.bind(this,t),onClick:this._executeItemClick.bind(this,t),tabIndex:0,"data-is-focusable":!0},this._renderSplitPrimaryButton(t,e,i,n,a),this._renderSplitDivider(t),this._renderSplitIconButton(t,e,i))};e.prototype._renderSplitPrimaryButton=function(e,t,i,r,o){var n=null!==v.getIsChecked(e)?"menuitemcheckbox":"menuitem",a=this.props.contextualMenuItemAs,s=void 0===a?_.ContextualMenuItem:a,l={key:e.key,disabled:this._isItemDisabled(e)||e.primaryDisabled,name:e.name,className:t.splitPrimary,role:e.role||n,canCheck:e.canCheck,isChecked:e.isChecked,checked:e.checked,icon:e.icon,iconProps:e.iconProps,"data-is-focusable":!1,"aria-hidden":!0};return q.createElement("button",z.getNativeProps(l,z.buttonProperties),q.createElement(s,{item:l,classNames:t,index:i,onCheckmarkClick:r?this._onItemClick:void 0,hasIcons:o}))};e.prototype._onSplitContainerItemKeyDown=function(e,t){if(13===t.which){this._executeItemClick(e,t);t.preventDefault();t.stopPropagation()}else this._onItemKeyDown(e,t)};e.prototype._renderSplitIconButton=function(t,e,i){var r=this,o=this.props.contextualMenuItemAs,n=void 0===o?_.ContextualMenuItem:o,a={onClick:this._onSplitItemClick.bind(this,t),disabled:this._isItemDisabled(t),className:e.splitMenu,subMenuProps:t.subMenuProps,submenuIconProps:t.submenuIconProps,split:!0};return q.createElement("button",z.assign({},z.getNativeProps(a,z.buttonProperties),{onMouseEnter:this._onItemMouseEnter.bind(this,t),onMouseLeave:this._onMouseItemLeave.bind(this,t),onMouseDown:function(e){return r._onItemMouseDown(t,e)},onMouseMove:this._onItemMouseMove.bind(this,t),"data-is-focusable":!1,"aria-hidden":!0}),q.createElement(n,{item:a,classNames:e,index:i,hasIcons:!1}))};e.prototype._renderSplitDivider=function(e){var t=e.getSplitButtonVerticalDividerClassNames||K.getSplitButtonVerticalDividerClassNames;return q.createElement(r.VerticalDivider,{getClassNames:t})};e.prototype._getIconProps=function(e){return e.iconProps?e.iconProps:{iconName:e.icon}};e.prototype._onItemMouseEnter=function(e,t){this._isScrollIdle&&this._updateFocusOnMouseEvent(e,t)};e.prototype._onItemMouseMove=function(e,t){var i=t.currentTarget;this._isScrollIdle&&void 0===this._enterTimerId&&i!==this._targetWindow.document.activeElement&&this._updateFocusOnMouseEvent(e,t)};e.prototype._updateFocusOnMouseEvent=function(t,e){var i=this,r=e.currentTarget,o=this.props.subMenuHoverDelay,n=void 0===o?this._navigationIdleDelay:o;if(t.key!==this.state.expandedMenuItemKey){if(void 0!==this._enterTimerId){this._async.clearTimeout(this._enterTimerId);this._enterTimerId=void 0}void 0===this.state.expandedMenuItemKey&&r.focus();if(v.hasSubmenu(t)){e.stopPropagation();this._enterTimerId=this._async.setTimeout(function(){r.focus();var e=i._splitButtonContainers.get(t.key);i._onItemSubMenuExpand(t,t.split&&e?e:r);i._enterTimerId=void 0},this._navigationIdleDelay)}else this._enterTimerId=this._async.setTimeout(function(){i._onSubMenuDismiss(e);r.focus();i._enterTimerId=void 0},n)}};e.prototype._onItemMouseDown=function(e,t){e.onMouseDown&&e.onMouseDown(e,t)};e.prototype._onItemClick=function(e,t){this._onItemClickBase(e,t,t.currentTarget)};e.prototype._onSplitItemClick=function(e,t){var i=this._splitButtonContainers.get(e.key);this._onItemClickBase(e,t,i||t.currentTarget)};e.prototype._onItemClickBase=function(e,t,i){var r=n(e);v.hasSubmenu(e)||r&&r.length?e.key===this.state.expandedMenuItemKey?this._onSubMenuDismiss(t):this._onItemSubMenuExpand(e,i):this._executeItemClick(e,t);t.stopPropagation();t.preventDefault()};e.prototype._onAnchorClick=function(e,t){this._executeItemClick(e,t);t.stopPropagation()};e.prototype._executeItemClick=function(e,t){if(!e.disabled&&!e.isDisabled){var i=!1;e.onClick?i=!!e.onClick(t,e):this.props.onItemClick&&(i=!!this.props.onItemClick(t,e));(i||!t.defaultPrevented)&&this.dismiss(t,!0)}};e.prototype._onItemKeyDown=function(e,t){var i=z.getRTL()?37:39;if(t.which===i&&!e.disabled){this._onItemSubMenuExpand(e,t.currentTarget);t.preventDefault()}};e.prototype._onItemSubMenuExpand=function(e,t){if(this.state.expandedMenuItemKey!==e.key){this.state.expandedMenuItemKey&&this._onSubMenuDismiss();t.focus();this.setState({expandedMenuItemKey:e.key,submenuTarget:t})}};e.prototype._getSubmenuProps=function(){var e=this.state,t=e.submenuTarget,i=e.expandedMenuItemKey,r=this._findItemByKey(i),o=null;if(r){o={items:n(r),target:t,onDismiss:this._onSubMenuDismiss,isSubMenu:!0,id:this.state.subMenuId,shouldFocusOnMount:!0,directionalHint:z.getRTL()?8:11,className:this.props.className,gapSpace:0,isBeakVisible:!1};r.subMenuProps&&z.assign(o,r.subMenuProps)}return o};e.prototype._findItemByKey=function(e){var t=this.props.items;return this._findItemByKeyFromItems(e,t)};e.prototype._findItemByKeyFromItems=function(e,t){for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o.itemType===j.ContextualMenuItemType.Section&&o.sectionProps){var n=this._findItemByKeyFromItems(e,o.sectionProps.items);if(n)return n}else if(o.key&&o.key===e)return o}};e.prototype._setTargetWindowAndElement=function(e){if(e)if("string"==typeof e){var t=z.getDocument();this._target=t?t.querySelector(e):null;this._targetWindow=z.getWindow()}else if(e.stopPropagation){this._targetWindow=z.getWindow(e.toElement);this._target=e}else if(void 0!==e.x&&void 0!==e.y){this._targetWindow=z.getWindow();this._target=e}else{var i=e;this._targetWindow=z.getWindow(i);this._target=e}else this._targetWindow=z.getWindow()};e.prototype._isItemDisabled=function(e){return!(!e.isDisabled&&!e.disabled)};e.prototype._getSubMenuId=function(e){var t=this.state.subMenuId;e.subMenuProps&&e.subMenuProps.id&&(t=e.subMenuProps.id);return t};e.defaultProps={items:[],shouldFocusOnMount:!0,gapSpace:0,directionalHint:7,beakWidth:16,getMenuClassNames:K.getContextualMenuClassNames};return e=i=H.__decorate([z.customizable("ContextualMenu",["theme"]),G.withResponsiveMode],e);var i}(z.BaseComponent);t.ContextualMenu=i});define("wy",["require","exports","wh"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DirectionalHint=i.DirectionalHint;!function(e){e[e.Normal=0]="Normal";e[e.Divider=1]="Divider";e[e.Header=2]="Header";e[e.Section=3]="Section"}(t.ContextualMenuItemType||(t.ContextualMenuItemType={}))});define("wF",["require","exports","jP","d","wG","wD"],function(e,t,i,u,p,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSplitButtonVerticalDividerClassNames=i.memoizeFunction(function(e){return u.mergeStyleSets(r.getDividerClassNames(e),{divider:{height:16,width:1}})});t.getContextualMenuClassNames=i.memoizeFunction(function(e,t){var i=p.getStyles(e);return u.mergeStyleSets({container:["ms-ContextualMenu-container",i.container,t,[{selectors:{":focus":{outline:0}}}]],root:["ms-ContextualMenu is-open",i.root],list:["ms-ContextualMenu-list is-open",i.list],header:["ms-ContextualMenu-header",i.header],title:i.title})});t.getItemClassNames=i.memoizeFunction(function(e,t,i,r,o,n,a,s,l,d){var c=p.getMenuItemStyles(e);return u.mergeStyleSets({item:["ms-ContextualMenu-item",c.item,a],divider:["ms-ContextualMenu-divider",c.divider,s],root:["ms-ContextualMenu-link",c.root,r&&["is-checked",c.rootChecked],o&&c.anchorLink,i&&["is-expanded",c.rootExpanded],t&&["is-disabled",c.rootDisabled],!t&&!i&&[{selectors:{":hover":c.rootHovered,":active":c.rootPressed,".ms-Fabric--isFocusVisible &:focus, .ms-Fabric--isFocusVisible &:focus:hover":c.rootFocused,".ms-Fabric--isFocusVisible &:hover":{background:"inherit;"}}}]],splitPrimary:[c.root,r&&["is-checked",c.rootChecked],t&&["is-disabled",c.rootDisabled],!t&&!r&&[{selectors:{":hover":c.rootHovered,":active":c.rootPressed,".ms-Fabric--isFocusVisible &:focus, .ms-Fabric--isFocusVisible &:focus:hover":c.rootFocused,".ms-Fabric--isFocusVisible &:hover":{background:"inherit;"}}}]],splitMenu:[c.root,{width:32},i&&["is-expanded",c.rootExpanded],t&&["is-disabled",c.rootDisabled],!t&&!i&&[{selectors:{":hover":c.rootHovered,":active":c.rootPressed,".ms-Fabric--isFocusVisible &:focus, .ms-Fabric--isFocusVisible &:focus:hover":c.rootFocused,".ms-Fabric--isFocusVisible &:hover":{background:"inherit;"}}}]],linkContent:["ms-ContextualMenu-linkContent",c.linkContent],linkContentMenu:["ms-ContextualMenu-linkContent",c.linkContent,{justifyContent:"center"}],icon:["ms-ContextualMenu-icon",n&&c.iconColor,c.icon,l,t&&["is-disabled",c.iconDisabled]],checkmarkIcon:["ms-ContextualMenu-checkmarkIcon",n&&c.checkmarkIcon,c.icon,l],subMenuIcon:["ms-ContextualMenu-submenuIcon",c.subMenuIcon,d],label:["ms-ContextualMenu-itemText",c.label],splitContainer:[c.splitButtonFlexContainer,!t&&!r&&[{selectors:{".ms-Fabric--isFocusVisible &:focus, .ms-Fabric--isFocusVisible &:focus:hover":c.rootFocused}}]]})})});define("wG",["require","exports","ap","d","jP"],function(e,t,u,p,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m="32px",h=i.memoizeFunction(function(){return{selectors:(e={},e[p.HighContrastSelector]={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText",MsHighContrastAdjust:"none"},e)};var e});t.getMenuItemStyles=i.memoizeFunction(function(e){var t,i,r,o,n=e.semanticColors,a=e.fonts,s=n.menuItemBackgroundHovered,l=n.menuItemBackgroundChecked,d=n.bodyDivider,c={item:[a.medium,{color:n.bodyText,position:"relative",boxSizing:"border-box"}],divider:{display:"block",height:"1px",backgroundColor:d,position:"relative"},root:[p.getFocusStyle(e),a.medium,{color:"inherit",backgroundColor:"transparent",border:"none",width:"100%",height:m,lineHeight:m,display:"block",cursor:"pointer",padding:"0px 6px",textAlign:"left"}],rootDisabled:{color:n.disabledBodyText,cursor:"default",pointerEvents:"none"},rootHovered:u.__assign({backgroundColor:s},h()),rootFocused:u.__assign({backgroundColor:s},h()),rootChecked:u.__assign({},h()),rootPressed:u.__assign({backgroundColor:l},h()),rootExpanded:u.__assign({backgroundColor:l,color:n.bodyTextChecked},h()),linkContent:{whiteSpace:"nowrap",height:"inherit",display:"flex",alignItems:"center",maxWidth:"100%"},anchorLink:{padding:"0px 6px",textRendering:"auto",color:"inherit",letterSpacing:"normal",wordSpacing:"normal",textTransform:"none",textIndent:"0px",textShadow:"none",textDecoration:"none",boxSizing:"border-box"},label:{margin:"0 4px",verticalAlign:"middle",display:"inline-block",flexGrow:"1",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},icon:{display:"inline-block",minHeight:"1px",maxHeight:m,width:"14px",margin:"0 4px",verticalAlign:"middle",flexShrink:"0"},iconColor:{color:n.menuIcon,selectors:(t={},t[p.HighContrastSelector]={color:"inherit"},t["$root:hover &"]={selectors:(i={},i[p.HighContrastSelector]={color:"HighlightText"},i)},t["$root:focus &"]={selectors:(r={},r[p.HighContrastSelector]={color:"HighlightText"},r)},t)},iconDisabled:{color:n.disabledBodyText},checkmarkIcon:{color:n.bodySubtext,selectors:(o={},o[p.HighContrastSelector]={color:"HighlightText"},o)},subMenuIcon:{height:m,lineHeight:m,textAlign:"center",display:"inline-block",verticalAlign:"middle",flexShrink:"0",fontSize:p.FontSizes.mini},splitButtonFlexContainer:[p.getFocusStyle(e),{display:"flex",height:m,flexWrap:"nowrap",justifyContent:"center",alignItems:"center"}],splitButtonSeparator:{}};return p.concatStyleSets(c)});t.getStyles=i.memoizeFunction(function(e){var t=e.semanticColors,i=e.fonts,r=t.bodyBackground,o=t.menuHeader,n={root:{backgroundColor:r,minWidth:"180px"},container:{},list:{listStyleType:"none",margin:"0",padding:"0",lineHeight:"0"},title:{fontSize:"16px",paddingRight:"14px",paddingLeft:"14px",paddingBottom:"5px",paddingTop:"5px",backgroundColor:e.palette.neutralLight},header:[i.small,{fontWeight:p.FontWeights.semibold,color:o,background:"none",border:"none",height:m,lineHeight:m,cursor:"default",padding:"0px 6px",userSelect:"none",textAlign:"left"}]};return p.concatStyleSets(n)})});define("wD",["require","exports","jP","d"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDividerClassNames=i.memoizeFunction(function(e){return r.mergeStyleSets({wrapper:{display:"inline-flex",height:"100%",alignItems:"center"},divider:{width:1,height:"100%",backgroundColor:e.palette.neutralTertiaryAlt}})})});define("ww",["require","exports","ap","wx"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("wx",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getIsChecked=function(e){return e.canCheck?!(!e.isChecked&&!e.checked):"boolean"==typeof e.isChecked?e.isChecked:"boolean"==typeof e.checked?e.checked:null};t.hasSubmenu=function(e){return!(!e.subMenuProps&&!e.items)}});define("wA",["require","exports","ap","wB"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("wB",["require","exports","ap","wC"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("wC",["require","exports","at","wD","d"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VerticalDivider=function(e){var t=n.getTheme(),i=e.getClassNames?e.getClassNames(t):o.getDividerClassNames(t);return r.createElement("span",{className:i.wrapper},r.createElement("span",{className:i.divider}))}});define("wv",["require","exports","ap","at","ww","jP","mo"],function(e,t,f,g,y,v,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextualMenuItem=function(e){var t,i,r,o,n,a,s,l,d,c,u,p,m=e.item,h=e.classNames;return g.createElement("div",{className:m.split?h.linkContentMenu:h.linkContent},function(e){var t=e.onCheckmarkClick,i=e.item,r=e.classNames,o=y.getIsChecked(i);if(t)return g.createElement(_.Icon,{iconName:o?"CheckMark":"",className:r.checkmarkIcon,onClick:function(e){return t(i,e)}});return null}(e),(l=(s=e).item,d=s.hasIcons,c=s.classNames,u=l.iconProps,p=l.icon,d?l.onRenderIcon?l.onRenderIcon(s):u?g.createElement(_.Icon,f.__assign({},u,{className:c.icon})):g.createElement(_.Icon,{iconName:p,className:c.icon}):null),(n=(o=e).item,a=o.classNames,n.name?g.createElement("span",{className:a.label},n.name):null),(i=(t=e).item,r=t.classNames,y.hasSubmenu(i)?g.createElement(_.Icon,f.__assign({iconName:v.getRTL()?"ChevronLeft":"ChevronRight"},i.submenuIconProps,{className:r.subMenuIcon})):null))}});define("GG",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_fa6c14f0{font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";position:relative;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";height:40px;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.container_fa6c14f0{display:-webkit-box;display:-ms-flexbox;display:flex}.primaryCommands_fa6c14f0{overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;vertical-align:top;line-height:40px;max-width:100%;margin:0 20px}.sideCommands_fa6c14f0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}[dir='ltr'] .sideCommands_fa6c14f0{right:0px}[dir='rtl'] .sideCommands_fa6c14f0{left:0px}html[dir='ltr'] .sideCommands_fa6c14f0{text-align:right}html[dir='rtl'] .sideCommands_fa6c14f0{text-align:left}html[dir='ltr'] .sideCommands_fa6c14f0{padding-right:20px}html[dir='rtl'] .sideCommands_fa6c14f0{padding-left:20px}.item_fa6c14f0{display:inline-block;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";height:40px;outline:transparent;vertical-align:top}.item_fa6c14f0:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.itemChevronDown_fa6c14f0,.itemCommandText_fa6c14f0{display:inline-block;padding:0 4px;vertical-align:top}.itemText_fa6c14f0{font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";position:relative;background:none;border:none;line-height:40px;min-width:20px;text-align:center;padding:0 4px;display:block;height:100%}.itemText_fa6c14f0::-moz-focus-inner{border:0}.itemText_fa6c14f0{outline:transparent}.itemText_fa6c14f0{position:relative}.ms-Fabric--isFocusVisible .itemText_fa6c14f0:focus:after{content:'';position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#000000"},{rawString:"}.itemText_fa6c14f0.itemLinkIsNoName_fa6c14f0{padding:0 8px}.itemText_fa6c14f0[disabled]{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";cursor:default;pointer-events:none}.itemText_fa6c14f0[disabled] .itemIcon_fa6c14f0,.itemText_fa6c14f0[disabled] .itemChevronDown_fa6c14f0{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.itemLink_fa6c14f0{font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";position:relative;background:none;border:none;line-height:40px;min-width:20px;text-align:center;padding:0 4px;display:block;height:100%;cursor:pointer}.itemLink_fa6c14f0::-moz-focus-inner{border:0}.itemLink_fa6c14f0{outline:transparent}.itemLink_fa6c14f0{position:relative}.ms-Fabric--isFocusVisible .itemLink_fa6c14f0:focus:after{content:'';position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#000000"},{rawString:"}.itemLink_fa6c14f0.itemLinkIsNoName_fa6c14f0{padding:0 8px}.itemLink_fa6c14f0[disabled]{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";cursor:default;pointer-events:none}.itemLink_fa6c14f0[disabled] .itemIcon_fa6c14f0,.itemLink_fa6c14f0[disabled] .itemChevronDown_fa6c14f0{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}@media screen and (-ms-high-contrast: active){.itemLink_fa6c14f0:hover::-moz-focus-inner,.itemLink_fa6c14f0.itemLinkIsExpanded_fa6c14f0::-moz-focus-inner{border:0}.itemLink_fa6c14f0:hover,.itemLink_fa6c14f0.itemLinkIsExpanded_fa6c14f0{outline:transparent}.itemLink_fa6c14f0:hover,.itemLink_fa6c14f0.itemLinkIsExpanded_fa6c14f0{position:relative}.itemLink_fa6c14f0:hover:after,.itemLink_fa6c14f0.itemLinkIsExpanded_fa6c14f0:after{content:'';position:absolute;top:0px;right:0px;bottom:0px;left:0px;pointer-events:none;border:1px solid WindowText}}.itemLink_fa6c14f0:hover:not([disabled]){color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.itemLink_fa6c14f0:hover:not([disabled]) .itemIcon_fa6c14f0{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.itemLink_fa6c14f0:hover:not([disabled]) .itemChevronDown_fa6c14f0{color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3c3c3c"},{rawString:"}.itemLink_fa6c14f0:hover:not([disabled]) .itemOverflow_fa6c14f0{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.itemLink_fa6c14f0.itemLinkIsExpanded_fa6c14f0{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:";color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.itemLink_fa6c14f0.itemLinkIsExpanded_fa6c14f0 .itemIcon_fa6c14f0{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.itemLink_fa6c14f0.itemLinkIsExpanded_fa6c14f0 .itemChevronDown_fa6c14f0{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.itemLink_fa6c14f0.itemLinkIsExpanded_fa6c14f0 .itemOverflow_fa6c14f0{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.itemLink_fa6c14f0.itemLinkIsExpanded_fa6c14f0:hover{background-color:"},{theme:"neutralQuaternary",defaultValue:"#d0d0d0"},{rawString:"}.itemLink_fa6c14f0.inactive_fa6c14f0{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";cursor:default;pointer-events:none}.itemLink_fa6c14f0.inactive_fa6c14f0 .itemIcon_fa6c14f0{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.itemIcon_fa6c14f0{font-size:16px;padding:0 4px}.itemIconColor_fa6c14f0{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.itemChevronDown_fa6c14f0{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px}.itemOverflow_fa6c14f0{font-size:18px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding:0 7px}.search_fa6c14f0{width:208px;max-width:208px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";height:40px;position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;border-color:transparent}html[dir='ltr'] .search_fa6c14f0{float:left}html[dir='rtl'] .search_fa6c14f0{float:right}html[dir='ltr'] .search_fa6c14f0{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir='rtl'] .search_fa6c14f0{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}@media screen and (-ms-high-contrast: active){.search_fa6c14f0{z-index:10}html[dir='ltr'] .search_fa6c14f0{border-right:1px solid WindowText}html[dir='rtl'] .search_fa6c14f0{border-left:1px solid WindowText}}.search_fa6c14f0:before{position:absolute;content:' ';right:0;bottom:0;left:0;margin:0 8px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.search_fa6c14f0:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast: active){.search_fa6c14f0:hover::-moz-focus-inner{border:0}.search_fa6c14f0:hover{outline:transparent}.search_fa6c14f0:hover{position:relative}.search_fa6c14f0:hover:after{content:'';position:absolute;top:0px;right:0px;bottom:0px;left:0px;pointer-events:none;border:1px solid WindowText}}.searchInput_fa6c14f0{height:40px;padding:8px 8px 8px 0;border:none;background-color:transparent;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;outline:none;cursor:pointer;font-size:14px;-webkit-appearance:none;-webkit-border-radius:0}html[dir='ltr'] .searchInput_fa6c14f0{border-left:42px solid transparent}html[dir='rtl'] .searchInput_fa6c14f0{border-right:42px solid transparent}@media screen and (-ms-high-contrast: active){html[dir='ltr'] .searchInput_fa6c14f0{border-left:40px solid Window}html[dir='rtl'] .searchInput_fa6c14f0{border-right:40px solid Window}}.searchInput_fa6c14f0::-ms-clear{display:none}.searchIconSearchWrapper_fa6c14f0{display:block}.searchIconArrowWrapper_fa6c14f0{display:none}.searchIconSearchWrapper_fa6c14f0,.searchIconArrowWrapper_fa6c14f0{top:0}[dir='ltr'] .searchIconSearchWrapper_fa6c14f0,[dir='ltr'] .searchIconArrowWrapper_fa6c14f0{padding-left:17px}[dir='rtl'] .searchIconSearchWrapper_fa6c14f0,[dir='rtl'] .searchIconArrowWrapper_fa6c14f0{padding-right:17px}html[dir='ltr'] .searchIconSearchWrapper_fa6c14f0,html[dir='ltr'] .searchIconArrowWrapper_fa6c14f0{padding-right:8px}html[dir='rtl'] .searchIconSearchWrapper_fa6c14f0,html[dir='rtl'] .searchIconArrowWrapper_fa6c14f0{padding-left:8px}.searchIconClearWrapper_fa6c14f0{display:none;top:1px;z-index:10}[dir='ltr'] .searchIconClearWrapper_fa6c14f0{right:0px}[dir='rtl'] .searchIconClearWrapper_fa6c14f0{left:0px}.searchIconWrapper_fa6c14f0{height:40px;line-height:40px;cursor:pointer;position:absolute;text-align:center;-ms-high-contrast-adjust:none}.search_fa6c14f0 .ms-Icon:before{font-size:16px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.searchInput_fa6c14f0,.searchInput_fa6c14f0::-webkit-input-placeholder{font-size:14px}\n"}]);t.root="root_fa6c14f0";t.container="container_fa6c14f0";t.primaryCommands="primaryCommands_fa6c14f0";t.sideCommands="sideCommands_fa6c14f0";t.item="item_fa6c14f0";t.itemChevronDown="itemChevronDown_fa6c14f0";t.itemCommandText="itemCommandText_fa6c14f0";t.itemText="itemText_fa6c14f0";t.itemLinkIsNoName="itemLinkIsNoName_fa6c14f0";t.itemIcon="itemIcon_fa6c14f0";t.itemLink="itemLink_fa6c14f0";t.itemLinkIsExpanded="itemLinkIsExpanded_fa6c14f0";t.itemOverflow="itemOverflow_fa6c14f0";t.inactive="inactive_fa6c14f0";t.itemIconColor="itemIconColor_fa6c14f0";t.search="search_fa6c14f0";t.searchInput="searchInput_fa6c14f0";t.searchIconSearchWrapper="searchIconSearchWrapper_fa6c14f0";t.searchIconArrowWrapper="searchIconArrowWrapper_fa6c14f0";t.searchIconClearWrapper="searchIconClearWrapper_fa6c14f0";t.searchIconWrapper="searchIconWrapper_fa6c14f0"});define("Nn",["require","exports","ap","No"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("No",["require","exports","ap","KU","KV","Ns","Np","K2","KW","KZ"],function(e,t,i,r,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t);i.__exportStar(d,t)});define("Ns",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.LINE="line";e.CIRCLE="circle";e.GAP="gap";e.line="line";e.circle="circle";e.gap="gap"}(t.ShimmerElementType||(t.ShimmerElementType={}));!function(e){e.CENTER="center";e.BOTTOM="bottom";e.TOP="top";e.center="center";e.bottom="bottom";e.top="top"}(t.ShimmerElementVerticalAlign||(t.ShimmerElementVerticalAlign={}))});define("Np",["require","exports","KL","Nr","Nq"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShimmerTile=i.styled(r.ShimmerTileBase,o.getStyles)});define("Nr",["require","exports","ap","at","KL","KM","KZ","KV"],function(e,t,i,k,r,I,T,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;!function(e){e[e.largeSquareWidth=96]="largeSquareWidth";e[e.largeSquareHeight=96]="largeSquareHeight";e[e.largeNameWidth=144]="largeNameWidth";e[e.largeNameHeight=7]="largeNameHeight";e[e.largeActivityWidth=96]="largeActivityWidth";e[e.largeActivityHeight=7]="largeActivityHeight";e[e.smallSquareWidth=62]="smallSquareWidth";e[e.smallSquareHeight=61]="smallSquareHeight";e[e.smallNameWidth=106]="smallNameWidth";e[e.smallNameHeight=5]="smallNameHeight";e[e.smallActivityWidth=62]="smallActivityWidth";e[e.smallActivityHeight=5]="smallActivityHeight"}(o||(o={}));var E={small:{squareWidth:62,squareHeight:61,nameWidth:106,nameHeight:5,activityWidth:62,activityHeight:5},large:{squareWidth:96,squareHeight:96,nameWidth:144,nameHeight:7,activityWidth:96,activityHeight:7}},D=r.classNamesFunction(),n=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){var e=this.props,t=e.getStyles,i=e.contentSize,r=void 0===i?{width:176,height:171}:i,o=e.itemActivity,n=void 0===o||o,a=e.itemName,s=void 0===a||a,l=e.itemThumbnail,d=void 0===l||l,c=e.tileSize,u=void 0===c?"large":c,p=I.TileLayoutSizes[u],m=p.nameplatePadding,h=p.nameplateMargin,f=p.nameplateActivityHeight,g=p.nameplateNameHeight,y=E[u],v=y.squareWidth,_=y.squareHeight,b=y.nameWidth,x=y.nameHeight,S=y.activityWidth,C=y.activityHeight,P=0;if(s||n){P+=2*m;s&&(P+=g);n&&(P+=f+h)}this._classNames=D(t,{});return k.createElement("div",{className:this._classNames.root},k.createElement(T.ShimmerGap,{widthInPixel:r.width,height:r.height-_-P}),k.createElement("div",{className:this._classNames.flexDiv},w.getRenderedElements([{type:"gap",widthInPixel:(r.width-v)/2,height:_},d?{type:"line",widthInPixel:v,height:_}:{type:"gap",widthInPixel:v,height:_},{type:"gap",widthInPixel:(r.width-v)/2,height:_}],_)),n||s?k.createElement("div",null,k.createElement(T.ShimmerGap,{widthInPixel:r.width,height:m}),s?k.createElement("div",{className:this._classNames.flexDiv},w.getRenderedElements([{type:"gap",widthInPixel:(r.width-b)/2,height:g},{type:"line",widthInPixel:b,height:x},{type:"gap",widthInPixel:(r.width-b)/2,height:g}],g)):null,n?k.createElement("div",{className:this._classNames.flexDiv},w.getRenderedElements([{type:"gap",widthInPixel:(r.width-S)/2,height:f},{type:"line",widthInPixel:S,height:C},{type:"gap",widthInPixel:(r.width-S)/2,height:f}],f)):null,k.createElement(T.ShimmerGap,{widthInPixel:r.width,height:m})):null)};return e}(r.BaseComponent);t.ShimmerTileBase=n});define("Nq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){return{root:["ms-ShimmerTile-root",{width:"100%",height:"100%",display:"flex",flexDirection:"column"}],flexDiv:["ms-ShimmerTile-flexRow",{display:"flex"}]}}});define("Nm",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-AnalyticsActionBar--stats{min-height:28px}.ms-AnalyticsActionBar--stats .ms-Shimmer-container{margin:0}.ms-AnalyticsActionBar--stats .ms-Shimmer-container .ms-Shimmer-shimmerWrapper{top:12px}.ms-CommandBar.ms-AnalyticsActionBar--bar{background-color:transparent}html[dir=ltr] .ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBar-primaryCommands{margin-left:0}html[dir=rtl] .ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBar-primaryCommands{margin-right:0}html[dir=ltr] .ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBar-primaryCommands .ms-CommandBarItem:first-child{margin-left:-12px}html[dir=rtl] .ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBar-primaryCommands .ms-CommandBarItem:first-child{margin-right:-12px}html[dir=ltr] .ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBar-sideCommands{padding-right:0}html[dir=rtl] .ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBar-sideCommands{padding-left:0}html[dir=ltr] .ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBar-sideCommands .ms-CommandBarItem{margin-right:-8px}html[dir=rtl] .ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBar-sideCommands .ms-CommandBarItem{margin-left:-8px}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBarItem-link:hover,.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBarItem:hover{background-color:transparent}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBarItem-link:hover .ms-CommandBarItem-commandText,.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBarItem:hover .ms-CommandBarItem-commandText{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBarItem-commandText,.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBarItem-text{font-size:12px;font-weight:400}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBarItem-commandText,.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBarItem-icon,.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-CommandBarItem-text{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}])});define("Na",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=[".docx",".xlsx",".pptx",".doc",".xls",".ppt",".pdf",".vsdx",".vsdm",".aspx",".vsd",".vdx",".vdw",".vss",".vssm",".vssx",".vst",".vstm",".vstx",".vtx",".vsx",".odc",".ods",".odt",".odp"];t.isSupported=function(e){return-1<i.indexOf(e)}});define("Ny",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-FileHoverCard-compactCard{padding:8px 24px}.ms-FileHoverCard-compactCard--title{font-size:17px;font-weight:300;font-weight:400;line-height:20px;padding:12px 0 8px 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ms-FileHoverCard-compactCard--activity{padding:8px 0}.ms-FileHoverCard-expandedCard{padding:0 24px}.ms-FileHoverCard-expandedCardSection{padding:10px 0;white-space:nowrap}.ms-FileHoverCard-expandedCardSection:not(:last-child){border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ms-FileHoverCard-expandedCard-LoadError{padding:120px 45px;font-size:14px;font-weight:400;text-align:center;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.ms-FileHoverCard-expandedCard-LoadError .ms-FileHoverCard-expandedCard-Suggestion{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.ms-FileHoverCard-expandedCard-hostScroll{height:calc(100% - 1px)}"}])});define("Nu",["require","exports","ap","Nw","Nv","Na","aC"],function(e,t,i,n,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=18e5,l=0,d=function(){function e(e,t){this._dictListener={};this._itemAnalyticsDataSource=t.itemAnalyticsDataSource;this._dictItemAnalytics={};this._promiseDeduplicator=new r.default;setInterval(this._cleanCache.bind(this),o)}e.prototype.addListener=function(e,t){var i=""+ ++l;this._dictListener[t.itemId]||(this._dictListener[t.itemId]={});this._dictListener[t.itemId][i]=e;return{key:i}};e.prototype.fetchItemAnalytics=function(r,e){var o=this;this._clearErrorResponse();if(a.isSupported(r.extension))this._dictItemAnalytics[r.itemId]&&this._dictItemAnalytics[r.itemId].data||this._promiseDeduplicator.deduplicate(r.itemId,function(){return s.default.all({allTimeItemAnalytics:o._itemAnalyticsDataSource.getItemAnalytics(r,{skipToken:e})}).then(function(e){var t=e.allTimeItemAnalytics,i={status:n.AnalyticsResultStatus.succeed,data:t,skipToken:t&&t.skipToken};o._dictItemAnalytics[r.itemId]=i;o._emitChange(r)},function(e){var t,i=e&&e.allTimeItemAnalytics;if(i&&"FileTypeNotSupported"===i.message)t=n.AnalyticsResultStatus.unsupport;else{if(i&&"Canceled"===i.message||"Canceled"===e)return;t=n.AnalyticsResultStatus.failed}o._dictItemAnalytics[r.itemId]={status:t,data:null};o._emitChange(r)})});else{this._dictItemAnalytics[r.itemId]={status:n.AnalyticsResultStatus.unsupport,data:null};this._emitChange(r)}};e.prototype.getItemAnalytics=function(e){return this._dictItemAnalytics[e.itemId]};e.prototype.removeListener=function(e,t){this._dictListener[t.itemId][e.key]&&delete this._dictListener[t.itemId][e.key]};e.prototype.getDailyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e)};e.prototype.getMonthlyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e,720)};e.prototype.getAllTimeItemAnalytics=function(e){return this._itemAnalyticsDataSource.getItemAnalytics(e).then(function(e){return i.__assign({activity:{},incompleteData:{missingDataBeforeDateTime:new Date(e.incompleteData.missingDataBeforeDateTime),wasThrottled:e.incompleteData.wasThrottled},startDateTime:new Date(e.startDateTime)},e)})};e.prototype._getItemAnalyticsByInterval=function(e,t){var i=new Date;i=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate()));var r=new Date,o=new Date;r.setDate(r.getDate()-90);o.setHours(r.getHours()-1440);return this._itemAnalyticsDataSource.getItemAnalyticsByInterval(e,r,i,t)};e.prototype._clearErrorResponse=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status===n.AnalyticsResultStatus.failed&&delete this._dictItemAnalytics[e]};e.prototype._emitChange=function(e){var t=this._dictListener[e.itemId];if(t)for(var i in t)t[i]()};e.prototype._cleanCache=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status!==n.AnalyticsResultStatus.unsupport&&delete this._dictItemAnalytics[e]};return e}();t.FileHoverCardStore=d});define("Nv",["require","exports","aC"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._pendingPromises={}}e.prototype.deduplicate=function(t,e){var i=this;if(!this._pendingPromises[t]){var r=e();return(this._pendingPromises[t]=r).then(function(e){delete i._pendingPromises[t];return e},function(e){delete i._pendingPromises[t];return o.default.reject(e)})}return this._pendingPromises[t]};return e}();t.default=i});define("Nb",["require","exports","ap","at","FZ","FV"],function(e,t,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._itemAnalyticsStore=i.props.itemAnalyticsStore;return i}e.prototype.componentWillMount=function(){var e=this.props.item;this._dailyItemActivityPromise=this._itemAnalyticsStore.getDailyItemAnalytics(e);this._monthlyItemActivityPromise=this._itemAnalyticsStore.getMonthlyItemAnalytics(e);this._totalItemActivityPromise=this._itemAnalyticsStore.getAllTimeItemAnalytics(e)};e.prototype.render=function(){if(!this.props)return null;var e={highchartsInstance:this.props.highchartsInstance,ranges:this._buildRanges(),sources:this._buildSources(),isWeeklyChart:!0,hideTrending:!0,loggingName:"FileAnalyticsChart"};return o.createElement(n.AnalyticsChart,i.__assign({},e))};e.prototype._buildRanges=function(){return a.buildRanges()};e.prototype._buildSources=function(){return a.buildSource(this._dailyItemActivityPromise,void 0,this._monthlyItemActivityPromise,this._totalItemActivityPromise,!0,!0)};return e}(o.Component);t.AnalyticsItemChart=r});define("FZ",["require","exports","ap","F1","F0"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("F1",["require","exports","ap","at","Ga","F0","jP","yg","d","F4","cL","aC","aL","aF","o1","V","mo","F3","FW","FV","xs","a0","aI","F2"],function(e,t,y,v,_,b,x,r,o,S,n,s,a,C,P,k,I,T,w,l,E,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){y.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selectedSource=t.props&&t.props.sources&&t.props.sources[0];t._selectedRange=t.props&&t.props.ranges&&t.props.ranges[0];t._palette=o.getTheme().palette;t._currentDate=new Date;t.state={errorState:b.AnalyticsChartError.None,isLoading:!0,series:void 0,currentIntervals:w.default.viewIntervals,sourceTotalMap:{},sourceTotalDeltaMap:{},tempDate:t._currentDate,totalInterval:t._selectedRange&&t._selectedRange.totalInterval,deltaInterval:t._selectedRange&&t._selectedRange.deltaInterval};return t}e.prototype.componentDidMount=function(){var i=this;if(this.props){var e=this.props.loggingName||"AnalyticsChart",r=new c.Qos({name:e+".Load"}),o=[this.props.highchartsInstance];if(this.props.sources)for(var t=function(t){o.push(t.dataPromise);if(t.totalPromise){o.push(t.totalPromise);t.totalPromise.then(function(e){return i._updateSourceTotalMap(e,t.key,b.AnalyticsTotalInterval.AllTime)})}if(t.totalWeekPromise){o.push(t.totalWeekPromise);t.totalWeekPromise.then(function(e){return i._updateSourceTotalMap(e,t.key,b.AnalyticsTotalInterval.LastWeek)})}if(t.totalMonthPromise){o.push(t.totalMonthPromise);t.totalMonthPromise.then(function(e){return i._updateSourceTotalMap(e,t.key,b.AnalyticsTotalInterval.LastMonth)})}if(t.totalDeltaPromise){o.push(t.totalDeltaPromise);t.totalDeltaPromise.then(function(e){return i._updateSourceTotalDeltaMap(e,t.key,b.AnalyticsDeltaInterval.LastMonth)})}if(t.totalWeeklyDeltaPromise){o.push(t.totalWeeklyDeltaPromise);t.totalWeeklyDeltaPromise.then(function(e){return i._updateSourceTotalDeltaMap(e,t.key,b.AnalyticsDeltaInterval.LastWeek)})}},n=0,a=this.props.sources;n<a.length;n++){t(a[n])}this._invalidateChartSeries();s.default.all(o).then(function(){r.end({resultType:c.ResultTypeEnum.Success});i.setState({errorState:b.AnalyticsChartError.None,isLoading:!1})},function(e){var t=e.some(function(e){return e&&404===e.status});t?r.end({resultType:c.ResultTypeEnum.ExpectedFailure}):r.end({resultType:c.ResultTypeEnum.Failure});i.setState({errorState:t?b.AnalyticsChartError.NotFound:b.AnalyticsChartError.Unknown,isLoading:!1})})}};e.prototype.render=function(){var u=this;if(!(this.props&&this.props.sources&&this.props.ranges&&this.state))return null;var e=this.state,t=e.errorState,i=e.isLoading,r=e.series,o=e.currentIntervals,p=e.sourceTotalMap,m=e.sourceTotalDeltaMap,n=t!==b.AnalyticsChartError.None,h=n||i,a=C.default.fromHtmlColor(this._palette.neutralSecondary);a.A=204;var s=this._selectedSource&&this._selectedSource.description,l={render:function(e){var t=e&&e.target&&e.target.renderTo;t&&t.setAttribute("aria-label",k.format(T.default.chartAriaLabelFormat,s))}},d=r&&{highchartsInstance:this.props.highchartsInstance,options:{accessibility:{pointDescriptionFormatter:function(e){var t=D(new Date(e.x),{weekday:"long",month:"long",day:"numeric"});return k.format(T.default.dataPointAriaLabelFormat,t,e.y,e.series.name)},pointDescriptionThreshold:!1},chart:{backgroundColor:null,className:"ms-AnalyticsChart-ChartRoot",description:s,events:l,style:null,type:"column"},legend:{enabled:!1},series:[r],title:{text:null},tooltip:{backgroundColor:C.default.toHtmlString(a),borderWidth:0,formatter:function(){return"\n              <div class='ms-AnalyticsChart-Tooltip'>\n                <div class='ms-AnalyticsChart-Tooltip-Header'>"+D(new Date(this.x),{weekday:"short",month:"long",day:"numeric"})+"</div>\n                <div class='ms-AnalyticsChart-Tooltip-Body'>"+A(this.y,{style:"decimal",useGrouping:!0})+"</div>\n                <div class='ms-AnalyticsChart-Tooltip-Footer'>"+k.getLocalizedCountValue(this.series.name,o,this.y)+"</div>\n              </div>\n            "},positioner:function(e,t,i){return{x:i.plotX+this.chart.plotLeft-e/2,y:i.plotY+this.chart.plotTop-t-16}},shadow:!1,useHTML:!0},xAxis:{labels:{formatter:function(){return D(new Date(this.value),{day:"numeric",month:"numeric"})}},lineWidth:0,tickWidth:0,type:"datetime"},yAxis:{allowDecimals:!1,gridLineColor:this._palette.neutralQuaternaryAlt,lineColor:"transparent",title:{text:null}}}},c=this.props.sources.map(function(c){return v.createElement(S.PivotItem,{key:c.key,itemKey:c.key,onRenderItemLink:function(e,t){var i=!h&&p&&p[e.itemKey]&&p[e.itemKey][u.state.totalInterval],r=void 0!==i?A(i,{style:"decimal",useGrouping:!0}):"-",o=!h&&m&&m[e.itemKey]&&void 0!==m[e.itemKey][u.state.deltaInterval]?m[e.itemKey][u.state.deltaInterval]:void 0,n=void 0!==o?A(o,{style:"decimal",useGrouping:!0}):"-",a=null;0===o?a=u.state.deltaInterval===b.AnalyticsDeltaInterval.LastWeek?c.trendWeeklyUnchangedLabel:c.trendUnchangedLabel:o&&(a=k.format(u.state.deltaInterval===b.AnalyticsDeltaInterval.LastWeek?c.trendWeeklyLabelFormat:c.trendLabelFormat,n));var s=v.createElement("div",{className:"ms-AnalyticsChart-SourcesCell-Delta"},a&&o<0?v.createElement(I.Icon,{iconName:"TriangleSolidDown12",className:"ms-AnalyticsChart-DeltaIcon ms-fontColor-red"}):null,a&&0<o?v.createElement(I.Icon,{iconName:"TriangleSolidUp12",className:"ms-AnalyticsChart-DeltaIcon ms-fontColor-green"}):null,v.createElement("span",null,a)),l="source-tooltip-"+c.key,d=k.getLocalizedCountValue(c.label,c.intervals,i);return v.createElement("div",{className:"ms-AnalyticsChart-SourcesCell"},v.createElement("div",{className:"ms-AnalyticsChart-SourcesCell-Total"},r),v.createElement("div",{className:"ms-AnalyticsChart-SourcesCell-Label"},v.createElement("span",null,d),c.description?v.createElement("div",{className:"ms-AnalyticsChart-SourcesCell-Description"},v.createElement(E.TooltipHost,{content:c.description,delay:E.TooltipDelay.zero,directionalHint:1,id:l},v.createElement(I.Icon,{iconName:"Info",className:"ms-Icon--m","aria-describedby":l}))):null),h||u.props.hideTrending||u._isCompact()?null:s)}})}),f=h?[]:this.props.ranges.map(function(e){return v.createElement(S.PivotItem,{key:e.key,itemKey:e.key,linkText:e.label})}),g=this.props.sources.indexOf(this._selectedSource)%2==1;return v.createElement("div",{className:"ms-AnalyticsChart"+(this._isCompact()?" is-compact":" is-full")},v.createElement("div",{className:"ms-AnalyticsChart-Sources"},v.createElement(S.Pivot,{headersOnly:!0,linkFormat:S.PivotLinkFormat.links,onLinkClick:this._onSourceLinkClick},c)),v.createElement("div",{className:"ms-AnalyticsChart-ChartHost"+(g?" alternate-hightlight":"")},h?null:v.createElement(_.Chart,y.__assign({ref:"chart"},d)),n?v.createElement("div",{className:"ms-AnalyticsChart-Error"},this._renderErrorGlyph(),v.createElement("div",null,t===b.AnalyticsChartError.NotFound?T.default.errorNotFoundLabel:T.default.errorLabel)):null,i&&!n?v.createElement(P.Spinner,{size:P.SpinnerSize.large,label:T.default.loadingLabel}):null),v.createElement("div",{className:x.css("ms-AnalyticsChart-Ranges",{"ms-AnalyticsChart-Ranges-Weekly":this.props.isWeeklyChart})},v.createElement(S.Pivot,{headersOnly:!0,linkFormat:S.PivotLinkFormat.links,onLinkClick:this._onRangeLinkClick},f)),v.createElement("div",{className:x.css("ms-AnalyticsChart-Paging",{"ms-AnalyticsChart-Paging-Weekly":this.props.isWeeklyChart})},v.createElement("button",{className:"ms-AnalyticsChart-Button ms-AnalyticsChart-PreviousWeek",disabled:!this._previousPageAvailable(),onClick:this._onPreviousPageClick},"< "+w.default.previousWeekLabel),v.createElement("span",{className:"ms-AnalyticsChart-ButtonDivider"}),v.createElement("button",{className:"ms-AnalyticsChart-Button ms-AnalyticsChart-NextWeek",disabled:!this._nextPageAvailable(),onClick:this._onNextPageClick},w.default.nextWeekLabel+" >")))};e.prototype.shouldComponentUpdate=function(e,t){return e.highchartsInstance!==this.props.highchartsInstance||e.ranges!==this.props.ranges||e.sources!==this.props.sources||this._isCompact(e)!==this._isCompact()||(!(this.state.series||!t.series)||(this.state.tempDate!==t.tempDate||(!a.deepCompare(this.state.sourceTotalMap,t.sourceTotalMap)||(this.state.isLoading!==t.isLoading||(this.state.deltaInterval!==t.deltaInterval||this.state.totalInterval!==t.totalInterval)))))};e.prototype.componentWillReceiveProps=function(e){if(this._isCompact(e)!==this._isCompact()){var t=new Date(this.state.tempDate.getTime());this._pagingRange=this._isCompact(e)?l.getWeeklyRanges(t):void 0;this._invalidateChartSeries()}};e.prototype._computeChartSeries=function(e){var t=this._getHighlightColors(),i=this.props.sources.indexOf(this._selectedSource);return{borderWidth:0,color:this._palette.neutralSecondary,data:this._computeSeriesData(e),name:this._selectedSource&&this._selectedSource.label,states:{hover:{color:t[i%t.length]}}}};e.prototype._computeSeriesData=function(e){var t=[];if(e){var i=this._pagingRange||this._selectedRange;t=(i&&i.filterData?i.filterData(e):e).map(function(e,t){var i=e.time;return{name:i=new Date(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()),x:i,y:e.value}})}return t};e.prototype._getHighlightColors=function(){return[this._palette.themePrimary]};e.prototype._invalidateChartSeries=function(){var i=this;this.setState({series:void 0});this._selectedSource&&this._selectedSource.dataPromise&&this._selectedSource.dataPromise.then(function(e){var t=i._computeChartSeries(e);i.state.series&&i._scheduleDynamicSeriesUpdate(i.state.series,t);i.setState({series:t,currentIntervals:i._selectedSource.intervals})})};e.prototype._isCompact=function(e){void 0===e&&(e=this.props);return e&&(e.responsiveMode<r.ResponsiveMode.medium||e.isWeeklyChart)};e.prototype._onRangeLinkClick=function(t){var e=this.props&&this.props.ranges&&this.props.ranges.filter(function(e){return e.key===t.props.itemKey})[0];this._selectedRange=e;this._invalidateChartSeries();this.setState({deltaInterval:this._selectedRange.deltaInterval,totalInterval:this._selectedRange.totalInterval});this.props&&this.props.loggingName&&e.engagementName&&d.Engagement.logData({name:this.props.loggingName+"."+e.engagementName+".Click"})};e.prototype._onPreviousPageClick=function(){var i=this;this._previousPageAvailable()&&this.setState(function(e){var t=new Date(e.tempDate.getTime()-6048e5);i._pagingRange=l.getWeeklyRanges(t);i._invalidateChartSeries();return{tempDate:t}})};e.prototype._onNextPageClick=function(){var i=this;this._nextPageAvailable()&&this.setState(function(e){var t=new Date(e.tempDate.getTime()+6048e5);i._pagingRange=l.getWeeklyRanges(t);i._invalidateChartSeries();return{tempDate:t}})};e.prototype._previousPageAvailable=function(){return this.state.tempDate>new Date(this._currentDate.getTime()-72576e5)};e.prototype._nextPageAvailable=function(){return this.state.tempDate<this._currentDate};e.prototype._onSourceLinkClick=function(t){var e=this.props&&this.props.sources&&this.props.sources.filter(function(e){return e.key===t.props.itemKey})[0];this._selectedSource=e;this._invalidateChartSeries();this.props&&this.props.loggingName&&e.engagementName&&d.Engagement.logData({name:this.props.loggingName+"."+e.engagementName+".Click"})};e.prototype._renderErrorGlyph=function(){var e={fill:this._palette.neutralQuaternary};return v.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"-3560 -2463.547 174 182.666"},v.createElement("path",{style:e,d:"M4293.5,2898.376l16.789-136.727,26.8,3.291L4320.3,2901.666Zm117.5,2.171V2795.466h27v105.081Zm-36,0v-52.54h27v52.54Zm-36,0V2719h27v181.547Zm-75,0v-73.5h27v73.5Z",transform:"translate(-7824 -5182.547)"}))};e.prototype._scheduleDynamicSeriesUpdate=function(e,i){var r=this;e!==i&&this._async&&this._async.requestAnimationFrame(function(){var e=r.refs&&r.refs.chart&&r.refs.chart.getChart();if(e){var t=e.series[0];if(t&&t.data&&i&&i.data&&(t.data.length!==i.data.length||t.name!==i.name)){t.remove(!1);e.addSeries(i)}else t.setData(i.data)}else r.forceUpdate()})};e.prototype._updateSourceTotalDeltaMap=function(e,t,i){var r=this.state.sourceTotalDeltaMap;r[t]||(r[t]={});r[t][i]=e;this.setState({sourceTotalDeltaMap:r})};e.prototype._updateSourceTotalMap=function(e,t,i){var r=this.state.sourceTotalMap;r[t]||(r[t]={});r[t][i]=e;this.setState({sourceTotalMap:r})};y.__decorate([x.autobind],e.prototype,"_onRangeLinkClick",null);y.__decorate([x.autobind],e.prototype,"_onPreviousPageClick",null);y.__decorate([x.autobind],e.prototype,"_onNextPageClick",null);y.__decorate([x.autobind],e.prototype,"_previousPageAvailable",null);y.__decorate([x.autobind],e.prototype,"_nextPageAvailable",null);y.__decorate([x.autobind],e.prototype,"_onSourceLinkClick",null);return e=y.__decorate([r.withResponsiveMode],e)}(x.BaseComponent);t.AnalyticsChart=i;function D(t,i){var r=void 0,e=n.default.language;if(t)try{r=t.toLocaleDateString(e,i)}catch(e){r=t.toLocaleDateString(void 0,i)}return r}function A(t,i){var r=void 0,e=n.default.language;if(t)try{r=t.toLocaleString(e,i)}catch(e){r=t.toLocaleString(void 0,i)}return r}});define("Ga",["require","exports","ap","Gb"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Gb",["require","exports","ap","at","o1"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={loadingSpinnerVisible:!0};return t}e.prototype.componentDidMount=function(){var t=this;this.props.highchartsInstance&&this.props.highchartsInstance.then(function(e){t._highcharts=e;t._highcharts.setOptions({global:{useUTC:!1,timezoneOffset:(new Date).getTimezoneOffset()}});t.setState({loadingSpinnerVisible:!1})})};e.prototype.componentDidUpdate=function(e){this._invalidateChart(this.props.options)};e.prototype.componentWillUnmount=function(){if(this._chart){this._chart.destroy();this._chart=void 0}};e.prototype.getChart=function(){return this._chart};e.prototype.render=function(){return o.createElement("div",null,this.state.loadingSpinnerVisible?o.createElement(n.Spinner,null):o.createElement("div",{ref:"chartHost"}))};e.prototype._invalidateChart=function(e){if(this._highcharts&&e&&this.refs.chartHost){this._chart&&this._chart.destroy();this._chart=new this._highcharts.Chart(r.__assign({},e,{credits:{enabled:!1},chart:r.__assign({},e.chart,{renderTo:this.refs.chartHost})}))}};return e}(o.Component);t.Chart=i});define("F0",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.LastWeek=0]="LastWeek";e[e.LastMonth=1]="LastMonth"}(t.AnalyticsDeltaInterval||(t.AnalyticsDeltaInterval={}));!function(e){e[e.AllTime=0]="AllTime";e[e.LastWeek=1]="LastWeek";e[e.LastMonth=2]="LastMonth"}(t.AnalyticsTotalInterval||(t.AnalyticsTotalInterval={}));!function(e){e[e.None=0]="None";e[e.NotFound=1]="NotFound";e[e.Unknown=2]="Unknown"}(t.AnalyticsChartError||(t.AnalyticsChartError={}))});define("F4",["require","exports","ap","F5"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("F5",["require","exports","ap","F8","F7","F6"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.PivotItem=o.PivotItem;i.__exportStar(n,t)});define("F8",["require","exports","ap","at","jP","wN","o7","F7","F6","F6","mo","F9"],function(e,t,l,d,c,u,i,a,o,n,p,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=r,s=function(r){l.__extends(e,r);function e(e){var s=r.call(this,e)||this;s.focusZone=c.createRef();s._renderPivotLink=function(e){var t,i,r=e.itemKey,o=e.headerButtonProps,n=s._keyToTabIds[r],a=e.onRenderItemLink;t=a?a(e,s._renderLinkContent):s._renderLinkContent(e);return d.createElement(u.CommandButton,l.__assign({},o,{id:n,key:r,className:c.css("ms-Pivot-link",m.link,(i={},i["is-selected "+m.linkIsSelected]=s.state.selectedKey===r,i)),onClick:s._onLinkClick.bind(s,r),onKeyPress:s._onKeyPress.bind(s,r),ariaLabel:e.ariaLabel,role:"tab","aria-selected":s.state.selectedKey===r,name:e.headerText}),t)};s._renderLinkContent=function(e){var t=e.itemCount,i=e.itemIcon,r=e.headerText;return d.createElement("span",{className:c.css("ms-Pivot-link-content")},void 0!==i&&d.createElement("span",{className:c.css("ms-Pivot-icon",m.icon)},d.createElement(p.Icon,{iconName:i})),void 0!==r&&d.createElement("span",{className:c.css("ms-Pivot-text",m.text)}," ",e.headerText),void 0!==t&&d.createElement("span",{className:c.css("ms-Pivot-count",m.count)}," (",t,")"))};s._pivotId=c.getId("Pivot");var t,i=s._getPivotLinks(s.props);e.initialSelectedKey?t=e.initialSelectedKey:e.initialSelectedIndex?t=i[e.initialSelectedIndex].itemKey:e.selectedKey?t=e.selectedKey:i.length&&(t=i[0].itemKey);s.state={links:i,selectedKey:t,selectedTabId:s._keyToTabIds[t]};s._renderPivotLink=s._renderPivotLink.bind(s);return s}e.prototype.componentWillReceiveProps=function(r){var o=this,n=this._getPivotLinks(r);this.setState(function(e,t){var i;o._isKeyValid(r.selectedKey)?i=r.selectedKey:o._isKeyValid(e.selectedKey)?i=e.selectedKey:n.length&&(i=n[0].itemKey);return{links:n,selectedKey:i,selectedTabId:o._keyToTabIds[i]}})};e.prototype.focus=function(){this.focusZone.current&&this.focusZone.current.focus()};e.prototype.render=function(){return d.createElement("div",null,this._renderPivotLinks(),this._renderPivotItem())};e.prototype._renderPivotLinks=function(){return d.createElement(i.FocusZone,{componentRef:this.focusZone,direction:i.FocusZoneDirection.horizontal},d.createElement("ul",{className:c.css("ms-Pivot",m.root,(e={},e["ms-Pivot--large "+m.rootIsLarge]=this.props.linkSize===n.PivotLinkSize.large,e),(t={},t["ms-Pivot--tabs "+m.rootIsTabs]=this.props.linkFormat===o.PivotLinkFormat.tabs,t)),role:"tablist"},this.state.links.map(this._renderPivotLink)));var e,t};e.prototype._renderPivotItem=function(){if(this.props.headersOnly)return null;var e=this.state.selectedKey,t=this._keyToIndexMapping[e],i=this.state.selectedTabId;return d.createElement("div",{role:"tabpanel","aria-labelledby":i},d.Children.toArray(this.props.children)[t])};e.prototype._getPivotLinks=function(e){var o=this,n=[];this._keyToIndexMapping={};this._keyToTabIds={};d.Children.map(e.children,function(e,t){if("object"==typeof e&&e.type===a.PivotItem){var i=e,r=i.props.itemKey||t.toString();n.push({headerText:i.props.headerText||i.props.linkText,headerButtonProps:i.props.headerButtonProps,ariaLabel:i.props.ariaLabel,itemKey:r,itemCount:i.props.itemCount,itemIcon:i.props.itemIcon,onRenderItemLink:i.props.onRenderItemLink});o._keyToIndexMapping[r]=t;o._keyToTabIds[r]=o._getTabId(r,t)}});return n};e.prototype._getTabId=function(e,t){return this.props.getTabId?this.props.getTabId(e,t):this._pivotId+"-Tab"+t};e.prototype._isKeyValid=function(e){return void 0!==e&&void 0!==this._keyToIndexMapping[e]};e.prototype._onLinkClick=function(e,t){t.preventDefault();this._updateSelectedItem(e,t)};e.prototype._onKeyPress=function(e,t){t.preventDefault();13===t.which&&this._updateSelectedItem(e)};e.prototype._updateSelectedItem=function(e,t){this.setState({selectedKey:e,selectedTabId:this._keyToTabIds[e]});if(this.props.onLinkClick&&0<=this._keyToIndexMapping[e]){var i=this._keyToIndexMapping[e],r=d.Children.toArray(this.props.children)[i];"object"==typeof r&&r.type===a.PivotItem&&this.props.onLinkClick(r,t)}};return e}(c.BaseComponent);t.Pivot=s});define("wN",["require","exports","ap","wO"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("wO",["require","exports","ap","w8","w7","w6","w4","w2","w1","wZ","wW","wU","wT","wP"],function(e,t,i,r,o,n,a,s,l,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t);i.__exportStar(d,t);i.__exportStar(c,t);i.__exportStar(u,t);i.__exportStar(p,t);i.__exportStar(m,t)});define("w8",["require","exports","ap","at","jP","mo","wt","xa","w9"],function(e,t,y,v,w,n,a,E,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){y.__extends(o,r);function o(e,t){var l=r.call(this,e)||this;l._buttonElement=w.createRef();l._splitButtonContainer=w.createRef();l._onRenderIcon=function(e,t){var i=l.props.iconProps;return i?v.createElement(n.Icon,y.__assign({},i,{className:l._classNames.icon})):null};l._onRenderTextContents=function(){var e=l.props,t=e.text,i=e.children,r=e.description,o=e.onRenderText,n=void 0===o?l._onRenderText:o,a=e.onRenderDescription,s=void 0===a?l._onRenderDescription:a;return t||"string"==typeof i||r?v.createElement("div",{className:l._classNames.textContainer},n(l.props,l._onRenderText),s(l.props,l._onRenderDescription)):[n(l.props,l._onRenderText),s(l.props,l._onRenderDescription)]};l._onRenderText=function(){var e=l.props.text,t=l.props.children;void 0===e&&"string"==typeof t&&(e=t);return e?v.createElement("div",{key:l._labelId,className:l._classNames.label,id:l._labelId},e):null};l._onRenderChildren=function(){var e=l.props.children;return"string"==typeof e?null:e};l._onRenderDescription=function(e){var t=e.description;return t?v.createElement("div",{key:l._descriptionId,className:l._classNames.description,id:l._descriptionId},t):null};l._onRenderAriaDescription=function(){var e=l.props.ariaDescription;return e?v.createElement("span",{className:l._classNames.screenReaderText,id:l._ariaDescriptionId},e):null};l._onRenderMenuIcon=function(e){var t=l.props.menuIconProps;return v.createElement(n.Icon,y.__assign({iconName:"ChevronDown"},t,{className:l._classNames.menuIcon}))};l._onRenderMenu=function(e){var t=e.onDismiss,i=void 0===t?l._dismissMenu:t;return v.createElement(a.ContextualMenu,y.__assign({id:l._labelId+"-menu",directionalHint:4},e,{className:"ms-BaseButton-menuhost "+e.className,target:l._isSplitButton?l._splitButtonContainer.current:l._buttonElement.current,labelElementId:l._labelId,onDismiss:i}))};l._dismissMenu=function(){var e=null;l.props.persistMenu&&l.state.menuProps&&((e=l.state.menuProps).hidden=!0);l.setState({menuProps:e})};l._openMenu=function(){if(l.props.menuProps){var e=l.props.menuProps;l.props.persistMenu&&(e.hidden=!1);l.setState({menuProps:e})}};l._onToggleMenu=function(){l._splitButtonContainer.current&&l._splitButtonContainer.current.focus();var e=l.state.menuProps;l.props.persistMenu?e&&e.hidden?l._openMenu():l._dismissMenu():e?l._dismissMenu():l._openMenu()};l._onSplitButtonPrimaryClick=function(e){l._isExpanded&&l._dismissMenu();l.props.onClick&&l.props.onClick(e)};l._onMouseDown=function(e){l.props.onMouseDown&&l.props.onMouseDown(e);e.preventDefault()};l._onSplitButtonContainerKeyDown=function(e){if(13===e.which){if(l._buttonElement.current){l._buttonElement.current.click();e.preventDefault();e.stopPropagation()}}else l._onMenuKeyDown(e)};l._onMenuKeyDown=function(e){if(!l.props.disabled){l.props.onKeyDown&&l.props.onKeyDown(e);if(!e.defaultPrevented&&l._isValidMenuOpenKey(e)){var t=l.props.onMenuClick;t&&t(e,l);l._onToggleMenu();e.preventDefault();e.stopPropagation()}}};l._onMenuClick=function(e){var t=l.props.onMenuClick;t&&t(e,l);if(!e.defaultPrevented){l._onToggleMenu();e.preventDefault();e.stopPropagation()}};l._warnConditionallyRequiredProps(["menuProps","onClick"],"split",l.props.split);l._warnDeprecations({rootProps:void 0});l._labelId=w.getId();l._descriptionId=w.getId();l._ariaDescriptionId=w.getId();var i=null;e.persistMenu&&e.menuProps&&((i=e.menuProps).hidden=!0);l.state={menuProps:i};return l}Object.defineProperty(o.prototype,"_isSplitButton",{get:function(){return!!this.props.menuProps&&!!this.props.onClick&&!0===this.props.split},enumerable:!0,configurable:!0});Object.defineProperty(o.prototype,"_isExpanded",{get:function(){return this.props.persistMenu?!this.state.menuProps.hidden:!!this.state.menuProps},enumerable:!0,configurable:!0});o.prototype.render=function(){var e=this.props,t=e.ariaDescription,i=e.ariaLabel,r=e.ariaHidden,o=e.className,n=e.description,a=e.disabled,s=e.primaryDisabled,l=e.href,d=e.iconProps,c=e.menuIconProps,u=e.styles,p=e.text,m=e.checked,h=e.variantClassName,f=e.theme,g=e.getClassNames,y=this.state.menuProps,v=a||s;this._classNames=g?g(f,o,h,d&&d.className,c&&c.className,v,m,!!y,this.props.split):E.getBaseButtonClassNames(u,o,h,d&&d.className,c&&c.className,v,m,!!y,this.props.split);var _,b=this._ariaDescriptionId,x=this._labelId,S=this._descriptionId,C=!v&&!!l,P=C?"a":"button",k=w.getNativeProps(w.assign(C?{}:{type:"button"},this.props.rootProps,this.props),C?w.anchorProperties:w.buttonProperties,["disabled"]);_=t?b:n?S:k["aria-describedby"]?k["aria-describedby"]:null;var I=null;i||(k["aria-labelledby"]?I=k["aria-labelledby"]:_&&(I=p?x:null));var T=w.assign(k,{className:this._classNames.root,ref:this._buttonElement,disabled:v,"aria-label":i,"aria-labelledby":I,"aria-describedby":_,"data-is-focusable":!1!==this.props["data-is-focusable"]&&!a&&!this._isSplitButton,"aria-pressed":m});r&&(T["aria-hidden"]=!0);if(this._isSplitButton)return this._onRenderSplitButtonContent(P,T);this.props.menuProps&&w.assign(T,{onKeyDown:this._onMenuKeyDown,onClick:this._onMenuClick,"aria-expanded":this._isExpanded,"aria-owns":this.state.menuProps?this._labelId+"-menu":null,"aria-haspopup":!0});return this._onRenderContent(P,T)};o.prototype.componentDidUpdate=function(e,t){this.props.onAfterMenuDismiss&&t.menuProps&&!this.state.menuProps&&this.props.onAfterMenuDismiss()};o.prototype.focus=function(){this._isSplitButton&&this._splitButtonContainer.current?this._splitButtonContainer.current.focus():this._buttonElement.current&&this._buttonElement.current.focus()};o.prototype.dismissMenu=function(){this._dismissMenu()};o.prototype.openMenu=function(){this._openMenu()};o.prototype._onRenderContent=function(e,t){var i=this.props,r=e,o=i.menuIconProps,n=i.menuProps,a=i.onRenderIcon,s=void 0===a?this._onRenderIcon:a,l=i.onRenderAriaDescription,d=void 0===l?this._onRenderAriaDescription:l,c=i.onRenderChildren,u=void 0===c?this._onRenderChildren:c,p=i.onRenderMenu,m=void 0===p?this._onRenderMenu:p,h=i.onRenderMenuIcon,f=void 0===h?this._onRenderMenuIcon:h,g=v.createElement(r,y.__assign({},t),v.createElement("div",{className:this._classNames.flexContainer},s(i,this._onRenderIcon),this._onRenderTextContents(),d(i,this._onRenderAriaDescription),u(i,this._onRenderChildren),!this._isSplitButton&&(n||o||this.props.onRenderMenuIcon)&&f(this.props,this._onRenderMenuIcon),this.state.menuProps&&!this.state.menuProps.doNotLayer&&m(n,this._onRenderMenu)));return n&&n.doNotLayer?v.createElement("div",{style:{display:"inline-block"}},g,this.state.menuProps&&m(n,this._onRenderMenu)):g};o.prototype._onRenderSplitButtonContent=function(e,t){var i=this.props,r=i.styles,o=void 0===r?{}:r,n=i.disabled,a=i.checked,s=i.getSplitButtonClassNames,l=i.primaryDisabled,d=s?s(!!n,!!this.state.menuProps,!!a):o&&c.getClassNames(o,!!n,!!this.state.menuProps,!!a);w.assign(t,{onClick:void 0,tabIndex:-1,"data-is-focusable":!1});return v.createElement("div",{role:"button","aria-labelledby":t.ariaLabel,"aria-disabled":n,"aria-haspopup":!0,"aria-expanded":this._isExpanded,"aria-pressed":this.props.checked,"aria-describedby":t.ariaDescription,className:d&&d.splitButtonContainer,onKeyDown:this._onSplitButtonContainerKeyDown,ref:this._splitButtonContainer,"data-is-focusable":!0,onClick:n||l?void 0:this._onSplitButtonPrimaryClick,tabIndex:n?void 0:0},v.createElement("span",{style:{display:"flex"}},this._onRenderContent(e,t),this._onRenderSplitButtonMenuButton(d),this._onRenderSplitButtonDivider(d)))};o.prototype._onRenderSplitButtonDivider=function(e){return e&&e.divider?v.createElement("span",{className:e.divider}):null};o.prototype._onRenderSplitButtonMenuButton=function(e){var t=this.props.menuIconProps,i=this.props.splitButtonAriaLabel;void 0===t&&(t={iconName:"ChevronDown"});var r={styles:e,checked:this.props.checked,disabled:this.props.disabled,onClick:this._onMenuClick,menuProps:void 0,iconProps:t,ariaLabel:i,"aria-haspopup":!0,"aria-expanded":this._isExpanded,"data-is-focusable":!1};return v.createElement(o,y.__assign({},r,{onMouseDown:this._onMouseDown,tabIndex:-1}))};o.prototype._isValidMenuOpenKey=function(e){return this.props.menuTriggerKeyCode?e.which===this.props.menuTriggerKeyCode:40===e.which&&(e.altKey||e.metaKey)};o.defaultProps={baseClassName:"ms-Button",styles:{},split:!1};return o}(w.BaseComponent);t.BaseButton=i});define("xa",["require","exports","jP","d"],function(e,t,i,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getBaseButtonClassNames=i.memoizeFunction(function(e,t,i,r,o,n,a,s,l){var d=s&&!l;return c.mergeStyleSets({root:["ms-Button",e.root,t,i,a&&["is-checked",e.rootChecked],d&&["is-expanded",e.rootExpanded,{selectors:{":hover .ms-Button-icon":e.iconExpandedHovered,":hover .ms-Button-menuIcon":e.rootExpandedHovered,":hover":e.rootExpandedHovered}}],n&&["is-disabled",e.rootDisabled],!n&&!d&&!a&&{selectors:{":hover":e.rootHovered,":hover .ms-Button-icon":e.iconHovered,":hover .ms-Button-description":e.descriptionHovered,":hover .ms-Button-menuIcon":e.menuIconHovered,":focus":e.rootFocused,":active":e.rootPressed,":active .ms-Button-icon":e.iconPressed,":active .ms-Button-description":e.descriptionPressed,":active .ms-Button-menuIcon":e.menuIconPressed}},n&&a&&[e.rootCheckedDisabled],!n&&a&&{selectors:{":hover":e.rootCheckedHovered,":active":e.rootCheckedPressed}}],flexContainer:["ms-Button-flexContainer",e.flexContainer],textContainer:["ms-Button-textContainer",e.textContainer],icon:["ms-Button-icon",r,e.icon,d&&e.iconExpanded,a&&e.iconChecked,n&&e.iconDisabled],label:["ms-Button-label",e.label,a&&e.labelChecked,n&&e.labelDisabled],menuIcon:["ms-Button-menuIcon",o,e.menuIcon,a&&e.menuIconChecked,n&&e.menuIconDisabled,!n&&!d&&!a&&{selectors:{":hover":e.menuIconHovered,":active":e.menuIconPressed}},d&&["is-expanded",e.menuIconExpanded,{selectors:{":hover":e.menuIconExpandedHovered}}]],description:["ms-Button-description",e.description,a&&e.descriptionChecked,n&&e.descriptionDisabled],screenReaderText:["ms-Button-screenReaderText",e.screenReaderText]})})});define("w9",["require","exports","jP","d"],function(e,t,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getClassNames=i.memoizeFunction(function(e,t,i,r){return{root:o.mergeStyles(e.splitButtonMenuButton,i&&[e.splitButtonMenuButtonExpanded],t&&[e.splitButtonMenuButtonDisabled],r&&!t&&[e.splitButtonMenuButtonChecked]),splitButtonContainer:o.mergeStyles(e.splitButtonContainer,r&&!t&&[e.splitButtonContainerChecked,{selectors:{":hover":e.splitButtonContainerCheckedHovered}}],!t&&!r&&[{selectors:{":hover":e.splitButtonContainerHovered,":focus":e.splitButtonContainerFocused}}],t&&e.splitButtonContainerDisabled),icon:o.mergeStyles(e.splitButtonMenuIcon,t&&e.splitButtonMenuIconDisabled),flexContainer:o.mergeStyles(e.splitButtonFlexContainer),divider:o.mergeStyles(e.splitButtonDivider)}})});define("w7",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.button=0]="button";e[e.anchor=1]="anchor"}(t.ElementType||(t.ElementType={}));!function(e){e[e.normal=0]="normal";e[e.primary=1]="primary";e[e.hero=2]="hero";e[e.compound=3]="compound";e[e.command=4]="command";e[e.icon=5]="icon";e[e.default=6]="default"}(t.ButtonType||(t.ButtonType={}))});define("w6",["require","exports","ap","at","jP","w7","wW","w4","wZ","wP","wT"],function(e,t,r,o,n,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._shouldUpdateComponentRef=!1;n.warn("The Button component has been deprecated. Use specific variants instead. (PrimaryButton, DefaultButton, IconButton, ActionButton, etc.)");return t}e.prototype.render=function(){var e=this.props;switch(e.buttonType){case a.ButtonType.command:return o.createElement(l.ActionButton,r.__assign({},e));case a.ButtonType.compound:return o.createElement(d.CompoundButton,r.__assign({},e));case a.ButtonType.icon:return o.createElement(c.IconButton,r.__assign({},e));case a.ButtonType.primary:return o.createElement(u.PrimaryButton,r.__assign({},e));default:return o.createElement(s.DefaultButton,r.__assign({},e))}};return e}(n.BaseComponent);t.Button=i});define("wW",["require","exports","ap","at","w8","jP","wX"],function(e,t,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){n.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e._shouldUpdateComponentRef=!1;return e}e.prototype.render=function(){var e=this.props,t=e.primary,i=void 0!==t&&t,r=e.styles,o=e.theme;return a.createElement(s.BaseButton,n.__assign({},this.props,{variantClassName:i?"ms-Button--primary":"ms-Button--default",styles:d.getStyles(o,r,i),onRenderDescription:l.nullRender}))};return e=n.__decorate([l.customizable("DefaultButton",["theme"])],e)}(l.BaseComponent);t.DefaultButton=i});define("wX",["require","exports","d","jP","wS","wR","wY"],function(e,t,a,i,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=i.memoizeFunction(function(e,t,i){var r=s.getStyles(e),o=l.getStyles(e),n={root:{minWidth:"80px",height:"32px"},label:{fontWeight:a.FontWeights.semibold}};return a.concatStyleSets(r,n,i?d.primaryStyles(e):d.standardStyles(e),o,t)})});define("wS",["require","exports","jP","d"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={outline:0},s={fontSize:n.FontSizes.icon,margin:"0 4px",height:"16px",lineHeight:"16px",textAlign:"center",verticalAlign:"middle",flexShrink:0};t.getStyles=i.memoizeFunction(function(e){var t=e.semanticColors,i=t.buttonBorder,r=t.disabledBackground,o=t.disabledText;return{root:[n.getFocusStyle(e,-1,"relative",{left:-2,top:-2,bottom:-2,right:-2,border:"none",outlineColor:"ButtonText"}),e.fonts.medium,{boxSizing:"border-box",border:"1px solid "+i,userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",padding:"0 16px",borderRadius:0}],rootDisabled:{backgroundColor:r,color:o,cursor:"default",pointerEvents:"none",selectors:{":hover":a,":focus":a}},iconDisabled:{color:o},menuIconDisabled:{color:o},flexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},textContainer:{flexGrow:1},icon:s,menuIcon:[s,{fontSize:n.FontSizes.small}],label:{margin:"0 4px",lineHeight:"100%"},screenReaderText:n.hiddenContentStyle}})});define("wR",["require","exports","d","jP"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=i.memoizeFunction(function(e,t){var i={splitButtonContainer:[r.getFocusStyle(e,0,"relative",{left:-2,top:-2,bottom:-2,right:-2,border:"none"}),{display:"inline-block"}],splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:{padding:6,height:"auto",boxSizing:"border-box",border:0,borderRadius:0,outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1},splitButtonDivider:{position:"absolute",width:1,right:31,top:8,bottom:8},splitButtonMenuButtonDisabled:{pointerEvents:"none",selectors:{":hover":{cursor:"default"}}},splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:{outline:"none",border:"none"}};return r.concatStyleSets(i,t)})});define("wY",["require","exports","d"],function(e,t,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.standardStyles=function(e){var t,i=e.semanticColors,r=i.buttonBackground,o=i.buttonBackgroundChecked,n=i.buttonBackgroundHovered,a=i.buttonText,s=i.buttonTextHovered,l=i.buttonTextChecked,d=i.buttonTextCheckedHovered;return{root:{backgroundColor:r,color:a},rootHovered:{backgroundColor:n,color:s},rootPressed:{backgroundColor:o,color:l},rootExpanded:{backgroundColor:o,color:l},rootChecked:{backgroundColor:o,color:l},rootCheckedHovered:{backgroundColor:e.palette.neutralLight,color:d},splitButtonContainer:{selectors:(t={},t[c.HighContrastSelector]={border:"none"},t)},splitButtonMenuButton:{color:e.palette.white,backgroundColor:e.palette.neutralLighter,selectors:{":hover":{backgroundColor:e.palette.neutralLight}}},splitButtonMenuButtonDisabled:{backgroundColor:e.palette.neutralLighter,selectors:{":hover":{backgroundColor:e.palette.neutralLighter}}},splitButtonDivider:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:e.palette.themePrimary},splitButtonMenuButtonExpanded:{backgroundColor:e.palette.neutralLight},splitButtonMenuIcon:{color:e.palette.neutralPrimary},splitButtonMenuIconDisabled:{color:e.palette.neutralTertiary}}};t.primaryStyles=function(e){return{root:{backgroundColor:e.palette.themePrimary,color:e.palette.white,selectors:(t={},t[c.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},t)},rootHovered:{backgroundColor:e.palette.themeDarkAlt,color:e.palette.white,selectors:(i={},i[c.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},i)},rootPressed:{backgroundColor:e.palette.themeDark,color:e.palette.white,selectors:(r={},r[c.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},r)},rootExpanded:{backgroundColor:e.palette.themeDark,color:e.palette.white},rootChecked:{backgroundColor:e.palette.themeDark,color:e.palette.white},rootCheckedHovered:{backgroundColor:e.palette.themePrimary,color:e.palette.white},rootDisabled:{selectors:(o={},o[c.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},o)},splitButtonContainer:{selectors:(n={},n[c.HighContrastSelector]={border:"none"},n)},splitButtonDivider:{backgroundColor:e.palette.themeLighter},splitButtonMenuButton:{backgroundColor:e.palette.themePrimary,color:e.palette.white,selectors:{":hover":{backgroundColor:e.palette.themeDark}}},splitButtonMenuButtonDisabled:{backgroundColor:e.palette.neutralLighter,selectors:{":hover":{backgroundColor:e.palette.neutralLighter}}},splitButtonMenuButtonChecked:{backgroundColor:e.palette.themeDark},splitButtonMenuButtonExpanded:{backgroundColor:e.palette.themeDark},splitButtonMenuIcon:{color:e.palette.white},splitButtonMenuIconDisabled:{color:e.palette.neutralTertiary}};var t,i,r,o,n}});define("w4",["require","exports","ap","at","w8","jP","w5"],function(e,t,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e._shouldUpdateComponentRef=!1;return e}e.prototype.render=function(){var e=this.props,t=e.styles,i=e.theme;return o.createElement(n.BaseButton,r.__assign({},this.props,{variantClassName:"ms-Button--action ms-Button--command",styles:s.getStyles(i,t),onRenderDescription:a.nullRender}))};return e=r.__decorate([a.customizable("ActionButton",["theme"])],e)}(a.BaseComponent);t.ActionButton=i});define("w5",["require","exports","d","jP","wS"],function(e,t,o,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=i.memoizeFunction(function(e,t){var i=n.getStyles(e),r={root:{padding:"0 4px",height:"40px",color:e.palette.neutralPrimary,backgroundColor:"transparent"},rootHovered:{color:e.palette.themePrimary},iconHovered:{color:e.palette.themePrimary},rootPressed:{color:e.palette.black},rootExpanded:{color:e.palette.themePrimary},iconPressed:{color:e.palette.themeDarker},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:"transparent"},rootChecked:{color:e.palette.black},iconChecked:{color:e.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:e.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:e.palette.neutralSecondary},textContainer:{flexGrow:0}};return o.concatStyleSets(i,r,t)})});define("wZ",["require","exports","ap","at","w8","jP","w0"],function(e,t,n,a,s,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){n.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e._shouldUpdateComponentRef=!1;return e}e.prototype.render=function(){var e=this.props,t=e.primary,i=void 0!==t&&t,r=e.styles,o=e.theme;return a.createElement(s.BaseButton,n.__assign({},this.props,{variantClassName:i?"ms-Button--compoundPrimary":"ms-Button--compound",styles:l.getStyles(o,r,i)}))};return e=n.__decorate([i.customizable("CompoundButton",["theme"])],e)}(i.BaseComponent);t.CompoundButton=r});define("w0",["require","exports","d","jP","wS","wR","wY"],function(e,t,c,i,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=i.memoizeFunction(function(e,t,i){var r,o,n=u.getStyles(e),a=p.getStyles(e),s={root:{maxWidth:"280px",minHeight:"72px",height:"auto",padding:"20px"},flexContainer:{flexDirection:"row",alignItems:"flex-start",minWidth:"100%",margin:""},textContainer:{textAlign:"left"},icon:{fontSize:"2em",lineHeight:"1em",height:"1em",margin:"0px 8px 0px 0px",flexBasis:"1em",flexShrink:"0"},label:{margin:"0 0 5px",lineHeight:"100%",fontWeight:c.FontWeights.semibold},description:[e.fonts.small,{lineHeight:"100%"}]},l={description:{color:e.palette.neutralSecondary},descriptionHovered:{color:e.palette.neutralDark},descriptionPressed:{color:"inherit"},descriptionChecked:{color:"inherit"},descriptionDisabled:{color:"inherit"}},d={description:{color:e.palette.white,selectors:(r={},r[c.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},r)},descriptionHovered:{color:e.palette.white,selectors:(o={},o[c.HighContrastSelector]={color:"Window",backgroundColor:"WindowText",MsHighContrastAdjust:"none"},o)},descriptionPressed:{color:"inherit"},descriptionChecked:{color:"inherit"},descriptionDisabled:{color:"inherit"}};return c.concatStyleSets(n,s,i?m.primaryStyles(e):m.standardStyles(e),i?d:l,a,t)})});define("wP",["require","exports","ap","at","w8","jP","wQ"],function(e,t,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e._shouldUpdateComponentRef=!1;return e}e.prototype.render=function(){var e=this.props,t=e.styles,i=e.theme;return o.createElement(n.BaseButton,r.__assign({},this.props,{variantClassName:"ms-Button--icon",styles:s.getStyles(i,t),onRenderText:a.nullRender,onRenderDescription:a.nullRender}))};return e=r.__decorate([a.customizable("IconButton",["theme"])],e)}(a.BaseComponent);t.IconButton=i});define("wQ",["require","exports","d","jP","wS","wR"],function(e,t,s,i,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=i.memoizeFunction(function(e,t){var i=l.getStyles(e),r=d.getStyles(e),o=e.palette,n=e.semanticColors,a={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent"},rootHovered:{color:o.themeDarker,backgroundColor:n.buttonBackground},rootPressed:{color:o.themePrimary,backgroundColor:n.buttonBackgroundHovered},rootExpanded:{color:o.themePrimary},rootChecked:{backgroundColor:n.buttonBackgroundChecked},rootCheckedHovered:{backgroundColor:n.buttonBackgroundHovered},rootDisabled:{color:n.disabledText}};return s.concatStyleSets(i,a,r,t)})});define("wT",["require","exports","ap","at","jP","wW"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){i.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e._shouldUpdateComponentRef=!1;return e}e.prototype.render=function(){return r.createElement(n.DefaultButton,i.__assign({},this.props,{primary:!0,onRenderDescription:o.nullRender}))};return e=i.__decorate([o.customizable("PrimaryButton",["theme"])],e)}(o.BaseComponent);t.PrimaryButton=a});define("w2",["require","exports","ap","at","w8","jP","w3"],function(e,t,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){r.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e._shouldUpdateComponentRef=!1;return e}e.prototype.render=function(){var e=this.props,t=e.styles,i=e.theme;return o.createElement(n.BaseButton,r.__assign({},this.props,{variantClassName:"ms-Button--commandBar",styles:s.getStyles(i,t),onRenderDescription:a.nullRender}))};return e=r.__decorate([a.customizable("CommandBarButton",["theme"])],e)}(a.BaseComponent);t.CommandBarButton=i});define("w3",["require","exports","d","jP","wS","wR"],function(e,t,l,i,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=i.memoizeFunction(function(e,t,i,r){var o,n=d.getStyles(e),a=c.getStyles(e),s={root:[l.getFocusStyle(e,-1,"relative",{left:4,top:4,bottom:4,right:4,border:"none"}),{minWidth:"40px",backgroundColor:e.palette.neutralLighter,color:e.palette.neutralPrimary,padding:"0 4px",selectors:(o={},o[l.HighContrastSelector]={border:"none"},o)}],rootHovered:{backgroundColor:e.palette.neutralLight,color:e.palette.neutralDark},rootPressed:{backgroundColor:e.palette.neutralQuaternaryAlt,color:e.palette.black},rootChecked:{backgroundColor:e.palette.neutralQuaternaryAlt,color:e.palette.black},rootExpanded:{backgroundColor:e.palette.neutralQuaternaryAlt,color:e.palette.black},rootCheckedHovered:{backgroundColor:e.palette.neutralQuaternary,color:e.palette.black},label:{fontWeight:"normal"},icon:{color:e.palette.themeDarkAlt},menuIcon:{color:e.palette.neutralSecondary}};return l.concatStyleSets(n,s,a,t)})});define("w1",["require","exports","w4"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CommandButton=i.ActionButton});define("wU",["require","exports","ap","at","wW","jP","wV"],function(e,t,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.styles,i=e.theme;return o.createElement(n.DefaultButton,r.__assign({},this.props,{styles:s.getStyles(i,t),onRenderDescription:a.nullRender}))};return t=r.__decorate([a.customizable("MessageBarButton",["theme"])],t)}(a.BaseComponent);t.MessageBarButton=i});define("wV",["require","exports","d","jP","wS"],function(e,t,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=i.memoizeFunction(function(e,t,i,r){var o=s.getStyles(e),n={root:{backgroundColor:e.palette.neutralQuaternaryAlt,color:e.palette.neutralPrimary},rootHovered:{backgroundColor:e.palette.neutralTertiaryAlt,color:e.palette.neutralDark},rootPressed:{backgroundColor:e.palette.neutralTertiary,color:e.palette.neutralDark}};return a.concatStyleSets(o,n,t)})});define("F7",["require","exports","ap","at","jP"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement("div",i.__assign({},o.getNativeProps(this.props,o.divProperties)),this.props.children)};return t}(o.BaseComponent);t.PivotItem=n});define("F6",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.links=0]="links";e[e.tabs=1]="tabs"}(t.PivotLinkFormat||(t.PivotLinkFormat={}));!function(e){e[e.normal=0]="normal";e[e.large=1]="large"}(t.PivotLinkSize||(t.PivotLinkSize={}))});define("F9",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_a49f64fd{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0;font-size:14px;font-weight:400;position:relative;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";white-space:nowrap}.links_a49f64fd{font-size:0;height:40px;list-style-type:none;padding:0;white-space:nowrap}.root_a49f64fd .link_a49f64fd{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";display:inline-block;font-size:14px;font-weight:400;line-height:40px;padding:0 8px;text-align:center;position:relative;background-color:transparent;border:0}[dir='ltr'] .root_a49f64fd .link_a49f64fd{margin-right:8px}[dir='rtl'] .root_a49f64fd .link_a49f64fd{margin-left:8px}.root_a49f64fd .link_a49f64fd:hover{cursor:pointer}.root_a49f64fd .link_a49f64fd:focus{outline:none}.root_a49f64fd .link_a49f64fd::before{background-color:transparent;bottom:0;content:'';height:2px;left:8px;position:absolute;right:8px;-webkit-transition:background-color .267s cubic-bezier(0.1, 0.25, 0.75, 0.9);transition:background-color .267s cubic-bezier(0.1, 0.25, 0.75, 0.9)}.root_a49f64fd .link_a49f64fd::after{color:transparent;content:attr(title);display:block;font-weight:bold;height:1px;overflow:hidden;visibility:hidden}.root_a49f64fd .link_a49f64fd .text_a49f64fd,.root_a49f64fd .link_a49f64fd .count_a49f64fd{display:inline-block;vertical-align:top}html[dir='ltr'] .root_a49f64fd .link_a49f64fd .icon_a49f64fd+.text_a49f64fd{margin-left:4px}html[dir='rtl'] .root_a49f64fd .link_a49f64fd .icon_a49f64fd+.text_a49f64fd{margin-right:4px}html[dir='ltr'] .root_a49f64fd .link_a49f64fd .count_a49f64fd{margin-left:4px}html[dir='rtl'] .root_a49f64fd .link_a49f64fd .count_a49f64fd{margin-right:4px}.root_a49f64fd .link_a49f64fd.linkIsSelected_a49f64fd{font-weight:600}.root_a49f64fd .link_a49f64fd.linkIsSelected_a49f64fd::before{-webkit-box-sizing:border-box;box-sizing:border-box;border-bottom:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_a49f64fd .link_a49f64fd.linkIsSelected_a49f64fd::before{border-bottom-color:WindowText}}.root_a49f64fd .link_a49f64fd.linkIsDisabled_a49f64fd{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.ms-Fabric--isFocusVisible .link_a49f64fd:focus{outline:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.link_a49f64fd.linkIsOverflow_a49f64fd{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.link_a49f64fd.linkIsOverflow_a49f64fd.linkIsSelected_a49f64fd{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.link_a49f64fd.linkIsOverflow_a49f64fd:hover:not(.linkIsSelected_a49f64fd),.link_a49f64fd.linkIsOverflow_a49f64fd:focus:not(.linkIsSelected_a49f64fd){color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.link_a49f64fd.linkIsOverflow_a49f64fd:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ellipsis_a49f64fd{font-size:15px;position:relative;top:0}.root_a49f64fd.rootIsLarge_a49f64fd .link_a49f64fd{font-size:17px}.root_a49f64fd.rootIsLarge_a49f64fd .link_a49f64fd.linkIsOverflow_a49f64fd::after{font-size:17px}.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd{height:40px;line-height:40px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding:0 10px;vertical-align:top}.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd::-moz-focus-inner{border:0}.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd{outline:transparent}.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd{position:relative}.ms-Fabric--isFocusVisible .root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#000000"},{rawString:"}[dir='ltr'] .root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd{margin-right:0px}[dir='rtl'] .root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd{margin-left:0px}.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd:hover:not(.linkIsSelected_a49f64fd):not(.linkIsOverflow_a49f64fd),.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd:focus:not(.linkIsSelected_a49f64fd):not(.linkIsOverflow_a49f64fd){color:"},{theme:"black",defaultValue:"#000000"},{rawString:";z-index:1}.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd:active{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd.linkIsSelected_a49f64fd{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-weight:300}.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd.linkIsSelected_a49f64fd::before{background-color:transparent;-webkit-transition:none;transition:none;position:absolute;top:0;left:0;right:0;bottom:0;content:'';height:auto}@media screen and (-ms-high-contrast: active){.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd.linkIsSelected_a49f64fd{color:HighlightText;background:Highlight;-ms-high-contrast-adjust:none}}.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd.linkIsOverflow_a49f64fd:hover:not(.linkIsSelected_a49f64fd),.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd.linkIsOverflow_a49f64fd:focus:not(.linkIsSelected_a49f64fd){background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd.linkIsOverflow_a49f64fd:active{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-Fabric--isFocusVisible .root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd:focus:before{height:auto;background:transparent;-webkit-transition:none;transition:none}@media screen and (-ms-high-contrast: active){.root_a49f64fd.rootIsTabs_a49f64fd .link_a49f64fd.linkIsSelected_a49f64fd{font-weight:600}}\n"}]);t.root="root_a49f64fd";t.links="links_a49f64fd";t.link="link_a49f64fd";t.text="text_a49f64fd";t.count="count_a49f64fd";t.icon="icon_a49f64fd";t.linkIsSelected="linkIsSelected_a49f64fd";t.linkIsDisabled="linkIsDisabled_a49f64fd";t.linkIsOverflow="linkIsOverflow_a49f64fd";t.ellipsis="ellipsis_a49f64fd";t.rootIsLarge="rootIsLarge_a49f64fd";t.rootIsTabs="rootIsTabs_a49f64fd"});define("FV",["require","exports","FZ","FW"],function(e,t,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.buildSource=function(e,t,i,r,o,n){return e?[{key:"Viewers",label:o?a.default.sourceItemUniqueViewersLabel:a.default.sourceUniqueViewersLabel,intervals:a.default.viewIntervals,description:n?void 0:o?a.default.sourceItemUniqueViewersDescription:a.default.sourceUniqueViewersDescription,totalPromise:r.then(function(e){return e.viewerCount}),totalWeekPromise:t&&t.then(function(e){return l(e,"viewerCount")}),totalMonthPromise:i.then(function(e){return l(e,"viewerCount")}),totalDeltaPromise:i.then(function(e){return d(e,"viewerCount")}),totalWeeklyDeltaPromise:t&&t.then(function(e){return d(e,"viewerCount")}),dataPromise:e.then(function(e){return s(e,"viewerCount")}),trendLabelFormat:a.default.trendLastMonthLabel,trendWeeklyLabelFormat:a.default.trendLastWeekLabel,trendUnchangedLabel:a.default.trendLastMonthNoChangeLabel,trendWeeklyUnchangedLabel:a.default.trendLastWeekNoChangeLabel,engagementName:"SourceUniqueViewers"},{key:"Views",label:o?a.default.sourceViewsCountLabel:a.default.sourceSiteVisitsLabel,intervals:a.default.viewIntervals,description:n?void 0:o?a.default.sourceItemVisitsDescription:a.default.sourceSiteVisitsDescription,totalPromise:r.then(function(e){return e.viewCount}),totalWeekPromise:t&&t.then(function(e){return l(e,"viewCount")}),totalMonthPromise:i.then(function(e){return l(e,"viewCount")}),totalDeltaPromise:i.then(function(e){return d(e,"viewCount")}),totalWeeklyDeltaPromise:t&&t.then(function(e){return d(e,"viewCount")}),dataPromise:e.then(function(e){return s(e,"viewCount")}),trendLabelFormat:a.default.trendLastMonthLabel,trendWeeklyLabelFormat:a.default.trendLastWeekLabel,trendUnchangedLabel:a.default.trendLastMonthNoChangeLabel,trendWeeklyUnchangedLabel:a.default.trendLastWeekNoChangeLabel,engagementName:"SourceViews"}]:[]};t.buildRanges=function(){var t=new Date;t=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()));return[{key:"LastWeek",label:a.default.rangeLastWeekLabel,deltaInterval:i.AnalyticsDeltaInterval.LastWeek,totalInterval:i.AnalyticsTotalInterval.AllTime,engagementName:"RangeLastWeek",isCompact:!0,filterData:function(e){return e.filter(function(e){return r(t,e.time)<7})}},{key:"LastMonth",label:a.default.rangeLastMonthLabel,deltaInterval:i.AnalyticsDeltaInterval.LastWeek,totalInterval:i.AnalyticsTotalInterval.AllTime,engagementName:"RangeLastMonth",filterData:function(e){return e.filter(function(e){return r(t,e.time)<30})}},{key:"All",label:a.default.rangeAllLabel,deltaInterval:i.AnalyticsDeltaInterval.LastWeek,totalInterval:i.AnalyticsTotalInterval.AllTime,engagementName:"RangeAllTime"}]};t.getWeeklyRanges=function(t){return{key:"Weekly range",label:""+a.default.rangeLastWeekLabel,filterData:function(e){return e.filter(function(e){return o(t,e.time)<7&&0<o(t,e.time)})}}};function s(e,t){return e.map(function(e){return{time:new Date(e.startDateTime),value:e[t]}})}function l(e,t){if(e||!(e.length<1)){return e[e.length-1][t]}}function d(e,t){if(e||!(e.length<3)){var i=e[e.length-1],r=e[e.length-2],o=i[t],n=r[t];if(0!==n)return Math.ceil((o-n)/n*100)}}function r(e,t){return Math.abs(e.getTime()-t.getTime())/864e5}function o(e,t){return(e.getTime()-t.getTime())/864e5}});define("F2",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-AnalyticsChart{padding-bottom:24px}.ms-AnalyticsChart.is-compact{margin:20px 25px}.ms-AnalyticsChart.is-full{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ms-AnalyticsChart-ChartRoot{overflow:visible!important;width:100%}.ms-AnalyticsChart-ChartRoot svg{overflow:visible}.ms-AnalyticsChart-ChartHost{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;min-height:400px;-ms-flex-pack:center;justify-content:center}.ms-AnalyticsChart-ChartHost>div{width:100%}.ms-AnalyticsChart-Sources{padding-bottom:10px}.is-full .ms-AnalyticsChart-Sources{padding-bottom:44px}.ms-AnalyticsChart-Sources .ms-Pivot.ms-Pivot{height:54px}.is-full .ms-AnalyticsChart-Sources .ms-Pivot.ms-Pivot{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.is-full .ms-AnalyticsChart-Sources .ms-Pivot.ms-Pivot{display:-ms-flexbox;display:flex}.is-full .ms-AnalyticsChart-Sources .ms-Pivot.ms-Pivot .is-selected{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.is-full .ms-AnalyticsChart-Sources .ms-Pivot.ms-Pivot .is-selected .ms-AnalyticsChart-SourcesCell-Total{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.is-compact .ms-AnalyticsChart-Sources .ms-Pivot.ms-Pivot .is-selected .ms-AnalyticsChart-SourcesCell-Label,.is-compact .ms-AnalyticsChart-Sources .ms-Pivot.ms-Pivot .is-selected .ms-AnalyticsChart-SourcesCell-Total{font-weight:600;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-AnalyticsChart-Sources .ms-Pivot.ms-Pivot .is-selected::before{display:none}.ms-AnalyticsChart-Sources .ms-Pivot.ms-Pivot .ms-Pivot-link{-ms-flex-preferred-size:100%;flex-basis:100%;-ms-flex-positive:1;flex-grow:1;height:54px;overflow:hidden}[dir=ltr] .ms-AnalyticsChart-Sources .ms-Pivot.ms-Pivot .ms-Pivot-link{margin-right:0}[dir=rtl] .ms-AnalyticsChart-Sources .ms-Pivot.ms-Pivot .ms-Pivot-link{margin-left:0}.ms-AnalyticsChart-Paging{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.ms-AnalyticsChart-Paging.ms-AnalyticsChart-Paging-Weekly{display:-ms-flexbox;display:flex}.is-full .ms-AnalyticsChart-Paging{display:none}.ms-AnalyticsChart-Button{border:none;background:0 0}.ms-AnalyticsChart-ButtonDivider:before{content:'  |  ';padding:0 8px}.ms-AnalyticsChart-Ranges{min-height:40px}.ms-AnalyticsChart-Ranges .ms-Pivot{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.ms-AnalyticsChart-Ranges.ms-AnalyticsChart-Ranges-Weekly{display:none}.is-compact .ms-AnalyticsChart-Ranges{display:none}.ms-AnalyticsChart-SourcesCell{-ms-flex-align:baseline;align-items:baseline;display:-ms-flexbox;display:flex;width:100%}.ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Label{-ms-flex:0 1 auto;flex:0 1 auto;font-size:21px;font-weight:100;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[dir=ltr] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Label{padding-left:8px}[dir=rtl] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Label{padding-right:8px}.is-compact .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Label{font-size:12px;font-weight:400}.ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Description{display:inline-block}.is-compact .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Description{display:none}[dir=ltr] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Description{margin-left:16px}[dir=rtl] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Description{margin-right:16px}.ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Total{-ms-flex:0 0 auto;flex:0 0 auto;font-weight:400;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.is-full .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Total{font-size:25px}[dir=ltr] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Total{padding-left:25px}[dir=rtl] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Total{padding-right:25px}[dir=ltr] .is-compact .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Total{padding-left:0}[dir=rtl] .is-compact .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Total{padding-right:0}.ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Delta{-ms-flex:0 16 auto;flex:0 16 auto;font-weight:400;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[dir=ltr] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Delta{margin-left:auto}[dir=rtl] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Delta{margin-right:auto}[dir=ltr] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Delta{padding-left:8px}[dir=rtl] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Delta{padding-right:8px}[dir=ltr] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Delta{padding-right:25px}[dir=rtl] .ms-AnalyticsChart-SourcesCell .ms-AnalyticsChart-SourcesCell-Delta{padding-left:25px}.is-compact .ms-AnalyticsChart-Sources .ms-Pivot-link:not(:first-child) .ms-AnalyticsChart-SourcesCell::before{content:' | '}[dir=ltr] .is-compact .ms-AnalyticsChart-Sources .ms-Pivot-link:not(:first-child) .ms-AnalyticsChart-SourcesCell::before{padding-right:16px}[dir=rtl] .is-compact .ms-AnalyticsChart-Sources .ms-Pivot-link:not(:first-child) .ms-AnalyticsChart-SourcesCell::before{padding-left:16px}.ms-AnalyticsChart-DeltaIcon{font-size:.8em;position:relative;top:1px}[dir=ltr] .ms-AnalyticsChart-DeltaIcon{right:2px}[dir=rtl] .ms-AnalyticsChart-DeltaIcon{left:2px}.ms-AnalyticsChart-Tooltip{color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";text-align:center}.ms-AnalyticsChart-Tooltip .ms-AnalyticsChart-Tooltip-Header{font-size:10px}.ms-AnalyticsChart-Tooltip .ms-AnalyticsChart-Tooltip-Body{font-size:21px}.ms-AnalyticsChart-Tooltip .ms-AnalyticsChart-Tooltip-Footer{font-size:10px}.ms-AnalyticsChart-Error{text-align:center}.ms-AnalyticsChart-Error svg{max-width:170px}"}])});define("NG",["require","exports","ap","at","j8","aq","jP","M9","M8","bX","rZ","iE","ep","dZ","dm","by","cE","NI","n7","NH"],function(e,t,r,u,o,n,a,s,l,d,c,p,m,h,f,g,y,v,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.resources=e.resources;t.state={fileHoverCardStore:t.resources.consume(l.resourceKey.optional),graphDataSource:t.resources.consume(h.graph.optional)};t.actionMap=t.resources.consume(d.actionMap);t._pageContext=t.resources.consume(p.pageContext);t._platform=t.resources.consume(g.platformDetection);t._engagement=t.resources.consume(y.resourceKey);return t}e.prototype.componentDidMount=function(){var t=this;this.resources.consumeAsync(l.resourceKey).then(function(e){t.setState({fileHoverCardStore:e})});this.resources.consumeAsync(h.graph).then(function(e){t.setState({graphDataSource:e})})};e.prototype.render=function(){var e=this.state,t=e.fileHoverCardStore,i=e.graphDataSource,r=this.props.item,o=this.props.item.properties.modifiedByUser,n=_.getGraphItemUrl(i,this.props.item),a=o?{displayName:o.title,id:this.props.item.itemId,email:o.email,image:"/_layouts/15/userphoto.aspx?size=S&accountname="+o.email}:void 0,s=r.lifeCycleStatus&&r.lifeCycleStatus.isMalwareDetected?void 0:[{key:"share",icon:"share",title:f.strings.Share,onClick:this.onShare}],l=Number(this._pageContext.webTemplate)===m.default.mySite,d=this._platform.isMobile,c={itemTitle:this.props.item.name,item:{itemId:this.props.item.itemId,graph:this.props.item.graph,extension:this.props.item.extension,graphItemUrl:n,getAccessToken:this.getAccessToken},target:this.props.target,currentUserActivity:{activityDateTime:this.props.item.dateModified,activityType:"Modified",actor:{user:a}},onDetails:this.onDetails,onView:this.onView,showViewers:l,actionBarItems:s,loginUserEmail:this._pageContext.userEmail,gapSpace:this.props.gapData?12+this.props.gapData.inlineCommandCount*v.COMMAND_BUTTON_WIDTH:0};return u.createElement("div",{className:"FileHoverCardField"},t&&i&&!d?u.createElement(b,{fileHoverCardProps:c,fileHoverCardStore:t,target:this.props.target}):this.props.children)};e.prototype.getAccessToken=function(){return _.getGraphAccessToken(this.state.graphDataSource,this.props.item)};e.prototype.onView=function(e){new(this.resources.injected(this.actionMap.ShowItemAnalyticsAction))({item:n.observable(this.props.item)}).execute(e)};e.prototype.onShare=function(e){this._engagement.logData({name:"FileHoverCard.CommandBar.ShareClick"});new(this.resources.injected(this.actionMap.SelectAction))({item:n.observable(this.props.item),showProperties:!1}).execute(e);new(this.resources.injected(this.actionMap.ShowShareAction))({focusItemResourceKey:c.shareFocusItemResourceKey}).execute(e)};e.prototype.onDetails=function(e,t){this._openInfoPane(e)};e.prototype._openInfoPane=function(e){new(this.resources.injected(this.actionMap.SelectAction))({item:n.observable(this.props.item),showProperties:!0}).execute(e)};r.__decorate([a.autobind],e.prototype,"getAccessToken",null);r.__decorate([a.autobind],e.prototype,"onView",null);r.__decorate([a.autobind],e.prototype,"onShare",null);r.__decorate([a.autobind],e.prototype,"onDetails",null);r.__decorate([a.autobind],e.prototype,"_openInfoPane",null);return e}(u.Component);t.default=i;var b=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._itemTitle=e.fileHoverCardProps.itemTitle;t._fileItem=e.fileHoverCardProps.item;t._currentUserActivity=e.fileHoverCardProps.currentUserActivity;t._fileHoverCardStore=e.fileHoverCardStore;return t}e.prototype.getChildContext=function(){return{fileHoverCardStore:this._fileHoverCardStore}};e.prototype.render=function(){return u.createElement("div",{className:"FileHoverCard--item"},u.createElement(s.FileHoverCard,r.__assign({},this.props.fileHoverCardProps,{itemTitle:this._itemTitle,currentUserActivity:this._currentUserActivity,item:this._fileItem,target:this.props.target})))};e.childContextTypes={fileHoverCardStore:o.object.isRequired};return e}(u.Component);t.FileHoverCardWrap=b});define("NI",["require","exports","at","bX","nd","od","nX"],function(e,a,s,i,r,o,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.COMMAND_BUTTON_WIDTH=36;a.createHeroCommandsSectionList=function(e){var t=e.resources.consume(i.disableCalloutInvoker.optional);return s.createElement("span",{className:"od-FieldRenderer-heroCommandContainer"},r.shareHeroCommandRenderer(e),!t&&o.dotDotDotRenderer(e))};a.createHeroCommandsSectionRecentList=function(e){var t=e.resources.consume(i.disableCalloutInvoker.optional);return s.createElement("span",{className:"od-FieldRenderer-heroCommandContainer"},r.shareHeroCommandRenderer(e),n.pinRenderer(e),!t&&o.dotDotDotRenderer(e))};a.nameFieldWithHeroCommands=function(e,t,i,r,o){var n=e.props.children.length*a.COMMAND_BUTTON_WIDTH;return s.createElement("div",{className:"od-FieldRenderer-Renderer-withCommands"},s.createElement("div",{className:i,style:{width:"calc(100% - "+n+"px)"}},t),e)}});define("NH",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-ActivityItem-personaContainer{display:inline}"}])});define("NJ",["require","exports","at","bA","j9","Kv","l0","NK"],function(e,t,n,i,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.activityRenderer=function(e){var t=e.item,i=e.isDisabled,r=void 0!==i&&i,o=s.getViewableItemActivity(t);return n.createElement("div",{className:a.css("od-FieldRenderer-text",{"od-FieldRenderer--disabled":t&&t.properties.isDisabled||r})},o?n.createElement(s.ItemActivityField,{activity:o}):null)};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.activityRenderer)})});define("NK",["c","az"],function(e,t){e.loadStyles([{rawString:".od-ActivityItem-timeStamp{display:inline-block}html[dir=ltr] .od-ActivityItem-timeStamp{padding-left:.3em}html[dir=rtl] .od-ActivityItem-timeStamp{padding-right:.3em}"}])});define("NL",["require","exports","at","V","l8","l7","oe","ba","nP","bA"],function(e,t,m,h,f,g,y,i,v,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=i.isFeatureEnabled(i.PeopleCardsOnLoki),b=i.isFeatureEnabled(i.PeopleCardsReactComponent);t.fileActivityRenderer=function(e){var t=e.item,i=e.column,r=e.isDisabled,o=e.resources,n=t.properties.editorName,a=n&&n.length?n[0]:void 0,s=g.getCellText(t,i),l=a?g.getAriaLabel(i,a.title):"";if(!a)return m.createElement(f.BaseText,{text:s,isDisabled:t.properties.isDisabled||r,ariaLabel:l});v.loadPeopleCardComponent(o);var d=v.generatePeopleCardState([a],o),c="od-FieldRender od-FieldRender-nofill ms-fontWeight-semibold";(_||b)&&(c+=" od-FieldRender-person");var u=v.getUserComponent({resources:o,user:a,ariaLabel:l,cellClassName:c,state:d}),p=h.formatToArray(y.strings.fileActivityContent,u,t.dateModified);return m.createElement("div",{className:"od-FieldRender-activity"},p)};t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.ConstantResourceFactory(t.fileActivityRenderer)})});define("NM",["require","exports","at","nZ","l8","cE","nz","bA","l0"],function(e,t,s,l,d,c,u,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.nameAndPathRenderer=function(e){var t=e.item,i=e.resources.consume(c.resourceKey),r={displayPathSegments:t.displayPath&&t.displayPath.segments||[t.displayName],parentLink:t.parentLink,onClick:function(e){i.logData({name:"MruRecent.FileLocation.Click",isIntentional:!0})}},o=l.signaledNameRendererWithHovercard(e,{inlineCommandCount:0}),n=d.PathRenderer(r),a=s.createElement("div",null,o,n);return u.nameFieldBuildAddOn({fieldRenderer:a,fieldRendererProps:e,addHeroCommands:!0})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.nameAndPathRenderer)})});define("NN",["require","exports","ap","at","l7","bA"],function(e,t,i,d,c,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.clientSideCustomRenderer=function(e){var t=e.item,i=e.column,r=t.properties[i.key],o=c.getAriaLabel(i,r),n=i.clientSideColumnAdapter;if(n&&n.fieldCustomizerLoaded&&n.renderCell)try{var a=n.listViewAdapter;if(a){var s={values:t.properties},l=a.createRowAdapter(s);if(l)return d.createElement(u,{ariaLabel:o,title:r,columnAdapter:n,rowAdapter:l});console.log("Could not create row adapter for column: "+i.internalName)}}catch(e){console.log("Error in using clientSideCustomRenderer, error: "+e)}return d.createElement("div",{title:r,"aria-label":o},r)};var u=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var t=this;return d.createElement("div",{ref:function(e){return t._div=e}})};t.prototype.componentDidMount=function(){var e=document.createElement("DIV");this._div.appendChild(e);this.forceUpdate()};t.prototype.componentWillUnmount=function(){this._cellAdapter&&this._cellAdapter.dispose()};t.prototype.componentDidUpdate=function(e){this._cellAdapter=this.props.columnAdapter.renderCell(this.props.rowAdapter,this._div)};return t}(d.Component);t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.ConstantResourceFactory(t.clientSideCustomRenderer)})});define("NO",["require","exports","ap","bN","aC","bA","gl","fZ","iE","aM","V","cY","eA","bn","NP","aZ","ba","ej","aI","aI","b9","cE","a0","iD","bb"],function(e,t,D,i,p,r,o,n,a,u,A,s,l,M,d,F,L,g,m,h,f,y,v,c,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var R;!function(e){e[e.None=0]="None";e[e.List=1]="List";e[e.ContentType=2]="ContentType";e[e.ProgId=3]="ProgId";e[e.FileType=4]="FileType"}(R||(R={}));var b={1:!0,64:!0,68:!0},N="ClientSideExtension.ListViewCommandSet",O="ClientSideExtension.ListViewCommandSet.ContextMenu",B="ClientSideExtension.ListViewCommandSet.CommandBar",x=function(r){D.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._pageContext=t.pageContext;i._listContext=t.listContext;i._dataRequestor=i.scope.attach(new t.dataRequestorType({}));i._apiUrlHelper=t.apiUrlHelper;i._itemParentHelper=t.itemParentHelper;i._scriptHelper=t.scriptHelper;i._clientSideHelper=t.clientSideHelper;return i}e.prototype.getCustomActionData=function(){var t=this,e=p.default.all([this._getLegacyCustomActions(),this._getTenantAppCustomActions(),this._getLegacyCustomActionsFromLocalStorage()]).then(function(e){for(var t={},i=0,r=e;i<r.length;i++){var o=r[i];for(var n in o){var a=t[n]||[];a.push.apply(a,o[n]);t[n]=a}}return t});(L.isFeatureEnabled(L.CustomActionsInListNext)||this._pageContext.isTenantDevSite)&&(!_.default.isActivated("4A5A7D00-358C-4BA3-8E26-5206C5AD9159","11/29/2017","Enable client-side extensions to all site templates")||b[this._pageContext.webTemplate])&&(e=e.then(function(e){return t.appendCustomActionsFromQueryParameter(e)&&t.loadCustomActionExtensions(e)||e}));return e};e.prototype.prepareAction=function(e,t){var i=this._pageContext.webAbsoluteUrl+"/",r=this._pageContext.layoutsUrl+"/",o=""+i+r,n=this._pageContext.siteAbsoluteUrl+"/",a=""+n+r,s="",l=this._listContext.listId;0===e.toLowerCase().lastIndexOf("javascript:launchapp(",0)&&(l=l.replace(/{/g,"%7B").replace(/-/g,"%2D").replace(/}/g,"%7D"));s=e.replace(/{SiteUrl}/g,i).replace(/~site\//g,i).replace(/~layouts\//g,r).replace(/~siteLayouts\//g,o).replace(/~siteCollection\//g,n).replace(/~siteCollectionLayouts\//g,a).replace(/{ListId}/g,l).replace(/{SelectedListId}/g,l).replace(/{ListUrlDir}/g,this._listContext.listUrl).replace(/{Source}/g,u.default.encodeURIComponent(window.location.href)).replace(/{ModernUX}/g,"true");var d=t&&t[0];if(d){var c=t.map(function(e){return e.properties.ID}).join(",");s=s.replace(/{ItemUrl}/g,u.default.encodeURIComponent(d.id)).replace(/{ItemId}/g,d.properties.ID).replace(/{SelectedItemId}/g,c)}else s=s.replace(/{ItemUrl}/g,null).replace(/{ItemId}/g,null).replace(/{SelectedItemId}/g,null);return s};e.prototype.invokeScriptAction=function(e,t,i,r){var o=this;return this._scriptHelper.enableScripts().then(function(){return o._scriptHelper.invokeScriptAction(e,!1,r)})};e.prototype.loadCustomActionExtensions=function(l){var d=new m.Qos({name:"LoadCustomActionExtensions"});f.default.mark("EUPL.LoadCustomActionExtensions.Start");var e=this._clientSideHelper;e||console.log("Error on consuming ClientSideHelperResource");var c=this.resources.consume(y.resourceKey);return e.getListViewAdapter().then(function(e){f.default.mark("EUPL.LoadCustomActionExtensions.ListViewAdapterPromiseReturn");var t=l.ContextMenu||[],i=l["Ribbon.Documents"]||[],r=l["Ribbon.List"]||[];f.default.mark("EUPL.LoadCustomActionExtensions.AppendActionsFromQueryParameter");var o=function(e,r,o){e.forEach(function(e,t){if(k(r[t])){r[t].children=e;console.log("Set new children for "+r[t].text+", children count: "+e.length);c.logData({name:"LoadCustomActionExtensions."+o,extraData:{childrenActionCount:e.length}})}else{r=r.concat(e);var i=e.length;0<i&&console.log("Added "+i+" custom actions to "+o);c.logData({name:"LoadCustomActionExtensions."+o,extraData:{newActionsCount:i}})}f.default.mark("EUPL.LoadCustomActionExtensions.AddNewActionsTo"+o)});return r},n=S(t,e,0).then(function(e){t=o(e,t,"ContextMenu")}),a=S(i,e,1).then(function(e){i=o(e,i,"RibbonDoc")}),s=S(r,e,2).then(function(e){r=o(e,r,"RibbonList")});return p.default.all([n,a,s]).then(function(e){console.log("Finished loading extensions for all custom actions");d.end({resultType:h.ResultTypeEnum.Success});f.default.mark("EUPL.LoadCustomActionExtensions.End");return{ContextMenu:t,"Ribbon.Documents":i,"Ribbon.List":r}})})};e.prototype.appendCustomActionsFromQueryParameter=function(e){var t=e.ContextMenu||[],i=e["Ribbon.Documents"]||[],r=e["Ribbon.List"]||[],o={"ClientSideExtension.ListViewCommandSet.ContextMenu":"ContextMenu:","ClientSideExtension.ListViewCommandSet.CommandBar":"CommandBar:"},n=new g.default(document.location.href).getQueryParameter("customActions"),a=!1;try{var s=JSON.parse(n);if(s)for(var l in s)try{var d=s[l],c=d.location,u=d.properties,p={text:o[c],action:"",allowMultiSelect:!0,isEnabled:!0,clientSideComponentId:l,clientSideComponentProperties:"object"==typeof u?JSON.stringify(u):""},m=c===N,h=c===O||m,f=c===B||m;h&&t.push(p);if(f){i.push(D.__assign({},p));r.push(D.__assign({},p))}h||f?a=!0:console.log("Invalid location: "+c)}catch(e){console.log("Error processing query parameter for "+l)}}catch(e){console.log("error in parsing query parameter for custom actions")}return a||C(t)||C(i)||C(r)};e.prototype._getLegacyCustomActionsFromLocalStorage=function(){try{var e=localStorage.localStorageCustomActionKey;if(e){var t=JSON.parse(e),i=t&&t.d&&t.d.CustomActionElements&&t.d.CustomActionElements.Items&&t.d.CustomActionElements.Items.results||[];return p.default.wrap(this._parseLegacyCustomActions(i))}}catch(e){console.log("Erorr in parsing LocalStorage provided Customactons.")}return p.default.wrap(null)};e.prototype._getLegacyCustomActions=function(){var i=this,e=this._listContext.listUrl,t=this._apiUrlHelper.build().segment("web").method("GetList",e).segment("CustomActionElements");return this._dataRequestor.getData({url:t.toString(),qosName:"GetCustomAction",noRedirect:!0}).then(function(e){var t=e&&e.d&&e.d.CustomActionElements&&e.d.CustomActionElements.Items&&e.d.CustomActionElements.Items.results||[];return i._parseLegacyCustomActions(t)})};e.prototype._getTenantAppCustomActions=function(){var l=this,e=this._pageContext,t=u.default.escapeUrlForCallback(e.webAbsoluteUrl)+"/_layouts/15/tenantappinfo.ashx?etag=0&lcid="+e.currentLanguage;return this._dataRequestor.getData({url:t,qosName:"GetTenantAppCustomAction"}).then(function(e){for(var t=[],i=0,r=e&&e.apps||[];i<r.length;i++)for(var o=0,n=r[i].customActions;o<n.length;o++){var a=n[o],s={registrationId:a.registrationId,registrationType:R[a.registrationType],requireSiteAdministrator:!1,rights:{High:Number(a.rightsHigh),Low:Number(a.rightsLow)}};l._isActionAllowed(a.action)&&t.push({text:a.title,iconUrl:a.imageUrl,isEnabled:l._getIsEnabled(s),action:a.action})}return{ContextMenu:t}})};e.prototype._getHasPermission=function(t){return t.requireSiteAdministrator?this._pageContext.isSiteAdmin:function(e){return s.PermissionMask.hasItemPermission(e,t.rights)}};e.prototype._getIsItemValid=function(e){var r=this,t=e.registrationType,o=e.registrationId;if(!o)return t===R.List;switch(t){case R.List:var n=parseInt(o,10);return function(e){var t=r.unwrapObservable(r._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),i=t&&t.list;return!!i&&(n===i.templateType||o===i.id)};case R.FileType:var i="."+o;return function(e){return A.equalsCaseInsensitive(e.extension,i)};case R.ContentType:return function(e){var t=e.properties.ContentTypeId;return t&&A.doesStringStartWith(t,o)};case R.ProgId:return function(e){var t=e.properties.ProgId;return t&&t===o}}return!1};e.prototype._getIsEnabled=function(e){var t=this._getHasPermission(e),i=this._getIsItemValid(e);return!(!t||!i)&&function(e){return!!e&&(!("function"==typeof t&&!t(e))&&!("function"==typeof i&&!i(e)))}};e.prototype._getIsEnabledForLegacyAction=function(e,r){var o=this,t=void 0===r||function(e){var t=o.unwrapObservable(o._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),i=t&&t.list;return r!==(i&&!1===i.isDocumentLibrary)};if(e.CommandUIExtension&&e.EnabledScript)return t||!0;var i=this._getIsEnabled({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:{High:Number(e.Rights.High),Low:Number(e.Rights.Low)}});return!!i&&("function"==typeof i?"function"==typeof t?function(e){return i(e)&&t(e)}:i:t)};e.prototype._getIsEnabledForClientSideAction=function(e){var t=this._getHasPermission({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:{High:Number(e.Rights.High),Low:Number(e.Rights.Low)}});return!!t&&function(e){return!e||("function"!=typeof t||t(e))}};e.prototype._parseLegacyCustomActions=function(e){for(var t=[],i=[],r=[],o=new DOMParser,n=0,a=e;n<a.length;n++){var s=a[n],l=s.Location,d=s.RegistrationType;if(l&&0===l.lastIndexOf(N,0)){if(!L.isFeatureEnabled(L.CustomActionsInListNext)&&!this._pageContext.isTenantDevSite)continue;if(!d||d!==R.List)continue;var c=l===N,u=l===O||c,p=l===B||c,m=this._getIsEnabledForClientSideAction(s),h={text:s.Title,isEnabled:m,allowMultiSelect:!0,clientSideComponentId:s.ClientSideComponentId,clientSideComponentProperties:s.ClientSideComponentProperties};u&&r.push(h);if(p){t.push(D.__assign({},h));i.push(D.__assign({},h))}}else{if(!this._isActionAllowed(s.UrlAction))continue;if(s.CommandUIExtension&&A.doesStringStartWith(s.Location,"CommandUI.Ribbon")&&s.UrlAction){var f=this._getIsEnabledForLegacyAction(s,!0),g=this._getIsEnabledForLegacyAction(s,!1),y=void 0;try{y=o.parseFromString(s.CommandUIExtension,M.CamlConstants.doctype)}catch(e){}if(!y)continue;var v=y.getElementsByTagName("Tab");v&&0!==v.length||(v=y.getElementsByTagName("Group"));if(v&&0<v.length){var _=this._getRelatedElement(v,!0),b=this._getRelatedElement(v,!1),x={};if(_||b)for(var S=0,C=y.getElementsByTagName("CommandUIHandlers");S<C.length;S++)for(var P=C[S].firstElementChild;P;){x[P.getAttribute("Command")]=P.getAttribute("CommandAction");P=P.nextElementSibling}if(_){var k=this._getRibbonTabCommand(_,x,s,f);t.push(k)}if(b){k=this._getRibbonTabCommand(b,x,s,g);i.push(k)}}else{var I=y.getElementsByTagName("Button"),T=this._getCommand(I,!0,s,f);T&&t.push(T);var w=this._getCommand(I,!1,s,g);w&&i.push(w)}}else if("EditControlBlock"===s.Location&&s.Title){var E={text:s.Title,isEnabled:this._getIsEnabledForLegacyAction(s),allowMultiSelect:!!s.CommandUIExtension&&!s.EnabledScript,action:s.UrlAction,clientSideComponentId:F.default.Empty,clientSideComponentProperties:""};r.push(E)}}}return{"Ribbon.Documents":t,"Ribbon.List":i,ContextMenu:r}};e.prototype._getCommand=function(e,t,i,r){var o;e&&0<e.length&&(o=this._getRelatedElement(e,t));if(o){var n=o.getAttribute("LabelText")||i.Title;if(n){var a={text:n,allowMultiSelect:!i.EnabledScript,action:i.UrlAction,isEnabled:r,clientSideComponentId:F.default.Empty,clientSideComponentProperties:""},s=this._getIconUrl(e[0]);s&&(a.iconUrl=s);return a}}};e.prototype._getIconUrl=function(e){return e.getAttribute("Image32by32")||e.getAttribute("Image16by16")};e.prototype._getRelatedElement=function(e,t){for(var i=0,r=e.length;i<r;i++){var o=e[i],n=o.getAttribute("Id");if(!n)return o;if((t||!A.doesStringStartWith(n,"Ribbon.Documents"))&&!(t&&A.doesStringStartWith(n,"Ribbon.List")||A.doesStringStartWith(n,"Ribbon.Calendar")))return o}return null};e.prototype._getRibbonTabCommand=function(e,t,i,r){for(var o=[],n=e.getElementsByTagName("Button"),a=0,s=n.length;a<s;a++){var l=n[a],d=l.getAttribute("Command"),c=d&&t[d]||i.UrlAction;if(this._isActionAllowed(c)){var u={text:l.getAttribute("LabelText"),iconUrl:this._getIconUrl(l),isEnabled:r,allowMultiSelect:!i.EnabledScript,action:c,clientSideComponentId:F.default.Empty,clientSideComponentProperties:""};o.push(u)}}return{text:e.getAttribute("Title"),tooltip:e.getAttribute("Description"),children:o}};e.prototype._isActionAllowed=function(e){return!e||("javascript:"!==e.substring(0,11).toLowerCase()||this._scriptHelper.isValidScriptAction(e,!1))};e.dependencies=D.__assign({},i.default.dependencies,{pageContext:a.pageContext,listContext:a.listContext,dataRequestorType:o.typeResourceKey,apiUrlHelper:n.resourceKey,itemParentHelper:l.resourceKey,scriptHelper:d.resourceKey,clientSideHelper:c.clientSideExtensionHelper.optional});return e}(i.default);t.CustomActionDataSource=x;function S(e,t,c,u){void 0===u&&(u={});for(var i=[],r=function(a){if(k(a)){var n=a.children;i.push(S(n,t,c,u).then(function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];n=n.concat(r);var o=r.length;0<o&&console.log("Added "+o+" custom actions to children collection of "+a.text)}return n}))}else{var s=a.clientSideComponentId.toString();if(!s||s===F.default.Empty.toString())return"continue";var l=a.clientSideComponentProperties,d=s+"-"+l,e=t.loadCommandSet(s,l).then(function(e){var t=[];if(u[d])console.log("already processed, skip id "+s+", location: "+c);else{for(var i=0,r=e.commandAdapters;i<r.length;i++){var o=r[i],n={text:o.title,iconUrl:o.iconUrl||a.iconUrl,allowMultiSelect:a.allowMultiSelect,action:a.action,isEnabled:a.isEnabled,clientSideComponentId:a.clientSideComponentId,clientSideComponentProperties:l,clientSideCommandAdapter:o};t.push(n)}v.Engagement.logData({name:"LoadCustomActionExtensionsCommandSet",extraData:{commandCount:t.length}});u[d]=!0}return t},function(e){console.log("Failed to loadCommandSet, id: "+s+", error: "+e);return[]});i.push(e)}},o=0,n=e;o<n.length;o++){r(n[o])}return p.default.all(i)}function C(e){return e.some(P)}function P(e){if(k(e))return C(e.children);var t=e.clientSideComponentId;return!!t&&t!==F.default.Empty}function k(e){return"children"in e}t.default=x;t.resourceKey=r.createResolvedResourceKey(e("module").id,x)});define("NP",["require","exports","aC","gm","c9","bA","iE"],function(e,t,a,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={"strings.js":{isLocalized:!0},"sp.res.resx":{path:"sp.res.js",isLocalized:!0},"sp.runtime.js":{dependencies:["sp.res.resx"]},"sp.js":{dependencies:["sp.runtime.js","sp.ui.dialog.js","sp.res.resx"]},"sp.init.js":{},"sp.ui.dialog.js":{dependencies:["sp.init.js","sp.res.resx"]},"core.js":{dependencies:["strings.js"]},"menu.js":{},"mQuery.js":{path:"mquery.js"},"callout.js":{dependencies:["strings.js","mQuery.js","core.js"]},"sp.core.js":{dependencies:["strings.js","sp.init.js","core.js"]},"sharedhovercard.strings.js":{isLocalized:!0},"sharedhovercard.js":{dependencies:["sharedhovercard.strings.js"]},"sharing.js":{dependencies:["strings.js","mQuery.js","core.js"]},"suitelinks.js":{dependencies:["strings.js","core.js"]},"clientrenderer.js":{},"srch.resources.resx":{path:"srch.resources.js",isLocalized:!0},"search.clientcontrols.js":{dependencies:["sp.init.js","clientrenderer.js","srch.resources.resx"]},"sp.search.js":{dependencies:["sp.init.js","sp.runtime.js"]},"ajaxtoolkit.js":{dependencies:["search.clientcontrols.js"]},userprofile:{path:"sp.userprofiles.js",dependencies:["sp.runtime.js"]},"followingcommon.js":{dependencies:["strings.js","sp.js","userprofile","core.js","mQuery.js"]},"profilebrowserscriptres.resx":{path:"profilebrowserscriptres.js",isLocalized:!0},"sp.ui.mysitecommon.js":{dependencies:["sp.init.js","sp.runtime.js","userprofile","profilebrowserscriptres.resx"]},browserScript:{path:"ie55up.js",dependencies:["strings.js"]},inplview:{path:"inplview.js",dependencies:["strings.js","core.js","sp.js"]},"datepicker.js":{dependencies:["strings.js"]},"sp.jsgrid.res.resx?All":{path:"sp.jsgrid.res.js",isLocalized:!0},"jsgrid.js":{dependencies:["sp.jsgrid.res.resx?All"]},"sp.datetimeutil.js":{},"jsgrid.gantt.js":{dependencies:["jsgrid.js","sp.datetimeutil.js"]},"spgantt.js":{dependencies:["strings.js","sp.runtime.js","jsgrid.js","jsgrid.gantt.js"]},"clientforms.js":{dependencies:["strings.js"]},"autofill.js":{},"clientpeoplepicker.js":{dependencies:["strings.js","autofill.js"]},"sp.ui.combobox.js":{dependencies:["sp.res.resx"]},"jsapiextensibilitymanager.js":{},"ganttsharedapi.generated.js":{},"ganttapishim.generated.js":{},"createsharedfolderdialog.js":{dependencies:["strings.js","clientpeoplepicker.js","clientforms.js"]},"dragdrop.js":{dependencies:["strings.js"]},"filePreview.js":{path:"filepreview.js",dependencies:["core.js"]},"sp.ui.listsearchbox.js":{dependencies:["search.clientcontrols.js","profilebrowserscriptres.resx"]},"sp.search.apps.js":{},"movecopy.js":{},"dlp.js":{},"offline.js":{},"theming.js":{},"cui.js":{},ribbon:{path:"sp.ribbon.js",dependencies:["strings.js","core.js","sp.core.js","sp.js","cui.js","sp.res.resx","sp.runtime.js","inplview"]},WPAdderClass:{path:"wpadder.js"},"quicklaunch.js":{dependencies:["strings.js","dragdrop.js"]},"sp.directory.js":{dependencies:["sp.js"]},"group.js":{dependencies:["strings.js","sp.directory.js","sp.js","sp.init.js","sp.runtime.js"]},"helppanel.js":{},"sp.requestexecutor.js":{dependencies:["sp.res.resx"]}},s=function(){function e(e,t){this._pageContext=t.pageContext}e.prototype.enableScripts=function(){var d=this;if(this._scriptPromise)return this._scriptPromise;var c=this._getLayoutPath();i.default.addConfig({paths:{init:c+"/init",core:c+"/core",msajax:c+"/msajaxbundle"},enforceDefine:!1,shim:{core:{deps:["init","msajax"]}}});return this._scriptPromise=r.loadModule({path:"core",getModule:function(){return new a.default(function(e,t){window.require(["core"],e,t)})}}).then(function(){var e=window.RegisterSod,t=window.RegisterSodDep;if("function"==typeof e&&"function"==typeof t){var i=d._pageContext.currentLanguage,r=c+"/"+i+"/";for(var o in u){var n=u[o],a=n.path||o;e(o,""+(n.isLocalized?r:c)+a);for(var s=0,l=n.dependencies||[];s<l.length;s++){t(o,l[s])}}}})};e.prototype.isValidScriptAction=function(e,t){if(t)return!0;if("javascript:LaunchApp("===e.substring(0,21)&&");"===e.substring(e.length-2)){var i=this._prepareJson(e);try{JSON.parse(i);return!0}catch(e){return!1}}return!1};e.prototype.invokeScriptAction=function(e,t,i){if(t)try{new Function("item","count",e).call(void 0,i&&0<i.length?i[0].properties:null,i?i.length:0);return a.default.wrap()}catch(e){return a.default.wrapError(e)}else{if("javascript:LaunchApp("!==e.substring(0,21)||");"!==e.substring(e.length-2))return a.default.wrapError(new Error("Action is invalid."));var r=window.LaunchApp;if("function"==typeof r){var o=this._prepareJson(e);try{var n=JSON.parse(o);n[5]=!0;r.apply(null,n);return a.default.wrap()}catch(e){return a.default.wrapError(e)}}}};e.prototype._prepareJson=function(e){return e.replace("javascript:LaunchApp(","[").replace(");","]").replace(/'/g,'"').replace(/(width|height|title):/g,'"$1":')};e.prototype._getLayoutPath=function(){var e=this._pageContext,t=e.cdnPrefix?"https://"+e.cdnPrefix:e.webAbsoluteUrl;t+="/"+e.layoutsUrl;if(e.cdnPrefix){var i=e.siteClientTag;if(i){var r=i.indexOf("$$");0<r&&(t+="/"+i.substring(r+2))}}return t};return e}();t.LegacyScriptHelper=s;t.default=s;t.resourceKey=o.createResolvedResourceKey(e("module").id,s,{pageContext:n.pageContext})});define("NQ",["require","exports","NS","b3","NR"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"ms-legacy-details-pane-host",name:e("module").id,template:e("NR"),viewModelType:i.default});t.default=t.resourceKey});define("NS",["require","exports","ap","bF","Kk","NT","oq","ba","qs","d0","b3"],function(e,t,i,o,n,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=r.call(this,e,t)||this;i.useNewDetailsPane=l.isFeatureEnabled(l.EnableNewDetailsPane);if(i.useNewDetailsPane){i.addBindingHandlers({react:s.default});i.detailsPaneComponentType=n.ResourcedControl;i.detailsPaneProps=i.observables.pureCompute(function(){return{resources:i.resources,specification:n.toSpecification(a.typeResourceKey.local,{})}})}else{i.addBindingHandlers({control:u.default});i.knockoutSpecification=u.toSpecification(d.resourceKey,{showSections:e.showSections});i.knockoutPlaceholder=u.toSpecification(c.resourceKey,{})}return i}e.dependencies=i.__assign({},o.default.dependencies);return e}(o.default);t.default=r});define("NT",["require","exports","ap","at","j8","bX","NV","NU","Kk","bA"],function(e,t,i,a,o,n,s,l,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i.state={currentItem:i._getCurrentItem(e),selectedItems:i._getSelectedItems(e),allSectionGroups:void 0};return i}e.prototype.componentDidMount=function(){this._addStoreListener(this.props)};e.prototype.componentWillUnmount=function(){this._removeCurrentStoreListener()};e.prototype.render=function(){var e=this.context.dependencies.resources,t=this.state,i=t.currentItem,r=t.selectedItems,o=t.allSectionGroups,n=0<r.length?r:[i];return o?a.createElement("div",{className:"od-DetailsPaneWrapper"},a.createElement(s.default,{items:n,allSectionGroups:o,resources:e})):null};e.prototype._removeCurrentStoreListener=function(){this._selectionListener.dispose()};e.prototype._addStoreListener=function(e){var i=this,r=this.context.dependencies.resources;this._selectionListener=this._getSelectionModel(e).selection.subscribe(function(e){i.setState({selectedItems:e})});r.consume(l.resourceKey).getInfoPaneManager().then(function(e){var t=new(r.injected(e));i.setState({allSectionGroups:t.getSectionGroups()})})};e.prototype._getCurrentItem=function(e){return this.context.dependencies.resources.consume(n.currentItem)};e.prototype._getSelectedItems=function(e){return this._getSelectionModel(e).selection.peek()};e.prototype._getSelectionModel=function(e){var t=this.context.dependencies.resources,i=t.consume(n.currentSelectionModelGroup.optional);if(i){var r=i.currentSelection();if(r&&r.itemSet)return r}return t.consume(n.itemsSelection)};e.contextTypes={dependencies:o.object.isRequired};return e}(a.Component);t.default=c;t.typeResourceKey=r.createResolvedComponentTypeResourceKey(e("module").id,c,{resources:d.resourceScopeKey.local})});define("NV",["require","exports","ap","at","au","QO","bP","jP","QM","NX","jP","bD","NW"],function(e,t,i,p,m,h,o,n,f,g,y,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._scope=new a.default;i._observables=i._scope.attach(new o.default({owner:i}));i.state={availableSectionGroups:i._observables.ignore(function(){return i._computeSectionGroups(e)}),isSecondaryPaneExpanded:!1,detailsPaneHeight:void 0,primaryHeaderHeight:void 0,secondaryHeaderHeight:void 0,scrollPosition:0};return i}e.prototype.componentDidMount=function(){this._addStoreListener(this.props);if(this._detailsPaneElement){this._updateDetailsPaneHeight();this._events.on(window,"resize",this._updateDetailsPaneHeight)}};e.prototype.componentWillReceiveProps=function(e){var t=this;e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this.setState({availableSectionGroups:this._observables.ignore(function(){return t._computeSectionGroups(e)})})};e.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.allSectionGroups!==this.props.allSectionGroups||e.resources!==this.props.resources||t.availableSectionGroups!==this.state.availableSectionGroups||t.isSecondaryPaneExpanded!==this.state.isSecondaryPaneExpanded||t.detailsPaneHeight!==this.state.detailsPaneHeight||t.primaryHeaderHeight!==this.state.primaryHeaderHeight||t.secondaryHeaderHeight!==this.state.secondaryHeaderHeight};e.prototype.componentWillUpdate=function(e){e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this._removeCurrentStoreListener()};e.prototype.componentDidUpdate=function(e){e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this._addStoreListener(this.props);if(this._primaryPaneElement&&1===e.items.length&&1===this.props.items.length&&e.items[0].peek().key!==this.props.items[0].peek().key){this._primaryPaneElement.scrollIntoView(!0);this.setState({isSecondaryPaneExpanded:!1,scrollPosition:0})}};e.prototype.componentWillUnmount=function(){this._removeCurrentStoreListener();this._detailsPaneElement&&this._events.off(window,"resize",this._updateDetailsPaneHeight);this._scope.dispose()};e.prototype.render=function(){var t=this,e=this.props,i=e.items,r=e.resources,o=this.state,n=o.availableSectionGroups,a=o.isSecondaryPaneExpanded,s=o.detailsPaneHeight,l=o.primaryHeaderHeight,d=o.secondaryHeaderHeight,c=o.scrollPosition;if(n&&n[0]){var u=0===n[0].sections.length;return p.createElement("div",{ref:function(e){t._detailsPaneElement=e},"data-automationid":"ms-info-pane",className:y.css("od-DetailsPane",{"od-DetailsPane--secondaryPaneDisabled":!n[1]||!n[1].sections.length})},p.createElement(h.ScrollablePane,{componentRef:function(e){t._scrollablePane=e},initialScrollPosition:!a&&c,className:"od-DetailsPane-scrollablePane"},p.createElement(f.default,{ref:function(e){t._primaryPaneElement=m.findDOMNode(e)},items:i,sectionGroup:n[0],onHeightChange:this._onPaneHeightChange,onHeaderHeightChange:this._onPrimaryHeaderHeightChange,isCollapsed:a||u,minHeight:s&&s-(d||0)+1,resources:r}),n[1]?p.createElement(g.default,{ref:function(e){t._secondaryPaneElement=m.findDOMNode(e)},items:i,sectionGroup:n[1],onHeaderClick:this._onSecondaryPaneHeaderClick,isHeaderClickDisabled:u,onHeightChange:this._onPaneHeightChange,onHeaderHeightChange:this._onSecondaryHeaderHeightChange,minHeight:s&&void 0!==l&&s-l,resources:r}):null))}return null};e.prototype._onPrimaryHeaderHeightChange=function(e){this.setState({primaryHeaderHeight:e})};e.prototype._onSecondaryHeaderHeightChange=function(e){this.setState({secondaryHeaderHeight:e})};e.prototype._onPaneHeightChange=function(){this._scrollablePane&&this._scrollablePane.forceLayoutUpdate()};e.prototype._onSecondaryPaneHeaderClick=function(){if(this._detailsPaneElement&&this._primaryPaneElement&&this._secondaryPaneElement){var e=this._detailsPaneElement.getBoundingClientRect().top;if(this._secondaryPaneElement.getBoundingClientRect().top-e<this._detailsPaneElement.clientHeight/2){this._primaryPaneElement.scrollIntoView(!0);this.setState({isSecondaryPaneExpanded:!1})}else{var t=this._scrollablePane.getScrollPosition();this._secondaryPaneElement.scrollIntoView(!0);this.setState({isSecondaryPaneExpanded:!0,scrollPosition:t})}}};e.prototype._updateDetailsPaneHeight=function(){this.setState({detailsPaneHeight:this._detailsPaneElement.clientHeight})};e.prototype._removeCurrentStoreListener=function(){this._sectionGroupsSubscription.dispose()};e.prototype._addStoreListener=function(e){var t=this,i=this._observables.pureCompute(function(){return t._computeSectionGroups(e)});this._sectionGroupsSubscription=this._observables.subscribe(i,function(e){t.setState({availableSectionGroups:e})})};e.prototype._computeSectionGroups=function(t){return t.allSectionGroups.map(function(e){return{sections:e.sections.filter(function(e){return e.isAvailable(t.items.map(function(e){return e.peek()}))})}})};i.__decorate([n.autobind],e.prototype,"_onPrimaryHeaderHeightChange",null);i.__decorate([n.autobind],e.prototype,"_onSecondaryHeaderHeightChange",null);i.__decorate([n.autobind],e.prototype,"_onPaneHeightChange",null);i.__decorate([n.autobind],e.prototype,"_onSecondaryPaneHeaderClick",null);return e}(y.BaseComponent);t.default=r});define("QO",["require","exports","ap","QP"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("QP",["require","exports","ap","QR","QQ"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("QR",["require","exports","jP","QQ","QS"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ScrollablePane=i.styled(r.ScrollablePaneBase,o.getStyles)});define("QQ",["require","exports","ap","at","j8","jP"],function(e,t,n,a,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=s.classNamesFunction(),i=function(i){n.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._root=s.createRef();t._stickyAboveRef=s.createRef();t._stickyBelowRef=s.createRef();t.subscribe=function(e){t._subscribers.add(e)};t.unsubscribe=function(e){t._subscribers.delete(e)};t.addStickyHeader=function(e){t._addSticky(e,t._stickyAbove,function(){t._stickyAboveRef.current&&t._stickyAboveRef.current.appendChild(e.content)})};t.addStickyFooter=function(e){t._addSticky(e,t._stickyBelow,function(){t._stickyBelowRef.current&&t._stickyBelowRef.current.insertBefore(e.content,t._stickyBelowRef.current.firstChild)})};t.removeStickyHeader=function(e){t._removeSticky(e,t._stickyAbove,t._stickyAboveRef.current)};t.removeStickyFooter=function(e){t._removeSticky(e,t._stickyBelow,t._stickyBelowRef.current)};t.notifySubscribers=function(e){t._subscribers.forEach(function(e){t._stickyAboveRef.current&&t._stickyBelowRef.current&&e(t._stickyAboveRef.current.getBoundingClientRect(),t._stickyBelowRef.current.getBoundingClientRect())});1<t._stickyAbove.size&&t._sortStickies(t._stickyAbove,t._stickyAboveRef.current);1<t._stickyBelow.size&&t._sortStickies(t._stickyBelow,t._stickyBelowRef.current)};t.getScrollPosition=function(){return t._root.current?t._root.current.scrollTop:0};t._setPlaceholderHeights=function(e){e.forEach(function(e,t){e.setPlaceholderHeight(e.content.clientHeight)})};t._subscribers=new Set;t._stickyAbove=new Set;t._stickyBelow=new Set;return t}Object.defineProperty(e.prototype,"root",{get:function(){return this._root.current},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"stickyAbove",{get:function(){return this._stickyAboveRef.current},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"stickyBelow",{get:function(){return this._stickyBelowRef.current},enumerable:!0,configurable:!0});e.prototype.getChildContext=function(){return{scrollablePane:{subscribe:this.subscribe,unsubscribe:this.unsubscribe,addStickyHeader:this.addStickyHeader,removeStickyHeader:this.removeStickyHeader,addStickyFooter:this.addStickyFooter,removeStickyFooter:this.removeStickyFooter,notifySubscribers:this.notifySubscribers}}};e.prototype.componentDidMount=function(){this._events.on(this._root.current,"scroll",this.notifySubscribers);this._events.on(window,"resize",this._onWindowResize)};e.prototype.componentWillUnmount=function(){this._events.off(this._root.current);this._events.off(window)};e.prototype.componentDidUpdate=function(e){var t=this.props.initialScrollPosition;this._root.current&&t&&e.initialScrollPosition!==t&&(this._root.current.scrollTop=t)};e.prototype.render=function(){var e=this.props,t=e.className,i=e.theme,r=e.getStyles,o=l(r,{theme:i,className:t});return a.createElement("div",n.__assign({},s.getNativeProps(this.props,s.divProperties),{ref:this._root,className:o.root}),a.createElement("div",{ref:this._stickyAboveRef,className:o.stickyAbove}),a.createElement("div",{ref:this._stickyBelowRef,className:o.stickyBelow}),a.createElement("div",{"data-is-scrollable":!0},this.props.children))};e.prototype.forceLayoutUpdate=function(){this._onWindowResize()};e.prototype._addSticky=function(e,t,i){if(!t.has(e)){t.add(e);i();e.content.addEventListener("transitionend",this._setPlaceholderHeights.bind(null,t),!1);e.props.stickyClassName&&this._async.setTimeout(function(){e.props.stickyClassName&&e.content.children[0].classList.add(e.props.stickyClassName)},1);this._setPlaceholderHeights(t)}};e.prototype._removeSticky=function(e,t,i){if(i&&t.has(e)){e.content.removeEventListener("transitionend",this._setPlaceholderHeights.bind(null,t,i));t.delete(e)}};e.prototype._onWindowResize=function(){var e=this;this._async.setTimeout(function(){e.notifySubscribers();e._setPlaceholderHeights(e._stickyAbove);e._setPlaceholderHeights(e._stickyBelow)},5)};e.prototype._sortStickies=function(e,t){var i=this;if(t){var r=Array.from(e);r=r.sort(function(e,t){return i._calculateOffsetParent(e.root.current)-i._calculateOffsetParent(t.root.current)});for(var o=0;o<t.children.length&&o<r.length&&t.children[o]===r[o].content;)++o;for(var n=t.children.length-1;o<=n;--n)t.removeChild(t.children[n]);for(n=o;n<r.length;++n)t.appendChild(r[n].content)}};e.prototype._calculateOffsetParent=function(e){for(var t=0;e&&this._root.current&&e.offsetParent!==this._root.current.offsetParent;){t+=e.offsetTop;e.parentElement&&(e=e.parentElement)}return t};e.childContextTypes={scrollablePane:r.object};return e=n.__decorate([s.customizable("ScrollablePane",["theme"])],e)}(s.BaseComponent);t.ScrollablePaneBase=i});define("QS",["require","exports","d"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t,i,r={position:"absolute",pointerEvents:"auto",width:"100%",zIndex:1};return{root:["ms-ScrollablePane",{overflowY:"auto",maxHeight:"inherit",height:"inherit",WebkitOverflowScrolling:"touch"},e.className],stickyAbove:[{top:0,selectors:(t={},t[o.HighContrastSelector]={borderBottom:"1px solid WindowText"},t)},r],stickyBelow:[{bottom:0,selectors:(i={},i[o.HighContrastSelector]={borderTop:"1px solid WindowText"},i)},r]}}});define("QM",["require","exports","ap","at","l8","dn","dj","V","jP","QK","QG","QF","NZ","ob","QN"],function(e,t,i,h,f,g,y,r,n,a,s,o,l,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){if(this._headerDiv){this._onHeaderHeightChange();this._events.on(window,"resize",this._onHeaderHeightChange)}};t.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.sectionGroup!==this.props.sectionGroup||e.isCollapsed!==this.props.isCollapsed||e.minHeight!==this.props.minHeight||e.onHeightChange!==this.props.onHeightChange||e.onHeaderHeightChange!==this.props.onHeaderHeightChange||e.resources!==this.props.resources};t.prototype.componentWillUnmount=function(){this._headerDiv&&this._events.off(window,"resize",this._onHeaderHeightChange)};t.prototype.render=function(){var t=this,e=this.props,i=e.isCollapsed,r=e.minHeight,o=e.onHeightChange;return h.createElement("div",{className:n.css("od-DetailsPane-PrimaryPane-wrapper",{"od-DetailsPane-PrimaryPane--isCollapsed":i}),style:{minHeight:!i&&r||this._headerDiv&&this._headerDiv.clientHeight}},h.createElement("div",{className:"od-DetailsPane-PrimaryPane"},h.createElement("div",{ref:function(e){t._headerDiv=e}},h.createElement(s.Sticky,null,this._renderSectionsHeader())),h.createElement("div",{className:"od-DetailsPane-PrimaryPane-body"},h.createElement(a.default,{onHeightChange:o},this._renderSectionsBody()))))};t.prototype._renderSectionsHeader=function(){var e,t=this.props.items;e=1===t.length?t[0].peek().displayName:r.format(o.strings.multipleItemsSelected,t.length);var i=this._renderPaneIcon();return h.createElement("div",{className:"od-DetailsPane-PrimaryPane-header",tabIndex:0},h.createElement("div",{className:"od-DetailsPane-PrimaryPane-header-icon"},i),h.createElement("div",{className:"od-DetailsPane-PrimaryPane-header-title",title:e},e))};t.prototype._renderPaneIcon=function(){var e,t,i,r,o,n,a,s,l=this.props,d=l.items,c=l.resources;if(1===d.length){var u=d[0].peek();e=u.iconName||"genericfile";var p=u.extension,m=c.consume(y.resourceKey.optional);t=u.iconUrl||(s=p,(a=m)&&a.getFileTypeIconUrl(s,!0))||g.getIconUrl(c,e,32);i=(n=p,(o=m)&&o.getFileTypeName(n,!0));r=v.getTooltipText(u)}else{e="genericfile";t=g.getIconUrl(c,e,32)}return h.createElement(f.FileTypeIconRenderer,{iconName:e,width:32,iconUrl:t,iconTitle:i,isDisabled:!1,tooltipText:r,ariaLabel:i,isClickable:!1,onClick:this._fileIconOnClick})};t.prototype._fileIconOnClick=function(e){};t.prototype._renderSectionsBody=function(){var e=this.props,t=e.items,i=e.sectionGroup,r=e.resources;return h.createElement(l.default,{items:t,sections:i.sections,resources:r})};t.prototype._onHeaderHeightChange=function(){if(this.props.onHeaderHeightChange){var e=this._headerDiv.clientHeight;this.props.onHeaderHeightChange(e)}};i.__decorate([n.autobind],t.prototype,"_fileIconOnClick",null);i.__decorate([n.autobind],t.prototype,"_onHeaderHeightChange",null);return t}(n.BaseComponent);t.default=d});define("QK",["require","exports","ap","at","bT","QL"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=new o.default(window),a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.shouldComponentUpdate=function(e,t){return e.children!==this.props.children};t.prototype.componentDidMount=function(){var e=this;this._iframeElement&&n.on(this._iframeElement.contentWindow,"resize",function(){e.props.onHeightChange()})};t.prototype.componentWillUnmount=function(){this._iframeElement&&n.off(this._iframeElement.contentWindow,"resize")};t.prototype.render=function(){var t=this;return r.createElement("div",{className:"od-ParentHeightWatcher"},r.createElement("iframe",{ref:function(e){t._iframeElement=e},className:"od-ParentHeightWatcher-iframe"}),this.props.children)};return t}(r.Component);t.default=a});define("QL",["c","az"],function(e,t){e.loadStyles([{rawString:".od-ParentHeightWatcher-iframe{position:absolute;top:0;bottom:0;left:0;right:0;height:100%;width:0;visibility:hidden}"}])});define("QG",["require","exports","ap","QH"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("QH",["require","exports","ap","QJ","QI"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("QJ",["require","exports","ap","at","au","j8","jP","QI"],function(e,t,i,s,l,r,o,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(e){var u=t.call(this,e)||this;u.root=o.createRef();u._onScrollEvent=function(e,t){if(u.root.current){var i=u.root.current.getBoundingClientRect(),r=i.top,o=i.bottom,n=u.state,a=n.isStickyTop,s=n.isStickyBottom,l=u.props.stickyPosition,d=l===p.StickyPositionType.Both||l===p.StickyPositionType.Header,c=l===p.StickyPositionType.Both||l===p.StickyPositionType.Footer;u.setState({isStickyTop:d&&(r<=e.bottom||a&&o<e.bottom),isStickyBottom:c&&(o>=t.top||s&&r>t.top)})}};u.state={isStickyTop:!1,isStickyBottom:!1};return u}e.prototype.componentDidMount=function(){if(!this.context.scrollablePane)throw new TypeError("Expected Sticky to be mounted within ScrollablePane");this.context.scrollablePane.subscribe(this._onScrollEvent);this.content=document.createElement("div");this.content.style.background=this.props.stickyBackgroundColor||this._getBackground();l.render(s.createElement("div",null,this.props.children),this.content);this.root.current&&this.root.current.appendChild(this.content);this.context.scrollablePane.notifySubscribers(!0)};e.prototype.componentWillUnmount=function(){var e=this,t=this.state,i=t.isStickyTop,r=t.isStickyBottom,o=this.context.scrollablePane;i&&this._resetSticky(function(){o.removeStickyHeader(e)});r&&this._resetSticky(function(){o.removeStickyFooter(e)});o.unsubscribe(this._onScrollEvent)};e.prototype.componentDidUpdate=function(e,t){var i=this,r=this.state,o=r.isStickyTop,n=r.isStickyBottom,a=this.context.scrollablePane;this.props.children!==e.children&&l.render(s.createElement("div",null,this.props.children),this.content);o&&!t.isStickyTop?this._setSticky(function(){a.addStickyHeader(i)}):!o&&t.isStickyTop&&this._resetSticky(function(){a.removeStickyHeader(i)});n&&!t.isStickyBottom?this._setSticky(function(){a.addStickyFooter(i)}):!n&&t.isStickyBottom&&this._resetSticky(function(){a.removeStickyFooter(i)})};e.prototype.shouldComponentUpdate=function(e,t){var i=this.state,r=i.isStickyTop,o=i.isStickyBottom,n=i.placeholderHeight;return r!==t.isStickyTop||o!==t.isStickyBottom||n!==t.placeholderHeight||this.props.children!==e.children};e.prototype.setPlaceholderHeight=function(e){this.setState({placeholderHeight:e})};e.prototype.render=function(){var e=this.state,t=e.isStickyTop,i=e.isStickyBottom,r=e.placeholderHeight,o=t||i;return s.createElement("div",{ref:this.root},s.createElement("div",{style:{height:o?r:0}}))};e.prototype._setSticky=function(e){this.content.parentElement&&this.content.parentElement.removeChild(this.content);e()};e.prototype._resetSticky=function(e){var t=this;this.root.current&&this.root.current.appendChild(this.content);setTimeout(function(){t.props.stickyClassName&&t.content.children[0].classList.remove(t.props.stickyClassName)},1);e()};e.prototype._getBackground=function(){if(!this.root.current)return null;for(var e=this.root.current;"rgba(0, 0, 0, 0)"===window.getComputedStyle(e).getPropertyValue("background-color")||"transparent"===window.getComputedStyle(e).getPropertyValue("background-color");){if("HTML"===e.tagName)return null;e.parentElement&&(e=e.parentElement)}return window.getComputedStyle(e).getPropertyValue("background-color")};e.defaultProps={stickyPosition:p.StickyPositionType.Both};e.contextTypes={scrollablePane:r.object};return e}(o.BaseComponent);t.Sticky=n});define("QI",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Both=0]="Both";e[e.Header=1]="Header";e[e.Footer=2]="Footer"}(t.StickyPositionType||(t.StickyPositionType={}))});define("NZ",["require","exports","ap","at","Qh","PS","PE","Px","Pb","O5","OS","N2","N0"],function(e,t,i,o,n,a,s,l,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var t=this,e=this.props.sections.map(function(e){return t._renderSection(e)});return o.createElement("div",null,e)};t.prototype._renderSection=function(e){var t=this.props,i=t.items,r=t.resources;return 9===e.type?o.createElement(n.default,{key:e.type,item:i[0].peek(),resources:r}):10===e.type?o.createElement(a.default,{key:e.type,item:i[0],resources:r}):11===e.type?o.createElement(s.default,{key:e.type,item:i[0],resources:r}):14===e.type?o.createElement(l.default,{key:e.type,item:i[0],resources:r}):7===e.type?o.createElement(d.default,{key:e.type,item:i[0],resources:r}):13===e.type?o.createElement(c.default,{key:e.type,item:i[0],resources:r}):3===e.type?o.createElement(u.default,{key:e.type,item:i[0],resources:r}):8===e.type?o.createElement(p.default,{key:e.type,item:i[0],resources:r}):15===e.type?o.createElement(m.default,{key:e.type,items:i.map(function(e){return e.peek()})}):null};return t}(o.Component);t.default=r});define("Qh",["require","exports","ap","at","Qj","QF","Qi"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,i=e.resources;return r.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection"},r.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection-title"},n.strings.itemActivityFeedSectionTitle),r.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection-content"},r.createElement(o.default,{item:t,resources:i})))};return t}(r.Component);t.default=a});define("Qj",["require","exports","ap","at","j8","Qy","dZ","Qm","jP","Gw","ba","Ql","Qk"],function(e,t,i,s,r,l,n,a,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i._resources=e.resources;i._itemActivityFeedStore=i._resources.consume(a.resourceKey);var r=i._resources.consume(n.identity);i._currentUserEmail=r.getIdentity().loginName;i._urlDataSource=i._resources.consume(n.url);i._itemActivityDataSource=i._resources.consume(n.itemActivityFeed);i._itemActivityFeedNavigateHelper=new(i._resources.injected(p.default));i.state={graphDataSource:i._resources.consume(n.graph.optional)};return i}e.prototype.getChildContext=function(){return{itemActivityFeedStore:this._itemActivityFeedStore}};e.prototype.componentDidMount=function(){this.state.graphDataSource||this._loadGraphDataSource()};e.prototype.shouldComponentUpdate=function(e,t){return e.item!==this.props.item&&0===e.item.revision||e.resources!==this.props.resources||t.graphDataSource!==this.state.graphDataSource};e.prototype.render=function(){var e=this.props.item,t=e.displayName,i=this._getGraphItemUrl(),r=this._getAccessToken(),o=!u.isOneDrive&&e.list&&e.list.isDocumentLibrary&&e.name||void 0;if(i&&r){var n={name:t,graphItemUrl:i,accessToken:r},a=l.default;return s.createElement("div",{className:"od-ItemActivityFeedWrapper"},s.createElement(a,{currentUserEmail:this._currentUserEmail,containingItem:n,isSingleLevel:!e.folder,canOpenItem:this._canOpenItem,onItemClick:this._onItemClick,onRenderUser:this._onRenderUser,currentListTitle:o}))}return s.createElement("div",null)};e.prototype._getGraphItemUrl=function(){var e=this.props.item,t=this.state.graphDataSource;if(t)return e.id===this._urlDataSource.getDefaultRootItemId()?t.getDriveUrl(e,{useDirectEndpoint:!0}):t.getItemUrl(e,{useDirectEndpoint:!0})};e.prototype._getAccessToken=function(){var e=this.props.item,t=this.state.graphDataSource;if(t)return t.getAccessToken(e)};e.prototype._canOpenItem=function(e){return!!this._getItemUrl(e)};e.prototype._onItemClick=function(e){var t=this.props.item,i=this._getItemUrl(e);this._itemActivityFeedNavigateHelper.navigateToItem(t,e,i)};e.prototype._getItemUrl=function(e){return this._itemActivityDataSource.getActivityItemUrl(e)};e.prototype._loadGraphDataSource=function(){var t=this;this._resources.consumeAsync(n.graph).then(function(e){t.setState({graphDataSource:e})})};e.prototype._onRenderUser=function(e,t){var i=t(e),r=this._itemActivityDataSource.getPageContextForRenderUser();return r?s.createElement(c.LivePersonaCardAdapter,{personaType:"User",email:e.user.email,pageContext:r},i):i};e.childContextTypes={itemActivityFeedStore:r.object.isRequired};i.__decorate([d.autobind],e.prototype,"_canOpenItem",null);i.__decorate([d.autobind],e.prototype,"_onItemClick",null);i.__decorate([d.autobind],e.prototype,"_onRenderUser",null);return e}(s.Component);t.default=o});define("Qy",["require","exports","ap","at","j8","QA","KC","Qz","KB","jP"],function(e,t,i,a,o,s,c,u,p,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._store=t.itemActivityFeedStore;i.state={activities:i._store.getItemActivities({item:i.props.containingItem,currentUserEmail:e.currentUserEmail})};return i}e.prototype.componentWillReceiveProps=function(e){if(e.containingItem.graphItemUrl!==this.props.containingItem.graphItemUrl||e.currentUserEmail!==this.props.currentUserEmail){this._removeCurrentStoreListener();this._addStoreListener(e);this.setState({activities:this._store.getItemActivities({item:e.containingItem,currentUserEmail:e.currentUserEmail})})}e.containingItem!==this.props.containingItem&&this._store.fetchItemActivities({item:e.containingItem,startIndex:0,currentUserEmail:e.currentUserEmail,qosPrefix:"ItemActivityFeed"})};e.prototype.componentDidMount=function(){this._addStoreListener(this.props)};e.prototype.componentWillUnmount=function(){this._store.removeListener(this._storeListener)};e.prototype.render=function(){var e=this.state.activities,t=this._getViewableItemActivitiesAndGroups(e).activities,i=this._getViewableItemActivitiesAndGroups(e).dateGroups;if(e.isPlaceholder||e.nextRequestToken){var r=i.length;t.push(void 0);0===r?i.push({key:"",name:"",startIndex:0,count:1}):0<r&&(i[i.length-1].count+=1)}var o=this._renderNoActivitiesNote(),n=this._renderError();return a.createElement("div",{className:"od-ItemActivityFeed"},o,a.createElement(s.default,{activities:t,groups:i,onRenderMissingActivity:this._onRenderMissingActivity}),n)};e.prototype._renderError=function(){var e=this.state.activities;if(e.success)return null;var t=0<e.activities.length?p.default.fetchMoreError:p.default.fetchError;return a.createElement("div",{className:"od-ItemActivityFeed-error"},t)};e.prototype._renderNoActivitiesNote=function(){var e=this.state.activities;return!e.success||e.isPlaceholder||0!==e.activities.length||e.nextRequestToken?null:a.createElement("div",{className:"od-ItemActivityFeed-noActivities"},p.default.noActivities)};e.prototype._getViewableItemActivitiesAndGroups=function(e){var t,i=[],r=[],o=function(){if(0===r.length)return 0;var e=r[r.length-1];return e.startIndex+e.count};if(e)for(var n=0,a=e.activities;n<a.length;n++){var s=a[n];if(s){var l=this._getViewableItemActivity(s);if(l){i.push(l);var d=u.getActivityGroupByDate(s),c=u.RelativeDateGroupStrings[d]||d;if(c!==t){r.push({key:"activityDateGroup-"+r.length,name:c,count:1,startIndex:o()});t=c}else r[r.length-1].count+=1}}}return{activities:i,dateGroups:r}};e.prototype._getViewableItemActivity=function(e){var t=this.props,i=t.currentUserEmail,r=t.containingItem,o=t.canOpenItem,n=t.onItemClick,a=t.isSingleLevel,s=t.onRenderUser,l=t.currentListTitle,d={currentUserEmail:i,containingItem:r,canOpenItem:o,onItemClick:n,isSingleLevel:a,activity:e,strings:p.default,onRenderUser:s,currentListTitle:l};switch(e.type){case 0:return new c.EditItemActivity(d);case 1:return new c.MoveItemActivity(d);case 2:return new c.CommentItemActivity(d);case 3:return new c.CommentResponseItemActivity(d);case 4:return new c.MentionItemActivity(d);case 5:return new c.VersionItemActivity(d);case 6:return new c.RestoreItemActivity(d);case 7:return new c.RenameItemActivity(d);case 8:return new c.DeleteItemActivity(d);case 9:return new c.CreateItemActivity(d);case 10:return new c.ShareItemActivity(d);default:return}};e.prototype._onRenderMissingActivity=function(e){this._store.fetchItemActivities({item:this.props.containingItem,startIndex:e,currentUserEmail:this.props.currentUserEmail,qosPrefix:"ItemActivityFeed"})};e.prototype._removeCurrentStoreListener=function(){this._store.removeListener(this._storeListener)};e.prototype._addStoreListener=function(e){var t=this;this._storeListener=this._store.addListener(function(){t.setState({activities:t._store.getItemActivities({item:e.containingItem,currentUserEmail:e.currentUserEmail})})},{item:e.containingItem,currentUserEmail:e.currentUserEmail})};e.contextTypes={itemActivityFeedStore:o.object.isRequired};i.__decorate([n.autobind],e.prototype,"_onRenderMissingActivity",null);return e}(a.Component);t.default=r});define("QA",["require","exports","ap","at","a0","QD","jP","o1","oO","QC","QB"],function(e,t,i,o,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.activities,i=e.groups;return o.createElement(l.GroupedList,{items:t,onRenderCell:this._onRenderCell,groupProps:{onRenderHeader:this._onRenderHeader},groups:i,listProps:{className:"od-ItemActivityList-grouplist"},onShouldVirtualize:function(){return!1}})};t.prototype._onRenderCell=function(e,t,i){var r=this.props.onRenderMissingActivity;return t?o.createElement("div",{className:"od-ItemActivityList-activity"},o.createElement(n.default,{key:t.getKey(),activity:t})):r?o.createElement(d.default,{activityIndex:i,onGetMoreActivities:this._onRequestMissingItemActivity},o.createElement("div",{className:"od-ItemActivityList-activity od-ItemActivityList-missingActivity"},o.createElement(s.Spinner,{size:s.SpinnerSize.large}))):void 0};t.prototype._onRenderHeader=function(e){var t=e.group;return o.createElement("div",{className:"od-ItemActivityList-grouplistTitle"},t.name)};t.prototype._onRequestMissingItemActivity=function(e,t){var i=this.props.onRenderMissingActivity;t&&r.Engagement.logData({name:"ItemActivityFeed.scrolled",isIntentional:!0});i&&i(e)};i.__decorate([a.autobind],t.prototype,"_onRenderCell",null);i.__decorate([a.autobind],t.prototype,"_onRenderHeader",null);i.__decorate([a.autobind],t.prototype,"_onRequestMissingItemActivity",null);return t}(o.Component);t.default=c});define("QD",["require","exports","ap","at","KA","mo","hs","QE"],function(e,t,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._onRenderActivityDescription=i._onRenderActivityDescription.bind(i);i._onRenderIcon=i._onRenderIcon.bind(i);return i}e.prototype.render=function(){var e=this.props.activity,t=s.getRelativeDateTimeStringForLists(e.getFriendlyDisplayTime()||"")||s.getFriendlyDateTimeStringPast(e.getDate());return o.createElement(n.ActivityItem,{key:e.getKey(),className:"od-ItemActivity-item",onRenderActivityDescription:this._onRenderActivityDescription,onRenderIcon:this._onRenderIcon,timeStamp:t.toString()})};e.prototype._onRenderIcon=function(){var e=this.props.activity.getIconName();return o.createElement(a.Icon,{iconName:e})};e.prototype._onRenderActivityDescription=function(){return o.createElement("div",null,this.props.activity.getTitle())};return e}(o.Component);t.default=r});define("QE",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".od-ItemActivity-item-nameText{font-weight:600;color:"},{theme:"bodyText",defaultValue:"#333333"},{rawString:"}.od-ItemActivity-item-linkText{font-weight:600;text-decoration:none}a.od-ItemActivity-item-linkText{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer}.od-ItemActivity-otherActors{list-style-type:none;margin:0;padding:0}"}])});define("QC",["require","exports","ap","at","jP","bS"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=new n.default,s=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){var e=this.props,t=e.onGetMoreActivities,i=e.activityIndex;this._containingScrollablePane=this._findContainingScrollablePane();this._isCurrentElementInView()&&t(i);this._events.on(this._containingScrollablePane,"scroll",this._onScrollEvent,!0)};t.prototype.componentWillUnmount=function(){this._events.off(this._containingScrollablePane,"scroll",this._onScrollEvent,!0)};t.prototype.render=function(){var t=this;return r.createElement("div",{ref:function(e){return t._missingActivityElement=e}},r.Children.only(this.props.children))};t.prototype._findContainingScrollablePane=function(){var e=document.getElementsByClassName("od-DetailsPane-scrollablePane");return e.length&&e[0]};t.prototype._onScrollEvent=function(e){var t=this,i=this.props,r=i.onGetMoreActivities,o=i.activityIndex;a.setTimeout(function(){t._isCurrentElementInView()&&r(o,!0)},100)};t.prototype._isCurrentElementInView=function(){if(this._missingActivityElement&&this._containingScrollablePane){var e=this._missingActivityElement.getBoundingClientRect(),t=this._containingScrollablePane.getBoundingClientRect(),i=e.top,r=e.bottom,o=t.top,n=t.bottom;return i<=n&&o<=i||o<=r&&r<=n}return!1};i.__decorate([o.autobind],t.prototype,"_onScrollEvent",null);i.__decorate([o.autobind],t.prototype,"_isCurrentElementInView",null);return t}(o.BaseComponent);t.default=s});define("QB",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".od-ItemActivityList-activity{margin:12px 0}.od-ItemActivityList-grouplist{background-color:"},{theme:"bodyBackground",defaultValue:"#ffffff"},{rawString:"}.od-ItemActivityList-grouplistTitle{font-weight:700;font-size:12px;color:"},{theme:"bodyText",defaultValue:"#333333"},{rawString:"}"}])});define("Qz",["require","exports","cL","KB"],function(e,t,b,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x,r,S=864e5,C=7;!function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.older="Older"}(x=t.RelativeDateGroups||(t.RelativeDateGroups={}));t.RelativeDateGroupStrings=((r={})[x.today]=i.default.today,r[x.yesterday]=i.default.yesterday,r[x.thisWeek]=i.default.thisWeek,r[x.lastWeek]=i.default.lastWeek,r[x.twoWeeksAgo]=i.default.twoWeeksAgo,r[x.threeWeeksAgo]=i.default.threeWeeksAgo,r[x.thisMonth]=i.default.thisMonth,r[x.lastMonth]=i.default.lastMonth,r);t.getActivityGroupByDate=function(e){var t,i,r,o,n,a,s,l,d,c,u,p,m,h,f,g,y,v=e.time,_=new Date;return v?P(_,v)?x.today:(y=v,P(new Date(_.getTime()-S),y)?x.yesterday:(h=v,g=(f=_).setHours(0,0,0,0)-f.getDay()*S,h.getTime()>g?x.thisWeek:(u=v,m=(p=_).setHours(0,0,0,0)-(p.getDay()+C)*S,u.getTime()>m?x.lastWeek:(d=v,c=_.setHours(0,0,0,0)-2*C*S,d.getTime()>c?x.twoWeeksAgo:(s=v,l=_.setHours(0,0,0,0)-3*C*S,s.getTime()>l?x.threeWeeksAgo:(n=v,(a=_).getFullYear()===n.getFullYear()&&a.getMonth()===n.getMonth()?x.thisMonth:(r=v,(o=_).getFullYear()===r.getFullYear()&&o.getMonth()-r.getMonth()==1?x.lastMonth:(i=v,_.getFullYear()===i.getFullYear()?v.toLocaleString(b.default.language,{month:"long"}):(t=v,_.getFullYear()>t.getFullYear()?v.toLocaleString(b.default.language,{month:"long",year:"numeric"}):x.older))))))))):x.older};function P(e,t){return e.toDateString()===t.toDateString()}});define("Qm",["require","exports","bA","Qx","Qn"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedResourceKey(e("module").id,r.default,{itemActivityFeedStore:o.resourceKey})});define("Qx",["require","exports","dq","dp"],function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={"SharePoint App":!0,"System Account":!0},r=function(){function e(e,t){this._baseStore=t.itemActivityFeedStore;this._dictItemActivities={}}e.prototype.addListener=function(e,t){var i=this,r=this._getItemActivitiesDictionaryKey(t);this._dictItemActivities[r]=this._transformItemActivities(t,this._baseStore.getItemActivities(t));return this._baseStore.addListener(function(){i._dictItemActivities[r]=i._transformItemActivities(t,i._baseStore.getItemActivities(t));e()},t)};e.prototype.fetchItemActivities=function(e){this._baseStore.fetchItemActivities(e)};e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t]:this._baseStore.getItemActivities(e)};e.prototype.removeListener=function(e){this._baseStore.removeListener(e)};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item.graphItemUrl;e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._transformItemActivities=function(e,t){var i=[];if(0<t.activities.length)for(var r={},o=0;o<t.activities.length;o++){var n=t.activities[o];if(!this._shouldHideActivity(n,e.currentUserEmail)){var a=t.activities[o-1],s=this._getCacheItemKey(n),l=n.actors[0];a&&this._isMergableMoveActivity(a,n)?this._handleMergableMoveActivity(a,n,i):s&&l?this._handleGroupableActivity(r,s,n,i):i.push(n)}}return{isPlaceholder:t.isPlaceholder,activities:i,nextRequestToken:t.nextRequestToken,success:t.success}};e.prototype._handleMergableMoveActivity=function(e,t,i){i[i.length-1]={id:e.id,type:e.type,actors:e.actors,item:e.item,parentItem:e.parentItem,time:e.time,friendlyDisplayTime:e.friendlyDisplayTime,action:{move:{from:e&&e.action&&e.action.move&&e.action.move.from,to:t&&t.action&&t.action.move&&t.action.move.to}}}};e.prototype._handleGroupableActivity=function(e,t,i,r){var o=i.actors[0],n=this._getActorKey(o),a=e[t],s=a&&this._shouldResetGroupingItem(a,i);if(!a||s){var l={};l[n]=o;e[t]={activity:i,lastActivityTime:i.time,actors:l,groupedIndex:r.length};r.push(i)}else if(!a.actors[n]){a.actors[n]=o;if(1===a.activity.actors.length){var d=a.activity,c={id:d.id,type:d.type,actors:[d.actors[0]],item:d.item,parentItem:d.parentItem,time:d.time,action:d.action};a.activity=c;r[a.groupedIndex]=c}a.activity.actors.push(o)}};e.prototype._shouldResetGroupingItem=function(e,t){return e.lastActivityTime.getTime()-18e5>t.time.getTime()};e.prototype._getCacheItemKey=function(e){if(2===e.type||3===e.type||0===e.type){var t=void 0;e.item.driveItem&&e.item.driveItem.id?t=e.type.toString()+"_"+e.item.driveItem.id:e.item.graphItemUrl&&(t=e.type.toString()+"_"+e.item.graphItemUrl);var i=e.action.commentResponse;t&&i&&i.commentAuthor&&(t+="_"+i.commentAuthor.email);return t}};e.prototype._shouldHideActivity=function(e,t){var i=!1,r=e.item&&e.item.name&&e.item.name.toLowerCase();if(r){var o=r.lastIndexOf(".");if(-1!==o){var n=r.substring(o+1);s.default.File;a.getItemTypeFromExtension(n)===s.default.OneNote&&(i=!0)}}return i||this._isSystemAccount(e)||5===e.type};e.prototype._isSystemAccount=function(e){var t=0<e.actors.length&&e.actors[0];return t&&i[t.displayName]};e.prototype._isMergableMoveActivity=function(e,t){return 1===e.type&&1===t.type&&!!e.action.move.from&&!!t.action.move.to&&e.item&&t.item&&e.item.name===t.item.name};e.prototype._getActorKey=function(e){return e.email||"@@noemail@@_"+e.displayName};return e}();t.default=r});define("Qn",["require","exports","bA","Qw","Qo"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedResourceKey(e("module").id,r.default,{itemActivitiesService:o.itemActivitiesServiceKey})});define("Qw",["require","exports","aC","Nv"],function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._itemActivitiesService=t.itemActivitiesService;this._lastListenerId=-1;this._dictListener={};this._dictItemActivities={};this._promiseDeduplicator=new i.default}e.prototype.addListener=function(e,t){var i=this._getItemActivitiesDictionaryKey(t);this._lastListenerId++;this._dictListener[i]||(this._dictListener[i]={});this._dictListener[i][this._lastListenerId]=e;return{key:this._lastListenerId,itemKey:i}};e.prototype.fetchItemActivities=function(t){var i=this,r=this._getItemActivitiesDictionaryKey(t),o=this._dictItemActivities[r];if(!o||0===t.startIndex){var e=0;o&&0===o.startIndex&&(e=o.noOfUnsuccessfulRequests);o={activities:{isPlaceholder:!0,activities:[],success:!0},noOfUnsuccessfulRequests:e,startIndex:0}}var n=o.activities;if(n.nextRequestToken||t.item.graphItemUrl){var a=(n.nextRequestToken||t.item.graphItemUrl)+"_"+(t.startIndex||0);this._promiseDeduplicator.deduplicate(a,function(){var e={item:t.item,nextRequestToken:n.nextRequestToken,qosPrefix:t.qosPrefix};return i._itemActivitiesService.getItemActivities(e).then(function(e){if(e&&e.success||2<=o.noOfUnsuccessfulRequests+1){i._dictItemActivities[r]={activities:i._mergeItemActivities(n,e),noOfUnsuccessfulRequests:0,startIndex:t.startIndex};i._emitChange(t)}else{i._dictItemActivities[r]={activities:n,noOfUnsuccessfulRequests:o.noOfUnsuccessfulRequests+1,startIndex:o.startIndex};i.fetchItemActivities(t)}},function(e){return s.default.reject(e)})})}};e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t].activities:{isPlaceholder:!0,activities:[],success:!0}};e.prototype.removeListener=function(e){if(!this._dictListener[e.itemKey]||!this._dictListener[e.itemKey][e.key])throw"Listener with key "+e.key+" for item "+e.itemKey+" not found";delete this._dictListener[e.itemKey][e.key]};e.prototype._emitChange=function(e){var t=this._getItemActivitiesDictionaryKey(e),i=this._dictListener[t];if(i)for(var r=0,o=Object.getOwnPropertyNames(i);r<o.length;r++){(0,i[o[r]])()}};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item.graphItemUrl;e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._mergeItemActivities=function(e,t){var i=(e.activities||[]).concat(t.activities||[]);return{isPlaceholder:!e&&!t||e.isPlaceholder&&t.isPlaceholder,activities:i,nextRequestToken:t.nextRequestToken||!t&&e.nextRequestToken,success:e.success&&t&&t.success}};return e}();t.default=r});define("Qo",["require","exports","ap","Qt","Qq","Qp"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.itemActivitiesResultProcessorKey=o.resourceKey;t.ItemActivitiesService=n.ItemActivitiesService;t.itemActivitiesServiceKey=n.resourceKey});define("Qt",["require","exports","Qv","Qr","Qu"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemActivityType=i.ItemActivityType;t.matchActivity=i.matchActivity;t.ItemActivitiesResultProcessor=r.default;t.ItemActivitiesService=o.default});define("Qv",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.edit=0]="edit";e[e.move=1]="move";e[e.comment=2]="comment";e[e.commentResponse=3]="commentResponse";e[e.mention=4]="mention";e[e.version=5]="version";e[e.restore=6]="restore";e[e.rename=7]="rename";e[e.delete=8]="delete";e[e.create=9]="create";e[e.share=10]="share";e[e.copy=11]="copy";e[e.unknown=12]="unknown"}(t.ItemActivityType||(t.ItemActivityType={}));t.matchActivity=function(t){return function(e){return 2===e.type?t.Comment(e):3===e.type?t.CommentResponse(e):9===e.type?t.Create(e):8===e.type?t.Delete(e):0===e.type?t.Edit(e):4===e.type?t.Mention(e):1===e.type?t.Move(e):7===e.type?t.Rename(e):6===e.type?t.Restore(e):10===e.type?t.Share(e):5===e.type?t.Version(e):11===e.type?t.Copy(e):t.Unknown(e)}}});define("Qr",["require","exports","Qs","ej"],function(e,t,p,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.prototype.processResponse=function(e){var t=this,i=e.item,r=e.response;return{isPlaceholder:!1,activities:r.value.map(function(e){return t._processActivityResponse(i,e)}),nextRequestToken:this._getNextRequestToken(r),success:!0}};e.prototype.processActivitiesByIntervalResponse=function(e){var t=this;return{activitiesByInterval:e.value.map(function(e){return t._processActivitySummaryResponse(e)}),success:!0}};e.prototype._processActivitySummaryResponse=function(e){return{totalCount:(void 0!==e.create?e.create.actionCount:0)+(void 0!==e.delete?e.delete.actionCount:0)+(void 0!==e.edit?e.edit.actionCount:0)+(void 0!==e.move?e.move.actionCount:0)+(void 0!==e.rename?e.rename.actionCount:0)+(void 0!==e.restore?e.restore.actionCount:0)+(void 0!==e.copy?e.copy.actionCount:0),startDateTime:d(e.startDateTime),endDateTime:d(e.endDateTime)}};e.prototype._getNextRequestToken=function(e){var t=e["@odata.nextLink"],i=t&&t.match(/skiptoken=([^&]+)/i);if(i)return i[1]};e.prototype._processActivityResponse=function(e,t){var i=this._getItem(e,t),r=this._getParentItem(t),o=this._getAction(e,i,r,t);if(p.isOdcActivity(t)){var n=t.actor&&t.actor.user,a=n&&{displayName:n.displayName,id:n.id};return{id:t.id,type:this._getActivityType(t),actors:a?[a]:[],item:i,parentItem:r,time:d(t.activityDateTime),action:o}}var s=t.actor.user,l=s&&{displayName:s.displayName,email:s.email,self:s.self,userPrincipalName:s.userPrincipalName};return{id:t.id,type:this._getActivityType(t),actors:[l],item:i,parentItem:r,time:d(t.times.recordedTime),friendlyDisplayTime:t["@sharePoint.localizedRelativeTime"],action:o}};e.prototype._getActivityType=function(e){return p.matchActivity({Comment:function(){return 2},Create:function(){return 9},Delete:function(){return 8},Edit:function(){return 0},Mention:function(){return 4},Move:function(){return 1},Rename:function(){return 7},Restore:function(){return 6},Share:function(){return 10},Version:function(){return 5},Copy:function(){return 11}})(e)};e.prototype._getItem=function(e,t){var i=p.getItem(t);if(p.isMoveActivity(t)){var r=p.getAction(t).move;if(r&&r.to)return{name:this._getFileNameFromPath(r.to),isRoot:this._isRootItem(r.to),graphItemUrl:void 0,relativePath:void 0,absolutePath:r.to}}else if(p.isDeleteActivity(t)){var o=p.getAction(t).delete;if(o&&o.name){var n=(s=(a=i&&i.parentReference)&&this._getRelativePathFromVroomPath(a.path))&&i&&s+"/"+i.name+"/"+o.name;return{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:void 0,relativePath:n,absolutePath:void 0,isFolder:"Folder"===o.objectType}}}if(i){!p.isOdcActivity(t)&&t.docDetails&&(i.webUrl=this._getNavLink(i,t.docDetails));var a,s;n=(s=(a=i.parentReference)&&this._getRelativePathFromVroomPath(a.path))&&s+"/"+i.name;return{name:i.name,isRoot:this._isRootItem(i.name),graphItemUrl:a&&"/drives/"+a.driveId+"/items/"+i.id,relativePath:n,absolutePath:void 0,driveItem:i}}return e};e.prototype._getParentItem=function(e){var t=p.getItem(e);if(p.isMoveActivity(e)){var i=p.getAction(e).move;if(i&&i.to){var r=this._getDirNameFromPath(i.to),o=t&&t.parentReference;return{name:this._getFileNameFromPath(r),isRoot:this._isRootItem(r),graphItemUrl:o&&"/drives/"+o.driveId+"/items/"+o.id,relativePath:void 0,absolutePath:this._getDirNameFromPath(r),isFolder:!0,driveItem:o&&{id:o.id}}}}else{if(p.isDeleteActivity(e)&&t){var n=(o=t.parentReference)&&this._getRelativePathFromVroomPath(o.path),a=n&&n+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:o&&"/drives/"+o.driveId+"/items/"+t.id,relativePath:a,absolutePath:void 0,isFolder:!0,driveItem:t}}if(t){if(o=t.parentReference&&t.parentReference){var s=(a=this._getRelativePathFromVroomPath(o.path))&&this._getFileNameFromPath(a);return{name:s,isRoot:this._isRootItem(s),graphItemUrl:"/drives/"+o.driveId+"/items/"+o.id,relativePath:a,absolutePath:void 0,isFolder:!0,driveItem:{id:o.id}}}}}};e.prototype._getNavLink=function(e,t){var i=e.webUrl,r=i&&new n.default(i),o=t.navigationId;r&&o&&r.setQueryParameter("nav",o);return r.toString()||i};e.prototype._getAction=function(e,t,i,r){var o={};p.isVersionActivity(r)&&(o.version={newVersion:p.getAction(r).version.newVersion});if(p.isMoveActivity(r)){var n=p.getAction(r).move;if(n.From){var a=this._getDirNameFromPath(n.From);o.move={from:{name:this._getFileNameFromPath(a),isRoot:this._isRootItem(a),graphItemUrl:void 0,absolutePath:a},to:void 0}}else if(n.to){var s=this._getDirNameFromPath(n.to);o.move={from:void 0,to:{name:this._getFileNameFromPath(s),isRoot:this._isRootItem(s),graphItemUrl:void 0,absolutePath:s}}}}if(p.isRenameActivity(r)){var l=p.getAction(r).rename;o.rename={newItem:{name:l.newName,isRoot:this._isRootItem(l.newName),graphItemUrl:t.graphItemUrl,relativePath:t.relativePath,absolutePath:t.absolutePath,driveItem:t.driveItem},oldItem:{name:l.oldName,isRoot:this._isRootItem(l.oldName),graphItemUrl:t.graphItemUrl,relativePath:t.relativePath,absolutePath:t.absolutePath,driveItem:t.driveItem}}}if(p.isCommentActivity(r)){var d=p.getAction(r).comment;d.isReply&&(o.commentResponse={commentAuthor:d.parentAuthor&&d.parentAuthor.user})}if(p.isMentionActivity(r)){var c=p.getAction(r).mention;o.mention={mentionees:c.mentionees&&c.mentionees.map(function(e){return e.user})}}if(p.isShareActivity(r)){var u=p.getAction(r).share;o.share={recipients:u.recipients&&u.recipients.map(function(e){return e.user})}}return o};e.prototype._getRelativePathFromVroomPath=function(e){if(e){return e.split(":",2)[1]}};e.prototype._getDirNameFromPath=function(e){return e&&e.substring(0,e.lastIndexOf("/"))};e.prototype._getFileNameFromPath=function(e){return e&&e.substring(e.lastIndexOf("/")+1)};e.prototype._isRootItem=function(e){return e&&"/LiveFolders"===e};return e}();t.default=i;function d(e){var t=!1;e.toUpperCase().indexOf("Z")===e.length-1&&(t=!0);var i=e.split(/[^0-9]/);if(!(i.length<6))return t?new Date(Date.UTC(Number(i[0]),Number(i[1])-1,Number(i[2]),Number(i[3]),Number(i[4]),Number(i[5]),isNaN(Number(i[6]))?0:Number(i[6]))):new Date(Number(i[0]),Number(i[1])-1,Number(i[2]),Number(i[3]),Number(i[4]),Number(i[5]),isNaN(Number(i[6]))?0:Number(i[6]))}});define("Qs",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(e){return void 0!==e.action}t.isOdbActivity=i;t.isOdcActivity=function(e){return void 0!==e.activityDateTime};function r(e){return void 0!==h(e).comment}t.isCommentActivity=r;function o(e){return void 0!==h(e).mention}t.isMentionActivity=o;function n(e){return void 0!==h(e).edit}t.isEditActivity=n;function a(e){return void 0!==h(e).version}t.isVersionActivity=a;function s(e){return void 0!==h(e).restore}t.isRestoreActivity=s;function l(e){return void 0!==h(e).move}t.isMoveActivity=l;function d(e){return void 0!==h(e).rename}t.isRenameActivity=d;function c(e){return void 0!==h(e).delete}t.isDeleteActivity=c;function u(e){return void 0!==h(e).create}t.isCreateActivity=u;function p(e){return void 0!==h(e).share}t.isShareActivity=p;function m(e){return void 0!==h(e).copy}t.isCopyActivity=m;t.matchActivity=function(t){return function(e){return r(e)?t.Comment(e):u(e)?t.Create(e):c(e)?t.Delete(e):n(e)?t.Edit(e):o(e)?t.Mention(e):l(e)?t.Move(e):d(e)?t.Rename(e):s(e)?t.Restore(e):p(e)?t.Share(e):a(e)?t.Version(e):m(e)?t.Copy(e):void 0}};function h(e){return i(e)?e.action:e}t.getAction=h;t.getItem=function(e){return e.driveItem}});define("Qu",["require","exports","aC"],function(e,r,o){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.DEFAULT_PAGE_SIZE=25;var t=function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor;this._itemActivitiesResultProcessor=t.itemActivitiesResultProcessor}e.prototype.getItemActivities=function(t){var i=this;t.environment=t.environment||"sharePoint";if(t.mockData)return o.default.resolve({activities:t.mockData,isPlaceholder:!1,success:!0});var e=this._getRequestUrl(t);return this._dataRequestor.send({apiName:t.qosPrefix?t.qosPrefix+".GetItemActivities":"GetItemActivities",path:e,headers:t.headers,accessToken:t.item.accessToken}).then(function(e){return i._itemActivitiesResultProcessor.processResponse({item:t.item,response:e})},function(e){return{error:e,isPlaceholder:!1,activities:[],success:!1}})};e.prototype.getActivitiesByDate=function(e){e.environment=e.environment||"sharePoint";return e.mockData?o.default.resolve({activitiesByDate:e.mockData,success:!0}):this.getActivitiesByInterval({item:e.item,headers:e.headers,interval:"day",startDateTime:e.startDateTime}).then(function(e){return{error:e.error,success:e.success,activitiesByDate:e.activitiesByInterval.map(function(e){var t=e.startDateTime;return{createCount:e.createCount,deleteCount:e.deleteCount,editCount:e.editCount,moveCount:e.moveCount,restoreCount:e.restoreCount,copyCount:e.copyCount,totalCount:e.totalCount,date:function(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())}(t)}})}},function(e){return o.default.resolve({activitiesByDate:[],error:new Error("Not implemented"),success:!1})})};e.prototype.getActivitiesByInterval=function(e){var t=this,i=e.item.graphItemUrl+"/action.getActivitiesByInterval?startDateTime="+e.startDateTime.toISOString()+"&interval=day";return this._dataRequestor.send({apiName:"GetActivitiesByInterval",headers:e.headers,path:i}).then(function(e){return t._itemActivitiesResultProcessor.processActivitiesByIntervalResponse(e)},function(e){return{error:e,activitiesByInterval:[],success:!1}})};e.prototype._getRequestUrl=function(e){var t=e.pageSize?e.pageSize:r.DEFAULT_PAGE_SIZE,i=e.item.graphItemUrl+"/activities?$expand=driveItem($select=id,name,webUrl,parentReference,file,folder)";i+="&$top="+t;e.filter&&(i+="&$filter="+e.filter);e.orderBy&&(i+="&$orderby="+e.orderBy);e.nextRequestToken&&(i+="&$skiptoken="+e.nextRequestToken);return i};return e}();r.default=t});define("Qq",["require","exports","bA","Qr"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedResourceKey(e("module").id,r.default,{})});define("Qp",["require","exports","bA","gf","Qt","Qq"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemActivitiesService=o.ItemActivitiesService;t.resourceKey=i.createResolvedResourceKey(e("module").id,o.ItemActivitiesService,{vroomDataRequestor:r.resourceKey,itemActivitiesResultProcessor:n.resourceKey})});define("Gw",["require","exports","ap","at","jP","aW","Gz","Gy","Gx"],function(e,t,i,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(o,r);function o(e,t){var i=r.call(this,e,t)||this;i.state={isReady:!1};o.ensureInitializeLPC(i.makeAdapterConfig()).then(function(){i.setState({isReady:!0})});return i}o.prototype.makeAdapterConfig=function(){var e=this.props.lpcCallbacks||{};this.props.addGroupMembersCallback&&(e.addGroupMembers=this.props.addGroupMembersCallback);return{pageContext:this.props.pageContext,actionCallBacks:e,dataCallBacks:this.props.lpcCallbacks}};o.prototype.render=function(){return o.LivePersonaCardHoverTarget?n.createElement(o.LivePersonaCardHoverTarget,{upn:this.props.email,hostAppPersonaInfo:{PersonaType:this.props.personaType},externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.children):n.createElement("div",{className:"sp-livePersonaCardAdapter-root"},this.props.children)};o.ensureInitializeLPC=function(t){if(!t.pageContext.isSPO)return Promise.reject("LPC is not supported on-prem.");if(!s.default.isFeatureEnabled({ODB:809,ODC:null,Fallback:!1}))return Promise.reject("The global LPC flight is off for this configuration.");if(window.LPC&&window.LPC.getRenderer){o.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget;t.callback&&t.callback();return Promise.resolve()}var e=new l.Loki(t.pageContext),i={culture:t.pageContext.currentUICultureName,region:e.getRegion(),clientType:t.clientType||"ODSP",clientContextType:"Generic",clientCorrelationId:t.pageContext.CorrelationId,logMessage:o._logResult,getAuthToken:e.getAuthTokenGetter(t.clientType),actionCallbacks:t.actionCallBacks,dataCallbacks:t.dataCallBacks};return d.initializeLivePersonaCard(i,function(){o.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget;t.callback&&t.callback();t.onSuccess&&t.onSuccess()},function(e){0;t.onFailure&&t.onFailure(e)})};o._logResult=function(e,t,i){0};o.LivePersonaCardHoverTarget=void 0;i.__decorate([a.autobind],o.prototype,"makeAdapterConfig",null);i.__decorate([a.autobind],o.prototype,"render",null);i.__decorate([a.autobind],o,"_logResult",null);return o}(a.BaseComponent);t.LivePersonaCardAdapter=r});define("Gz",["require","exports","ap","GA"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("GA",["require","exports","ap","aI","ef"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(r,e);function r(){return null!==e&&e.apply(this,arguments)||this}r.prototype.getDataSourceName=function(){return"LokiDataSource"};r.prototype.getRegion=function(){var t=new o.Qos({name:"LivePersonaCard.GetLokiRegion"});try{var e=this._pageContext.farmLabel;if(!e){t.end({resultType:o.ResultTypeEnum.Failure,resultCode:"LokiNoFarmLabel",error:"Farm label property not found in _spPageContextinfo object. Aborting connection!"});return""}var i=e.split("_")[0].toLowerCase();return r.FARMLABEL_TO_REGION_MAPPING[i]}catch(e){t.end({resultType:o.ResultTypeEnum.Failure,resultCode:"LokiGetRegionError",error:e});return""}};r.prototype.getAuthTokenGetter=function(e){var r=this;void 0===e&&(e="LPC-ODSP");var o=this._pageContext.CorrelationId;return function(t,i){r.getData(function(){return"/_vti_bin/DelveApi.ashx/authtoken/loki?d="+Date.now()},function(e){t(e.replace(/"/g,""),o)},"lokiGetAuthToken",void 0,"GET",{"X-Delve-ClientPlatform":e},void 0,void 0,void 0,void 0,function(e){i(e.statusText,o);return"Loki getAuthToken() failed with "+e.code})}};r.FARMLABEL_TO_REGION_MAPPING={edog:"ppe",msit:"msit",spdf:"df"};return r}(r.default);t.Loki=n;t.default=n});
/*! Version: 1.3.17; Third Party Notices: https://go.microsoft.com/fwlink/?linkid=855968 */define("Gy",[],function(){return function(i){function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var o={};return r.m=i,r.c=o,r.i=function(e){return e},r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=36)}([function(e,t,i){"use strict";i.d(t,"a",function(){return r});var r=function(e,t,i){this.type=e,this.message=t,this.rootCorrelationId=i}},function(e,t,i){"use strict";var r=function(){function i(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return i.prototype.Equals=function(e){var t=new i(e);return this.low===t.low&&this.high===t.high},i}();t.Int64=r;var o=function(){function i(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return i.prototype.Equals=function(e){var t=new i(e);return this.low===t.low&&this.high===t.high},i}();t.UInt64=o;var n=function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e)},e.ToInt16=function(e){return 32767&e|(32768&e)<<16>>16},e.ToInt32=function(e){return 2147483647&e|2147483648&e},e.ToUInt8=function(e){return 255&e},e.ToUInt32=function(e){return 4294967295&e},e}();t.Number=n},function(e,t,i){"use strict";(r=t.AWTPiiKind||(t.AWTPiiKind={}))[r.NotSet=0]="NotSet",r[r.DistinguishedName=1]="DistinguishedName",r[r.GenericData=2]="GenericData",r[r.IPV4Address=3]="IPV4Address",r[r.IPv6Address=4]="IPv6Address",r[r.MailSubject=5]="MailSubject",r[r.PhoneNumber=6]="PhoneNumber",r[r.QueryString=7]="QueryString",r[r.SipAddress=8]="SipAddress",r[r.SmtpAddress=9]="SmtpAddress",r[r.Identity=10]="Identity",r[r.Uri=11]="Uri",r[r.Fqdn=12]="Fqdn",r[r.IPV4AddressLegacy=13]="IPV4AddressLegacy";var r},function(e,t,i){"use strict";var n=i(11),a=i(2),s=i(4),r=function(){function e(){}return e.getPayloadBlob=function(r,e){var t=new n.IO.MemoryStream,o=new n.CompactBinaryProtocolWriter(t);return o.WriteFieldBegin(n.BondDataType.BT_MAP,3),o.WriteMapContainerBegin(e,n.BondDataType.BT_STRING,n.BondDataType.BT_LIST),Object.keys(r).forEach(function(e){o.WriteString(e);var t=r[e];o.WriteContainerBegin(1,n.BondDataType.BT_STRUCT),o.WriteFieldBegin(n.BondDataType.BT_STRING,2),o.WriteString("act_default_source"),o.WriteFieldBegin(n.BondDataType.BT_STRING,5),o.WriteString(s.newGuid()),o.WriteFieldBegin(n.BondDataType.BT_INT64,6),o.WriteInt64(s.numberToBondInt64(Date.now())),o.WriteFieldBegin(n.BondDataType.BT_LIST,8),o.WriteContainerBegin(t.length,n.BondDataType.BT_STRUCT);for(var i=0;i<t.length;++i)o.WriteBlob(t[i]);o.WriteStructEnd(!1)}),o.WriteStructEnd(!1),t.GetBuffer()},e.getEventBlob=function(t){var e=new n.IO.MemoryStream,i=new n.CompactBinaryProtocolWriter(e);i.WriteFieldBegin(n.BondDataType.BT_STRING,1),i.WriteString(t.id),i.WriteFieldBegin(n.BondDataType.BT_INT64,3),i.WriteInt64(s.numberToBondInt64(t.timestamp)),i.WriteFieldBegin(n.BondDataType.BT_STRING,5),i.WriteString(t.type),i.WriteFieldBegin(n.BondDataType.BT_STRING,6),i.WriteString(t.name);var r=[],o=[];return Object.keys(t.properties).forEach(function(e){t.properties[e].pii===a.AWTPiiKind.NotSet?r.push(e):o.push(e)}),r.length&&(i.WriteFieldBegin(n.BondDataType.BT_MAP,13),i.WriteMapContainerBegin(r.length,n.BondDataType.BT_STRING,n.BondDataType.BT_STRING),r.forEach(function(e){i.WriteString(e),i.WriteString(t.properties[e].value)})),o.length&&(i.WriteFieldBegin(n.BondDataType.BT_MAP,30),i.WriteMapContainerBegin(o.length,n.BondDataType.BT_STRING,n.BondDataType.BT_STRUCT),o.forEach(function(e){i.WriteString(e),i.WriteFieldBegin(n.BondDataType.BT_INT32,1),i.WriteInt32(1),i.WriteFieldBegin(n.BondDataType.BT_INT32,2),i.WriteInt32(t.properties[e].pii),i.WriteFieldBegin(n.BondDataType.BT_STRING,3),i.WriteString(t.properties[e].value),i.WriteStructEnd(!1)})),i.WriteStructEnd(!1),e.GetBuffer()},e.base64Encode=function(e){return n.Encoding.Base64.GetString(e)},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,i){"use strict";var r=i(1),o=/[xy]/g;t.numberToBondInt64=function(e){var t=new r.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(o,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},t.isPii=function(e){return!isNaN(e)&&null!==e&&0<=e&&e<=13}},function(e,t,i){"use strict";var r=i(2);t.AWTPiiKind=r.AWTPiiKind;var o=i(15);t.AWT=o.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/"},function(e,t,i){"use strict";t.Version="1.2.0",t.FullVersionString="AWT-Web-CJS-"+t.Version},function(e,t,d){"use strict";function c(t){var i={};return Object.keys(t).forEach(function(e){i["Perf_"+e]=t[e].toString()}),i}function u(){v.AWT.flush(function(){})}Object.defineProperty(t,"__esModule",{value:!0}),t.initializeLivePersonaCard=function(a,s,l){return r=r||new Promise(function(t,i){try{var r,o,n=new y.a;e=a,v.AWT.initialize(b),v.AWT.setContext("culture",e.culture),v.AWT.setContext("region",e.region),v.AWT.setContext("clientType",e.clientType),v.AWT.setContext("clientContextType",e.clientContextType),v.AWT.setContext("clientCorrelationId",e.clientCorrelationId),v.AWT.setContext("bootstrapperVersion",_),d.i(g.a)(a).then(function(){return d.i(m.a)(a)}).then(function(e){return n.measureFromStart(y.b.getAuthToken),o=d.i(m.b)(e),a.tenantAadObjectId=o.tenantId,a.userAadObjectId=o.userAadId,a.userPuid=o.userPuid,d.i(p.a)(e,a)}).then(function(e){return n.measureFromStart(y.b.getLokiConfig),r=e,v.AWT.setContext("LokiUrl",e.LokiUrl),v.AWT.setContext("tenantAadObjectId",o.tenantId),v.AWT.setContext("userAadObjectId",o.userAadId),v.AWT.setContext("userPuid",o.userPuid),d.i(f.a)(r)}).then(function(){return n.measureFromStart(y.b.getLpcBundles),d.i(h.a)(r,a,n)}).then(function(){var e=c(n.getAllTimings());e.RootCorrelationId=r.RootCorrelationId,v.AWT.logEvent({name:"initializeLivePersonaCard_success",properties:e}),u(),s&&s(),t()}).catch(function(e){var t=c(n.getAllTimings());e.type&&(t.ErrorType=e.type),e.message&&(t.ErrorMessage=e.message),e.rootCorrelationId&&(t.RootCorrelationId=e.rootCorrelationId),navigator&&void 0!==typeof navigator.onLine&&(t.IsClientOnline=navigator.onLine),t.IsCatastrophic=!1,v.AWT.logEvent({name:"initializeLivePersonaCard_failure",properties:t}),u(),l&&l("Failed to initialize Live Persona Card: "+e.type),i("Failed to initialize Live Persona Card: "+e.type)})}catch(e){try{v.AWT.logEvent({name:"initializeLivePersonaCard_failure",properties:{IsCatastrophic:!0,Reason:e.toString()},tenantToken:b}),u()}catch(e){console.error("Couldn't log error through ARIA: "+e.toString())}l&&l("Failed to initialize Live Persona Card: "+e.name+" "+e.message),i("Failed to initialize Live Persona Card: "+e.name+" "+e.message)}var e})},t.fetchLokiConfig=function(t){return d.i(m.a)(t).then(function(e){return d.i(p.a)(e,t)})};var i=d(17),p=(d.n(i),d(22)),m=d(21),h=d(24),f=d(23),g=d(31),y=d(28),v=d(5),_=(d.n(v),d(34));d.i(i.polyfill)();var r,b="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257"},function(e,t,i){"use strict";(r=t.BondDataType||(t.BondDataType={}))[r.BT_STOP=0]="BT_STOP",r[r.BT_STOP_BASE=1]="BT_STOP_BASE",r[r.BT_UINT8=3]="BT_UINT8",r[r.BT_UINT32=5]="BT_UINT32",r[r.BT_UINT64=6]="BT_UINT64",r[r.BT_STRING=9]="BT_STRING",r[r.BT_STRUCT=10]="BT_STRUCT",r[r.BT_LIST=11]="BT_LIST",r[r.BT_MAP=13]="BT_MAP",r[r.BT_INT32=16]="BT_INT32",r[r.BT_INT64=17]="BT_INT64",r[r.BT_UNAVAILABLE=127]="BT_UNAVAILABLE";var r},function(e,t,i){"use strict";var a=i(1),r=function(){function e(){}return e.GetBytes=function(e){for(var t=[],i=0;i<e.length;++i){var r=e.charCodeAt(i);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||57344<=r?t.push(224|r>>12,128|r>>6&63,128|63&r):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++i)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t},e}();t.Utf8=r;var o=function(){function e(){}return e.GetString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[],r=e.length%3,o=0,n=e.length-r;o<n;o+=3){var a=(e[o]<<16)+(e[o+1]<<8)+e[o+2];i.push([t.charAt((s=a)>>18&63),t.charAt(s>>12&63),t.charAt(s>>6&63),t.charAt(63&s)].join(""))}var s;switch(r){case 1:a=e[e.length-1];i.push(t.charAt(a>>2)),i.push(t.charAt(a<<4&63)),i.push("==");break;case 2:var l=(e[e.length-2]<<8)+e[e.length-1];i.push(t.charAt(l>>10)),i.push(t.charAt(l>>4&63)),i.push(t.charAt(l<<2&63)),i.push("=")}return i.join("")},e}();t.Base64=o;var n=function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},e}();t.Varint=n;var s=function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,i=e.high,r=[];i||4294967168&t;)r.push(127&t|128),t=(127&i)<<25|t>>>7,i>>>=7;return r.push(127&t),r},e}();t.Varint64=s;var l=function(){function e(){}return e.EncodeZigzag32=function(e){return(e=a.Number.ToInt32(e))<<1^e>>31},e.EncodeZigzag64=function(e){var t=e.low,i=e.high,r=i<<1|t>>>31,o=t<<1;2147483648&i&&(r=~r,o=~o);var n=new a.UInt64("0");return n.low=o,n.high=r,n},e}();t.Zigzag=l},function(e,t,i){"use strict";var r=i(1),o=function(){function e(){this._buffer=[]}return e.prototype.WriteByte=function(e){this._buffer.push(r.Number.ToByte(e))},e.prototype.Write=function(e,t,i){for(;i--;)this.WriteByte(e[t++])},e.prototype.GetBuffer=function(){return this._buffer},e}();t.MemoryStream=o},function(e,t,i){"use strict";var r=i(8);t.BondDataType=r.BondDataType;var o=i(9);t.Encoding=o;var n=i(10);t.IO=n;var a=i(1);t.Int64=a.Int64,t.UInt64=a.UInt64,t.Number=a.Number;var s=function(){function e(e){this._stream=e}return e.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)},e.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e)},e.prototype.WriteMapContainerBegin=function(e,t,i){this.WriteUInt8(t),this.WriteUInt8(i),this.WriteUInt32(e)},e.prototype.WriteFieldBegin=function(e,t){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},e.prototype.WriteInt32=function(e){e=o.Zigzag.EncodeZigzag32(e),this.WriteUInt32(e)},e.prototype.WriteInt64=function(e){this.WriteUInt64(o.Zigzag.EncodeZigzag64(e))},e.prototype.WriteString=function(e){if(""===e)this.WriteUInt32(0);else{var t=o.Utf8.GetBytes(e);this.WriteUInt32(t.length),this._stream.Write(t,0,t.length)}},e.prototype.WriteStructEnd=function(e){this.WriteUInt8(e?r.BondDataType.BT_STOP_BASE:r.BondDataType.BT_STOP)},e.prototype.WriteUInt32=function(e){var t=o.Varint.GetBytes(a.Number.ToUInt32(e));this._stream.Write(t,0,t.length)},e.prototype.WriteUInt64=function(e){var t=o.Varint64.GetBytes(e);this._stream.Write(t,0,t.length)},e.prototype.WriteUInt8=function(e){this._stream.WriteByte(a.Number.ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=s},function(e,t,i){"use strict";var r=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){var i=this;if(e&&t)try{var r=e.split(",");if("this-request-only"===t)return r;var o=1e3*parseInt(t,10);r.forEach(function(e){i._killedTokenDictionary[e]=Date.now()+o})}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,i){"use strict";var r=i(3),o=function(){function e(e,t){this._maxRequestSize=e,this._outboundQueue=t,this._currentBatch={},this._currentBatchSize=0}return e.prototype.addEventToBatch=function(e){var t=r.default.getEventBlob(e);t.length>this._maxRequestSize||(this._currentBatchSize+t.length>this._maxRequestSize?this.flushBatch():(void 0===this._currentBatch[e.tenantToken]&&(this._currentBatch[e.tenantToken]=[]),this._currentBatch[e.tenantToken].push(t),this._currentBatchSize+=t.length))},e.prototype.flushBatch=function(){0<this._currentBatchSize&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentBatchSize=0)},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=o},function(e,t,i){"use strict";var r=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(300<=e&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,i=Math.floor(1200*Math.random())+2400;return t=Math.pow(4,e)*i,Math.min(t,12e4)},e}();Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,i){"use strict";var r=i(2),o=i(16),n=i(4),a=i(6),s=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,l=/\./g,d=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,c=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),this._isInitialized)throw"Already Initialized";this._defaultTenantToken=e,this._overrideValuesFromConfig(t),o.default.initialize(this._config),this._isInitialized=!0},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&o.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._isDestroyed=!0,o.default.flushAndTeardown())},e.setContext=function(e,t,i){void 0===i&&(i="allTkns"),null!==(t=this._sanitizeProperty(e,t))&&(this._contextProperties[i]||(this._contextProperties[i]={}),this._contextProperties[i][e]=t)},e.logEvent=function(t){var i=this;if(this._isInitialized){if(!t.name||!t.properties)return;t.name=t.name.toLowerCase(),t.name.replace(l,"_");var e="";if(t.type?(t.type.toLowerCase(),e="custom."):t.type="custom",!s.test(t.name)||!s.test(t.type))return;if(t.type=e+t.type,isNaN(t.timestamp)&&(t.timestamp=(new Date).getTime()),t.tenantToken||(t.tenantToken=this._defaultTenantToken),t.id=n.newGuid(),Object.keys(t.properties).forEach(function(e){t.properties[e]=i._sanitizeProperty(e,t.properties[e]),null===t.properties[e]&&delete t.properties[e]}),this._addContextIfAbsent(t,t.tenantToken),this._addContextIfAbsent(t,"allTkns"),0===Object.keys(t.properties).length)return;this._setDefaultProperty(t,"EventInfo.InitId",this._getInitId(t.tenantToken)),this._setDefaultProperty(t,"EventInfo.Sequence",this._getSequenceId(t.tenantToken)),this._setDefaultProperty(t,"EventInfo.SdkVersion",a.FullVersionString),this._setDefaultProperty(t,"EventInfo.Name",t.name),this._setDefaultProperty(t,"EventInfo.Time",new Date(t.timestamp).toISOString()),o.default.sendEvent(t)}},e._overrideValuesFromConfig=function(e){e.collectorUrl&&(this._config.collectorUrl=e.collectorUrl),1e3<e.sendingTimer&&(this._config.sendingTimer=e.sendingTimer)},e._getInitId=function(e){return void 0===this._initIdMap[e]&&(this._initIdMap[e]=n.newGuid()),this._initIdMap[e]},e._getSequenceId=function(e){return void 0===this._sequenceIdMap[e]&&(this._sequenceIdMap[e]=0),(++this._sequenceIdMap[e]).toString()},e._setDefaultProperty=function(e,t,i){e.properties[t]={value:i,pii:r.AWTPiiKind.NotSet}},e._addContextIfAbsent=function(t,e){if(this._contextProperties[e]){var i=this._contextProperties[e];Object.keys(i).forEach(function(e){t.properties[e]||(t.properties[e]=i[e])})}},e._sanitizeProperty=function(e,t){return"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||(t={value:t}),d.test(e)&&null!=t&&null!==t.value&&void 0!==t.value&&""!==t.value?(void 0===t.pii&&(t.pii=r.AWTPiiKind.NotSet),t.value=t.value.toString(),n.isPii(t.pii)?t:null):null},e}();c._isInitialized=!1,c._isDestroyed=!1,c._contextProperties={},c._sequenceIdMap={},c._initIdMap={},c._config={collectorUrl:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",sendingTimer:1e3},Object.defineProperty(t,"__esModule",{value:!0}),t.default=c},function(e,t,i){"use strict";var r=i(13),l=i(3),s=i(14),o=i(12),n=i(6),a=function(){function e(){}return e.initialize=function(e){this._inboundQueues.push([]),this._recordBatcher=new r.default(2936012,this._outboundQueue),this._newEventsAllowed=!0,"undefined"==typeof Uint8Array&&(this._urlString+="&content-encoding=base64"),this._sendingTimer=e.sendingTimer,this._urlString=e.collectorUrl+this._urlString+"&x-apikey="},e.sendEvent=function(e){var t=this;this._newEventsAllowed&&(this._inboundQueues[this._inboundQueues.length-1].push(e),!this._running&&this._timeout<0&&!this._isCurrentlyFlushing&&(this._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},this._sendingTimer)))},e.flushAndTeardown=function(){this._newEventsAllowed=!1,this._batchAndSendEvents(!0)},e.flush=function(e){this._inboundQueues.push([]),this._isCurrentlyFlushing?this._flushQueue.push(e):(this._isCurrentlyFlushing=!0,this._flush(e))},e._batchAndSendEvents=function(e){for(this._running=!0;0<this._inboundQueues[0].length&&this._outboundQueue.length<1;)this._recordBatcher.addEventToBatch(this._inboundQueues[0].pop());0===this._outboundQueue.length&&this._recordBatcher.flushBatch(),this._sendRequest(this._outboundQueue.pop(),0,e)},e._retryRequestIfNeeded=function(e,t,i,r,o){var n=this,a=!0;e&&void 0!==e.status&&(this._killSwitch.setKillSwitchTenants(e.getResponseHeader("kill-tokens"),e.getResponseHeader("kill-duration-seconds")).forEach(function(e){delete t[e],i--}),(!s.default.shouldRetryForStatus(e.status)||i<=0)&&(a=!1));a&&o<4?setTimeout(function(){return n._sendRequest(t,o+1,!1)},s.default.getMillisToBackoffForRetry(o)):this._handleRequestFinished(null)},e._sendRequest=function(t,e,i){var r=this,o=new XMLHttpRequest,n=0,a="";if(Object.keys(t).forEach(function(e){r._killSwitch.isTenantKilled(e)?delete t[e]:(0<a.length&&(a+=","),a+=e,n++)}),o.open("POST",this._urlString+a,!i),i||(o.ontimeout=function(){r._retryRequestIfNeeded(o,t,n,a,e)},o.onerror=function(){r._retryRequestIfNeeded(o,t,n,a,e)},o.onload=function(){r._handleRequestFinished(o)}),0<n){var s=l.default.getPayloadBlob(t,n);"undefined"==typeof Uint8Array?o.send(l.default.base64Encode(s)):o.send(new Uint8Array(s))}else i&&this._handleRequestFinished(null)},e._handleRequestFinished=function(e){var t=this;e&&this._killSwitch.setKillSwitchTenants(e.getResponseHeader("kill-tokens"),e.getResponseHeader("kill-duration-seconds")),0<this._inboundQueues[0].length?this._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},this._sendingTimer):(this._timeout=-1,this._running=!1)},e._flush=function(e){var t=this;this._running||(-1<this._timeout&&(clearTimeout(this._timeout),this._timeout=-1),0<this._inboundQueues[0].length&&this._batchAndSendEvents(!1)),this._checkPrimaryInboundQueueEmpty(function(){t._inboundQueues.shift(),null!=e&&e(),0<t._flushQueue.length?setTimeout(function(){return t._flush(t._flushQueue.shift())},t._sendingTimer):(t._isCurrentlyFlushing=!1,0<t._inboundQueues[0].length&&(t._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},t._sendingTimer)))})},e._checkPrimaryInboundQueueEmpty=function(e){var t=this;0===this._inboundQueues[0].length?this._checkOutboundQueueEmptyAndSent(e):setTimeout(function(){return t._checkPrimaryInboundQueueEmpty(e)},250)},e._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._running?setTimeout(function(){return t._checkOutboundQueueEmptyAndSent(e)},250):e()},e}();a._outboundQueue=[],a._inboundQueues=[],a._newEventsAllowed=!1,a._killSwitch=new o.default,a._isCurrentlyFlushing=!1,a._flushQueue=[],a._running=!1,a._timeout=-1,a._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+n.FullVersionString,Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,W){(function(q,j){e.exports=function(){"use strict";function d(e){return"function"==typeof e}function t(){var e=setTimeout;return function(){return e(i,1)}}function i(){for(var e=0;e<P;e+=2)(0,F[e])(F[e+1]),F[e]=void 0,F[e+1]=void 0;P=0}function s(e,t){var i=arguments,r=this,o=new this.constructor(c);void 0===o[R]&&v(o);var n,a=r._state;return a?(n=i[a-1],T(function(){return y(a,o,n,r._result)})):f(r,o,e,t),o}function l(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(c);return p(t,e),t}function c(){}function a(e){try{return e.then}catch(e){return V.error=e,V}}function u(e,t,i){t.constructor===e.constructor&&i===s&&t.constructor.resolve===l?(n=e,(a=t)._state===O?m(n,a._result):a._state===B?h(n,a._result):f(a,void 0,function(e){return p(n,e)},function(e){return h(n,e)})):i===V?(h(e,V.error),V.error=null):void 0===i?m(e,t):d(i)?(r=t,o=i,T(function(t){var i=!1,e=function(e,t,i,r){try{e.call(t,i,r)}catch(e){return e}}(o,r,function(e){i||(i=!0,r!==e?p(t,e):m(t,e))},function(e){i||(i=!0,h(t,e))},t._label);!i&&e&&(i=!0,h(t,e))},e)):m(e,t);var r,o,n,a}function p(e,t){e===t?h(e,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(i=t)||"object"==typeof i&&null!==i?u(e,t,a(t)):m(e,t);var i}function r(e){e._onerror&&e._onerror(e._result),g(e)}function m(e,t){e._state===N&&(e._result=t,e._state=O,0!==e._subscribers.length&&T(g,e))}function h(e,t){e._state===N&&(e._state=B,e._result=t,T(r,e))}function f(e,t,i,r){var o=e._subscribers,n=o.length;e._onerror=null,o[n]=t,o[n+O]=i,o[n+B]=r,0===n&&e._state&&T(g,e)}function g(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var r=void 0,o=void 0,n=e._result,a=0;a<t.length;a+=3)r=t[a],o=t[a+i],r?y(i,r,o,n):o(n);e._subscribers.length=0}}function e(){this.error=null}function y(e,t,i,r){var o=d(i),n=void 0,a=void 0,s=void 0,l=void 0;if(o){if((n=function(e,t){try{return e(t)}catch(e){return U.error=e,U}}(i,r))===U?(l=!0,a=n.error,n.error=null):s=!0,t===n)return void h(t,new TypeError("A promises callback cannot return that same promise."))}else n=r,s=!0;t._state!==N||(o&&s?p(t,n):l?h(t,a):e===O?m(t,n):e===B&&h(t,n))}function v(e){e[R]=H++,e._state=void 0,e._result=void 0,e._subscribers=[]}function o(e,t){this._instanceConstructor=e,this.promise=new e(c),this.promise[R]||v(this.promise),C(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?m(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&m(this.promise,this._result))):h(this.promise,new Error("Array Methods must be provided an Array"))}function _(e){this[R]=H++,this._result=this._state=void 0,this._subscribers=[],c!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof _?function(t,e){try{e(function(e){p(t,e)},function(e){h(t,e)})}catch(e){h(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}var n,b,x,S,C=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},P=0,k=void 0,I=void 0,T=function(e,t){F[P]=e,F[P+1]=t,2===(P+=2)&&(I?I(i):L())},w="undefined"!=typeof window?window:void 0,E=w||{},D=E.MutationObserver||E.WebKitMutationObserver,A="undefined"==typeof self&&void 0!==q&&"[object process]"==={}.toString.call(q),M="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,F=new Array(1e3),L=void 0;L=A?function(){return q.nextTick(i)}:D?(b=0,x=new D(i),S=document.createTextNode(""),x.observe(S,{characterData:!0}),function(){S.data=b=++b%2}):M?((n=new MessageChannel).port1.onmessage=i,function(){return n.port2.postMessage(0)}):void 0===w?function(){try{var e=W(35);return void 0!==(k=e.runOnLoop||e.runOnContext)?function(){k(i)}:t()}catch(e){return t()}}():t();var R=Math.random().toString(36).substring(16),N=void 0,O=1,B=2,V=new e,U=new e,H=0;return o.prototype._enumerate=function(){for(var e=this.length,t=this._input,i=0;this._state===N&&i<e;i++)this._eachEntry(t[i],i)},o.prototype._eachEntry=function(t,e){var i=this._instanceConstructor,r=i.resolve;if(r===l){var o=a(t);if(o===s&&t._state!==N)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(i===_){var n=new i(c);u(n,t,o),this._willSettleAt(n,e)}else this._willSettleAt(new i(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},o.prototype._settledAt=function(e,t,i){var r=this.promise;r._state===N&&(this._remaining--,e===B?h(r,i):this._result[t]=i),0===this._remaining&&m(r,this._result)},o.prototype._willSettleAt=function(e,t){var i=this;f(e,void 0,function(e){return i._settledAt(O,t,e)},function(e){return i._settledAt(B,t,e)})},_.all=function(e){return new o(this,e).promise},_.race=function(o){var n=this;return new n(C(o)?function(e,t){for(var i=o.length,r=0;r<i;r++)n.resolve(o[r]).then(e,t)}:function(e,t){return t(new TypeError("You must pass an array to race."))})},_.resolve=l,_.reject=function(e){var t=new this(c);return h(t,e),t},_._setScheduler=function(e){I=e},_._setAsap=function(e){T=e},_._asap=T,_.prototype={constructor:_,then:s,catch:function(e){return this.then(null,e)}},_.polyfill=function(){var e=void 0;if(void 0!==j)e=j;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var i=null;try{i=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===i&&!t.cast)return}e.Promise=_},_.Promise=_}()}).call(t,W(33),W(32))},function(e,t){function s(e){this.message=e}var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";(s.prototype=new Error).name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new s("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,r,o=0,n=0,a="";r=t.charAt(n++);~r&&(i=o%4?64*i+r:r,o++%4)?a+=String.fromCharCode(255&i>>(-2*o&6)):0)r=l.indexOf(r);return a}},function(e,t,i){var r=i(18);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return decodeURIComponent(r(t).replace(/(.)/g,function(e,t){var i=t.charCodeAt(0).toString(16).toUpperCase();return i.length<2&&(i="0"+i),"%"+i}))}catch(e){return r(t)}}},function(e,t,i){"use strict";function r(e){this.message=e}var o=i(19);(r.prototype=new Error).name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new r("Invalid token specified");var i=!0===(t=t||{}).header?0:1;try{return JSON.parse(o(e.split(".")[i]))}catch(e){throw new r("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=r},function(e,t,o){"use strict";t.a=function(e){return i=i||new Promise(function(i,r){e.authToken?(o.i(n.a)(s,e.authToken),i(e.authToken)):e.getAuthToken(function(e,t){e?(o.i(n.a)(s,e),i(e)):r(new a.a("GetAuthTokenError","Auth token is undefined",t))},function(e,t){r(new a.a("GetAuthTokenError",e,t))})})},t.b=function(e){if(!e)throw Error("Empty AuthToken");var t=r(e);return{tenantId:t.tid,userAadId:t.oid,userPuid:t.puid,expirationTimeEpoch:t.exp}};var i,n=o(29),a=o(0),r=o(20),s=(o.n(r),"LokiAuthToken")},function(e,t,c){"use strict";t.a=function(l,d){return i=i||new Promise(function(t,i){var e,r,o=new XMLHttpRequest,n=(e=d,r=c.i(u.a)(v)||e.culture,"ppe"===e.region||"df"===e.region||"msit"===e.region?h.replace("{0}",e.region).replace("{1}",e.clientType).replace("{2}",r):f.replace("{0}",e.clientType).replace("{1}",r));o.open("GET",n,!0),o.setRequestHeader("authToken",l),o.setRequestHeader("Accept","application/json");var a=c.i(p.a)();o.setRequestHeader("X-RootCorrelationId",a),o.setRequestHeader("X-CorrelationId",a),o.setRequestHeader("X-ClientCorrelationId",d.clientCorrelationId),o.setRequestHeader("X-ClientType",d.clientType);var s=c.i(u.a)(y);s&&o.setRequestHeader(y,s),o.addEventListener("load",function(){if(200===o.status)try{var e=JSON.parse(o.response);e.RootCorrelationId=a,e.LokiVersion=o.getResponseHeader("x-serverversion")||"",t(e)}catch(e){i(new m.a("GetLokiConfigError","Failed to parse initialization config.",a))}else i(new m.a("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+o.status,a))}),o.addEventListener("error",function(){i(new m.a("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",a))}),o.addEventListener("timeout",function(){i(new m.a("GetLokiConfigError","Loki config request timed out after "+g+" ms.",a))}),o.timeout=g,o.send()})};var i,u=c(26),p=c(25),m=c(0),h="https://{0}.loki.delve.office.com/api/v1/configuration/{1}/{2}",f="https://loki.delve.office.com/api/v1/configuration/{0}/{1}",g=6e4,y="LivePersonaCardVersionOverride",v="LivePersonaCardCultureOverride"},function(e,t,r){"use strict";t.a=function(e){if(!o){var t,i=e.Resources[l];t="OwaPeopleHub"===e.Workload?e.Resources[s]:e.Resources[a],o=Promise.all([r.i(n.a)(i),r.i(n.a)(t)])}return o};var o,n=r(27),a="livepersonacard_full",s="livepersonacard_global",l="livepersonacardstrings"},function(e,t,i){"use strict";t.a=function(s,l,d){return r=r||new Promise(function(e,t){try{var i=(r=s,n=d,{refreshAuthToken:(a=o=l,function(i){a.getAuthToken(function(e,t){i(e,"",t)},function(e,t){i("",e,t)})}),logToExternalApplication:o.logMessage,logToExternalAria:function(e,t){e.tenantToken=t,u.AWT.logEvent(e)},contextType:o.clientContextType,strings:window.LivePersonaCardStrings.strings,source:o.clientType,consumerCorrelationId:o.clientCorrelationId,activeFlights:r.Flights,performanceTimings:n.getAllTimings(),isDebug:!1,region:o.region,culture:o.culture,dataCallbacks:o.dataCallbacks,actionCallbacks:o.actionCallbacks,privateDataCallbacks:o.privateDataCallbacks,privateActionCallbacks:o.privateActionCallbacks,options:o.options?o.options:{isLinkedInIntegrationEnabled:!1,hideDocumentFilter:!1},lokiUrl:r.LokiUrl,lokiVersion:r.LokiVersion,tenantAadObjectId:o.tenantAadObjectId,userAadObjectId:o.userAadObjectId,userPuid:o.userPuid});window.LPC.start(i),e()}catch(e){t(new c.a("StartLivePersonaCardError",e.name+" "+e.message))}var r,o,n,a})};var r,c=i(0),u=i(5);i.n(u)},function(e,t,i){"use strict";t.a=function(){return r.replace(/[xy]/g,function(e){var t;if(window.crypto){var i=new Uint8Array(1);window.crypto.getRandomValues(i),t=i[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)})};var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx"},function(e,t,i){"use strict";t.a=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}},function(e,t,i){"use strict";t.a=function(r){return new Promise(function(e,t){var i=document.createElement("script");i.type="text/javascript",i.crossOrigin="anonymous",i.src=r,i.addEventListener("load",function(){e()}),i.addEventListener("error",function(){t(new o.a("LoadScriptError","Unexpected error while loading script on page."))}),document.body.appendChild(i)})};var o=i(0)},function(e,t,i){"use strict";i.d(t,"b",function(){return r}),i.d(t,"a",function(){return n});var r,o;(o=r||(r={})).getAuthToken="GetAuthTokenFromStartDuration",o.getLokiConfig="GetLokiConfigFromStartDuration",o.getLpcBundles="GetLpcBundlesFromStartDuration";var n=function(){function e(){this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.getAllTimings=function(){var r=this;if(window.performance&&"function"==typeof window.performance.getEntriesByType){var e=window.performance.getEntriesByType("resource");e&&e.forEach(function(e){if(e&&e.name){var t=e.name.toLowerCase(),i=!1;-1!==t.indexOf("authtoken/loki")?(t="AuthRequestDuration",i=!0):-1!==t.indexOf("/lpc/versionless/livepersonacard_")?(t="LpcBundleRequestDuration",i=!0):-1!==t.indexOf("/lpc/versionless/livepersonacardstrings")?(t="LpcStringsRequestDuration",i=!0):-1!==t.indexOf("/api/v1/configuration/")&&(t="InitConfigRequestDuration",i=!0),i&&(r.timings[t]=Math.round(e.duration))}})}return this.timings},e.prototype.getCurrentTime=function(){return window.performance&&"function"==typeof window.performance.now?performance.now():Date.now()},e}()},function(e,t,i){"use strict";t.a=function(e,t){try{sessionStorage&&sessionStorage.setItem&&sessionStorage.setItem(e,t)}catch(e){}}},function(e,t,i){"use strict";t.a=function(e){return void 0===e||"string"!=typeof e||""===e||null===e},t.b=function(e){return void 0===e||"function"!=typeof e}},function(e,t,o){"use strict";t.a=function(r){return new Promise(function(e,t){var i=function(e){var t="";if(e){var i=[];o.i(n.a)(e.culture)&&i.push("culture"),o.i(n.a)(e.clientType)&&i.push("clientType"),o.i(n.a)(e.clientContextType)&&i.push("clientContextType"),o.i(n.a)(e.clientCorrelationId)&&i.push("clientCorrelationId"),o.i(n.b)(e.logMessage)&&i.push("logMessage"),o.i(n.b)(e.getAuthToken)&&i.push("getAuthToken"),0<i.length&&(t="Invalid required parameter(s): "+i.join(", ")+". Check the values and types you're passing."),e.region&&-1===s.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+s.join(", ")+" for pre-production environments.")}else t="Config must be defined.";return t}(r);i?t(new a.a("ValidateBootstrapperConfigError",i)):e()})};var n=o(30),a=o(0),s=["msit","df","ppe"]},function(e,t){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t){function i(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(d===setTimeout)return setTimeout(t,0);if((d===i||!d)&&setTimeout)return d=setTimeout,setTimeout(t,0);try{return d(t,0)}catch(e){try{return d.call(null,t,0)}catch(e){return d.call(this,t,0)}}}function n(){h&&p&&(h=!1,p.length?m=p.concat(m):f=-1,m.length&&a())}function a(){if(!h){var e=o(n);h=!0;for(var t=m.length;t;){for(p=m,m=[];++f<t;)p&&p[f].run();f=-1,t=m.length}p=null,h=!1,function(t){if(c===clearTimeout)return clearTimeout(t);if((c===r||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}(e)}}function s(e,t){this.fun=e,this.array=t}function l(){}var d,c,u=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:i}catch(e){d=i}try{c="function"==typeof clearTimeout?clearTimeout:r}catch(e){c=r}}();var p,m=[],h=!1,f=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];m.push(new s(e,t)),1!==m.length||h||o(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=l,u.addListener=l,u.once=l,u.off=l,u.removeListener=l,u.removeAllListeners=l,u.emit=l,u.prependListener=l,u.prependOnceListener=l,u.listeners=function(e){return[]},u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t){e.exports="1.3.17"},function(e,t){},function(e,t,i){e.exports=i(7)}])});define("Gx",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".sp-livePersonaCardAdapter-root{display:inline-block}"}])});define("Ql",["require","exports","ap","bN","bX","dk","vq","eT"],function(e,t,n,i,r,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){n.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._actionMap=t.resources.consume(r.actionMap);t._itemTaskObserver=new(t.resources.consume(s.resourceKey));return t}e.prototype.navigateToItem=function(e,t,i){var r=this;if(i){var o=t.driveItem;o.webUrl||(o=n.__assign({},o,{webUrl:i}));t.isFolder?this.navigateToFolder(o.webUrl):this._convertToOneDriveItem(e,o).then(function(e){r.navigateToFile(e)})}};e.prototype.navigateToFile=function(e){var t=this.createObservable(e);if(this._isOfficeItem(e)){new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:t}).execute(void 0)}else{new(this.managed(this._actionMap.ExternalNavigateAction))({item:t}).execute(void 0)}};e.prototype.navigateToFolder=function(e){new(this.managed(this._actionMap.NavigationAction))({url:e,forceNavigation:!0,target:"_blank"}).execute(void 0)};e.prototype._isOfficeItem=function(e){var t=e.extension&&e.extension.replace(/^\./,"");e.appMap=t&&o.OfficeIconFileTypeMap[t];return e.appMap&&".pdf"!==e.extension};e.prototype._convertToOneDriveItem=function(i,r){var o=this;return this.resources.consumeAsync(a.resourceKey).then(function(e){var t=e.processItem({itemFromServer:r,requestKey:i.key,observer:o._itemTaskObserver}).key;o._itemTaskObserver.flush();return o._itemTaskObserver.getItem({key:t})})};return e}(i.default);t.default=l});define("Qk",["c","az"],function(e,t){e.loadStyles([{rawString:".od-ItemActivityFeedWrapper .sp-livePersonaCardAdapter-root{font-family:inherit;font-size:inherit}"}])});define("Qi",["c","az"],function(e,t){e.loadStyles([{rawString:".od-DetailsPane-ItemActivityFeedSection{margin:12px 0;padding:0 16px}.od-DetailsPane-ItemActivityFeedSection-title{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";margin:12px 0;padding:8px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities{font-size:12px}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 0 0 8px}html[dir=rtl] .od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 8px 0 0}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-timeStamp{padding-top:2px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-missingActivity{margin-bottom:12px}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityTypeIcon{font-size:16px!important}"}])});define("PS",["require","exports","ap","at","PT","N3"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,i=e.resources;return r.createElement(n.default,{sectionControlKey:o.resourceKey,item:t,resources:i})};return t}(r.Component);t.default=a});define("PT",["require","exports","P1","b5","b3","P0","PZ","PU"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-activities-feed",template:e("P0"),viewModel:i.default,synchronous:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"ms-activities-feed",name:e("module").id,template:e("P0"),viewModelType:i.default});t.default=n});define("P1",["require","exports","ap","bF","aC","qH","bX","eO","hs","Qg","Qf","P3","P2","V","OR","dz","cJ","lB","c7","Pa"],function(i,e,t,r,o,p,m,n,h,a,f,g,s,y,v,_,b,x,l,S){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var C=a.strings,P=100,k='<a href="#">',I="</a>",d=function(u){t.__extends(e,u);function e(e,t){void 0===t&&(t={});var i=u.call(this,e,t)||this,r=i.observables,o=i.resources;i._item=e.item;i._currentItem=i.resources.consume(m.currentItem);i.addBindingHandlers({bindableHtml:p.default,keyboard:b.default,toggle:v.default,selection:_.default});var n=o.consume(m.isSharingSectionExpanded.optional),a=i.resources.consume(m.actionMap);i._showVersionHistoryAction=new(i.child(a.ShowVersionHistoryAction));i._itemActivityResults=r.create([]);i.isLoading=r.create(!0);i.loadingSpinnerFlatTagName=x.default.tagName;i._helper=new(i.managed(g.default));i.sectionHelper=new(i.managed(S.default))({shouldStartExpanded:!n||!n.peek()});i.keyNav=new f.default;var s=i.thisWeekCollection=r.createArray([]),l=i.lastWeekCollection=r.createArray([]),d=i.earlierCollection=r.createArray([]);i.resxStrings=C;i.hasChanges=r.pureCompute(i._computeHasChanges);i.showForEarlierChangesMsg=r.pureCompute(i._computeShowForEarlierChangesMsg);i.forEarlierChangesMsg=y.format(C.ForEarlierChanges,k,I);i._activityComponents=null;i.showSeeMore=r.create(!1);i.seeMoreText=C.ActivitiesFeedShowMore;i.errorMessage=i.createObservable(null);var c=r.createArray([{title:C.ActivitiesFeedThisWeekListText,tiles:s},{title:C.ActivitiesFeedLastWeekListText,tiles:l},{title:C.ActivitiesFeedEarlierListText,tiles:d}]);i.tileCollections=i.addDisposable(c.filter(function(e){return 0<e.tiles().length}));i._itemActivityQueryParams={add:!0,deleteObject:!0,fetchLimit:P,group:!0,item:!0,latestFirst:!0,move:!0,rename:!0,restore:!0,roleAssignmentAdd:!0,roleDefinitionAdd:!0,update:!0,user:!0};r.backgroundCompute(i._updateActivities);r.backgroundCompute(i._computeUpdateActivityComponents);return i}e.prototype.onFileVersionClick=function(e,t){this._showVersionHistoryAction.execute(t).done();return!1};e.prototype.onSeeMore=function(){var e=this;this.showSeeMore(!1);this.isLoading(!0);this.async.setTimeout(function(){e._generateCollectionsToRender(e._activityComponents,!0);e.isLoading(!1)},0);return!1};e.prototype._updateActivities=function(){var t=this,i=this._item();this.isLoading(!0);this.thisWeekCollection([]);this.lastWeekCollection([]);this.earlierCollection([]);this.keyNav.focusableTiles([]);this._activityComponents=null;var r=i.type===n.default.Folder&&i===this._currentItem.peek();this._getItemActivityDataSource().then(function(e){return e.getItemActivities(i,t._itemActivityQueryParams,r)}).done(function(e){t._itemActivityResults(e);t.errorMessage(null);t.isLoading(!1)},function(e){t.errorMessage(t.resxStrings.Error);t.isLoading(!1)})};e.prototype._computeHasChanges=function(){return 0!==this._itemActivityResults().length};e.prototype._computeUpdateActivityComponents=function(){if(this.hasChanges()){this._activityComponents=s.default.process(this._itemActivityResults());this._generateCollectionsToRender(this._activityComponents,!1)}};e.prototype._computeShowForEarlierChangesMsg=function(){var e=this._item(),t=this._itemActivityResults();return(e.type===n.default.File||!!e.appMap)&&(!this.hasChanges()||1!==t[t.length-1].itemActivityChangeType)&&!this.showSeeMore()&&this._showVersionHistoryAction.isAvailable()};e.prototype._generateCollectionsToRender=function(e,t){var i=[],r=[],o=[],n=[];this.showSeeMore(!1);if(e)for(var a=0;a<e.length;a++){var s=e[a],l=this._helper.convertToTile(s,a),d=s.date;(h.isThisWeek(d)?i:h.isLastWeek(d)?r:o).push(l);n.push(l);var c=a+1;if(!t&&6===c&&e.length>c){this.showSeeMore(!0);break}}this.thisWeekCollection(i);this.lastWeekCollection(r);this.earlierCollection(o);this.keyNav.focusableTiles(n)};e.prototype._getItemActivityDataSource=function(){var t=this,e=l.loadModule({path:"iw",getModule:function(){return new o.default(function(e,t){i(["iw"],e,t)})}}).then(function(e){return new(t.managed(e))});this._getItemActivityDataSource=function(){return e};return e};e.dependencies=t.__assign({},r.default.dependencies);return e}(r.default);e.default=d});define("Qf",["require","exports","aq"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var t=this;this.keyboardOptions=[{target:null,mappings:{Left:this.keyLeft,Right:this.keyRight,Enter:this.onEnter,Space:this.onSpace}},{target:window,mappings:{}}];this.focusableTiles=i.observableArray([]);this.focusedItem=i.observable();this.sectionHeaderFocus=i.observable(!1);this.sectionHeaderFocus.subscribe(function(e){!e&&t.focusedItem()&&t.focusedItem().focused(!1)})}e.prototype.keyRight=function(e,t){e.keyNav.trySetExpansion(!0);t.stopPropagation();return!0};e.prototype.keyLeft=function(e,t){e.keyNav.trySetExpansion(!1);t.stopPropagation();return!0};e.prototype.onEnter=function(e,t){e.keyNav.trySetExpansion();t.stopPropagation();return!0};e.prototype.onSpace=function(e,t){return e.keyNav.onEnter(e,t)};e.prototype.trySetExpansion=function(e){var t=this.focusedItem();if(t&&1===t.type){var i=t,r=i.expanded();i.expanded(void 0===e?!r:e);if(r!==e){var o=this.focusableTiles,n=o.indexOf(i)+1;if(0<n&&i.focused()){var a=i.activities;i.expanded()?o.splice.apply(o,[n,0].concat(a)):o.splice(n,a.length)}}}};return e}();t.default=r});define("P3",["require","exports","ap","aq","bN","hs","P4","cL"],function(e,t,i,p,r,m,o,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(){var e=t.call(this)||this;e._headlineGenerator=e.resources.consume(o.resourceKey);return e}e.prototype.convertToTile=function(e,t){var i,r=e.relativeTime?m.getRelativeDateTimeStringForLists(e.relativeTime):m.getRelativeDateTimeStringPastWithHourMinute(e.date);if(1===e.type){for(var o=e,n=this._getMainEditor(o.editors),a=new Array,s=0,l=o.activities;s<l.length;s++){var d=l[s],c={date:d.date.toLocaleTimeString(h.default.language,{hour:"numeric",minute:"2-digit"}),editor:d.editor,focused:p.observable(!1),headline:this._headlineGenerator.generateActivityHeadline(d),type:0,navigateToOptions:d.navigateToOptions};a.push(c)}i={activities:a,date:r,editor:n,expanded:p.observable(!1),focused:p.observable(!1),headline:this._headlineGenerator.generateHeadline(o),index:t,type:1}}else if(0===e.type){var u=e;i={date:r,editor:u.editor,focused:p.observable(!1),headline:this._headlineGenerator.generateActivityHeadline(u),index:t,type:0,navigateToOptions:u.navigateToOptions}}return i};e.prototype._getMainEditor=function(e){var i,r=this;e.some(function(e){var t=e.email===r._headlineGenerator.userLoginName;t&&(i=e);return t});!i&&0<e.length&&(i=e[0]);return i};return e}(r.default);t.default=n});define("P4",["require","exports","dZ","PY","Qe","Qd","Qc","Qb","Qa","P9","P8","P7","P6","P5","U","V","bA"],function(e,t,i,l,o,r,d,c,n,a,s,u,p,m,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y='<span class="ms-fontWeight-semibold">',v='<span class="od-ItemActivityTile-ellipsisWrapper">',_="</span>",b=function(){function e(e,t){void 0===e&&(e={});this._userLoginName=t.identityDataSource.getIdentity().loginName}Object.defineProperty(e.prototype,"userLoginName",{get:function(){return this._userLoginName},enumerable:!0,configurable:!0});e.prototype.generateHeadline=function(e){var t=null;if(1===e.type){var i=e,r=this._encodeAggregate(i);t=this._generateAggregateHeadline(r)}else if(0===e.type){var o=e,n=this._encodeActivity(o);t=this.generateActivityHeadline(n)}return t};e.prototype.generateActivityHeadline=function(e){var t=this._encodeActivity(e),i=null,r=this._getEllipsisText(e,t.latestName),o=this._getEllipsisText(e,t.previousName,!0);this._isListItem="a list item"===e.latestName;switch(t.itemActivityChangeType){case 1:i=this._generateAddHeadline(t,r,o);break;case 2:i=this._generateCommentHeadline(t,r);break;case 3:i=this._generateEditHeadline(t,r);break;case 4:i=this._generateMoveHeadline(t,r);break;case 5:i=this._generateRemoveHeadline(t,r);break;case 6:i=this._generateRenameHeadline(t,r,o);break;case 7:i=this._generateRenameOrMoveHeadline(t,r);break;case 8:i=this._generateRestoreHeadline(t,r);break;case 9:i=this._generateShareHeadline(t,r);break;case 11:i=this._generateVersionHeadline(t,r);break;default:i=l.strings.DataFetchError}return i};e.prototype._encodeAggregate=function(e){for(var t=new Array,i=0;i<e.editors.length;i++){var r=this._encodePerson(e.editors[i]);t.push(r)}var o=new Array;for(i=0;i<e.activities.length;i++){var n=this._encodeActivity(e.activities[i]);o.push(n)}return{activities:o,editors:t,date:e.date,itemActivityChangeType:e.itemActivityChangeType,type:e.type}};e.prototype._encodeActivity=function(e){var t=this._encodePerson(e.editor),i=e.sharedWith,r=new Array;if(i)for(var o=0;o<e.sharedWith.length;o++){var n=this._encodePerson(e.sharedWith[o]);r.push(n)}return{id:e.id,changeToken:h.default.encodeText(e.changeToken),editor:t,latestName:h.default.encodeText(e.latestName),latestFolder:h.default.encodeText(e.latestFolder),previousName:h.default.encodeText(e.previousName),previousFolder:h.default.encodeText(e.previousFolder),sharedWith:r,date:e.date,itemActivityChangeType:e.itemActivityChangeType,type:e.type,navigateToOptions:e.navigateToOptions}};e.prototype._encodePerson=function(e){return{userId:h.default.encodeText(e.userId),email:h.default.encodeText(e.email),name:h.default.encodeText(e.name)}};e.prototype._generateAddHeadline=function(e,t,i){var r=o.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?f.format(r.AddListItemYou,y,_):f.format(r.AddItemYou,y,_,v,t,_):this._isListItem?f.format(r.AddListItem,y,e.editor.name,_):f.format(r.AddItem,y,e.editor.name,_,v,t,_):this._isListItem?r.AddListItemNoEditors:f.format(r.AddItemNoEditors,v,t,_)};e.prototype._generateCommentHeadline=function(e,t){var i=r.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?f.format(i.CommentListItemYou,y,_):f.format(i.CommentItemYou,y,_,v,t,_):this._isListItem?f.format(i.CommentListItem,y,e.editor.name,_):f.format(i.CommentItem,y,e.editor.name,_,v,t,_):this._isListItem?i.CommentListItemNoEditors:f.format(i.CommentItemNoEditors,v,t,_)};e.prototype._generateVersionHeadline=function(e,t){var i=m.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?f.format(i.VersionListItemYou,y,_):f.format(i.VersionItemYou,y,_,v,t,_):this._isListItem?f.format(i.VersionListItem,y,e.editor.name,_):f.format(i.VersionItem,y,e.editor.name,_,v,t,_):this._isListItem?i.VersionListItemNoEditors:f.format(i.VersionItemNoEditors,v,t,_)};e.prototype._generateEditHeadline=function(e,t){var i=d.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?f.format(i.ListItemEditYou,y,_):f.format(i.EditYou,y,_,v,t,_):this._isListItem?f.format(i.ListItemEdit,y,e.editor.name,_):f.format(i.Edit,y,e.editor.name,_,v,t,_):this._isListItem?i.ListItemEditNoEditors:f.format(i.EditNoEditors,v,t,_)};e.prototype._generateMoveHeadline=function(e,t){var i=c.strings,r=this._getEllipsisText(e,e.latestFolder),o=this._getEllipsisText(e,e.previousFolder,!0),n=!!e.latestFolder&&!!e.previousFolder,a=!e.latestFolder&&!!e.previousFolder,s=!!e.latestFolder&&!e.previousFolder;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?n?f.format(i.MoveFromToYou,y,_,v,t,_,v,o,_,v,r,_):a?f.format(i.MoveFromYou,y,_,v,t,_,v,o,_):s?f.format(i.MoveToYou,y,_,v,t,_,v,r,_):f.format(i.MoveYou,y,_,v,t,_):n?f.format(i.MoveFromTo,y,e.editor.name,_,v,t,_,v,o,_,v,r,_):a?f.format(i.MoveFrom,y,e.editor.name,_,v,t,_,v,o,_):s?f.format(i.MoveTo,y,e.editor.name,_,v,t,_,v,r,_):f.format(i.Move,y,e.editor.name,_,v,t,_):n?f.format(i.MoveFromToNoEditors,v,t,_,v,o,_,v,r,_):a?f.format(i.MoveFromNoEditors,v,t,_,v,o,_):s?f.format(i.MoveToNoEditors,v,t,_,v,r,_):f.format(i.MoveNoEditors,v,t,_)};e.prototype._generateRemoveHeadline=function(e,t){var i=n.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?f.format(i.ListItemRemoveYou,y,_):f.format(i.RemoveYou,y,_,v,t,_):this._isListItem?f.format(i.ListItemRemove,y,e.editor.name,_):f.format(i.Remove,y,e.editor.name,_,v,t,_):this._isListItem?i.ListItemRemoveNoEditors:f.format(i.RemoveNoEditors,v,t,_)};e.prototype._generateRenameHeadline=function(e,t,i){var r=a.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?e.previousName?f.format(r.RenameFromToYou,y,_,v,i,_,v,t,_):f.format(r.RenameToYou,y,_,v,t,_):e.previousName?f.format(r.RenameFromTo,y,e.editor.name,_,v,i,_,v,t,_):f.format(r.RenameTo,y,e.editor.name,_,v,t,_):e.previousName?f.format(r.RenameFromToNoEditors,v,i,_,v,t,_):f.format(r.RenameToNoEditors,v,t,_)};e.prototype._generateRenameOrMoveHeadline=function(e,t){var i=s.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?f.format(i.RenameOrMoveYou,y,_,v,t,_):f.format(i.RenameOrMove,y,e.editor.name,_,v,t,_):f.format(i.RenameOrMoveNoEditors,v,t,_)};e.prototype._generateRestoreHeadline=function(e,t){var i=u.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?f.format(i.RestoreYou,y,_,v,t,_):f.format(i.Restore,y,e.editor.name,_,v,t,_):f.format(i.RestoreNoEditors,v,t,_)};e.prototype._generateShareHeadline=function(e,t){return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._generateYouSharedWith(e.sharedWith,t):this._generateSharedWith(e.editor,e.sharedWith,t):this._generateNoEditorSharedWith(e.editor,e.sharedWith,t)};e.prototype._generateNoEditorSharedWith=function(e,t,i){var r=p.strings,o=null;switch(t.length){case 0:o=this._isListItem?r.ListItemShareNoEditors:f.format(r.ShareNoEditors,v,i,_);break;case 1:o=this._isListItem?f.format(r.ListItemShareWithNoEditorsOnePerson,t[0].name):f.format(r.ShareWithNoEditorsOnePerson,v,i,_,t[0].name);break;case 2:o=this._isListItem?f.format(r.ListItemShareWithNoEditorsTwoPersons,t[0].name,t[1].name):f.format(r.ShareWithNoEditorsTwoPersons,v,i,_,t[0].name,t[1].name);break;default:if(this._isListItem){var n=f.getLocalizedCountValue(r.ListItemShareWithNoEditorsMultiplePersons,r.ShareWithNoEditorsMultiplePersonsIntervals,t.length-2);o=f.format(n,t[0].name,t[1].name,String(t.length-2))}else{n=f.getLocalizedCountValue(r.ShareWithNoEditorsMultiplePersons,r.ShareWithNoEditorsMultiplePersonsIntervals,t.length-2);o=f.format(n,v,i,_,t[0].name,t[1].name,String(t.length-2))}}return o};e.prototype._generateSharedWith=function(e,t,i){var r=p.strings,o=null;if(t)switch(t.length){case 0:o=this._isListItem?f.format(r.ListItemShareWithNoPersons,y,e.name,_):f.format(r.ShareWithNoPersons,y,e.name,_,v,i,_);break;case 1:o=this._isListItem?f.format(r.ListItemShareWithOnePerson,y,e.name,_,t[0].name):f.format(r.ShareWithOnePerson,y,e.name,_,v,i,_,t[0].name);break;case 2:o=this._isListItem?f.format(r.ListItemShareWithTwoPersons,y,e.name,_,t[0].name,t[1].name):f.format(r.ShareWithTwoPersons,y,e.name,_,v,i,_,t[0].name,t[1].name);break;default:if(this._isListItem){var n=f.getLocalizedCountValue(r.ListItemShareWithMultiplePersons,r.ShareWithMultiplePersonsIntervals,t.length-2);o=f.format(n,y,e.name,_,t[0].name,t[1].name,String(t.length-2))}else{n=f.getLocalizedCountValue(r.ShareWithMultiplePersons,r.ShareWithMultiplePersonsIntervals,t.length-2);o=f.format(n,y,e.name,_,v,i,_,t[0].name,t[1].name,String(t.length-2))}}else o=f.format(r.ShareWithNoPersons,y,e.name,_,v,i,_);return o};e.prototype._generateYouSharedWith=function(e,t){var i=p.strings,r=null;if(e)switch(e.length){case 0:r=this._isListItem?f.format(i.ListItemShareWithNoPersonsYou,y,_):f.format(i.ShareWithNoPersonsYou,y,_,v,t,_);break;case 1:r=this._isListItem?f.format(i.ListItemShareWithOnePersonYou,y,_,e[0].name):f.format(i.ShareWithOnePersonYou,y,_,v,t,_,e[0].name);break;case 2:r=this._isListItem?f.format(i.ListItemShareWithTwoPersonsYou,y,_,e[0].name,e[1].name):f.format(i.ShareWithTwoPersonsYou,y,_,v,t,_,e[0].name,e[1].name);break;default:if(this._isListItem){var o=f.getLocalizedCountValue(i.ListItemShareWithMultiplePersonsYou,i.ShareWithMultiplePersonsYouIntervals,e.length-2);r=f.format(o,y,_,e[0].name,e[1].name,String(e.length-2))}else{o=f.getLocalizedCountValue(i.ShareWithMultiplePersonsYou,i.ShareWithMultiplePersonsYouIntervals,e.length-2);r=f.format(o,y,_,v,t,_,e[0].name,e[1].name,String(e.length-2))}}else r=this._isListItem?f.format(i.ListItemShareWithNoPersonsYou,y,_):f.format(i.ShareWithNoPersonsYou,y,_,v,t,_);return r};e.prototype._generateAggregateHeadline=function(e){var t=null,i=e.editors,r=d.strings;if(3===e.itemActivityChangeType&&r)if(this._didYouEdit(e.editors))t=this._generateAggregateHeadlineYou(e);else switch(i.length){case 0:t=f.format(r.AggregateNoEditors);break;case 1:t=f.format(r.AggregateOneEditor,y,i[0].name,_);break;case 2:t=f.format(r.AggregateTwoEditors,y,i[0].name,_,y,i[1].name,_);break;default:var o=f.getLocalizedCountValue(r.AggregateMultipleEditors,r.AggregateMultipleEditorsIntervals,i.length-2);t=f.format(o,y,i[0].name,i[1].name,_,String(i.length-2))}else t=l.strings.DataFetchError;return t};e.prototype._generateAggregateHeadlineYou=function(e){var t,i,r=this,o=d.strings,n=null,a=e.editors;a.some(function(e){if(e.email===r._userLoginName){t=e;return!0}});if(-1<(i=a.indexOf(t))){a.splice(i,1);a.unshift(t)}if(3===e.itemActivityChangeType&&o)switch(a.length){case 1:n=f.format(o.AggregateEditYou,y,_);break;case 2:n=f.format(o.AggregateTwoEditorsYou,y,_,y,a[1].name,_);break;default:var s=f.getLocalizedCountValue(o.AggregateMultipleEditorsYou,o.AggregateMultipleEditorsYouIntervals,a.length-2);n=f.format(s,y,a[1].name,_,String(a.length-2))}else n=l.strings.DataFetchError;return n};e.prototype._getEllipsisText=function(e,t,i){return!e.navigateToOptions||i?'<span class="od-ItemActivityTile-ellipsis" title="'+t+'">'+t+"</span>":'<a class="od-ItemActivityTile-ellipsis" title="'+t+'" data-bind="event: { click: function(obj, ev) { return $data.onClick($data.tile, ev); } }">'+t+"</a>"};e.prototype._didYouEdit=function(e){var t=this;return e.some(function(e){return e.email===t._userLoginName})};e.dependencies={identityDataSource:i.identity};return e}();t.default=b;t.resourceKey=g.createResolvedResourceKey(e("module").id,b)});define("P2",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.process=function(e){for(var t=new Array,i=0;i<e.length;i++)this._addActivity(e[i],t);var r=t.length;if(!(0===r)){var o=t[r-1];if(1===o.type){var n=o;1<n.activities.length?this._sort(n.activities):this._downgrade(n.activities,t)}}return t};e._addActivity=function(e,t){var i=t.length,r=0===i,o=!1,n=null;if(!r&&(o=(n=t[i-1]).itemActivityChangeType!==e.itemActivityChangeType||n.date.toDateString()!==e.date.toDateString())&&1===n.type){var a=n;1<a.activities.length?this._sort(a.activities):this._downgrade(a.activities,t)}if(3!==e.itemActivityChangeType)t.push(e);else if(r||o){var s=this._create(e);t.push(s)}else this._update(n,e)};e._downgrade=function(e,t){if(1===e.length){t.pop();t.push(e[0])}};e._sort=function(e){e.sort(function(e,t){return e.date.getTime()<t.date.getTime()?1:e.date.getTime()>t.date.getTime()?-1:e.changeToken.localeCompare(t.changeToken)})};e._create=function(e){var t=new Array;e.editor.name&&t.push(e.editor);var i=new Array;i.push(e);return{activities:i,date:e.date,relativeTime:e.relativeTime,editors:t,itemActivityChangeType:e.itemActivityChangeType,type:1}};e._update=function(e,r){e.editors.some(function(e){var t=!0;for(var i in r.editor)t=t&&r.editor[i]===e[i];return t})||e.editors.push(r.editor);e.itemActivityChangeType=r.itemActivityChangeType;e.activities.push(r)};return e}();t.default=i});define("OR",["require","exports","aq","cJ"],function(e,t,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.init=function(e,t,i,r,o){var n=t(),a={Enter:function(e){n(!n());return!1}},s=new d.default({element:e,bindingContext:o,allBindingsAccessor:i,valueAccessor:function(){return a}});l.applyBindingsToNode(e,s,o);l.applyBindingsToNode(e,{click:function(){return n(!n())}},o)};return e}();t.default=i});define("Pa",["require","exports","ap","bN"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this,i=e.shouldStartExpanded,r=void 0===i||i;t._shouldStartExpanded=r;t.showArrow=!1;t.isExpanded=t._getIsExpanded();return t}e.prototype._getIsExpanded=function(){var t=this,i=this.createObservable(this._shouldStartExpanded);return this.createComputed({read:function(){return!t.showArrow||i()},write:function(e){t.showArrow&&i(e)},pure:!0})};return e}(r.default);t.default=o});define("P0",[],function(){return'<div class="InfoPane-section InfoPaneSection--activitiesfeed" data-bind="keyboard: keyNav.keyboardOptions, css: { \'is-expanded\': sectionHelper.isExpanded, \'no-arrow\': !sectionHelper.showArrow }, selection: { data: keyNav.focusableTiles, mode: \'single\', direction: \'vertical\', focused: keyNav.focusedItem }"><div class=InfoPane-sectionHeader id=od-ActivitiesFeed-sectionHeader data-bind="hasFocus: keyNav.sectionHeaderFocus, toggle: sectionHelper.isExpanded, attr: { \'aria-expanded\': sectionHelper.isExpanded(), tabindex: sectionHelper.showArrow ? 0 : -1, role: sectionHelper.showArrow ? \'button\' : \'\' }">\x3c!--ko if: sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e<h2 class=InfoPane-sectionHeaderText data-bind="text: resxStrings.ActivitiesHeader"></h2></div><div class=InfoPane-sectionContent role=tree data-bind="foreach: { data: tileCollections }"><div class="od-ActivitiesFeed-listTitle ms-font-s ms-fontColor-neutralSecondaryAlt ms-fontWeight-semibold" data-bind="text: title"></div><div class=od-ActivitiesFeed-list data-bind="foreach: { data: tiles }"><ms-item-activity-tile params="activity: $data"></ms-item-activity-tile></div></div><div class=InfoPane-sectionContent>\x3c!--ko if: isLoading()--\x3e<div class=od-ActivitiesFeed-loadingSpinnerFlat data-bind="component: {name: loadingSpinnerFlatTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if: !isLoading()--\x3e\x3c!--ko if: errorMessage()--\x3e<span class=ms-fontColor-error data-bind="text: errorMessage"></span>\x3c!--/ko--\x3e\x3c!--ko if: !errorMessage && !hasChanges()--\x3e<span class=ms-font-s data-bind="text: resxStrings.NoChange"></span>\x3c!--/ko--\x3e\x3c!--ko if: showForEarlierChangesMsg()--\x3e<span class="od-ActivitiesFeed-sectionForEarlierChanges ms-font-s" data-bind="bindableHtml: forEarlierChangesMsg, click: onFileVersionClick, clickBubble: false"></span>\x3c!--/ko--\x3e\x3c!--ko if: showSeeMore()--\x3e<a data-bind="click: onSeeMore, clickBubble: false, text: seeMoreText" href=#></a>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>'});define("PZ",["c","az"],function(e,t){e.loadStyles([{rawString:".od-ActivitiesFeed-sectionForEarlierChanges{margin-top:15px}"}])});define("PU",["require","exports","PX","b5","PW","PV"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-item-activity-tile",template:e("PW"),viewModel:i.default,synchronous:!0});t.default=o});define("PX",["require","exports","ap","aq","bF","qH","PY","ON","V","OR","s6","aI","dc","by"],function(e,t,i,o,r,n,a,s,l,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.addBindingHandlers({bindableHtml:n.default,scrollIntoView:s.default,toggle:d.default});t._navigation=t.resources.consume(p.navigation);t._platform=t.resources.consume(m.platformDetection);t.tile=e.activity;t._initObservables();t.accessibleLabel=t.createComputed(t._computeAccessibleLabel);t.expanded=o.observable(!1);t.isAggregate=!1;if(1===t.tile.type){t.isAggregate=!0;var i=t.tile;t.activities=i.activities}return t}e.prototype.onClick=function(e,t){if(e.navigateToOptions){this._navigation.navigateTo(e.navigateToOptions);var i={url:e.navigateToOptions.url,qosEventName:"RecentActivityItemLink",timeout:this._platform.isMobile?7e3:3e3};this._validateLink(i)}};e.prototype._validateLink=function(t){try{var i=new u.Qos({name:"NavigationLinkValidation"}),r=new XMLHttpRequest;r.open("GET",t.url,!0);t.timeout&&(r.timeout=t.timeout);r.onload=function(e){if(200<=r.status&&r.status<400){t.onComplete&&t.onComplete(r.status);i.end({resultType:u.ResultTypeEnum.Success,extraData:{source:t.qosEventName,httpCode:r.status}})}else{t.onError&&t.onError(r.status);i.end({resultCode:"LinkDoesNotExist",resultType:u.ResultTypeEnum.Failure,extraData:{source:t.qosEventName,httpCode:r.status}})}};r.ontimeout=function(e){t.onTimeout&&t.onTimeout();i.end({resultCode:"ValidationTimedOut",resultType:u.ResultTypeEnum.Failure,extraData:{source:t.qosEventName}})};r.send()}catch(e){t.onFailValidation&&t.onFailValidation();i.end({resultCode:"FailedToValidate",resultType:u.ResultTypeEnum.Failure,extraData:{source:t.qosEventName}})}};e.prototype._initObservables=function(){var t=this;if(1===this.tile.type){var e=this.tile;this.addDisposable(e.expanded.subscribe(function(e){t.expanded(e)}))}};e.prototype._computeAccessibleLabel=function(){var e,t=c.renderText(this,this.tile.headline),i=a.strings;0===this.tile.index?0===this.tile.type?e=i.FirstActivityAccessibleLabel:1===this.tile.type&&(e=i.FirstAggregateAccessibleLabel):e=1===this.tile.type?i.AggregateAccessibleLabel:i.ActivityAccessibleLabel;return l.format(e,t,this.tile.date)};return e}(r.default);t.default=h});define("ON",["require","exports","ap","bH","aq","cU"],function(e,t,i,r,m,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){i.__extends(e,t);function e(e){var c=t.call(this,e)||this,u=n.getScrollContainer(c.element),p=c.element;c.createBackgroundComputed(function(){var e=m.unwrap(c.valueAccessor());if(e.isSelected()){var t=e.top,i=e.containerToTop,r=e.smooth,o=u.scrollTop,n=o+u.offsetHeight,a=u.scrollHeight-u.clientHeight,s=p.offsetTop,l=s+p.offsetHeight,d=o;i?d=0:s<o||t?d=s:n<l&&(d=l-u.offsetHeight);if((d=Math.min(d,a))===o)return;r?c.smoothScroll(u,d,o):u.scrollTop=d}});return c}e.prototype.smoothScroll=function(e,t,i,r){var o=this;void 0===r&&(r=0);if(!(100<r)){var n=1*r/100,a=0;a=n<=.5?2*n*n:1-2*(n=1-n)*n;e.scrollTop=i+a*(t-i);this.async.setTimeout(function(){o.smoothScroll(e,t,i,r+1)},5)}};return e}(r.default);t.default=o;t.viewElementInScrollContainer=function(e,t){var i=e.offsetParent;if(i){for(var r=n.getScrollContainer(e),o=e.offsetTop+e.clientTop;r!==i;){o+=i.offsetTop;if(!(i=i.offsetParent))return}i.scrollTop=o+t}}});define("PW",[],function(){return'<div class=od-ItemActivityTile-section data-bind="css: { \'is-expanded\': expanded }, scrollIntoView: { isSelected: tile.focused || expanded }"><div class="od-ItemActivityTile-sectionHeader ms-font-s" role=treeitem data-bind="attr: { \'aria-label\': accessibleLabel, \'aria-expanded\': expanded, tabindex: tile.index === 0 ? 0 : -1 }, css: { \'od-ItemActivityTile-sectionToggle\': isAggregate, \'od-ItemActivityTile-sectionFocused\': tile.focused }, hasFocus: tile.focused, toggle: expanded">\x3c!--ko if: isAggregate--\x3e<i class="od-ItemActivityTile-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e<div class=od-ItemActivityTile-entity data-bind="component: { name: \'od-persona\', params: { person: tile.editor, personaSize: $component.personaSize, showPresence: false } }, attr: { \'aria-hidden\': true }"></div><div class=od-ItemActivityTile-details><span data-bind="bindableHtml: tile.headline" class=od-ItemActivityTile-headline></span> <span data-bind="text: tile.date" class="od-ItemActivityTile-date ms-fontColor-neutralSecondary"></span></div></div>\x3c!--ko if: isAggregate--\x3e<div data-bind="foreach: { data: activities, as: \'activity\' }" role=group><div class=od-ItemActivityTile-sectionContent data-bind="css: {\'od-ItemActivityTile-sectionFocused\': activity.focused }"><ms-item-activity-tile params="activity: activity"></ms-item-activity-tile></div></div>\x3c!--/ko--\x3e</div>'});define("PV",["c","az"],function(e,t){e.loadStyles([{rawString:"[dir=ltr] .od-ItemActivityTile-section{padding-right:10px}[dir=rtl] .od-ItemActivityTile-section{padding-left:10px}html[dir=ltr] .od-ItemActivityTile-identity{float:left}html[dir=rtl] .od-ItemActivityTile-identity{float:right}[dir=ltr] .od-ItemActivityTile-identity{margin-right:5px}[dir=rtl] .od-ItemActivityTile-identity{margin-left:5px}.od-ItemActivityTile-sectionExpandButton{font-size:17px;position:absolute;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";width:32px;height:32px;line-height:32px;text-align:center;transition:transform 167ms cubic-bezier(.1,.9,.2,1)}[dir=ltr] .od-ItemActivityTile-sectionExpandButton{right:0}[dir=rtl] .od-ItemActivityTile-sectionExpandButton{left:0}.od-ItemActivityTile-section.is-expanded .od-ItemActivityTile-sectionExpandButton{-ms-transform:rotate(-180deg);transform:rotate(-180deg)}.od-ItemActivityTile-section .od-ItemActivityTile-sectionContent{display:none}.od-ItemActivityTile-section.is-expanded .od-ItemActivityTile-sectionContent{display:block}.od-ItemActivityTile-sectionHeader{padding:15px 0;min-height:40px}.od-ItemActivityTile-sectionContent{font-size:12px;min-height:40px}[dir=ltr] .od-ItemActivityTile-sectionContent{padding-left:25px}[dir=rtl] .od-ItemActivityTile-sectionContent{padding-right:25px}.od-ItemActivityTile-sectionToggle{cursor:pointer}.od-ItemActivityTile-sectionFocused{background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-ItemActivityTile-details{display:table}.od-ItemActivityTile-date{display:block}.odItemActivityTile-headline{display:block}.od-ItemActivityTile-entity{font-size:12px}html[dir=ltr] .od-ItemActivityTile-entity{float:left}html[dir=rtl] .od-ItemActivityTile-entity{float:right}.od-ItemActivityTile-entity .od-Persona{overflow:hidden;display:inline-block}.od-ItemActivityTile-entity .od-Persona.od-Persona--lg .od-Persona-image{width:40px;height:40px;line-height:40px}.od-ItemActivityTile-entity .od-Persona-details{display:none}.od-ItemActivityTile-ellipsisWrapper{white-space:nowrap}.od-ItemActivityTile-ellipsis{white-space:nowrap;max-width:130px;overflow:hidden;text-overflow:ellipsis;display:inline-block;vertical-align:text-bottom}.od-ItemActivityTile-ellipsis:hover{cursor:pointer}"}])});define("N3",["require","exports","ap","at","b3","N5","bD","N4"],function(e,t,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._scope=new s.default;t._sectionParams={item:t.props.item};return t}e.prototype.componentWillReceiveProps=function(e){e.item!==this.props.item&&(this._sectionParams={item:e.item})};e.prototype.shouldComponentUpdate=function(e){return e.sectionControlKey!==this.props.sectionControlKey||e.resources!==this.props.resources||e.item!==this.props.item};e.prototype.componentWillUnmount=function(){this._scope.dispose()};e.prototype.render=function(){var e=this.props,t=e.sectionControlKey,i=e.resources,r=n.toSpecification(t,this._sectionParams);return o.createElement("div",{className:"od-DetailsPane-LegacySection"},o.createElement(a.default,{specification:r,resources:i}))};return e}(o.Component);t.default=i});define("N5",["require","exports","ap","at","b3","aq"],function(e,t,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={specificationObservable:a.observable(t.props.specification)};return t}e.prototype.componentWillReceiveProps=function(e){e.specification!==this.props.specification&&this.state.specificationObservable(e.specification)};e.prototype.componentDidMount=function(){var e=this,t=this._getBindingContext();this._binding=new(this.props.resources.resolved(n.default))({element:this._knockoutHost,valueAccessor:function(){return{specification:e.state.specificationObservable,placeholder:e.props.placeholder}},bindingContext:t})};e.prototype.componentWillUnmount=function(){this._binding.dispose()};e.prototype.render=function(){var t=this;return o.createElement("div",{ref:function(e){t._knockoutHost=e}})};e.prototype._getBindingContext=function(){var e=document.createElement("div");a.applyBindings({},e);var t=a.contextFor(e);a.removeNode(e);return t};return e}(o.Component);t.default=i});define("N4",["c","az"],function(e,t){e.loadStyles([{rawString:".od-DetailsPane-LegacySection .InfoPane-section{padding:12px 16px;margin:12px 0;width:auto;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:'}.od-DetailsPane-LegacySection .InfoPane-sectionHeader{position:relative}.od-DetailsPane-LegacySection .InfoPane-sectionHeaderText{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}.od-DetailsPane-LegacySection .od-SharingSection-PermissionsPile{padding:12px 16px;margin:12px 0;width:auto}.od-DetailsPane-LegacySection .InfoPaneSection--properties{width:auto}.od-DetailsPane-LegacySection .InfoPane-sectionContent .od-ClientFormFields-field{padding:0;margin:12px 0}.od-DetailsPane-LegacySection .InfoPaneSection--activitiesfeed .InfoPane-sectionContent{margin-top:12px}.od-DetailsPane-LegacySection .InfoPaneSection--shortcutInformation{font-size:12px}.od-DetailsPane-LegacySection .InfoPaneSection--shortcutInformation .InfoPane-sectionHeader{display:none}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section{padding:0}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section .od-PolicyTipMessageBar{padding:12px 16px}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section .InfoPane-sectionContent{padding:12px 16px}'}])});define("PE",["require","exports","ap","at","PF","N3"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,i=e.resources;return r.createElement(n.default,{sectionControlKey:o.resourceKey,item:t,resources:i})};return t}(r.Component);t.default=a});define("PF",["require","exports","PL","b5","b3","PK","PJ","PI","PH","PG"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-information-info-pane-section",template:e("PH"),viewModel:i.default,synchronous:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"ms-information-info-pane-section",name:e("module").id,template:e("PH"),viewModelType:i.default});r.registerTemplate("ms-information-basicentry",e("PK"));r.registerTemplate("ms-information-editableentry",e("PJ"));r.registerTemplate("ms-information-iterableentry",e("PI"));t.default=n});define("PL",["require","exports","ap","bF","OR","sX","PN","eA","eO","PM","V","dH","hO","KG","LY","hs","cY","dZ","Pa","dj"],function(e,t,i,r,d,o,c,u,n,a,s,p,m,h,f,g,y,v,_,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function x(e){var t=e.condition,i=e.value;return t?t():i()&&0<i().length}var S=o.strings,l=function(l){i.__extends(e,l);function e(e,t){void 0===t&&(t={});var i=l.call(this,e,t)||this,r=i._changeFolderTypeAction=new(i.managed(c.default))({}),o=i.resources;i._urlDataSource=o.consume(v.url);i._itemParentHelper=o.consume(u.resourceKey);i._fileHandlerProvider=o.consume(b.resourceKey.local);i._item=e.item;var n=i.observables;i._isCustomList=n.pureCompute(i._computeIsCustomList);i.strings=S;i.sectionHelper=new(i.managed(_.default));i.addBindingHandlers({toggle:d.default});i._audio=n.pureCompute(i._computeAudio);var a=o.consume(v.identity).getIdentity().type===y.IdentityType.anonymous?n.create():n.pureCompute(i._computePath),s=n.createArray([{title:S.informationFiletype,value:n.pureCompute(i._computeFileType)},{title:S.informationFolderType,condition:n.pureCompute(i._computeIsFolderTypeVisible),value:n.pureCompute(i._computeFolderType),className:"InfoPaneSection-information-folderType",editClassName:"InfoPaneSection-information-changeFolderType",onEdit:function(e){r.execute(e);return!1},editText:S.informationFolderTypeChange},{title:S.informationVisitorViews,value:n.pureCompute(i._computeVisitorViews)},{title:S.informationDateTaken,value:n.pureCompute(i._computeDateTaken)},{title:S.informationDimensions,value:n.pureCompute(i._computeDimensions)},{title:S.informationDuration,value:n.pureCompute(i._computeDuration)},{title:S.informationBitrate,value:n.pureCompute(i._computeBitRate)},{title:S.informationCamera,value:n.pureCompute(i._computeCamera)},{title:S.informationShot,value:n.pureCompute(i._computeShot)},{title:S.informationTitle,value:n.pureCompute(i._computeTitle)},{title:S.informationAlbum,value:n.pureCompute(i._computeAlbum)},{title:S.informationAlbumArtist,value:n.pureCompute(i._computeAlbumArtist)},{title:S.informationArtist,value:n.pureCompute(i._computeArtist)},{title:S.informationTrack,value:n.pureCompute(i._computeTrack)},{title:S.informationDisc,value:n.pureCompute(i._computeDisc)},{title:S.informationComposers,value:n.pureCompute(i._computeComposers)},{title:S.informationGenre,value:n.pureCompute(i._computeGenre)},{title:S.informationYear,value:n.pureCompute(i._computeYear)},{title:S.informationCopyright,value:n.pureCompute(i._computeCopyright)},{title:S.informationLocations,value:n.pureCompute(i._computeLocations)},{title:S.informationModified,value:n.pureCompute(i._computeModified)},{title:S.informationDeleted,value:n.pureCompute(i._computeDeleted)},{title:S.informationAddedBy,value:n.pureCompute(i._computeAddedBy)},{title:S.informationDateCreated,value:n.pureCompute(i._computeCreated)},{title:S.informationDateShared,value:n.pureCompute(i._computeDateShared)},{title:S.informationPath,value:a,className:"InfoPaneSection-information-path"},{title:S.informationOriginalLocation,value:n.pureCompute(i._computeOriginalLocation)},{title:S.informationSize,value:n.pureCompute(i._computeSize)},{title:S.informationPanoramaResolution,value:n.pureCompute(i._computePanoramaResolution)},{title:S.informationPanoramaRange,value:n.pureCompute(i._computePanoramaRange)}]);i.entries=i.addDisposable(s.filter(x));return i}e.prototype.getEntryType=function(e){return e.editText?"ms-information-editableentry":Array.isArray(e.value())?"ms-information-iterableentry":"ms-information-basicentry"};e.prototype._computeAudio=function(){return this._item().audio};e.prototype._computeTitle=function(){var e=this._audio();return e&&e.title};e.prototype._computeAlbum=function(){var e=this._audio();return e&&(e.album||S.informationUnknownAlbum)};e.prototype._computeAlbumArtist=function(){var e=this._audio();return e&&e.albumArtist};e.prototype._computeArtist=function(){var e=this._audio();return e&&(e.artist||S.informationUnknownArtist)};e.prototype._computeTrack=function(){var e=this._audio(),t=e&&e.track,i=e&&e.trackCount;return t?i?s.format(S.informationTrackAndDiscFormat,t,i):""+t:""};e.prototype._computeDisc=function(){var e=this._audio(),t=e&&e.disc,i=e&&e.discCount;if(e&&(1<t||1<i))return t<=i?s.format(S.informationTrackAndDiscFormat,t,i):t&&""+t};e.prototype._computeComposers=function(){var e=this._audio();return e&&e.composers};e.prototype._computeGenre=function(){var e=this._audio();return e&&e.genre};e.prototype._computeYear=function(){var e=this._audio();return e&&e.year&&""+e.year};e.prototype._computeCopyright=function(){var e=this._audio();return e&&e.copyright};e.prototype._computeFileType=function(){var e=this._item();if(!e.isBundle&&void 0===e.virtualItemType){var t=this._fileHandlerProvider,i=e.extension,r=t&&i&&t.getFileTypeName(i);return f.getFriendlyItemType(e,this._isCustomList(),r)}};e.prototype._computeIsFolderTypeVisible=function(){var e=this._item();return e.type===n.default.Folder&&!e.isBundle&&!e.isSpecialFolder&&void 0===e.virtualItemType&&this._changeFolderTypeAction.isAvailable()};e.prototype._computeDateTaken=function(){var e=this._item(),t=(e.photo||e.video)&&e;return t?t.dateTakenTime?g.getFullDisplayDate(t.dateTakenTime,!0):t.dateTaken:""};e.prototype._computeFolderType=function(){switch(this._item().category){case a.default.documents:return S.informationFolderTypeDocuments;case a.default.photos:return S.informationFolderTypePhotos;case a.default.favorites:return S.informationFolderTypeFavorites}return""};e.prototype._computeVisitorViews=function(){var e=this._item().statistics.views;return e&&""+e};e.prototype._computeDimensions=function(){var e=this._item(),t=e.video||!e.panorama&&e.photo||{},i=t.width,r=t.height;return i&&r?s.format(S.informationDimensionsFormat,i,r):""};e.prototype._computeDuration=function(){var e=this._item().video,t=e&&e.duration;return 0<t?h.formatTime(t):""};e.prototype._computeBitRate=function(){var e=this._item().video,t=e&&e.bitrate;if(t){var i=1e6<t?"Mega":"Kilo",r=1e6<t?1e6:1e3;return s.format(S["information"+i+"BitrateFormat"],Math.floor(t/r))}};e.prototype._computeCamera=function(){var e=this._item(),t=e.photo,i=e.video;return t&&t.cameraModel||i&&i.cameraModel};e.prototype._computeShot=function(){var e=this._item().photo;if(e){var t=e.exposureNumerator,i=e.exposureDenominator,r=t&&""+t;i&&1!==i&&(r=s.format(S.informationShotExposureFormat,t,i));var o=e.focalRatio?""+e.focalRatio:"";o=o&&s.format(S.informationShotFStopFormat,o);var n=e.focalLength?""+e.focalLength:"";return[r,o,n=n&&s.format(S.informationShotFocalLengthFormat,n)].join(" ").trim()}};e.prototype._computeLocations=function(){var e=this._item().locations;if(e){for(var t=[],i=0,r=e;i<r.length;i++){var o=r[i];o&&t.push(o)}return t}};e.prototype._computeModified=function(){var e=this._item();if(!this._urlDataSource.isRecycleBin(e.queryType))return e.dateModifiedTime?g.getFullDisplayDate(e.dateModifiedTime):e.dateModified};e.prototype._computeDeleted=function(){var e=this._item();if(this._urlDataSource.isRecycleBin(e.queryType))return e.dateDeletedTime?g.getFullDisplayDate(e.dateDeletedTime):e.dateDeleted};e.prototype._computeAddedBy=function(){return this._item().creatorName};e.prototype._computeCreated=function(){var e=this._item();return e.dateCreatedTime?g.getFullDisplayDate(e.dateCreatedTime):e.dateCreated};e.prototype._computeDateShared=function(){var e=this._item();return e.dateSharedTime?g.getFullDisplayDate(e.dateSharedTime):e.dateShared};e.prototype._computePath=function(){var e=this._item();if(!e.audio&&e.parent&&!this._urlDataSource.isRecycleBin(e.queryType)){for(var t=[],i=e;i;i=i.parent)t.unshift(i.name);return t}};e.prototype._computeOriginalLocation=function(){var e=this._item();if(this._urlDataSource.isRecycleBin(e.queryType)||e.queryType===p.default.Search||e.queryType===p.default.SharedWithMe)return e.location};e.prototype._computeSize=function(){var e=this._item();return e.size&&m.default.getDisplayString(e.size,{ignoreZero:!0})};e.prototype._computePanoramaResolution=function(){var e=this._item().panorama,t=e&&e.resolution;if(t)return s.format(S.informationPanoramaResolutionFormat,t)};e.prototype._computePanoramaRange=function(){var e=this._item().panorama||{},t=e.horizontalFov,i=e.verticalFov;if(t&&i)return s.format(S.informationPanoramaRangeFormat,Math.round(t),Math.round(i))};e.prototype._computeIsCustomList=function(){var e=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._item(),"list"));return!!e&&!e.list.isDocumentLibrary};e.dependencies=i.__assign({},r.default.dependencies);return e}(r.default);t.default=l});define("PN",["require","exports","ap","kz","aC","aI","sX","PO","c0","dZ","dI","eX","ci"],function(e,t,r,i,s,l,d,c,o,n,u,a,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="ChangeFolderType";t.isSingleSelectAction=!0;t.canFallbackToParent=!0;t._identityDataSource=t.resources.consume(n.identity);t._itemProvider=t.resources.consume(a.resourceKey);t._urlDataSource=t.resources.consume(n.url);return t}e.prototype.onSelectionExecute=function(e,t,i){var r=this,o=e[0],n=o.category,a=this.observables.create(n);return this.resources.consume(p.resourceKey).requestDialog({title:d.strings.informationChangeFolderTitle,component:{name:c.default.tagName,params:{category:a}},actions:[{name:d.strings.informationSave,execute:function(){return s.default.wrap(2)},isAvailable:this.createComputed(function(){return o.category!==a()}),isDefault:!0,icon:new u.default("Save"),automationId:"changeFolderTypeSave"}]}).wait().then(function(){return r._itemProvider.changeFolderType({category:a(),item:o}).then(function(){return{resultType:l.ResultTypeEnum.Success}})})};e.prototype.onSelectionIsAvailable=function(e,t){var i=this._identityDataSource.getIdentity();return i&&i.type!==o.IdentityType.anonymous&&void 0!==t.category&&!this._urlDataSource.isRecycleBin(t.queryType)};return e}(i.default);t.default=m});define("PO",["require","exports","PR","b5","PQ","PP"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-folder-type-editor",template:e("PQ"),viewModel:i.default,synchronous:!0});t.default=o});define("PR",["require","exports","ap","bF","sX","PM","aq"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.infoPaneResx=o;t.category=e.category;t.typeDocuments=n.default[n.default.documents];t.typePhotos=n.default[n.default.photos];t.categoryText=a.observable(n.default[t.category()]);t.subscribe(t.categoryText,function(){t.category(n.default[t.categoryText()])});return t}return e}(i.default);t.default=s});define("PM",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.documents=0]="documents";e[e.photos=1]="photos";e[e.favorites=2]="favorites"}(i||(i={}));t.default=i});define("PQ",[],function(){return'<div class=FolderTypeEditor><div class=FolderTypeEditor-option><div class=ms-RadioButton><input class=ms-RadioButton-input type=radio name=folderType id=folderTypeDocuments data-bind="attr: { value: typeDocuments }, checked: categoryText"> <label for=folderTypeDocuments class=ms-RadioButton-field><span class=ms-Label data-bind="text: infoPaneResx.strings.informationFolderTypeDocuments"></span></label></div></div><div class=FolderTypeEditor-option><div class=ms-RadioButton><input type=radio name=folderType id=folderTypePhotos value=photos data-bind="attr: { value: typePhotos }, checked: categoryText" class=ms-RadioButton-input> <label for=folderTypePhotos class=ms-RadioButton-field><span class=ms-Label data-bind="text: infoPaneResx.strings.informationFolderTypePhotos"></span></label></div></div></div>'});define("PP",["c","az"],function(e,t){e.loadStyles([{rawString:".FolderTypeEditor-option+.FolderTypeEditor-option{margin-top:10px}"}])});define("PK",[],function(){return'<dt data-bind="text: title"></dt><dd data-bind="class: $data.className, text: value"></dd>'});define("PJ",[],function(){return'<dt data-bind="text: title"></dt><dd><div data-bind="class: $data.className, text: value"></div><a href=javascript:; data-bind="class: $data.editClassName, click: onEdit, text: editText"></a></dd>'});define("PI",[],function(){return'<dt data-bind="text: title"></dt><dd data-bind="foreach: { data: value }"><div data-bind="class: $parent.className, text: $data"></div></dd>'});define("PH",[],function(){return'<div class="InfoPane-section InfoPaneSection--information" data-bind="css: { \'is-expanded\': sectionHelper.isExpanded, \'no-arrow\': !sectionHelper.showArrow }"><div class=InfoPane-sectionHeader data-bind="toggle: sectionHelper.isExpanded, attr: { \'aria-expanded\': sectionHelper.isExpanded(), tabindex: sectionHelper.showArrow ? 0 : -1, role: sectionHelper.showArrow ? \'button\' : \'\' }">\x3c!--ko if: sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e<h2 class=InfoPane-sectionHeaderText data-bind="text: strings.informationHeader"></h2></div><div class=InfoPane-sectionContent><dl class=InfoPaneSection-informationBody data-bind="template: { name: getEntryType, foreach: entries }"></dl></div></div>'});define("PG",["c","az"],function(e,t){e.loadStyles([{rawString:".InfoPaneSection-informationBody{margin:0}.InfoPaneSection-informationBody dt{margin-bottom:3px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px}.InfoPaneSection-informationBody dd{margin:0 0 16px 0;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px}.InfoPaneSection-information-folderType{display:inline}.InfoPaneSection-information-changeFolderType{margin-left:10px;margin-right:10px;text-decoration:none}.InfoPaneSection-information-changeFolderType:visited{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.InfoPaneSection-information-path{display:inline;word-break:break-all}.InfoPaneSection-information-path:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:0 5px;font-size:8px;font-weight:800;content:'\\E76C'}.InfoPaneSection-information-path:last-child:after{content:'';display:none}html[dir=rtl] .InfoPaneSection-information-path:after{content:'\\E76B'}.od-DetailsPane-LegacySection .InfoPaneSection-informationBody dd{margin-bottom:12px}.od-DetailsPane-LegacySection .InfoPaneSection--information .InfoPane-sectionHeader{display:none}"}])});define("Px",["require","exports","ap","at","Pz","N3","Py"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,i=e.resources;return r.createElement("div",{className:"od-DetailsPane-ItemPreviewSection"},r.createElement(n.default,{sectionControlKey:o.resourceKey,item:t,resources:i}))};return t}(r.Component);t.default=a});define("Pz",["require","exports","PC","b5","b3","PB","PA"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-infoPane-preview",template:e("PB"),viewModel:i.default,synchronous:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"od-infoPane-preview",name:e("module").id,template:e("PB"),viewModelType:i.default});t.default=n});define("PC",["require","exports","ap","bF","qS","lA","MD","sB","yR","PD","oq","ba","eO"],function(e,t,i,r,n,a,s,l,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){void 0===t&&(t={});var i=o.call(this,e,t)||this;i._item=e.item;i.addBindingHandlers({clientRect:n.default,react:u.default});var r=i.observables;i.size=r.create();i._thumbnailError=r.create();i._imageSize=r.pureCompute(i._computeImageSize);i._thumbnail=r.pureCompute(i._computeThumbnail);i._rotation=r.pureCompute(i._computeRotation);i._hasThumbnailError=r.pureCompute(i._computeHasThumbnailError);i._isImage=r.pureCompute(i._computeIsImage);i._isFolder=r.pureCompute(i._computeIsFolder);i._iframeUrl=r.pureCompute(i._computeIFrameUrl);i._isIFrame=r.pureCompute(i._computeIsIFrame);i._isItemMalicious=r.pureCompute(i._computeItemMalicious);i.component=r.pureCompute(i._computeComponent);i.analyticsActionBarComponent=c.default;i.analyticsActionBarProps=i.createPureComputed(i._updateAnalyticsActionBarProps);i.enableAnalyticsActionBar=i.createPureComputed(i._computeAnalyticsActionBarAvailable);return i}e.prototype._computeAnalyticsActionBarAvailable=function(){return p.isFeatureEnabled(p.ItemAnalyticsUX)&&this._item().type!==m.default.Folder};e.prototype._updateAnalyticsActionBarProps=function(){return{item:this._item(),resources:this.resources}};e.prototype._computeComponent=function(){if(!this._isItemMalicious()){if(this._isIFrame())return{name:s.default.tagName,params:{title:"",url:this._iframeUrl,isExcludeFromScreenReader:!0}};if(this._isFolder())return{name:d.default.tagName,params:{item:this._item,imageRect:this._imageSize}};if(this._isImage())return{name:l.default.tagName,params:{image:this._thumbnail,rotation:this._rotation,desiredSize:this._imageSize,alignment:["fitWidth","top"],error:this._thumbnailError}}}};e.prototype._computeIsFolder=function(){var e=this._item();return!(!e||!e.folder)};e.prototype._computeIFrameUrl=function(){var e=this._item();return e&&e.previewIFrameUrl};e.prototype._computeIsIFrame=function(){return!!this._iframeUrl()};e.prototype._computeThumbnail=function(){var e=this._item();return e&&(e.orientedThumbnail||e).thumbnail};e.prototype._computeRotation=function(){var e=this._item(),t=e&&e.orientedThumbnail;return t?t.rotation:a.default.none};e.prototype._computeIsImage=function(){return!!this._thumbnail()&&!this._hasThumbnailError()};e.prototype._computeHasThumbnailError=function(){return this._hasThumbnailError.peek()||!!this._thumbnailError()};e.prototype._computeImageSize=function(){var e=this.size();return{width:e&&e.width||319,height:180}};e.prototype._computeItemMalicious=function(){var e=this._item();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};e.dependencies=i.__assign({},r.default.dependencies);return e}(r.default);t.default=o});define("PD",["require","exports","ap","at","aq","jP","M9","M8","bX","iE","dZ","ep","cE","rZ","n7"],function(e,t,r,a,o,n,s,l,d,c,u,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.resources=e.resources;t.state={fileHoverCardStore:t.resources.consume(l.resourceKey.optional),graphDataSource:t.resources.consume(u.graph.optional)};t.actionMap=t.resources.consume(d.actionMap);t._pageContext=t.resources.consume(c.pageContext);t._engagement=t.resources.consume(m.resourceKey);return t}e.prototype.componentDidMount=function(){var t=this;this.resources.consumeAsync(l.resourceKey).then(function(e){t.setState({fileHoverCardStore:e})});this.resources.consumeAsync(u.graph).then(function(e){t.setState({graphDataSource:e})})};e.prototype.render=function(){var e=this.state,t=e.fileHoverCardStore,i=e.graphDataSource,r=f.getGraphItemUrl(i,this.props.item),o=Number(this._pageContext.webTemplate)===p.default.mySite,n={itemId:this.props.item.itemId,graph:this.props.item.graph,extension:this.props.item.extension,graphItemUrl:r,getAccessToken:this.getAccessToken};return s.isSupported(n.extension)&&a.createElement("div",{className:"AnalyticsActionBarField"},t&&i&&f.shouldEnableFileHoverCard(this.props.item,this.resources)&&a.createElement(g,{item:n,fileHoverCardStore:t,onView:this.onView,actionBarItems:[],showViewers:o}))};e.prototype.getAccessToken=function(){return f.getGraphAccessToken(this.state.graphDataSource,this.props.item)};e.prototype.onView=function(e){this._engagement.logData({name:"DetailsPane.AnalyticsActionBar.ViewClick"});new(this.resources.injected(this.actionMap.ShowItemAnalyticsAction))({item:o.observable(this.props.item)}).execute(e)};e.prototype.onShare=function(e){this._engagement.logData({name:"DetailsPane.AnalyticsActionBar.ShareClick"});new(this.resources.injected(this.actionMap.SelectAction))({item:o.observable(this.props.item),showProperties:!1}).execute(e);new(this.resources.injected(this.actionMap.ShowShareAction))({focusItemResourceKey:h.shareFocusItemResourceKey}).execute(e)};r.__decorate([n.autobind],e.prototype,"getAccessToken",null);r.__decorate([n.autobind],e.prototype,"onView",null);r.__decorate([n.autobind],e.prototype,"onShare",null);return e}(a.Component);t.default=i;var g=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={itemAnalyticsResult:t.props.fileHoverCardStore.getItemAnalytics(t.props.item)};return t}e.prototype.componentWillReceiveProps=function(e){e.item!==this.props.item&&this.setState({itemAnalyticsResult:this.props.fileHoverCardStore.getItemAnalytics(e.item)})};e.prototype.componentDidMount=function(){this._addListener()};e.prototype.componentDidUpdate=function(e){var t=this.props.fileHoverCardStore;if(this.props.item.itemId!==e.item.itemId){t.removeListener(this._storeListener,e.item);this._addListener()}};e.prototype.componentWillUnmount=function(){this.props.fileHoverCardStore.removeListener(this._storeListener,this.props.item)};e.prototype.render=function(){var e=this.state.itemAnalyticsResult,t={itemAnalytics:e&&e.data,onClick:this.props.onView,isNotSupported:!s.isSupported(this.props.item.extension),status:e&&e.status,isCompact:!0,disableViewerCount:this.props.showViewers,withFacePile:this.props.showViewers},i=t&&t.itemAnalytics;return a.createElement("div",{className:"AnalyticsActionBar--item"},i?a.createElement(s.AnalyticsActionBar,{analyticsStats:t,items:this.props.actionBarItems,withFacePile:this.props.showViewers,showActionBar:!1,farItems:[]}):null)};e.prototype._addListener=function(){var e=this,t=this.props.fileHoverCardStore;this._storeListener=t.addListener(function(){e.setState({itemAnalyticsResult:t.getItemAnalytics(e.props.item)})},this.props.item);t.fetchItemAnalytics(this.props.item)};r.__decorate([n.autobind],e.prototype,"_addListener",null);return e}(a.Component);t.AnalyticsActionBarWrap=g});define("PB",[],function(){return'\x3c!--ko if: component--\x3e<div class=InfoPaneSection--preview data-bind="clientRect: { size: size }, component: component"></div>\x3c!--ko if: enableAnalyticsActionBar--\x3e<div class=InfoPaneSection--viewCountLink data-bind="react: { componentType: analyticsActionBarComponent, props: analyticsActionBarProps }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("PA",["c","az"],function(e,t){e.loadStyles([{rawString:".InfoPaneSection--preview{width:auto;height:180px;position:relative;margin-bottom:8px}.InfoPaneSection--preview .od-ImageStack-tile{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.InfoPaneSection--preview .ms-IFrameCtrl-iFrame{min-height:180px;height:180px}.InfoPaneSection--viewCountLink{font-size:14px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField{padding:5px 20px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item{height:40px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--notSupported{height:0}"}])});define("Py",["c","az"],function(e,t){e.loadStyles([{rawString:".od-DetailsPane-ItemPreviewSection{margin:0 0 12px 0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--preview{margin-bottom:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink{padding:4px 16px}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField{padding:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item{height:auto;padding:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item .ms-AnalyticsStats--stats{height:auto;padding:0}"}])});define("Pb",["require","exports","ap","at","Pc","N3"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,i=e.resources;return r.createElement(n.default,{sectionControlKey:o.resourceKey,item:t,resources:i})};return t}(r.Component);t.default=a});define("Pc",["require","exports","Pf","b5","b3","Pe","Pd"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-properties-section",template:e("Pe"),viewModel:i.default,synchronous:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"ms-properties-section",name:e("module").id,template:e("Pe"),viewModelType:i.default});t.default=n});define("Pf",["require","exports","ap","bF","Pv","Pn","eA","OR","lB","sX","Pj","iG","Pg","eO","V","Pa","bX","cE"],function(e,t,i,r,n,s,l,d,c,o,u,p,m,h,f,g,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=o.strings,a=function(a){i.__extends(e,a);function e(e,t){void 0===t&&(t={});var i=a.call(this,e,t)||this;i.sectionHelper=new(i.managed(g.default));i.loadingSpinnerTagName=c.default.tagName;i.clientFormEditLink=_.clientFormEditLink;i.sectionNotificationTagName=u.default.tagName;i._item=e.item;var r=i,o=r.observables,n=r.resources;i._itemParentHelper=n.consume(l.resourceKey);i._isDocLib=o.pureCompute(i._computeIsDocLib);i.clientForm=o.create();i._serverError=o.create();i.canEdit=o.pureCompute(i._computeCanEdit);i.isLoading=o.pureCompute(i._computeIsLoading);i.propertiesErrorMessage=o.pureCompute(i._computePropertiesErrorMessage);i._selectionModel=n.consume(y.itemsSelection);i.clientFormTitle=o.pureCompute(i._computeTitle);i.addBindingHandlers({toggle:d.default});i._editItemAction=new(i.managed(m.default))({item:e.item});i._clientFormProvider=n.consume(s.resourceKey);o.compute(i._updateProperties);return i}e.prototype.onEditClick=function(e){this._editItemAction.execute(e)};e.prototype._computeTitle=function(){var e=this._selectionModel.selection();return e&&1<e.length?_.bulkEditClientFormTitle:_.clientFormTitle};e.prototype._computeIsLoading=function(){return!this._serverError()&&!this.clientForm()};e.prototype._computeCanEdit=function(){return!this._serverError()&&this._editItemAction.isAvailable()&&!this._isBulkEdit()};e.prototype._computeIsDocLib=function(){var e=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._item(),"list"));return!e||e.list.isDocumentLibrary};e.prototype._computePropertiesErrorMessage=function(){var e=this._serverError();if(e){var t=e&&e.message&&(e.message.value||e.message);return t?f.format(_.propertiesNotificaiton_serverErrorWithDetails,t):_.propertiesNotificaiton_serverErrorNoDetails}var i=this._item();if(i&&i.type!==h.default.Folder){var r=i.hasMissingMetadata,o=this.clientForm(),n=o&&o.params.clientForm;if(n&&n.contentType){r=!1;for(var a=0,s=n.fields;a<s.length;a++){var l=s[a];if(l&&l.schema){var d=l.schema;if(d.Required&&!i.properties[d.Name]){r=!0;break}}}}if(r)return this._isDocLib()?_.propertiesNotificaiton_missingMetadata_file:_.propertiesNotificaiton_missingMetadata_item}return""};e.prototype._updateProperties=function(){var o=this,i=this._selectionModel.selection(),e=this.resources.consume(p.rumOneHelper);e&&e.logPropertiesPaneUpdate();this.clientForm(null);this._serverError(null);this.async.setImmediate(function(){var e=o._item,r=!1;if(o._isBulkEdit()){e=i[0];r=!0}if(e.peek()){var t=e.peek().properties;o._clientFormProvider.getClientForm({clientFormType:1,item:e,contentType:t.ContentType,contentTypeId:t.ContentTypeId,isBulkEdit:r,selection:i}).done(function(e){var t=o.unwrapObservable(o._itemParentHelper.getFacetedAncestorOrSelf(o._item(),"list")),i=r?"BulkEditForm.Render":"EditForm.Render";o.resources.consume(v.resourceKey).logData({name:i,isIntentional:!0});o.clientForm({name:n.getClientFormTagName(e,o.resources),params:{clientForm:e,interactiveSave:!r,isInfoPane:!0,isReadOnly:t&&t.list.disableGridEditing,suppressDefaultSaveBehavior:!0}})},function(e){o._serverError(e)})}})};e.prototype._isBulkEdit=function(){var e=this._selectionModel.selection();return e&&1<e.length};e.dependencies=i.__assign({},r.default.dependencies);return e}(r.default);t.default=a});define("Pv",["require","exports","aC","aq","c7","Pw","ba","on","cE"],function(i,e,t,r,o,n,a,s,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d="ms-client-form",c="ms-client-form-react",u=a.isFeatureEnabled(a.ReactClientForm);if(u){var p=s.createComponent(c,"YW",function(){return new t.default(function(e,t){i(["YW"],e,t)})});r.components.isRegistered(p.tagName)||r.components.register(p.tagName,p)}o.loadModule({path:"V2",getModule:function(){return new t.default(function(e,t){i(["V2"],e,t)})}}).then(function(e){r.components.isRegistered(e.tagName)||r.components.register(e.tagName,e)});e.getClientFormTagName=function(e,t){if(!u)return d;if(!e||!e.fields)return d;var i=c,r=t&&t.consume(l.resourceKey)||null;n.supportReactClientForm(e)||(i=d);if(r){var o=i===c?"ClientForm.Instantiate.ReactClientForm":"ClientForm.Instantiate.KOClientForm";r.logData({name:o,extraData:{TagName:i}})}return i}});define("Pw",["require","exports","a0","aW"],function(e,t,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=["attachments","boolean","choice","datetime","file","lookup","lookupmulti","multichoice","note","number","text","url","user","usermulti"].concat(i.default.isFeatureEnabled({ODB:593})?["taxonomyfieldtype","taxonomyfieldtypemulti"]:[]),r="D4B6480A-4BED-4094-9A52-30181EA38F1D";function d(e,t){return"lookup"===e.toLowerCase()&&t&&t.toLowerCase()===r.toLowerCase()}t.isComplianceTagField=d;function c(e,t){return e&&t&&"computed"===e.toLocaleLowerCase()&&"contenttype"===t.toLocaleLowerCase()}t.isContentTypeField=c;t.supportReactClientForm=function(e){var t,i=e&&e.fields||null;if(null==i||!Array.isArray(i))return!1;for(var r=0;r<i.length;r++){var o=i[r];if(null==o)return!1;var n=o&&o.schema&&o.schema.FieldType||"",a=o&&o.schema&&o.schema.Name||"";if(l.indexOf(n.toLowerCase())<0&&!d(n,o.schema.Id)&&!c(n,a)){t=n,s.Engagement.logData({name:"ReactClientForm.Fallback",extraData:{UnsupportedFieldType:t}});return!1}}return!0}});define("Pn",["require","exports","ap","aC","iJ","eO","eS","Pu","bN","Pp","iE","Po","bA"],function(e,t,i,g,o,y,p,m,n,a,s,h,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._buffer=[];i._bufferSize=5;i._clientFormDataSource=t.clientFormDataSource;i._itemsStore=t.itemsStore;i._listContext=t.listContext;return i}e.prototype.getClientForm=function(t){var i,r=this,e=t.item.peek(),o=this._getBufferKeyFromItem(e,t.contentType),n=t.isBulkEdit?void 0:this._getClientFormFromBuffer(o);e.type!==y.default.Folder||t.contentType||(t.contentType="Folder");if(n&&!this._listContext.refreshClientForm){if(e.hasClientFormData){n.item=t.item;return g.default.wrap(n)}this._deleteClientFormFromBuffer(o)}var a=[];if(t.isBulkEdit&&t.selection&&!t.isSwitchingContentType)for(var s={},l=0,d=t.selection;l<d.length;l++){var c=d[l];if(c){var u=c.peek(),p=u.properties;if(p){var m=u.type!==y.default.Folder||p.ContentType?p.ContentType:"Folder",h=p.ContentTypeId,f=m+h;if(!s[f]){a.push({contentType:m,contentTypeId:h});s[f]=!0}}}}else a.push({contentType:t.contentType,contentTypeId:t.contentTypeId});return this._clientFormDataSource.getClientFormSchema(t.clientFormType,a,t.isBulkEdit).then(function(e){i={item:t.item,formType:e.formType,contentType:e.contentType,contentTypeId:e.contentTypeId,fields:[],isBulkEdit:t.isBulkEdit};r._generateFieldsFromSchema(i,e);if(2!==t.clientFormType)return r.updateFormValues(i)}).then(function(){r._addClientFormToBuffer(i);return g.default.wrap(i)})};e.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)};e.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)};e.prototype.updateItem=function(e){e.clientForm.isBulkEdit&&e.selection&&(this._buffer=[]);return this._clientFormDataSource.updateItem(e)};e.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)};e.prototype.updateItemMetadata=function(e,r){var o=this,t=e.items,n=e.metadata,a=e.parentItem,s=e.skipInvalidation,l=e.onComplete,d=t.length,c=0,u=[];return g.default.wrap(function(){t.forEach(function(e,i){r&&(u[i]=new p.default(e.key,e));var t={item:o.createObservable(e),fields:function(){for(var e=[],t=n.group;t;){var i=t.fieldValue,r=t.fieldSchema;e.push({data:o.createObservable(i),serverData:null,state:o.createObservable(0),hasException:o.createObservable(!1),errorMessage:o.createObservable(""),schema:r});t=h.convertGroup(m.default.getParent(t,n.itemGroups))}return e}(),contentType:null,formType:1};o._clientFormDataSource.updateItem({clientForm:t,newDocumentUpdate:!1,checkInComment:null}).then(function(){c++;if(r){u[i]=u[i].succeed();r.update(u)}if(c===d){l&&l(!0);a&&!s&&o._itemsStore.invalidateItem(a.key)}},function(e){if(r){var t=e&&0<e.length&&e[0]&&e[0].message&&e[0].message.value;u[i]=u[i].fail(new Error(t));r.update(u)}})});r&&r.update(u)}())};e.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)};e.prototype.getFormRenderMode=function(e,t){return this._clientFormDataSource.getFormRenderMode(e,t)};e.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()};e.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()};e.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()};e.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)};e.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()};e.prototype._generateFieldsFromSchema=function(e,t){for(var i=this._listContext&&this._listContext.enableAttachments,r=0,o=t.fields.length;r<o;r++){var n=t.fields[r];("Attachments"!==n.Type||i)&&e.fields.push(this._generateField(e,n))}};e.prototype._generateField=function(e,t){return{hasException:this.createObservable(!1),errorMessage:this.createObservable(""),schema:t,state:this.createObservable(0)}};e.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t};e.prototype._getClientFormFromBuffer=function(e){for(var t=0,i=this._buffer.length;t<i;t++){var r=this._buffer[t].key;if(r===e){if(0===t)return this._buffer[t].form;var o=this._buffer[t].form;this._buffer.splice(t,1);this._buffer.unshift({key:r,form:o});return o}}return null};e.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit&&!this._hasAppendOnlyField(e)){var t=e.item.peek();t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}};e.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,i=this._buffer.length;t<i;t++){if(this._buffer[t].key===e){this._buffer.splice(t,1);break}}};e.prototype._hasAppendOnlyField=function(e){for(var t=0,i=e.fields;t<i.length;t++){if(i[t].schema.AppendOnly)return!0}return!1};e.dependencies=i.__assign({},n.default.dependencies,{clientFormDataSource:a.resourceKey,itemsStore:o.resourceKey,listContext:s.listContext});return e}(n.default);t.default=l;t.resourceKey=r.createResolvedResourceKey(e("module").id,l)});define("Pu",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(a){a.getParent=function(t,e){if(t.level&&t.parentKey&&0!==t.level)return e.filter(function(e){return e.groupingId===t.parentKey})[0]};a.getFilterDetails=function(e,t){for(var i=e,r=[],o=[];i&&i.fieldSchema;){r.unshift(i.fieldSchema.Name);var n=s(i);o.unshift(n);i=a.getParent(i,t)}return{fields:r,values:o}};function s(e){var t="";switch(e.fieldSchema.Type){case"User":case"Lookup":t=e.name;break;case"DateTime":var i=decodeURIComponent(e.groupString).split(";#"),r=i[0];0<i.length&&(i=i.slice(1,i.length-1))[e.level]&&(r=i[e.level]);t=function(e){if(!e)return e;var t=e.substring(0,4),i=e.substring(4,6),r=e.substring(6,8);return[t,"-",i,"-",r].join("")}(r);break;default:t=e.fieldValue}return t}}(i||(i={}));t.default=i});define("Pp",["require","exports","ap","aq","aC","hc","ej","aM","Pt","V","h6","bs","eq","dZ","iE","dJ","Pr","fO","fZ","ba","m8","aP","b4","aL","bA","U","Pq","dc"],function(e,a,l,p,I,t,d,c,T,w,i,u,C,o,n,s,m,h,f,g,P,y,v,_,r,b,E,x){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.RootContentTypeIds={folder:"0x0120",document:"0x0101",item:"0x01"};var S=function(r){l.__extends(e,r);function e(e,t){var i=r.call(this,t.pageContext)||this;i._clientForms=null;i._listContext=t.listContext;i._itemsDataSource=t.items;i._navigation=t.navigation;i._complianceTagDataSource=t.compliance;i._itemUrlHelper=t.itemUrlHelper;i._apiUrlHelper=t.apiUrlHelper;return i}e.prototype.createItem=function(i){var e=this,t=this._getUrlInfo(i.clientForm.item),r=t.listUrl,o=t.itemUrlParts,n="AddValidateUpdateItemUsingPath";return this._createOrUpdateItem("CreateItem",function(){return e._apiUrlHelper.build().webByItemUrl(o).method("GetList",r).method(n).toString()},function(e){var t=i.rootFolder||r;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:t}},formValues:e,bNewDocumentUpdate:i.newDocumentUpdate,checkInComment:i.checkInComment})},i,n).then(function(){return e._updateAttachmentsField(i)})};e.prototype.updateItem=function(l){var d=this,c=l.clientForm.isBulkEdit&&l.selection&&1<l.selection.length?l.selection:void 0;c&&c.filter(function(e){return!!e});var u=c&&0<c.length;return this._createOrUpdateItem("UpdateItem",function(e){var t=d._getUrlInfo(e),i=t.listUrl,r=t.itemUrlParts;return u?d._apiUrlHelper.build().webByItemUrl(r).method("GetList",i).method("BulkValidateUpdateListItems").toString():d._apiUrlHelper.build().webByItemUrl(r).method("GetList",i).method("items",e.peek().properties.ID).method("ValidateUpdateListItem").toString()},function(e){var t,i;if(u){t=[];for(var r=0,o=c;r<o.length;r++){var n=o[r];t.push(parseInt(n.peek().properties.ID,10))}var a=l.clientForm.item.peek(),s=a&&a.parent;i=s&&d._itemUrlHelper.getItemUrlParts(s.key).normalizedItemUrl}return JSON.stringify({itemIds:t,formValues:e,bNewDocumentUpdate:l.newDocumentUpdate,checkInComment:l.checkInComment,folderPath:i})},l,u?"BulkValidateUpdateListItems":"ValidateUpdateListItem",c).then(function(e){return d._updateAttachmentsField(l).then(function(){return e})})};e.prototype.getClientFormSchema=function(i,r,o){var n=this,e=function(){var e=n._locateClientFormWithContentTypeInfos(i,r);if(o&&e&&e.fields){var t=e.fields.filter(function(e){var t=e.FieldType.toLowerCase(),i=e.Name;return"file"!==t&&"attachments"!==t&&"Title"!==i&&"LinkTitle"!==i&&"LinkTitleNoMenu"!==i});return l.__assign({},e,{fields:t})}return e};if(null===this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas().then(function(){return e()})}return I.default.wrap(e())};e.prototype.updateFormValues=function(r,o){var n=this,a=r.item.peek();if(!a)return I.default.wrap();for(var s=[],e=0,t=r.fields;e<t.length;e++){var i=t[e];if(0===i.state.peek()){i.state(2);s.push(i)}}return this.getData(function(){var e=a.properties.ID,t=c.default.encodeRestUriStringToken(n._listContext.listUrl),i=g.isFeatureEnabled(g.ModernAppendOnly)?"15":"7",r=new d.default(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",o=g.isFeatureEnabled(g.ModernAppendOnly)?",cutoffVersion="+r:"";return n._pageContext.webAbsoluteUrl+"/_api/web/GetList(@v1)/RenderExtendedListFormData(itemId="+e+",formId='editform',mode='2',options="+i+o+")?@v1='"+t+"'"},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return t=JSON.parse(t.d.RenderExtendedListFormData)}return null},"GetItemDataForClientForm",function(){return""},"POST",this._getAdditionalHeaders()).then(function(e){n._handleServerData(r,e,o,s);for(var t=0,i=s;t<i.length;t++){i[t].state(0)}},function(e){for(var t=e.code?e.code.split(","):e.error.code.split(","),i=1<t.length?Number(t[0]):-1,r=0,o=s;r<o.length;r++){o[r].state(0)}return I.default.wrapError({errorCode:i,message:e&&e.message?e.message.value?e.message.value:e.message:""})})};e.prototype.getFieldValueSuggestions=function(i,e,l,t){var r=this;l=l||5;t=b.default.encodeText(t);var o=this._getSuggestionsViewXml(i,e,!0,l,t),n=this._getSuggestionsViewXml(i,e,!1,l,t),a=this._getAdditionalHeaders(),s=function(e){var t=JSON.parse(e);return t&&t.Row&&0<t.Row.length?t.Row.map(function(e){var t=e[i];return"string"==typeof t||t instanceof String?e[i].trim():JSON.stringify(e[i])}):[]},d=this.getData(function(){return r._getServerConnectionUrl().toString()},s,"GetLatestFieldValueModifiedByMe",function(){return u.default.getAdditionalPostData({needsSchema:!1,viewXml:o})},"POST",a),c=this.getData(function(){return r._getServerConnectionUrl().toString()},s,"GetLatestFieldValueModifiedByOther",function(){return u.default.getAdditionalPostData({needsSchema:!1,viewXml:n})},"POST",a);return I.default.all([d,c]).then(function(e){for(var t={},i=[],r=0,o=e;r<o.length;r++)for(var n=0,a=o[r];n<a.length;n++){var s=a[n];if(!t[s]){i.push(s);t[s]=!0;if(i.length===l)return i}}return i})};e.prototype.getFieldFilterData=function(e,t){var i=s.serializeQuery(this._navigation.viewParams);return this._itemsDataSource.getFilterData(e,i,t)};e.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var i in this._clientForms[e])this._clientForms[e].hasOwnProperty(i)&&t.push({displayName:i,description:i,templateUrl:null});return t};e.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})};e.prototype.getFormRenderMode=function(e,t){var i=this;return this._ensureClientForms(function(){return i._getFormRenderMode(e,t)})};e.prototype.getPowerAppFormId=function(){return this._powerAppFormId};e.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo};e.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData};e.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='"+e+"'&visualizationTarget=1"},function(e){var t=JSON.parse(e),i="";t.d&&t.d.Value&&(i=JSON.parse(t.d.Value));return i},"GetPowerAppFormDesignUrl",null,"GET")};e.prototype.fetchAllClientFormSchemas=function(){var r=this;this._clientFormsDebouncer||(this._clientFormsDebouncer=new v.default);this._clientFormsDebouncer.isExecuting()||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this.getData(function(){return r._getServerConnectionUrl().toString()},function(e){r._clientForms={};var t=JSON.parse(e);t.ContentTypeIdToNameMap&&(r._contentTypeIdToNameMap=t.ContentTypeIdToNameMap);var i=t.ClientForms;if(i){i.New&&r._processClientFormResponse(2,i.New);if(i.Edit){r._processClientFormResponse(1,i.Edit);r._processClientFormResponse(3,i.Edit)}}t.Navigation&&(r._listContext.leftNavigationData={quickLaunchNodes:t.Navigation.Nodes});void 0!==t.EnableAttachments&&(r._listContext.enableAttachments=t.EnableAttachments);t.FormRenderModes&&r._processFormRenderMode(t.FormRenderModes);(t.PowerAppFormId||t.AppId)&&(r._powerAppFormId=t.PowerAppFormId||t.AppId);t.AppRenderInfo&&(r._powerAppFormInfo=t.AppRenderInfo||{});t.AppAdditionalData&&(r._powerAppAdditionalData=t.AppAdditionalData)},"GetClientForms",function(){var e=!r._listContext.leftNavigationData&&g.isFeatureEnabled(g.RenderListDataAsStreamLeftNavOpt);return u.default.getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:e})},"POST",this._getAdditionalHeaders())));return this._clientFormsPromise};e.prototype.getDataSourceName=function(){return"ClientFormDataSource"};e.prototype._processClientFormResponse=function(e,t){this._clientForms[e]||(this._clientForms[e]={});var i=this._clientForms[e];for(var r in t)if(t.hasOwnProperty(r)&&!i[r]){i[r]={contentType:r,contentTypeId:this._reverseLookupContentTypeIdByName(r),formType:e,fields:[],mode:0};for(var o=i[r],n=t[r],a=0,s=n.length;a<s;a++)o.fields.push(n[a])}};e.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return i.getListDataUrl({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})};e.prototype._getUrlInfo=function(e){var t=e&&this._itemUrlHelper.getItemUrlParts(this.peekUnwrapObservable(e).key);return{listUrl:t?t.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:t}};e.prototype._createOrUpdateItem=function(e,t,i,o,r,n){for(var a=this,s=o.clientForm.fields,l=[],d=[],c={},u=[],p=null,m=this._failedUpdateComplianceTagIdsCount=0,h=s;m<h.length;m++){var f=h[m];if(f.data&&0===f.state.peek()){var g=f.data.peek();if(P.isClientFormComplianceTagField(f)&&g!==f.serverData){p=f;if(n){var y=this._getUpdateMultipleComplianceTagsPromises(g,n,f);if(y)for(var v=0,_=y;v<_.length;v++){var b=_[v];u.push(b)}}else{var x=this._getUpdateComplianceTagPromise(g,o.clientForm.item.peek(),f);x&&u.push(x)}}else if(this._isClientFormFieldUpdated(o,g,f)&&"attachments"!==f.schema.FieldType.toLowerCase()){f.state(1);l.push(f);var S=f.schema.Name;g="ContentType"===S?g.displayName:g;d.push({FieldName:S,FieldValue:g,HasException:!1,ErrorMessage:null})}else c[f.schema.Name]=!0}}2===o.clientForm.formType&&d.push({FieldName:"ContentType",FieldValue:o.clientForm.contentType,HasException:!1,ErrorMessage:null});if(0===l.length&&0===u.length)return I.default.wrap({status:T.UpdateResultStatus.success});u.push(this._getUpdateItemPromise(e,t,i,o,r,l,d,o.clientForm.item,n));return I.default.all(u).then(function(e){for(var t={status:T.UpdateResultStatus.success},i=0,r=e;i<r.length;i++){var o=r[i];if(o&&o.hasOwnProperty("status")){t.status=o.status;o.failedItemIds&&(t.failedItemIds=o.failedItemIds)}break}0<a._failedUpdateComplianceTagIdsCount&&t.status===T.UpdateResultStatus.success&&(t.status=T.UpdateResultStatus.partialSuccess);return t},function(e){p&&p.state(0);for(var t=0,i=l;t<i.length;t++){i[t].state(0)}var r=C.getServerUrl(a._pageContext)+o.clientForm.item.peek().properties.FileRef;throw e=(e=Array.isArray(e)?e:[e]).filter(function(e){return e&&e.message&&e.message.value}).map(function(e){e.message.value=e.message.value.replace('"'+r+'" ',"");return e})})};e.prototype._getUpdateItemPromise=function(e,t,i,x,S,C,r,P,k){return r&&0!==r.length&&C&&0!==C.length?this.getData(t.bind(null,P),function(e){var t=JSON.parse(e);if(!t.d||!t.d[S]||!t.d[S].results){for(var i=0,r=C;i<r.length;i++){(b=r[i]).state(0)}return I.default.wrapError("The server response couldn't be processed")}for(var o=null,n={},a="",s=0,l=t.d[S].results;s<l.length;s++){var d=l[s];if(2===x.clientForm.formType&&"Id"===d.FieldName){var c=P.peek();c.properties||(c.properties={});c.properties.ID=d.FieldValue}if(!0===d.HasException||null!==d.ErrorMessage){var u=d.FieldName;n[u]||(n[u]=[]);void 0!==d.ItemId&&n[u].indexOf(d.ItemId)<0&&n[u].push(d.ItemId);if(!o){o={};for(var p=0,m=x.clientForm.fields;p<m.length;p++){var h=m[p];o[h.schema.Name]=h}}if(o[u]){o[u].errorMessage(d.ErrorMessage);o[u].hasException(!0);var f=o[u].schema.Title;a=a?a+", "+f:f}}}var g={status:a?T.UpdateResultStatus.fail:T.UpdateResultStatus.success};if(k&&k.length&&n.null){var y=n.null;y.length<k.length?g.status=T.UpdateResultStatus.partialSuccess:g.status=T.UpdateResultStatus.fail;g.failedItemIds=y}for(var v=0,_=C;v<_.length;v++){var b=_[v];if(a){if(!n[b.schema.Name]&&x.isInteractiveSave){b.errorMessage(w.format(E.strings.ErrorInOtherFields,a));b.hasException(!0)}}else{b.errorMessage("");b.hasException(!1)}b.state(0)}return g},e,function(){return i(r)},"POST",this._getAdditionalHeaders(),void 0,5):I.default.wrap()};e.prototype._handleServerData=function(e,t,i,r){for(var o=t.ListData,n=t.Data.Row[0],a=e.item.peek(),s=e.isBulkEdit,l=0,d=r.length;l<d;l++){var c=r[l],u=c.schema;if(!i||!i.hasOwnProperty(u.Name)){void 0===c.data&&(c.data=p.observable(null));void 0===c.serverData&&(c.serverData=null);if(o.hasOwnProperty(u.Name)){"boolean"===u.FieldType.toLowerCase()&&""===n[u.Name]&&"0"===o[u.Name]?c.serverData="":c.serverData=o[u.Name];a.hasOwnProperty(u.Name)||a.properties.hasOwnProperty(u.Name)||(a.properties[u.Name]=n[u.Name])}else c.serverData=null;s&&(c.serverData=null);if(c.schema.AppendOnly){c.appendOnlyData=t[c.schema.Name];c.data("")}else c.data(c.serverData);c.hasException(!1);c.errorMessage("");c.schema=u}}a.properties[P.ASSETID_FIELD_NAME]=o[P.ASSETID_FIELD_NAME];a.hasClientFormData=!0};e.prototype._getAdditionalHeaders=function(){return i.getListRequestHeaders(this._listContext)};e.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var i in e[t]){var r=2;switch(i){case"Edit":r=1;break;case"Display":r=3}var o=0;switch(e[t][i].RenderType){case 1:o=1;break;case 2:o=2;break;case 3:o=3;break;case 4:o=4;break;default:y.Verbose.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][i].RenderType})}this._clientForms[r][t].mode=o}};e.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var i in this._clientForms[t])if(this._clientForms[t][i].mode===e)return!0;return!1};e.prototype._getSuggestionsViewXml=function(e,t,i,r,o){var n=i?'<Eq><FieldRef Name="Editor" LookupId="TRUE"/><Value Type="int"><UserID/></Value></Eq>':'<Neq><FieldRef Name="Editor" LookupId="TRUE"/><Value Type="int"><UserID/></Value></Neq>';return'<View Scope="RecursiveAll">'+('<Query><OrderBy><FieldRef Name="ID" Ascending="false"></FieldRef></OrderBy><Where>'+(n=o?"<And>"+n+'<BeginsWith><FieldRef Name="'+e+'"/><Value Type="'+t+'">'+o+"</Value></BeginsWith></And>":"<And>"+n+'<IsNotNull><FieldRef Name="'+e+'"/></IsNotNull></And>')+"</Where></Query>")+('<ViewFields><FieldRef Name="Modified"/><FieldRef Name="Editor"/><FieldRef Name="'+e+'"/></ViewFields>')+'<RowLimit Paged="TRUE">'+r+"</RowLimit></View>"};e.prototype._getUpdateComplianceTagPromise=function(t,e,i){var r,o=i.schema;o.ComplianceTags&&(r=o.ComplianceTags.filter(function(e){return e&&e.tagValue===t})[0]);return r?this._complianceTagDataSource.updateComplianceTag(e,r).then(null,function(e){if(e&&i){i.errorMessage(e.message&&e.message.value?e.message.value:e);i.hasException(!0)}}):I.default.wrap()};e.prototype._getUpdateMultipleComplianceTagsPromises=function(t,e,i){var r,o=this,n=i.schema,a=[];n.ComplianceTags&&(r=n.ComplianceTags.filter(function(e){return e&&e.tagValue===t})[0]);if(r){for(var s=[],l=0,d=0,c=e.length;d<c;d++){var u=e[d];s.push(parseInt(u().properties.ID,10));if(++l===P.MAX_ITEM_SIZE||d===e.length-1){var p=this._itemUrlHelper.getItemUrlParts(e[0]().key).serverRelativeListUrl;a.push(this._complianceTagDataSource.updateComplianceTagInBatch(s,r,p).then(function(e){o._failedUpdateComplianceTagIdsCount+=e.length},function(e){if(e&&i){i.errorMessage(e.message&&e.message.value?e.message.value:e);i.hasException(!0)}}));s=[];l=0}}return a}return null};e.prototype._updateAttachmentsField=function(e){var t=this,i=e.clientForm.item.peek(),r=null;if(i&&i.properties.ID){for(var o=0,n=e.clientForm.fields;o<n.length;o++){var a=n[o];if("attachments"===a.schema.FieldType.toLowerCase()){r=a;break}}var s=r&&r.AttachmentOperationsManager;if(s&&0<s.operationsPool.length){s.setListItem(i);return s.executeAllOperations(s.operationsPool,!0).then(function(e){s.operationsPool=[];t.handleAttachmentsErrors(e,r)},function(e){s.operationsPool=[];t.handleAttachmentsErrors(e,r)})}}return I.default.wrap(null)};e.prototype.handleAttachmentsErrors=function(e,t){var i=[];e.forEach(function(e){e.result||i.push(e.errorMsg)});if(t&&i&&0<i.length){var r=i.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage(r);t.hasException(!0)}};e.prototype._getFormRenderMode=function(e,t){var i=this._contentTypeIdToNameMap[t],r=this._clientForms[e][i];return r?r.mode:this._checkRenderModes(3)?3:0};e.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null};e.prototype._ensureClientForms=function(e){if(!this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas().then(e)}return I.default.wrap(e())};e.prototype._isClientFormFieldUpdated=function(e,t,i){return(!e.clientForm.isBulkEdit||""!==t||null!==i.serverData)&&(g.isFeatureEnabled(g.ReactClientForm)?i.schema.AppendOnly?!!t:!_.deepCompare(t,i.serverData):t!==i.serverData)};e.prototype._locateClientForm=function(e,t,i){!t&&i&&this._contentTypeIdToNameMap&&(t=this._contentTypeIdToNameMap[i]);if(!t&&this._clientForms[e])for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){t=r;break}if(i&&0===i.lastIndexOf(a.RootContentTypeIds.folder,0)&&this._clientForms[e]&&!this._clientForms[e][t]){var o={FileLeafRef:1,Title:1,URL:1};for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){var n=this._clientForms[e][r].fields.filter(function(e){return!!o[e.Name]})[0];if(n){this._clientForms[e].Folder={contentType:"Folder",contentTypeId:i,formType:e,fields:[n],mode:0};return this._clientForms[e].Folder}}}return this._clientForms[e]&&this._clientForms[e][t]?this._clientForms[e][t]:null};e.prototype._locateClientFormWithContentTypeInfos=function(i,o){if(!o||!o.length)return this._locateClientForm(i,void 0,void 0);var e=o[0],t=this._locateClientForm(i,e.contentType,e.contentTypeId);if(1===o.length||!t||!t.fields)return t;for(var n=t.fields.slice(),r=function(e){if(0===n.length)return"break";var t=o[e],r=a._locateClientForm(i,t.contentType,t.contentTypeId);n=n.filter(function(e){for(var t=0,i=r.fields;t<i.length;t++){if(i[t].Name===e.Name)return!0}return!1})},a=this,s=1;s<o.length;s++){if("break"===r(s))break}return l.__assign({},t,{fields:n})};e.dependencies={pageContext:n.pageContext,listContext:n.listContext,items:o.items,navigation:x.navigation,compliance:m.resourceKey,itemUrlHelper:h.resourceKey,apiUrlHelper:f.resourceKey};return e}(t.default);a.default=S;a.resourceKey=r.createResolvedResourceKey(e("module").id,S)});define("Pt",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.fail=0]="fail";e[e.partialSuccess=1]="partialSuccess";e[e.success=2]="success"}(t.UpdateResultStatus||(t.UpdateResultStatus={}))});define("Pr",["require","exports","ap","bN","aC","gl","iE","fZ","fO","m8","Ps","bA","aP"],function(e,t,i,o,l,n,a,s,d,c,u,r,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._pageContext=t.pageContext;i._apiUrlHelper=t.apiUrlHelper;i._itemUrlHelper=t.itemUrlHelper;i._dataRequestor=new n.default({qosName:"ComplianceTagDataSource"},{pageContext:i._pageContext});return i}e.prototype.getAvailableTagsForSite=function(){var t=this;return this._dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(e){return t._transformToComplianceTags(e.d.GetAvailableTagsForSite.results)},function(e){return l.default.wrapError(u.strings.GetAvailableTagsForSiteFailed)})};e.prototype.updateComplianceTagInBatch=function(e,t,i){if(!e||0===e.length){p.Verbose.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+i});return l.default.wrap([])}var r=JSON.stringify({itemIds:e,listUrl:i,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this._dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:r,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return l.default.wrapError(e)})};e.prototype.updateComplianceTag=function(t,i){var r=this,e="SetComplianceTag",o=i.blockEdit||i.blockDelete,n=i.blockEdit,a=i.isEventTag,s=JSON.stringify({complianceTag:i.tagValue,isTagPolicyHold:o,isTagPolicyRecord:n,isEventBasedTag:a});return this._dataRequestor.getData({url:this._buildUpdateHashtagsUrl(t,e),qosName:e,additionalPostData:s,method:"POST",noRedirect:!0}).then(function(){return i.tagName},function(e){return 404===e.status?r._useOldMethodToSetTags(t,i):l.default.wrapError(e)})};e.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()};e.prototype._buildUpdateHashtagsUrl=function(e,t){var i=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(i).method("GetList",i.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()};e.prototype._transformToComplianceTags=function(e){var t=[],i={tagName:u.strings.NoneComplianceTagName,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:u.strings.NoneComplianceTagDescription,tagTooltip:u.strings.NoneComplianceTagDescription,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:""};t.push(i);for(var r=0,o=e;r<o.length;r++){var n=o[r],a=c.getTagDescription(n),s=c.getTagTooltip(n),l={tagName:n.TagName,tagValue:n.TagName,blockDelete:n.BlockDelete,blockEdit:!!n.BlockEdit,tagDescription:a,tagTooltip:s,hasRetentionAction:n.HasRetentionAction,autoDelete:n.AutoDelete,isEventTag:n.IsEventTag,reviewerEmail:n.ReviewerEmail,notes:n.Notes,displayName:n.DisplayName};t.push(l)}return t};e.prototype._useOldMethodToSetTags=function(e,t){var i=this._getUpdateMethodName(t.blockDelete,t.blockEdit);return this._dataRequestor.getData({url:this._buildOldUrl(e,t.tagValue,i),qosName:i,noRedirect:!0}).then(function(){return t.tagName},function(e){return l.default.wrapError(e)})};e.prototype._getUpdateMethodName=function(e,t){return t?"SetComplianceTagWithRecord":e?"SetComplianceTagWithHold":"SetComplianceTagWithNoHold"};e.prototype._buildOldUrl=function(e,t,i){var r=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(r).method("GetList",r.serverRelativeListUrl).method("Items",e.properties.ID).methodWithAliases(i,{complianceTag:t}).toString()};e.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()};e.dependencies=i.__assign({},o.default.dependencies,{pageContext:a.pageContext,apiUrlHelper:s.resourceKey,itemUrlHelper:d.resourceKey});return e}(o.default);t.default=m;t.resourceKey=r.createResolvedResourceKey(e("module").id,m)});define("Po",["require","exports","ap"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertGroup=function e(t){if(t){var i=t.fieldSchema,r=t.children,o=n.__rest(t,["fieldSchema","children"]);return n.__assign({fieldSchema:i?n.__assign({},i,{Name:i.Name}):void 0,children:r?r.map(e):void 0},o)}}});define("Pj",["require","exports","Pm","b5","Pl","Pk"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-section-notification",template:e("Pl"),viewModel:i.default,synchronous:!0});t.default=o});define("Pm",["require","exports","ap","bF","d"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.text=e.notificationText;t.iconClass=o.getIconClassName(e.iconName||"Error");return t}return e}(i.default);t.default=n});define("Pl",[],function(){return'<div class=od-SectionNotification><i class="od-SectionNotification-icon ms-Icon" data-bind="css: iconClass"></i><div class=od-SectionNotification-text><span data-bind="text: text"></span></div></div>'});define("Pk",["c","az"],function(e,t){e.loadStyles([{rawString:".od-SectionNotification{padding:8px;background-color:"},{theme:"warningBackground",defaultValue:"rgba(255,185,0,.2)"},{rawString:";display:-ms-flexbox;display:flex}.od-SectionNotification-icon{padding-top:1px;font-size:14px}html[dir=ltr] .od-SectionNotification-icon{padding-right:4px}html[dir=rtl] .od-SectionNotification-icon{padding-left:4px}.od-SectionNotification-text{-ms-flex:1;flex:1}"}])});define("Pg",["require","exports","ap","kz","bX","dZ","aI","Ph","MZ","cY","iE","ey","ci","Pn","kG","jb"],function(e,t,i,r,n,a,s,l,d,c,u,p,m,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this;t.name="EditItemAction";var i=e.isFullPageApp,r=void 0!==i&&i;t._isFullPageApp=r;t._urlDataSource=t.resources.consume(a.url);t._pageContext=t.resources.consume(u.pageContext);t._dialogProvider=t.resources.consume(m.resourceKey);t._actionMap=t.resources.consume(n.actionMap);t._itemCommandHelper=t.resources.consume(f.resourceKey);return t}e.prototype.onSelectionIsAvailable=function(e,t){var i=this.getParent(t,"list");return!!this._itemCommandHelper.isCommandSupported(t,g.editItem)&&(i&&i.list.templateType!==p.default.mySiteDocumentLibrary&&c.PermissionMask.hasItemPermission(t,c.PermissionMask.editListItems)&&1===e)};e.prototype.onSelectionExecute=function(e,t,i){return d.default.isCheckedOutByOther(e[0],this._pageContext.userId)?d.default.showCheckedOutByOtherDialog(this._dialogProvider):this._editInFullPageClientForm(e,t)};e.prototype._editInFullPageClientForm=function(e,t){return this._actionMap?new(this.managed(this._actionMap.LaunchListFormAction))({type:1,item:e[0],url:this._urlDataSource.getEditFormUrl(e[0]),isFullPageApp:this._isFullPageApp}).execute(t):this._editInClientFormDialog(e)};e.prototype._editInClientFormDialog=function(e){var i=this;return this.resources.consume(h.resourceKey).getClientForm({item:this.observables.create(e[0]),clientFormType:1,contentType:e[0].properties.ContentType}).then(function(e){var t=i.resources.consume(m.resourceKey);return l.default.getDialog(e,t,i.resources).wait()}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};return e}(r.default);t.default=o});define("Ph",["require","exports","aq","aC","Pv","Pi","dI"],function(e,t,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.getDialog=function(e,t,i){var r=null;return t.requestDialog({title:s.strings.TitleLabel,actions:[{name:s.strings.SaveLabel,icon:new l.default("Save"),execute:function(){null===r&&n.default.wrap(1);return r.processAndSaveChanges().then(function(e){return e?2:1})},isAvailable:o.observable(!0),isDefault:!1,automationId:"saveClientFormDialog"},{name:s.strings.CancelLabel,icon:new l.default("Cancel"),execute:function(){return n.default.wrap(3)},isAvailable:o.observable(!0),isDefault:!0,automationId:"cancelClientFormDialog"}],component:{name:a.getClientFormTagName(e,i),params:{clientForm:e,interactiveSave:!1,fieldsManagerAccessor:function(e){r=e}}},size:"XLarge"})};return e}();t.default=i});define("Pe",[],function(){return'<div class="InfoPane-section InfoPaneSection--properties" data-automationid=ms-properties-section data-bind="css: { \'is-expanded\': sectionHelper.isExpanded, \'no-arrow\': !sectionHelper.showArrow }"><div class=InfoPane-sectionHeader id=spo-Properties-sectionHeader data-bind="toggle: sectionHelper.isExpanded, attr: { \'aria-expanded\': sectionHelper.isExpanded(), tabindex: sectionHelper.showArrow ? 0 : -1, role: sectionHelper.showArrow ? \'button\' : \'\' }">\x3c!--ko if: sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e<span class=InfoPane-sectionHeaderText data-bind="text: clientFormTitle"></span>\x3c!--ko if: canEdit--\x3e<a class=spo-Properties-editLink data-bind="click: onEditClick, clickBubble: false, text: clientFormEditLink" href=#></a>\x3c!--/ko--\x3e</div><div class=InfoPane-sectionContent>\x3c!--ko if: isLoading--\x3e<div class=od-ClientFormFields-loadingSpinner data-bind="component: { name: loadingSpinnerTagName }"></div>\x3c!--/ko--\x3e\x3c!--ko if: propertiesErrorMessage--\x3e<div class=spo-Properties-sectionNotification data-bind="component: { name: sectionNotificationTagName, params: { notificationText: propertiesErrorMessage } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: clientForm--\x3e<div class=spo-Properties-clientForm data-bind="component: clientForm"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>'});define("Pd",["c","az"],function(e,t){e.loadStyles([{rawString:".InfoPaneSection--properties{width:100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.spo-Properties-editLink{line-height:26px;font-size:12px}html[dir=ltr] .spo-Properties-editLink{float:right}html[dir=rtl] .spo-Properties-editLink{float:left}.InfoPane .spo-Properties-clientForm .ReactClientForm.is-bulkEdit{top:116px}.od-DetailsPane-LegacySection .spo-Properties-clientForm .od-ClientForm.is-bulkEdit{top:64px}"}])});define("O5",["require","exports","ap","at","O6","N3"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,i=e.resources;return r.createElement(n.default,{sectionControlKey:o.resourceKey,item:t,resources:i})};return t}(r.Component);t.default=a});define("O6",["require","exports","O9","b5","b3","O8","O7"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-shortcutInformation-info-pane-section",template:e("O8"),viewModel:i.default,synchronous:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"ms-shortcutInformation-info-pane-section",name:e("module").id,template:e("O8"),viewModelType:i.default});t.default=n});define("O9",["require","exports","ap","bF","sX","hs","cE","kE","LY","dZ","Pa"],function(e,t,i,r,o,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p="TargetPath.ShortcutInformation.Click",m=o.strings,n=function(n){i.__extends(e,n);function e(e,t){void 0===t&&(t={});var i=n.call(this,e,t)||this;i._item=e.item;i.strings=m;i.sectionHelper=new(i.managed(u.default));var r=i.observables,o=i.resources;i.targetItem=r.create(null);i._shortcutProvider=o.consume(l.resourceKey);i._urlDataSource=o.consume(c.url);r.compute(i._computeTargetItem);i._fileType=r.pureCompute(i._computeFileType);i._modified=r.pureCompute(i._computeModified);i.targetFileType=r.pureCompute(i._computeTargetFileType);i.targetModified=r.pureCompute(i._computeTargetModified);i.targetContainerPath=r.pureCompute(i._computeTargetContainerPath);i.targetContainerName=r.pureCompute(i._computeTargetContainerName);i.path=r.pureCompute(i._computePath);i.targetPathOnClick=function(){i.resources.consume(s.resourceKey).logData({name:p,isIntentional:!0});return!0};return i}e.prototype._computeTargetItem=function(){var e=this._item(),t=this._shortcutProvider,i=this.targetItem;i(null);t.getShortcutTargetData(e.id).then(function(e){return t.getFileByUrl(e.url)}).then(function(e){i(e)})};e.prototype._computeFileType=function(){var e=this._item();if(!e.isBundle&&void 0===e.virtualItemType)return d.getFriendlyItemType(e)};e.prototype._computeModified=function(){var e=this._item();if(!this._urlDataSource.isRecycleBin(e.queryType))return e.dateModifiedTime?a.getFullDisplayDate(e.dateModifiedTime):e.dateModified};e.prototype._computePath=function(){var e=this._item();if(!e.audio&&e.parent&&!this._urlDataSource.isRecycleBin(e.queryType)){for(var t=[],i=e;i;i=i.parent)t.unshift(i.name);return t}};e.prototype._computeTargetFileType=function(){var e=this.targetItem();return e?d.getShortcutFileType(e.Name):this._fileType()};e.prototype._computeTargetModified=function(){var e=this.targetItem();return e?a.getFullDisplayDate(e.TimeLastModified):this._modified()};e.prototype._computeTargetContainerPath=function(){var e=this.targetItem();if(e){var t=e.ServerRelativeUrl,i=e.ServerUrl,r=t.lastIndexOf("/");return i+(0<r?t.slice(0,r):t)}};e.prototype._computeTargetContainerName=function(){var e=this.targetItem();if(e){var t=e.ServerRelativeUrl,i=t.lastIndexOf("/"),r=t.lastIndexOf("/",i-1);return t.slice(r+1,i)}};e.dependencies=i.__assign({},r.default.dependencies);return e}(r.default);t.default=n});define("O8",[],function(){return'<div class="InfoPane-section InfoPaneSection--shortcutInformation" data-bind="css: { \'is-expanded\': sectionHelper.isExpanded, \'no-arrow\': !sectionHelper.showArrow }"><div class=InfoPane-sectionHeader data-bind="toggle: sectionHelper.isExpanded, attr: { \'aria-expanded\': sectionHelper.isExpanded(), tabindex: sectionHelper.showArrow ? 0 : -1, role: sectionHelper.showArrow ? \'button\' : \'\' }">\x3c!--ko if: sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e<span class=InfoPane-sectionHeaderText data-bind="text: strings.informationHeader"></span></div><div class="InfoPane-sectionContent InfoPaneSection-shortcutInformation"><table><tbody>\x3c!--ko if: targetFileType()--\x3e<tr><th data-bind="text: strings.informationFiletype"></th><td data-bind="text: targetFileType"></td></tr>\x3c!--/ko--\x3e\x3c!--ko if: targetModified()--\x3e<tr class=InfoPaneSection-information-groupPadding><th data-bind="text: strings.informationModified"></th><td data-bind="text: targetModified"></td></tr>\x3c!--/ko--\x3e\x3c!--ko if: targetContainerPath() && targetContainerName()--\x3e<tr><th data-bind="text: strings.informationPath"></th><td><a class=InfoPaneSection-information-targetPath data-bind="text: targetContainerName, click: targetPathOnClick, attr: { href: targetContainerPath }" target=_blank></a></td></tr>\x3c!--/ko--\x3e\x3c!--ko ifnot: targetContainerPath() && targetContainerName()--\x3e<tr><th data-bind="text: strings.informationPath"></th><td><div data-bind="foreach: { data: path }"><span class=InfoPaneSection-information-path data-bind="text: $data"></span></div></td></tr>\x3c!--/ko--\x3e</tbody></table></div></div>'});define("O7",["c","az"],function(e,t){e.loadStyles([{rawString:".InfoPaneSection-shortcutInformation table{border-spacing:0;width:100%}.InfoPaneSection-shortcutInformation tr:first-child td,.InfoPaneSection-shortcutInformation tr:first-child th{padding-top:0}.InfoPaneSection-shortcutInformation td,.InfoPaneSection-shortcutInformation th{padding:8px 0;width:50%;word-break:break-all}.InfoPaneSection-shortcutInformation th{vertical-align:top;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-weight:400}html[dir=ltr] .InfoPaneSection-shortcutInformation th{text-align:left}html[dir=rtl] .InfoPaneSection-shortcutInformation th{text-align:right}"}])});define("OS",["require","exports","ap","at","OT","N3"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,i=e.resources;return r.createElement(n.default,{sectionControlKey:o.resourceKey,item:t,resources:i})};return t}(r.Component);t.default=a});define("OT",["require","exports","OW","b5","b3","OV","OU"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-policy-tip-section",template:e("OV"),viewModel:i.default,synchronous:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"ms-policy-tip-section",name:e("module").id,template:e("OV"),viewModelType:i.default});t.default=n});define("OW",["require","exports","ap","aC","b4","a0","dZ","ba","sX","qY","oc","O1","OY","c7","bF","OX","d"],function(o,e,t,n,l,d,c,u,p,m,h,f,a,g,i,y,v){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(s){t.__extends(e,s);function e(e,t){void 0===t&&(t={});var i=s.call(this,e,t)||this,o=i._item=e.item;i.viewTipLink=p.strings.policyTipLaunchDialogLink;var r=i.observables,n=i.resources;n.bind(m.resourceKey);i._panelProvider=n.consume(m.resourceKey.local);i._policyTipDataSource=n.consume(c.policyTip);i.isPolicyTipPanelEnabled=u.isFeatureEnabled(u.PolicyTipPanel);i.policyTipMessageBarTagName=f.default.tagName;i.policyTipMessageBarParams={item:o.peek(),onClick:i.onViewTipClick.bind(i)};i.policyTipInfo=r.create(null);if(i.isPolicyTipPanelEnabled){var a=new l.default;r.compute(function(){var e=o();a.debounce(i.trackPromise(i._policyTipDataSource.getPolicyTip(e).then(function(e){i.policyTipInfo(e)})))})}i.backgroundClass=r.pureCompute(function(){var e=o();if(!e||!e.policyTip)return"";var t=y.isPolicyTipFlagSet(e.policyTip,2),i=y.isPolicyTipFlagSet(e.policyTip,1);return t?"od-PolicyTipSection--block":i?"od-PolicyTipSection--notify":void 0});i.iconClass=r.pureCompute(function(){var e=o();if(!e||!e.policyTip)return"";var t=y.isPolicyTipFlagSet(e.policyTip,2),i=y.isPolicyTipFlagSet(e.policyTip,1);return t?v.getIconClassName("DRM")+" ms-fontColor-redDark":i?v.getIconClassName("IncidentTriangle")+" ms-fontColor-orange":void 0});i.text=r.pureCompute(function(){var e=o(),t=h.strings;if(!e||!e.policyTip)return"";var i=y.isPolicyTipFlagSet(e.policyTip,2),r=y.isPolicyTipFlagSet(e.policyTip,1);return i?t.policyTipBlockText:r?t.policyTipNotifyText:void 0});i.hasTip=r.pureCompute(function(){return!!(1&o().policyTip)});i.subscribe(o,function(e){e.policyTip&&d.Engagement.logData({name:"PolicyTip.InfoPaneSection.Shown"})});return i}e.prototype.onViewTipClick=function(t){var i=this,r=this._item.peek();if(!this.isPolicyTipPanelEnabled){d.Engagement.logData({name:"PolicyTip.InfoPaneSection.ViewTip.Click"});g.loadModule({path:"R2",getModule:function(){return new n.default(function(e,t){o(["R2"],e,t)})}}).then(function(e){new(i.resources.injected(e))({item:i.observables.create(r)}).execute(t)});return!1}var e={item:r,policyTipInfo:this.policyTipInfo.peek()};this._panelProvider.requestPanel({component:{name:a.default.tagName,params:e}})};e.dependencies=t.__assign({},i.default.dependencies);return e}(i.default);e.default=r});define("O1",["require","exports","O4","b5","O3","O2"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-policy-tip-message-bar",template:e("O3"),viewModel:i.default,synchronous:!0});t.default=o});define("O4",["require","exports","ap","OX","bF"],function(e,t,i,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this,i=e.item,r=e.onClick;t.item=i;t.onClick=r;var o=i.policyTip,n=l.isPolicyTipFlagSet(o,2),a=l.isPolicyTipFlagSet(o,1);t.isBlock=n;t.isNotify=!n&&a;t.isInfo=!n&&!a;t.hasPolicyTip=t.observables.create(!!o);t.messageBarAction=t.onClick;t.messageBarActionText=l.getPolicyTipActionText();t.messageBarText=l.getPolicyTipText(o);return t}return e}(r.default);t.default=o});define("OX",["require","exports","Br","V"],function(e,t,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPolicyTipActionText=function(){return a.strings.ViewPolicyTip};t.getPolicyTipHeader=function(e){return i.format(a.strings.PolicyTipHeader,"'"+e+"'")};t.getPolicyTipText=function(e,t){var i=a.strings.PolicyTipBlock,r=this.isPolicyTipFlagSet(e,4),o=this.isPolicyTipFlagSet(e,2),n=this.isPolicyTipFlagSet(e,1);r?i=a.strings.PolicyTipNotifyAndBlock:o?i=a.strings.PolicyTipBlock:n&&(i=a.strings.PolicyTipNotify);t&&(i=i+' <a href=";" data-bind="click: '+t+'">'+a.strings.ViewPolicyTip+"</a>");return i};t.isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t}});define("O3",[],function(){return"\x3c!--ko if: hasPolicyTip()--\x3e<div class=od-PolicyTipMessageBar data-bind=\"css: { 'od-PolicyTipMessageBar-block': isBlock, 'od-PolicyTipMessageBar-severeWarning': isNotify, 'od-PolicyTipMessageBar-warning': isInfo }\"><div class=od-PolicyTipMessageBar-content><div class=od-PolicyTipMessageBar-icon><i class=ms-Icon data-bind=\"icon: true, css: { 'ms-Icon--Blocked2': isBlock, 'ms-Icon--Warning': isNotify, 'ms-Icon--Info': isInfo }\"></i></div><div class=od-PolicyTipMessageBar-text><span data-bind=\"text: messageBarText\"></span> <a role=button class=ms-Link href=javascript:; data-bind=\"text: messageBarActionText, click: messageBarAction\"></a></div></div></div>\x3c!--/ko--\x3e"});define("O2",["c","az"],function(e,t){e.loadStyles([{rawString:".od-PolicyTipMessageBar{padding:8px;display:-ms-flexbox;display:flex}.od-PolicyTipMessageBar-content{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row}.od-PolicyTipMessageBar-text{font-size:12px;font-weight:400;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;overflow-x:auto}.od-PolicyTipMessageBar-icon{font-size:16px}[dir=ltr] .od-PolicyTipMessageBar-icon{padding-right:8px}[dir=rtl] .od-PolicyTipMessageBar-icon{padding-left:8px}.od-PolicyTipMessageBar-block{background-color:#fde7e9}.od-PolicyTipMessageBar-block .od-PolicyTipMessageBar-icon{color:#a80000}.od-PolicyTipMessageBar-severeWarning{background-color:#fed9cc}.od-PolicyTipMessageBar-severeWarning .od-PolicyTipMessageBar-icon{color:#d83b01}.od-PolicyTipMessageBar-severeWarning .od-PolicyTipMessageBar-text{color:#333}.od-PolicyTipMessageBar-warning{background-color:#fff4ce}.od-PolicyTipMessageBar-warning .od-PolicyTipMessageBar-icon{color:#333}.od-PolicyTipMessageBar-warning .od-PolicyTipMessageBar-text{color:#333}"}])});define("OY",["require","exports","O0","b5","OZ"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-policy-tip-panel",template:e("OZ"),viewModel:i.default});t.default=o});define("O0",["require","exports","ap","a0","hs","eX","BP","Br","OX","dZ","oq","bF"],function(e,t,i,r,n,a,s,l,d,c,u,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this,i=e.item,r=e.policyTipInfo;t._item=i;t._policyTipInfo=r;t.addBindingHandlers({react:u.default});t._itemProvider=t.resources.consume(a.resourceKey);t._policyTipDataSource=t.resources.consume(c.policyTip);t._showJustificationInput=t.createObservable(!1);t._confirmationText=t.createObservable("").extend({notify:"always"});t.policyTipComponent=s.PolicyTip;t.policyTipComponentProps=t.createPureComputed(t._computePolicyTipComponentParams);return t}e.prototype._computePolicyTipComponentParams=function(){var e=this._confirmationText(),t=this._showJustificationInput(),i=this._getPolicyTipStrings();return{confirmationText:e,onDismissed:this._onDismissed.bind(this),onOverrideClicked:this._onOverrideClicked.bind(this),onOverrideSubmitClicked:this._onOverrideSubmitClicked.bind(this),overrideRequiresJustification:this._policyTipInfo?2===this._policyTipInfo.overrideOption:void 0,showJustificationInput:t,onReportClicked:this._onReportClicked.bind(this),strings:i}};e.prototype._getPolicyTipStrings=function(){var e=this._policyTipInfo;if(!e)return{noPolicyTipInfoError:l.strings.NoPolicyTipInfoError,titleText:d.getPolicyTipHeader(this._item.name),headerText:void 0,issues:void 0,lastScannedText:void 0,learnMoreActionLabel:void 0,learnMoreLabel:void 0,learnMoreUrl:void 0,overrideActionLabel:void 0,overrideLabel:void 0,policyTipDescription:void 0,reportActionLabel:void 0,reportInProgressLabel:void 0,reportLabel:void 0,submitButtonLabel:void 0};var t=1===e.overrideOption||2===e.overrideOption;return{headerText:l.strings.TipIssues,issues:e.issueDescriptions,lastScannedText:e.lastScanned?l.strings.TipLastScanned+": "+n.getRelativeDateTimeStringPast(e.lastScanned):void 0,learnMoreActionLabel:l.strings.LearnMoreActionLabel,learnMoreLabel:l.strings.LearnMoreLabel,learnMoreUrl:e.policyInfoUrl,noPolicyTipInfoError:void 0,overrideActionLabel:t?l.strings.OverrideActionLabel:void 0,overrideLabel:l.strings.OverrideLabel,policyTipDescription:e.explanationText,reportActionLabel:l.strings.ReportActionLabel,reportInProgressLabel:l.strings.ReportInProgress,reportLabel:l.strings.ReportLabel,submitButtonLabel:l.strings.SubmitButtonText,titleText:d.getPolicyTipHeader(this._item.name)}};e.prototype._onReportClicked=function(){var t=this;this._logEngagementEvent("ReportClicked");var e={item:this._item,action:1};this._policyTipDataSource.updatePolicy(e).done(function(e){if(1===e){t._logEngagementEvent("FalsePositiveReported");t._confirmationText(l.strings.ReportConfirmation)}else if(3===e||2===e){t._logEngagementEvent("OverrideWithoutJustification");t._confirmationText(l.strings.OverrideConfirmation)}})};e.prototype._onOverrideClicked=function(){var t=this;this._logEngagementEvent("OverrideClicked");var e=this._policyTipInfo.overrideOption;if(1===e){var i={item:this._item,action:0};this._policyTipDataSource.updatePolicy(i).done(function(e){t._logEngagementEvent("OverrideWithoutJustification");t._confirmationText(l.strings.OverrideConfirmation)})}else if(2===e){this._logEngagementEvent("JustificationInputShown");this._showJustificationInput(!0)}};e.prototype._onOverrideSubmitClicked=function(e){var t=this;this._logEngagementEvent("OverrideSubmitClicked");var i={item:this._item,action:0,justification:e};this._policyTipDataSource.updatePolicy(i).done(function(e){t._logEngagementEvent("OverrideWithJustification");t._confirmationText(l.strings.OverrideConfirmation)})};e.prototype._onDismissed=function(){this._itemProvider.invalidateItem(this._item.parentKey,{triggerFetch:!0})};e.prototype._logEngagementEvent=function(e){r.Engagement.logData({name:"PolicyTipPanel."+e})};return e}(o.default);t.default=p});define("BP",["require","exports","ap","BQ"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("BQ",["require","exports","ap","BR"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("BR",["require","exports","ap","jP","wN","o1","BT","at","V","mo","BS"],function(e,t,r,o,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isLoading:!1,justificationText:"",reportButtonClicked:!1,overrideButtonClicked:!1,overrideSubmitClicked:!1,overrideSubmitDisabled:e.overrideRequiresJustification};return t}e.prototype.componentWillReceiveProps=function(e,t){this.state.isLoading&&e.confirmationText&&this.setState(r.__assign({},this.state,{isLoading:!1}))};e.prototype.componentWillUnmount=function(){this.props.onDismissed()};e.prototype.render=function(){var e=this.props.strings,t=e.noPolicyTipInfoError?l.createElement("div",{className:"od-PolicyTip-container"},l.createElement("span",{className:"od-PolicyTip-error"},e.noPolicyTipInfoError)):l.createElement("div",{className:"od-PolicyTip-container"},l.createElement("span",{className:"od-PolicyTip-description"},e.policyTipDescription),l.createElement("div",{className:"od-PolicyTip-header"},l.createElement(c.Icon,{iconName:"Blocked2",className:"od-PolicyTip-blockedIcon"}),l.createElement("span",{className:"od-PolicyTip-headerText"},e.headerText)),this._renderIssues(),l.createElement("span",{className:"od-PolicyTip-minorText"},e.lastScannedText),this._renderLearnMore(),l.createElement("div",{className:"od-PolicyTip-actions"},this._renderActions()),this._renderJustificationInput(),this._renderStatus());return l.createElement("div",null,l.createElement("h2",{className:"od-PolicyTip-title"},e.titleText),t)};e.prototype._renderIssues=function(){for(var e=[],t=0,i=0,r=this.props.strings.issues;i<r.length;i++){var o=r[i];e.push(l.createElement("span",{className:"od-PolicyTip-issue",key:t++},o))}return e};e.prototype._renderLearnMore=function(){var e=this.props.strings;if(e.learnMoreUrl){var t=l.createElement("a",{href:e.learnMoreUrl,target:"_blank"},e.learnMoreActionLabel),i=d.formatToArray(e.learnMoreLabel,t);return l.createElement("div",{className:"od-PolicyTip-learnMoreContainer od-PolicyTip-minorText"},i)}};e.prototype._getAction=function(e,t,i,r){if(i)return l.createElement("div",{className:"od-PolicyTip-action"},l.createElement("span",null,""+d.format(e,t)));var o=l.createElement("a",{className:"od-PolicyTip-actionLabel",onClick:r,role:"button",href:"javascript:;"},t),n=d.formatToArray(e,o);return l.createElement("div",{className:"od-PolicyTip-action"},n)};e.prototype._renderActions=function(){var e=this.props,t=this.state,i=e.strings,r=[],o=this._getAction(i.reportLabel,i.reportActionLabel,t.reportButtonClicked,this._onReportClicked);r.push(o);if(i.overrideActionLabel){var n=this._getAction(i.overrideLabel,i.overrideActionLabel,t.overrideButtonClicked,this._onOverrideClicked);r.push(n)}return r};e.prototype._renderStatus=function(){var e=this.props;return this.state.isLoading?l.createElement("div",{className:"od-PolicyTip-status"},l.createElement(a.Spinner,null),l.createElement("span",{className:"od-PolicyTip-statusText"},e.strings.reportInProgressLabel)):e.confirmationText?l.createElement("div",{className:"od-PolicyTip-status"},l.createElement(c.Icon,{iconName:"CheckMark"}),l.createElement("span",{className:"od-PolicyTip-statusText"},e.confirmationText)):void 0};e.prototype._renderJustificationInput=function(){var e=this.props,t=this.state;if(e.showJustificationInput)return l.createElement("div",{className:"od-PolicyTip-justificationInputContainer"},l.createElement(s.TextField,{autoAdjustHeight:!0,multiline:!0,onBeforeChange:this._onJustificationChanged,underlined:!0,resizable:!1}),!t.overrideSubmitClicked&&l.createElement(n.PrimaryButton,{className:"od-PolicyTip-submitButton",disabled:t.overrideSubmitDisabled,onClick:this._onOverrideSubmitClicked},e.strings.submitButtonLabel))};e.prototype._onReportClicked=function(){var e=this;this.setState(r.__assign({},this.state,{isLoading:!0,reportButtonClicked:!0}),function(){e.props.onReportClicked()})};e.prototype._onOverrideClicked=function(){var e=this;this.setState(r.__assign({},this.state,{overrideButtonClicked:!0}),function(){e.props.onOverrideClicked()})};e.prototype._onOverrideSubmitClicked=function(){var e=this;this.setState(r.__assign({},this.state,{isLoading:!0,overrideSubmitClicked:!0}),function(){e.props.onOverrideSubmitClicked(e.state.justificationText)})};e.prototype._onJustificationChanged=function(e){this.props.overrideRequiresJustification&&this.setState(r.__assign({},this.state,{justificationText:e,overrideSubmitDisabled:!e}))};r.__decorate([o.autobind],e.prototype,"_onReportClicked",null);r.__decorate([o.autobind],e.prototype,"_onOverrideClicked",null);r.__decorate([o.autobind],e.prototype,"_onOverrideSubmitClicked",null);r.__decorate([o.autobind],e.prototype,"_onJustificationChanged",null);return e}(o.BaseComponent);t.PolicyTip=i});define("BT",["require","exports","ap","BU"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("BU",["require","exports","ap","BX","BV"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("BX",["require","exports","ap","at","BZ","mo","jP","BY","d"],function(e,t,T,w,r,E,D,i,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var M=i,o=function(i){T.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._textElement=D.createRef();t._onRenderLabel=function(e){return e.label?w.createElement(r.Label,{htmlFor:t._id},e.label):null};t._onRenderDescription=function(e){return e.description?w.createElement("span",{className:D.css("ms-TextField-description",M.description)},e.description):null};t._warnDeprecations({iconClass:"iconProps",addonString:"prefix",onRenderAddon:"onRenderPrefix"});t._warnMutuallyExclusive({value:"defaultValue"});t._id=D.getId("TextField");t._descriptionId=D.getId("TextFieldDescription");t._latestValue=e.value||e.defaultValue||"";t.state={value:t._latestValue,isFocused:!1,errorMessage:""};t._onInputChange=t._onInputChange.bind(t);t._onFocus=t._onFocus.bind(t);t._onBlur=t._onBlur.bind(t);t._delayedValidate=t._async.debounce(t._validate,t.props.deferredValidationTime);t._lastValidation=0;t._isDescriptionAvailable=!1;return t}Object.defineProperty(e.prototype,"value",{get:function(){return this.state.value},enumerable:!0,configurable:!0});e.prototype.componentDidMount=function(){this._isMounted=!0;this._adjustInputHeight();this.props.validateOnLoad&&this._validate(this.state.value)};e.prototype.componentWillReceiveProps=function(e){var t=this,i=this.props.onBeforeChange;if(void 0!==e.value&&e.value!==this.state.value){i&&i(e.value);this._latestValue=e.value;this.setState({value:e.value,errorMessage:""},function(){t._adjustInputHeight()});this._delayedValidate(e.value)}};e.prototype.componentWillUnmount=function(){this._isMounted=!1};e.prototype.render=function(){var e=this.props,t=e.className,i=e.description,r=e.disabled,o=e.iconClass,n=e.iconProps,a=e.multiline,s=e.required,l=e.underlined,d=e.borderless,c=e.addonString,u=e.prefix,p=e.suffix,m=e.onRenderAddon,h=void 0===m?this._onRenderAddon:m,f=e.onRenderPrefix,g=void 0===f?this._onRenderPrefix:f,y=e.onRenderSuffix,v=void 0===y?this._onRenderSuffix:y,_=e.onRenderLabel,b=void 0===_?this._onRenderLabel:_,x=e.onRenderDescription,S=void 0===x?this._onRenderDescription:x,C=this.state.isFocused,P=this._errorMessage;this._isDescriptionAvailable=Boolean(i||P);var k,I=D.css("ms-TextField",M.root,t,((k={})["is-required "+M.rootIsRequiredLabel]=this.props.label&&s,k["is-required "+M.rootIsRequiredPlaceholderOnly]=!this.props.label&&s,k["is-disabled "+M.rootIsDisabled]=r,k["is-active "+M.rootIsActive]=C,k["ms-TextField--multiline "+M.rootIsMultiline]=a,k["ms-TextField--underlined "+M.rootIsUnderlined]=l,k["ms-TextField--borderless "+M.rootIsBorderless]=d,k));return w.createElement("div",{className:I},w.createElement("div",{className:D.css("ms-TextField-wrapper",M.wrapper,l?P&&M.invalid:"")},b(this.props,this._onRenderLabel),w.createElement("div",{className:D.css("ms-TextField-fieldGroup",M.fieldGroup,C&&M.fieldGroupIsFocused,P&&M.invalid)},(void 0!==c||this.props.onRenderAddon)&&w.createElement("div",{className:D.css("ms-TextField-prefix",M.fieldPrefixSuffix)},h(this.props,this._onRenderAddon)),(void 0!==u||this.props.onRenderPrefix)&&w.createElement("div",{className:D.css("ms-TextField-prefix",M.fieldPrefixSuffix)},g(this.props,this._onRenderPrefix)),a?this._renderTextArea():this._renderInput(),(o||n)&&w.createElement(E.Icon,T.__assign({className:D.css(o,M.icon)},n)),(void 0!==p||this.props.onRenderSuffix)&&w.createElement("div",{className:D.css("ms-TextField-suffix",M.fieldPrefixSuffix)},v(this.props,this._onRenderSuffix)))),this._isDescriptionAvailable&&w.createElement("span",{id:this._descriptionId},S(this.props,this._onRenderDescription),P&&w.createElement("div",{"aria-live":"assertive"},w.createElement(D.DelayedRender,null,w.createElement("p",{className:D.css("ms-TextField-errorMessage",A.AnimationClassNames.slideDownIn20,M.errorMessage)},w.createElement("span",{className:M.errorText,"data-automation-id":"error-message"},P))))))};e.prototype.focus=function(){this._textElement.current&&this._textElement.current.focus()};e.prototype.select=function(){this._textElement.current&&this._textElement.current.select()};e.prototype.setSelectionStart=function(e){this._textElement.current&&(this._textElement.current.selectionStart=e)};e.prototype.setSelectionEnd=function(e){this._textElement.current&&(this._textElement.current.selectionEnd=e)};Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this._textElement.current?this._textElement.current.selectionStart:-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this._textElement.current?this._textElement.current.selectionEnd:-1},enumerable:!0,configurable:!0});e.prototype.setSelectionRange=function(e,t){this._textElement.current&&this._textElement.current.setSelectionRange(e,t)};e.prototype._onFocus=function(e){this.props.onFocus&&this.props.onFocus(e);this.setState({isFocused:!0});this.props.validateOnFocusIn&&this._validate(this.state.value)};e.prototype._onBlur=function(e){this.props.onBlur&&this.props.onBlur(e);this.setState({isFocused:!1});this.props.validateOnFocusOut&&this._validate(this.state.value)};e.prototype._onRenderAddon=function(e){var t=e.addonString;return w.createElement("span",{style:{paddingBottom:"1px"}},t)};e.prototype._onRenderPrefix=function(e){var t=e.prefix;return w.createElement("span",{style:{paddingBottom:"1px"}},t)};e.prototype._onRenderSuffix=function(e){var t=e.suffix;return w.createElement("span",{style:{paddingBottom:"1px"}},t)};e.prototype._getTextElementClassName=function(){var e,t;e=this.props.multiline&&!this.props.resizable?D.css("ms-TextField-field ms-TextField-field--unresizable",M.field,M.fieldIsUnresizable):D.css("ms-TextField-field",M.field);return D.css(e,this.props.inputClassName,((t={})[M.hasIcon]=!!this.props.iconClass,t))};Object.defineProperty(e.prototype,"_errorMessage",{get:function(){var e=this.state.errorMessage;e||(e=this.props.errorMessage);return e},enumerable:!0,configurable:!0});e.prototype._renderTextArea=function(){var e=D.getNativeProps(this.props,D.textAreaProperties,["defaultValue"]);return w.createElement("textarea",T.__assign({id:this._id},e,{ref:this._textElement,value:this.state.value,onInput:this._onInputChange,onChange:this._onInputChange,className:this._getTextElementClassName(),"aria-describedby":this._isDescriptionAvailable?this._descriptionId:void 0,"aria-invalid":!!this.state.errorMessage,"aria-label":this.props.ariaLabel,onFocus:this._onFocus,onBlur:this._onBlur}))};e.prototype._renderInput=function(){var e=D.getNativeProps(this.props,D.inputProperties,["defaultValue"]);return w.createElement("input",T.__assign({type:"text",id:this._id},e,{ref:this._textElement,value:this.state.value,onInput:this._onInputChange,onChange:this._onInputChange,className:this._getTextElementClassName(),"aria-label":this.props.ariaLabel,"aria-describedby":this._isDescriptionAvailable?this._descriptionId:void 0,"aria-invalid":!!this.state.errorMessage,onFocus:this._onFocus,onBlur:this._onBlur}))};e.prototype._onInputChange=function(e){var t=this,i=e.target.value;if(i!==this._latestValue){this._latestValue=i;this.setState({value:i,errorMessage:""},function(){t._adjustInputHeight();t.props.onChanged&&t.props.onChanged(i)});var r=this.props,o=r.validateOnFocusIn,n=r.validateOnFocusOut;o||n||this._delayedValidate(i);(0,this.props.onBeforeChange)(i)}};e.prototype._validate=function(t){var i=this,e=this.props,r=e.validateOnFocusIn,o=e.validateOnFocusOut;if(this._latestValidateValue!==t||r||o){this._latestValidateValue=t;var n=(0,this.props.onGetErrorMessage)(t||"");if(void 0!==n)if("string"==typeof n){this.setState({errorMessage:n});this._notifyAfterValidate(t,n)}else{var a=++this._lastValidation;n.then(function(e){i._isMounted&&a===i._lastValidation&&i.setState({errorMessage:e});i._notifyAfterValidate(t,e)})}else this._notifyAfterValidate(t,"")}};e.prototype._notifyAfterValidate=function(e,t){this._isMounted&&e===this.state.value&&this.props.onNotifyValidationResult&&this.props.onNotifyValidationResult(t,e)};e.prototype._adjustInputHeight=function(){if(this._textElement.current&&this.props.autoAdjustHeight&&this.props.multiline){var e=this._textElement.current;e.style.height="";var t=e.scrollHeight+2;e.style.height=t+"px"}};e.defaultProps={multiline:!1,resizable:!0,autoAdjustHeight:!1,underlined:!1,borderless:!1,onChanged:function(){},onBeforeChange:function(){},onNotifyValidationResult:function(){},onGetErrorMessage:function(){},deferredValidationTime:200,errorMessage:"",validateOnFocusIn:!1,validateOnFocusOut:!1,validateOnLoad:!0};return e}(D.BaseComponent);t.TextField=o});define("BZ",["require","exports","ap","B0"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("B0",["require","exports","ap","B1"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("B1",["require","exports","ap","at","jP","B2"],function(e,t,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){a.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.disabled,i=e.required,r=e.children,o=e.className,n=e.theme;return s.createElement("label",a.__assign({},l.getNativeProps(this.props,l.divProperties),{className:d.getLabelClassNames(n,o,!!t,!!i).root}),r)};return t=a.__decorate([l.customizable("Label",["theme"])],t)}(l.BaseComponent);t.Label=i});define("B2",["require","exports","jP","d"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getLabelClassNames=i.memoizeFunction(function(e,t,i,r){return n.mergeStyleSets({root:["ms-Label",{color:e.semanticColors.bodyText,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},i&&{color:e.semanticColors.disabledBodyText,selectors:(o={},o[n.HighContrastSelector]={color:"GrayText"},o)},r&&{selectors:{"::after":{content:"' *'",color:e.semanticColors.errorText,paddingRight:12}}},t]});var o})});define("BY",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_16260cda{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0;position:relative}.screenReaderOnly_16260cda{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.fieldGroup_16260cda{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0;border:1px solid "},{theme:"inputBorder",defaultValue:"#a6a6a6"},{rawString:";background:"},{theme:"inputBackground",defaultValue:"#ffffff"},{rawString:";height:32px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;position:relative}.fieldGroup_16260cda:hover{border-color:"},{theme:"inputBorderHovered",defaultValue:"#212121"},{rawString:"}.fieldGroup_16260cda.fieldGroupIsFocused_16260cda{border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast: active){.fieldGroup_16260cda.fieldGroupIsFocused_16260cda{border-width:2px}.fieldGroup_16260cda.fieldGroupIsFocused_16260cda .field_16260cda{padding:0 11px 0 11px}[dir='rtl'] .fieldGroup_16260cda.fieldGroupIsFocused_16260cda .field_16260cda{padding:0 11px 0 11px}}.fieldGroup_16260cda.fieldGroupIsFocused_16260cda.invalid_16260cda{border-color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:"}.rootIsDisabled_16260cda .fieldGroup_16260cda{background-color:"},{theme:"disabledBackground",defaultValue:"#f4f4f4"},{rawString:";border-color:"},{theme:"disabledBackground",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast: active){.fieldGroup_16260cda:hover,.fieldGroup_16260cda.fieldGroupIsFocused_16260cda{border-color:Highlight}}.fieldGroup_16260cda::-ms-clear{display:none}.fieldGroup_16260cda :-ms-input-placeholder,.fieldGroup_16260cda :-ms-input-placeholder{color:"},{theme:"inputPlaceholderText",defaultValue:"#666666"},{rawString:";opacity:1}.fieldGroup_16260cda ::-ms-input-placeholder,.fieldGroup_16260cda :-ms-input-placeholder{color:"},{theme:"inputPlaceholderText",defaultValue:"#666666"},{rawString:";opacity:1}.fieldGroup :-ms-input-placeholder,.fieldGroup :-ms-input-placeholder{color:"},{theme:"inputPlaceholderText",defaultValue:"#666666"},{rawString:";opacity:1}.fieldGroup ::-ms-input-placeholder,.fieldGroup :-ms-input-placeholder{color:"},{theme:"inputPlaceholderText",defaultValue:"#666666"},{rawString:";opacity:1}.fieldGroup_16260cda ::placeholder,.fieldGroup_16260cda :-ms-input-placeholder{color:"},{theme:"inputPlaceholderText",defaultValue:"#666666"},{rawString:";opacity:1}.root_16260cda.rootIsDisabled_16260cda .field{background-color:"},{theme:"disabledBackground",defaultValue:"#f4f4f4"},{rawString:";border-color:"},{theme:"disabledBackground",defaultValue:"#f4f4f4"},{rawString:"}.fieldPrefixSuffix_16260cda{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;line-height:1;padding:0 10px;white-space:nowrap}.field_16260cda{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0;font-size:14px;border-radius:0;border:none;background:none;color:"},{theme:"bodyText",defaultValue:"#333333"},{rawString:";padding:0 12px 0 12px;width:100%;min-width:0;text-overflow:ellipsis;outline:0}[dir='rtl'] .field_16260cda{padding:0 12px 0 12px}.field_16260cda:active,.field_16260cda:focus,.field_16260cda:hover{outline:0}[dir='ltr'] .field_16260cda.hasIcon_16260cda{padding-right:24px}[dir='rtl'] .field_16260cda.hasIcon_16260cda{padding-left:24px}.field_16260cda[disabled]{background-color:transparent;border-color:transparent}.field_16260cda .field_16260cda::-webkit-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field_16260cda .field_16260cda:-ms-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field_16260cda .field_16260cda::-ms-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field .field::-webkit-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field .field:-ms-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field .field::-ms-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field_16260cda .field_16260cda::placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.root_16260cda.rootIsRequiredLabel_16260cda .ms-Label::after{content:' *';color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.root_16260cda.rootIsRequiredPlaceholderOnly_16260cda .ms-TextField-fieldGroup::after{content:'*';color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";position:absolute;top:-5px}[dir='ltr'] .root_16260cda.rootIsRequiredPlaceholderOnly_16260cda .ms-TextField-fieldGroup::after{right:-10px}[dir='rtl'] .root_16260cda.rootIsRequiredPlaceholderOnly_16260cda .ms-TextField-fieldGroup::after{left:-10px}.root_16260cda.rootIsActive_16260cda{border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_16260cda.rootIsActive_16260cda{border-width:2px}.root_16260cda.rootIsActive_16260cda .field_16260cda{padding:0 11px 0 11px}[dir='rtl'] .root_16260cda.rootIsActive_16260cda .field_16260cda{padding:0 11px 0 11px}}.icon_16260cda{pointer-events:none;position:absolute;bottom:5px;top:auto;font-size:16px;line-height:18px}html[dir='ltr'] .icon_16260cda{right:8px}html[dir='rtl'] .icon_16260cda{left:8px}.description_16260cda{color:"},{theme:"bodySubtext",defaultValue:"#666666"},{rawString:";font-size:11px}.rootIsBorderless_16260cda .fieldGroup_16260cda{border-color:transparent;border-width:0}.root_16260cda.rootIsUnderlined_16260cda{border:0px solid "},{theme:"inputBorder",defaultValue:"#a6a6a6"},{rawString:"}.root_16260cda.rootIsUnderlined_16260cda .wrapper_16260cda{display:-webkit-box;display:-ms-flexbox;display:flex;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:inherit;width:100%}.root_16260cda.rootIsUnderlined_16260cda .wrapper_16260cda.invalid_16260cda,.root_16260cda.rootIsUnderlined_16260cda .wrapper_16260cda.invalid_16260cda:focus,.root_16260cda.rootIsUnderlined_16260cda .wrapper_16260cda.invalid_16260cda:hover{border-bottom:1px solid "},{theme:"errorText",defaultValue:"#a80000"},{rawString:"}.root_16260cda.rootIsUnderlined_16260cda .ms-Label{font-size:14px;line-height:22px;height:32px}[dir='ltr'] .root_16260cda.rootIsUnderlined_16260cda .ms-Label{margin-right:8px}[dir='rtl'] .root_16260cda.rootIsUnderlined_16260cda .ms-Label{margin-left:8px}[dir='ltr'] .root_16260cda.rootIsUnderlined_16260cda .ms-Label{padding-left:12px}[dir='rtl'] .root_16260cda.rootIsUnderlined_16260cda .ms-Label{padding-right:12px}.root_16260cda.rootIsUnderlined_16260cda .fieldGroup_16260cda{-webkit-box-flex:1;-ms-flex:1 1 0px;flex:1 1 0px;border-width:0}[dir='ltr'] .root_16260cda.rootIsUnderlined_16260cda .fieldGroup_16260cda{text-align:left}[dir='rtl'] .root_16260cda.rootIsUnderlined_16260cda .fieldGroup_16260cda{text-align:right}.root_16260cda.rootIsUnderlined_16260cda.rootIsDisabled_16260cda{border-color:"},{theme:"disabledBackground",defaultValue:"#f4f4f4"},{rawString:"}.root_16260cda.rootIsUnderlined_16260cda.rootIsDisabled_16260cda .ms-Label{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.root_16260cda.rootIsUnderlined_16260cda.rootIsDisabled_16260cda .field_16260cda{background-color:transparent;color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.root_16260cda.rootIsUnderlined_16260cda.rootIsDisabled_16260cda .fieldGroup_16260cda{background-color:transparent}.root_16260cda.rootIsUnderlined_16260cda:hover:not(.rootIsActive_16260cda):not(.rootIsDisabled_16260cda){border-color:"},{theme:"inputBorderHovered",defaultValue:"#212121"},{rawString:"}.root_16260cda.rootIsUnderlined_16260cda.rootIsActive_16260cda{border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_16260cda.rootIsUnderlined_16260cda.rootIsActive_16260cda{border-width:2px}.root_16260cda.rootIsUnderlined_16260cda.rootIsActive_16260cda .field_16260cda{padding:0 11px 0 11px}[dir='rtl'] .root_16260cda.rootIsUnderlined_16260cda.rootIsActive_16260cda .field_16260cda{padding:0 11px 0 11px}}@media screen and (-ms-high-contrast: active){.root_16260cda.rootIsUnderlined_16260cda:hover:not(.rootIsDisabled_16260cda) .wrapper_16260cda,.root_16260cda.rootIsUnderlined_16260cda.rootIsActive_16260cda .wrapper_16260cda{border-color:Highlight}}.root_16260cda.rootIsMultiline_16260cda .fieldGroup_16260cda{min-height:60px;height:auto;display:-webkit-box;display:-ms-flexbox;display:flex}.root_16260cda.rootIsMultiline_16260cda .field_16260cda{line-height:17px;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding-top:6px;overflow:auto;width:100%}[dir='ltr'] .root_16260cda.rootIsMultiline_16260cda .field_16260cda.hasIcon_16260cda{padding-right:40px}[dir='rtl'] .root_16260cda.rootIsMultiline_16260cda .field_16260cda.hasIcon_16260cda{padding-left:40px}.errorMessage_16260cda{font-size:12px;font-weight:400;color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:";margin:0;padding-top:5px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.invalid_16260cda,.invalid_16260cda:focus,.invalid_16260cda:hover{border-color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:"}[dir='ltr'] .root_16260cda.rootIsUnderlined_16260cda .ms-Label{padding-left:12px}[dir='rtl'] .root_16260cda.rootIsUnderlined_16260cda .ms-Label{padding-right:12px}[dir='ltr'] .root_16260cda.rootIsUnderlined_16260cda .ms-Label{padding-right:0}[dir='rtl'] .root_16260cda.rootIsUnderlined_16260cda .ms-Label{padding-left:0}html[dir='ltr'] .root_16260cda.rootIsUnderlined_16260cda .field_16260cda{text-align:left}html[dir='rtl'] .root_16260cda.rootIsUnderlined_16260cda .field_16260cda{text-align:right}.root_16260cda.rootIsMultiline_16260cda .icon_16260cda{padding-bottom:8px;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}[dir='ltr'] .root_16260cda.rootIsMultiline_16260cda .icon_16260cda{padding-right:24px}[dir='rtl'] .root_16260cda.rootIsMultiline_16260cda .icon_16260cda{padding-left:24px}.root_16260cda.rootIsMultiline_16260cda .field_16260cda.fieldIsUnresizable_16260cda{resize:none}.hidden_16260cda{display:none}\n"}]);t.root="root_16260cda";t.screenReaderOnly="screenReaderOnly_16260cda";t.fieldGroup="fieldGroup_16260cda";t.fieldGroupIsFocused="fieldGroupIsFocused_16260cda";t.field="field_16260cda";t.invalid="invalid_16260cda";t.rootIsDisabled="rootIsDisabled_16260cda";t.fieldPrefixSuffix="fieldPrefixSuffix_16260cda";t.hasIcon="hasIcon_16260cda";t.rootIsRequiredLabel="rootIsRequiredLabel_16260cda";t.rootIsRequiredPlaceholderOnly="rootIsRequiredPlaceholderOnly_16260cda";t.rootIsActive="rootIsActive_16260cda";t.icon="icon_16260cda";t.description="description_16260cda";t.rootIsBorderless="rootIsBorderless_16260cda";t.rootIsUnderlined="rootIsUnderlined_16260cda";t.wrapper="wrapper_16260cda";t.rootIsMultiline="rootIsMultiline_16260cda";t.errorMessage="errorMessage_16260cda";t.fieldIsUnresizable="fieldIsUnresizable_16260cda";t.hidden="hidden_16260cda"});define("BV",["require","exports","ap","at","BX","jP","BW"],function(e,t,r,o,n,a,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_MASK_CHAR="_";var f;!function(e){e[e.default=0]="default";e[e.backspace=1]="backspace";e[e.delete=2]="delete";e[e.textPasted=3]="textPasted"}(f||(f={}));var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._shouldUpdateComponentRef=!1;t._maskCharData=h.parseMask(e.mask,e.maskFormat);e.value&&t.setValue(e.value);t._isFocused=!1;t._moveCursorOnMouseUp=!1;t.state={displayValue:h.getMaskDisplay(e.mask,t._maskCharData,e.maskChar)};return t}e.prototype.componentWillReceiveProps=function(e){if(e.mask!==this.props.mask){this._maskCharData=h.parseMask(e.mask,e.maskFormat);this.state={displayValue:h.getMaskDisplay(e.mask,this._maskCharData,e.maskChar)}}};e.prototype.componentDidUpdate=function(){this.state.maskCursorPosition&&this._textField.setSelectionRange(this.state.maskCursorPosition,this.state.maskCursorPosition)};e.prototype.render=function(){return o.createElement(n.TextField,r.__assign({},this.props,{onFocus:this._onFocus,onBlur:this._onBlur,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onChanged:this._onInputChange,onBeforeChange:this._onBeforeChange,onKeyDown:this._onKeyDown,onPaste:this._onPaste,value:this.state.displayValue,ref:this._resolveRef("_textField")}))};Object.defineProperty(e.prototype,"value",{get:function(){for(var e="",t=0;t<this._maskCharData.length;t++){if(!this._maskCharData[t].value)return;e+=this._maskCharData[t].value}return e},enumerable:!0,configurable:!0});e.prototype.setValue=function(e){for(var t=0,i=0;t<e.length&&i<this._maskCharData.length;){var r=e[t];if(this._maskCharData[i].format.test(r)){this._maskCharData[i].value=r;i++}t++}};e.prototype.focus=function(){this._textField&&this._textField.focus()};e.prototype.select=function(){this._textField&&this._textField.select()};e.prototype.setSelectionStart=function(e){this._textField&&this._textField.setSelectionStart(e)};e.prototype.setSelectionEnd=function(e){this._textField&&this._textField.setSelectionEnd(e)};e.prototype.setSelectionRange=function(e,t){this._textField&&this._textField.setSelectionRange(e,t)};Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this._textField&&null!==this._textField.selectionStart?this._textField.selectionStart:-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this._textField&&this._textField.selectionEnd?this._textField.selectionEnd:-1},enumerable:!0,configurable:!0});e.prototype._onFocus=function(e){var t=this.props.onFocus;t&&t(e);this._isFocused=!0;for(var i=0;i<this._maskCharData.length;i++)if(!this._maskCharData[i].value){this.setState({maskCursorPosition:this._maskCharData[i].displayIndex});break}};e.prototype._onBlur=function(e){var t=this.props.onBlur;t&&t(e);this._isFocused=!1;this._moveCursorOnMouseUp=!0};e.prototype._onMouseDown=function(e){this._isFocused||(this._moveCursorOnMouseUp=!0)};e.prototype._onMouseUp=function(e){if(this._moveCursorOnMouseUp){this._moveCursorOnMouseUp=!1;for(var t=0;t<this._maskCharData.length;t++)if(!this._maskCharData[t].value){this.setState({maskCursorPosition:this._maskCharData[t].displayIndex});break}}};e.prototype._onBeforeChange=function(e){null===this._changeSelectionData&&(this._changeSelectionData={changeType:f.default,selectionStart:null!==this._textField.selectionStart?this._textField.selectionStart:-1,selectionEnd:null!==this._textField.selectionEnd?this._textField.selectionEnd:-1})};e.prototype._onInputChange=function(e){if(this._changeSelectionData){var t=this.state.displayValue,i=0,r=this._changeSelectionData,o=r.changeType,n=r.selectionStart,a=r.selectionEnd;if(o===f.textPasted){var s=a-n,l=e.length+s-t.length,d=n,c=e.substr(d,l);s&&(this._maskCharData=h.clearRange(this._maskCharData,n,s));i=h.insertString(this._maskCharData,d,c)}else if(o===f.delete||o===f.backspace){var u=o===f.delete;if(l=a-n){this._maskCharData=h.clearRange(this._maskCharData,n,l);i=h.getRightFormatIndex(this._maskCharData,n)}else if(u){this._maskCharData=h.clearNext(this._maskCharData,n);i=h.getRightFormatIndex(this._maskCharData,n)}else{this._maskCharData=h.clearPrev(this._maskCharData,n);i=h.getLeftFormatIndex(this._maskCharData,n)}}else if(e.length>t.length){d=a-(l=e.length-t.length);var p=e.substr(d,l);i=h.insertString(this._maskCharData,d,p)}else if(e.length<=t.length){l=1;var m=t.length+l-e.length;d=a-l,p=e.substr(d,l);this._maskCharData=h.clearRange(this._maskCharData,d,m);i=h.insertString(this._maskCharData,d,p)}this._changeSelectionData=null;this.setState({displayValue:h.getMaskDisplay(this.props.mask,this._maskCharData,this.props.maskChar),maskCursorPosition:i})}};e.prototype._onKeyDown=function(e){this._changeSelectionData=null;if(this._textField.value){var t=e.keyCode,i=e.ctrlKey,r=e.metaKey;if(i||r)return;if(8===t||46===t){var o=e.target.selectionStart,n=e.target.selectionEnd;if(!(8===t&&n&&0<n||46===t&&null!==o&&o<this._textField.value.length))return;this._changeSelectionData={changeType:8===t?f.backspace:f.delete,selectionStart:null!==o?o:-1,selectionEnd:null!==n?n:-1}}}};e.prototype._onPaste=function(e){var t=e.target.selectionStart,i=e.target.selectionEnd;this._changeSelectionData={changeType:f.textPasted,selectionStart:null!==t?t:-1,selectionEnd:null!==i?i:-1}};e.defaultProps={maskChar:t.DEFAULT_MASK_CHAR,maskFormat:h.DEFAULT_MASK_FORMAT_CHARS};r.__decorate([a.autobind],e.prototype,"_onFocus",null);r.__decorate([a.autobind],e.prototype,"_onBlur",null);r.__decorate([a.autobind],e.prototype,"_onMouseDown",null);r.__decorate([a.autobind],e.prototype,"_onMouseUp",null);r.__decorate([a.autobind],e.prototype,"_onBeforeChange",null);r.__decorate([a.autobind],e.prototype,"_onInputChange",null);r.__decorate([a.autobind],e.prototype,"_onKeyDown",null);r.__decorate([a.autobind],e.prototype,"_onPaste",null);return e}(a.BaseComponent);t.MaskedTextField=i});define("BW",["require","exports"],function(e,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});s.DEFAULT_MASK_FORMAT_CHARS={9:/[0-9]/,a:/[a-zA-Z]/,"*":/[a-zA-Z0-9]/};s.parseMask=function(e,t){void 0===t&&(t=s.DEFAULT_MASK_FORMAT_CHARS);if(!e)return[];for(var i=[],r=0,o=0;o+r<e.length;o++){var n=e.charAt(o+r);if("\\"===n)r++;else{var a=t[n];a&&i.push({displayIndex:o,format:a})}}return i};s.getMaskDisplay=function(e,t,i){var r=e;if(!r)return"";r=r.replace(/\\/g,"");var o=0;0<t.length&&(o=t[0].displayIndex-1);for(var n=0,a=t;n<a.length;n++){var s=a[n],l=" ";if(s.value){l=s.value;s.displayIndex>o&&(o=s.displayIndex)}else i&&(l=i);r=r.slice(0,s.displayIndex)+l+r.slice(s.displayIndex+1)}i||(r=r.slice(0,o+1));return r};s.getRightFormatIndex=function(e,t){for(var i=0;i<e.length;i++)if(e[i].displayIndex>=t)return e[i].displayIndex;return e[e.length-1].displayIndex};s.getLeftFormatIndex=function(e,t){for(var i=e.length-1;0<=i;i--)if(e[i].displayIndex<t)return e[i].displayIndex;return e[0].displayIndex};s.clearRange=function(e,t,i){for(var r=0;r<e.length;r++)if(e[r].displayIndex>=t){if(e[r].displayIndex>=t+i)break;e[r].value=void 0}return e};s.clearNext=function(e,t){for(var i=0;i<e.length;i++)if(e[i].displayIndex>=t){e[i].value=void 0;break}return e};s.clearPrev=function(e,t){for(var i=e.length-1;0<=i;i--)if(e[i].displayIndex<t){e[i].value=void 0;break}return e};s.insertString=function(e,t,i){for(var r=0,o=0,n=0;n<e.length&&r<i.length;n++)if(e[n].displayIndex>=t){o=e[n].displayIndex;for(;r<i.length;){if(e[n].format.test(i.charAt(r))){e[n].value=i.charAt(r++);n+1<e.length?o=e[n+1].displayIndex:o++;break}r++}}return o}});define("BS",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".od-PolicyTip-container{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-PolicyTip-title{font-size:21px;font-weight:100;margin:0 0 8px 0}.od-PolicyTip-description{font-size:14px;font-weight:400;margin-top:20px}.od-PolicyTip-header{display:-ms-flexbox;display:flex;margin:20px 0}.od-PolicyTip-blockedIcon{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:21px;padding-top:2px}.od-PolicyTip-headerText{font-size:17px;font-weight:300;font-weight:600}[dir=ltr] .od-PolicyTip-headerText{margin-left:12px}[dir=rtl] .od-PolicyTip-headerText{margin-right:12px}.od-PolicyTip-issue{font-size:14px;font-weight:400;margin-bottom:12px}[dir=ltr] .od-PolicyTip-issue{margin-left:33px}[dir=rtl] .od-PolicyTip-issue{margin-right:33px}.od-PolicyTip-minorText{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-PolicyTip-learnMoreContainer{display:-ms-flexbox;display:flex}[dir=ltr] .od-PolicyTip-learnMoreContainer a{padding-right:4px}[dir=rtl] .od-PolicyTip-learnMoreContainer a{padding-left:4px}.od-PolicyTip-actions{margin-top:60px}.od-PolicyTip-action{font-size:12px;font-weight:400;margin-bottom:8px}.od-PolicyTip-actionLabel{font-weight:600;cursor:pointer}[dir=ltr] .od-PolicyTip-label{margin-left:4px}[dir=rtl] .od-PolicyTip-label{margin-right:4px}.od-PolicyTip-status{display:-ms-flexbox;display:flex;margin-top:34px;margin-bottom:8px}.od-PolicyTip-status{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PolicyTip-statusText{font-size:12px;font-weight:400}[dir=ltr] .od-PolicyTip-statusText{margin-left:4px}[dir=rtl] .od-PolicyTip-statusText{margin-right:4px}.od-PolicyTip-submitButton{margin-top:8px}.od-PolicyTip-error{margin-top:36px;font-size:17px;font-weight:300}"}])});define("OZ",[],function(){return'<div data-bind="react: { componentType: policyTipComponent, props: policyTipComponentProps }"></div>'});define("OV",[],function(){return'<div class="od-PolicyTipSection InfoPane-section is-expanded">\x3c!--ko if: !isPolicyTipPanelEnabled--\x3e<div class=InfoPane-sectionContent data-bind="css: backgroundClass"><i class="od-PolicyTipSection-icon ms-Icon" data-bind="css: iconClass"></i><div class=od-PolicyTipSection-text><span data-bind="text: text"></span>\x3c!--ko if: hasTip--\x3e<br><a href=javascript: data-bind="click: onViewTipClick, text: viewTipLink"></a>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if: isPolicyTipPanelEnabled && policyTipInfo()--\x3e\x3c!--ko component: {\r\n name: policyTipMessageBarTagName,\r\n params: policyTipMessageBarParams\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: \'ms-panel-host\' }--\x3e\x3c!--/ko--\x3e</div>'});define("OU",["c","az"],function(e,t){e.loadStyles([{rawString:"[dir=ltr] .od-PolicyTipSection.InfoPane-section{padding-left:20px}[dir=rtl] .od-PolicyTipSection.InfoPane-section{padding-right:20px}.od-PolicyTipSection .InfoPane-sectionContent{padding:8px}.od-PolicyTipSection--notify{background-color:rgba(216,59,1,.2)}.od-PolicyTipSection--block{background-color:rgba(232,17,35,.2)}.od-PolicyTipSection-icon{padding-top:2px;font-size:17px}html[dir=ltr] .od-PolicyTipSection-icon{float:left}html[dir=rtl] .od-PolicyTipSection-icon{float:right}[dir=ltr] .od-PolicyTipSection-text{margin-left:25px}[dir=rtl] .od-PolicyTipSection-text{margin-right:25px}"}])});define("N2",["require","exports","ap","at","N6","N3"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,i=e.resources;return r.createElement(n.default,{sectionControlKey:o.resourceKey,item:t,resources:i})};return t}(r.Component);t.default=a});define("N6",["require","exports","OI","b5","b3","OH","LB","Os","N7"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-sharing-info-pane-section",template:e("OH"),viewModel:i.default,synchronous:!0});t.resourceKey=o.createResolvedControlDefinitionResourceKey({automationName:"ms-sharing-info-pane-section",name:e("module").id,template:e("OH"),viewModelType:i.default});t.default=n});define("OI",["require","exports","ap","cE","qH","bX","sX","V","OR","p7","bF","Oh","q0","OP","OO","cJ","OJ","dz"],function(e,t,i,l,d,c,r,f,u,p,o,m,h,g,y,v,_,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=r.strings,n=function(s){i.__extends(e,s);function e(e,t){void 0===t&&(t={});var i=s.call(this,e,t)||this;i.personaTileTagName=_.default.tagName;i.panelOverlayTagName=m.default.tagName;i.dialogHostTagName=h.default.tagName;i.addBindingHandlers({toggle:u.default,bindableHtml:d.default,keyboard:v.default,selection:b.default,tooltip:p.default});i._engagement=i.resources.consume(l.resourceKey);var r=i.observables;i.permissionsFacepileCollection=r.createArray();i.infoPanePersonaTileCollection=r.createArray([]);i.groupPersonaTileCollection=r.createArray([]);i.peoplePersonaTileCollection=r.createArray([]);i.isExpanded=i.resources.consume(c.isSharingSectionExpanded.optional)||r.create(!0);i.strings=x;i.hasFocus=e.hasFocus;i.addPeopleText=x.addPeople;i.addPeopleScreenReaderText=x.addPeopleButtonName;i.viewPermissionsScreenRead=r.create("");i.openPanelActionText=x.openPanel;i.advancedText=x.advanced;i.stopSharingText=x.stopSharing;i.emailText=x.emailEveryone;i.showPermissionsPanel=r.create(!1);i.shouldShowLinks=r.create(!1);i.hasMultiLinks=r.create(!1);i.linksDetails=r.create("");i.groupsDetails=r.create("");i.numberOfGroups=r.create(0);i.totalFacePileCount=r.create(0);i.extraPersonaTooltipText=r.create("");i.showPermissionsPanelTitle=x.sharingOpenPermissionsPanelTitle;i.showPermissionsPanelHintText=x.sharingOpenPermissionsPanelHintText;i.extraPersonaText=r.create("");i.extraPersonaNumber=r.create(0);i.sharedWithGuestText=x.sharingGuestShared;i.permissionsPanelName=x.sharingPermissionsPanelName;var o=e.item,n=i._sharingSectionHelper=new(i.managed(g.default))({item:o,hasFocus:e.hasFocus});i.fileName=n.fileName;i.accessSummaryScreenReaderText=r.pureCompute(i._setAccessSummary);i.sharingSectionSummary=r.pureCompute(function(){return f.format(x.sharingSectionSummary,i.fileName())});i.viewPermissionsScreenRead=r.pureCompute(function(){return f.format(x.sharingViewPermissionsScreenRead,i.fileName())});i.privateDescription=n.privateDescription;i.hasInheritedLink=n.hasInheritedLink;i.isShareLinkVisible=n.isShareLinkVisible;i.isLoading=n.isLoading;i.scopes=n.scopes;i.links=n.links;i.canUnshare=n.canUnshare;i.personaTileCollection=n.personaTileCollection;i.hasSettings=n.hasSettings;i.advancedUrl=n.advancedUrl;i.keyNav=n.keyNav;i.mailto=n.mailto;i.showEmailLink=n.showEmailLink;i.sharingApiErrorMessage=n.sharingApiErrorMessage;i._totalNumberOfLinks=n.totalNumberOfLinks;i.statusText=n.statusText;i.hasGuest=i.createPureComputed(i._calculateExternalUser);i.accessSummaryScreenReaderText=r.pureCompute(i._setAccessSummary);i.sharingSectionSummary=r.pureCompute(function(){return f.format(x.sharingSectionSummary,i.fileName())});i.viewPermissionsScreenRead=r.pureCompute(function(){return f.format(x.sharingViewPermissionsScreenRead,i.fileName())});var a=i.resources.consume(c.actionMap);i._showAction=new(i.managed(a.ShowPermissionsAction))({item:o,engagementSource:"InfoPane"});r.compute(i._computeSparateGroupAndPeoplePersona);r.compute(i._calculateExtraPersona);r.compute(i._updateLinksData);return i}e.prototype.launchPermissionsPanel=function(e,t){this._engagement.logData({name:"ViewPermission.Sharing.InfoPaneSection.Click",isIntentional:!0});this._executeShowPermissionsPanel(t)};e.prototype.closeDialog=function(){this.onLinkRemoved()};e.prototype.onScopeClick=function(e){this._sharingSectionHelper.onScopeClick(e.scope.item)};e.prototype.onShareClick=function(){this._sharingSectionHelper.onShareClick()};e.prototype.onLinkRemoved=function(){this._sharingSectionHelper.onLinkRemoved()};e.prototype.onAdvancedClick=function(){this._engagement.logData({name:"AdvancedSettings.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};e.prototype.stopSharing=function(){this._sharingSectionHelper.stopSharing()};e.prototype.clickEmail=function(){this._engagement.logData({name:"EmailEveryone.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};e.prototype.moreThanOneLink=function(){return 1<this._totalNumberOfLinks()};e.prototype._updateLinksData=function(){var e=this._totalNumberOfLinks();this.linksDetails(this._getLinksDetails());var t=0!==e;this.shouldShowLinks(t);var i=1<e;this.hasMultiLinks(i)};e.prototype._getLinksDetails=function(){return 1<this._totalNumberOfLinks()?f.format(x.sharingLinkTitleMulti,this._totalNumberOfLinks()):x.sharingLinkTitleSingle};e.prototype._executeShowPermissionsPanel=function(e){this._showAction.execute(e).done()};e.prototype._computeSparateGroupAndPeoplePersona=function(){var e=this.personaTileCollection(),t=[],i=[];if(!this.showPermissionsPanel())for(var r=0,o=e;r<o.length;r++){var n=o[r];2===n.personaParams.person().entityType?t.push(n):i.push(n)}this.groupPersonaTileCollection(t.slice());this.peoplePersonaTileCollection(i);this.numberOfGroups(t.length);this.groupsDetails(this._getGroupsDetails())};e.prototype._getGroupsDetails=function(){return 1<this.numberOfGroups()?f.format(x.sharingGroupTitleMulti,this.numberOfGroups()):x.sharingGroupTitleSingle};e.prototype._getAllUsers=function(e){for(var t={},i=0,r=e;i<r.length;i++){t[(d=r[i]).personaParams.person().userId]=!0}for(var o=0,n=this.links();o<n.length;o++){var a=n[o];if(a.linkMembers)for(var s=0,l=a.linkMembers;s<l.length;s++){var d,c=l[s],u=(d=this._sharingSectionHelper.convertPersonToPersonaTile(this.createObservable(c),c.userId)).personaParams.person.peek().userId;if(!t[u]){t[u]=!0;e.push(d)}}}return e};e.prototype._calculateExternalUser=function(){for(var e=0,t=this.peoplePersonaTileCollection();e<t.length;e++){if(t[e].personaParams.person().isExternal)return!0}for(var i=0,r=this.links();i<r.length;i++){var o=r[i];if(5===o.kind||4===o.kind)return!0;for(var n=0,a=o.linkInvitees;n<a.length;n++){if(a[n].isExternal)return!0}}return!1};e.prototype._calculateExtraPersona=function(){var e=(0===this._totalNumberOfLinks()?0:1)+(0===this.numberOfGroups()?0:1),t=this._getAllUsers(this.peoplePersonaTileCollection()),i=t.length,r=0;if(7<1+e+t.length){i=7-e-2;r=6}else r=e+t.length;var o=t.length-i;this.extraPersonaNumber(o);99<=o?this.extraPersonaText(x.sharingExtraNumberOverflow):this.extraPersonaText(f.format(x.sharingExtraNumberText,o));this.extraPersonaTooltipText(f.format(x.sharingMoreTitle,o));this.infoPanePersonaTileCollection(t.slice(0,i));this.totalFacePileCount(r);this._setFacepileContent()};e.prototype._setAccessSummary=function(){var e=this._totalNumberOfLinks()+" "+f.getLocalizedCountValue(x.sharinglocTextLink,x.sharingIntervals,this._totalNumberOfLinks());e+=" "+this.numberOfGroups()+" "+f.getLocalizedCountValue(x.sharinglocTextGroup,x.sharingIntervals,this.numberOfGroups());for(var t=0,i=this.infoPanePersonaTileCollection();t<i.length;t++){e+=" "+i[t].personaParams.person().name}this.extraPersonaNumber()&&(e+=" "+f.format(x.sharingAccessSummaryMore,this.extraPersonaNumber()));this.hasGuest()?e+=" "+f.format(x.sharingAccessSummarySharedWithGuest,this.fileName()):this.privateDescription()&&(e+=" "+x.sharingAccessSummaryNotShared);return e};e.prototype._setFacepileContent=function(){var e=0,t=[],i=this.infoPanePersonaTileCollection();if(this.shouldShowLinks()){var r=f.format(x.sharingLinksScreenRead,this.linksDetails(),this.fileName(),e+1,this.totalFacePileCount()),o=new y.default({key:e,linkNum:this._totalNumberOfLinks(),screenReadText:this.createObservable(r)});t.push(o);e++}if(this.numberOfGroups()){var n=f.format(x.sharingGroupsScreenRead,this.groupsDetails(),this.fileName(),e+1,this.totalFacePileCount()),a=new y.default({key:e,groupNum:this.numberOfGroups(),screenReadText:this.createObservable(n),personaTile:this.groupPersonaTileCollection()[0]});t.push(a);e++}for(var s=0,l=i;s<l.length;s++){var d=l[s],c=d.personaParams.person().name,u=f.format(x.sharingPersonaScreenRead,c,this.fileName(),e+1,this.totalFacePileCount()),p=new y.default({key:e,screenReadText:this.createObservable(u),personaTile:d});t.push(p);e++}if(this.extraPersonaNumber()){var m=f.format(x.sharingExtraPeopleScreenRead,this.extraPersonaNumber().toString(),e+1,this.totalFacePileCount()),h=new y.default({key:e,extraPersona:this.extraPersonaNumber(),screenReadText:this.createObservable(m)});t.push(h);e++}this.permissionsFacepileCollection(t)};e.dependencies=i.__assign({},o.default.dependencies);return e}(o.default);t.default=n});define("Oh",["require","exports","b5","Oj","Oi","qU"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-panel-overlay",template:e("Oi"),viewModel:r.default,synchronous:!0});t.default=o});define("Oj",["require","exports","ap","bF","cp","cI","cA","cl","cU","cR","cV","cT","bW","d5","qX"],function(e,t,i,r,g,y,v,_,b,x,S,C,P,o,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I={},n=function(f){i.__extends(e,f);function e(e){void 0===e&&(e={});var t=f.call(this,e)||this;t.overlayTagName=g.default.tagName;t.closePanelLabel=k.strings.closePanelLabel;t.addBindingHandlers({dismiss:y.default,element:P.default,host:v.default,interactionScope:_.default,focusTrap:x.default,recoverFocus:C.default,preserveFocus:S.default,scrollContainer:b.default});var i=e.size,r=void 0===i?"Small":i,o=e.title,n=void 0===o?"":o,a=e.onClose,s=e.ariaLabel,l=void 0===s?"":s,d=e.showCloseButton,c=void 0===d||d,u=e.isOpen,p=e.width,m=void 0===p?"":p,h=e.virtualParentElement;t._size=r;t._onClose=a;t.contentElement=t.createObservable();t.title=t.wrapObservable(n);t._ariaLabel=t.wrapObservable(l);t.showCloseButton=t.createObservable(!!t._onClose&&c);t.isOpen=u;t.widthClass=t.createPureComputed(t._computeWidthClass,{deferEvaluation:!0});t.style=m?{width:m+"px"}:I;t.ariaLabel=t.createPureComputed(t._computeAriaLabel);t.virtualParentElement=h;return t}e.prototype.onClose=function(e,t){this._onClose&&this._onClose(t);return!1};e.prototype.onDismiss=function(e,t){this._onClose&&this._onClose(t);return!1};e.prototype.isPanelOpen=function(e){return this.isOpen?this.isOpen():e()};e.prototype._computeWidthClass=function(){return this.style===I?"od-Panel--"+o.default.determineCssClass(this._size):""};e.prototype._computeAriaLabel=function(){return this.unwrapObservable(this.title)||this.unwrapObservable(this._ariaLabel)};return e}(r.default);t.default=n});define("Oi",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {\r\n afterAdd: 1,\r\n beforeRemove: 500,\r\n isOpen: isOpen\r\n },\r\n alignToParent: false,\r\n virtualParentElement: virtualParentElement\r\n }\r\n}--\x3e<div class=od-Panel-container data-bind="focusTrap: {}, css: { \'od-Panel--hidden\': !isPanelOpen($host.isOpen) }"><div class="ms-ModalOverlay od-PanelOverlay"></div><div class="od-Panel od-Panel--hasPadding od-Panel--autoScroll" role=dialog tabindex=-1 data-bind="interactionScope: { isScope: true }, preserveFocus, recoverFocus: { isEnabled: isPanelOpen($host.isOpen) }, scrollContainer, dismiss: { isOpen: isOpen || $host.isOpen, close: $component.onDismiss.bind($component), useLocalEvents: true }, class: widthClass(), attr: { \'aria-label\': ariaLabel }, style: style, element: $component.contentElement">\x3c!--ko if: title--\x3e<div class="od-Panel-title ms-font-xl ms-fontWeight-semilight" data-bind="text: title"></div>\x3c!--/ko--\x3e<div class=od-Panel-content data-bind="host: {}"></div>\x3c!--ko if: showCloseButton--\x3e<button class="od-Panel-button od-Panel-button--close" data-bind="click: $component.onClose.bind($component), attr: { \'aria-label\': $component.closePanelLabel }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e'});define("OP",["require","exports","ap","cE","bX","ba","sX","DI","aq","aC","ci","V","aM","bF","gK","eO","Om","dI","s8","dH","OQ","kL"],function(e,t,c,r,o,n,i,a,s,l,d,u,p,m,h,f,g,y,v,_,b,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=i.strings,C=function(i){c.__extends(e,i);function e(e){var l=i.call(this,e)||this;l.sharingApiErrorMessage=l.createObservable("");l._people=l.createObservable(Array());l.keyNav=new b.default;l.personaTileCollection=l._getPersonaTileCollection();l.keyNav.focusableTiles=l.personaTileCollection;l.isNewSharingFlowEnabled=n.isFeatureEnabled(n.SharingDialogRedux);l.isLoading=s.observable(!1);l.scopes=s.observableArray();l.links=s.observableArray();l._scopesLinks=l.observables.createArray();l.hasFocus=e.hasFocus;l.personaSize=4;l.hasSettings=s.observable(!1);l.advancedUrl=s.observable("");l.canUnshare=s.observable(!1);l.showEmailLink=s.observable(!1);l.readPermissionsUpdated=l.createObservable(!1);l.updateComplete=l.createObservable("");l.canManagePermissions=l.createObservable(!1);l.hasInheritedLink=l.createObservable(!1);var t=l.resources.consume(o.actionMap);l.privateDescription=l.createPureComputed(l._computeShareStatus);l._engagement=l.resources.consume(r.resourceKey);l._currentItemShareAction=l.isNewSharingFlowEnabled?new(l.managed(t.ShareByLinkAction)):new(l.managed(t.ShareAction));l._sharingProvider=l.resources.consume(a.resourceKey);l._item=e.item;l.isShareLinkVisible=l.createComputed(l._computeIsShareLinkVisible);l.fileItem=l._item();l.createComputed(function(){var e=l._item();l._onItemChanged(e)});l.totalNumberOfLinks=l.createPureComputed(l._computeTotalNumberOfLinks);l.statusText=l.createComputed(l._computeStatusText);l.fileName=l.createObservable("");l.mailto=l.createComputed(function(){if(!l.hasSettings())return"";for(var e,t="mailto:",i=[],r=0,o=l.scopes();r<o.length;r++)for(var n=0,a=o[r].people;n<a.length;n++){var s=a[n];s.email&&i.push(s.email)}l.showEmailLink(0<i.length&&i.length<30);t+=p.default.encodeURIComponent(i.join(";"));t+="?subject="+p.default.encodeURIComponent(l._settings.itemName);e=h.canonicalizeDecodedUrl(l._settings.itemUrl);t+="&body="+p.default.encodeURIComponent(l._normalizeUrl(e));l.fileName(l._settings.itemName);l.canManagePermissions(l._settings.canManagePermissions);l.hasInheritedLink(l._settings.hasInheritedLink);l.sharingApiErrorMessage(l._settings.sharingApiErrorMessage);return t});return l}e.prototype.dispose=function(){i.prototype.dispose.call(this);if(this._getPermissionsPromise){this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}};e.prototype.onLinkRemoved=function(){this._engagement.logData({name:"RemoveLinkFromPanel.Sharing.InfoPaneSection.Click",isIntentional:!0});this._onItemChanged(this._item.peek())};e.prototype.onScopeClick=function(e){this._executeShare(e);return!1};e.prototype.notifyPermissionsUpdated=function(){this.updateComplete(S.sharingPermissionsUpdated);this.readPermissionsUpdated(!0)};e.prototype.cleanPermissionsUpdated=function(){this.updateComplete("");this.readPermissionsUpdated(!1)};e.prototype.onShareClick=function(){this._engagement.logData({name:"AddPeopleFromInfoPane.Sharing.InfoPaneSection.Click",isIntentional:!0});this._executeShare(this._item.peek());return!1};e.prototype.stopSharing=function(e){this._engagement.logData({name:"StopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});this._stopSharingConfirm(e)};e.prototype.convertPersonToPersonaTile=function(e,t,i){return{personaParams:{inputEvent:this.observables.create(),openContextMenu:this.observables.create(!1),item:i,person:e,personaSize:this.personaSize,showPresence:!0,sharingRoleMenuRootElementClass:"OneDriveApp"},key:t,focused:this.observables.create(!1)}};e.prototype._computeIsShareLinkVisible=function(){return this._currentItemShareAction.isAvailable()};e.prototype._stopSharing=function(){return this._sharingProvider.unshare(this._item.peek())};e.prototype._stopSharingConfirm=function(t){var i=this,e=this.resources.consume(d.resourceKey),r=this._engagement,o=s.observable(!0);e.requestDialog({title:S.stopSharingConfirmationTitle,size:"Medium",component:{name:g.default.tagName,params:{message:S.stopSharingConfirmationMessage}},actions:[{name:S.stopSharingConfirmationButton,execute:function(){r.logData({name:"Unshare.Sharing.InfoPaneSection.Click",isIntentional:!0});o(!1);return i._stopSharing().then(function(e){n.isFeatureEnabled(n.SharedByMe)&&i._item.peek().queryType===_.default.SharedByMe&&t();return 2},function(e){return 3})},isDefault:!0,isAvailable:o,icon:new y.default("Save"),automationId:"UnshareConfirm"},{name:S.stopSharingCancelButton,execute:function(){r.logData({name:"CancelStopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});return l.default.wrap(3)},isDefault:!1,icon:new y.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};e.prototype._executeShare=function(t,e){void 0===e&&(e=this.resources);n.isOneDrive&&this.trackPromise(e.consumeAsync(x.resourceKey).then(function(e){e.fireShareEvent(t)}));var i=this.resources.consume(o.actionMap);(this.isNewSharingFlowEnabled?this.addDisposable(new(e.injected(i.ShareByLinkAction))):this.addDisposable(new(e.injected(i.ShareAction))({item:s.observable(t),startState:3}))).execute(null)};e.prototype._computeStatusText=function(){var e=this._item.peek(),t=this.isLoading(),i="",r=this.scopes();this._hasError&&(i=this._errorText);t?i=S.sharingLoadingStatus:0!==this.totalNumberOfLinks()||this._hasNonOwnerScopes(r)||(i=e.type===f.default.Folder?S.sharingUnsharedFolderStatus:S.sharingUnsharedFileStatus);return i};e.prototype._hasNonOwnerScopes=function(e){var t=!0,i=!1;e&&0!==e.length||(t=!1);if(t)for(var r=0;r<e.length&&!i;r++)for(var o=e[r].people,n=0;n<o.length&&!i;n++){0!==o[n].sharingInfo.role&&(i=!0)}return t&&i};e.prototype._computeShareStatus=function(){var e=this.scopes(),t="";if(0===this.totalNumberOfLinks()&&!this._hasNonOwnerScopes(e)&&0===this._item().sharingRole)if(e&&0!==e.length){if(1===e.length&&this._areAllOwners(e[0].people)){var i=e[0].people[0];t=1===e[0].people.length&&2===i.entityType?u.format(S.sharingUnsharedOwnedByGroup,i.name):S.sharingUnsharedNotShared}}else t=S.sharingUnsharedNotShared;return t};e.prototype._areAllOwners=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.sharingInfo&&0!==r.sharingInfo.role)return!1}return!0};e.prototype._computeTotalNumberOfLinks=function(){var e=this.links(),t=this._scopesLinks();return e.length+t.length};e.prototype._onItemChanged=function(t){var i=this;this.cleanPermissionsUpdated();if(this._getPermissionsPromise){this.isLoading(!1);this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}if(t&&t.key!==this._itemKey){this._itemKey=t.key;this.scopes([]);this.links([]);this.isLoading(!0)}if(t){this._sharingData=this._sharingProvider.getSharingData(t);this._sharingData.getSettings().then(function(e){i._settings=e;i.advancedUrl(e.advancedUrl);i.hasSettings(!0)},function(e){});this._hasError=!1;this._getPermissionsPromise=this._sharingData.getPermissions();this._sharingData.doSharingScopesContainLinks()||(this._getLinksPromise=this._sharingData.getLinks());this.trackPromise(this._getPermissionsPromise.then(function(e){i.isLoading(!1);i.scopes(i._processScopes(t,e))},function(e){e&&403===e.status?i._errorText=S.accessDenied:e&&e.code&&-1<e.code.indexOf("-2130575139")?i._errorText=S.noscriptErrorStatus:i._errorText=S.serverError;i._hasError=!0;i.isLoading(!1)}));this._getLinksPromise&&this._getLinksPromise.then(function(e){e&&i.links(e.filter(function(e){return e.isActive&&8!==e.type}))},function(e){});this.fileItem=t}};e.prototype._processScopes=function(e,t){var i=this,r=[];0<t.length&&this.canUnshare(t[0].canUnshare);this._scopesLinks([]);for(var o=0;o<t.length;o++){var n=t[o];if(n&&n.people.length){var a=c.__assign({},n,{headerHtml:"",sharingPeople:[]});if(n.item&&n.item.key!==this._item.peek().key){var s;s="<span data-bind=\"component: { name: '"+v.default.tagName+"', params: { item: scope.item } }\"></span>";a.headerHtml=u.format(S.sharingScopeHeaderFormat,s)}n.people.forEach(function(e){e.sharingInfo.link&&i._scopesLinks.push(e.sharingInfo.link);a.sharingPeople.push({personInfo:e,sharingItem:n.item})});r.push(a)}}for(var l=new Array,d=0;d<r.length;d++)l=l.concat(r[d].sharingPeople);this._people().length&&this.notifyPermissionsUpdated();this._people(l);return r};e.prototype._getPersonaTileCollection=function(){var n=this,r=this.createPureComputed(function(){for(var e={},t=0,i=n._people();t<i.length;t++){var r=i[t],o=r.personInfo;3!==o.sharingInfo.type&&(e[o.userId]=r)}return e}),e=this.observables.createArray();this.createBackgroundComputed(function(){e.splice.apply(e,[0,e.peek().length].concat(n._people().map(function(e){return e.personInfo.userId})))});return e.filter(function(e){return e in r()}).map({mappingWithDisposeCallback:function(e){var t=n.createObservable(),i=n.createComputed(function(){t(r()[e].personInfo||t.peek())});return{mappedValue:n.convertPersonToPersonaTile(t,e,r()[e].sharingItem),dispose:function(){i.dispose()}}}})};e.prototype._normalizeUrl=function(e){var t=document.createElement("A");t.href=e;return t.href};return e}(m.default);t.default=C});define("DI",["require","exports","ap","bN","bA","dZ","d7","eX","dc","DK","DJ"],function(e,t,i,o,r,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._dataSource=t.sharingDataSource;i._sharingDataDataSource=t.sharingDataDataSource;i._itemProvider=t.externallySharedItemProvider||t.itemProvider;i._shareDataCache={};i._shareItemHelper=t.shareItemHelper;return i}e.prototype.getSharingInformation=function(e,t){return this._dataSource.getSharingInformation(e,t)};e.prototype.shareLink=function(t){var i=this;return this._dataSource.shareLink(t).then(function(e){if(e.link){i._invalidateCachedItem(t.items[0]);i._invalidateItem(t.items[0])}return e})};e.prototype.unshareLink=function(t){var i=this;return this._dataSource.unshareLink(t).then(function(e){i._invalidateCachedItem(t.item);i._invalidateItem(t.item);return e})};e.prototype.updatePermissions2=function(e,t,i){var r=this;return this._dataSource.updatePermissions2(e,t,i).then(function(e){r._invalidateCachedItem(t);r._invalidateItem(t);return e})};e.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)};e.prototype.getClientId=function(){return this._dataSource.getClientId()};e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};e.prototype.emailWithoutPermissioning=function(e,t,i){return this._dataSource.emailWithoutPermissioning(e,t,i)};e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};e.prototype.getSharingData=function(e,t){var i=this._shareDataCache[e.id],r=i&&i.data;if(!r||e.eTag!==i.eTag||t){r=this.scope.attach(new c.default({item:e},{dataSource:this._sharingDataDataSource}));this._shareDataCache[e.id]={eTag:e.eTag,data:r}}return r};e.prototype.share=function(e,t,i){var r=this;return this._shareItemHelper.share(e,t,i).then(function(e){r._invalidateCache();return e})};e.prototype.unshare=function(i){var r=this;return this._dataSource.unshare(i).then(function(e){r._invalidateCache();var t=r._itemProvider;if(t){t.invalidateItem(i.parent.key);t.invalidateItem(i.key)}return e})};e.prototype.updatePermissions=function(e,t,i,r){var o=this;return this._dataSource.updatePermissions(e,t,i,r).then(function(e){o._invalidateCache();o._itemProvider&&o._itemProvider.invalidateItem(t.parent.key);return e})};e.prototype.manageSharingLinks=function(i,e){var r=this;if(e&&e.link&&e.link.shareId&&!e.create){var t={item:i[0],kind:e.link.kind,shareId:e.link.shareId};return this._dataSource.unshareLink(t).then(function(e){r._invalidateCachedItem(t.item);r._invalidateItem(t.item);return[]})}var o=(i=i&&i.length?i:[]).map(function(e){return r.getSharingData(e)});return this._dataSource.manageSharingLinks(o,e).then(function(e){r._invalidateCache();var t=i[0]&&i[0].parent&&i[0].parent.key;t&&r._itemProvider.invalidateItem(t);return e})};e.prototype._invalidateCache=function(){this._shareDataCache={}};e.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)};e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};e.dependencies=i.__assign({},o.default.dependencies,{sharingDataSource:n.sharing,sharingDataDataSource:n.sharingData.optional,navigation:l.navigation,externallySharedItemProvider:a.externallySharedItem.optional,itemProvider:s.resourceKey.optional,shareItemHelper:d.resourceKey});return e}(o.default);t.default=u;t.resourceKey=r.createResolvedResourceKey(e("module").id,u)});define("DK",["require","exports","ap","bN","bA","aC","dZ","eX","dR","eQ","cg","dY","dc","DL","iE"],function(e,t,i,o,r,a,n,s,l,d,c,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._dataSource=t.sharingDataSource;i._itemProvider=t.itemProvider;i._operationProvider=t.operationProvider;i._navigation=t.navigation;i._urlDataSource=t.urlDataSource;i._sharingContextInformation=t.sharingContextInformation;return i}e.prototype.share=function(e,t,i){if(this._sharingContextInformation||i)return this._dataSource.share(e,t);var r=this._getShareOperation(t),o=this._dataSource.share(e,t);r.state(u.default.started);return o.then(this._onSuccess(t,r),this._onError(r))};e.prototype._getShareOperation=function(e){var t=this,i=this.observables,r=this._operationProvider.register({name:e.items[0].name,type:c.default.shareItem,payloads:{shareItem:{items:e.items}},iconName:e.items[0].iconName,actions:{hipCheck:{isAvailable:i.create(!1),execute:function(){t._navigation.navigateTo({url:t._urlDataSource.getHipCheckUrl(),frameId:"_blank"});r.state(u.default.expired);return a.default.wrap()}},verifyAccount:{isAvailable:i.create(!1),execute:function(){t._navigation.navigateTo({url:t._urlDataSource.getVerifyAccountUrl(),frameId:"_blank"});r.state(u.default.expired);return a.default.wrap()}}}});r.progress.maximum(1);r.progress.current(0);return r};e.prototype._onSuccess=function(i,r){var o=this;return function(e){i.items[0].parent&&o._itemProvider&&o._itemProvider.invalidateItem(i.items[0].parent.key);r.progress.current(1);0<=e.statusCode?r.state(u.default.completed):r.state(u.default.failed);var t=r.payloads.peek();t.shareItem.result=e.statusCode;r.payloads(t);return e}};e.prototype._onError=function(o){var n=this;return function(e){var t=o.payloads.peek();t.shareItem.result=e.statusCode||e.code;o.payloads(t);var i,r=e.code;if(3006===r&&n._urlDataSource.getHipCheckUrl()){o.actions.peek().hipCheck.isAvailable(!0);i=e&&e.message}else if(3009!==r&&3033!==r||!n._urlDataSource.getVerifyAccountUrl())3007!==r&&3035!==r||(i=e&&e.message);else{o.actions.peek().verifyAccount.isAvailable(!0);i=m.strings.VerifyAccount}i&&o.error(new d.default({message:i}));o.state(u.default.failed);return a.default.wrapError(e)}};e.dependencies=i.__assign({},o.default.dependencies,{sharingDataSource:n.sharing,itemProvider:s.resourceKey.optional,operationProvider:l.resourceKey,navigation:p.navigation,urlDataSource:n.url,sharingContextInformation:h.sharingContextInformation.optional});return e}(o.default);t.default=f;t.resourceKey=r.createResolvedResourceKey(e("module").id,f)});define("DJ",["require","exports","aC"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.item=e.item;this._dataSource=t.dataSource}e.prototype.getSettings=function(){var t=this;if(!this._settingsPromise){this._settingsPromise=this._dataSource.getSettings(this);this._settingsPromise.done(null,function(e){if(i.default.isCanceled(e)){t._settingsPromise=null;t._rawResponse=null}})}return this._settingsPromise};e.prototype.getPermissions=function(e){this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this));return this._permissionsPromise};e.prototype.cancelGetPermissionsPromise=function(){if(this._permissionsPromise){this._permissionsPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getLinks=function(){var t=this;this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(e){return t._linksData=e}));return this._linksPromise};e.prototype.cancelGetLinksPromise=function(){if(this._linksPromise){this._linksPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)};e.prototype.setLink=function(t){var e=this._linksData;if(t&&e){var i=e.filter(function(e){return e&&e.role===t.role&&e.type===t.type});if(0===i.length)e.push(t);else{var r=i[0];r.url=t.url;r.expiration=t.expiration;r.isActive=t.isActive}}};e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()};e.prototype.getRawResponse=function(){var t=this;if(!this._rawResponse){this._rawResponse=this._dataSource.getRawResponse(this);this._rawResponse.done(null,function(e){i.default.isCanceled(e)&&(t._rawResponse=null)})}return this._rawResponse};e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null;this._settingsPromise=null;this._permissionsPromise=null;this._rawResponse=null};return e}();t.default=r});define("Om",["require","exports","Op","b5","Oo","On"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-confirmation",template:e("Oo"),viewModel:i.default});t.default=o});define("Op",["require","exports","ap","bF"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.message=e.message;return t}return e}(i.default);t.default=o});define("Oo",[],function(){return'<div class=od-Confirmation><p class=od-Confirmation-message data-bind="text: message"></p></div>'});define("On",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-Confirmation-message{padding:0;box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}'}])});define("OQ",["require","exports","ap","bN"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){i.__extends(e,t);function e(){var e=t.call(this)||this;e.keyboardOptions=[{target:null,mappings:{Enter:e.onKeyEnter}},{target:window,mappings:{}}];e.focusedTile=e.observables.create();e.focusableTiles=e.observables.createArray();return e}e.prototype.onKeyEnter=function(e,t){var i=e.keyNav.focusedTile();if(i){i.personaParams.inputEvent(t);i.personaParams.openContextMenu(!0)}t.stopPropagation();return!0};return e}(r.default);t.default=o});define("OO",["require","exports","aq"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.focused=i.observable(!1);this.index=e.key;this.linkNum=e.linkNum;this.groupNum=e.groupNum;this.personaTile=e.personaTile;this.extraPersona=e.extraPersona;this.screenReadText=e.screenReadText;this._disablePictureAlt()}e.prototype._disablePictureAlt=function(){this.personaTile&&(this.personaTile.personaParams.disablePictrueAlt=!0)};return e}();t.default=r});define("OJ",["require","exports","OM","b5","OL","OK"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-persona-tile",template:e("OL"),viewModel:i.default,synchronous:!0});t.default=o});define("OM",["require","exports","ap","g8","Os","ON","bF"],function(e,t,i,o,n,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.personaTagName=n.default.tagName;t.addBindingHandlers({scrollIntoView:a.default});var i=e.tile;t.tile=i;t.tile.personaParams.disableTab=!0;t.tile.personaParams.canManagePermissions=e.canManagePermissions;t.disableTab=e.disableTab;t._person=t.tile.personaParams.person.peek();t.ariaLabel=t.createComputed(t._computeAriaLabel);return t}e.prototype._computeAriaLabel=function(){var e=this._person.sharingInfo.role,t="",i=this.tile.personaParams.canManagePermissions?o.strings.EnterKeyInstruction:"";if(0===e)t=o.strings.Owner;else if(2===e){t=o.strings.Edit;t+=i}else if(1===e){t=o.strings.View;t+=i}return this._person.name+" "+t};return e}(r.default);t.default=s});define("Os",["require","exports","OE","b5","OD","OC","Ox","Ot"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-persona",template:e("OD"),viewModel:i.default});t.default=o});define("OE",["require","exports","ap","bF","p3","ok","oj","cE","lB","aq","g8","OF","p7","ba","Ot","dZ","bX","cJ","bW","V","hs"],function(e,t,r,i,n,o,a,s,l,d,c,u,p,m,h,f,g,y,v,_,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=function(i){r.__extends(e,i);function e(e){var r=i.call(this,e)||this;r.loadingSpinnerTagName=l.default.tagName;r.personaImageTagName=h.default.tagName;r.addBindingHandlers({tooltip:p.default,keyboard:y.default,element:v.default});r.updateSharingRole=function(e){if(5===e.sharingInfo.role)r._removePerson(r.person());else{var t=r.person();t.sharingInfo=e.sharingInfo;r.person(t);r.updatingPermissions(!1)}};r._item=e.item;r.openContextMenu=e.openContextMenu||r.observables.create(!1);r.inputEvent=e.inputEvent||r.observables.create(null);r.sharingRoleElement=r.createObservable();r.disableTab=r.createObservable(e.disableTab);r.showEmail=m.isFeatureEnabled(m.ShowEmailInPeoplePicker);r.person=d.isObservable(e.person)?e.person:d.observable(e.person);r.updatingPermissions=d.observable(!1);r.nameEmail=r.person().email?_.format(c.strings.NameAndEmail,r.person().name,r.person().email):r.person().name;r._removePerson=e.removePerson||function(e){};r.showName=void 0===e.showName||!!e.showName;r.showProfileLink=!!e.profileLinkOn;r.showPresence=!!e.showPresence;r._includeComma=!!e.includeComma;r._sharingRoleMenuRootElementClass=e.sharingRoleMenuRootElementClass||"od-Dialog-main";r._urlDataSource=r.resources.consume(f.url);e.personaSize?r.personaSize=d.isObservable(e.personaSize)?e.personaSize:d.observable(e.personaSize):r.personaSize=d.observable(3);r.personaImageParams={person:r.person,disablePictrueAlt:e.disablePictrueAlt,iconType:e.iconType};r.createComputed(function(){if(r.openContextMenu()&&r.canChangePermissions()&&r.canManagePermissions()){var e=r._createContextMenuCommands(),t=r._createContextMenuHelper(e),i=r.inputEvent.peek();o.default.createContextMenu(i,t,r);13===i.keyCode&&i.preventDefault();r.openContextMenu(!1)}});r.personaClass=r.createComputed(function(){var e=void 0===r.person().isResolved||r.person().isResolved?"":"od-Persona-unresolved ";r._includeComma&&(e+="od-Persona--comma ");e+="od-Persona";switch(r.personaSize()){case 7:return e+" od-Persona--mini";case 1:return e+" od-Persona--tiny";case 2:return e+" od-Persona--xs";case 3:return e+" od-Persona--sm";case 5:return e+" od-Persona--lg";case 6:return e+" od-Persona--xl";default:return e}});r.hasSharingInfo=r.createComputed(function(){return!!r.person().sharingInfo});var t=r.resources.isExposed(g.viewParams)?r.resources.consume(g.viewParams):null;r.personIsCurrentUser=r.createPureComputed(function(){return t&&r.person().userId&&r._urlDataSource.getOwnerId("",t()).toLowerCase()===r.person().userId.toLowerCase()},{deferEvaluation:!0});r.canChangePermissions=r.createPureComputed(function(){return!!r.person().sharingInfo&&0!==r.person().sharingInfo.role&&!r.personIsCurrentUser()});r.canManagePermissions=r.createObservable(e.canManagePermissions);r.presenceVisible=r.createComputed(function(){return r.showPresence&&!!r.person().sip});r.tooltip=r.person().email;r.updatingText=c.strings.UpdatingText;r.person().providerName&&(r.tooltip+="\n"+r.person().providerName);return r}e.prototype.getSharingRole=function(e){if(e&&this._item){var t=e.expiration?b.getShortDisplayDate(new Date(e.expiration)):null;switch(e.role){case 1:return t?_.format(c.strings.ViewExpiration,t):c.strings.View;case 2:return t?_.format(c.strings.EditExpiration,t):c.strings.Edit;case 6:return c.strings.Review;case 4:return c.strings.CoOwner;case 0:return c.strings.Owner;case 7:return e.customRole}}return""};e.prototype.onSharingRoleClick=function(e,t){this.resources.consume(s.resourceKey).logData({name:"UpdatePermissionsMenu.SharingDialog.Click",isIntentional:!0});var i=this._createContextMenuCommands(),r=this._createContextMenuHelper(i,t);o.default.createContextMenu(t,r,this);return i};e.prototype._createContextMenuCommands=function(){var e,t=[],i="";if(m.isFeatureEnabled(m.ReviewPermissionUI)&&this._item.appMap&&"ms-word"===this._item.appMap){var r,o="";if(1===this.person().sharingInfo.role){i=c.strings.AllowEdit;e=2;o=c.strings.ReviewOnly;r=6}else if(6===this.person().sharingInfo.role){i=c.strings.AllowEdit;e=2;o=c.strings.ViewOnly;r=1}else if(2===this.person().sharingInfo.role){i=c.strings.ReviewOnly;e=6;o=c.strings.ViewOnly;r=1}t[0]=new n.default({text:i,isToggleable:!1,action:new(this.managed(u.default))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[1]=new n.default({text:o,isToggleable:!1,action:new(this.managed(u.default))({person:this.person(),role:r,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[2]=new n.default({text:c.strings.StopSharing,isToggleable:!1,action:new(this.managed(u.default))({person:this.person(),role:5,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})})}else{if(1===this.person().sharingInfo.role){i=c.strings.AllowEdit;e=2}else{i=c.strings.ViewOnly;e=1}t[0]=new n.default({text:i,isToggleable:!1,action:new(this.managed(u.default))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[1]=new n.default({text:c.strings.StopSharing,isToggleable:!1,action:new(this.managed(u.default))({person:this.person(),role:5,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})})}return t};e.prototype._createContextMenuHelper=function(e,t){return new a.default({items:e,rootElementClass:this._sharingRoleMenuRootElementClass,anchorElement:t&&t.target||this.sharingRoleElement.peek()})};return e}(i.default);t.default=x});define("OF",["require","exports","ap","g4","aI","OG"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="UpdatePermissions";t._item=e.item;t._person=e.person;t._role=e.role;t._isExecuting=e.isExecuting;t._callback=e.callback;t._expiration=e.expiration;return t}e.prototype.onExecute=function(e,t){var i=this;this._isExecuting&&this._isExecuting(!0);return this.resources.consumeAsync(n.resourceKey).then(function(e){return e.updatePermissions([i._person],i._item,i._role,i._expiration)}).then(function(e){i._callback(e.people[0]);i._isExecuting(!1);return{resultType:o.ResultTypeEnum.Success}},function(e){i._isExecuting(!1);return{resultType:o.ResultTypeEnum.Failure}})};return e}(i.default);t.default=a});define("OG",["require","exports","aC","e8"],function(i,e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=r.createResolvedAliasResourceKey(i("module").id,"DI",function(){return new t.default(function(e,t){i(["DI"],e,t)})})});define("Ot",["require","exports","Ow","b5","Ov","Ou"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-persona-image",template:e("Ov"),viewModel:i.default});t.default=o});define("Ow",["require","exports","ap","aq","bF","g8","V","lw"],function(e,t,r,o,i,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.isImageLoaded=o.observable(!1);t.addBindingHandlers({imageLoader:s.default});t.person=o.isObservable(e.person)?e.person:o.observable(e.person);t.disablePictrueAlt=e.disablePictrueAlt;t.pictureAlt=t.createComputed(t._computePictureAlt);t._iconType=e.iconType;return t}e.prototype.getIconType=function(e){if(this._iconType)return this._iconType;switch(e?e.type:3){case 1:return"Contact";case 0:return"Mail";default:return"People"}};e.prototype._computePictureAlt=function(){var e=a.format(n.strings.PictureAlt,o.utils.unwrapObservable(this.person().name));return this.disablePictrueAlt?"":e};return e}(i.default);t.default=l});define("Ov",[],function(){return"<div class=\"od-Persona-image ms-Icon\" data-bind=\"icon: true, class: 'ms-Icon--' + getIconType(person().sharingInfo), css: { 'od-Persona-image--isLoaded': isImageLoaded }\">\x3c!--ko if: person().image--\x3e<img data-bind=\"imageLoader: { src: person().image, isLoaded: isImageLoaded, scenarioName: 'personaImage' }, attr: { alt: pictureAlt }\">\x3c!--/ko--\x3e</div>"});define("Ou",["c","az"],function(e,t){e.loadStyles([{rawString:".od-Persona-image{display:inline-block;width:50px;height:50px;border-radius:50%;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";font-size:21px;position:relative;overflow:hidden;text-align:center;vertical-align:middle}.od-Persona-image.ms-Icon{line-height:50px}.od-Persona-image>img{display:none;position:absolute;left:0;top:0;width:100%;height:100%;object-fit:cover}.od-Persona-image--isLoaded>img{display:block;border-radius:50%}"}])});define("OD",[],function(){return'<div data-bind="tooltip:{ content: nameEmail, \'aria-label\': person().name}, css: personaClass"><div class=od-Persona-imageArea><div class=od-Persona-imageCircle>\x3c!--ko component: {\r\n name: personaImageTagName,\r\n params: personaImageParams\r\n }--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: presenceVisible--\x3e\x3c!--ko component: {\r\n name: \'ms-presence\',\r\n params: { sip: person().sip }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class=od-Persona-details>\x3c!--ko if: showProfileLink--\x3e\x3c!--ko if: person().profilePage--\x3e<a class="od-Persona-link od-Persona-primaryText" target=_blank data-bind="attr: {href: person().profilePage}, text: person().name"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot: person().profilePage--\x3e<span class="od-Persona-link od-Persona-primaryText" data-bind="text: person().name"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !showProfileLink && showName--\x3e<div class="od-Persona-primaryText od-persona-link" data-bind="text: person().name"></div>\x3c!--/ko--\x3e<div class=od-Persona-secondaryText data-bind="visible: !!person().job, text: person().job"></div><div class=od-Persona-tertiaryText data-bind="visible: !!person().department, text: person().department"></div><div class=od-Persona-optionalText data-bind="visible: !!person().office, text: person().office"></div><div class=od-Persona-emailText data-bind="visible: showEmail, text: person().email"></div>\x3c!--ko if: canChangePermissions() && canManagePermissions()--\x3e<div class=od-Persona-sharingContainer data-bind="visible: !updatingPermissions() && getSharingRole(person().sharingInfo) && personaSize() > 3"><a href=javascript: role=button class=od-Persona-sharingRole data-bind="click: onSharingRoleClick, keyboard: { Space: onSharingRoleClick }, attr: { \'aira-label\': getSharingRole(person().sharingInfo), tabindex: !disableTab ? 0 : -1, }, element: sharingRoleElement"><div class=od-Persona-sharingRole-Text><span data-bind="text: getSharingRole(person().sharingInfo)"></span> <span class=od-Persona-sharingRole-Chevron data-bind="visible: !personIsCurrentUser()"><i class="ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i></span></div></a></div>\x3c!--ko if: updatingPermissions()--\x3e<div class=od-Persona-sharingSpinner data-bind="component: {name: loadingSpinnerTagName, params : {loadingText: updatingText} }, visible: updatingPermissions()"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: hasSharingInfo && (!canChangePermissions() || !canManagePermissions())--\x3e<div class=od-Persona-sharingRole-Text data-bind="text: getSharingRole(person().sharingInfo)"></div>\x3c!--/ko--\x3e</div></div>'});define("OC",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-Persona{box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;line-height:1;position:relative;width:100%}.od-Persona .od-Persona-imageArea{position:relative;display:inline-block;background-color:transparent;width:48px;height:48px;overflow:visible}[dir=ltr] .od-Persona .od-Persona-imageArea{margin-right:8px}[dir=rtl] .od-Persona .od-Persona-imageArea{margin-left:8px}.od-Persona .od-Persona-imageCircle{width:48px;height:48px;margin:0;border-radius:50%;overflow:hidden;position:absolute;background-color:'},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-imageCircle{left:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{right:0}[dir=ltr] .od-Persona .od-Persona-imageCircle{right:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{left:0}.od-Persona .od-Persona-initials{border-radius:50%}.od-Persona .od-Persona-placeholder{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:';position:absolute;font-size:47px;top:7px}[dir=ltr] .od-Persona .od-Persona-placeholder{right:0}[dir=rtl] .od-Persona .od-Persona-placeholder{left:0}[dir=ltr] .od-Persona .od-Persona-placeholder{left:0}[dir=rtl] .od-Persona .od-Persona-placeholder{right:0}.od-Persona .od-Persona-image{width:48px;height:48px;line-height:48px}.od-Persona .od-Persona-image[src=""]{display:none}.od-Persona .od-Persona-presence{position:absolute;height:12px;width:12px;border-radius:50%;top:auto;bottom:-6px;border:2px solid '},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-presence{left:auto}[dir=rtl] .od-Persona .od-Persona-presence{right:auto}[dir=ltr] .od-Persona .od-Persona-presence{right:-2px}[dir=rtl] .od-Persona .od-Persona-presence{left:-2px}.od-Persona .od-Persona-row{white-space:nowrap;clear:both;display:inline-block}.od-Persona.od-Persona-unresolved .od-Persona-image{display:none}.od-Persona .od-Persona-details{vertical-align:top;display:inline-block;margin-top:4px}.od-Persona .od-persona-link{display:inline-block;padding-bottom:3px}.od-Persona .od-Persona-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:';font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;white-space:nowrap;max-width:100%;overflow:hidden;text-overflow:ellipsis;padding-bottom:3px}.od-Persona .od-Persona-emailText,.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-secondaryText,.od-Persona .od-Persona-sharingRole-Text,.od-Persona .od-Persona-sharingSpinner,.od-Persona .od-Persona-tertiaryText{color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;padding-bottom:3px;white-space:nowrap;height:auto;overflow:hidden;text-overflow:ellipsis}.od-Persona .od-Persona-sharingRole-Text{margin:2px 0}.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-tertiaryText{display:none}.od-Persona .od-Persona-sharingRole{cursor:pointer;display:inline-block}.od-Persona .od-Persona-sharingRole .ms-Icon--ChevronDown{position:relative;top:2px}.od-Persona.od-Persona--mini{width:24px;height:24px;display:inline-block}.od-Persona.od-Persona--mini .od-Persona-image,.od-Persona.od-Persona--mini .od-Persona-imageArea,.od-Persona.od-Persona--mini .od-Persona-imageCircle{width:24px;height:24px;margin:0}.od-Persona.od-Persona--mini .od-Persona-details{display:none}.od-Persona.od-Persona--tiny{padding:0;display:inline-block}[dir=ltr] .od-Persona.od-Persona--tiny{margin-left:4px}[dir=rtl] .od-Persona.od-Persona--tiny{margin-right:4px}.od-Persona.od-Persona--tiny .od-Persona-image,.od-Persona.od-Persona--tiny .od-Persona-imageArea,.od-Persona.od-Persona--tiny .od-Persona-imageCircle{display:none}.od-Persona.od-Persona--tiny .od-Persona-presence{vertical-align:text-bottom;padding-top:0}.od-Persona.od-Persona--tiny .od-Persona-details{height:14px;margin-top:0;line-height:14px;overflow:visible}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-details{padding-left:15px}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-details{padding-right:15px}.od-Persona.od-Persona--tiny .od-Persona-presence{height:10px;width:10px;top:10px;border:0}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-presence{right:auto}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-presence{left:auto}.od-Persona.od-Persona--tiny .od-Persona-primaryText{color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:';font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;padding-top:2px}.od-Persona.od-Persona--tiny .od-Persona-optionalText,.od-Persona.od-Persona--tiny .od-Persona-secondaryText,.od-Persona.od-Persona--tiny .od-Persona-sharingRole-Text,.od-Persona.od-Persona--tiny .od-Persona-sharingSpinner,.od-Persona.od-Persona--tiny .od-Persona-tertiaryText{display:none}.od-Persona.od-Persona--tiny.od-Persona--comma{padding:0;background-color:transparent}.od-Persona.od-Persona--tiny.od-Persona--comma .od-Persona-primaryText:after{content:\',\'}.od-Persona.od-Persona--xs .od-Persona-image,.od-Persona.od-Persona--xs .od-Persona-imageArea,.od-Persona.od-Persona--xs .od-Persona-imageCircle{width:32px;height:32px}.od-Persona.od-Persona--xs .od-Persona-imageArea{margin-bottom:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-right:8px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-left:8px}.od-Persona.od-Persona--xs .od-Persona-image{line-height:32px}.od-Persona.od-Persona--xs .od-Persona-placeholder{font-size:28px;top:4px}.od-Persona.od-Persona--xs .od-Persona-presence{bottom:-1px}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-presence{right:-1px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-presence{left:-1px}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:0}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:4px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:4px}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{margin-right:4px}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{margin-left:4px}.od-Persona.od-Persona--xs .od-Persona-primaryText{font-size:14px;padding-top:3px}.od-Persona.od-Persona--xs .od-Persona-secondaryText{display:none}.od-Persona.od-Persona--sm .od-Persona-image,.od-Persona.od-Persona--sm .od-Persona-imageArea,.od-Persona.od-Persona--sm .od-Persona-imageCircle{width:40px;height:40px}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-left:4px}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-right:4px}.od-Persona.od-Persona--sm .od-Persona-image{line-height:40px}.od-Persona.od-Persona--sm .od-Persona-placeholder{font-size:38px;top:5px}.od-Persona.od-Persona--sm .od-Persona-presence{bottom:-1px;margin:0}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-presence{right:-1px}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-presence{left:-1px}.od-Persona.od-Persona--sm .od-Persona-primaryText{font-size:14px;padding:0}.od-Persona.od-Persona--sm .od-Persona-secondaryText{padding:0;margin-top:5px}.od-Persona.od-Persona--lg .od-Persona-image,.od-Persona.od-Persona--lg .od-Persona-imageArea,.od-Persona.od-Persona--lg .od-Persona-imageCircle{width:72px;height:72px}.od-Persona.od-Persona--lg .od-Persona-imageArea{height:78px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:12px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:12px}.od-Persona.od-Persona--lg .od-Persona-image{line-height:72px;font-size:28px}.od-Persona.od-Persona--lg .od-Persona-details{padding-top:6px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:10px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:10px}.od-Persona.od-Persona--lg .od-Persona-placeholder{font-size:68px;top:10px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-placeholder{left:-5px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-placeholder{right:-5px}.od-Persona.od-Persona--lg .od-Persona-presence{height:20px;width:20px;bottom:4px;border-width:3px}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-presence{right:-2px}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-presence{left:-2px}.od-Persona.od-Persona--lg .od-Persona-primaryText{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;line-height:12px}.od-Persona.od-Persona--lg .od-Persona-tertiaryText{display:block}.od-Persona.od-Persona--lg .od-Persona-optionalText,.od-Persona.od-Persona--lg .od-Persona-secondaryText,.od-Persona.od-Persona--lg .od-Persona-sharingRole-Text,.od-Persona.od-Persona--lg .od-Persona-tertiaryText{line-height:12px;margin-top:8px;margin-bottom:0}.od-Persona.od-Persona--xl .od-Persona-image,.od-Persona.od-Persona--xl .od-Persona-imageArea,.od-Persona.od-Persona--xl .od-Persona-imageCircle{width:100px;height:100px}[dir=ltr] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-right:20px}[dir=rtl] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-left:20px}.od-Persona.od-Persona--xl .od-Persona-image{line-height:100px;font-size:28px}.od-Persona.od-Persona--xl .od-Persona-placeholder{font-size:95px;top:12px}.od-Persona.od-Persona--xl .od-Persona-presence{height:28px;width:28px;border-width:4px}.od-Persona.od-Persona--xl .od-Persona-primaryText{font-size:21px;font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;margin-top:2px}.od-Persona.od-Persona--xl .od-Persona-secondaryText{padding-top:7px}.od-Persona.od-Persona--xl .od-Persona-optionalText,.od-Persona.od-Persona--xl .od-Persona-tertiaryText{padding-top:8px;display:block}.od-Persona.od-Persona--darkText .od-Persona-primaryText{color:'},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-Persona.od-Persona--darkText .od-Persona-optionalText,.od-Persona.od-Persona--darkText .od-Persona-secondaryText,.od-Persona.od-Persona--darkText .od-Persona-tertiaryText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}"}])});define("Ox",["require","exports","OA","b5","Oz","Oy"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-presence",template:e("Oz"),viewModel:i.default});t.default=o});define("OA",["require","exports","ap","bF","aq","DM","OB","d"],function(e,t,r,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){r.__extends(e,i);function e(e){var t=i.call(this)||this;t.strings=a.strings;t.sip=o.isObservable(e.sip)?e.sip:o.observable(e.sip||"");t.presenceType=o.observable(0);t._dataProvider=t.resources.consume(n.resourceKey);t.registerPresence(t.sip());t.isVisible=!!t._presenceDisposable;t._sipSubscriptionOld=t.sip.subscribe(function(e){t.unRegisterPresence(e)},t,"beforeChange");t._sipSubscriptionNew=t.sip.subscribe(function(e){t.registerPresence(e)},t);t.presenceClass=t.createComputed(t._computePresenceClass);t.presenceTypeText=t.createComputed(t._computePresenceTypeText);return t}e.prototype.dispose=function(){i.prototype.dispose.call(this);this.unRegisterPresence(this.sip());this._sipSubscriptionOld&&this._sipSubscriptionOld.dispose();this._sipSubscriptionNew&&this._sipSubscriptionNew.dispose()};e.prototype.registerPresence=function(e){var t=this;this._dataProvider&&e&&(this._presenceDisposable=this._dataProvider.subscribePresence(e,function(e){t._presenceCallback(e)}))};e.prototype.unRegisterPresence=function(e){this._presenceDisposable&&this._presenceDisposable.dispose()};e.prototype._presenceCallback=function(e){!this.isDisposed&&this.presenceType&&this.presenceType(e)};e.prototype._computePresenceTypeText=function(){var e="";switch(this.presenceType()){case 1:e=this.strings.online;break;case 2:e=this.strings.busy;break;case 3:e=this.strings.doNotDisturb;break;case 4:e=this.strings.beRightBack;break;case 5:e=this.strings.away;break;case 6:e=this.strings.offline}return e};e.prototype._computePresenceClass=function(){var e="";switch(this.presenceType()){case 1:e="ms-Presence--Online "+s.getIconClassName("SkypeCheck");break;case 2:e="ms-Presence--Busy";break;case 3:e="ms-Presence--DoNotDisturb "+s.getIconClassName("SkypeMinus");break;case 4:e="ms-Presence--BeRightBack";break;case 5:e="ms-Presence--Away "+s.getIconClassName("SkypeClock");break;case 6:e="ms-Presence--Offline";break;case 7:case 0:e="ms-Presence--Hidden";break;default:e="ms-Presence--Hidden"}return"ms-Presence "+e};return e}(i.default);t.default=l});define("DM",["require","exports","aC","bA","dZ","DN","ba"],function(e,t,i,r,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var i=(this._dataSource=t.dataSource).getCapabilities().supportsMruCaching;i&&(this._mruCache=new a.default);this.MaxCacheSuggestions=i?5:0}e.prototype.search=function(e,r){var o,n,a=this,t={cached:null,promise:null};!this._mruCache||r.groupID||s.isFeatureEnabled(s.PeoplePickerGraph)&&r.useGraph||0<(n=this.searchMruCache(e,r&&r.filterExternalUsers)).length&&(t.cached=n);t.promise=new i.default(function(i,t){o=a._dataSource.search(e,r).then(function(e){if(e)if(n){0<n.length&&(n=a._removeStaleCacheResults(n,e));var t=n.map(function(e){return e.userId});i(e.filter(function(e){return t.indexOf(e.userId)<0}))}else i(e)},function(e){t(e)})},function(){o&&o.cancel()});return t};e.prototype.resolve=function(e,t){var i=this;return this._dataSource.resolve(e,t).then(function(e){i._mruCache&&e.isResolved&&i.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t)};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.searchMruCache=function(e,t){var i=[],r=this._mruCache;if(r){i=r.getItems(e,t);var o=this.MaxCacheSuggestions;i.length>o&&(i=i.splice(0,o))}return i};e.prototype._removeStaleCacheResults=function(r,e){var o=r.map(function(e){return e.userId}),n=[];e.forEach(function(e){var t=o.indexOf(e.userId);if(-1<t){var i=r[t];a.default.isCacheEntryFresh(i,e)&&n.push(i)}});return n};return e}();t.default=n;t.resourceKey=r.createResolvedResourceKey(e("module").id,n,{dataSource:o.people})});define("DN",["require","exports","ap","a3","a2"],function(e,t,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(o,r);function o(){var e=r.call(this,o._Key,o._DataStoreCachingType)||this;e._MaxItems=200;e._Version=7;var t=window._sharingContextInfo;t&&(o._StorageKey=""+o._StorageKey+t.webAbsoluteUrl);e._buffer=e.getValue(o._StorageKey);e._buffer&&e._buffer.version===e._Version||e.initializeBuffer();e._data={};for(var i=0;i<e._buffer.dataArray.length;i++)e._data[e._buffer.dataArray[i].email]=e._buffer.dataArray[i];return e}o.clear=function(){new n.default(o._Key,o._DataStoreCachingType).remove(o._StorageKey)};o.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};o.prototype.setItem=function(e){var t=this._data[e.email];if(t){if(o.isCacheEntryFresh(t,e))return;var i=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[i]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var r=this._buffer.dataArray[this._buffer.index];delete this._data[r.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(o._StorageKey,this._buffer)};o.prototype.getItems=function(e,t){for(var i=[],r=0;r<this._buffer.dataArray.length;r++){var o=(this._buffer.index-r+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[o].email&&0<=this._buffer.dataArray[o].email.toLowerCase().indexOf(e.toLowerCase())||this._buffer.dataArray[o].name&&0<=this._buffer.dataArray[o].name.toLowerCase().indexOf(e.toLowerCase()))||t&&1===this._buffer.dataArray[o].entityType||i.push(this._buffer.dataArray[o])}return i};o.prototype.containsItem=function(e){return!!this._data[e.email]};o.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version};o._Key="ClientPeoplePicker";o._StorageKey="MRU";o._DataStoreCachingType=a.default.local;return o}(n.default);t.default=r});define("Oz",[],function(){return"<a data-bind=\"css: presenceClass, visible: isVisible, attr: {title: presenceTypeText, 'aria-label': presenceTypeText}\" class=od-Persona-presence></a>"});define("Oy",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-Presence{display:inline-block;width:12px;height:12px;z-index:1;margin:3px;border-radius:50%;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;vertical-align:bottom}.ms-Presence.ms-Presence--Online{background-color:#7dbc00}.ms-Presence.ms-Presence--Busy{background-color:#e9001b}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Busy{background-color:#1AEBFF}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Busy{background-color:#37006E}}.ms-Presence.ms-Presence--DoNotDisturb{background-color:#eb0615}.ms-Presence.ms-Presence--BeRightBack{background-color:#f9ce15}.ms-Presence.ms-Presence--Away{background-color:#f9ce15}.ms-Presence.ms-Presence--Offline{background-color:#bd2eae}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}.ms-Presence.ms-Presence--Hidden{background-color:#f1f1f1}.ms-Presence::before{font-size:8px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";line-height:12px;vertical-align:top;position:relative}@media screen and (-ms-high-contrast:active){.ms-Presence{border-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";box-shadow:0 0 0 1px #1AEBFF inset;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence{border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px #37006E inset;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-Persona.od-Persona--lg .ms-Presence{width:20px;height:20px;border-width:3px}.od-Persona.od-Persona--lg .ms-Presence::before{line-height:20px;font-size:14px}.od-Persona.od-Persona--xl .ms-Presence{width:28px;height:28px;border-width:4px}.od-Persona.od-Persona--xl .ms-Presence::before{line-height:28px;font-size:21px}.od-focus--enabled a.ms-Presence{box-shadow:none}.od-focus--enabled .ms-Presence:focus:before{position:absolute;top:0;bottom:0;left:0;right:0;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";content:'';border-radius:50%}"}])});define("OL",[],function(){return"<div class=od-PersonaTile role=treeitem data-bind=\"attr: { tabindex: (tile.index === 0) && !(disableTab === true) ? 0 : -1, 'aria-label': ariaLabel }, hasFocus: tile.focused, scrollIntoView: { isSelected: tile.focused }\"><div class=od-PersonaTile-Persona data-bind=\"attr: { 'aria-hidden': true }, component: { name: personaTagName, params: tile.personaParams }\"></div></div>"});define("OK",["c","az"],function(e,t){e.loadStyles([{rawString:".od-PersonaTile:focus{border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}"}])});define("OH",[],function(){return'\x3c!--ko if: !sharingApiErrorMessage()--\x3e<div class=od-SharingSection-PermissionsPile role=region data-bind="attr: { \'aria-label\': sharingSectionSummary }"><div class=InfoPane-sectionHeader><h2 class=InfoPane-sectionHeaderText data-bind="text: strings.sharingHasAccess"></h2></div>\x3c!--ko if: isLoading()--\x3e<div class=SharingSection-status data-bind="text: statusText"></div>\x3c!--/ko--\x3e\x3c!--ko if: !isLoading()--\x3e<div class=od-SharingSection-PermissionsPile-personas>\x3c!--ko if: isShareLinkVisible--\x3e<div class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role=button tabindex=0 data-bind="tooltip: { content: addPeopleText }, keyboard: { Enter: onShareClick, Space: onShareClick }, click: onShareClick, attr: { \'aria-label\': addPeopleScreenReaderText }"><div class=od-SharingSection-PermissionsPile-addFriend><i class="ms-Icon ms-Icon--AddFriend" data-bind="icon: true"></i></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if: !privateDescription()--\x3e<div class=od-PermissionPile-FacePile><div class=ms-accessible data-bind="text: accessSummaryScreenReaderText"></div>\x3c!--ko foreach: permissionsFacepileCollection--\x3e\x3c!--ko if: linkNum--\x3e<div class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role=button tabindex=0 data-bind="tooltip: { content: $parent.linksDetails() }, keyboard: { Enter: $parent.launchPermissionsPanel.bind($component), Space: $parent.launchPermissionsPanel.bind($component) }, click: $parent.launchPermissionsPanel.bind($component), attr: { \'aria-label\': screenReadText, \'setsize\': $parent.totalFacePileCount(), \'posinset\': index+1 }"><div class=od-SharingSection-PermissionsPile-personaIcon data-bind="css:{ \'od-SharingSection-PermissionsPile-personaIcon--many\': $parent.hasMultiLinks() }"><i class="ms-Icon ms-Icon--Link" data-bind="icon: true"></i>\x3c!--ko if: linkNum > 1--\x3e<div class=od-SharingSection-PermissionsPile-numberText data-bind="text: linkNum.toString()"></div>\x3c!--/ko--\x3e</div></div></div>\x3c!--/ko--\x3e\x3c!--ko if: groupNum > 1--\x3e<div class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role=button tabindex=0 data-bind="tooltip: { content: $parent.groupsDetails() }, keyboard: { Enter: $parent.launchPermissionsPanel.bind($component), Space: $parent.launchPermissionsPanel.bind($component) }, click: $parent.launchPermissionsPanel.bind($component), attr: { \'aria-label\': screenReadText }"><div class=od-SharingSection-PermissionsPile-personaIcon data-bind="css: { \'od-SharingSection-PermissionsPile-personaIcon--many\': groupNum > 1 }"><i class="ms-Icon ms-Icon--Group" data-bind="icon: true"></i><div class=od-SharingSection-PermissionsPile-numberText data-bind="text: groupNum"></div></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if: personaTile && (!groupNum || groupNum === 1 && !$parent.showPermissionsPanel())--\x3e<div class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role=button tabindex=0 data-bind="tooltip: { content: personaTile.personaParams.person().name }, keyboard: { Enter: $parent.launchPermissionsPanel.bind($component), Space: $parent.launchPermissionsPanel.bind($component) }, click: $parent.launchPermissionsPanel.bind($component), attr: { \'aria-label\': screenReadText }"><div class=od-PersonaTile-Persona data-bind="component: { name: \'od-persona\', params: personaTile.personaParams }"></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if: extraPersona--\x3e<div class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role=button tabindex=0 data-bind="tooltip: { content: $parent.extraPersonaTooltipText }, keyboard: { Enter: $parent.launchPermissionsPanel.bind($component), Space: $parent.launchPermissionsPanel.bind($component) }, click: $parent.launchPermissionsPanel.bind($component), attr: { \'aria-label\': screenReadText }"><div class=od-SharingSection-PermissionsPile-personaMore><div class=od-SharingSection-PermissionsPile-moreNumber data-bind="text: $parent.extraPersonaText"></div></div></div></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--ko if: privateDescription() && !hasInheritedLink()--\x3e<div class=od-SharingSection-PermissionsPile-description><i class="ms-Icon ms-Icon--Lock" data-bind="icon: true"></i><div class=od-SharingSection-PermissionsPile-descriptionText data-bind="text: privateDescription"></div></div>\x3c!--/ko--\x3e\x3c!--ko if: hasGuest--\x3e<div class=od-SharingSection-PermissionsPile-description><i class="ms-Icon ms-Icon--Globe" data-bind="icon: true"></i><div class=od-SharingSection-PermissionsPile-descriptionText data-bind="text: sharedWithGuestText"></div></div>\x3c!--/ko--\x3e<div class=ms-font-s><a href=javascript:; class=ms-Link data-bind="tooltip: { content: showPermissionsPanelTitle }, click: launchPermissionsPanel, attr: { \'aria-label\': viewPermissionsScreenRead }"><span data-bind="text: showPermissionsPanelHintText"></span></a></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});define("N7",["require","exports","Oa","b5","N9","N8"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-sharingLink",template:e("N9"),viewModel:i.default,synchronous:!0});t.default=o});define("Oa",["require","exports","ap","aq","cE","DI","yk","aC","ci","Or","Ol","uA","p7","Ok","sX","V","bF","Os","Oh","Og","Ob","oq","mo","LY","ba"],function(e,t,i,a,s,l,d,r,o,c,u,p,m,h,f,g,n,y,v,_,b,x,S,C,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.passwordProtectedLinkIndicatorLabel=_.strings.passwordProtectedLinkIndicatorAriaLabel;t._engagement=t.resources.consume(s.resourceKey);t.link=e.link;var i=!e.isShareLinkVisible||e.isShareLinkVisible,r=6===t.link.kind?t._dedupeLinkMembers(t.link.linkInvitees.concat(t.link.linkMembers)):t.link.linkMembers;t.totalLinkMembers=t.createObservable(r);t._extraMembersCount=t.createPureComputed(t._getExtraMembers);t.extraMembersText=t.createPureComputed(t._getExtraMemberText);t.briefLinkMembers=t.createPureComputed(t._getBriefLinkMembers);t.extraLinkMembers=t.createPureComputed(t._getExtraLinkMembers);t.extraMembersName=t.createPureComputed(t._getExtraMembersName);t.showTotal=t.createObservable(!1);t.personaTagName=y.default.tagName;t.personaSize=7;t.isLinkVisible=10!==t.link.type&&i;t._onLinkRemoved=e.onLinkRemoved;t.isEditable=e.isEditable||!1;t.arePasswordLinksEnabled=P.isFeatureEnabled(P.EnablePasswordProtectedLinks);t.isPasswordProtectedLink=t.link&&t.link.hasPassword;t.panelOverlayTagName=v.default.tagName;t.editLinkTagName=b.default.tagName;t.editLinkPanelTitle=_.strings.editLinkPanelTitle;t.editLinkParams={onClose:t.onClosePanel.bind(t),onLinkRemoved:t._onLinkRemoved,sharingLink:t.link};t.showEditLinkPanel=t.createObservable(!1);t._sharingProvider=t.resources.consume(l.resourceKey);t.disableLinkText=_.strings.removeLinkButtonText;t.isInheritedText=t.link.isInherited?h.strings.InheritedText:"";t.sharingHintText=a.observable("");var o=t.resources.consume(d.resourceKey.optional);o&&o.loadData().then(function(e){t.sharingHintText(c.getLinkHintText(t.link,e.CompanyDisplayName))});t.canManageLinks=a.observable(!1);t._sharingProvider.getSharingData(t.link.item).getSettings().then(function(e){P.isFeatureEnabled(P.EnableLinkLevelManageAccess)?t.canManageLinks(t.link.linkMembers&&!t.link.isInherited&&!C.hasAutoAlbumTag(t.link.item)):t.canManageLinks(e.canManageLinks&&!t.link.isInherited&&!C.hasAutoAlbumTag(t.link.item))});t.addBindingHandlers({tooltip:m.default,selectOnFocus:p.default,react:x.default});t.iconComponent=S.Icon;t.iconComponentProps=t._getLinkIconProps(t.link);return t}e.prototype.logCopy=function(){this._engagement.logData({name:this.link.tag+"Link.SharingLink.Copy",isIntentional:!0});return!0};e.prototype.removeSharingLink=function(){var t=this,e=this.resources.consume(o.resourceKey);u.disableLinkConfirm(function(){t._engagement.logData({name:"Disable "+t.link.tag+" Link.SharingLink.Click",isIntentional:!0});var e={link:t.link,type:t.link.type,role:t.link.role,create:!1};return t._sharingProvider.manageSharingLinks([t.link.item],e).then(function(e){t._onLinkRemoved&&t._onLinkRemoved();return r.default.wrap(!0)},function(e){return!1})},function(e){t.isReady=e},e,"SharingLink")};e.prototype.onSharingHintClick=function(){if(this.isEditable){this._engagement.logData({name:this.link.tag+"Link.SharingLink.EditPermissions",isIntentional:!0});this.showEditLinkPanel(!0)}};e.prototype.onClosePanel=function(){this.showEditLinkPanel(!1)};e.prototype.showTotalLinkMembers=function(){this.showTotal(!0)};e.prototype.hideTotalLinkMembers=function(){this.showTotal(!1)};e.prototype._getExtraMembers=function(){var e=(this.link.linkMembers?this.link.linkMembers.length:0)-6;return 0<e?e+1:0};e.prototype._getExtraMemberText=function(){var e="",t=this._extraMembersCount();if(t){99<t&&(e=f.strings.sharingExtraNumberOverflow);e=g.format(f.strings.sharingExtraNumberText,t)}return e};e.prototype._getBriefLinkMembers=function(){var e=this.totalLinkMembers(),t=e?e.slice(0,5):[];return this._extraMembersCount()?t:e};e.prototype._getExtraLinkMembers=function(){var e=this.totalLinkMembers();return e?e.slice(5):[]};e.prototype._getExtraMembersName=function(){return this.totalLinkMembers().slice(5).map(function(e){return e.name}).join(h.strings.NameSeparator)};e.prototype._dedupeLinkMembers=function(e){for(var t=[],i=[],r=0,o=e;r<o.length;r++){var n=o[r],a=n.email;if(!t[a]){t[a]=!0;i.push(n)}}return i};e.prototype._getLinkIconProps=function(e){var t=e.kind;this.isAnonymousLink=5===t||4===t;this.isCSL=3===t||2===t;this.isPSL=6===t;this.isGeneric=!this.isAnonymousLink&&!this.isCSL&&!this.isPSL;var i="Link";this.isAnonymousLink?i="Globe":this.isCSL?i="Work":this.isPSL&&(i="PeopleAdd");return{iconName:i}};return e}(n.default);t.default=k});define("Or",["require","exports","Bk","V"],function(e,t,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getLinkHintText=function(e,t,i,r){if(null===e)return"";if(6===e.kind)return 2===e.role?s.strings.pslEditLabel:6===e.role?s.strings.pslReviewLabel:1===e.role?s.strings.pslViewLabel:s.strings.peopleSharingLinkLabel;if(8===e.type&&i&&0<i.length&&r&&1===r){for(var o=i[0].sharingInfo.role,n=1;n<i.length;n++)if(o!==i[n].sharingInfo.role){o=5;break}return 1===i.length?2===o?l.format(s.strings.InvitedUsersOneEditLinkText,i[0].name):1===o?l.format(s.strings.InvitedUsersOneViewLinkText,i[0].name):l.format(s.strings.InvitedUsersOneAccessLinkText,i[0].name):2===i.length?2===o?l.format(s.strings.InvitedUsersTwoEditLinkText,i[0].name,i[1].name):1===o?l.format(s.strings.InvitedUsersTwoViewLinkText,i[0].name,i[1].name):l.format(s.strings.InvitedUsersTwoAccessLinkText,i[0].name,i[1].name):3===i.length?2===o?l.format(s.strings.InvitedUsersThreeEditLinkText,i[0].name,i[1].name):1===o?l.format(s.strings.InvitedUsersThreeViewLinkText,i[0].name,i[1].name):l.format(s.strings.InvitedUsersThreeAccessLinkText,i[0].name,i[1].name):2===o?l.format(s.strings.InvitedUsersThreePlusEditLinkText,i[0].name,i[1].name,i.length-2):1===o?l.format(s.strings.InvitedUsersThreePlusViewLinkText,i[0].name,i[1].name,i.length-2):l.format(s.strings.InvitedUsersThreePlusAccessLinkText,i[0].name,i[1].name,i.length-2)}var a=e.expiration?new Date(e.expiration).toLocaleDateString():null;if(4===e.entityType)return s.strings.AnonymousViewText;switch(e.type){case 9:return 2===e.role?t?l.format(s.strings.OrganizationEditText,t):s.strings.NoNameOrganizationEditText:t?l.format(s.strings.OrganizationViewText,t):s.strings.NoNameOrganizationViewText;case 8:return 2===r?2===e.role?s.strings.ToLineEditText:s.strings.ToLineViewText:s.strings.DirectLinkText;case 6:return e.supportsExpiration&&a?d(6,new Date(e.expiration)):s.strings.AnonymousEditText;case 5:return e.supportsExpiration&&a?d(5,new Date(e.expiration)):s.strings.AnonymousViewText;case 3:return s.strings.AnonymousEmbedText;case 4:return l.format(s.strings.appText,e.name);case 7:return s.strings.AnonymousSurveyText;case 10:return s.strings.OneNoteSharingText;default:return""}};t.getWhoCanAccessLinkOptions=function(e,t,i){var r=[];if(1===i||2===i){e.anonymousLinksEnabled&&e.canManageLinks&&r.push({text:s.strings.AnonymousOptionText,type:6});e.organizationLinksEnabled&&e.canManageLinks&&(t?r.push({text:l.format(s.strings.NamedOrganizationOptionText,t),type:9}):r.push({text:s.strings.UnnamedOrganizationOptionText,type:9}))}1===i?r.push({text:s.strings.SpecificPeopleOptionText,type:8}):r.push({text:s.strings.ToLineOptionText,type:8});return r};t.getSharingInfoText=function(e){return 0===e.length?null:1===e.length?l.format(s.strings.PermissionsInfoOneAccessLinkText,e[0].name):2===e.length?l.format(s.strings.PermissionsInfoTwoAccessLinkText,e[0].name,e[1].name):3===e.length?l.format(s.strings.PermissionsInfoThreeAccessLinkText,e[0].name,e[1].name):l.format(s.strings.PermissionsInfoThreePlusAccessLinkText,e[0].name,e[1].name,e.length-2)};function d(e,t){var i=new Date(t).toLocaleDateString(),r=t.getTime()<Date.now();return 6===e?l.format(r?s.strings.AnonymousEditExpiredText:s.strings.AnonymousEditExpiryText,i):5===e?l.format(r?s.strings.AnonymousViewExpiredText:s.strings.AnonymousViewExpiryText,i):""}});define("Ol",["require","exports","aq","Oq","a0","Om","aC","dI","DL","V"],function(e,t,n,a,s,l,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.disableLinkConfirm=function(t,i,e,r){var o=n.observable(!0);return e.requestDialog({title:a.strings.DisableLinkConfirmationTitle,size:"Medium",component:{name:l.default.tagName,params:{message:a.strings.DisableLinkConfirmationMessage}},actions:[{name:a.strings.DisableLinkConfirmationButton,execute:function(){s.Engagement.logData({name:"Confirm.DisableLink."+r+".Click",isIntentional:!0});o(!1);var e=t().then(function(e){return d.default.wrap(e?2:3)});i(e);return e},isDefault:!0,isAvailable:o,icon:new c.default("Save"),automationId:"UnshareConfirm"},{name:a.strings.KeepExistingLinkButton,execute:function(){s.Engagement.logData({name:"KeepExisting.DisableLink."+r+".Click",isIntentional:!0});return d.default.wrap(3)},isDefault:!1,icon:new c.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};t.getSharingStatusText=function(e,t){for(var i=0,r=0,o=!1,n=0,a=e.people;n<a.length;n++){var s=a[n];if(2===s.entityType)r++;else if(0!==s.sharingInfo.role){i++;1===s.entityType&&(o=!0)}}var l="";0<r&&0<i?l=1<r?p.format(o?u.strings.SharedWithPeopleGroupsAndExternalUsers:u.strings.SharedWithPeopleAndGroups,t,r,i):p.format(o?u.strings.SharedWithPeopleGroupAndExternalUsers:u.strings.SharedWithPeopleAndGroup,t,i):1===r?l=p.format(u.strings.SharedWithGroup,t):1<r?l=p.format(u.strings.SharedWithGroups,t,r):0<i&&o?l=p.format(u.strings.SharedWithPeopleAndExternalUsers,t,i):1<i?l=p.format(u.strings.SharedWithPeople,t,i):1===i&&(l=p.format(u.strings.SharedWithPerson,t));return l};t.getNumberOfDaysUntilExpiry=function(e){if(!e)return 0;var t=e.getTime()-(new Date).getTime();return Math.ceil(t/864e5)}});define("Ob",["require","exports","Oe","b5","Od","Oc"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-editLink",template:e("Od"),viewModel:i.default,synchronous:!0});t.default=o});define("Oe",["require","exports","ap","cE","eX","Og","Bk","Ol","DI","aC","ci","uA","Of","bF","ba"],function(e,t,i,a,s,l,d,r,c,o,u,p,m,n,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.setPasswordAriaLabel=l.strings.setPasswordAriaLabel;var i=e.onClose,r=e.onLinkRemoved,o=e.sharingLink;t._onClose=i;t._onLinkRemoved=r;t._sharingLink=o;t.addBindingHandlers({selectOnFocus:p.default});t._itemProvider=t.resources.consume(s.resourceKey);t._sharingProvider=t.resources.consume(c.resourceKey);t._engagement=t.resources.consume(a.resourceKey);t._sharingLinkExpirationHelper=new(t.managed(m.default));t.cancelButtonText=l.strings.cancelButtonText;t.createBackgroundComputed(t._computeValidInput);t.invalidPasswordText=d.strings.invalidPasswordError;t.linkExpirationInDays=t.createObservable(t._getDefaultLinkExpirationInDays(t._sharingLink.expiration));t.linkExpiresChecked=t.createObservable(!!t._sharingLink.expiration);t.linkExpiresInputLabel=t.createPureComputed(t._computeLinkExpiresInputLabel);t.linkExpiresText=l.strings.setExpirationLabel;t.passwordChanged=t.createObservable(!1);t.passwordValue=t.createObservable("");t.updateButtonText=l.strings.updateButtonText;t.setPasswordPermissionsWarning=d.strings.SetPasswordPermissionsWarning;t.removeLinkButtonText=l.strings.removeLinkButtonText;t.arePasswordLinksEnabled=h.isFeatureEnabled(h.EnablePasswordProtectedLinks);t.isSetPasswordChecked=t.createObservable(!!t._sharingLink.hasPassword);t.setPasswordLabel=l.strings.setPasswordLabel;t.arePasswordLinksEnabled&&t._onSetPasswordChecked();t.isPasswordInvalid=t.createComputed(t._computeIsPasswordInvalid);t.isUpdateButtonDisabled=t.createComputed(t._computeIsUpdateButtonDisabled);return t}e.prototype.onUpdateClick=function(){var t=this;this._logEngagementEvent("Update");var e=this._sharingLink,i=[e.item],r=this.linkExpiresChecked.peek()?this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(this.linkExpirationInDays.peek(),10)):null,o={type:e.type,role:e.role,create:!0,expiration:r};if(this.arePasswordLinksEnabled){var n=this.isSetPasswordChecked.peek(),a=n&&this.passwordChanged.peek(),s=!n&&e.hasPassword;a&&(o.password=this.passwordValue.peek());s&&(o.password="")}this._sharingProvider.manageSharingLinks(i,o).then(function(e){t._itemProvider.invalidateItem(i[0].key,{triggerFetch:!0});t._onClose()})};e.prototype.changePasswordInput=function(){this.passwordChanged(!0);this.passwordValue("")};e.prototype.onCancelClick=function(){this._logEngagementEvent("Cancel");this._onClose()};e.prototype.onRemoveLinkClicked=function(){var t=this,i=this._sharingLink,e=this.resources.consume(u.resourceKey);this._logEngagementEvent("RemoveLink");r.disableLinkConfirm(function(){t._engagement.logData({name:"Disable "+i.tag+" Link.SharingLink.Click",isIntentional:!0});var e={link:i,type:i.type,role:i.role,create:!1};return t._sharingProvider.manageSharingLinks([i.item],e).then(function(e){t._onLinkRemoved&&t._onLinkRemoved();return o.default.wrap(!0)},function(e){return!1})},function(e){},e,"EditLink")};e.prototype._onSetPasswordChecked=function(){if(this._sharingLink&&this._sharingLink.hasPassword){this.passwordValue("        ")}};e.prototype._computeValidInput=function(){var e=this.linkExpirationInDays(),t=parseInt(e,10),i=t.toString();if(t<=0&&t>m.MAX_EXPIRATION){i="";this.linkExpiresChecked(!1)}this.linkExpirationInDays(i)};e.prototype._computeIsPasswordInvalid=function(){var e=this.passwordValue();return this.isSetPasswordChecked()&&this.passwordChanged()&&0<e.length&&0===e.trim().length};e.prototype._computeIsUpdateButtonDisabled=function(){var e=this.linkExpiresChecked(),t=this.isSetPasswordChecked(),i=this.isPasswordInvalid();if(!e&&!t)return!1;var r=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeExpirationValidity(r)!==m.LinkExpirationValidity.Valid||i};e.prototype._computeLinkExpiresInputLabel=function(){var e=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeLinkExpiresInputLabel(e)};e.prototype._getDefaultLinkExpirationInDays=function(e){var t=parseInt(m.DEFAULT_EXPIRATION,10);e&&(t=this._sharingLinkExpirationHelper.getDaysFromToday(new Date(e)));return t.toString()};e.prototype._logEngagementEvent=function(e){this._engagement.logData({name:"EditLinkPanel."+e+".Click",isIntentional:!0,extraData:{linkExpiration:this.linkExpirationInDays.peek(),hasPassword:0!==this.passwordValue.peek().length}})};return e}(n.default);t.default=f});define("Of",["require","exports","ap","hs","bN","V","Bk"],function(e,r,i,o,t,n,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.DEFAULT_EXPIRATION="30";r.MAX_EXPIRATION=1825;var s;!function(e){e[e.Invalid=0]="Invalid";e[e.Empty=1]="Empty";e[e.Valid=2]="Valid"}(s=r.LinkExpirationValidity||(r.LinkExpirationValidity={}));var l=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.computeExpirationValidity=function(e){if(""===e)return s.Empty;var t=e.match(/^-?[0-9]+/);if(t&&t[0]!==e||!t)return s.Invalid;var i=parseInt(e,10);return i<=0||i>r.MAX_EXPIRATION?s.Invalid:s.Valid};e.prototype.computeLinkExpiresInputLabel=function(e){if(this.computeExpirationValidity(e)===s.Valid){var t=parseInt(e,10),i=new Date;i.setDate(i.getDate()+t);return n.format(a.strings.daysWithDate,o.getShortDisplayDate(i))}return a.strings.days};e.prototype.getDaysFromToday=function(e){var t=new Date;return Math.round((e.getTime()-t.getTime())/864e5)};e.prototype.calculateLinkExpiration=function(e){if(0<e&&e<=r.MAX_EXPIRATION){var t=new Date;t.setDate(t.getDate()+e);return t.toISOString()}return null};return e}(t.default);r.default=l});define("Od",[],function(){return'<div class=od-EditLink><div class="ms-CheckBox od-EditLink-linkExpiresCheckbox"><input type=checkbox id=od-EditLink-linkExpires data-bind="checked: linkExpiresChecked" class=ms-CheckBox-input> <label for=od-EditLink-linkExpires class=ms-CheckBox-field data-bind="css: {\'is-checked\': linkExpiresChecked}"><span data-bind="text: linkExpiresText, automation: \'linkExpiresText\'" class=ms-Label></span></label>\x3c!--ko if: linkExpiresChecked()--\x3e<div class=od-EditLink-linkExpiresInputDiv><input id=od-EditLink-linkExpiresInput class=od-EditLink-linkExpiresInput type=number data-bind="value: linkExpirationInDays, selectOnFocus: { isPermanent: false, isReentrant: true }"> <label for=od-EditLink-linkExpiresInput><span class=od-EditLink-linkExpiresInputLabel data-bind="text: linkExpiresInputLabel"></span></label></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: arePasswordLinksEnabled--\x3e<div class="ms-CheckBox od-EditLink-setPasswordCheckbox"><input type=checkbox id=od-EditLink-setPassword data-bind="checked: isSetPasswordChecked" class=ms-CheckBox-input> <label for=od-EditLink-setPassword class=ms-CheckBox-field data-bind="css: {\'is-checked\': isSetPasswordChecked}"><span data-bind="text: setPasswordLabel, automation: \'setPasswordLabel\'" class=ms-Label></span></label>\x3c!--ko if: isSetPasswordChecked()--\x3e<div class=od-EditLink-setPasswordInputContainer><input id=od-EditLink-setPasswordInput class=od-EditLink-setPasswordInput type=password data-bind="attr: { \'aria-label\': setPasswordAriaLabel, \'aria-invalid\': isPasswordInvalid() }, value: passwordValue, valueUpdate: \'input\', click: changePasswordInput, selectOnFocus: { isPermanent: false, isReentrant: true }, css: { \'od-EditLink-invalidPasswordOutline\': isPasswordInvalid() }"></div>\x3c!--ko if: isPasswordInvalid()--\x3e<div class=od-EditLink-invalidPasswordError role=alert data-bind="text: invalidPasswordText"></div>\x3c!--/ko--\x3e<div class=od-EditLink-passwordProtectedLinkInformationArea><i class="ms-Icon ms-Icon--Info od-EditLink-passwordProtectedLinkInformationIcon" data-bind="icon: true"></i><div class=od-EditLink-passwordProtectedLinkInformationTextArea data-bind="text: setPasswordPermissionsWarning"></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class=od-EditLink-removeLinkHolder><i class="ms-Icon ms-Icon--Delete" data-bind="icon: true"></i> <button class=od-EditLink-removeLinkText data-bind="click: onRemoveLinkClicked, text: removeLinkButtonText"></button></div><div class=od-EditLink-buttons><button class="od-Button od-Button--primary" role=button data-bind="click: onUpdateClick, disable: isUpdateButtonDisabled"><span class=od-Button-label data-bind="text: updateButtonText"></span></button> <button class=od-Button role=button data-bind="click: onCancelClick"><span class=od-Button-label data-bind="text: cancelButtonText"></span></button></div></div>'});define("Oc",["c","az"],function(e,t){e.loadStyles([{rawString:".od-EditLink{margin-top:20px}.od-EditLink-linkExpiresInputDiv{display:inline-block;margin:12px 0 14px}.od-EditLink-linkExpiresInput{width:40px}.od-EditLink-linkExpiresCheckbox{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-EditLink-setPasswordInputContainer{margin-top:12px}.od-EditLink-setPasswordInput{height:28px}.od-EditLink-invalidPasswordOutline{outline:1px solid "},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-EditLink-invalidPasswordError{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:';font-size:12px;margin-top:8px}.od-EditLink-setPasswordCheckbox{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-EditLink-removeLinkHolder{-ms-flex-align:center;align-items:center;color:#a80000;display:-ms-flexbox;display:flex;margin:34px 0}.od-EditLink-removeLinkText{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;background:0 0;border:none;color:#a80000;cursor:pointer}[dir=ltr] .od-EditLink-removeLinkText{margin-left:4px}[dir=rtl] .od-EditLink-removeLinkText{margin-right:4px}.od-EditLink-passwordProtectedLinkInformationArea{margin-top:8px;background-color:'},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";display:-ms-flexbox;display:flex}.od-EditLink-passwordProtectedLinkInformationTextArea{padding:10px;font-size:14px}.od-EditLink-passwordProtectedLinkInformationIcon{font-size:17px;padding-top:14px}html[dir=ltr] .od-EditLink-passwordProtectedLinkInformationIcon{padding-left:10px}html[dir=rtl] .od-EditLink-passwordProtectedLinkInformationIcon{padding-right:10px}"}])});define("N9",[],function(){return'<div class=od-SharingLink role=group data-bind="attr: { \'aria-label\': sharingHintText }"><div class="od-SharingLink-cell od-SharingLink-iconCell"><div class=od-SharingLink-iconBackground data-bind="css: { \'od-SharingLink-anonymous-bg\': isAnonymousLink, \'od-SharingLink-csl-bg\': isCSL, \'od-SharingLink-psl-bg\': isPSL, \'od-SharingLink-generic-bg\': isGeneric }"></div><div class=od-SharingLink-icon role=presentation data-bind="react: { componentType: iconComponent, props: iconComponentProps }, css: { \'od-SharingLink-anonymous\': isAnonymousLink, \'od-SharingLink-csl\': isCSL, \'od-SharingLink-psl\': isPSL, \'od-SharingLink-generic\': isGeneric }"></div></div><div class=od-SharingLink-cell><div class="od-Sharinglink-table od-Sharinglink-url"><div class=od-Sharinglink-row><div class=od-SharingLink-cell>\x3c!--ko if: isLinkVisible--\x3e<input class="od-SharingLink-input od-TextField-field" type=text readonly data-bind="value: link.url, selectOnFocus: { isPermanent: true }, event: { copy: $component.logCopy.bind($component) }">\x3c!--/ko--\x3e\x3c!--ko ifnot: isLinkVisible--\x3e<span class=od-SharingLink-linkSwitcher data-bind="text: sharingHintText"></span>\x3c!--/ko--\x3e</div>\x3c!--ko if: canManageLinks--\x3e<div class=od-SharingLink-cell><button class=od-SharingLink-removeLinkButton data-bind="css: { \'od-SharingLink-removeLinkButton-leftMargin\': isLinkVisible }, click: removeSharingLink, attr: { \'title\': disableLinkText, \'aria-label\': disableLinkText }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: isLinkVisible--\x3e<div class=od-SharingLink-linkSwitcher>\x3c!--ko if: isEditable--\x3e<div class=od-SharingLink-sharingHintContainer><button class=od-SharingLink-sharingHint data-bind="click: onSharingHintClick">\x3c!--ko text: sharingHintText--\x3e\x3c!--/ko--\x3e<i class="ms-Icon ms-Icon--ChevronDown od-SharingLink-chevron" data-bind="icon: true"></i></button>\x3c!--ko if: arePasswordLinksEnabled--\x3e\x3c!--ko if: isPasswordProtectedLink--\x3e<i class="ms-Icon ms-Icon--Lock od-SharingLink-lock" role=img data-bind="icon: true, attr: {\'aria-label\': passwordProtectedLinkIndicatorLabel }"></i>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: !isEditable--\x3e<div class=od-SharingLink-sharingHint data-bind="text: sharingHintText"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: link.linkMembers--\x3e<div class=od-SharingLink-linkUser><div class=od-Sharing-briefLinkMembers>\x3c!--ko foreach: briefLinkMembers--\x3e<div class=od-SharingLink-linkMember data-bind="component: { name: $parent.personaTagName, params: { person: $data, personaSize: $parent.personaSize } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: extraMembersText()--\x3e\x3c!--ko if: !showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronDown" role=button data-bind="icon: true, click: showTotalLinkMembers, tooltip: { content: extraMembersName }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronUp" role=button data-bind="icon: true, click: hideTotalLinkMembers"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: showTotal()--\x3e<div class=od-Sharing-extraLinkMembers>\x3c!--ko foreach: extraLinkMembers--\x3e<div class=od-SharingLink-linkMember data-bind="component: { name: $parent.personaTagName, params: { person: $data, personaSize: $parent.personaSize } }"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: showEditLinkPanel--\x3e\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: {\r\n onClose: $component.onClosePanel.bind($component),\r\n title: editLinkPanelTitle\r\n }\r\n }--\x3e\x3c!--ko component: {\r\n name: editLinkTagName,\r\n params: editLinkParams\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("N8",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-SharingLink{margin-bottom:10px;display:-ms-flexbox;display:flex}.od-SharingLink-cell{display:table-cell;max-width:200px}.od-SharingLink-iconCell{vertical-align:top;width:48px;position:relative}[dir=ltr] .od-SharingLink-iconCell{padding-right:10px}[dir=rtl] .od-SharingLink-iconCell{padding-left:10px}.od-SharingLink-icon{display:inline-block;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font-size:28px;min-width:48px;height:48px;text-align:center;line-height:48px;position:absolute;background-color:transparent;border-width:1px;border-style:solid;border-radius:50%}.od-SharingLink-iconBackground{display:inline-block;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";border-radius:50%;min-width:48px;height:48px;border-style:solid;border-width:1px;position:absolute}[dir=ltr] .od-SharingLink-iconBackground{margin-right:10px}[dir=rtl] .od-SharingLink-iconBackground{margin-left:10px}.od-SharingLink-url .od-SharingLink-cell{width:100%}.od-SharingLink-table{display:table;width:100%}.od-SharingLink-row{display:table-row}.od-SharingLink-input{width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}.od-SharingLink-removeLinkButton{margin:0;padding:5px;border:0;background:0 0;cursor:pointer;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SharingLink-removeLinkButton-leftMargin{margin-left:4px}[dir=rtl] .od-SharingLink-removeLinkButton-leftMargin{margin-right:4px}.od-SharingLink-linkSwitcher{display:inline;cursor:pointer}.od-SharingLink-linkMember{display:inline-block;padding:2px 4px}.od-SharingLink-linkMember .ms-Icon{font-size:12px;width:24px;text-align:center;line-height:24px}.od-SharingLink-linkUser{width:200px}.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronDown,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp{width:24px;height:24px;border-radius:50%;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:';display:inline-block;margin:0 4px;line-height:24px}.od-SharingLink-linkUser .ms-Icon--ChevronDown:before,.od-SharingLink-linkUser .ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--chevronDown:before{line-height:24px;display:table-cell;width:24px;text-align:center}.od-SharingLink-chevron{font-size:11px}[dir=ltr] .od-SharingLink-chevron{margin-left:4px}[dir=rtl] .od-SharingLink-chevron{margin-right:4px}.od-SharingLink-sharingHint{display:inline;border:none;background:0 0;padding:0;cursor:pointer;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400}html[dir=ltr] .od-SharingLink-sharingHint{text-align:left}html[dir=rtl] .od-SharingLink-sharingHint{text-align:right}.od-SharingLink-anonymous{color:#107c10}.od-SharingLink-csl{color:'},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-SharingLink-psl{color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:"}.od-SharingLink-generic{border-color:transparent}.od-SharingLink-anonymous-bg{background-color:#107c10;border-color:#107c10;opacity:.1}.od-SharingLink-csl-bg{background-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";opacity:.1}.od-SharingLink-psl-bg{background-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:";border-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:";opacity:.1}.od-SharingLink-generic-bg{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=ltr] .od-SharingLink-lock{margin-left:12px}html[dir=rtl] .od-SharingLink-lock{margin-right:12px}.od-SharingLink-sharingHintContainer{display:-ms-flexbox;display:flex}"}])});define("N0",["require","exports","at","mo","sX","N1"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=1<e.items.length?o.strings.externalItemsMessage:o.strings.externalItemMessage;return i.createElement("div",{className:"od-DetailsPane-LegacySection"},i.createElement("div",{className:"InfoPane-section InfoPaneSection--itemStatus no-arrow"},i.createElement(r.Icon,{className:"itemStatus-icon",iconName:"Globe"}),i.createElement("div",{className:"itemStatus-message"},t)))}});define("N1",["c","az"],function(e,t){e.loadStyles([{rawString:'.InfoPaneSection--itemStatus{display:-ms-flexbox;display:flex}html[dir=ltr] .InfoPaneSection--itemStatus .itemStatus-icon{margin-right:8px}html[dir=rtl] .InfoPaneSection--itemStatus .itemStatus-icon{margin-left:8px}.InfoPaneSection--itemStatus .itemStatus-message{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}'}])});define("QN",["c","az"],function(e,t){e.loadStyles([{rawString:".od-DetailsPane-PrimaryPane-wrapper{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.od-DetailsPane-PrimaryPane{padding-bottom:12px}.od-DetailsPane-PrimaryPane--isCollapsed .od-DetailsPane-PrimaryPane{padding-bottom:0}.od-DetailsPane-PrimaryPane-header{padding:10px 16px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px;box-shadow:0 1px 3px rgba(0,0,0,.08);background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";display:-ms-flexbox;display:flex}.od-DetailsPane-PrimaryPane-header-icon{display:inline-block}.od-DetailsPane-PrimaryPane-header-title{display:inline-block}.od-DetailsPane-PrimaryPane-header-icon .FileTypeIcon-icon{width:20px!important;height:20px!important}.od-DetailsPane-PrimaryPane-header-title{margin-left:12px;line-height:23px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-DetailsPane-PrimaryPane-body{position:relative}.od-DetailsPane-PrimaryPane--isCollapsed .od-DetailsPane-PrimaryPane-body{height:0;overflow:hidden}"}])});define("NX",["require","exports","ap","at","QK","QG","QF","NZ","mo","jP","NY"],function(e,t,i,n,a,s,o,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){if(this._headerDiv){this._onHeaderHeightChange();this._events.on(window,"resize",this._onHeaderHeightChange)}};t.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.sectionGroup!==this.props.sectionGroup||e.minHeight!==this.props.minHeight||e.onHeightChange!==this.props.onHeightChange||e.onHeaderHeightChange!==this.props.onHeaderHeightChange||e.resources!==this.props.resources};t.prototype.componentDidUpdate=function(e){e.sectionGroup.sections.length&&this.props.sectionGroup.sections.length||e.sectionGroup.sections.length===this.props.sectionGroup.sections.length||this._onHeaderHeightChange()};t.prototype.componentWillUnmount=function(){this._headerDiv&&this._events.off(window,"resize",this._onHeaderHeightChange)};t.prototype.render=function(){var t=this,e=this.props,i=e.sectionGroup,r=e.onHeightChange,o=e.minHeight;return n.createElement("div",{className:"od-DetailsPane-SecondaryPane-wrapper",style:{minHeight:i.sections.length&&o||0}},n.createElement("div",{className:c.css("od-DetailsPane-SecondaryPane",{"od-DetailsPane-SecondaryPane--disabled":!i.sections.length})},n.createElement("div",{"aria-hidden":"true",ref:function(e){t._headerDiv=e}},n.createElement(s.Sticky,{stickyPosition:s.StickyPositionType.Both},this._renderSectionsHeader())),n.createElement("div",{className:"od-DetailsPane-SecondaryPane-body"},n.createElement(a.default,{onHeightChange:r},this._renderSectionsBody()))))};t.prototype._renderSectionsHeader=function(){var e=this.props,t=e.sectionGroup,i=e.onHeaderClick,r=e.isHeaderClickDisabled;return n.createElement("button",{className:c.css("od-DetailsPane-SecondaryPane-header",{"od-DetailsPane-SecondaryPane-header--disabled":!t.sections.length,"od-DetailsPane-SecondaryPane-header--headerClickDisabled":r}),"aria-hidden":"true",onClick:!r&&i},n.createElement("div",{className:"od-DetailsPane-SecondaryPane-header-icon"},n.createElement(d.Icon,{iconName:"GripperBarHorizontal"})),n.createElement("div",{className:"od-DetailsPane-SecondaryPane-header-text"},o.strings.moreDetailsTitle))};t.prototype._renderSectionsBody=function(){var e=this.props,t=e.items,i=e.sectionGroup,r=e.resources;return n.createElement(l.default,{items:t,sections:i.sections,resources:r})};t.prototype._onHeaderHeightChange=function(){if(this.props.onHeaderHeightChange){var e=this._headerDiv.clientHeight;this.props.onHeaderHeightChange(e)}};i.__decorate([c.autobind],t.prototype,"_onHeaderHeightChange",null);return t}(c.BaseComponent);t.default=r});define("NY",["c","az"],function(e,t){e.loadStyles([{rawString:".od-DetailsPane-SecondaryPane-wrapper{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-DetailsPane-SecondaryPane{padding-bottom:12px}.od-DetailsPane-SecondaryPane.od-DetailsPane-SecondaryPane--disabled{padding-bottom:0}.od-DetailsPane-SecondaryPane-header{padding:0 16px;text-align:center;height:48px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:12px;box-shadow:0 -1px 1px rgba(0,0,0,.08);border:0;width:100%;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.ms-ScrollablePane-stickyAbove .od-DetailsPane-SecondaryPane-header{box-shadow:0 -1px 3px rgba(0,0,0,.08)}.od-DetailsPane-SecondaryPane-header:hover{cursor:pointer}.od-DetailsPane-SecondaryPane-header--headerClickDisabled:hover{cursor:default}.od-DetailsPane-SecondaryPane-header--disabled{display:none}.od-DetailsPane-SecondaryPane-body{position:relative}.od-DetailsPane-SecondaryPane-header-icon{padding-top:3px;font-size:17px}"}])});define("NW",["c","az"],function(e,t){e.loadStyles([{rawString:".od-DetailsPaneWrapper{position:absolute;top:0;bottom:0;left:0;right:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=ltr] .od-DetailsPaneWrapper{border-left:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}html[dir=rtl] .od-DetailsPaneWrapper{border-right:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-DetailsPane{height:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-DetailsPane--secondaryPaneDisabled{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.od-DetailsPane-scrollablePane{overflow-x:hidden}"}])});define("NU",["require","exports","ap","bN","aC","dZ","c7","bA"],function(o,e,t,i,n,a,s,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=function(r){t.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._urlDataSource=t.urlDataSource;return i}e.prototype.getInfoPaneManager=function(){var e=this._urlDataSource.getAppSubfolder(!0);return this._onRequire(e)};e.prototype._onRequire=function(e){var i;switch(e){case"odb":i="QX";break;case"odc":i="auH"}return s.loadModule({path:i,getModule:function(){return new n.default(function(e,t){o([i],e,t)})}})};e.dependencies=t.__assign({},i.default.dependencies,{urlDataSource:a.url});return e}(i.default);e.default=l;e.resourceKey=r.createResolvedResourceKey(o("module").id,l)});define("NR",[],function(){return'\x3c!--ko if: useNewDetailsPane--\x3e<div data-bind="react: { componentType: detailsPaneComponentType, props: detailsPaneProps }"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: useNewDetailsPane--\x3e\x3c!--ko control: {\r\n specification: knockoutSpecification,\r\n placeholder: knockoutPlaceholder\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("QT",["require","exports","QW","b3","QV","QU"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"ms-info-pane",name:e("module").id,template:e("QV"),viewModelType:i.default});t.default=t.resourceKey});define("QW",["require","exports","ap","bF","bX","OR","V","sX","dZ","qS","d5","aL","bR","jG","NU","oy","cV","ba","cU"],function(e,t,i,r,n,a,s,o,l,d,c,u,p,m,h,f,g,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=o.strings,b=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,t)||this;i.addBindingHandlers({scrollContainer:v.default,toggle:a.default,clientRect:d.default,preserveFocus:g.default,delayedHasFocus:f.default});var r=i.observables;i._showSections=e.showSections||r.create(!0);i._defaultSelectionModel=t.defaultSelection;i._selectionModelGroup=t.selectionModelGroup;i._currentItem=t.currentItem;i._responsiveUI=t.responsiveUI;i._sectionWithFocus=t.sectionWithFocus;i._isExpanded=t.isInfoPaneExpanded;i._infoPaneProvider=t.infoPaneProvider;i.ariaLabel=_.infoPaneAriaLabel;i.screenReaderInformation=_.screenReaderInformation;i.isPaneFocused=r.create(!1);i._allSections=r.createArray();(i._selection=r.pureCompute(i._computeSelectionModel)).equalityComparer=p.objectStrictEquality;i._wasEverExpanded=r.pureCompute(i._computeWasEverExpanded);(i.item=r.pureCompute(i._computeItem).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})).equalityComparer=p.objectStrictEquality;i.selectionMessage=r.pureCompute(i._computeSelectionMessage);i.availableSections=i._getAvailableSections();i.size=r.create();i.size.equalityComparer=u.deepCompare;i.sizeCss=r.pureCompute(i._computeSizeCss).extend({rateLimit:500});r.backgroundCompute(i._computeAllSections);return i}e.prototype._computeWasEverExpanded=function(){return this._wasEverExpanded.peek()||this._isExpanded()};e.prototype._computeAllSections=function(){var l=this,d=this._sectionWithFocus;this._showSections()&&this._wasEverExpanded()&&this._infoPaneProvider.getInfoPaneManager().then(function(e){for(var t,i=new(l.managed(e)),r=[].concat.apply([],i.getSectionGroups().map(function(e){return e.sections})),o=0,n=r;o<n.length;o++){var a=n[o],s=!1;if(d&&d.peek()===a.type){s=!0;t=a}a.legacyComponent.params={item:l.item,hasFocus:s}}d&&d(null);l._allSections(r);l.isPaneFocused(!t)})};e.prototype._getAvailableSections=function(){var r=this;return this.addDisposable(this._allSections.filter(function(e){var t=r.item();if((7===e.type||0===e.type)&&y.isFeatureEnabled(y.SPListBulkEditItemProperties)){var i=r._selection().selection().map(function(e){return r.peekUnwrapObservable(e)});i&&0!==i.length||!t||(i=[t]);return!!i&&e.isAvailable(i)}return!!t&&e.isAvailable([t])}))};e.prototype._computeItem=function(){var e=this._computeSelectionLength();return 0===e?this._currentItem():1===e?this.unwrapObservable(this._selection().selection()[0]):void 0};e.prototype._computeSelectionMessage=function(){var e=this._computeSelectionLength();if(1<e&&!y.isFeatureEnabled(y.SPListBulkEditItemProperties))return s.format(_.selectedItemsFormatString,e)};e.prototype._computeSelectionLength=function(){var e=this._selection();return e&&e.selection().length||0};e.prototype._computeSizeCss=function(){var e=this.size(),t=this._responsiveUI,i=c.default.determineWindowSize(e&&e.width||319);this.availableSections().length<5&&0<t.compareSize(i,"Large")&&(i="Large");return c.default.determineCssClass(i)};e.prototype._computeSelectionModel=function(){var e=this._selectionModelGroup;if(e){var t=e.currentSelection();if(t&&t.itemSet)return t}return this._defaultSelectionModel};e.dependencies=i.__assign({},r.default.dependencies,{currentItem:n.currentItem,selectionModelGroup:n.currentSelectionModelGroup.optional,defaultSelection:n.itemsSelection,responsiveUI:c.resourceKey,urlDataSource:l.url,sectionWithFocus:n.focusedInfoPaneSection.optional,isInfoPaneExpanded:m.base.infoPane.isInfoPaneExpanded,infoPaneProvider:h.resourceKey});return e}(r.default);t.default=b});define("QV",[],function(){return'<div aria-live=assertive><div role=alert class=ms-accessible data-bind="text: screenReaderInformation"></div></div><div class=InfoPane role=dialog tabindex=0 data-automationid=ms-info-pane data-bind="attr: {\'aria-label\': ariaLabel}, preserveFocus, class: \'od-InfoPane--\' + sizeCss(), delayedHasFocus: isPaneFocused, scrollContainer: {}, clientRect: { size: size }">\x3c!--ko foreach: availableSections--\x3e\x3c!--ko component: legacyComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: selectionMessage--\x3e<div class="InfoPane-selectionMessage ms-font-l" data-bind="text: selectionMessage"></div>\x3c!--/ko--\x3e</div>'});define("QU",["c","az"],function(e,t){e.loadStyles([{rawString:'.InfoPane{box-sizing:border-box;outline:0;position:absolute;top:0;bottom:0;left:0;right:0;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}.InfoPane::after,.InfoPane::before{display:table;content:\'\';line-height:0}.InfoPane::after{clear:both}.InfoPane-sectionHeaderText{font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;font-weight:400;margin-top:0;margin-bottom:0}.InfoPane-section{padding:20px 20px 22px 40px;box-sizing:border-box;display:inline-block;width:100%}html[dir=rtl] .InfoPane-section{padding:20px 40px 22px 20px}.InfoPane-section.no-arrow{padding:20px 20px 22px 16px}html[dir=rtl] .InfoPane-section.no-arrow{padding:20px 16px 22px 20px}.InfoPane-section.no-arrow .InfoPane-sectionHeader{cursor:default}.InfoPane-sectionHeader{position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;height:32px;line-height:32px;cursor:pointer}.InfoPane-sectionHeader:focus{outline:1px solid '},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.InfoPane-sectionExpandButton.ms-Icon{font-size:17px;position:absolute;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';width:32px;height:32px;line-height:32px;text-align:center;transition:transform 167ms cubic-bezier(.1,.9,.2,1)}[dir=ltr] .InfoPane-sectionExpandButton.ms-Icon{left:-32px}[dir=rtl] .InfoPane-sectionExpandButton.ms-Icon{right:-32px}.InfoPane-section.is-expanded .InfoPane-sectionExpandButton.ms-Icon{-ms-transform:rotate(-180deg);transform:rotate(-180deg)}.InfoPane-section .InfoPane-sectionContent{display:none}.InfoPane-section.is-expanded .InfoPane-sectionContent{display:block}.InfoPane-sectionContent{margin-top:10px;font-size:12px}.InfoPane-selectionMessage{margin:0 0 20px 14px}html[dir=rtl] .InfoPane-selectionMessage{margin:0 14px 20px 0}.lg .InfoPane-selectionMessage,.xlg .InfoPane-selectionMessage,.xxlg .InfoPane-selectionMessage,.xxxlg .InfoPane-selectionMessage,.xxxxlg .InfoPane-selectionMessage{margin-top:18px;font-size:21px}.od-InfoPane-selectFile{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;margin:0 0 20px 14px}html[dir=rtl] .od-InfoPane-selectFile{margin:0 14px 20px 0}'}])});define("QX",["require","exports","ap","Pc","Q6","Q3","O6","OT","PT","Q0","ba","eO","QZ","kE","ig","iE","bX","dZ","ep","QY","dH"],function(e,t,i,f,g,y,v,_,b,x,S,C,r,P,k,I,o,n,T,w,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=t.resources;t._pageContext=i.consume(I.pageContext);t._currentItem=i.consume(o.currentItem);t._urlDataSource=i.consume(n.url);t._isSharedWithMeTab=t.createComputed(t._checkIsSharedWithMeTab);t._isSharedByMeTab=t.createComputed(t._checkIsSharedByMeTab);return t}e.prototype.getSectionGroups=function(){var o,n=this,e=this.observables,t=this.resources,i=this._pageContext,r=t.consume(I.listContext.optional),a=e.create(),s=Number(i.webTemplate)===T.default.mySite,l=i.isSiteAdmin&&s,d=!r||r.isDocLib;if(r.tenantTagPolicyEnabled){t.consume(w.resourceKey).hasComplianceTags().done(function(e){a(e)})}s?l&&(o=function(e){return a()}):o="splist"===this.urlDataSource.getAppSubfolder()?function(){return!0}:void 0;var c=this.sections,u=[],p=[];S.isFeatureEnabled(S.EnableNewDetailsPane)||u.push(this.createSection(0,g.default,function(e){if(1!==e.length&&!S.isFeatureEnabled(S.SPListBulkEditItemProperties))return!1;var t=e[0];return!!(t.displayName||t.size||t.dateModified)}));u.push(c[14]);u.push(this.createSection(15,y.default,function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r&&(!r.lifeCycleStatus||!r.lifeCycleStatus.isExternal))return!1}return!0}));if(!i.isAnonymousGuestUser){u.push(this.createSection(3,_.default,function(e){return 1===e.length&&!!e[0].policyTip}));u.push(c[8]);o&&u.push(this.createSection(7,f.default,function(e){if(1!==e.length&&!S.isFeatureEnabled(S.SPListBulkEditItemProperties))return!1;if(0===e.length)return!1;for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r){if(!(o(r)&&r!==n._currentItem()&&!r.isPlaceholder&&!r.isRootFolder&&void 0!==r.properties.ID))return!1}}return!0}));if(S.isFeatureEnabled(S.EnableNewActivityFeed)||S.isFeatureEnabled(S.InfoPaneActivityFeed)){var m=function(e){if(1!==e.length)return!1;var t=e[0];return t.id&&(s&&!n._isSharedWithMeTab()||!s)&&(s&&!n._isSharedByMeTab()||!s)&&(t.isRootFolder||void 0!==t.properties.ID||void 0!==t.properties.id)&&(!t.list||t.list.permissions&&t.list.permissions.openItems)&&(t.type===C.default.File||!!t.appMap||t.type===C.default.Folder||t.type===C.default.Media)},h=s?u:p;S.isFeatureEnabled(S.EnableNewActivityFeed)&&h.push(this.createSection(9,x.default,function(e){return r&&r.isDocLib&&m(e)}));S.isFeatureEnabled(S.InfoPaneActivityFeed)&&h.push(this.createSection(10,b.default,function(e){var t=r&&r.isDocLib;return(!S.isFeatureEnabled(S.EnableNewActivityFeed)||!t)&&m(e)}))}}p.push(c[11]);if(d){t.consume(P.resourceKey.optional)&&p.push(this.createSection(13,v.default,function(e){if(1!==e.length)return!1;var t=e[0];return!t.isPlaceholder&&!t.isRootFolder&&k.default.isShortcutItem(t)&&S.isFeatureEnabled(S.ShortcutLink)}))}return[{sections:u},{sections:p}]};e.prototype._checkIsSharedWithMeTab=function(){this._currentItem();return this._urlDataSource.getQueryType()===a.default.SharedWithMe};e.prototype._checkIsSharedByMeTab=function(){this._currentItem();return this._urlDataSource.getQueryType()===a.default.SharedByMe};return e}(r.default);t.default=s});define("Q6",["require","exports","Q9","b5","Q8","Q7"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-item-details-section",template:e("Q8"),viewModel:i.default,synchronous:!0});t.default=o});define("Q9",["require","exports","ap","bF","hO","df","sX","d7","dZ","eO","ba","sX","cY","V","oq","bX","d","Ra"],function(e,t,i,r,n,a,l,s,d,c,u,o,p,m,h,f,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=o.strings,_=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.fileTypeIconTagName=a.default.tagName;t.malwareDetectedMessageComponent=y.malwareDetectedMessage;t._item=e.item;var i=t.observables,r=t.resources;t.addBindingHandlers({react:h.default});t._selectionModel=r.consume(f.itemsSelection);t.name=i.pureCompute(t._computeItemName);t.sizeAndDate=i.pureCompute(t._computeSizeAndDate);t.icon=i.pureCompute(t._computeIconName);t.extension=i.pureCompute(t._computeExtension);t.sizeAndDateEmpty=i.pureCompute(t._computeSizeAndDateEmpty);t.isItemMalwareDetected=i.pureCompute(t._computeIsItemMalwareDetected);t.strings=l.strings;t._urlDataSource=r.consume(d.url);t.errorText=i.create("");t.isLoading=i.create(!1);t.isOn=i.create(!1);t.showViewCountText=t.createObservable("");t.loadingAnalytics=t.createObservable(!0);t.areNotificationsAvailable=i.pureCompute(t._computeAreNotificationsAvailable);t.notificationsAriaLabel=l.strings.notificationBellAriaLabel;t.notificationsTooltip=i.pureCompute(t._computeNotificationsTooltip);if(u.isFeatureEnabled(u.EnableNotificationSubscriptions)&&r.isExposed(s.subscriptions)){t._subscriptionsProvider=r.consume(s.subscriptions);t.createBackgroundComputed(t._computeItemChanged)}t._identityDataSource=r.consume(d.identity.optional);t.itemAnalytics=t.createObservable(void 0);t.showViewCountText=t.createComputed(t._getViewCountString);return t}e.prototype.updateNotifications=function(e,t){this.isOn(!this.isOn());this.onToggleChanged(e,t)};e.prototype.onToggleChanged=function(e,t){var i=this,r=this._item.peek();if(r){var o={subscription:this._subscription,item:r,isOn:this.isOn()};this._subscriptionsProvider.updateSubscription(o).then(function(){i.errorText("")},function(e){i.errorText(l.strings.notificationsFailedToUpdate)})}};e.prototype.getRingerIcon=function(){var e=this.isOn()?"Ringer":"RingerOff";return g.getIconClassName(e)};e.prototype._getViewCountString=function(){var e=this.itemAnalytics();if(!e||!e.viewCount)return"";var t=this.itemAnalytics().viewCount;return m.format(1<t?v.viewCounts:v.viewCount,t)};e.prototype._computeAreNotificationsAvailable=function(){var e=this._item();if(!e)return!1;var t=this._identityDataSource.getIdentity(),i=this._urlDataSource.getOwnerId(null,{}).toLowerCase()===this._urlDataSource.getOwnerId(e.key).toLowerCase();return t&&t.type!==p.IdentityType.anonymous&&i&&!e.isPlaceholder&&e.type!==c.default.Folder&&!this._urlDataSource.isRecycleBin(e.queryType)&&u.isFeatureEnabled(u.EnableNotificationSubscriptions)};e.prototype._computeItemChanged=function(){var s=this,e=this._item();if(this.areNotificationsAvailable()){this._subscription=null;this.isLoading(!0);this.isOn(!1);this._subscriptionsProvider.getSubscriptions(e).then(function(e){for(var t=!0,i=s._urlDataSource.getOwnerId(null,{}).toLowerCase(),r=0,o=e;r<o.length;r++){var n=o[r],a=n.createdBy.user;a&&a.id&&a.id.toLowerCase()===i&&(t=!(s._subscription=n).muted)}s.isOn(t);s.isLoading(!1);s.errorText("")},function(e){s.isLoading(!1);s.errorText(l.strings.notificationsFailed)})}};e.prototype._computeItemName=function(){var e=this._item();if(e)return e.displayName||e.name||"";var t=this._selectionModel.selection();return m.format(l.strings.selectedItemsFormatString,t.length)};e.prototype._computeExtension=function(){var e=this._item();return e&&e.extension};e.prototype._computeSizeAndDate=function(){var e=this._item();if(!e)return"";if(e.isRootFolder)return"";var t=void 0!==e.size?n.default.getDisplayString(e.size,{ignoreZero:!0}):"",i=e.dateModified||"";return t&&i?t+" - "+i:t||i};e.prototype._computeIconName=function(){var e=this._item();if(!e){if(1<this._selectionModel.selection.peek().length)return"multiple"}return e&&e.iconName||"genericfile"};e.prototype._computeSizeAndDateEmpty=function(){return 0===this.sizeAndDate().length};e.prototype._computeNotificationsTooltip=function(){return this.isOn()?v.notificationBellTooltipOn:v.notificationBellTooltipOff};e.prototype._computeIsItemMalwareDetected=function(){var e=this._item();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};return e}(r.default);t.default=_});define("Ra",["require","exports","at","x6","mh","Lf"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.malwareDetectedMessage=function(){return i.createElement(r.MessageBar,{messageBarType:r.MessageBarType.severeWarning,isMultiline:!0},n.strings.malwareDetectedMessage+" ",i.createElement(o.Link,{href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},n.strings.malwareDetectedMessageLearnMore))}});define("x6",["require","exports","ap","x7"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("x7",["require","exports","ap","x9","x8"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("x9",["require","exports","ap","at","jP","wN","mo","x8","ya"],function(e,t,i,o,n,a,s,l,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=r,c=function(r){i.__extends(e,r);function e(e){var t,i=r.call(this,e)||this;i.ICON_MAP=((t={})[l.MessageBarType.info]="Info",t[l.MessageBarType.warning]="Info",t[l.MessageBarType.error]="ErrorBadge",t[l.MessageBarType.blocked]="Blocked2",t[l.MessageBarType.remove]="Blocked",t[l.MessageBarType.severeWarning]="Warning",t[l.MessageBarType.success]="Completed",t);i._onClick=function(e){i.setState({expandSingleLine:!i.state.expandSingleLine})};i.state={labelId:n.getId("MessageBar"),showContent:!1,expandSingleLine:!1};return i}e.prototype.render=function(){return this.props.isMultiline?this._renderMultiLine():this._renderSingleLine()};e.prototype._getActionsDiv=function(){return this.props.actions?o.createElement("div",{className:this.props.isMultiline?"ms-MessageBar-actions "+d.actions:"ms-MessageBar-actionsSingleLine "+d.actionsSingleLine},this.props.actions):null};e.prototype._getClassName=function(){return n.css(this.props.className,"ms-MessageBar",d.root,((e={})["ms-MessageBar "+d.root]=this.props.messageBarType===l.MessageBarType.info,e["ms-MessageBar--error "+d.rootIsError]=this.props.messageBarType===l.MessageBarType.error,e["ms-MessageBar--blocked "+d.rootIsBlocked]=this.props.messageBarType===l.MessageBarType.blocked||this.props.messageBarType===l.MessageBarType.remove,e["ms-MessageBar--severeWarning "+d.rootIsSevereWarning]=this.props.messageBarType===l.MessageBarType.severeWarning,e["ms-MessageBar--success "+d.rootIsSuccess]=this.props.messageBarType===l.MessageBarType.success,e["ms-MessageBar--warning "+d.rootIsWarning]=this.props.messageBarType===l.MessageBarType.warning,e));var e};e.prototype._getDismissDiv=function(){return this.props.onDismiss?o.createElement(a.IconButton,{disabled:!1,className:n.css("ms-MessageBar-dismissal",d.dismissal),onClick:this.props.onDismiss,iconProps:{iconName:"Clear"},ariaLabel:this.props.dismissButtonAriaLabel}):null};e.prototype._getDismissSingleLine=function(){return this.props.onDismiss?o.createElement("div",{className:n.css("ms-MessageBar-dismissSingleLine",d.dismissSingleLine)},this._getDismissDiv()):null};e.prototype._getExpandSingleLine=function(){return!this.props.actions&&this.props.truncated?o.createElement("div",{className:n.css("ms-MessageBar-expandSingleLine",d.expandSingleLine)},o.createElement(a.IconButton,{disabled:!1,className:n.css("ms-MessageBar-expand",d.expand),onClick:this._onClick,iconProps:{iconName:this.state.expandSingleLine?"DoubleChevronUp":"DoubleChevronDown"},ariaLabel:this.props.overflowButtonAriaLabel})):null};e.prototype._getIconSpan=function(){return o.createElement("div",{className:n.css("ms-MessageBar-icon",d.icon)},o.createElement(s.Icon,{iconName:this.ICON_MAP[this.props.messageBarType]}))};e.prototype._renderMultiLine=function(){return o.createElement("div",{className:n.css(this._getClassName(),"ms-MessageBar-multiline",d.multiLine,this.props.onDismiss&&d.dismissalMultiLine),role:"status","aria-live":this._getAnnouncementPriority()},o.createElement("div",{className:n.css(d.content,"ms-MessageBar-content")},this._getIconSpan(),this._renderInnerText(),this._getDismissDiv()),this._getActionsDiv())};e.prototype._renderSingleLine=function(){return o.createElement("div",{className:n.css(this._getClassName(),"ms-MessageBar-singleline",d.singleLine,this.props.onDismiss&&"ms-MessageBar-dismissalSingleLine",this.props.truncated&&"ms-MessageBar-expandingSingleLine",this.props.truncated&&d.expandingSingleLine)},o.createElement("div",{className:n.css(d.content,"ms-MessageBar-content")},this._getIconSpan(),this._renderInnerText(),this._getExpandSingleLine(),this._getActionsDiv(),this._getDismissSingleLine()))};e.prototype._renderInnerText=function(){return o.createElement("div",{className:n.css("ms-MessageBar-text",d.text,this.props.actions&&d.multiLineWithActions,!this.props.onDismiss&&d.noDismissButton,this.state.expandSingleLine&&d.expandSingleLine),id:this.state.labelId},o.createElement("span",{className:n.css("ms-MessageBar-innerText "+d.innerText),role:"status","aria-live":this._getAnnouncementPriority()},o.createElement(n.DelayedRender,null,o.createElement("span",null,this.props.children))))};e.prototype._getAnnouncementPriority=function(){switch(this.props.messageBarType){case l.MessageBarType.blocked:case l.MessageBarType.error:case l.MessageBarType.severeWarning:return"assertive"}return"polite"};e.defaultProps={messageBarType:l.MessageBarType.info,onDismiss:void 0,isMultiline:!0};return e}(n.BaseComponent);t.MessageBar=c});define("x8",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.info=0]="info";e[e.error=1]="error";e[e.blocked=2]="blocked";e[e.severeWarning=3]="severeWarning";e[e.success=4]="success";e[e.warning=5]="warning";e[e.remove=9e4]="remove"}(t.MessageBarType||(t.MessageBarType={}))});define("ya",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_d18144f0{background-color:"},{theme:"infoBackground",defaultValue:"#f4f4f4"},{rawString:";min-height:32px;color:"},{theme:"infoText",defaultValue:"#333333"},{rawString:";width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;position:relative;word-break:break-word}.root_d18144f0 .ms-Link{font-size:12px;color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.icon_d18144f0,.text_d18144f0{display:table-cell;vertical-align:top}.icon_d18144f0{font-size:16px;min-width:16px;min-height:16px;display:-webkit-box;display:-ms-flexbox;display:flex;color:"},{theme:"info",defaultValue:"#666666"},{rawString:";-ms-flex-negative:0;flex-shrink:0;margin:16px 0 16px 16px}html[dir='rtl'] .icon_d18144f0{margin:16px 16px 16px 0}@media screen and (max-width: 479px){.icon_d18144f0{margin:8px 0 8px 8px}html[dir='rtl'] .icon_d18144f0{margin:8px 8px 8px 0}}.text_d18144f0{font-size:12px;font-weight:400;min-width:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;margin:16px 8px 16px 8px}html[dir='rtl'] .text_d18144f0{margin:16px 8px 16px 8px}@media screen and (max-width: 479px){.text_d18144f0{margin:8px 0 8px 8px}html[dir='rtl'] .text_d18144f0{margin:8px 8px 8px 0}html[dir='ltr'] .text_d18144f0.noDismissButton_d18144f0{margin-right:8px}html[dir='rtl'] .text_d18144f0.noDismissButton_d18144f0{margin-left:8px}}html[dir='ltr'] .text_d18144f0.noDismissButton_d18144f0{margin-right:16px}html[dir='rtl'] .text_d18144f0.noDismissButton_d18144f0{margin-left:16px}.innerText_d18144f0{line-height:16px}html[dir='ltr'] .innerText_d18144f0 span a{padding-left:4px}html[dir='rtl'] .innerText_d18144f0 span a{padding-right:4px}.root_d18144f0.rootIsWarning_d18144f0{background-color:"},{theme:"warningBackground",defaultValue:"#fff4ce"},{rawString:";color:"},{theme:"warningText",defaultValue:"#333333"},{rawString:"}.root_d18144f0.rootIsSevereWarning_d18144f0{background-color:"},{theme:"severeWarningBackground",defaultValue:"#fed9cc"},{rawString:";color:"},{theme:"severeWarningText",defaultValue:"#333333"},{rawString:"}.root_d18144f0.rootIsSevereWarning_d18144f0 .icon_d18144f0{color:"},{theme:"severeWarning",defaultValue:"#a80000"},{rawString:"}.root_d18144f0.rootIsError_d18144f0{background-color:"},{theme:"errorBackground",defaultValue:"#fde7e9"},{rawString:";color:"},{theme:"errorText",defaultValue:"#333333"},{rawString:"}.root_d18144f0.rootIsError_d18144f0 .icon_d18144f0{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.root_d18144f0.rootIsBlocked_d18144f0{background-color:"},{theme:"errorBackground",defaultValue:"#fde7e9"},{rawString:";color:"},{theme:"errorText",defaultValue:"#333333"},{rawString:"}.root_d18144f0.rootIsBlocked_d18144f0 .icon_d18144f0{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.root_d18144f0.rootIsSuccess_d18144f0{background-color:"},{theme:"successBackground",defaultValue:"#dff6dd"},{rawString:";color:"},{theme:"successText",defaultValue:"#333333"},{rawString:"}.root_d18144f0.rootIsSuccess_d18144f0 .icon_d18144f0{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.content_d18144f0{display:-webkit-box;display:-ms-flexbox;display:flex;line-height:normal;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.content_d18144f0:before{pointer-events:none;position:absolute;right:0;bottom:0;left:0;top:0;margin:0}@media screen and (-ms-high-contrast: active){.content_d18144f0:before{border:1px solid WindowText;content:' '}}.actions_d18144f0{margin:0 12px 12px 0}html[dir='rtl'] .actions_d18144f0{margin:0 0 12px 12px}html[dir='ltr'] .actions_d18144f0 :nth-child(n+2){margin-left:12px}html[dir='rtl'] .actions_d18144f0 :nth-child(n+2){margin-right:12px}.actionsSingleLine_d18144f0{margin:8px 8px 8px 0}html[dir='rtl'] .actionsSingleLine_d18144f0{margin:8px 0 8px 8px}html[dir='ltr'] .actionsSingleLine_d18144f0 :nth-child(n+2){margin-left:8px}html[dir='rtl'] .actionsSingleLine_d18144f0 :nth-child(n+2){margin-right:8px}.actions_d18144f0,.actionsSingleLine_d18144f0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;-webkit-box-align:center;-ms-flex-align:center;align-items:center}@media screen and (max-width: 479px){.actions_d18144f0,.actionsSingleLine_d18144f0{margin:0 8px 8px 0}html[dir='rtl'] .actions_d18144f0,html[dir='rtl'] .actionsSingleLine_d18144f0{margin:0 0 8px 8px}html[dir='ltr'] .actions_d18144f0 :nth-child(n+2),html[dir='ltr'] .actionsSingleLine_d18144f0 :nth-child(n+2){margin-left:8px}html[dir='rtl'] .actions_d18144f0 :nth-child(n+2),html[dir='rtl'] .actionsSingleLine_d18144f0 :nth-child(n+2){margin-right:8px}.actions_d18144f0 .ms-Button,.actionsSingleLine_d18144f0 .ms-Button{margin-top:8px}}.dismissal_d18144f0,.expand_d18144f0{-ms-flex-negative:0;flex-shrink:0;margin:8px 8px 8px 0}.dismissal_d18144f0::-moz-focus-inner,.expand_d18144f0::-moz-focus-inner{border:0}.dismissal_d18144f0,.expand_d18144f0{outline:transparent}.dismissal_d18144f0,.expand_d18144f0{position:relative}.ms-Fabric--isFocusVisible .dismissal_d18144f0:focus:after,.ms-Fabric--isFocusVisible .expand_d18144f0:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#000000"},{rawString:"}html[dir='rtl'] .dismissal_d18144f0,html[dir='rtl'] .expand_d18144f0{margin:8px 0 8px 8px}@media screen and (max-width: 479px){.dismissal_d18144f0,.expand_d18144f0{margin:0 0 0 8px}html[dir='rtl'] .dismissal_d18144f0,html[dir='rtl'] .expand_d18144f0{margin:0 8px 0 0}}@media screen and (-ms-high-contrast: active){.dismissal_d18144f0,.expand_d18144f0{-ms-high-contrast-adjust:none}}.dismissSingleLine_d18144f0,.expandSingleLine_d18144f0{display:-webkit-box;display:-ms-flexbox;display:flex}.dismissal_d18144f0 .ms-Button-icon,.dismissSingleLine_d18144f0 .ms-Button-icon,.expandSingleLine_d18144f0 .ms-Button-icon{font-size:12px;height:12px;line-height:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.multiLine_d18144f0{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.multiLine_d18144f0 .content_d18144f0{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.multiLine_d18144f0 .innerText_d18144f0{overflow:visible;white-space:pre-wrap}.multiLine_d18144f0 .text_d18144f0.multiLineWithActions_d18144f0{margin-bottom:8px}@media screen and (max-width: 479px){.multiLine_d18144f0 .text_d18144f0.multiLineWithActions_d18144f0{margin-bottom:0}}.singleLine_d18144f0 .innerText_d18144f0{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.singleLine_d18144f0 .expandSingleLine_d18144f0{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.singleLine_d18144f0 .expandSingleLine_d18144f0 .content_d18144f0{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.singleLine_d18144f0 .expandSingleLine_d18144f0 .innerText_d18144f0{overflow:visible;white-space:pre-wrap}@media screen and (max-width: 479px){.singleLine_d18144f0:not(.expandingSingleLine_d18144f0){-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.singleLine_d18144f0:not(.expandingSingleLine_d18144f0) .content_d18144f0{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.singleLine_d18144f0:not(.expandingSingleLine_d18144f0) .innerText_d18144f0{overflow:visible;white-space:pre-wrap}}@media screen and (max-width: 479px) and (max-width: 479px){.singleLine_d18144f0:not(.expandingSingleLine_d18144f0) .text_d18144f0.multiLineWithActions_d18144f0{margin-bottom:0}}\n"}]);t.root="root_d18144f0";t.icon="icon_d18144f0";t.text="text_d18144f0";t.noDismissButton="noDismissButton_d18144f0";t.innerText="innerText_d18144f0";t.rootIsWarning="rootIsWarning_d18144f0";t.rootIsSevereWarning="rootIsSevereWarning_d18144f0";t.rootIsError="rootIsError_d18144f0";t.rootIsBlocked="rootIsBlocked_d18144f0";t.rootIsSuccess="rootIsSuccess_d18144f0";t.content="content_d18144f0";t.actions="actions_d18144f0";t.actionsSingleLine="actionsSingleLine_d18144f0";t.dismissal="dismissal_d18144f0";t.expand="expand_d18144f0";t.dismissSingleLine="dismissSingleLine_d18144f0";t.expandSingleLine="expandSingleLine_d18144f0";t.multiLine="multiLine_d18144f0";t.multiLineWithActions="multiLineWithActions_d18144f0";t.singleLine="singleLine_d18144f0";t.expandingSingleLine="expandingSingleLine_d18144f0"});define("Q8",[],function(){return'<div class="InfoPane-section InfoPaneSection--itemDetails"><div class=InfoPane-itemDetails-icon data-bind="component: { name: fileTypeIconTagName, params: { iconName: icon(), extension: extension(), desiredSize: 32 } }"></div><div class=InfoPane-itemDetails-allDetails><div class=InfoPane-itemDetails-name data-bind="text: name, css: {\'InfoPane-itemDetails-name--centered\': sizeAndDateEmpty }, attr: {\'title\' : name }"></div><div class=InfoPane-itemDetails-sizeAndDate data-bind="text: sizeAndDate"></div></div>\x3c!--ko if: isItemMalwareDetected--\x3e<div class=InfoPane-itemDetails-malwareInfectedMessageBar data-bind="react: { componentType: malwareDetectedMessageComponent }"></div>\x3c!--/ko--\x3e\x3c!--ko if: areNotificationsAvailable--\x3e<button class=InfoPane-itemDetails-notificationBell data-bind="attr: { \'aria-pressed\': isOn, \'aria-label\': notificationsAriaLabel }, css: { \'InfoPane-itemDetails-notificationBell--loading\': isLoading }, click: updateNotifications"><i class=InfoPane-itemDetails-notificationIcon data-bind="icon: true, css: getRingerIcon(), attr: { \'title\': notificationsTooltip }"></i></button>\x3c!--/ko--\x3e<div class=InfoPane-itemDetails-notificationStatus data-bind="text: errorText" aria-live=assertive></div></div>'});define("Q7",["c","az"],function(e,t){e.loadStyles([{rawString:'.InfoPaneSection--itemDetails{padding:0;width:auto;margin-top:13px;margin-bottom:20px;display:block}html[dir=rtl] .InfoPaneSection--itemDetails{padding:0}.InfoPane-itemDetails-name{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:'}.InfoPane-itemDetails-name--centered{padding-top:9px}html[dir=ltr] .InfoPane-itemDetails-allDetails{float:left}html[dir=rtl] .InfoPane-itemDetails-allDetails{float:right}.InfoPane-itemDetails-name,.InfoPane-itemDetails-sizeAndDate{max-width:176px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.InfoPane-itemDetails-icon{margin-top:2px;margin-right:18px;margin-left:18px}html[dir=ltr] .InfoPane-itemDetails-icon{float:left}html[dir=rtl] .InfoPane-itemDetails-icon{float:right}.InfoPane-itemDetails-icon .FileTypeIcon-icon{outline:0}.InfoPane-itemDetails-sizeAndDate{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.InfoPane-itemDetails-notificationBell{cursor:pointer;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:transparent;border:none;height:19px}html[dir=ltr] .InfoPane-itemDetails-notificationBell{float:right}html[dir=rtl] .InfoPane-itemDetails-notificationBell{float:left}[dir=ltr] .InfoPane-itemDetails-notificationBell{margin-right:12px}[dir=rtl] .InfoPane-itemDetails-notificationBell{margin-left:12px}.InfoPane-itemDetails-notificationBell--loading{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.InfoPane-itemDetails-notificationStatus{font-size:12px;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";display:inline-block}[dir=ltr] .InfoPane-itemDetails-notificationStatus{margin-left:68px}[dir=rtl] .InfoPane-itemDetails-notificationStatus{margin-right:68px}.InfoPane-itemDetails-viewCountDetailsLink{padding:18px}.InfoPane-itemDetails-notificationIcon{font-size:16px}.InfoPane-itemDetails-malwareInfectedMessageBar{padding:10px 8px 0 8px;display:inline-block}html[dir=rtl] .InfoPane-itemDetails-malwareInfectedMessageBar{padding:10px 8px 0 8px}"}])});define("Q3",["require","exports","Q5","b5","Q4","N1"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-item-status-section",template:e("Q4"),viewModel:i.default,synchronous:!0});t.default=o});define("Q5",["require","exports","ap","bF","dI","ll","bX","sX"],function(e,t,i,r,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this,i=t.observables,r=t.resources;t.iconComponent={name:a.default.tagName,params:{icon:new n.default("Globe")}};t._selectionModel=r.consume(s.itemsSelection);t.message=i.pureCompute(t._computeMessage);return t}e.prototype._computeMessage=function(){return 1<this._selectionModel.selection().length?l.strings.externalItemsMessage:l.strings.externalItemMessage};return e}(r.default);t.default=o});define("Q4",[],function(){return'<div class="InfoPane-section InfoPaneSection--itemStatus no-arrow"><div class=itemStatus-icon data-bind="component: iconComponent"></div><div class=itemStatus-message data-bind="text: message"></div></div>'});define("Q0",["require","exports","Q2","b5","Q1"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-activities-feed-react",template:e("Q1"),viewModel:i.default,synchronous:!0});t.default=o});define("Q2",["require","exports","ap","bF","oq","Qj","Qg","Pa","bX"],function(e,t,i,r,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.addBindingHandlers({react:o.default});t.activitiesHeaderTitle=a.strings.ActivitiesHeader;var i=t.resources.consume(l.isSharingSectionExpanded.optional);t.sectionHelper=new(t.managed(s.default))({shouldStartExpanded:!i||!i.peek()});t.controlComponent=n.default;t.controlProps=t.observables.pureCompute(function(){return{item:e.item(),resources:t.resources}});return t}return e}(r.default);t.default=d});define("Q1",[],function(){return'<div class="InfoPane-section InfoPaneSection--activitiesfeed" data-bind="css: { \'is-expanded\': sectionHelper.isExpanded, \'no-arrow\': !sectionHelper.showArrow }"><div class=InfoPane-sectionHeader id=od-ActivitiesFeed-sectionHeader data-bind="toggle: sectionHelper.isExpanded, attr: { \'aria-expanded\': sectionHelper.isExpanded(), tabindex: sectionHelper.showArrow ? 0 : -1, role: sectionHelper.showArrow ? \'button\' : \'\' }">\x3c!--ko if: sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e<h2 class=InfoPane-sectionHeaderText data-bind="text: activitiesHeaderTitle"></h2></div><div class=InfoPane-sectionContent role=tree><div data-bind="react: { componentType: controlComponent, props: controlProps }"></div></div></div>'});define("QZ",["require","exports","ap","PF","N6","Pz","dZ","jG","bN","ig","ba"],function(e,t,i,s,l,d,c,u,r,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(a){i.__extends(e,a);function e(e){var t=a.call(this,e)||this,i=t.resources,r=t.urlDataSource=i.consume(c.url),o=t.sections={},n=i.consume(u.base.infoPane.hidePreview.optional);o[14]=t.createSection(14,d.default,function(e){if(1!==e.length)return!1;var t=e[0],i=t.folder;return(!n||!n())&&(i?!!i.covers&&0<i.covers.length:(!!t.thumbnail||t.previewIFrameUrl)&&0<t.size)});o[11]=t.createSection(11,s.default,function(e){if(1!==e.length)return!1;var t=e[0];return t&&!t.isPlaceholder&&!t.isRootFolder&&!(p.default.isShortcutItem(t)&&m.isFeatureEnabled(m.ShortcutLink))});o[8]=t.createSection(8,l.default,function(e){if(1!==e.length)return!1;var t=e[0];if(t&&!t.isRootFolder&&!r.isRecycleBin(t.queryType))switch(t.sharingRole){case 0:case 2:case 4:return!0}return!1});return t}e.prototype.createSection=function(e,t,i){return{type:e,legacyComponent:{name:t.tagName,params:{}},isAvailable:i}};return e}(r.default);t.default=o});define("QY",["require","exports","Pr","bA"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._dataSource=t.dataSource}e.prototype.getAvailableTagsForSite=function(){this._cachedTagsPromise||(this._cachedTagsPromise=this._dataSource.getAvailableTagsForSite());return this._cachedTagsPromise};e.prototype.updateComplianceTag=function(e,t){return this._dataSource.updateComplianceTag(e,t)};e.prototype.hasComplianceTags=function(){return this.getAvailableTagsForSite().then(function(e){return!!(e&&1<e.length)})};e.dependencies={dataSource:i.resourceKey};return e}();t.default=o;t.resourceKey=r.createResolvedResourceKey(e("module").id,o)});define("Rb",["require","exports","ap","aC","aq","ci","bN","Re","ba","c7","nU","Rc"],function(l,e,t,d,c,u,i,p,m,h,f,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(i){t.__extends(s,i);function s(e){var t=i.call(this)||this;t._person=e;return t}Object.defineProperty(s,"isLpcFlighted",{get:function(){return m.isFeatureEnabled(m.PeopleCardsReactComponent)},enumerable:!0,configurable:!0});s.personaRendered=function(t,i,e){this._loadLpcIfFlighted(function(e){return e.addedPersonaToPage(t,i)},e)};s.personaRemoved=function(t,i,e){this._loadLpcIfFlighted(function(e){return e.removedPersonaFromPage(t,i)},e)};s._loadLpcIfFlighted=function(e,t){if(s.isLpcFlighted){this._personaCardLoader||(this._personaCardLoader=new r.default(t));this._personaCardLoader.loadLivePersonaCard(e)}};s.prototype.show=function(i,r){var o=this;void 0===r&&(r=!1);if(!s.isLpcFlighted){var n=this.resources.consume(u.resourceKey),a=c.observable(0);if(m.isFeatureEnabled(m.PeopleCardsOnLoki)){h.loadModule({path:"Rt",getModule:function(){return new d.default(function(e,t){l(["Rt"],e,t)})}}).then(function(e){if(n.currentDialog()&&n.currentDialog().component&&n.currentDialog().component.params){var t=n.currentDialog().component.params;t.payloadParams&&t.payloadParams.user&&(o._person.userId!==t.payloadParams.user.userId||o._person.sip!==t.payloadParams.user.sip)&&n.currentDialog().complete()}o._currentDialog=n.requestDialog({title:null,size:"Small",isCallout:!0,isDismissableOnResize:!1,isDismissableOnScroll:!1,invokerEvent:i,calloutHeight:a,component:{name:e.tagName,params:{payloadParams:{user:o._person,isDataPreloaded:r,closeCallback:function(){return o._closePersonaCard()},invokerEvent:i},calloutHeight:a,resources:o.resources}},actions:[],stayAsPopup:!0,maxOneDialog:!0});o._currentDialog.wait().then(function(){})})}else if(i.type!==f.PEOPLE_CARD_HOVER_EVENT_NAME){this._currentDialog=n.requestDialog({title:null,size:"Small",isCallout:!0,isDismissableOnResize:!0,isDismissableOnScroll:!0,invokerEvent:i,calloutHeight:a,component:{name:p.default.tagName,params:{payloadParams:this._person,calloutHeight:a,resources:this.resources}},actions:[],stayAsPopup:!0});this._currentDialog.wait().then(function(){})}}};s.prototype._closePersonaCard=function(){this._currentDialog&&this._currentDialog.complete()};return s}(i.default);e.default=o});define("Re",["require","exports","Rh","b5","Rg","Rf","Os"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-personaCard",template:e("Rg"),viewModel:i.default});t.default=o});define("Rh",["require","exports","ap","bF","aq","d0","DM","Ri","U","cE"],function(e,t,i,r,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){var t=r.call(this)||this;t.progressSpinnerFlatTagName=n.default.tagName;t.strings=s.strings;t._engagement=t.resources.consume(d.resourceKey);var i=e.payloadParams;t._calloutHeight=e.calloutHeight;t.isDataReady=o.observable(!1);t.getPersonaCardData(i);t.userID=o.observable(i.sip);t.name=o.observable(i.name);t.email=o.observable(i.email);t.phone=o.observable("");t.office=o.observable("");t.job=o.observable("");t.department=o.observable("");t.image=o.observable("");t.sip=o.observable(i.sip);t.profilePage=o.observable("");t.showOrg=o.observable(!1);t.showPhone=o.observable(!0);t.showChat=o.observable(!1);t.showMail=o.observable(!1);t.managerChain=o.observableArray([]);t.directReports=o.observableArray([]);t.async.setTimeout(function(){t._calloutHeight&&t._calloutHeight(t._calloutHeight.peek()+1)},13);return t}e.prototype.encodeString=function(e){return l.default.encodeText(e)};e.prototype.resetCard=function(e){this.isDataReady(!1);this.getPersonaCardData(e);this._setPersonData(e);this.managerChain([]);this.directReports([]);this.showOnlyPhone()};e.prototype.showOnlyPhone=function(){this._engagement.logData({name:"ShowPhone.PersonaCard.Click",isIntentional:!0});this.showOrg(!1);this.showPhone(!0);this.showChat(!1);this.showMail(!1)};e.prototype.showOnlyMail=function(){this._engagement.logData({name:"ShowEmail.PersonaCard.Click",isIntentional:!0});this.showOrg(!1);this.showPhone(!1);this.showChat(!1);this.showMail(!0)};e.prototype.showOnlyChat=function(){this._engagement.logData({name:"ShowChat.PersonaCard.Click",isIntentional:!0});this.showOrg(!1);this.showPhone(!1);this.showChat(!0);this.showMail(!1)};e.prototype.showOnlyOrg=function(){this._engagement.logData({name:"ShowOrg.PersonaCard.Click",isIntentional:!0});this.showOrg(!0);this.showPhone(!1);this.showChat(!1);this.showMail(!1);this._calloutHeight(350)};e.prototype.showDirect=function(e){this._engagement.logData({name:"OrgDirect.PersonaCard.Click",isIntentional:!0});this.resetCard(e)};e.prototype.showManager=function(e){this._engagement.logData({name:"OrgManager.PersonaCard.Click",isIntentional:!0});this.resetCard(e)};e.prototype.logSendEmailClick=function(){this._engagement.logData({name:"SendEmail.PersonaCard.Click",isIntentional:!0});return!0};e.prototype.logStartChatClick=function(){this._engagement.logData({name:"StartChat.PersonaCard.Click",isIntentional:!0});return!0};e.prototype.logViewProfileClick=function(){this._engagement.logData({name:"ViewProfile.PersonaCard.Click",isIntentional:!0});return!0};e.prototype.getPersonaCardData=function(e){var i=this;this._engagement.logData({name:"PersonaCard.Launched"});if(e.sip){this.resources.consume(a.resourceKey).getPersonaDetails(e.sip).done(function(e){var t=e.personDetails;i._setPersonData(t);i.managerChain(e.managerChain);i.directReports(e.directReports);i.isDataReady(!0)})}};e.prototype._setPersonData=function(e){this.sip(e.sip||"");this.userID(e.userId||"");this.name(e.name||"");this.email(e.email||"");this.phone(e.phone||"");this.office(e.office||"");this.job(e.job||"");this.department(e.department||"");this.image(e.image||"");this.profilePage(e.profilePage||"")};return e}(r.default);t.default=c});define("Rg",[],function(){return'<div class=od-PersonaCard data-bind="css : {\'od-PersonaCard-isOrgActive\': showOrg()}" data-automationid=PersonaCard><div class=PersonaCard-progressBox data-bind="component: {name: progressSpinnerFlatTagName}, visible: (isDataReady() === false)"></div><od-persona params="person:$data, personaSize: 5, profileLinkOn: true, showPresence: true" class=PersonaCard-personaContainer></od-persona><div class=od-PersonaCard-actions><div class=od-PersonaCard-mainActions role=tablist><a class=od-PersonaCard-action id=od-PersonaCard-chatAction href=javascript:void(0) data-bind="css : {\'od-PersonaCard-action--isActive\': showChat()}, click: showOnlyChat, attr: {\'aria-selected\': showChat(), \'aria-label\': strings.sendIM, \'title\': strings.sendIM}" role=tab><i class="ms-Icon ms-Icon--Message" data-bind="icon: true"></i></a> <a class=od-PersonaCard-action id=od-PersonaCard-phoneAction href=javascript:void(0) data-bind="css : {\'od-PersonaCard-action--isActive\': showPhone()}, click: showOnlyPhone, attr: {\'aria-selected\': showPhone(), \'aria-label\': strings.contact, \'title\': strings.contact}" role=tab><i class="ms-Icon ms-Icon--Phone" data-bind="icon: true"></i></a> <a class=od-PersonaCard-action id=od-PersonaCard-mailAction href=javascript:void(0) data-bind="css: {\'od-PersonaCard-action--isActive\': showMail()}, click: showOnlyMail, attr: {\'aria-selected\': showMail(), \'aria-label\': strings.sendEmail, \'title\': strings.sendEmail }" role=tab><i class="ms-Icon ms-Icon--Mail" data-bind="icon: true"></i></a> <a class="od-PersonaCard-action od-PersonaCard-orgChart" id=od-PersonaCard-orgAction href=javascript:void(0) role=tab aria-controls=PersonaCard-orgChart data-bind="css : { \'od-PersonaCard-action--isActive\': showOrg() }, click: showOnlyOrg, attr: {\'aria-selected\': showOrg(), \'aria-label\': strings.organization, \'title\': strings.organization}"><i class="ms-Icon ms-Icon--Org" id=PersonaCard-orgChartTab data-bind="icon: true"></i></a></div><div class=od-PersonaCard-overflow><a class="PersonCard-persona-secondaryText PersonCard-profileLink" target=_blank data-bind="text: strings.viewProfile, click: $component.logViewProfileClick.bind($component), attr: {\'href\': profilePage}"></a></div></div><div class=od-PersonaCard-actionDetailBox aria-live=polite><div class=od-PersonaCard-detailChat><div class=od-PersonaCard-actionDetails data-bind="css : {\'od-PersonaCard-action--isActive\': showChat()}"><div class=od-PersonaCard-detailLine><span class=od-PersonaCard-detailLabel data-bind=text:strings.sendIM></span> <a class=ms-Link data-bind="text: sip, click: $component.logStartChatClick.bind($component), attr: {href: \'sip:\'+ sip(), title: strings.sendIM}"></a></div></div><div class=od-PersonaCard-actionDetails data-bind="css: {\'od-PersonaCard-action--isActive\': showPhone()}"><div class=od-PersonaCard-detailLine><span class=od-PersonaCard-detailLabel data-bind=text:strings.business></span> <span class=ms-Link data-bind="text: phone, attr: {title: strings.contact}"></span></div></div><div class=od-PersonaCard-actionDetails data-bind="css : {\'od-PersonaCard-action--isActive\': showMail()}"><div class=od-PersonaCard-detailLine><span class=od-PersonaCard-detailLabel data-bind=text:strings.sendEmail></span> <a class=ms-Link data-bind="text: email, click: $component.logSendEmailClick.bind($component), attr: {href: \'mailto:\'+ email(), title: strings.sendEmail}"></a></div></div><div class="od-PersonaCard-actionDetails od-PersonaCard-detailOrg" data-bind="css : {\'od-PersonaCard-action--isActive\': showOrg()}"><div class=ms-OrgChart><div class=ms-OrgChart-group><div class=ms-OrgChart-list data-bind=foreach:managerChain><a class=ms-OrgChart-listItem data-bind="click: $parent.showManager.bind($parent)" href=javascript:void(0)><od-persona params="person: $data, showPresence: true"></od-persona></a></div></div><div class=ms-OrgChart-group><div class=ms-OrgChart-list><a class=ms-OrgChart-listItem href=javascript:void(0)><od-persona params="person:$data, showPresence: true"></od-persona></a></div></div><div class=ms-OrgChart-group><div data-bind="text: strings.directReports" class="ms-OrgChart-groupTitle PersonCard-persona-primaryText PersonCard-spacer"></div><div class=ms-OrgChart-list data-bind=foreach:directReports><a class=ms-OrgChart-listItem data-bind="click: $parent.showDirect.bind($parent)" href=javascript:void(0)><od-persona params="person: $data, showPresence: true"></od-persona></a></div></div></div></div></div></div></div>'});define("Rf",["c","az"],function(e,t){e.loadStyles([{rawString:'.PersonaCard-progressBox{position:absolute;width:100%;left:0;top:2px;height:4px;z-index:1}.od-PersonaCard{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;animation-name:ms-fadeIn,ms-slideUpIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;bottom:0;position:relative;height:200px}@media (prefers-reduced-motion:reduce){.od-PersonaCard{animation:none}}[dir=ltr] .od-PersonaCard{left:0}[dir=rtl] .od-PersonaCard{right:0}[dir=ltr] .od-PersonaCard{right:0}[dir=rtl] .od-PersonaCard{left:0}.od-PersonaCard.od-PersonaCard-isOrgActive{height:344px}.od-PersonaCard .od-Persona-details{max-width:75%}.PersonaCard-personaContainer>.od-Persona{background-color:'},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding:12px}.od-PersonaCard-actions{box-sizing:border-box;list-style:none;margin:0;padding:0 10px;border-bottom:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:48px}.od-PersonaCard-mainActions{width:auto;height:auto;max-width:194px}html[dir=ltr] .od-PersonaCard-mainActions{float:left}html[dir=rtl] .od-PersonaCard-mainActions{float:right}.od-PersonaCard-action,.od-PersonaCard-overflow{display:inline-block;cursor:pointer;font-size:17px;height:48px;line-height:48px;padding:0 10px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";position:relative;box-sizing:border-box}.od-PersonaCard-action:hover,.od-PersonaCard-overflow:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-PersonaCard-action:active,.od-PersonaCard-overflow:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PersonaCard-action--isActive.od-PersonaCard-overflow,.od-PersonaCard-action.od-PersonaCard-action--isActive{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:'}.od-PersonaCard-action--isActive.od-PersonaCard-overflow:after,.od-PersonaCard-action.od-PersonaCard-action--isActive:after{box-sizing:border-box;-ms-transform:rotate(45deg);content:"";width:10px;height:10px;border:1px solid '},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;border-right:none;border-bottom:none;bottom:-4px}[dir=ltr] .od-PersonaCard-action--isActive.od-PersonaCard-overflow:after,[dir=ltr] .od-PersonaCard-action.od-PersonaCard-action--isActive:after{-ms-transform:rotate(45deg);transform:rotate(45deg)}[dir=rtl] .od-PersonaCard-action--isActive.od-PersonaCard-overflow:after,[dir=rtl] .od-PersonaCard-action.od-PersonaCard-action--isActive:after{-ms-transform:rotate(-45deg);transform:rotate(-45deg)}[dir=ltr] .od-PersonaCard-action--isActive.od-PersonaCard-overflow:after,[dir=ltr] .od-PersonaCard-action.od-PersonaCard-action--isActive:after{left:15px}[dir=rtl] .od-PersonaCard-action--isActive.od-PersonaCard-overflow:after,[dir=rtl] .od-PersonaCard-action.od-PersonaCard-action--isActive:after{right:15px}.od-PersonaCard-overflow{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin-top:-1px}html[dir=ltr] .od-PersonaCard-overflow{float:right}html[dir=rtl] .od-PersonaCard-overflow{float:left}.od-PersonaCard-overflow:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PersonaCard-orgChart{position:absolute;top:48px}[dir=ltr] .od-PersonaCard-orgChart{right:4px}[dir=rtl] .od-PersonaCard-orgChart{left:4px}.od-PersonaCard-actionDetailBox{min-height:48px;overflow-y:auto;overflow-x:hidden;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-PersonaCard-actionDetails{list-style:none;width:100%;min-height:48px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:9px 20px;animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;box-sizing:border-box;display:none;transition:max-height .25s ease}html[dir=ltr] .od-PersonaCard-actionDetails{float:left}html[dir=rtl] .od-PersonaCard-actionDetails{float:right}@media (prefers-reduced-motion:reduce){.od-PersonaCard-actionDetails{animation:none}}.od-PersonaCard-actionDetails.od-PersonaCard-action--isActive{display:block}.od-PersonaCard-detailChat,.od-PersonaCard-detailMail,.od-PersonaCard-detailOrg,.od-PersonaCard-detailPhone,.od-PersonaCard-detailVideo{overflow:hidden;width:100%;padding:0;margin:0}.od-PersonaCard-detailOrg{overflow-y:auto}.od-PersonaCard-detailExpander{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:15px;height:30px;line-height:30px;margin-top:1px;position:absolute;text-align:center;width:30px}[dir=ltr] .od-PersonaCard-detailExpander{right:10px}[dir=rtl] .od-PersonaCard-detailExpander{left:10px}.od-PersonaCard-detailExpander:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;content:'\\e087'}.od-PersonaCard-detailLine{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";line-height:30px}.od-PersonaCard-detailLabel{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:'}.od-PersonaCard-action.od-PersonaCard-orgChart,.od-PersonaCard-orgChart.od-PersonaCard-overflow{max-height:300px;animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-PersonaCard-action.od-PersonaCard-orgChart,.od-PersonaCard-orgChart.od-PersonaCard-overflow{animation:none}}.od-PersonaCard-action.od-PersonaCard-orgChart:after,.od-PersonaCard-orgChart.od-PersonaCard-overflow:after{display:none}.ms-OrgChart{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;animation-name:ms-fadeIn,ms-slideDownIn10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both;overflow-y:auto;height:200px;width:100%}@media (prefers-reduced-motion:reduce){.ms-OrgChart{animation:none}}.ms-OrgChart .od-Persona .od-Persona-image,.ms-OrgChart .od-Persona .od-Persona-imageArea,.ms-OrgChart .od-Persona .od-Persona-imageCircle{width:50px;height:50px}.ms-OrgChart .od-Persona-details{margin-top:5px}.ms-OrgChart-group{width:100%;height:auto}.ms-OrgChart-groupTitle{color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";line-height:1;padding:4px}.ms-OrgChart-list{padding:4px;margin:12px 0 16px 0}.ms-OrgChart-listItem{height:auto;width:100%;position:relative;list-style:none;margin-bottom:8px;display:block;padding:2px}.ms-OrgChart-listItem:hover{cursor:pointer}.od-focus--enabled .ms-OrgChart-listItem:focus:before{position:absolute;top:0;left:0;right:0;bottom:0;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";content:''}.ms-OrgChart-listItemBtn{background:0 0;border:0;cursor:pointer;position:relative;height:50px;width:100%;background:0 0;border:0;margin:0;padding:0;outline:transparent}[dir=ltr] .ms-OrgChart-listItemBtn{text-align:left}[dir=rtl] .ms-OrgChart-listItemBtn{text-align:right}"}])});define("Rc",["require","exports","aI","nU","ba","fW","aC","Rd","ep","Gy"],function(e,t,s,i,r,l,o,n,a,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c="CouldNotLoadComponentFromResourceCatalog";t.REQUEST_TIMEOUT_DURATION=3e4;var u="_spPageContextInfo",p=function(){function e(e){this._pageContext=e;this._pageCorrelationId=this._pageContext&&this._pageContext.CorrelationId;this._webTemplate=Number(e.webTemplate)}e.prototype.loadLivePersonaCard=function(e){var n=this;this._loadLivePersonaCardPromise=this._loadLivePersonaCardPromise||new o.default(function(e,i){var r=new s.default({name:"LivePersonaCard.LoadComponentFromResourceCatalog"});try{var t=n._getLpcBootstrapperConfig();d.initializeLivePersonaCard(t).then(function(){r.end({resultType:s.ResultTypeEnum.Success});e()}).catch(function(e){var t="Could not load live persona card from RC: "+e;r.end({resultType:s.ResultTypeEnum.Failure,resultCode:c,error:t});i(t)})}catch(e){var o="Could not load live persona card from RC: "+e.name+" "+e.message;r.end({resultType:s.ResultTypeEnum.Failure,resultCode:c,error:o});i(o)}});this._loadLivePersonaCardPromise.then(function(){e&&e(n._getLpc())},function(e){})};e.prototype._getLpcBootstrapperConfig=function(){return{culture:this._getCulture(),region:this._getRegion(),clientType:"ODSP",clientContextType:this._getDefaultScenarioContextType(),clientCorrelationId:this._pageCorrelationId,getAuthToken:this._getAuthToken,logMessage:function(e,t,i){var r=new s.default({name:e});"Success"===t?r.end({resultType:s.ResultTypeEnum.Success,extraData:{message:i}}):r.end({resultType:"ExpectedFailure"===t?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,error:i||""})},dataCallbacks:{getAndPrefetchPersonaImageUri:function(e,t){t("/_layouts/15/userphoto.aspx?size=L&accountname="+e.Smtp)}},options:{isLinkedInIntegrationEnabled:r.isFeatureEnabled(r.PeopleCardsLinkedInIntegration)}}};e.prototype._getLpc=function(){return window.LPC};e.prototype._getRegion=function(){try{return i.getLokiRegion(this._pageContext)}catch(e){return""}};e.prototype._getCulture=function(){return window[u]&&window[u].currentUICultureName||"en-us"};e.prototype._getAuthToken=function(o,n){var a=new s.default({name:"LivePersonaCard.GetAuthTokenInHostApp"});l.default.start({url:"/_vti_bin/DelveApi.ashx/authtoken/loki?d="+Date.now(),json:null,method:"GET",headers:{"X-Delve-ClientPlatform":"ODSPLivePersonaCard"},requestTimeoutInMS:t.REQUEST_TIMEOUT_DURATION}).then(function(e){var t=e.getResponseHeader("request-id");if(200===e.status){var i=e.responseText.replace(/"/g,"");a.end({resultType:s.ResultTypeEnum.Success,extraData:{requestId:t}});o(i,t)}else{var r="Auth token request status code is "+e.status;a.end({resultType:s.ResultTypeEnum.Failure,resultCode:"ErrorResponse",error:r,extraData:{requestId:t,statusCode:e.status}});n(r,t)}},function(e){var t="Couldn't get authtoken. StatusCode: "+e.status;a.end({resultType:s.ResultTypeEnum.Failure,resultCode:"Generic",error:t});n(t)})};e.prototype._getDefaultScenarioContextType=function(){return this._webTemplate===a.default.teamSite?n.default[n.default.TeamSite]:this._webTemplate===a.default.mySite?n.default[n.default.OneDriveForBusiness]:this._webTemplate===a.default.group?n.default[n.default.Group]:n.default[n.default.Generic]};return e}();t.default=p});define("Rd",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Generic=0]="Generic";e[e.TeamSite=1]="TeamSite";e[e.Group=2]="Group";e[e.OneDriveForBusiness=3]="OneDriveForBusiness"}(i=t.ScenarioContextType||(t.ScenarioContextType={}));t.default=i});define("Rj",["require","exports","ap","aq","aC","bN","Rm","aI","aN","Rk","aZ","Rd","gr","iE","br","ep"],function(e,t,r,o,d,i,c,u,s,n,p,a,l,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g="MruDocumentsReady",y="OrgChartUserPhotoReady",v=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._peopleCards={};t._getPeopleCardListeners={};t._getOrgChartListeners={};t._getDocumentsListeners={};t._queuedPrefetches=[];t._pageContext=t.resources.consume(m.pageContext);t._clientCorrelationId=t._pageContext.CorrelationId;t._webTemplate=Number(t._pageContext.webTemplate);t._prefetchedUserTimestampsByDisplayType={};t._createAndStartLokiConnectionManager();return t}e.prototype.prefetchPeopleCards=function(e,t){e&&0!==e.length&&0!==(e=this._filterAndUpdatePrefetchedUsers(e,t)).length&&(this._connection.connectionState===n.LokiConnectionState.Connected?this._connection.sendPrefetchPeopleCardsMessage(e,p.default.generate(),this._getScenarioContext(void 0,t)):this._queuedPrefetches=this._queuedPrefetches.concat(e))};e.prototype.getPeopleCard=function(i,e){var r=this;void 0===e&&(e=!1);this._lastGetPeopleCardUser=i;var o=this._getPeopleCardObservable(i);if(e)return o;var t=this._clearAndReturnGetPeopleCardListeners(i),n=p.default.generate();o.error(0);this._clearFailed(o);var a={clientCorrelationId:this._clientCorrelationId,connectionId:this._connection.getConnectionId(),requestId:n};t.push(u.Qos.instrumentPromise({name:"LokiGetUserInfo",extraData:a},function(){return r._connection.createMessageListener(o,i,"UserInfoReady",n,function(e){var t=c.createPersonFromLokiPerson(e.UserInfo,r._connection.getServerUrl()),i=o.userInfo().person?o.userInfo().person.image:"";t.image=i;o.userInfo({person:t,failed:!1})},function(e){o.userInfo({person:{userId:i,email:i,name:""},failed:!0});o.error(3)})}));t.push(u.Qos.instrumentPromise({name:"LokiGetCoverPhoto",extraData:a},function(){return r._connection.createMessageListener(o,i,"CoverPhotoDataReady",n,function(e){o.coverPhoto(c.createCoverPhotoFromLokiCoverPhoto(e))},function(e){o.coverPhoto({colorValue:"",isColor:!1,url:"",failed:!0})})}));t.push(u.Qos.instrumentPromise({name:"LokiGetRecentDocs",extraData:a},function(){return r._connection.createMessageListener(o,i,g,n,function(e){return o.recentDocumentSets[r._getDefaultScenarioContextType()](c.createDocumentSection(e))},function(e){return o.recentDocumentSets[r._getDefaultScenarioContextType()]({documents:[],failed:!0,ready:!0})})}));t.push(u.Qos.instrumentPromise({name:"LokiGetManager",extraData:a},function(){return r._connection.createMessageListener(o,i,"ManagerReady",n,function(e){o.managerChain().failed=!1;o.managerChain().ready=!0;if(e.Manager){var t=c.createPersonFromLokiPerson(e.Manager,r._connection.getServerUrl());r._prefetchOrgChartUser([t.userId]);0===o.managerChain().managers.length&&o.managerChain().managers.push(t)}else r.getOrgChart(i);o.managerChain.valueHasMutated()},function(e){return o.managerChain({managers:[],failed:!0,ready:!0})})}));t.push(u.Qos.instrumentPromise({name:"LokiGetUserImage",extraData:a},function(){return r._connection.createMessageListener(o,i,"UserPhotoReady",n,function(e){if(e.Photo&&o.userInfo().person){var t=o.userInfo(),i="data:image/png;base64,"+e.Photo;if(t.person.image!==i){t.person.image=i;o.userInfo(t)}}},function(e){})}));t.push(u.Qos.instrumentPromise({name:"LokiGetOrgChartUserPhoto",extraData:a},function(){return r._connection.createMessageListenerWithTimeout(i,y,n,1e4,function(e){e.HasError||r._updateOrgChartUserPhoto(o,e.Photo,e.OrgChartUserAadObjectId)})}));this._connection.getMessageData(i,"UserNotFound",n).done(function(e){s.default.log({message:"Could not find user",extraData:a},"LokiUserNotFound");o.error(1);d.default.all(t).cancel()},function(e){});this._connection.sendGetPeopleCardMessage(i,n,this._getScenarioContext(),function(e){o.error(2);d.default.all(t).cancel()});return o};e.prototype.getOrgChart=function(e){var s=this;this._lastGetOrgChartUser=e;var l=this._getPeopleCardObservable(e),t=this._clearAndReturnGetOrgChartListeners(e),i=p.default.generate(),r={clientCorrelationId:this._clientCorrelationId,connectionId:this._connection.getConnectionId(),requestId:i};t.push(u.Qos.instrumentPromise({name:"LokiGetOrgChart",extraData:r},function(){return s._connection.createMessageListener(l,e,"OrgChartReady",i,function(e){var t=e.OrgChart,i={};l.managerChain().managers.forEach(function(e){return i[e.aadObjectId]=e.image});l.directReports().directs.forEach(function(e){return i[e.aadObjectId]=e.image});var r=t.Managers.map(function(e){return c.createPersonFromLokiPerson(e,s._connection.getServerUrl(),i[e.AadObjectId]||"")}),o=t.Directs.map(function(e){return c.createPersonFromLokiPerson(e,s._connection.getServerUrl(),i[e.AadObjectId]||"")});l.managerChain({managers:r,failed:!1,ready:!0});l.directReports({directs:o,failed:!1,ready:!0});var n=l.managerChain().managers.map(function(e){return e.userId}),a=l.directReports().directs.map(function(e){return e.userId});s._prefetchOrgChartUser(n.concat(a))},function(e){l.managerChain({managers:[],failed:!0,ready:!0});l.directReports({directs:[],failed:!0,ready:!0})})}));t.push(u.Qos.instrumentPromise({name:"LokiGetOrgChartUserPhoto",extraData:r},function(){return s._connection.createMessageListenerWithTimeout(e,y,i,1e4,function(e){e.HasError||s._updateOrgChartUserPhoto(l,e.Photo,e.OrgChartUserAadObjectId)})}));this._connection.sendGetOrgChartMessage(e,i,this._getScenarioContext(),function(e){l.error(2);d.default.all(t).cancel()});return l};e.prototype.prefetchDocuments=function(e,t){var i=p.default.generate();this._connection.sendPrefetchDocumentsMessage(e,i,this._getScenarioContext(t))};e.prototype.getDocuments=function(e,t){var i=this,r=this._getPeopleCardObservable(e),o=this._clearAndReturnGetDocumentsListeners(e),n=p.default.generate(),a={clientCorrelationId:this._clientCorrelationId,connectionId:this._connection.getConnectionId(),requestId:n,scenarioContextType:t};o.push(u.Qos.instrumentPromise({name:"LokiGetDocuments",extraData:a},function(){return i._connection.createMessageListener(r,e,g,n,function(e){return r.recentDocumentSets[i._getDefaultScenarioContextType()](c.createDocumentSection(e))},function(e){return r.recentDocumentSets[i._getDefaultScenarioContextType()]({documents:[],failed:!0,ready:!0})})}));this._connection.sendGetDocumentsMessage(e,n,this._getScenarioContext(t),function(e){r.error(2);d.default.all(o).cancel()});return r};e.prototype._prefetchOrgChartUser=function(e){if(e&&0!==e.length&&this._connection.connectionState===n.LokiConnectionState.Connected){if(0===(e=this._filterAndUpdatePrefetchedUsers(e,l.default.Card)).length)return;this._connection.sendPrefetchPeopleCardsMessage(e,p.default.generate(),this._getScenarioContext(void 0,l.default.Card))}};e.prototype._filterAndUpdatePrefetchedUsers=function(e,t){var i=this;(e=e.filter(function(e){return!(i._prefetchedUserTimestampsByDisplayType[e]&&i._prefetchedUserTimestampsByDisplayType[e].time+36e5>Date.now()&&i._prefetchedUserTimestampsByDisplayType[e].displayType===t)})).forEach(function(e){i._prefetchedUserTimestampsByDisplayType[e]={time:Date.now(),displayType:t}});return e};e.prototype._clearAndReturnGetPeopleCardListeners=function(e){this._getPeopleCardListeners[e]&&d.default.all(this._getPeopleCardListeners[e]).cancel();this._getPeopleCardListeners[e]=[];return this._getPeopleCardListeners[e]};e.prototype._clearAndReturnGetOrgChartListeners=function(e){this._getOrgChartListeners[e]&&d.default.all(this._getOrgChartListeners[e]).cancel();this._getOrgChartListeners[e]=[];return this._getOrgChartListeners[e]};e.prototype._clearAndReturnGetDocumentsListeners=function(e){this._getDocumentsListeners[e]&&d.default.all(this._getDocumentsListeners[e]).cancel();this._getDocumentsListeners[e]=[];return this._getDocumentsListeners[e]};e.prototype._clearAllListeners=function(){var t=this;Object.keys(this._getPeopleCardListeners).forEach(function(e){t._clearAndReturnGetPeopleCardListeners(e)});Object.keys(this._getOrgChartListeners).forEach(function(e){t._clearAndReturnGetOrgChartListeners(e)});Object.keys(this._getDocumentsListeners).forEach(function(e){t._clearAndReturnGetDocumentsListeners(e)});this._getDocumentsListeners={};this._getPeopleCardListeners={};this._getOrgChartListeners={}};e.prototype._updateOrgChartUserPhoto=function(i,r,o){if(r){i.managerChain().managers.forEach(function(e){if(e.aadObjectId===o){var t="data:image/png;base64,"+r;if(e.image!==t){e.image=t;i.managerChain.valueHasMutated()}}});i.directReports().directs.forEach(function(e){if(e.aadObjectId===o){var t="data:image/png;base64,"+r;if(e.image!==t){e.image=t;i.directReports.valueHasMutated()}}})}};e.prototype._getPeopleCardObservable=function(e){if(this._peopleCards[e])return this._peopleCards[e];var t={};t[this._getDefaultScenarioContextType()]=o.observable({documents:[],failed:!1,ready:!1});var i={userInfo:o.observable({person:{userId:e,name:null,email:e},failed:!1}),coverPhoto:o.observable({colorValue:null,isColor:!1,url:null,failed:!1}),managerChain:o.observable({managers:[],failed:!1,ready:!1}),directReports:o.observable({directs:[],failed:!1,ready:!1}),recentDocumentSets:t,error:o.observable(0)};return this._peopleCards[e]=i};e.prototype._clearFailed=function(e){e.userInfo().failed=!1;e.coverPhoto().failed=!1;e.managerChain().failed=!1;e.directReports().failed=!1;e.recentDocumentSets[this._getDefaultScenarioContextType()]().failed=!1};e.prototype._getDefaultScenarioContextType=function(){return this._webTemplate===f.default.teamSite?a.default.TeamSite:this._webTemplate===f.default.mySite?a.default.Generic:this._webTemplate===f.default.group?a.default.Group:a.default.Generic};e.prototype._getScenarioContext=function(e,t){var i={Properties:{ScenarioPath:this._getCurrentScenarioPath()},ScenarioContextType:void 0!==e?e:this._getDefaultScenarioContextType()};void 0!==t&&(i.Properties.DisplayType=t);return i};e.prototype._getCurrentScenarioPath=function(){var e=window.location.search;e&&"?"===e.charAt(0)&&(e=e.substr(1));return h.deserializeQuery(e).listurl||this._pageContext.webAbsoluteUrl};e.prototype._createAndStartLokiConnectionManager=function(){var e=this;this._connection=new(this.managed(n.LokiConnectionManager))({connectedCallback:function(){0<e._queuedPrefetches.length&&e._connection.sendPrefetchPeopleCardsMessage(e._queuedPrefetches,p.default.generate(),e._getScenarioContext(void 0,l.default.Page));if(e._lastGetPeopleCardUser){e.getPeopleCard(e._lastGetPeopleCardUser);e._lastGetPeopleCardUser===e._lastGetOrgChartUser&&e.getOrgChart(e._lastGetOrgChartUser)}},disconnectedCallback:function(){e._clearAllListeners()},clientCorrelationId:this._clientCorrelationId});this._connection.start()};return e}(i.default);t.default=v});define("Rm",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createPersonFromLokiPerson=function(e,t,i){void 0===i&&(i="");return e?{userId:e.UserPrincipalName,name:e.FullName,email:e.Email,job:e.JobTitle,office:e.OfficeLocation,sip:e.Email,aadObjectId:e.AadObjectId,phone:e.WorkPhone,department:e.Department,image:i,profilePage:t+"/_layouts/15/me.aspx?p="+encodeURIComponent(e.UserPrincipalName)+"&v=profile&origin=ProfileODBCard"}:null};t.createDocumentSection=function(e){return{documents:e.Documents?e.Documents.map(function(e){return i(e)}):[],failed:e.HasError,ready:!0}};function i(e){return{docId:e.Id,title:e.Title,address:e.Address,redirectAddress:function(e){if(e.FileExtension&&"pdf"===e.FileExtension.toLowerCase())return e.Path||e.Address;return e.Address||e.Path}(e),path:e.Path,sitePath:function(e){if(e.SitePath&&-1<e.SitePath.indexOf(";"))return e.SitePath.split(";")[0];return e.SitePath}(e),lastModified:e.LastModified,fileExtension:e.FileExtension,previewImageUrl:function(e){if(!(e.SiteId&&e.WebId&&e.UniqueId&&e.DocId))return"";return"/_layouts/15/getpreview.ashx?guidSite="+e.SiteId+"&guidWeb="+e.WebId+"&guidFile="+e.UniqueId+"&docId="+e.DocId+"&metadataToken="+e.DocumentPreviewMetadata+"&clienttype=PeopleCard"}(e),isShared:"0"!==e.PrivacyIndicator}}t.createDocumentFromLokiDocument=i;t.createCoverPhotoFromLokiCoverPhoto=function(e){return{colorValue:e.CoverPhoto?e.CoverPhoto.ColorValue:"",isColor:!!e.CoverPhoto&&e.CoverPhoto.IsColor,url:e.CoverPhoto?e.CoverPhoto.Url:"",failed:e.HasError}}});define("Rk",["require","exports","ap","aC","bE","bN","gl","eq","iE","Rl","aI","aN","aL","nU","cE"],function(o,e,t,l,d,i,n,a,s,c,u,p,m,h,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var g,y=5e3,v=1,_="hub",b="Could not get data from service";!function(e){e[e.Connecting=0]="Connecting";e[e.Connected=1]="Connected";e[e.Disconnected=2]="Disconnected"}(g=e.LokiConnectionState||(e.LokiConnectionState={}));var r=function(i){t.__extends(r,i);function r(e){var t=i.call(this,e)||this;t._dataRequestor=new(t.child(n.typeResourceKey))({});t._pageContext=t.resources.consume(s.pageContext);t._connectionErrorsListener=null;t._connectedCallback=e.connectedCallback;t._disconnectedCallback=e.disconnectedCallback;t._clientCorrelationId=e.clientCorrelationId;t._reconnectDelay=y;t._authRetriesLeft=v;t._connectionState=g.Disconnected;t._queuedRequests=[];t._authToken=null;t._lastSuccessfulAuthTokenRetrieval=-1;t._logInfo("LokiConnectionManager.Constructor","LokiConnectionManager initialized");return t}Object.defineProperty(r.prototype,"connectionState",{get:function(){return this._connectionState},enumerable:!0,configurable:!0});r.prototype.start=function(){this._connect()};r.prototype.sendPrefetchPeopleCardsMessage=function(r,o,n){var a=this;this._startConnectionIfNecessaryAndExecuteCallback(function(){var e=r?r.length:0,t={clientCorrelationId:a._clientCorrelationId,connectionId:a.getConnectionId(),requestId:o,count:e,scenarioContextType:n.ScenarioContextType},i=new u.Qos({name:"LokiSendPrefetchMessage",extraData:t});try{a._sendWithSignalR(function(e){e?i.end({resultType:u.ResultTypeEnum.Failure,error:e,extraData:t}):i.end({resultType:u.ResultTypeEnum.Success,extraData:t})},_,"PeopleShown",[r,o,n],o)}catch(e){i.end({resultType:u.ResultTypeEnum.Failure,error:e,extraData:t})}},o)};r.prototype.sendGetPeopleCardMessage=function(e,r,o,n){var a=this;this._startConnectionIfNecessaryAndExecuteCallback(function(){var t={clientCorrelationId:a._clientCorrelationId,connectionId:a.getConnectionId(),requestId:r,scenarioContextType:o.ScenarioContextType},i=new u.Qos({name:"LokiSendGetPeopleCardMessage",extraData:t});try{a._sendWithSignalR(function(e){if(e){i.end({resultType:u.ResultTypeEnum.Failure,error:e,extraData:t});n(e)}else i.end({resultType:u.ResultTypeEnum.Success,extraData:t})},_,"GetPersonCard",[e,r,o],r)}catch(e){i.end({resultType:u.ResultTypeEnum.Failure,error:e,extraData:t});n(e)}},r)};r.prototype.sendGetOrgChartMessage=function(e,r,o,n){var a=this;this._startConnectionIfNecessaryAndExecuteCallback(function(){var t={clientCorrelationId:a._clientCorrelationId,connectionId:a.getConnectionId(),requestId:r,scenarioContextType:o.ScenarioContextType},i=new u.Qos({name:"LokiSendGetOrgChartMessage",extraData:t});try{a._sendWithSignalR(function(e){if(e){i.end({resultType:u.ResultTypeEnum.Failure,error:e,extraData:t});n(e)}else i.end({resultType:u.ResultTypeEnum.Success,extraData:t})},_,"GetOrgChart",[e,r,o],r)}catch(e){i.end({resultType:u.ResultTypeEnum.Failure,error:e,extraData:t});n(e)}},r)};r.prototype.sendGetDocumentsMessage=function(e,r,o,n){var a=this;this._startConnectionIfNecessaryAndExecuteCallback(function(){var t={clientCorrelationId:a._clientCorrelationId,connectionId:a.getConnectionId(),requestId:r,scenarioContextType:o.ScenarioContextType},i=new u.Qos({name:"LokiSendGetDocumentsMessage",extraData:t});try{a._sendWithSignalR(function(e){if(e){i.end({resultType:u.ResultTypeEnum.Failure,error:e,extraData:t});n(e)}else i.end({resultType:u.ResultTypeEnum.Success,extraData:t})},_,"GetMruDocuments",[e,r,o],r)}catch(e){i.end({resultType:u.ResultTypeEnum.Failure,error:e,extraData:t});n(e)}},r)};r.prototype.sendPrefetchDocumentsMessage=function(e,r,o){var n=this;this._startConnectionIfNecessaryAndExecuteCallback(function(){var t={clientCorrelationId:n._clientCorrelationId,connectionId:n.getConnectionId(),requestId:r,scenarioContextType:o.ScenarioContextType},i=new u.Qos({name:"LokiSendPrefetchDocumentsMessage",extraData:t});try{n._sendWithSignalR(function(e){e?i.end({resultType:u.ResultTypeEnum.Failure,error:e,extraData:t}):i.end({resultType:u.ResultTypeEnum.Success,extraData:t})},_,"PrefetchMruDocuments",[e,r,o],r)}catch(e){i.end({resultType:u.ResultTypeEnum.Failure,error:e,extraData:t})}},r)};r.prototype.createMessageListenerWithTimeout=function(i,r,o,n,a){var s=this,e=new d.default,t=e.getPromise().then(function(){s._resetConnectionTimeout();var e=new d.default,t=s._subscribe(function(e,t){r===e&&t&&t.RequestedCardUserId===i&&t.RequestId===o&&a(t)});s.async.setTimeout(function(){e.complete()},n);return e.getPromise().then(function(e){t.dispose();return e},function(e){t.dispose();return l.default.wrapError(e)})});this._startConnectionIfNecessaryAndCompleteSignal(e,o);return t};r.prototype.createMessageListener=function(e,t,i,r,o,n){var a=this;return this.getMessageData(t,i,r).then(function(e){if(e.HasError){n(b);return l.default.wrapError(b)}o(e)},function(e){l.default.isCanceled(e)&&a._connectionState!==g.Disconnected||n(e);return l.default.wrapError(e)})};r.prototype.getMessageData=function(o,n,a){var s=this,e=new d.default,t=e.getPromise().then(function(){s._resetConnectionTimeout();var i=new d.default,t=s.async.setTimeout(function(){i.error("Timeout")},1e4),r=s._subscribe(function(e,t){n===e&&t&&t.RequestedCardUserId===o&&t.RequestId===a&&i.complete(t)});return i.getPromise().then(function(e){s.async.clearTimeout(t);r.dispose();return e},function(e){s.async.clearTimeout(t);r.dispose();return l.default.wrapError(e)})});this._startConnectionIfNecessaryAndCompleteSignal(e,a);return t};r.prototype.getServerUrl=function(){return a.getServerUrl(this._pageContext)};r.prototype.getConnectionId=function(){return this._signalRManager?this._signalRManager.getConnectionId():""};r.prototype._connect=function(t){var i=this;void 0===t&&(t=0);this._connectionState=g.Connecting;var r=new u.Qos({name:"LokiConnect",extraData:{clientCorrelationId:this._clientCorrelationId}}),e=Date.now()-27e5>this._lastSuccessfulAuthTokenRetrieval;!this._authToken||e?this._dataRequestor.getData({url:a.getSafeWebServerRelativeUrl(this._pageContext)+"/_vti_bin/DelveApi.ashx/authtoken/loki?d="+Date.now(),qosName:"LokiGetAuthToken",method:"GET",additionalHeaders:{"X-Delve-ClientPlatform":"ODBPeopleCard"}}).then(function(e){i._lastSuccessfulAuthTokenRetrieval=Date.now();i._authToken=e;i._startConnection(e,t,r,!0)},function(){r.end({resultCode:"AccessTokenRetrieval",resultType:u.ResultTypeEnum.Failure,extraData:i._getExtraQoSData()});i._authToken=null;i._resetTimeoutsAndListeners();i._attemptReconnectAfterDelay(t)}):this._startConnection(this._authToken,t,r,!1)};r.prototype._startConnection=function(e,i,r,o){var t,n,a=this;try{t=this._generateLokiUrlFromRegion(h.getLokiRegion(this._pageContext))}catch(e){r.end({resultCode:"CreateLokiBackendUrl",resultType:u.ResultTypeEnum.Failure,extraData:m.extend(this._getExtraQoSData(),{error:e,fetchedNewAuthToken:o})});this._resetTimeoutsAndListeners();this._attemptReconnectAfterDelay(i);return}try{n="AuthToken="+encodeURIComponent(e)+"&clientCorrelationId="+this._clientCorrelationId+"&client=ODSP&clientVersion="+this._getClientVersion()+"&farmLabel="+this._getFarmLabel()+"&farmId="+this._getFarmId()}catch(e){r.end({resultCode:"CreateAdditionalQueryString",resultType:u.ResultTypeEnum.Failure,extraData:m.extend(this._getExtraQoSData(),{error:e})});this._resetTimeoutsAndListeners();this._attemptReconnectAfterDelay(i);return}this._signalRManager=new c.SignalRManager({logErrorCallback:function(e,t){return a._logError(e,t)},logInfoCallback:function(e,t){return a._logInfo(e,t)},url:t,transport:c.TransportType.WebSocketsWithLongPollingFallback,connectionData:[{name:_}],additionalQueryString:n,reconnectCallback:function(){a._authRetriesLeft--;a._clearConnection(0<=a._authRetriesLeft)}});this._signalRManager.disconnected(function(e){p.default.log(e,"LokiDisconnect");a._resetTimeoutsAndListeners();a._attemptReconnectAfterDelay(i)});this._signalRManager.start(function(e,t){if(null==e){r.end({resultType:u.ResultTypeEnum.Success,extraData:m.extend(a._getExtraQoSData(),{transportType:c.TransportType[t],fetchedNewAuthToken:o})});a._connectedCallback&&a._connectedCallback();a._authRetriesLeft=v;a._connectionState=g.Connected;a.events.on(window,"unload",function(){a._signalRManager.end(null)});a._startConnectionErrorsListener();a._resetConnectionTimeout();a._executeAndClearQueuedRequests()}else{r.end({resultCode:"SignalRManager",resultType:u.ResultTypeEnum.Failure,extraData:m.extend(a._getExtraQoSData(),{error:e})});a._resetTimeoutsAndListeners();a._attemptReconnectAfterDelay(i)}})};r.prototype._logError=function(e,t){p.default.log({message:"Loki"+t,extraData:this._getExtraQoSData()},e)};r.prototype._logInfo=function(e,t,i){void 0===i&&(i=null);var r=this._getExtraQoSData();r.message=t;i&&(r.requestId=i);this.resources.consume(f.resourceKey).logData({name:"Loki"+e,extraData:r})};r.prototype._subscribe=function(e){return this._signalRManager?this._signalRManager.subscribe(e):{dispose:function(){}}};r.prototype._getExtraQoSData=function(){return{clientCorrelationId:this._clientCorrelationId,connectionId:this.getConnectionId(),connectionState:g[this._connectionState]}};r.prototype._startConnectionErrorsListener=function(){var i=this;this._connectionErrorsListener=this._subscribe(function(e,t){if("TokenExpired"===e){p.default.log({message:"Security token expired. Attempting to reconnect with new token",extraData:i._getExtraQoSData()},"LokiTokenExpired");i._endConnection(!0)}else if("UnknownAuthorizationFailure"===e){p.default.log({message:"Unknown authorization failure encountered",extraData:i._getExtraQoSData()},"LokiUnknownAuthorizationFailure");i._endConnection(!1)}else if("PersonCardUnknownFailure"===e){p.default.log({message:"Unknown failure encountered",extraData:i._getExtraQoSData()},"LokiUnknownFailure");i._endConnection(!1)}})};r.prototype._endConnection=function(t){var i=this;if(this._signalRManager){this._signalRManager.disconnected(null);this._signalRManager.end(function(e){i._clearConnection(t)})}else this._clearConnection(t)};r.prototype._clearConnection=function(e){this._clearConnectionErrorsListener();if(e)this._connect();else{this._connectionState=g.Disconnected;this._disconnectedCallback&&this._disconnectedCallback()}};r.prototype._resetTimeoutsAndListeners=function(){this.async.clearTimeout(this._connectionTimeoutId);this._clearConnectionErrorsListener()};r.prototype._clearConnectionErrorsListener=function(){if(this._connectionErrorsListener){this._connectionErrorsListener.dispose();this._connectionErrorsListener=null}};r.prototype._executeAndClearQueuedRequests=function(){this._queuedRequests.forEach(function(e){return e.complete()});this._queuedRequests=[]};r.prototype._attemptReconnectAfterDelay=function(e){var t=this;if(e<1){this._reconnectDelay=y;this._queuedRequests=[];this._connectionState=g.Disconnected;this._disconnectedCallback&&this._disconnectedCallback()}else if(r._connectTimestamp&&Date.now()-r._connectTimestamp<this._reconnectDelay){p.default.log({message:"Attempting reconnect too soon",extraData:this._getExtraQoSData()},"LokiConnectionAttemptTooSoon");this._endConnection(!1)}else{r._connectTimestamp=Date.now();p.default.log({message:"Attempting reconnect in "+this._reconnectDelay+" ms",extraData:this._getExtraQoSData()},"LokiReconnect");this.async.setTimeout(function(){t._reconnectDelay*=2;t._connect(e-1)},this._reconnectDelay)}};r.prototype._getClientVersion=function(){try{var e="undefined"==typeof __webpack_public_path__?o.toUrl(""):__webpack_public_path__,t=e.indexOf("/files/");return e.substr(t+"/files/".length).replace("/","")}catch(e){return"error"}};r.prototype._sendWithSignalR=function(e,t,i,r,o){void 0===o&&(o="0");this._resetConnectionTimeout();this._signalRManager.send(e,t,i,r,o)};r.prototype._resetConnectionTimeout=function(){var e=this;this.async.clearTimeout(this._connectionTimeoutId);this._connectionTimeoutId=this.async.setTimeout(function(){e._logInfo("LokiConnectionManager.ResetConnectionTimeout","Connection idle. Disconnecting.");e._endConnection(!1)},36e5)};r.prototype._startConnectionIfNecessaryAndExecuteCallback=function(e,t){var i=new d.default;i.getPromise().then(function(){return e()});this._startConnectionIfNecessaryAndCompleteSignal(i,t)};r.prototype._startConnectionIfNecessaryAndCompleteSignal=function(e,t){if(this._connectionState===g.Disconnected){this._logInfo("LokiConnectionManager.StartConnectionIfNecessary","Currently in disconnected state. Attempting to start new connection and queueing request.",t);this._queuedRequests.push(e);this.start()}else{if(this._connectionState!==g.Connecting){this._logInfo("LokiConnectionManager.StartConnectionIfNecessary","Currently in connected state. Executing request.",t);return e.complete()}this._logInfo("LokiConnectionManager.StartConnectionIfNecessary","Currently in connecting state. Queueing request.",t);this._queuedRequests.push(e)}};r.prototype._getFarmLabel=function(){return this._pageContext.farmLabel};r.prototype._getFarmId=function(){var e=this._pageContext.fid;e||p.default.log({message:"Farm Id property not found in _spPageContextinfo object",extraData:this._getExtraQoSData()},"LokiNoFarmId");return e};r.prototype._generateLokiUrlFromRegion=function(e){return"https://"+e+".loki.delve.office.com/signalr"};return r}(i.default);e.LokiConnectionManager=r});define("Rl",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,l,d;!function(e){e[e.Get=0]="Get";e[e.Post=1]="Post"}(s||(s={}));!function(e){e[e.Abort=0]="Abort";e[e.Connect=1]="Connect";e[e.Negotiate=2]="Negotiate";e[e.Poll=3]="Poll";e[e.Start=4]="Start";e[e.Send=5]="Send"}(l||(l={}));!function(e){e[e.LongPolling=0]="LongPolling";e[e.WebSockets=1]="WebSockets";e[e.WebSocketsWithLongPollingFallback=2]="WebSocketsWithLongPollingFallback"}(d=t.TransportType||(t.TransportType={}));var i=function(){function e(e){this.receivedCallbacks=[];this.config=e;this.queuedWebSocketSendRequests=[]}e.prototype.start=function(r){var o=this;this.config.logInfoCallback("SignalRManager.start","SignalRManager start");this.signalRNegotiate(function(e,t){if(null==e)if(t){o.negotiateResponse=t;o.signalRConnect(function(e,t){if(null==e)o.signalRStart(function(e,t){if(null==e)if(t&&"started"===t.Response)r(null,o.getTransport("start"));else{var i="Unexpected start response "+(t?t.Response:": startResponse is null");o.config.logErrorCallback("SignalRManager.signalRStart",i);r(i,null)}else{o.config.logErrorCallback("SignalRManager.signalRStart",e);r(e||"Unknown error 3",null)}});else{o.config.logErrorCallback("SignalRManager.signalRConnect in signalRNegotiate",e);r(e||"Unknown error 2",null)}})}else{o.config.logErrorCallback("SignalRManager.signalRNegotiate",e);r("negotiateResponse is not defined",null)}else{o.config.logErrorCallback("SignalRManager.signalRNegotiate",e);r(e||"Unknown error 1",null)}})};e.prototype.send=function(e,t,i,r,o){void 0===o&&(o="0");var n={H:t,M:i,A:r,I:o};if(this.negotiateResponse&&this.getTransport("send")===d.WebSockets){if(!this.socket||1!==this.socket.readyState){var a=this.socket?"WebSocket readyState is not CONNECTED.":"WebSocket is undefined or null.";this.config.logErrorCallback("SignalRManager.send",a+" Queueing the send request");this.queueWebSocketSendRequests(n,e);return}this.socket.send(JSON.stringify(n));e(null)}else this.request({method:s.Get,expectedStatusCode:200,action:l.Send,queryString:"data="+JSON.stringify(n)},e)};e.prototype.end=function(e){this.request({method:s.Post,action:l.Abort,expectedStatusCode:200},e)};e.prototype.disconnected=function(e){this.disconnectedCallback=e};e.prototype.subscribe=function(t){var i=this;this.receivedCallbacks.push(t);return{dispose:function(){var e=i.receivedCallbacks.indexOf(t);-1<e&&i.receivedCallbacks.splice(e,1)}}};e.prototype.getTransport=function(e){this.negotiateResponse||this.config.logErrorCallback("SignalRManager.getTransport","this.negotiateResponse is undefined in "+e);return this.negotiateResponse&&this.negotiateResponse.TryWebSockets?d.WebSockets:d.LongPolling};e.prototype.getConnectionId=function(){return this.negotiateResponse?this.negotiateResponse.ConnectionId:""};e.prototype.getBaseQueryString=function(){var e="clientProtocol=1.5";this.config.additionalQueryString&&(e+="&"+this.config.additionalQueryString);this.config.connectionData&&(e+="&connectionData="+encodeURIComponent(JSON.stringify(this.config.connectionData)));if(this.negotiateResponse){this.negotiateResponse.ConnectionToken&&(e+="&connectionToken="+encodeURIComponent(this.negotiateResponse.ConnectionToken));this.negotiateResponse.TryWebSockets?e+="&transport=webSockets":e+="&transport=longPolling"}return e};e.prototype.signalRNegotiate=function(e){this.request({method:s.Get,action:l.Negotiate,expectedStatusCode:200},e)};e.prototype.signalRConnect=function(i){var r=this;if(this.negotiateResponse){this.negotiateResponse.TryWebSockets=this.negotiateResponse.TryWebSockets&&this.config.transport!==d.LongPolling&&"function"==typeof WebSocket;if(this.negotiateResponse.TryWebSockets){this.config.logInfoCallback("SignalRManager.signalRConnect","WebSocket negotiated");this.socket=new WebSocket("wss://"+this.config.url.substring(8)+"/connect?"+this.getBaseQueryString());this.socket.onopen=function(){r.config.logInfoCallback("SignalRManager.socket.onopen","WebSocket opened.");r.config.transport=d.WebSockets;r.executeAndClearQueuedWebSocketSendRequests()};this.socket.onclose=function(e){e?r.config.logErrorCallback("SignalRManager.socket.onclose","WebSocket issue. ErrorCode: "+e.code+". Reason: '"+e.reason+"'. WasClean: "+e.wasClean+"."):r.config.logErrorCallback("SignalRManager.socket.onclose","No closeEvent");r.onSocketClose(i)};this.socket.onerror=function(){r.onSocketError(i)};this.socket.onmessage=function(e){if(1===r.socket.readyState)if(e.data){var t=JSON.parse(e.data);1===t.S?i(null,null):r.processMessage(t)}else r.config.logErrorCallback("SignalRManager.socket.onmessage","No data in websocket message.");else{r.config.logErrorCallback("SignalRManager.socket.onmessage","Websocket not ready. Reconnecting with longpolling");r.negotiateResponse.TryWebSockets=!1;r.signalRConnect(i)}}}else{this.config.logInfoCallback("SignalRManager.signalRConnect","Longpolling negotiated");this.runLongPolling();this.request({method:s.Post,action:l.Connect,expectedStatusCode:200},i)}}else{this.config.logErrorCallback("SignalRManager.signalRConnect in signalRConnect","Connection not yet negotiated.");i("SignalR connection not negotiated in signalRConnect",null)}};e.prototype.onSocketError=function(e){if(this.config.transport===d.WebSocketsWithLongPollingFallback){this.config.logErrorCallback("SignalRManager.socket.onerror","WebSocket issue. Attempting longpolling.");this.negotiateResponse&&(this.negotiateResponse.TryWebSockets=!1);this.signalRConnect(e)}else if(this.disconnectedCallback){this.config.logErrorCallback("SignalRManager.socket.onerror","WebSocket error. Closing connection.");this.disconnectedCallback("Websocket onerror")}};e.prototype.onSocketClose=function(e){if(this.disconnectedCallback){this.config.logErrorCallback("SignalRManager.socket.onclose","WebSocket connection closed.");this.disconnectedCallback("Websocket onclose")}};e.prototype.poll=function(e){var t="";this.lastMessageId&&(t="messageId="+encodeURIComponent(this.lastMessageId));this.request({method:s.Post,action:l.Poll,expectedStatusCode:200,queryString:t},e)};e.prototype.signalRStart=function(e){this.request({method:s.Get,action:l.Start,expectedStatusCode:200},e)};e.prototype.runLongPolling=function(){var i=this;this.poll(function(e,t){if(!e&&t){i.processMessage(t);i.runLongPolling()}else i.disconnectedCallback&&i.disconnectedCallback(e)})};e.prototype.processMessage=function(e){var r=this;if(e){this.lastMessageId=e.C;var o=e.M;o&&o.forEach(function(t,i){try{r.config.logInfoCallback("SignalRManager.processMessage","Processing message "+(i+1)+" of "+o.length+". MethodName: "+t.M);r.receivedCallbacks.forEach(function(e){e(t.M,t.A[0])})}catch(e){r.config.logErrorCallback("SignalRManager.processMessage","Could not process message "+(i+1)+" of "+o.length+". MethodName: "+t.M+". Error: "+e)}})}else this.config.logInfoCallback("SignalRManager.processMessage","Received message without message response")};e.prototype.request=function(t,i){var r=this,e=this.config.url+"/"+l[t.action].toLowerCase()+"?"+this.getBaseQueryString();t.queryString&&(e+="&"+t.queryString);var o=new XMLHttpRequest;o.open(s[t.method].toUpperCase(),e);if(i){o.onreadystatechange=function(){if(4===o.readyState){if(t.action!==l.Poll&&t.action!==l.Send){var e="StatusCode: "+o.status+". RequestMethod: "+s[t.method]+". RequestAction: "+l[t.action];r.config.logInfoCallback("SignalRManager.requestResponse",e)}o.status===t.expectedStatusCode?o.responseText&&0<o.responseText.length?i(null,JSON.parse(o.responseText)):i(null,null):401===o.status?r.config.reconnectCallback?r.config.reconnectCallback():i("No reconnectCallback provided. StatusText: "+o.statusText+", ReadyState: "+o.readyState+", Status: "+o.status+"RequestMethod: "+s[t.method]+". RequestAction: "+l[t.action],null):i("Error with unexpected status. StatusText: "+o.statusText+", ReadyState: "+o.readyState+", Status: "+o.status+"RequestMethod: "+s[t.method]+". RequestAction: "+l[t.action],null)}};o.onerror=function(){i("StatusText: "+o.statusText+", ReadyState: "+o.readyState+", Status: "+o.status+". RequestMethod: "+s[t.method]+". RequestAction: "+l[t.action],null)}}o.send()};e.prototype.executeAndClearQueuedWebSocketSendRequests=function(){if(this.queuedWebSocketSendRequests)for(;this.queuedWebSocketSendRequests.length;){var e=this.queuedWebSocketSendRequests.splice(0,1)[0];this.socket.send(JSON.stringify(e.payload));e.callback(null)}};e.prototype.queueWebSocketSendRequests=function(e,t){this.queuedWebSocketSendRequests.push({payload:e,callback:t})};return e}();t.SignalRManager=i});define("Rn",["require","exports","bA","gf","Nj"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedResourceKey(e("module").id,o.ItemAnalyticsService,{vroomDataRequestor:r.resourceKey})});define("Ro",["require","exports","ap","bN","Rp","iJ","gf","Qq","eT","dZ","bA","aN"],function(e,t,u,i,r,o,n,a,p,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){u.__extends(e,i);function e(e,t){var d=i.call(this,e,t)||this;d._onProcessBatch=function(i){var t=d.observables,r=d._itemsStore,e=i.map(function(e){return t.peekUnwrap(r.getItem(e))}),o=e.map(function(e){return e.graph.itemId}),n=e[0],a=d._graphDataSource.getDriveUrl(n,{useDirectEndpoint:!0})+"/ExtendedActivitiesForItems",s=d._graphDataSource.getAccessToken(n,{useDirectEndpoint:!0}),l={driveItems:o,badgeOnly:!0};return d._vroomDataRequestor.send({path:a,apiName:"ItemActivityFieldDataSource.extendedActivitiesForItems",requestType:"POST",accessToken:s,useAuthorizationHeaders:!0,postData:JSON.stringify(l)}).then(function(e){var t=function(e){for(var t={},i=0,r=e;i<r.length;i++){var o=r[i],n=o.driveItemId;if(n){var a=t[n]||(t[n]=[]);a.push(o)}}return t}(e.value);d._processResponse(t,i)})};d._onBatchError=function(e){c.default.log(e,"ItemActivityFieldDataSource.onProcessBatch")};d._areSameBatch=function(e,t){var i=d.observables,r=d._itemsStore,o=i.peekUnwrap(r.getItem(e)),n=i.peekUnwrap(r.getItem(t));return o.graph.driveId===n.graph.driveId};d._vroomDataRequestor=t.vroomDataRequestor;d._itemsStore=t.itemsStore;d._graphDataSource=t.graphDataSource;d._itemTaskObserverType=t.itemTaskObserverType;d._itemActivitiesResultProcessor=t.itemActivitiesResultProcessor;d._batchProcessor=d.scope.attach(new t.batchProcessorType({batchLimit:50,onProcessBatch:d._onProcessBatch,areSameBatch:d._areSameBatch,onBatchError:d._onBatchError}));return d}e.prototype.enqueue=function(e){this._batchProcessor.enqueue(e)};e.prototype._processResponse=function(e,t){for(var i=this.observables,r=this._itemsStore,o=new this._itemTaskObserverType,n=0,a=t;n<a.length;n++){var s=a[n];console.log("DEBUG process key",s);var l=i.peekUnwrap(r.getItem(s)),d=e[l.graph.itemId];if(d){var c=this._itemActivitiesResultProcessor.processResponse({item:{name:l.name,relativePath:"",absolutePath:"",isFolder:!!l.folder,graphItemUrl:this._graphDataSource.getItemUrl(l,{useDirectEndpoint:!0})},response:{value:d,"@odata.nextLink":void 0}}).activities;o.update([new p.Task(l.key).succeed({item:{activity:m(c)}})])}}o.flush()};return e}(i.default);t.ItemActivityFieldDataSource=d;function m(e){var t=e[0],i={};if(t)for(var r=0,o=t.actors;r<o.length;r++){i[(c=o[r]).id]=!0}for(var n=void 0,a=1;a<e.length;a++){var s=e[a];n||(n=u.__assign({},t,{actors:(t.actors||[]).slice()}));for(var l=0,d=s.actors;l<d.length;l++){var c;if(!i[(c=d[l]).id]){n.actors.push(c);i[c.id]=!0}}}return n||t}t.resourceKey=l.createResolvedResourceKey(e("module").id,d,u.__assign({},i.default.dependencies,{batchProcessorType:r.typeResourceKey,vroomDataRequestor:n.resourceKey,itemTaskObserverType:p.resourceKey,graphDataSource:s.graph,itemActivitiesResultProcessor:a.resourceKey,itemsStore:o.resourceKey}))});define("Rp",["require","exports","bA","Rq","bN"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=i.createResolvedTypeResourceKey(e("module").id,r.BatchProcessor,{asyncType:o.asyncTypeResourceKey})});define("Rq",["require","exports","jh","bE","aC","bS","bD"],function(e,t,p,m,r,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var i=this,r=t.asyncType,o=void 0===r?h.default:r;this._scope=new f.default;this._async=new o(this);this._semaphore=new p.default;this._onProcessBatch=e.onProcessBatch;this._batchLimit=e.batchLimit;this._onBatchError=e.onBatchError;var n=e.processorLimit,a=void 0===n?1:n,s=e.throttleDelay,l=void 0===s?10:s,d=e.areSameBatch,c=void 0===d?g:d;this._areSameBatch=c;this._throttleDelay=l;this._queuedKeys=[];this._signal=new m.default;for(var u=0;u<a;u++)this._semaphore.enqueue(function(){return i._processQueue()});this._scope.attach({dispose:function(){i._signal.cancel()}})}e.prototype.enqueue=function(e){this._queuedKeys.push(e);var t=this._signal;this._signal=new m.default;t.complete()};e.prototype.dispose=function(){this._scope.dispose()};e.prototype._processQueue=function(){var i=this;return this._signal.getPromise().then(function(){return i._delay()}).then(function(){var e=i._take();return r.default.resolve(0<e.length?i._onProcessBatch(e):void 0).catch(function(e){var t=i._onBatchError;t&&t(e)})}).then(function(){i._semaphore.enqueue(function(){return i._processQueue()})})};e.prototype._delay=function(){var e=this,t=new m.default(function(){e._async.clearTimeout(void 0)});this._async.setTimeout(function(){t.complete()},this._throttleDelay);return t.getPromise()};e.prototype._take=function(){var e=[],t=this._queuedKeys,i=t.shift();i&&e.push(i);for(var r=0;e.length<this._batchLimit&&r<t.length;){var o=t[r];this._areSameBatch(i,o)?e.push.apply(e,t.splice(r,1)):r++}return e};return e}();t.BatchProcessor=i;function g(){return!0}});define("Rr",["require","exports","ap","bN","gC","dZ","bA","iJ","aC","eT","jh"],function(e,t,i,o,n,a,r,s,u,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=1,p=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._itemTaskObserver=new t.itemTaskObserverType;i._itemsStore=t.itemsStore;i._getTrendingSignalQueue=new l.default(d);i._itemQueue=[];return i}e.prototype.queueNewItem=function(e){1===this._itemQueue.push(e)&&this.async.setTimeout(this._processNewItems,10)};e.prototype._processNewItems=function(){var c=this;this.resources.consumeAsync(a.graph).then(function(e){for(var t={},i=0,r=c._itemQueue;i<r.length;i++){var o=r[i],n=c._itemsStore.getItem(o),a=n&&n.peek();(s=e.getDriveUrl(a,{useDirectEndpoint:!0,apiVersion:"v2.1"}))&&(t[s]?t[s].push(a):t[s]=[a])}c._itemQueue=[];for(var s in t)if(t.hasOwnProperty(s)){var l=t[s],d=e.getAccessToken(l[0],{apiVersion:"v2.1"});c._processQueuedItems(s,d,l)}})};e.prototype._processQueuedItems=function(s,l,d){var c=this;this.resources.consumeAsync(n.resourceKey).then(function(r){for(var o={},e=[];d&&0<d.length;){var t=d.length<20?d.length:20,i=d.splice(0,t),n=0<i.length&&i.reduce(function(e,t){var i=t&&t.properties&&t.properties.uniqueId;if(i){o[t.itemId]={key:t.key,lifeCycleStatus:t.lifeCycleStatus};e.push(i)}return e},[]);if(n&&0<n.length){var a=c._getTrendingSignalQueue.enqueue(function(e,t,i){return function(){return r.getFilesAnalytics(e,t,i)}}(n,s,l));e.push(a)}}return u.default.all(e).then(function(e){c._processQueryResponse(e,o)})})};e.prototype._processQueryResponse=function(e,t){for(var i=[],r=0,o=e;r<o.length;r++)for(var n=0,a=o[r].value;n<a.length;n++){var s=a[n],l=s.analytics.lastSevenDays&&s.analytics.lastSevenDays.isTrending,d=t[s.id];if("string"==typeof l&&"True"===l||"boolean"==typeof l&&!0===l){d.lifeCycleStatus=d.lifeCycleStatus||{};d.lifeCycleStatus.isTrending=!0;i.push(new c.Task(d.key).succeed({item:d}))}}this._itemTaskObserver.update(i);this._itemTaskObserver.flush()};e.dependencies=i.__assign({},o.default.dependencies,{itemTaskObserverType:c.resourceKey,itemsStore:s.resourceKey});return e}(o.default);t.default=p;t.resourceKey=r.createResolvedResourceKey(e("module").id,p)});define("Rs",["require","exports","aC","fW","bA"],function(e,t,l,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._makeXHR=t.makeXHR||i.default.start}e.prototype.getContents=function(s){var e=s.zip&&s.zip.zipMetaDataUrl;return e?this._makeXHR({url:e}).then(function(e){var t=e.status;if(200<=t&&t<300){var i=JSON.parse(e.responseText).metadata,r=i.delimiter,o=i.error,n=i.list,a=void 0===n?[]:n;return{delimiter:r,error:o,root:{children:a,date:s.dateModified,extension:s.extension,isFolder:!0,name:s.name,childCount:a.length,parentFolder:void 0,path:"",size:0}}}return l.default.reject(new Error(""+t))},function(e){return l.default.reject(e&&e instanceof XMLHttpRequest?new Error(""+e.status):e)}):l.default.reject(new Error("No data."))};return e}();t.default=o;t.resourceKey=r.createResolvedResourceKey(e("module").id,o,{makeXHR:void 0})});define("Rt",["require","exports","Rw","b5","Rv","Ru"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-peoplecard",template:e("Rv"),viewModel:i.default,synchronous:!0});t.default=o});define("Rw",["require","exports","ap","bF","aq","dZ","d7","R1","Ot","RW","RR","RM","RH","RC","Rx","cE","lw","V","Rd","iE","eq","ep","aN","nU"],function(e,t,i,r,c,u,p,m,h,f,g,y,v,_,b,x,S,C,o,P,k,n,a,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T="/_layouts/15/editprofile.aspx",w=5,E=3,D=10,s=function(d){i.__extends(e,d);function e(e){var t=d.call(this,e)||this;t.reportsToTagName=g.default.tagName;t.staffTagName=y.default.tagName;t.recentDocumentsTagName=v.default.tagName;t.orgChartTagName=_.default.tagName;t.expandedDocumentsTagName=b.default.tagName;t.personaImageTagName=h.default.tagName;t.errorDetailsTagName=f.default.tagName;t._hideUnwantedElements();t._skipUnwantedFocusOnDialog();t._observableSubscriptions=[];t._peopleCardProvider=t.resources.consume(p.peopleCard);t._engagement=t.resources.consume(x.resourceKey);t.addBindingHandlers({imageLoader:S.default});var i=e.payloadParams.user,r=e.payloadParams.invokerEvent;t.isDataPreloaded=e.payloadParams.isDataPreloaded;t._closeCallback=e.payloadParams.closeCallback;t._currentUserId=c.observable(i.userId||i.sip);t._currentUserEmail=c.observable(i.email||i.userId||i.sip);t._calloutHeight=e.calloutHeight;var o=t.resources.consume(P.pageContext.optional);t._webTemplate=Number(o.webTemplate);t.editProfileLink=""+k.getServerUrl(o)+T;t.personData=c.observable({person:i,failed:!1});t.coverPhoto=c.observable({colorValue:null,isColor:!1,url:null,failed:!1}).extend({rateLimit:50});t.isCoverPhotoLoaded=c.observable(!1);t.isBasicDataReady=c.observable(!1);t.fadeIn=c.observable(!1);t.fadeInFeed=c.observable(!1);t.animateOverlay=c.observable(!1);t.fadeInOverlay=c.observable(!1);t.animateBackButton=c.observable(!1);t.scrollableFeed=c.observable(!1);t.activeExpandedView=c.observable(0);t.backNavPeople=c.observableArray([]);t.backEnabled=t.createPureComputed(function(){return 0<t.backNavPeople().length&&!t.animateBackButton()});var n=t.resources.consume(u.identity);t._loggedInUserName=n.getIdentity().loginName;t.isMeCard=t.createPureComputed(function(){return t._loggedInUserName===t._currentUserId()});t.personaImageParams=t.createPureComputed(function(){return{person:t.personData().person,iconType:"Contact"}});t.recentDocumentSets={};t.scenarioContextType=c.observable(t._getInitialScenarioContextType());t.availableContextTypes=t._getAvailableContextTypes();for(var a=0,s=t.availableContextTypes;a<s.length;a++){var l=s[a];t.recentDocumentSets[l]=c.observable({documents:[],failed:!1,ready:!1})}t.recentDocsCount=t.createPureComputed(function(){return t.isMeCard()?w:E});t.activeRecentDocs=t.createPureComputed(function(){return t.recentDocumentSets&&t.recentDocumentSets[t.scenarioContextType()]?t.recentDocumentSets[t.scenarioContextType()]():{documents:[],failed:!1,ready:!1}});t.isDocumentsDataReady=t.createPureComputed(function(){return t.activeRecentDocs&&t.activeRecentDocs().ready});t.recentDocumentsSummary=t.createPureComputed(function(){return t.activeRecentDocs&&t.activeRecentDocs().documents&&t.activeRecentDocs().documents.slice(0,t.recentDocsCount())||[]});t.recentDocumentsExpanded=t.createPureComputed(function(){return t.activeRecentDocs&&t.activeRecentDocs().documents&&{documents:t.activeRecentDocs().documents.slice(0,D),failed:t.activeRecentDocs().failed,ready:t.activeRecentDocs().ready}||{documents:[],failed:!1,ready:!1}});t.managerChain=c.observable({managers:[],failed:!1,ready:!1});t.directReports=c.observable({directs:[],failed:!1,ready:!1});t.isManagerDataReady=t.createPureComputed(function(){return t.managerChain&&t.managerChain().ready});t.isDirectsDataReady=t.createPureComputed(function(){return t.directReports&&t.directReports().ready});t.manager=t.createPureComputed(function(){return t.managerChain&&t.managerChain().managers&&t.managerChain().managers[t.managerChain().managers.length-1]||{userId:"",name:"",email:""}});t.moreAboutText=t.createPureComputed(function(){return t.isMeCard()?t.strings.moreAboutYou:t.personData().person&&t.personData().person.name?C.format(t.strings.moreAbout,t.personData().person.name):""});t.moreDocumentsText=t.createPureComputed(function(){return t.isMeCard()?t.strings.moreDocumentsYou:t.personData().person&&t.personData().person.name?C.format(t.strings.moreDocuments,t.personData().person.name):""});t.sendMailText=t.createPureComputed(function(){return t.personData().person.email?C.format(t.strings.sendEmail,t.personData().person.email):""});t.sendImText=t.createPureComputed(function(){return t.personData().person.sip?C.format(t.strings.sendIM,t.personData().person.sip):""});t.expandedLinkUrl=t.createPureComputed(function(){return 2===t.activeExpandedView()?""+t.personData().person.profilePage.replace("&v=profile","&v=liveprofilemodified"):t.personData().person.profilePage});t.expandedLinkText=c.observable("");t.error=c.observable(0);t.hasError=t.createPureComputed(function(){return 0!==t.error()});t.errorMessage=t.createPureComputed(function(){return 0===t.error()?null:1===t.error()?t.strings.errorUserNotFound:t.strings.errorOther});t.strings=m.strings;t.getPeopleCardData(i,t.isDataPreloaded);t.async.setTimeout(function(){if(t._calloutHeight){t._calloutHeight(t._calloutHeight.peek()+1);t.fadeIn(!0)}},0);r&&r.type===I.PEOPLE_CARD_HOVER_EVENT_NAME?t._fadeInFeedAndScrollbarAfterDelay():t.fadeInFeed(!0);t.isOverlayDisplayed=t.createPureComputed(function(){return 0!==t.activeExpandedView()});t.overlayStyle=c.observable({});t.expandedSectionCoords={top:0,left:0,width:0,height:0};return t}e.prototype.showOrgClick=function(e){this._engagement.logData({name:"ShowOrganization.PeopleCard.Click",isIntentional:!0});this._peopleCardProvider.getOrgChart(this._currentUserEmail());this.expandedLinkText(this.moreAboutText());e&&this._animateExpandedViewOpen(e,1)};e.prototype.showMoreDocumentsClick=function(e){this._engagement.logData({name:"ShowMoreDocuments.PeopleCard.Click",isIntentional:!0});for(var t=0,i=this.availableContextTypes;t<i.length;t++){var r=i[t];r!==this.scenarioContextType()&&this._peopleCardProvider.prefetchDocuments(this._currentUserEmail(),r)}this.expandedLinkText(this.moreDocumentsText());e&&this._animateExpandedViewOpen(e,2)};e.prototype.changeScenarioContext=function(e){this._engagement.logData({name:"ChangeScenarioContext.PeopleCard.Click",isIntentional:!0});this.scenarioContextType(e);this._peopleCardProvider.getDocuments(this._currentUserEmail(),e)};e.prototype.expandContextToGeneric=function(){this.changeScenarioContext(o.default.Generic)};e.prototype.closeExpandedViewClick=function(){var e=this;this._engagement.logData({name:"ExitExpandedView.PeopleCard.Click",isIntentional:!0});this.overlayStyle({top:this.expandedSectionCoords.top+"px",left:this.expandedSectionCoords.left+"px",width:this.expandedSectionCoords.width+"px",height:this.expandedSectionCoords.height+"px"});this.fadeInOverlay(!1);this.activeExpandedView(0);this.animateBackButton(!1);this.async.setTimeout(function(){e.animateOverlay(!1);e.overlayStyle({top:"50px",left:e.expandedSectionCoords.left+"px",width:e.expandedSectionCoords.width+"px",height:"80%"})},267)};e.prototype.backClick=function(){if(this.backEnabled()){this._engagement.logData({name:"BackButton.PeopleCard.Click",isIntentional:!0});this.navigatePerson(this.backNavPeople.pop(),!1,!0)}};e.prototype.retryClick=function(){this._engagement.logData({name:"Retry.PeopleCard.Click",isIntentional:!0});this.navigatePerson(this.personData().person,!1,!1)};e.prototype.coverPhotoClick=function(){this.fadeInFeed()||this.fadeInFeed(!0)};e.prototype.navigatePerson=function(e,t,i){void 0===t&&(t=!0);void 0===i&&(i=!1);if(e.email||e.userId||e.sip){t&&this.backNavPeople.push(this.personData().person);this.isBasicDataReady(!1);this._currentUserId(e.userId||e.sip);this._currentUserEmail(e.email||e.userId||e.sip);this.coverPhoto({colorValue:null,isColor:!1,url:null,failed:!1});this.managerChain({managers:[],failed:!1,ready:!1});this.directReports({directs:[],failed:!1,ready:!1});this.scenarioContextType(this._getInitialScenarioContextType());for(var r=0,o=this.availableContextTypes;r<o.length;r++){var n=o[r];this.recentDocumentSets[n]&&this.recentDocumentSets[n]({documents:[],failed:!1,ready:!1})}this.error(0);this.expandedLinkText("");this.activeExpandedView(0);this.animateOverlay(!1);this.animateBackButton(!1);this.personData({person:e,failed:!1});this._setInitialFocus();this.getPeopleCardData(e)}};e.prototype.logSendEmailClick=function(){if(this.hasError())return!1;this._engagement.logData({name:"SendEmail.PeopleCard.Click",isIntentional:!0});return!0};e.prototype.logStartChatClick=function(){if(this.hasError())return!1;this._engagement.logData({name:"StartChat.PeopleCard.Click",isIntentional:!0});return!0};e.prototype.logProfileClick=function(){this._engagement.logData({name:"ProfileLink.PeopleCard.Click",isIntentional:!0});return!0};e.prototype.logEditProfileClick=function(){this._engagement.logData({name:"EditProfileLink.PeopleCard.Click",isIntentional:!0});return!0};e.prototype.logProfileExpandedClick=function(){this._engagement.logData({name:"ProfileExpandedLink.PeopleCard.Click",isIntentional:!0});return!0};e.prototype.userPhotoClick=function(){this._engagement.logData({name:"UserPhoto.PeopleCard.Click",isIntentional:!0});I.openNewTab(this.personData().person.profilePage)};e.prototype.userPhotoHoverStart=function(){this._engagement.logData({name:"UserPhoto.PeopleCard.HoverStart",isIntentional:!0})};e.prototype.userPhotoHoverEnd=function(){this._engagement.logData({name:"UserPhoto.PeopleCard.HoverEnd"})};e.prototype.mouseLeftCard=function(e,t){if(this._closeCallback&&!this.fadeInFeed()){this._engagement.logData({name:"PeopleCard.MouseLeave"});this._closeCallback()}};e.prototype.afterRender=function(){var e=this;this.async.setTimeout(function(){e._setInitialFocus()},100)};e.prototype.getPeopleCardData=function(t,i){var r=this;void 0===i&&(i=!1);this._engagement.logData({name:"PeopleCard.Launched",extraData:{isMeCard:this.isMeCard(),dataPreloaded:i}});if(t.email||t.userId||t.sip){this._clearPeopleCardObservableSubscriptions();this._peopleCardProvider.getPeopleCard(t.email||t.userId||t.sip,i).then(function(e){r._subscribeToPeopleCardObservableChanges(e);r._updateCardObservables(e,t.name,i)})}};e.prototype._updateCardObservables=function(e,t,i){void 0===i&&(i=!1);var r=e.userInfo();r.person.name||(r.person.name=t);this.personData(r);var o=e.coverPhoto(),n=this.coverPhoto(),a=n.colorValue,s=n.isColor,l=n.url,d=n.failed;o.url===l&&o.colorValue===a&&o.isColor===s&&o.failed===d||this.coverPhoto(o);this.managerChain(e.managerChain());this.directReports(e.directReports());this.recentDocumentSets[this.scenarioContextType()](e.recentDocumentSets[this.scenarioContextType()]());this.error(e.error());i&&r.person&&(r.failed||this.isBasicDataReady(!0))};e.prototype._subscribeToPeopleCardObservableChanges=function(e){var i=this;this._observableSubscriptions.push(e.userInfo.subscribe(function(e){var t=i.personData();!e.person.name&&t.person&&(e.person.name=t.person.name);i.personData(e);e.failed||i.isBasicDataReady(!0)}));this._observableSubscriptions.push(e.coverPhoto.subscribe(this.coverPhoto));this._observableSubscriptions.push(e.managerChain.subscribe(function(e){i.managerChain(e)}));this._observableSubscriptions.push(e.directReports.subscribe(function(e){i.directReports(e)}));this._observableSubscriptions.push(e.recentDocumentSets[this.scenarioContextType()].subscribe(function(e){i.recentDocumentSets[i.scenarioContextType()](e);i._calloutHeight.valueHasMutated()}));this._observableSubscriptions.push(e.error.subscribe(this.error))};e.prototype._clearPeopleCardObservableSubscriptions=function(){this._observableSubscriptions.forEach(function(e){e.dispose()});this._observableSubscriptions=[]};e.prototype._getAvailableContextTypes=function(){var e=[o.default.Generic];this._webTemplate===n.default.teamSite?e.push(o.default.TeamSite):this._webTemplate===n.default.mySite?e.push(o.default.OneDriveForBusiness):this._webTemplate===n.default.group?e.push(o.default.Group):a.default.log("Unknown PeopleCard webTemplateId:"+this._webTemplate);return e};e.prototype._getInitialScenarioContextType=function(){switch(this._webTemplate){case n.default.teamSite:return o.default.TeamSite;case n.default.mySite:return o.default.Generic;case n.default.group:return o.default.Group;default:return o.default.Generic}};e.prototype._fadeInFeedAndScrollbarAfterDelay=function(){var e=this;this.async.setTimeout(function(){e._engagement.logData({name:"PeopleCard.Expanded"});e.fadeInFeed(!0);e._calloutHeight.valueHasMutated();e._setInitialFocus();e.async.setTimeout(function(){e.scrollableFeed(!0);e._calloutHeight.valueHasMutated()},500)},1e3)};e.prototype._animateExpandedViewOpen=function(e,t){for(var i=this,r=e.target;"li"!==r.tagName.toLowerCase();)r=r.parentElement;this.expandedSectionCoords.top=r.offsetTop;this.expandedSectionCoords.left=r.offsetLeft;this.expandedSectionCoords.width=r.offsetWidth;this.expandedSectionCoords.height=r.offsetHeight;this.overlayStyle({top:0,left:0,width:"100%",height:"100%"});this.animateOverlay(!0);this.animateBackButton(!0);this.async.setTimeout(function(){i.activeExpandedView(t);i.fadeInOverlay(!0);i._focusFirstCardElement()},267)};e.prototype._hideUnwantedElements=function(){var e=document.getElementsByClassName("od-Dialog-button od-Dialog-button--close")[0];e&&(e.style.display="none")};e.prototype._skipUnwantedFocusOnDialog=function(){var e=document.getElementsByClassName("od-Dialog-main")[0];e&&(e.onfocus=this._focusFirstCardElement)};e.prototype._focusFirstCardElement=function(){var e=document.getElementsByClassName("od-PeopleCard-userPhoto")[0],t=document.getElementsByClassName("od-PeopleCard-backBtn")[0],i=document.getElementsByClassName("od-PeopleCard-closeExpandedView")[0];i&&"visible"===window.getComputedStyle(i).visibility?i.focus():t&&"visible"===window.getComputedStyle(t).visibility?t.focus():e&&e.focus()};e.prototype._setInitialFocus=function(){var e=document.getElementsByClassName("od-PeopleCard-action")[0],t=document.getElementsByClassName("od-PeopleCard-editProfile")[0];e&&"visible"===window.getComputedStyle(e).visibility?e.focus():t&&"visible"===window.getComputedStyle(t).visibility&&t.focus()};return e}(r.default);t.default=s});define("RW",["require","exports","RZ","b5","RY","RX"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-peoplecard-errordetails",template:e("RY"),viewModel:i.default,synchronous:!0});t.default=o});define("RZ",["require","exports","ap","bF","R0","iE"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.strings=o.strings;t.correlationIdShown=t.createObservable(!1);var i=t.resources.consume(n.pageContext);t.correlationId=i.CorrelationId;return t}e.prototype.moreInfoClick=function(){this.correlationIdShown(!0)};return e}(r.default);t.default=a});define("RY",[],function(){return'<div class=od-PeopleCard-errorDetailsContainer>\x3c!--ko if: !correlationIdShown()--\x3e<a href=javascript:; class="od-PeopleCard-errorDetails ms-font-xs" data-bind="text: strings.errorDetails, click: moreInfoClick"></a>\x3c!--/ko--\x3e\x3c!--ko if: correlationIdShown()--\x3e<div><span class=ms-font-xs data-bind="text: strings.errorCorrelationId"></span> <span class="od-PeopleCard-errorCorrelationId ms-font-xs" data-bind="text: correlationId"></span></div>\x3c!--/ko--\x3e</div>'});define("RX",["c","az"],function(e,t){e.loadStyles([{rawString:".od-PeopleCard-errorDetailsContainer{margin:5px 0}.od-PeopleCard-errorDetails{display:block;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-PeopleCard-errorDetails:hover{cursor:pointer;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PeopleCard-errorCorrelationId{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}"}])});define("RR",["require","exports","RU","b5","RT","RS","Ot"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-peoplecard-reportsto",template:e("RT"),viewModel:i.default,synchronous:!0});t.default=o});define("RU",["require","exports","ap","bF","Ot","cE","RV"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.personaImageTagName=o.default.tagName;t.manager=e.manager;t._navigatePersonCallback=e.navigatePersonCallback;t._showOrgCallback=e.showOrgCallback;t.isDataReady=e.isDataReady;t.isMeCard=e.isMeCard;t.strings=a.strings;t.isKeyboardNavigatable=e.isKeyboardNavigatable;t.contentBlockClass=t.createPureComputed(function(){return t.isDataReady()?"od-PeopleCard-contentBlock":"od-PeopleCard-contentBlock--loading"});t.titleText=t.createPureComputed(function(){return t.isMeCard()?t.strings.yourManager:t.strings.reportsTo});return t}e.prototype.onPersonClick=function(){this.resources.consume(n.resourceKey).logData({name:"ReportsTo.PeopleCard.Click",isIntentional:!0});this._navigatePersonCallback(this.manager())};e.prototype.onShowOrgClick=function(e,t){this._showOrgCallback(t)};return e}(i.default);t.default=s});define("RT",[],function(){return"<li data-bind=\"css: contentBlockClass\"><a href=javascript:; class=\"od-PeopleCard-blockTitle ms-font-m-plus ms-fontWeight-light ms-fontColor-neutralSecondaryAlt\" data-bind=\"text: titleText, click: $component.onShowOrgClick, attr: { tabindex: $component.isKeyboardNavigatable ? '0' : '-1'}\"></a><div class=od-PeopleCard-orgPersonSlim><a class=od-PeopleCard-personControl href=# target=_blank rel=\"noopener noreferrer\" data-bind=\"attr: { tabindex: $component.isKeyboardNavigatable ? '0' : '-1' }, click: $component.onPersonClick\"><span class=od-PeopleCard-personImage>\x3c!--ko if: manager().name--\x3e\x3c!--ko component: {\r\n name: personaImageTagName,\r\n params: { person:manager(), iconType:\"Contact\"}\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</span> <span class=od-PeopleCard-personDetailsSlim><span class=\"od-PeopleCard-personName ms-font-s ms-fontWeight-semibold\" data-bind=\"text: manager() && manager().name || '', attr: {'title': manager() && manager().name || ''}\"></span> <span class=\"od-PeopleCard-personTitleSlim ms-font-s ms-fontWeight-semilight\" data-bind=\"text: manager() && manager().job || '', attr: {'title': manager() && manager().job || ''}\"></span></span></a></div><div class=od-PeopleCard-showMore><a class=od-PeopleCard-showMoreLink href=javascript:; data-bind=\"text: strings.showOrgChart, attr: { tabindex: $component.isKeyboardNavigatable ? '0' : '-1' }, click: $component.onShowOrgClick\"></a></div></li>"});define("RS",["c","az"],function(e,t){e.loadStyles([{rawString:".od-PeopleCard-personControl{height:32px;background-color:transparent;cursor:pointer;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:start;justify-content:flex-start;margin:0 -8px;overflow:hidden;position:relative;padding:4px 8px}.od-PeopleCard-personControl:focus,.od-PeopleCard-personControl:hover{background:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-PeopleCard-personImage{width:32px;height:32px;-ms-flex:none;flex:none;transition:box-shadow 167ms}[dir=ltr] .od-PeopleCard-personImage{margin-right:8px}[dir=rtl] .od-PeopleCard-personImage{margin-left:8px}.od-PeopleCard-personImage .od-Persona-image{width:32px;height:32px;line-height:32px;font-size:14px;transform:translate3d(0,0,0)}.od-PeopleCard-personDetailsSlim{-ms-flex:initial;flex:initial;overflow:hidden;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";white-space:nowrap;text-overflow:ellipsis}html[dir=ltr] .od-PeopleCard-personTitleSlim{border-left:1px solid rgba(0,0,0,.1)}html[dir=rtl] .od-PeopleCard-personTitleSlim{border-right:1px solid rgba(0,0,0,.1)}[dir=ltr] .od-PeopleCard-personTitleSlim{margin-left:.6em}[dir=rtl] .od-PeopleCard-personTitleSlim{margin-right:.6em}[dir=ltr] .od-PeopleCard-personTitleSlim{padding-left:.8em}[dir=rtl] .od-PeopleCard-personTitleSlim{padding-right:.8em}"}])});define("RM",["require","exports","RP","b5","RO","RN","Ot"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-peoplecard-staff",template:e("RO"),viewModel:i.default,synchronous:!0});t.default=o});define("RP",["require","exports","ap","aq","bF","Ot","cE","RQ","V"],function(e,t,r,o,i,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=5,c=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.personaImageTagName=n.default.tagName;t.directs=e.directs;t._navigatePersonCallback=e.navigatePersonCallback;t._showOrgCallback=e.showOrgCallback;t.isDataReady=e.isDataReady;t.strings=s.strings;t.isKeyboardNavigatable=e.isKeyboardNavigatable;t.shownDirects=t.createPureComputed(function(){return t.directs().directs?t.directs().directs.slice(0,5).map(function(e){return o.observable(e)}):[]});t.notShownDirectsCount=t.createPureComputed(function(){return t.directs().directs&&t.directs().directs.length>d?t.directs().directs.length-d:0});t.contentBlockClass=t.createPureComputed(function(){return t.isDataReady()?"od-PeopleCard-contentBlock":"od-PeopleCard-contentBlock--loading"});t.showAllText=t.createPureComputed(function(){return l.format(t.strings.showMoreText,t.directs().directs.length-d)});return t}e.prototype.onPersonClick=function(e){this.resources.consume(a.resourceKey).logData({name:"Staff.PeopleCard.Click",isIntentional:!0});this._navigatePersonCallback(e)};e.prototype.onShowOrgClick=function(e,t){this._showOrgCallback(t)};return e}(i.default);t.default=c});define("RO",[],function(){return"<li data-bind=\"css: contentBlockClass\"><a href=javascript:; class=\"od-PeopleCard-blockTitle ms-font-m-plus ms-fontWeight-light ms-fontColor-neutralSecondaryAlt\" data-bind=\"text: strings.staff, click: $component.onShowOrgClick, attr: { tabindex: $component.isKeyboardNavigatable ? '0' : '-1' }\"></a><div class=od-PeopleCard-facePileControl>\x3c!--ko foreach: shownDirects--\x3e<a class=od-PeopleCard-facepilePerson href=javascript:; data-bind=\"click: $component.onPersonClick.bind($component, $data), attr: { title: name, tabindex: $component.isKeyboardNavigatable ? '0' : '-1' }\">\x3c!--ko component: {\r\n name: $component.personaImageTagName,\r\n params: { person: $data, iconType: \"Contact\"}\r\n }--\x3e\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e\x3c!--ko if: notShownDirectsCount()--\x3e<a class=od-PeopleCard-facepilePerson href=javascript:; data-bind=\"click: $component.onShowOrgClick\"><span class=od-PeopleCard-facePileOverflow data-bind=\"text: showAllText(), title: $component.strings.showAllTooltip, attr: { tabindex: $component.isKeyboardNavigatable ? '0' : '-1' }\"></span></a>\x3c!--/ko--\x3e</div><div class=od-PeopleCard-showMore><a class=od-PeopleCard-showMoreLink href=javascript:; data-bind=\"text: strings.showOrgChart, click: $component.onShowOrgClick, attr: { tabindex: $component.isKeyboardNavigatable ? '0' : '-1' }\"></a></div></li>"});define("RN",["c","az"],function(e,t){e.loadStyles([{rawString:".od-PeopleCard-facePileControl{display:-ms-flexbox;display:flex;padding-top:4px}.od-PeopleCard-facepilePerson{width:32px;height:32px;border:2px solid transparent;border-radius:50%;cursor:pointer;display:inline-block;overflow:hidden;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] .od-PeopleCard-facepilePerson{margin-right:8px}[dir=rtl] .od-PeopleCard-facepilePerson{margin-left:8px}.od-PeopleCard-facepilePerson .od-Persona-image{width:32px;height:32px;transform:translate3d(0,0,0)}.od-PeopleCard-facepilePerson:focus,.od-PeopleCard-facepilePerson:hover{border-color:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}.od-PeopleCard-facepilePerson img{width:100%}.od-PeopleCard-facePileOverflow{width:100%;height:100%;background:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";display:block;font-size:12px;font-weight:bolder;line-height:30px;text-align:center}"}])});define("RH",["require","exports","RK","b5","RJ","RI"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-peoplecard-recentdocuments",template:e("RJ"),viewModel:i.default,synchronous:!0});t.default=o});define("RK",["require","exports","ap","aq","bF","d","RL","df","dq","hs","cE","V","aN","Rd","LY"],function(e,t,r,o,i,n,a,s,l,d,c,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=16,g=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.fileTypeIconTagName=s.default.tagName;t.iconSize=f;t.documents=e.documents;t.personName=e.personName;t.noDocsLink=e.noDocsLink;t.strings=a.strings;t._showMoreDocumentsCallback=e.showMoreDocumentsCallback;t.scenarioContextType=e.scenarioContextType;t.isDataReady=e.isDataReady;t.isMeCard=e.isMeCard;t.isKeyboardNavigatable=e.isKeyboardNavigatable;t.noDocumentsText=t.isMeCard()?t.strings.noDocsDescriptionYou:u.format(t.strings.noDocsDescription,t.personName);t.noDocumentsLink=t.createPureComputed(function(){return t.isMeCard()?t.strings.noDocsLinkYou:u.format(t.strings.noDocsLink,t.personName)});t.noDocumentsInContextText=t.createPureComputed(function(){return t.scenarioContextType()===m.default.Group?t.isMeCard()?t.strings.noDocsDescriptionGroupYou:u.format(t.strings.noDocsDescriptionGroup,t.personName):t.isMeCard()?t.strings.noDocsDescriptionSiteYou:u.format(t.strings.noDocsDescriptionSite,t.personName)});t.isPrivacyInfoShown=o.observable(!1);t.privacyInfoText=t.isMeCard()?t.strings.privacyInfoMe:u.format(t.strings.privacyInfoOthers,t.personName);t.contentBlockClass=t.createPureComputed(function(){return t.isDataReady()?"od-PeopleCard-contentBlock":"od-PeopleCard-contentBlock--loading"});t.titleText=t._getTitleText();t._engagement=t.resources.consume(c.resourceKey);return t}e.prototype.getTimestamp=function(e){return d.getRelativeDateTimeStringPast(d.iso8601DateTimeToJsDate(e))};e.prototype.getIconName=function(e){return l.getIconNameFromExtension(e||"")};e.prototype.onDocumentClick=function(){this._engagement.logData({name:"Document.PeopleCard.Click",isIntentional:!0});return!0};e.prototype.onShowMoreDocumentsClick=function(e,t){this._showMoreDocumentsCallback(t)};e.prototype.logNoDocsClick=function(){this._engagement.logData({name:"NoDocumentsLink.PeopleCard.Click",isIntentional:!0});return!0};e.prototype.showPrivacyInfo=function(){this.isPrivacyInfoShown(!0)};e.prototype.hidePrivacyInfo=function(){this.isPrivacyInfoShown(!1)};e.prototype.getPrivacyTitleText=function(e){return e?this.strings.sharedPrivacyTitle:this.strings.privatePrivacyTitle};e.prototype.getPrivacyIcon=function(e){return n.getIconClassName(e?"People":"Lock")};e.prototype.getFileTypeFromExtension=function(e){return h.getShortcutFileTypeFromExtension(e)};e.prototype._getTitleText=function(){if(this.isMeCard())return this.strings.yourDocumentsTitle;switch(this.scenarioContextType()){case m.default.Generic:return this.strings.documentsTitleO365;case m.default.TeamSite:return this.strings.documentsTitleTeamSite;case m.default.Group:return this.strings.documentsTitleGroup;case m.default.OneDriveForBusiness:return this.strings.documentsTitleSite;default:p.default.log("Unknown PeopleCard scenarioContextType:"+this.scenarioContextType())}};return e}(i.default);t.default=g});define("RJ",[],function(){return'<li data-bind="css: contentBlockClass"><a href=javascript:; class="od-PeopleCard-blockTitle ms-font-m-plus ms-fontWeight-light ms-fontColor-neutralSecondaryAlt" data-bind="text: titleText, click:$component.onShowMoreDocumentsClick, attr: { tabindex: $component.isKeyboardNavigatable ? \'0\' : \'-1\' }"></a> <i class="od-PeopleCard-privacyInfoIcon ms-Icon ms-Icon--Info" data-bind="icon: true, event: { mouseover: showPrivacyInfo, mouseout: hidePrivacyInfo, focus: showPrivacyInfo, blur: hidePrivacyInfo }, attr: { tabindex: $component.isKeyboardNavigatable ? \'0\' : \'-1\', \'aria-label\': privacyInfoText }"></i><div class=od-PeopleCard-documentContentContainer><p class="od-PeopleCard-privacyInfoBlock ms-font-s" data-bind="text: privacyInfoText, visible: isPrivacyInfoShown()"></p>\x3c!--ko if: documents && documents.length === 0--\x3e\x3c!--ko if: scenarioContextType() === 0--\x3e<p class=ms-font-s data-bind="text: noDocumentsText"></p><p class=ms-font-s><a class=od-PeopleCard-noDocsLink data-bind="text: noDocumentsLink(), attr: {\'href\': noDocsLink, target: \'_blank\', rel:\'noopener noreferrer\'}, click: $component.logNoDocsClick.bind($component)"></a></p>\x3c!--/ko--\x3e\x3c!--ko if: scenarioContextType() !== 0--\x3e<p class=ms-font-s data-bind="text: noDocumentsInContextText()"></p><p class=ms-font-s><a class=od-PeopleCard-noDocsLink data-bind="text: strings.noDocsLinkContext, click: $parent.expandContextToGeneric.bind($parent)"></a></p>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: documents && documents.length > 0--\x3e<ol class="od-PeopleCard-documentList od-PeopleCard-resetList ms-font-s" data-bind="foreach: documents"><li class=od-PeopleCard-documentItem><a class="od-PeopleCard-documentItemLink od-PeopleCard-interactiveContentItem" data-bind="attr: {href: redirectAddress, target: \'_blank\', rel:\'noopener noreferrer\', tabindex: $component.isKeyboardNavigatable ? \'0\' : \'-1\' }, click: $component.onDocumentClick.bind($component), keyboard: { mappings: { Space: $component.onDocumentClick.bind($component) } }"><span class=od-PeopleCard-documentTitle><span class=od-PeopleCard-documentIcon>\x3c!--ko component: {\r\n name: $component.fileTypeIconTagName,\r\n params: { iconName: $component.getIconName(fileExtension),\r\n iconUrl: \'\',\r\n desiredSize: $component.iconSize,\r\n iconFieldAriaLabel: $component.getFileTypeFromExtension(fileExtension) }\r\n }--\x3e\x3c!--/ko--\x3e</span> <span class="ms-fontWeight-semibold od-PeopleCard-nowrap" data-bind="text: title"></span> <i class=ms-Icon data-bind="visible: $component.isMeCard(), attr: {title: $component.getPrivacyTitleText(isShared)}, class: $component.getPrivacyIcon(isShared)"></i></span> <span class="od-PeopleCard-documentModified ms-fontColor-neutralSecondaryAlt" data-bind="text: $component.getTimestamp(lastModified)"></span></a></li></ol><div class=od-PeopleCard-showMore><a class=od-PeopleCard-showMoreLink href=javascript:; data-bind="text: strings.showMoreDocs, click:$component.onShowMoreDocumentsClick, attr: { tabindex: $component.isKeyboardNavigatable ? \'0\' : \'-1\' }"></a></div>\x3c!--/ko--\x3e</div></li>'});define("RI",["c","az"],function(e,t){e.loadStyles([{rawString:".od-PeopleCard-privacyInfoIcon{opacity:0;position:absolute;top:14px;font-size:16px;padding:6px;cursor:pointer;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}[dir=ltr] .od-PeopleCard-privacyInfoIcon{right:14px}[dir=rtl] .od-PeopleCard-privacyInfoIcon{left:14px}.od-PeopleCard-privacyInfoIcon:hover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-privacyInfoIcon:focus{opacity:1;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-contentBlock:hover .od-PeopleCard-privacyInfoIcon{opacity:1}.od-PeopleCard-documentContentContainer{position:relative}.od-PeopleCard-privacyInfoBlock{position:absolute;top:0;height:100%;margin:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";z-index:1}[dir=ltr] .od-PeopleCard-privacyInfoBlock{left:0}[dir=rtl] .od-PeopleCard-privacyInfoBlock{right:0}.od-PeopleCard-documentItem{width:100%;line-height:25px;text-decoration:none}.od-PeopleCard-documentTitle{width:70%;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-PeopleCard-documentIcon{position:relative;top:-2px;width:16px;height:16px;display:inline-block}[dir=ltr] .od-PeopleCard-documentIcon{margin-right:4px}[dir=rtl] .od-PeopleCard-documentIcon{margin-left:4px}.od-PeopleCard-documentModified{width:28%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}html[dir=ltr] .od-PeopleCard-documentModified{text-align:right}html[dir=rtl] .od-PeopleCard-documentModified{text-align:left}.od-PeopleCard-noDocsLink{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer}.od-PeopleCard-documentItemLink{-webkit-display:flex;display:-ms-flexbox;display:flex}"}])});define("RC",["require","exports","RF","b5","RE","RD","Ot"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-peoplecard-orgchart",template:e("RE"),viewModel:i.default,synchronous:!0});t.default=o});define("RF",["require","exports","ap","aq","bF","Ot","RG","V","cE"],function(e,t,r,o,i,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.personaImageTagName=n.default.tagName;t._engagement=t.resources.consume(l.resourceKey);t.personInFocus=e.personInFocus;t.managerChain=e.managerChain;t.managers=t.createPureComputed(function(){return e.managerChain().managers?e.managerChain().managers.map(function(e){return o.observable(e)}):[]});t.directReports=e.directReports;t.directs=t.createPureComputed(function(){return e.directReports().directs?e.directReports().directs.map(function(e){return o.observable(e)}):[]});t._navigatePersonCallback=e.navigatePersonCallback;t._retryCallback=e.retryCallback;t._selfClickCallback=e.selfClickCallback;t.strings=a.strings;t.staffLabel=t.createPureComputed(function(){return s.format(t.strings.staffLabel,t.directReports().directs.length)});return t}e.prototype.onManagerClick=function(e){this._navigatePersonCallback(e);this._engagement.logData({name:"OrgManager.PeopleCard.Click",isIntentional:!0})};e.prototype.onSelfClick=function(){this._selfClickCallback();this._engagement.logData({name:"OrgSelf.PeopleCard.Click",isIntentional:!0})};e.prototype.onDirectClick=function(e){this._navigatePersonCallback(e);this._engagement.logData({name:"OrgDirect.PeopleCard.Click",isIntentional:!0})};e.prototype.onRetryClick=function(e){this._retryCallback();this._engagement.logData({name:"OrgRetry.PeopleCard.Click",isIntentional:!0})};return e}(i.default);t.default=d});define("RE",[],function(){return'<div><div class="od-PeopleCard-expandedHeader ms-font-m-plus" data-bind="text: strings.orgTitle"></div><ol class=od-PeopleCard-resetList>\x3c!--ko if: !managerChain().failed && !directReports().failed--\x3e\x3c!--ko if: managerChain() && managerChain().managers && managerChain().managers.length > 0--\x3e<li class=od-PeopleCard-orgChartSection data-bind="foreach: managers"><a class=od-PeopleCard-orgChartUserLink href=# target=_blank rel="noopener noreferrer" data-bind="click: $component.onManagerClick.bind($component, $data)"><div class=od-PeopleCard-orgChartUserRow><div class=od-PeopleCard-orgChartUser><div class=od-PeopleCard-orgChartUserPhotoWrapper>\x3c!--ko if: name--\x3e\x3c!--ko component: {\r\n name: $component.personaImageTagName,\r\n params: { person: $data, iconType: "Contact"}\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class=od-PeopleCard-orgChartUserData><span class="od-PeopleCard-orgChartUserName ms-font-m ms-fontWeight-semiBold od-PeopleCard-nowrap" data-bind="text: name"></span> <span class="od-PeopleCard-orgChartUserTitle ms-font-s od-PeopleCard-nowrap" data-bind="text: job"></span></div></div></div></a></li>\x3c!--/ko--\x3e<li class=od-PeopleCard-orgChartSection><a class=od-PeopleCard-orgChartUserLink href=# target=_blank rel="noopener noreferrer" data-bind="click: $component.onSelfClick.bind($component)"><div class=od-PeopleCard-orgChartUserRow><div class=od-PeopleCard-orgChartUser><div class=od-PeopleCard-orgChartUserPhotoWrapper>\x3c!--ko if: personInFocus().person.name--\x3e\x3c!--ko component: {\r\n name: $component.personaImageTagName,\r\n params: { person: personInFocus().person, iconType: "Contact"}\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class=od-PeopleCard-orgChartUserData><span class="od-PeopleCard-orgChartUserName ms-font-m ms-fontWeight-semiBold od-PeopleCard-nowrap" data-bind="text: personInFocus().person.name"></span> <span class="od-PeopleCard-orgChartUserTitle ms-font-s od-PeopleCard-nowrap" data-bind="text: personInFocus().person.job"></span></div></div></div></a></li>\x3c!--ko if: directReports() && directReports().directs && directReports().directs.length > 0--\x3e<li class=od-PeopleCard-orgChartSection><span class="od-PeopleCard-orgChartDirectsTitle ms-font-s ms-fontWeight-semiBold" data-bind="text: staffLabel()"></span>\x3c!--ko foreach: directs--\x3e<a class=od-PeopleCard-orgChartUserLink href=# target=_blank rel="noopener noreferrer" data-bind="click: $component.onDirectClick.bind($component, $data)"><div class=od-PeopleCard-orgChartUserRowNoOffset><div class=od-PeopleCard-orgChartUser><div class=od-PeopleCard-orgChartUserPhotoWrapper>\x3c!--ko if: name--\x3e\x3c!--ko component: {\r\n name: $component.personaImageTagName,\r\n params: { person: $data, iconType: "Contact"}\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class=od-PeopleCard-orgChartUserData><span class="od-PeopleCard-orgChartUserName ms-font-m ms-fontWeight-semiBold od-PeopleCard-nowrap" data-bind="text: name"></span> <span class="od-PeopleCard-orgChartUserTitle ms-font-s od-PeopleCard-nowrap" data-bind="text: job"></span></div></div></div></a>\x3c!--/ko--\x3e</li>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: managerChain().failed || directReports().failed--\x3e<div class="od-PeopleCard-orgChartError od-PeopleCard-errorPanel"><span class="od-PeopleCard-errorHeader ms-font-m-plus" data-bind="text: strings.errorHeader"></span> <span class="od-PeopleCard-errorSubHeader ms-font-s" data-bind="text: strings.errorMessage"></span> <a href=javascript:; class="od-PeopleCard-errorRetry ms-fontColor-themeSecondary" data-bind="text: strings.errorRetryButton, click: $component.onRetryClick"></a></div>\x3c!--/ko--\x3e</ol></div>'});define("RD",["c","az"],function(e,t){e.loadStyles([{rawString:".od-PeopleCard-orgChartSection{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:" 2px;border-radius:0 0 0 10px;padding-bottom:24px;position:relative}html[dir=ltr] .od-PeopleCard-orgChartSection{border-left:solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:" 2px}html[dir=rtl] .od-PeopleCard-orgChartSection{border-right:solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:" 2px}[dir=ltr] .od-PeopleCard-orgChartSection{margin-left:24px}[dir=rtl] .od-PeopleCard-orgChartSection{margin-right:24px}.od-PeopleCard-orgChartSection:nth-child(2){border-bottom:0;margin-top:-24px}[dir=ltr] .od-PeopleCard-orgChartSection:nth-child(2){margin-left:64px}[dir=rtl] .od-PeopleCard-orgChartSection:nth-child(2){margin-right:64px}.od-PeopleCard-orgChartSection:nth-child(3){margin-top:-16px}[dir=ltr] .od-PeopleCard-orgChartSection:nth-child(3){margin-left:64px}[dir=rtl] .od-PeopleCard-orgChartSection:nth-child(3){margin-right:64px}.od-PeopleCard-orgChartSection:last-child{border-bottom:none;padding-bottom:0}html[dir=ltr] .od-PeopleCard-orgChartSection:last-child{border-left:solid transparent 0}html[dir=rtl] .od-PeopleCard-orgChartSection:last-child{border-right:solid transparent 0}[dir=ltr] .od-PeopleCard-orgChartUserRow{margin-left:-24px}[dir=rtl] .od-PeopleCard-orgChartUserRow{margin-right:-24px}[dir=ltr] .od-PeopleCard-orgChartUserRowNoOffset{margin-left:0}[dir=rtl] .od-PeopleCard-orgChartUserRowNoOffset{margin-right:0}.od-PeopleCard-orgChartUser{position:relative;height:44px;background:0 0;cursor:pointer;padding:4px;top:-4px;white-space:nowrap}.od-PeopleCard-orgChartUserPhotoWrapper{width:40px;height:40px;border:2px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:50%;line-height:40px;margin-top:-24px;overflow:hidden;padding:2px;position:absolute;top:50%;perspective:1px}[dir=ltr] .od-PeopleCard-orgChartUserPhotoWrapper{left:0}[dir=rtl] .od-PeopleCard-orgChartUserPhotoWrapper{right:0}.od-PeopleCard-orgChartUserData{padding:4px}[dir=ltr] .od-PeopleCard-orgChartUserData{padding-left:56px}[dir=rtl] .od-PeopleCard-orgChartUserData{padding-right:56px}.od-PeopleCard-orgChartUserName{display:block;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-PeopleCard-orgChartUserTitle{display:block;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-PeopleCard-orgChartDirectsTitle{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";display:inline-block;margin-bottom:8px;padding:4px 8px}html[dir=ltr] .od-PeopleCard-orgChartDirectsTitle{border-left:solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:" 2px}html[dir=rtl] .od-PeopleCard-orgChartDirectsTitle{border-right:solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:" 2px}.od-PeopleCard-orgChartUserPhotoWrapper .od-Persona-image{display:block;width:40px;height:40px}.od-PeopleCard-orgChartError.od-PeopleCard-errorPanel{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKwAAACsCAYAAADmMUfYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABHpJREFUeNrs3T1PG2cAwPGzfX6JZGgckYTCEBRVyhgEiryyRNmq7l0y9hu0W+jWsR8hX6Dq2q0sHU5icL9AyAKqSCpoiGLHvtz1Ma065cWUw9jH7ydZ9mD5uOf5Yx5A97iS53kE86JqCBAsCBYEi2BBsHAqvmonnCTJ43C3VpLTed7tdp8KtsTq9fp2u92+M+/nkaZp9ObNm9/DQ8GWXafTmftz6Pf742CtYUGwIFgEC4IFwSJYmH2xIXi/4XAYvXv37lKOXa/Xozg2NYI9gxcvXrwOwf5Wq9X+mOZxwzGXFxYWHpXhnxuCna40+GFzc3NnmgdNkmQr3D0y/NawCBYEC4JFsCBYECyCBcGCYBEsCBYEi2BBsCBYBAuCBcEiWBAsCBbBgmBBsAgWBAuCpdxsBvcBlUqlFe5+TZLEYAh29q2srLSMgiUBCBbBgmBBsAgWBAuC5aq5cv84yPN8sL+/f1zkGN68ebPdaDQ++qSTk5Po1atX/x03y7J4NBq1z/VuU62mV23+KmECfduew+7ubu/WrVv3r1279tHnHR0djW/fd7vdbaNmSYBgQbAgWAQLggXBIlgQLAgWwYJgQbAIFgQLgkWwIFgo0qVc05UkyVq9Xv+uWq1e+oZraZp+Ee7+97VVWZbdm/S5tVrtq16vtzbv0YRzHmxsbHxzZYINxpP29Y0bN9pl+K5vNpuffM7CwkLUarXuh4f35/18X758+TrcXalgT6/4/NSFe6X6URbHp7dSrCMv8Wpda1j80gWCBcEiWBAsCJY5NPN/GBxvosb0dDodwZ7HX0GWZT9KaSqeCPacarXa8YMHD7a1dPGSJHliDQuCRbAgWBAsggXBgmARLAgWBItgDQGCBcGCYBEsCBZOTXTFwXi3weifDdyKsj7pE7Msa4XjbxV50t1ud2feJy6MyfWzjOMFHH+r4JfshXk5LiTY4HGtVvs2juNBUV9ds9mcaCe4er3+WTjuz0Ud9+3bt+OJrpTgzWa9Uqn80mg0+kW9YHi98fy2Jpy7wuZkOBy28zx/GB7uFBVstLi42Op0OlPfz3VlZaU1ySBO6tmzZ6X58TiOdXV19fq0j7u0tDTeX7RZ1OsdHBxEg8Fk74XWsPilCwQLgkWwIFgQLIKFi1XoZnD9fj86PDx8Xa1W/5z2iYxGozt37941o++xt7eXxnG8P+3jpmn6+fLycqPIj7cqfPfCMDA/ra+vP5724CRJkkvzg3Oyv7GxsTbt4+7u7vaigj9Iz5IAa1gQLAgWwYJgQbAIFgQLgkWwIFgQLIIFwYJgESwIFgSLYEGwIFgEC4IFwSJYECwIlrIofDO40Wj05b+bgDEjxrsIXsacZFl2b6aDbTab0e3btzvhYUcms2O85WVU8C6CZ2liZoOtVqtRkXuBUowyzYk1LIIFwYJgESwIFgTLHJr477AnJyenn8PF7BgOh+2Dg4MynEfhwT5N03Qn3FQyO3p5nj8cDAalOZ9JnlQJJ23qsYYFwSJYQ4BgQbAgWAQLggXBIli4UH8LMADdAf2REtv+JwAAAABJRU5ErkJggg==)}.od-PeopleCard-orgChartUserLink{-webkit-display:flex;display:-ms-flexbox;display:flex}.od-PeopleCard-orgChartUserLink:focus,.od-PeopleCard-orgChartUserLink:hover{background:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}"}])});define("Rx",["require","exports","RA","b5","Rz","Ry"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-peoplecard-expandeddocuments",template:e("Rz"),viewModel:i.default,synchronous:!0});t.default=o});define("RA",["require","exports","ap","aq","bF","RB","df","dq","hs","cE","aN","Rd","V","nU","LY"],function(e,t,i,r,o,n,a,s,l,d,c,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=48,g=16,y=13,v=32,_=9,b=function(e){i.__extends(t,e);function t(t){var i=e.call(this,t)||this;i.fileTypeIconTagName=a.default.tagName;i._engagement=i.resources.consume(d.resourceKey);i.strings=n.strings;i.documentSet=t.documentSet;i.isDocumentsDataReady=t.isDocumentsDataReady;i.isMeCard=t.isMeCard;i.personName=t.personName;i.isContextTypeSelectorHidden=r.observable(!0);i.secondaryActionsAbove=r.observable(!1);i.docPreviewZoomDown=r.observable(!1);i.contextTypeItems=r.observableArray([]);i.contextTypeItems(t.availableContextTypes.map(function(e){return{scenarioContextType:e,contextTypeText:i._getContextText(e),isSelected:e===t.scenarioContextType()}}));i._scenarioContextType=t.scenarioContextType;i._changeContextTypeCallback=t.changeContextTypeCallback;i.secondaryActionsIndex=r.observable(-1);i.iconSizeLarge=f;i.iconSizeSmall=g;i.contextText=i.createPureComputed(function(){return i._getContextText(t.scenarioContextType())});i.titleText=i.createPureComputed(function(){return i.strings.expandedDocsTitle+" "+i.contextText()});i.noDocumentsText=i.createPureComputed(function(){return i._scenarioContextType()===u.default.Generic?i.isMeCard()?i.strings.noDocsDescriptionYou:p.format(i.strings.noDocsDescription,i.personName):i._scenarioContextType()===u.default.Group?i.isMeCard()?i.strings.noDocsDescriptionGroupYou:p.format(i.strings.noDocsDescriptionGroup,i.personName):i.isMeCard()?i.strings.noDocsDescriptionSiteYou:p.format(i.strings.noDocsDescriptionSite,i.personName)});return i}t.prototype.onDocumentClick=function(e){this._engagement.logData({name:"DocumentExpandedDoc.PeopleCard.Click",isIntentional:!0});m.openNewTab(e.redirectAddress)};t.prototype.getTimestamp=function(e){return l.getRelativeDateTimeStringPast(l.iso8601DateTimeToJsDate(e))};t.prototype.getIconName=function(e){return s.getIconNameFromExtension(e||"")};t.prototype.toggleContextTypeSelectorVisibility=function(){this.isContextTypeSelectorHidden(!this.isContextTypeSelectorHidden())};t.prototype.changeScenarioContextType=function(e){this._changeContextTypeCallback(e);this.isContextTypeSelectorHidden(!0);this.secondaryActionsIndex(-1)};t.prototype.onRetryClick=function(){this._changeContextTypeCallback(this._scenarioContextType());this._engagement.logData({name:"DocumentExpandedRetry.PeopleCard.Click",isIntentional:!0})};t.prototype.onSecondaryActionsClick=function(e,t,i){this.secondaryActionsIndex()===e()?this.secondaryActionsIndex(-1):this.secondaryActionsIndex(e());var r=i.currentTarget,o=r.getBoundingClientRect().bottom,n=r.offsetParent.offsetParent.getBoundingClientRect().bottom;this.secondaryActionsAbove(n-o<170)};t.prototype.onPreviewImageHover=function(e,t){var i=t.currentTarget.offsetParent,r=i.getBoundingClientRect().top,o=i.offsetParent.offsetParent.getBoundingClientRect().top;this.docPreviewZoomDown(r-o<120)};t.prototype.onCopyLinkClick=function(e,t){this._engagement.logData({name:"DocumentExpandedCopyLink.PeopleCard.Click",isIntentional:!0});prompt(this.strings.copyLinkText,e.redirectAddress)};t.prototype.onShareByEmailClick=function(e,t){this._engagement.logData({name:"DocumentExpandedShareByEmail.PeopleCard.Click",isIntentional:!0});window.location.assign(this.getEmailSharingLink(e))};t.prototype.onDownloadClick=function(e,t){this._engagement.logData({name:"DocumentExpandedDownload.PeopleCard.Click",isIntentional:!0});m.openNewTab(e.path)};t.prototype.onGoToLocationClick=function(e,t){this._engagement.logData({name:"DocumentExpandedGoToLocation.PeopleCard.Click",isIntentional:!0});m.openNewTab(e.sitePath)};t.prototype.previewLoadHandler=function(e,t){var i=t.target.parentElement;i.style.visibility="visible";i.style.opacity="1"};t.prototype.getEmailSharingLink=function(e){return"mailto:?subject="+p.format(this.strings.shareByEmailSubject,encodeURIComponent(e.title))+"&body="+(this.strings.shareByEmailFirstLine+"%0D%0A%0D%0A"+p.format(this.strings.shareByEmailSecondLine,e.title)+"%0D%0A"+encodeURI(encodeURI(e.path)))};t.prototype.onContextSelectorItemKeyPress=function(e,t,i){i.keyCode!==y&&i.keyCode!==v||this.changeScenarioContextType(e);if(i.keyCode===_){if(i.shiftKey)return!0;if(e===this.contextTypeItems()[this.contextTypeItems().length-1].scenarioContextType){var r=document.getElementsByClassName("od-PeopleCard-documentsContext")[0];if(r){r.focus();return!1}}}return!0};t.prototype.getFileTypeFromExtension=function(e){return h.getShortcutFileTypeFromExtension(e)};t.prototype._getContextText=function(e){switch(e){case u.default.Generic:return this.strings.expandedDocsO365;case u.default.TeamSite:return this.strings.expandedDocsTeamSite;case u.default.Group:return this.strings.expandedDocsGroup;case u.default.OneDriveForBusiness:return this.strings.expandedDocsSite;default:c.default.log("Unknown PeopleCard scenarioContextType:"+e)}};return t}(o.default);t.default=b});define("Rz",[],function(){return'<div><div class="od-PeopleCard-expandedHeader od-PeopleCard-nowrap ms-font-m-plus" data-bind="attr: {title: titleText()}"><span data-bind="text: strings.expandedDocsTitle"></span> <button class="od-PeopleCard-documentsContext ms-font-m-plus" data-bind="click: $component.toggleContextTypeSelectorVisibility"><span data-bind="text: contextText()"></span> <span class="ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></span></button><div class="od-PeopleCard-documentsContextSelector ms-font-m-plus" data-bind="css: { \'od-PeopleCard-documentsContextSelectorHidden\': isContextTypeSelectorHidden() }"><ul data-bind="foreach: contextTypeItems"><li class="od-PeopleCard-documentsContextSelectorItem od-PeopleCard-nowrap ms-font-m-plus" tabindex=0 role=option data-bind="css: { \'od-PeopleCard-documentsContextSelectorItemSelected\': isSelected }, attr: { title: contextTypeText, \'aria-selected\': isSelected }, click: $component.changeScenarioContextType.bind($component, scenarioContextType), event: { keydown: $component.onContextSelectorItemKeyPress.bind($component, scenarioContextType) }">\x3c!--ko if: isSelected--\x3e<span class="ms-Icon ms-Icon--CheckMark od-PeopleCard-documentsContextSelectorCheck" data-bind="icon: true"></span>\x3c!--/ko--\x3e<span data-bind="text: contextTypeText"></span></li></ul></div></div>\x3c!--ko if: !documentSet.failed--\x3e\x3c!--ko if: documentSet && documentSet.documents.length === 0 && isDocumentsDataReady()--\x3e<p class=ms-font-s data-bind="text: noDocumentsText()"></p>\x3c!--/ko--\x3e<ol class=od-PeopleCard-resetList data-bind="foreach: documentSet.documents"><li class=od-PeopleCard-docFeedItem data-bind="css: { \'od-PeopleCard-docFeedItemSelected\': $index() === $component.secondaryActionsIndex() }"><a class=od-PeopleCard-docFeedLink data-bind="attr: {href: \'#\', target: \'_blank\', rel: \'noopener noreferrer\'}, click: $component.onDocumentClick.bind($component)"><div class=od-PeopleCard-docPreview><div class=od-PeopleCard-docPreviewImageWrapper data-bind="css: { \'od-PeopleCard-docPreviewImageWrapperZoomDown\': $component.docPreviewZoomDown() }, event: { mouseover: $component.onPreviewImageHover.bind($component) }"><img class=od-PeopleCard-docPreviewImage data-bind="attr: { src: previewImageUrl, alt: title }, event: { load: $component.previewLoadHandler }"><div class=od-PeopleCard-docPreviewIconSmall>\x3c!--ko component: {\r\n name: $component.fileTypeIconTagName,\r\n params: { iconName: $component.getIconName(fileExtension),\r\n iconUrl: \'\',\r\n desiredSize: $component.iconSizeSmall,\r\n iconFieldAriaLabel: $component.getFileTypeFromExtension(fileExtension) }\r\n }--\x3e\x3c!--/ko--\x3e</div></div><div class=od-PeopleCard-docPreviewIcon>\x3c!--ko component: {\r\n name: $component.fileTypeIconTagName,\r\n params: { iconName: $component.getIconName(fileExtension),\r\n iconUrl: \'\',\r\n desiredSize: $component.iconSizeLarge,\r\n iconFieldAriaLabel: $component.getFileTypeFromExtension(fileExtension) }\r\n }--\x3e\x3c!--/ko--\x3e</div></div><div class=od-PeopleCard-docPreviewDetails><span class="ms-font-m ms-fontWeight-semibold od-PeopleCard-docPreviewTitle" data-bind="text: title"></span> <span class="ms-font-s od-PeopleCard-nowrap od-PeopleCard-docPreviewTimestamp" data-bind="text: $component.getTimestamp(lastModified)"></span><div><button class=od-PeopleCard-documentSecondaryActionsButton data-bind="click: $component.onSecondaryActionsClick.bind($component, $index), clickBubble: false, attr: {\'aria-label\': $component.strings.secondaryActionsLabel}"><span class="ms-Icon ms-Icon--More" data-bind="icon: true"></span></button>\x3c!--ko if: $index() === $component.secondaryActionsIndex()--\x3e<div class="od-PeopleCard-documentSecondaryActionsPane ms-font-m od-PeopleCard-nowrap" data-bind="css: { \'od-PeopleCard-documentSecondaryActionsPaneAbove\': $component.secondaryActionsAbove(), \'od-PeopleCard-documentSecondaryActionsPaneBelow\': !$component.secondaryActionsAbove() }"><ul class=od-PeopleCard-resetList><li tabindex=0 class="od-PeopleCard-documentSecondaryAction od-PeopleCard-nowrap" data-bind="text: $component.strings.actionCopyLink, attr: { title: $component.strings.actionCopyLink }, click: $component.onCopyLinkClick.bind($component), clickBubble: false"></li><li tabindex=0 class="od-PeopleCard-documentSecondaryAction od-PeopleCard-nowrap" data-bind="text: $component.strings.actionShareByEmail, attr: { title: $component.strings.actionShareByEmail }, click: $component.onShareByEmailClick.bind($component), clickBubble: false"></li><hr><li tabindex=0 class="od-PeopleCard-documentSecondaryAction od-PeopleCard-nowrap" data-bind="text: $component.strings.actionDownload, attr: { title: $component.strings.actionDownload }, click: $component.onDownloadClick.bind($component), clickBubble: false"></li><hr><li tabindex=0 class="od-PeopleCard-documentSecondaryAction od-PeopleCard-nowrap" data-bind="text: $component.strings.actionGoToLocation, attr: { title: $component.strings.actionGoToLocation }, click: $component.onGoToLocationClick.bind($component), clickBubble: false"></li></ul></div>\x3c!--/ko--\x3e</div></div></a></li></ol>\x3c!--/ko--\x3e\x3c!--ko if: documentSet.failed--\x3e<div class="od-PeopleCard-expandedDocumentsError od-PeopleCard-errorPanel"><span class="od-PeopleCard-errorHeader ms-font-m-plus" data-bind="text: strings.errorHeader"></span> <span class="od-PeopleCard-errorSubHeader ms-font-s" data-bind="text: strings.errorMessage"></span> <a href=javascript:; class="od-PeopleCard-errorRetry ms-fontColor-themeSecondary" data-bind="text: strings.errorRetryButton, click: onRetryClick"></a></div>\x3c!--/ko--\x3e</div>'});define("Ry",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-PeopleCard-resetList{list-style:none;margin:0;padding:0}.od-PeopleCard-nowrap{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-PeopleCard-personToggles{margin-top:30px;text-align:center}.od-PeopleCard-personToggles .od-PeopleCard-personControl{width:42px;height:42px}.od-PeopleCard-errorPanel{min-height:150px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKoAAACsCAYAAADrLzefAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAdHElEQVR4Xu2dCbR2VVnHZQYZRAEtFBxSNAcyxQTXCgKHcgDUlCVoLi1bKVAROSAisXAOSRJMBTXCgaEVmilOWWYyz3xMH4NBmZCh5jwg3P6/fZ/3ruee73nfs8873fOes/9r/Rf6fHfvfZ69/+8enr3PPvdZWloqLGw9Q2NhYdsYGgsL28bQWFjYNobGwsK2MTYWjI0LLrhgI/G+9n8LxkCoydBYsAKJbnNxd/Eg8UjxXeLHxH8WbxBvE78r/p+4VOHPROx3ivzdJeKnxQ+IfyH+kfhM8cFWXIEQajI09hQSzP3EZ4vHi+eKN4q/EKsCnAUR9PniaeJhIj+Oje3ReoVQk6GxJ5AQthdfJL5XvFK8R9xARBdddNHSZZddtnTllVcuXX311Uvr1q1buv7665duvPHGpfXr1y/ddNNNSzfffPPSLbfcknjrrbeu/G/+DfJ3N9xww9J11123dM011yxdddVVS1dcccXSJZdcsnThhRduUKbxO+JnxDeITxF7IdxQk6Gxw1Bj7yoeLjJ03y2uEgfCQZDXXnttEhYCRHizJmJG/Ij48ssvTz+O6rOJ3xQ/KNLrb2EudQ6hJkNjx6BG3Ulkfnm5uKrxESa9GyKZlyhzSS/MD4aeNxDuD8Qzxd8WO9XThpoMjR2AGm9TcX+RueaqnpNhnOGbXiwSSFtJD8+P6uKLL/aChf8lvkX8FXN/oRFqMjQuMNRYzDuPFhkmVxrz0ksvTb3TYA656KS3RbRBT/sF8ZlWHQuJUJOhcQGhxmHu+R7xh2JqNBqRxc+i9ZxNybSFee3Ab+NV4kvFTa2KFgahJkPjAkEN8UjxdHEljETvyeo6atQukx8kvWwlivCf4qvFzazKWo9Qk6FxAaCKf5D4fnFl/kmvwjwuasQ+kekN0YPKtOAW8RBxI6vC1iLUZGhsMVTRW4pvEln1pkZgccScLWq0aZPIAGUx3DLnRRBML+jJCGt5YoOD2Cu9PLFXer55zJUpg3IrgmV37GlWna1EqMnQ2FKogp8j3moVnob4WfWgNDJ509CIjrJGBObHIqt3RgGEjIhn9WMb9LCV5/+I+ECr2lYh1GRobBmoUPEcq+DUwNOeg9KY9JL0gIhyUFZA9u/Zt79Q5JlOEd8qHif+uXiE+Br7L9EH7O8WEcbnxWvEb4lR3qn3Q7z8QKYtXEYDfnSuvG+Lr7Bqbg1CTYbGFkEVebBVaKpchDStYZOGY/hm6jCkt7xOPEM8Snyu+DBxKnM85bONyLboK8W/EgkrfU9c9Qz8KPF5miMH0w82Olw5XxRbczAm1GRobAFUcQ8Qz7KKTL0cFRxVfBMi8oE4B3k7Xi2eJP6uuJM9ytygMjcRnyzSG39KXCVceltEO416gJXpACfADrZHWVOEmgyNawxV2F4iYZVUiVRoVNFNSOMy7FV6Tg6hfFVke/XhVnxroGfiiCFbpBwLXLWBQY/I9GDSbV8WdpWpDlOUre0R1gShJkPjGkKVhGhSyInGmHSexrwzmHMypDOffJAV23roWTcW9xb/TvyRmHzhh0cvO+mmBp3BIE+R+nm0FT13hJoMjWsAVczW4spQz0GMSeaiDO+VedhPRM567mlFLizkw7biq8RVh2yos0l+2Iw6LpRF+O8AK3KuCDUZGucMVcjO4hVWQUlkUUXmkB60ItC7RA5Cz33OOQ/Ir/3E88QVn5nijNvDMpWozN+PsqLmhlCToXGOUEU8UfxvKoVf87gLBdJVhnhe//hTcU3nW/OC/HyCeLaY/GdKQHx23FGJ6cQgL5F569y2YENNhsY5Qc7vK36fyqAXHKcXCGKDHEo5VtzGiukV5DdRAw6Fp/rgxz9uzJmRbZCP+DlxLi8thpoMjXOAnD5A/DmVwFAzzi+fBnBzqntF9v5budsyb6geeGnwejHVD5sI43QExG9dpOQi8X5WxMwQajI0zhhyluNnSaTjLJroRSvH2oh/LvwiadpQnRDeOkb8qZgEN878v7LIYgE30/l+qMnQOEPISUSaXqJjyI4qZhT5hbtK+7H4WnHhzlzOE6ofjkJ+WUz1RufQNP5KNMHV+zpxR8t+6gg1GRpnBDnHcD+2SCsTfHrRx1rWBTVQXXExxp+JnFVIW7NNF65MHZxYLxZnMg0INRkaZwA59QwxDfdNRRqETDjJ39m3MGcJ1duvi1yckeqy6VSgIlZ29aa+wAo1GRqnDDnDSjSdH2XYiSpgGBly3Mts7H3vb9kWjAnV4X3Fj1udppEqqvthpE3cAoszCZtY1lNBqMnQOEXICd5lugOnmq7uCd67CrlZfIxlWzAFqD652CJNxZq2DdMG1zYnW5ZTQajJ0DglyAGOsnH+MsVJm1REJYb3JfH+lm3BFKF6fZ64EstussiiIyGd8XDLcmKEmgyNU4AenMk779SnOU2TCqiI9KPiVIeWgtVQ/XLPVTrMzTSrSbyVE1ykE3m5cl/LciKEmgyNU4Aemvea0vDQZHVZOcVzstj6l9G6ANUzIazbqfemYnU7g/8r7mpZjo1Qk6FxQuhh9xHT3KfJqrLSk77FsiuYE1TnDxG5wbCRWJnSuXMWvKIz0bmAUJOhcQLoIbnnKR3ybRKGqoj0WMuuYM5Q3dN+vFqdxJo7ZauErU6w7MZCqMnQOAH0kFxU22jxVJmUv8uyKlgjqA3oWb9Oe9BTjtGOnLvYz7JrjFCToXFM6OE4zJvmpbkHeCsxuQ+LZU7aAqgdmLMy50znKqK2i+h2D7m4bXvLrhFCTYbGMaCH2kVMQX1WgpETVTKsuGA+b0KW1X2LoPZ4qpgOtHC2NWrDKul93cH1D1tWjRBqMjSOAT3UZ3k4horIgSpxyG2LrhfH+vUVzBZqFw4RpXbKPddKlGeQRmx8s2CoydDYEHqYFw8eLHfId0MEr+mu2YtkBfVQ+7yTtmoypXMhK2622dKyykKoydDYAHoIXjT7Bg+VOzxUFk+/Y1kVtBRqI96A5YR/9iKZv3FRgOMsqyyEmgyNDaCHeAcPw1wzxwHmpc6BEy2bgpZDbcW1SryHln2IhamCtTNvAD/UsqpFqMnQmAkVzhU3abJNLxk9bJVuXspbp5tbVgULALXXs6ztxmnvMy2bWoSaDI2ZUOGf4CF4mOghq3RBfV7A282yWVjIh8FlaLnswp0CXPiWPYJWFlZPsWxGItRkaMyACuX1XAK7WXv5lSH/SMtmoSE/oq/1jWKjuVobIR+4n5Yjl9lTAM4gm/9ftGxGItRkaMyACuXAbPZBaPewvBzWiXip/EhCZYVLow2j2wdfeKEC+fF08yerk2J7dfD34j6WzVCEmgyNNVBhvyqm3jTn4AIv5NlDchTsyZbNwkO+JKHWDYFEQ8z/TggVyBe+m5AdN+cHa3VwnmUxFKEmQ2MNVBhbndm9qetR3mtZdALyp89C3XHgf85GQKVXfYJlEyLUZGgcARXCPVHpJb2cbt+FKHBqZq/YrgXMp14KFcif1+FX7sLKTf8+almECDUZGkdAhfwlheWs9Hl4t5f/JsuiM5BPfRfqVmK6xzbnfAe7WlYPd4tDD1iHmgyNQ6DMWfGlxsmJo7lwFJegbWXZdAaDuuirUIF8egW+EdHJ6VVdXPXtlsUGCDUZGodAmacDCvSS0UNU6XrTQy2LTkF+FaEub69yqCirV3Xb5xyuD6M/oSZD4xAo43QtTM5V5W5uypnGzvWmQH71XqhAfv0h/uV2YC6e/jzLYhVCTYbGAMr0EWIKSeW8nuBW+m+2LDoH+ZaEyooWsQ5jD4S6hZjubsiJALj6ONeyWIVQk6ExgDLlM9tZp73dthlbpTtYFp2DfEtCbcBOChXItzfiY05ctbKo2uCa0FCToTGAMkzbZjm/GHcW8VRL3knIvyJUg3zjc0vpAracM6tuxH2NZbGCUJOhsQJl9jgy5eAsQ1lU8ID8u3sHKusQQkE3oPY+k3ZnFyrShqe7uOILlnwFoSZDYwXKLF0mkTPsu5DUOkte0BOozbmxMStU5Xaq2DxadX1lqMnQWIEyupRMEWFUqKfr0o+w5AU9gdqcUNV/0P45U0T3EuAhlkVCqMnQ6KBMeMc7ZVi32uff7W+5JaXcpd9DqN35gHHWORC3+j/HkieEmgyNDsrkD8gsZ8vUDfv/bskLega1PXfhZq1nXHToO+JK8D/UZGh0UAbpwlfUHxXm6bbHOnEwuqA51Pbc4pj2/3O+iO0W3ntYFrEmQ6ODMkiB3LpC+fVYgbB1H8AtmB/U/u9FBzl3j7mv27zWkseaDI0GJeblvZRRXTfu9nCvteQFPYU0kFb/OVuq7prRlV2qUJOh0aDEB5NJzm6DO8F9iiXvPOQr0yJeycnlSyxppyE/+UZAOrNc9waIm6feYcljTYZGgxKfQCY5AVwXlnqRJe885GvZmRoC+Qpqw1SVKePOpA01GRoNSpi+WlwXP60UtjDfwJ8U8jUJlV0W6mgY3TysT0JN1wDlzFNdPDXdUxVqMjQalDCt3upeOXEv7623pL2A/E1CrZu/d/30VAT5+mx8RoRRnXi6V1TSJlGoydC4XNB2lri2Idy+7dkpcU8gf4tQh0C+Pth8DuvE0y2oTiNtqMnQuFzQniTOWbm501K9utJc/hahjoD8JZBfe5rKRYzOJ12oydC4XMjLSZxzEMUtpJ6fEvcE8rcIdQTkL5+grF1QufOp3yJdqMnQuFwIX3XLmgy73YVHpcQ9gfwtQh0B+fs+/Mb/qF4GpP6sfuDmoSZD43IhJzUshNdUevU5cvlbhDoC8pdP1Dft7HYNNRkalws5m4SEV6KMB3Td9p0pYY8gn4tQR0D+pg2jnANN7o3lPUNNhsblQr5Gwrr3911o6vKUsEeQz0WoIyB/98bvnBCVO9D0wlCToXG5kPSOVF0MlYmyFfCZlLBHkM9FqCMgf3fDb078R/Xi6WKph4aaDI3LhaRgf11owcVQx/pUyyJDPhehjoD83d78DuvF04U4jwg1GRqXC0mNUHeowDXCSSlhjzCooyLU4TC/a+vIHWo6NtRkaFwuIH3crO71E9cIE33/chEhn4tQayCf06UlDYR6XKjJ0LhcQErYpICUsEeQz0WoNRjUUZOROdRkZNQfb2qJmgj1jfZsvYF8LkKtgXy+C9/rhOr2+xsJlddeU8IGQu3c/ad1kM9FqDWQz2m/fyZCtQJSwgZCLUP/EJahv9HQf2KoydC4XMD3SNhgMdW7r/DJ5yLUGpjfjTq8UJOhcbmArF+C77JTwh5hUEdFqDHkL69OJ98bCPWYUJOhcbmQ20jYIOB/ekrYI8jnItQRkL/c8Jd8j+rFc5KAf7ruusEW6udSwh5BPhehjoD8fQx+N9xCfXWoydC4XMhXSNjgUMo1KWGPIJ+LUEdA/u6H3zmHUtzh+wNCTYbG5ULSXZcM7VHGA1ZPZ/cJ8rkIdQTk7yH43fCY32+EmgyNy4WkrwhTyVHGA9JIVgDs1WfN5W8R6gjI39fjd8OD0zuHmgyNy4Vkn852X7l4XErcE8jfItQRkL+n4jeRoaheBnSdXXpLJNRkaFwuJPt0tjv0elBK3BPI3yLUEZC/5+N33TrHTR/TtT6hJkPjciFPInHOis3FwI5PiXsC+VuEOgLyN20a1cXiXeToK6QLNRkalwvhoqusI1q8V2UFfTIl7gnkbxHqEMjXXfGZuWdUJ56uft5H2lCTodGghLeQQV0s1d3Idrsl7QXkbxHqEMjX/fE55yZIdzfXYaQNNRkaDUrIVYm1b6LSUG7V9jBL3nnI1yLUIZCvKWrEtDCqE093SdpvkTbUZGg0KOHbyCBn5e8Cti+z5J2HfC1CHQL5ehk+N7x28gGkDTUZGg1K+EIyyNlZcI3xIUveecjXItQA8pML9vgyTu3pO7ezeZsljzUZGg1K/MuWSZMCb7XknYd8LUINID+fi78NO7gzLXmsydDooAzSB67qYmE0lpunPt6Sdxryswg1gPz8IP7mzE9dDP5wSx5rMjQ6KIMPkRGVHRXk6VZvnf30uYf8LEKtQD7yGtP/4C+jbFQfAw7r3EJNhkYHZZAOFuSEGVzgthfX+8jPItQK5ONv4mvORpELa666tyzUZGh0UCY7iFkTY/7dCoYPtSw6C/lYhFqBfDwRX3MiRW5H828teUKoydBYgTJKZ1PrjvxBN+fo/PAvH4tQHeTfZuKd+Fq3poHuaN+BlkVCqMnQWIEyOoIMcw6ouOGfRdjGlkUnIf+KUB3k34H4mTPsu4MoPxa3siwSQk2GxgqUUfYX/Ph3d+zv6ZZFJyH/ilAd5N8/4Sf+RvXg6V4K3eB8SKjJ0BhAGV5FxnXbqdDNPVZiY12E/CtCNcg3voLyC/ysOy0F3bbpyy2LFYSaDI0BlOHryDhn+Hfd+t3iLpZF5yDfilAN8u0d+JijD7faZ9jfzrJYQajJ0BhAGf6SiPCyfjFuUdXZiynkWxGqIL+2FdPZ05xFlHs1+gzLYhVCTYbGIVDG/0gBOXMQt6X6I3F7y6JTkF9FqIL8SqNtzpYpdeWC/PtYFqsQajI0DoEyPoACclZ10J2oOtqy6BTkV++FKp+2EL+Jf3UnpaCLCnHWeSPLZhVCTYbGIVDGXEd5BwU1fCiGhXSEq0uQT0WoF1xwJL7lfOERus5r6DWloSZD4wiogKMpKGdLFbrVXefmqvKp10KVP9zRn66VzOm4KtPBHS2bDRBqMjSOgArg4X5IgXWHDqB7uJ+JndpWlT99F+q78CtnbgrdoaWTLYsQoSZDYw1UUNrPzQlFQBcB+IRl0QnIn94KVb6wCfRT/MrpsFzIkljryNeVQk2GxhqooF3En1Nw3Yt/0D0kfKZls/CQL30W6nn4lNtZuUvQajurUJOhMQMq8PQmD+p2q74urtrbXVTIjyRUhrRRdPP0TghVfrwEfwgz5cTUXUfF6/dPtGyGItRkaMyACnyomHrVnCAvvY47LfNOy2ahIT+SUBtw4YUqH1ijpIPRdVf1DOimfmdZNiMRajI0ZkIFn8wD5E6mEbQ9MPOUPS2bhYV84N2g5zfgYyzpwkI+fFzMbnO3mKbNd7NsRiLUZGjMhAreSUy9Ss5hFejmKhwD3GCft6C9UHv9nrVd1toEumnPyJW+R6jJ0NgAeoB06x+7VXVvAMDKFKBTUYAuQ231SDGFJXOHfHdt/nfFHSyrWoSaDI0NoAfgVPf1PFDO6wfQnZ6Bv29ZFbQUaqMtxUtpr9zFM52W29NPV/XkItRkaGwIPci+9kBZMTXoDs6yIHuaZVXQQqh9Pkpb5Y6akGiHtS83pmxiWWUh1GRoHAN6mBSuYk5SF1cc0M1XWUXualkVtAhql6OsjbI7ocqi+UmWVTZCTYbGMaAHImyRXuwiwB05UCWCdpNt3iDY2rIraAHUHtzIl64ezV0s0+O6V5Heblk1QqjJ0DgmzLH0kLm/PgLGzrHPi736DkBboXbYS/wJ7ZJz48mAbshfJ25p2TVCqMnQOAH0cOk6F1b2ufMZFldu4v0JsdGcpmC6UP0/QUynohBe1GYR3YXOHED6NcuuMUJNhsYJoAfcRryRB27ipAsMwzPE8FBtwWyhen+c+G3agaOcuesNtkldZ3OEZTcWQk2GxgmhB+UXmYaN3JgbdJNwyEqz9KxzhOqbdmssUkZOFxv/pDhRJxNqMjROAXrYV9iDZ50FGLAi1rPFMmedA1TPe4iNRQrdXj6vl9zfshwboSZD45Sgh05nATQk3MvQEDkZsSLWL4nbWpYFM4Dq91kip+4bi9SdimPXairXjYaaDI1Tgh6cXasv40iTxRVkzurmPNeJD7dsC6YI1ethYroEj56xiUjdFikhrBdYlhMj1GRonCLkAPHVG3CoyWYApBd2oSv2i/e1bAsmhOpyczFFaCDb303apjLqvc6ynQpCTYbGKUOOPFxMr9Q2/dXSCzMcWYWw0/HHYokITADVH1fef1VM9ZpzS6NnJUJzimU7NYSaDI0zgBxiRZlu02gqVv7W3a4BuQhj6FuMBcOhemNTJi2amFrlbswMaFOytFslniNOPTITajI0zghy6qliEisx1iZihfzy3byV7drOvH81a6iuOAF1itVdGqVyXiPxtI2ZgUg/Lc4kIhNqMjTOEHKOk1ZcjtW4Z4XMW935ACrtA2InrwyaFlQ/+4g3ianecs9ieFZ6UhbIMwsbhpoMjTOGnNxbTD1r03AI5O9dWAR+S3yJZV9gUJ1wrf1HrI7SwrTpUA9ZOFV60vtaETNBqMnQOAfIWaYBaT+ZHrLpMAQZilzvCr8g7m5F9BaqA65eerWY5qKQH3bTDgG6/Xt4rjjzDZhQk6FxTpDTjxW/QSXo135v7ns4VbJN6+au/PI5K9C7863yeSPxRWL62DLkhzxuvbr7CCChrLlsaYeaDI1zhJx/iJhus2Z4ybnDKCI9sjuIDTnB89di5wUrH/m2EzctptdFIMN87hnSKul53XE9eIwVNReEmgyNc4YqgotgPzOomHEm+wOy2HJ7z5Bdl4+JYx87ayvkE1c+vkpcWSgxsjDCjDPMw8pilYNFc5/7h5oMjWsAVcgm4tutgpLYmmy5VsmiodIrwH8VXyqOdaC3LdDz7yZyFTmLyOQbPSg/8EnqjNHMLZpuF/ewIueKUJOhcQ2hynmBmCICzFubnLyKSA9RmRLA74vvE1nQLcQul56TrehXil8TV3zhDAXx5XF7UEjayoYKB4F2sqLnjlCToXGNoUp6hHiJVVrjfeiI9DQMie7c5IBcTEwg/OniZvYIrYCehy+NHCoiHLaPV56b0WLSHzFk5FGdDHpRpknHiGv6fbBQk6GxBVBlcfKKqUA62TON3nVAGgfxM1ySt+MPRObKXKqxp7ipPc5coPL4oMeLRX4414qrno+YM73nJMP7gORR6UWJFLTitfVQk6GxRaDyxPVWmaknGSfmOoyIlhhjIFrIDho4TfwTcT+RKMVEAlb67cTdRW7Fe6v4KTF9br5K5uqIc5o+Mxflh+/K+RtxG3u8NUeoydDYMqgS2adm8ZCGPyb8k6xsh5H5LKJgTjtEuAPSyHeJhNW4J5Q3EbjX4P3iSY7sCmFHiJxWulVMl98OI70miyJGj1n4V4mIEC0Iv0yylgg1GRpbClXq48V/s0pOvcK4scIc0oshGH4UiJewjdtYmIj8EBANvTk+EJSftjAHDGLMhJ3eLG5hVdsqhJoMjS2GKpfdF4bM28RU8RLQ1OavOURQ9E5MGxhGERo9MaQ3hIib/8+/QZ4PMU5jfplLyrIzEX6YP0ts9dsSoSZD4wJAlc10gA9xMQSvCBZRzKpnWhTSg7JQcjFRyKfs97LqazVCTYbGBYIqn4XJceLKAQymBPRo8+y92kB67GCTg7jrQp3bDTUZGhcQaoytxcNFv3q+l7kZQ3TUsF0gP0amGIwm3m/xH8SF6EGrCDUZGhcYahyOuB0kXiQOGi71sswdmVtGDb5IZGrDnNd6Ty9Q4sAcJH+UVcdCItRkaOwI1GBcT/NuMX0cYUB2YlhkLFJPS8/J/BtxVuaekNAX26utiYVOglCTobFjUAOyy3Wg+Pdiut57QDX6PTQ+w+e45zZnQYRJr8kPyr2F68kr6OzcLXTvGSHUZGjsMNSwHI17jniqmD5A7ElvNa/45oCs0und+bGwWq/MNwfEBl4vPtrc6SRCTYbGnkANzoFj7lwizMXdrEO/G6Xpwj0ImMUZIiaqQAyVXg+RIWjmvxDh8V9s/Bvk7xA+82TESC9OT0mPHpVnZOuY7Vvixg+0x+48Qk2Gxp5CYkC4vB7DBW8niJ8VVzYWZkjOFFwh8goNV5HT42d/RaRrCDUZGgtWQaLhzld6Xl734KW540WmDpy0IpDOKyDs+3MCCWFz6Jj/cgIKO7HMfxHZFXqP+AbxZeIzRI40rumxurYh1GRkLCxsG0NjYWHbGBoLC9vG0FhY2DaGxsLCtjE0Fha2jaGxsLBtDI2Fhe3i0n3+H22Nlx55ajZBAAAAAElFTkSuQmCC);background-position:50% 50px;background-repeat:no-repeat;background-size:100px;padding-top:160px;text-align:center}.od-PeopleCard-errorSection{position:relative;text-align:center}.od-PeopleCard-errorSection-inner{position:absolute;top:50%;-ms-transform:translateY(-50%);transform:translateY(-50%);width:290px}.od-PeopleCard-errorSection-inner>.od-PeopleCard-errorHeader{margin-bottom:6px}.od-PeopleCard-errorRetry:hover{cursor:pointer}.od-PeopleCard-errorRetry:before{font-family:FabricMDL2Icons;content:'\\e895';font-size:12px;position:relative;top:2px}[dir=ltr] .od-PeopleCard-errorRetry:before{margin-right:6px}[dir=rtl] .od-PeopleCard-errorRetry:before{margin-left:6px}.od-PeopleCard-errorHeader,.od-PeopleCard-errorSubHeader{display:block;margin-bottom:4px}.od-PeopleCard-errorPanel .od-PeopleCard-errorRetry{display:inline-block;margin:16px 0}.od-PeopleCard-contentBlock.od-PeopleCard-errorSection.od-PeopleCard-errorSection-docs,.od-PeopleCard-errorSection.od-PeopleCard-errorSection-docs.od-PeopleCard-contentBlock--loading{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkQAAAC7CAYAAACEu4G/AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTExIDc5LjE1ODMyNSwgMjAxNS8wOS8xMC0wMToxMDoyMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpiZmQ3YWMwZC1iZGZmLTlkNDMtYmZkZi02NmZhNzY2NWFiZGQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE4NEIxODgwNzlCMTFFNjg1RjQ4RDdDNjNCM0QwOUEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE4NEIxODcwNzlCMTFFNjg1RjQ4RDdDNjNCM0QwOUEiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YmZkN2FjMGQtYmRmZi05ZDQzLWJmZGYtNjZmYTc2NjVhYmRkIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmJmZDdhYzBkLWJkZmYtOWQ0My1iZmRmLTY2ZmE3NjY1YWJkZCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pp6EKp8AACJfSURBVHja7J2JcyPHlaezCjdv9qVu6mp3S7IuqyW1PSN7Zid2JmZiN2L/592d2NhjYoPhldce2WtbGskSWlcfYJPEjdr3AxLdIFjg1SBQx/dFpKp5iCwmCpVfvXz50jkAAAAAAAAAAAAAAACA3FJvtHdCugEAAAByLEM1O3yAEAEAAECeuWethBABAABALtFUmR2u698IEQAAAORRhop2eG/8MUIEAAAAeeQta1WECAAAAHJJvdGWCP1k8nMIEQAAAOSNt6YdCCECAACATLNbb5asDZ2n3miv2uHV6e8p0k0AAACQcX5q7ZZJ0eeDyK2FwfGAUEAfAQAAQFYxCVLw55+cDwIFZj6rxcCtlsyKJiyICBEAAADEicSHdnjZWn+i9ax1fGv7Y3Oy3d+pRQn7U16Z9J3Izm6/Gzmd5EY5QIgAAABSLCua8lmztu6b/q3cmBVr/9mkpD2nXxX6Vjrj90d2bhKjpxNtz85nb4nd9WrcJ1eKRyfJECIAAIDky8+mb1v+KAmalfaivblihajeaAdeboq+FdzzBVbFyZ/5/eGg2j9/rCfwUqb2kv/cE2v/bUl9t+r77AiVQuCKU1lECBEAAEDyBOiqb1esbbtzrApfKQYvm/jo/636JkEq+3bWSI8rhYHr9+cy+9VYYne+HGuMMfaDEAEAACxfgjQe37Z2zYvQhcviFEJ3J0l/mwlayQRNUre3s1npL1uIFMKqFgOECAAAIIFIFN5w54jgzPxBg/mcULUouQqGycdKRB4f+/afgR0HZwwerZQCbaCqFpkYKafoobVHOpogtS+rQ00yNW23dvzvCmLnGhEiAACAJaOVWTaA/+DF4dxo+bhyYgpB4MqF+ZxTzcShFvuV5zoxGAqSJCwaHa31Bmqjj4eiER75Hzd8G26bYYKkZGv93d9LkkyQBnPs1uuzRM8hRAAAAMnCpEAKc2O/G1Wfdk4Pu0gwyuEoKbgU6uOj9XQWiX6vWunYCQTPZOmUUxsL0l1rXesLidG31r6bnl4zYdR2G0om/zcTyIdnOL0bcZ+szOgsCjMCAAAsXoIUkLhp7ZYfuEMJxHeHg2PCIflR1KdUCIYClJOBu+/F6Btr3z84GPbLP7rnu9Nr6u1za1+bHB2LKpk8qZv+o5sK/JStD69WESIAAIBlSpDGXCVNv+pl6Njk1sPWwCnDpVIYDd4ldhwVrYNu9GivE8VNJyoH6Qs3ihp1J4RIuUN/P/3N6+XArZXi1YcpMwAAgMsVIUU1XrP2unse4YjlahUDiqHa6c/MrapYe9vaXZMgidHnXow24765fEL3EiECAAC4IH5qZssG4ccxIqQaQloCf5Px9uLETSWegGToT25Ue+n29BdvroTDvcwQIgAAgPnJkPJ/FJ0Yb5fR9CKkCs1aQn+FXpqPEB32InfYfb5y7Sz/m5uq5aQk9Ou12SEihAgAAOB8IqTpmPenhOerW6uhlo+PV0LBJdAyMdLGrN0LLM5X/aHtSoAQAQAAvKAIaeuLd9woH+gYij4USQFaCJ3+aMf69jlCRkqmXi/P1h6SqgEAAE6Xode8DJVnfY8G6K0KcYZFoDIEVwqB6w4Ct9+JXOsMYlQ4RVYRIgAAgNkipPyge260XP5EesO9LBCiRaKyBNvVkRjtmRh1psSoHLp2qRCU7KUJS6dUr0SIAAAA4mVIy+TfczH1giYpBKP6NrUiMrRMMVLBxXbfDcVI24fodblSC1vB6PXbd6OK2DPh1QMAADgqQqpto6jQSycOoMEoL2W1FDCYLo+etZY/Ck2MFQ66UaUYurBSCCYnyg7caPPcMkIEAABwsgxpG42P3Am5QkLRoI3y8vYQyzEt3yQ6NS8450Hr07TtxyZCBAAAcFyENB7+1NqbJ32fpmE2K9pag+FzgSiyo4KLK6eJ6jnQFFplUqjIIQIAAGTIuU/cKYnTq37ZNiq0ELS561MvQauX8PO111nP/45h3SgqJgAAQK65v1PT0qTvZ31dwSAl7G4gQ4tAm7XueT/ZcvOLCMVR9DLUsBbx2gIAABi/ftD8ZBC565OfI1doYWhKTFufbCzp9x8yZQYAALmn3mjfjCK3/WNrMFyyLf/ZqARuhaX0l42ic3tehDaWeB4rvNIAAJB3GVIitTZpHcrQk/bAbVXYhmMBKCIkD6km4WQQIgAAyKsISXk+tPYyvbFwlLezmaQTYsoMAADyKENabv1X7uiO9XD5qA7QQdJkCCECAIA8ypAK+mmZ/Rq9sVCUOK2l7utJPDmECAAA8iRD616GqvTGQtFyeqXp1JJ6gggRAADkRYY2vQyV6Y2Fy5DytUpJPkmECAAA8iBD216GGPcWy3jT1VLST5RFhQAAgAzBZaAaQ4oOVdJwsggRAABkWYY2kaGloX3CVtNyslwgAACQCXbrTT3k37b2hfYnm0igZqxbjgxtpOmEuUgAACArjIssXvnqcfszRwL1slDeUC1tJ02lagAASD279aa23nhz/HEpdP2r1bAQMMotg/HeZKmCHCIAAEi7DL0yKUOiO3CFh62BG0T0z4I5SKMMIUQAAJB2Gdqyw724r/VNhiKECK9AiAAAIOMypOXcv4gbyzRTtl0JXYFRbpHsuxTmDiFEAACQZhmS83zsZmzBsVUJXLlAP+EUCBEAAGQb5Qxdi/vCWilw1SLZ1Avm0NoKQgQAALAgduvNq3Z4K+5r1ULg1svI0BLopv0PQIgAACBNMqS6QpoqO2Y9xXA0VQYLR6nr6wgRAADA4lDxxWN5Q9KgrUroqDu0FPaz4BMIEQAApILdevNVO7wU97WNcqBijLAc+ln4I7h8AAAgDTKkqNB7cV9TAvVKidDQEqkiRAAAAItBxRdL058smAdtkkS9TAYIEQAAwALwU2U34r6mJOoQH1omzaz8IQgRAAAkHZVYPJanommycgEbWjLdrPwhCBEAACSa+zu1f7PDfy2Ew41DR4ZkHrRB3hDMkSJdAAAASefWaqhaN9VmL3J7nWg4VcYS+0SQmVcBIQIAgDSgFWaFWnG0LQculBgys2McU2YAAJBo6o32dTvcGn+MDCWKzLwcCBEAACRZhjTgvk9PJBYiRAAAAAvgtrU1ugEQIgAAyCX1Rlt5rm/RE4kmQogAAAAulzeslemGRDNAiAAAAC6JeqOt7SDu0BMIEUIEAAB55q7LUMIuIEQAAADnwkeHbtMTqYAIEQAAwCVxl/EJIUKIAAAgt9Qb7YojOpQmKMwIAABwCfyEsQmP4A8BAIDcUm+0lUR9m55IFZnZExUhAgCApbFbb65bGw+qr1kr0SupoorZAQAAvDgfW1sxKfqqN3C3ijympw29Yt0siCxCBAAAS8EkaNsOG/7DOz80B65aCNxaOXAlxChNNLMgRFxyAACwLG5Pf6LVj1x/ENEz6SITS+8RIgAAWDi79aYiCjvHBqXAuWoxoIPSRSb2m0OIAABgGbwcNwatIENpZMVlIEqEEAEAwDJ4JXZkLSFEKWUfIQIAADgHu/Xmmh22pz9fKQSugA8BQgQAADkhNjpUY91zmpHkpnraDCECAIBFc2v6EwHJ1GlHPrGf9j8AAABgIezWm6o7tDb9edUfQodSTwEhAgAAOBu34j5ZZbosC6y6UZFGhAgAAOAUbk5/QtNlFbKps0IXIQIAADiB3Xqz5p5v1fEMpssyhV7fNkIEAAAwm5fiPlkt0DEZo4MQAQAAzOZ63CeZLssc69YOECIAAIApdutNWc+16c+XNV2GD2URpcmnapdehAgAABbBth8kj1BhuiyrVKztIUQAADnER0EgHiXa/sna46NCRJdlmE2XomKNXIkAAOcXn9Df7MdNORMqNviH+zu1L+b08//BDyZP/VFP2w37+anfVfybJ+3/0BlE5U7fOq7MMJRx7FV2PTeKGCUaSmEBAJwuKBq1NeWjHBglBm+5+Aj7ypx+pX5OzbfJROSBnYvESFGWh9Z+NEFKVd2XeqMtcSwrMsR0WS7Qq9z1UpRo50DNAQBmS5BkRJWVVUywfOqdP3CPb6yEdf80PG4lPygEEwPCwD85j4+aTtJS5ZaOjXZUPuxFb5/hNJW0+sTat9YemBwlfmWPCdHrdviAKyx3HFqrugSn6iBEAABHRUjbD9y29rI7Z5i/ZLf6a7UXv98fdCO317nQAh1Fj/5i7RuTo0QWxzMhumeH17jSkKKkwZQZAMBIhG7Y4Y6bUSvnLPTmtMi4f/GfoyrB71l71/6eB3b8wsToUcK6eourLbdoKrjp3aOUtJNjlRkAIEP1pqIWf31RGdJCKW0/sVqcT9BdkSbl2LzAAiz9nzvWfml/W2KSWeuNtqYO17nico3y4iKXwE1giRABANhY7c44jSPTUDHBcmEkLcVw/rkHNROrWnH02zRy9AbOdfqR6/rjOSJISZs623SkasAoH09XsaZ4NxAiAICEYNLww68fNA8GkVuN+3oYjCRFUaBSYbEjun6XIkalMHj2GQlR2/7T6o0EaZYfrZeDhwnr6jWuNpi4tCVDKikxXnyw9BMCAMgt9Ub7qh3ebvWjK49b0ZGb41CCiskuHhjZKdu5u2ZvJEljdM5XqsPz1hL9P+xsVn5IQF8rv+kOVx1ModWWqre1ucyTIEIEAHkVIUUrNEArmXoY/SmG0VAwVkuBWymmY4+tIHg+xdaPAnfYjdxhL7K/4dm3qH7SJ/b3Klr0ryZGT5Z4uuQPQRzjQqfj0hNLmUYjQgQAeRMhJfa+ae2um1pYogBLFnaSiE6+uX9l7TMTo84S+v6f3GjZNcBJtL0YrbsFLv5CiAAgTzKkVWQqCriS866QDP3WpOibBfa9Brb/xFUI52A8labZrNXL/mVMmQFAHkRIg/E7jvyVMVrl87H1i6pwf2pitIjtP2p0O5yT8VSa0NYfqsQe+AeaufsLQgQAWZchhd3vO/JX4pAQbVsf7ZoUXXYBxxW6G17QVyaTrsf5RgMvTsqaq7gXmGJDiAAgyzKkAf8jN9pLDOJRTs+vrK+UV/RnhAhSQtnN3l+w51vffxz5hhABQO5ESGH1n7pR8jScjvrrXes3PYFrCm04kOzWm5KY7v2d2jym1EimhkVRvIjfkFQNAKnGBm2FyD+09mcbuBs+X+hjN5oOgvOjZfn/8uBgoPHhb9xoSuJ/WN92TngNNFUxblX3vNDeeM+q4rVa2CuFww1zARL7VAAAkGYZ+rm1l6x1ygX3L1er4bv276v0zsUZRO7g+8OBHZ7lXSmZ9X962Vn3TdGjVX88dUpysxw8rhaD7ZBRBxAiAIBLk6EhNtgOrtXCsMCd7cIo0eJRKxpuCXJZ3FplX3FIHlyVAJBWPpyUITGIXPiwNdARLsjTzuXKUICsAkIEADAfdutN1RSKzUfR1hsI0cVZK2kLk2OfHjDoQNZhlRkAxAnHuPhZzTfljpR8K7ijOSN9P2BqmasSb1V2v2nt6f2dWvMSzu22Hd6IHWztrK9Ww7gBHc4qLKM+bD1sDUq9gStYX0aVQhAddM9vmYoGhRNHJWmUSCIChAgAUiBCV+zwMwUK5vAw/3trf5zz+WnrjfeRobkjkT30r/mq9WVVfbnXidxGOQi6g6hwMLXwXnlaBfvuotmOjvpYr0HBPg79vwEQIgBIKxr25rXT9OGcZUiRqo9dzGIQfWIbGbrI6yMRqvpWnhbMrcqoqxXVWS0NpadVLgTVYkAuECBEAJBt9t1oCuyFKztvVoLNeqOtAfdgZ7PyQnI0saIstjLtVjVwZWToLGgKU1Oa4+XyZ6oeLTnaKA8NSOLUcEe3UABAiAAg/Zi0aJC7YU3TZds/NgeF7hxSaKuF4K4d7vrfofyiJ34wVfvRJKl9jh/3nrwn7gsaqKussz+Jnhddvc7jnLAXcl03qku0StdCluAuApBPCVKOkFZpqZrzkU1PG53IHc5IoFWkQDeNIHh+8xiv6NIxmrix3Dy91owG6YfWvrP2gwlSrIb5vKFP4r5WKwbPpnXgGJKWgbucTW27/mXmoRoQIgBInQQVvATddidMebT6kWv1lDfifLJs8Cxh9jS05L3vxah0viksRTG+t/aNBMnkKPIypFVt/97F7IOln3+1FnITO86eG60GrF3y75HQrtHdgBBlGLsJF/wNuDD1FKSnIt2oD+/v1Pr0FKREhJR3c8eLUCkFp9yy9qW1rx4cDN51MfWGFKG6Xg2HwgYjF/UitLLg11i/c4PuhyyQ23Cnr7OiUPKWP676p52xCJ3E/7L2A5cPJOh61vXbN1FvTYiQBsa7XoYKKfpz9B4c7lRfLrjDTsyjx2Y5QIae0/AitIxE5zX/oFjiZQCEKF2Dhp5kVOr/uhehiw4SHS4dSNB1/bobJR1L0v+3iZBk/zVrb7sZq7LSgLbh6PaPT8lozbdyh8A99a/vMld8SUsPESLIArm5q9igoSfOt+bxs65Ug3+tFALdjPQ0vj8rGRTgkq9pPdB8ZO3m+HPlQvDZ1Wqw4zKwLFp7au1PJXcrj+l6Lcx70T/ddxQ3S9IqL90P13lXQprJU4To+3kJUTkM3p382J7I9YSksLWWFT+y9nicFApwSTKkwUd1eY5EUHqD6J1BFGRCGFZLwTAxZnLLiM1KkGcZGnjxSKLsKlIVOfJSIcXk5uL9+km7+P3h4B+jOYR2b52+nLjrBayuIxEkmLMMXbPDL2Y90GRtKXpvMIoW6W61nd8l9lrRVXHJnpqiYCMgREmm3mir2JzyKXb2OtqPJz5wo2XFxTB4tj9POLEZ4biT9H9qWfE58xckR3+x9sV0tV5fX6Vxf6dGThKcVYY0HaZpsplWrsiKryoM6SfJUaFpxunvBV42QIiSJULKq1De0LMloVqt8rA1GP7RZTOfcsENy/1rn54F7Msjn/rW2h9MjJ7awKanvX/wn/+dSdFfuBzhFBl62ctQMEvqFRkqU7U5Kxx6uaik6JyVNrDFSwcIUTJESFsQvONm1MZo96PhgLHEP1wC9PW3h4Mwio7UV5EsfUq0CC4iQ5L77UrIDuPZoeHvYWl7RQf+HkeUCBCiJYqQape870ZbESQa7RP1YzM2rUirR3ZNih5xacKEDCna+fNZ79eVYjBMNoZMoBuDttxI84otokSAEC1Rhl71MpSKVXMPTYY6gxNviL81KfqSyxNMhrbt8MtZT9xrpcCtky+UFTr+/V9N+d9BoUZAiJYgQhKgD1xMaf+kolhyox25Zu/UVfl/Min6jEs01zKkgfHv3IwcEomQhAgywYF/nbNSCoUtPQAhWqAMqVS9dsBeTeP5K5dJYtQ/2Yu+tvZ/TIyoaZQ/GdIqsl9Z20aGMo9Wka25bOV0KiF8hZcW0kQqdgOywWHTJ5WOZUiDxL9LqwyJSiFw12qhq568IugVax/5fdcgX7w9S4a0rB4ZygyKpKy77C1wkQw1eXkhTSQ+PGsyoCcnRYJK9u++L4p4Py0yd6KNqtBcNXD7XV94Lh6JoOp7fMrlmg984cW7cV+TQFNjKDNkvZChcqJqvMyAEM1nYFAOhRJKxxtU/rzVjzQoZGpE0NO+aj0+aUduhha9Zn3Rvr9T+/0L9mfRP7kVJ55Ie164dOzY76Cq9vLRdMNDa1ePvFntEWCrigwhQ+m5tTm284AUkdgL1edQ/I2LWb6pqEo1g8XnVDjyUXswrIY9g1+bsHz9An2qGk1/fcK36De33SinQW24N5v9TkLfS+B337XutfvRa+MRRVOsxZB+yQB5Sjhm01dIDUmOEN1zM2pZtHqaOsjei6Hieler4bCa9gwpumdSc2CC8viCv6J7BkGu+nZ9QqS0j5L2ZvvGfvcT3jaXT73R1rLll3qDwDU6g+F2McgQMpRCiDhDakhkmMUG4GEycdzXlIysCFGWY7CdfuQetWZOnyla888mJt2z/CwbWDWMKvm81u5Hm/Zz357DE59qJP3FzqHHW+jShEjlJF6nJzLFvn8v5mkKSUKEykMqSFyEyGRIN4yfxX2tFI52u8763URbi2xVnHvcjlUiJSmqEOXnMYOoukZ5CVf9cXPyBlwe7uvwwiv4Ff5+3//c3/IWuhQZUgThNXoiU+hBZsXlL59GMnTgUrwiGBCiZfJh3HmNVmSFLsjJ7aRaDNx6dGz1mZKffzOZR2SDpyYPlRu0448zX9M59l0UJ2QwN95xJKJmCUVSCy6/kZIulwAgROdkt97UU/GVuK9pF++8beKt1WdKtFYRR0XHtirh02LovvEipBUct90oWnTm13E83TiOFQ2b/WdgTcWz+wM7Dk4uGGnn0rhWC1u8feaPva5XvNhCdtBChTxHSMpcApAGEqMYJkN60/x93JtHhejyWntFonJopjJRiO/PbjRttnOZv1dCpFymtgmZSh1MJnlfH6120hTAH619tbNZoZL2/IRIZSau0ROZIQ/L6890K3PkEkHCSVKE6K04GdLKmjxvXqmpwqmqxHcX8XsVjdPKplpRUaTAtUzKDnujO5pf7SQpU+LvbRvEPzUpYvXZi8vQBjKUKfaRoWeottYa3QAI0Sns1psaXGNX1GyWA5Iploz6/7kcHUOD+N/aYK5o0f8jWvRC3KULMoPyhqp0w5H+AEh2ACIh5/HTuHPRIFwuoENJk6MZn1aE75cmRuQLXADfbzv0RGZouezsXJ+lsQYguRfpbr2ppaivxI2w6+zZlDa03P/vbHBnie35eYVBIzOo+CLTQ0fhQQkQojNw28UEHlZK+VtVlhE0/fm3Ph8GzidEkH40NbRCNxyD6UNAiE5it95UbY5jBejkQVOJxJC+p0FNn7GH0RnwETWSb7OBkoeZKounQxcAQnTyU8PT6U8qdyjEh7IgRZ/YYM+T4emQO5QNVJGZyOhsKNAICNEs7u/UtFHpfzf3+S8rpaA7lqBVokNZQTL0C7+fGszmJbqA+2kOYKUZJJpEhHZvroaKJpRUfFHFANnVO1NsWXvP2v+lK47jd7XfoidST952sb8IlOQAhOgMvKz/KC5UIZM6i6h447cPDgaP3KjEQuf+Tu1Pee2M3Xqz4kbTZA9thFgN2LcsCwN9jW44FT3qqhyBHgIKdAcgRMefkANHDkXmafWij9yofL8Gjr5JwdcmRXndD03lCd7XP747GAxUa6tSIHcuxSg6RFL86UxH0HQ/UF6Rkq37E2NSDWGCXAqRv5FQoyKjaE+0vU4kIapMfFo3uzddfqfRtiZCC2Hb7xknIYLUoUGdulsXQxGjim/HnqHcaFNcoTIGJboL8iBE13kZsos2hdU+aDG8tltv/nGZUSL7/a/4AU3ncLjAczkWTdBMMdGhVLLnyAG7DKruaO0iyVHTPzxT5wkyK0RsZpnlC8yeAVeKgTs8LkV6OvyJtc+WeHrvuYnopAmSwvfanfyxtR+tPTJJGixCiErkzqUVokOLYTKSpCm2Qy9GzC5ANoTI5w9t8zJkm7Vy4JomRDFxIkWJ/nBJ0nGR67/kBV1NU3o9O79v7fi1BMnO84VXydjPK7uY8H+JlZVphJVly6E8IUJP/cMVYgrpFiJv+CTPZRwFP6rFkRTF3NhuWftmzqKtJ0lVyV7z19j46TL0LdJU3reHg/AM749XfDs0mfncjl+ZGPXnHVEgfYj7J1yIcTV8Taf1HXvIQYrf0KzMyAkqttmMzyXaOYsQmYwoqqKojYp5fhkjQDd8U8Tx1CXQFwj1SKy0MuxN5T7Z8csLRrZihahAAlHaaDlyWZLE+D1/OPF+BUiVELHXVU7QlJBa97hC3DDBKJpc9E6Qodft8I4bTTW1tWT/1moYeZnSXnhXz3s+g4tPflW8GN228/iNnffDC964j74R8aE0ChHb0iSPsQjt+X8TxYPlC5HfuFWrLxQF0jy76s78OPVt3FDy9Ahno363E5tcrZWGD2KuIcnDx9auTArJSjEYf+7CCZVK9r6xErr+QKUBomF5gE5fwhadVZYUmv+VneMXdvzsHNNox85ZLhQgRGmDqZlkozGn78jzgmUJkQ0Okp+bfoDbckcr8CqUiRDlGOUR7XVibeOYENm1pOvoQxeTgNzuRzcju7Re1CGU21QouOeXaWn0b0WxVCpAU3z90+VI0auv/I33LByrucJsWerYR4hSQcHLkBKvVx17zcFlC5F/itegoO03Tpq3Xa032qvueYJrCXPP2d0pGEVmesenza5MXVPa3uOtWT9HkiJZWbmkeabh9F45cOvWVDRxv+uGe+zN4Pf3d2p75/jxZYQo9fTpglSh1AzVMYp4CIdLESIbtJS38YYbJbKePgoUnq3WgRxTttG/d3xOat0nTWuguXfadaJIU3lBFlHx22p0+opuDY7kQJULweBqNXh8zh8ZHhcijChlkLCbPvQQrnfvU0fuKsxLiGzg0tP82+6ciay9AZ0NQzF2h/Hp05puvWPtpZkXq6nEZjmQiCzlvK/VQnfYjdxeNxpOsm1XAsnNL+uN9m93NitfnvFHHZsCRIdShZZ3s5FrOgm9DJFXBC8mRCZCCjW+4y4Y5dEDfcTNP/eUhpGd2Omn9066SWl6bKMSLP36WSkFrmLnomRsH6TSTfYDk6IVk6LPeIUzTxshSj26zzQcZV/gIkJkMqTlzR+4M26wpxmASjiaatCWBFThhWcXXHjiTer4taS7lolQkjY+fZ6MfYQ3TIpKJkW/Oe97jhmzdDk9XZAJNpEiOLcQmQypzsu9UyXIjXI7asVR3gXASVJ0lilURWC2K+FwuiolvG5S1Dcp+t0J33MsITfikkgLeqnIH8qWFDF9Bs/HnDN8T92NlpnOHLQ2ysGwpstWJUCG4FQKZwiJ6Lq6Wk2VDI25Y1J0Z8bDhd5vx5ZrRxhRWjh0zPpnjY2TxjdAiI6gCsI2KH0aTD3IToqQtmVg6TCcXYhGbdYlE3gZKqZ3qvVdk6IbMe8lxcW6058fRJHSzJ+4UQh/3w+8qoSsBN4DN1oZ0/Dfsxf3M2Ah0O/ZRFG/Nt0Ap2qM3dhl0L9o9qKVJ+2REynBVTVakCC4KA27lg7j9zZzV6qZiDRq8Pznnc1Kc+K9VPyxGf2sO4iGCxO2K2FUKrjhUrUL5BG1vTCVHdM4C7tsHTknWUUPIBVHBBAhOkGGrkmGnM81UpVhTWFUmRaDF+SxCVErRogUdVTEMSP8YO1bNypRIXGpDSK3+t3hKIFKyeJzKi7Z8oLEYH35gyaF/bIL+UQI0Yky9FduVP4cYO6oCvSTdjQwSRhOjikqpOhQytH0175/2qz5m2zVTVSoftSKhn+7xE8COEc6ftDmpj5/qBqSDzRFvUo3IESTMqR9yH6FDMEl07RRJnraiVa0Fcf1Wpjmadi2b+unDZyqdq1vuMQcKd3Uiy5m3zS4MESHcvKc5h9ekN8cEsbIkN70RIZgEQzsrhMOk/PTK0OKCO15+dg4y41UdbkuOWFcT7iql/OUS2xudOiCXFBxZ9+oGbIsRCZDupnf58kSFsB4B2o9kT0JguE0U9o2zWz499BGQt/b6/4cYQ7yThfkBr1vWFGYQ6YLM/7ETe08DnBJjCOQ04nAaVg91fbyloYkZorPAZz/YeKpY5FCLl/4IfVGW0/rb9MlsAAOT5AdRSe33PPaIEmLcOhGWXLpWuq+4YgUze1eCblAMsQ0aY7f5O868oZgMfTO+H2ViRtTEqrJSirWUzo4jiNFcDG4N+aPJl2QQyGqN9rbdrhJd8ACGHipOA+aPtOWF0/d8nI59lz6Q+jr3OQRIjjX+4XcsbwJkWOqDBaHpOai68nGyY6tJchQFnJwAt/YPe38FOmCXI6PrNTMEf9fgAEADtvA3YJ5ORcAAAAASUVORK5CYII=);background-repeat:no-repeat;background-position:right bottom;background-size:cover}.od-PeopleCard{position:relative;width:340px;opacity:0;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";box-shadow:0 0 20px rgba(0,0,0,.2);border:1px solid rgba(0,0,0,.15);margin-top:-20px;overflow:hidden;-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;z-index:2}[dir=ltr] .od-PeopleCard{left:50%}[dir=rtl] .od-PeopleCard{right:50%}[dir=ltr] .od-PeopleCard{margin-left:-180px}[dir=rtl] .od-PeopleCard{margin-right:-180px}.od-PeopleCard-fadeIn{opacity:1;transition:opacity 267ms ease-out}.od-PeopleCard-cardContentWrapper{position:relative}.od-PeopleCard-contentOverlay{position:absolute;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;opacity:0;padding-bottom:44px;visibility:hidden;z-index:3}.od-PeopleCard-contentOverlay.od-PeopleCard--active{transition:all 267ms ease-out;opacity:1;visibility:visible}.od-PeopleCard-closeExpandedView{position:absolute;visibility:hidden;display:inline-block;background:rgba(0,0,0,.5);cursor:pointer;height:40px;line-height:40px;opacity:0;border:0;padding:0 12px;-ms-transform:translateY(100%);transform:translateY(100%);transition-property:opacity transform;transition-duration:167ms;transition-timing-function:ease-out;z-index:2}.od-PeopleCard-closeExpandedView .od-PeopleCard-userName{display:inline-block;color:#fff;line-height:38px;vertical-align:top;max-width:230px}[dir=ltr] .od-PeopleCard-closeExpandedView .od-PeopleCard-userName{margin-left:4px}[dir=rtl] .od-PeopleCard-closeExpandedView .od-PeopleCard-userName{margin-right:4px}.od-PeopleCard--closeExpandedViewActive{visibility:visible;opacity:1;-ms-transform:translateY(0);transform:translateY(0)}.od-PeopleCard--closeExpandedViewActive:focus,.od-PeopleCard--closeExpandedViewActive:hover{background:rgba(0,0,0,.75)}.od-PeopleCard-backBtn{position:absolute;visibility:hidden;display:inline-block;color:#fff;background:rgba(0,0,0,.5);height:40px;line-height:40px;opacity:0;border:0;padding:0 12px;transition-property:opacity;transition-duration:167ms;transition-timing-function:ease-out}.od-PeopleCard-backBtn:focus,.od-PeopleCard-backBtn:hover{background:rgba(0,0,0,.75)}.od-PeopleCard-backBtnEnabled{visibility:visible;opacity:1;cursor:pointer}.od-PeopleCard-iconGoBack{display:inline-block;position:relative;color:#fff;font-size:20px}.od-PeopleCard-expandedHeader{max-width:270px;margin-bottom:20px}.od-PeopleCard-expandedContent{position:relative;height:100%;box-sizing:border-box;opacity:0;overflow:hidden;padding:16px;transition:none}.od-PeopleCard-expandedContent.od-PeopleCard--active{opacity:1;transition:opacity 267ms ease-out}.od-PeopleCard-expandedContent.od-PeopleCard--scrollable{overflow-y:auto}.od-PeopleCard-escapeValveExpanded{border-top:1px solid rgba(0,0,0,.1);opacity:0;padding-top:4px;transition:none}.od-PeopleCard-escapeValveExpanded.od-PeopleCard--active{opacity:1;transition:opacity 267ms ease-out 167ms}.od-PeopleCard-cardContentWrapper{position:relative}.od-PeopleCard-header{position:relative;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:1px solid rgba(0,0,0,.15);overflow:hidden;padding-top:8px;padding-bottom:16px;-ms-transform:translateY(0);transform:translateY(0);transition-property:opacity transform;transition-duration:167ms;transition-timing-function:ease-out}[dir=ltr] .od-PeopleCard-header{padding-right:16px}[dir=rtl] .od-PeopleCard-header{padding-left:16px}[dir=ltr] .od-PeopleCard-header{padding-left:24px}[dir=rtl] .od-PeopleCard-header{padding-right:24px}.od-PeopleCard-header--animateOut{-ms-transform:translateY(-100%);transform:translateY(-100%)}.od-PeopleCard-coverPhotoWrapper{position:relative;height:40px;background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 50% 50% no-repeat;background-size:cover;overflow:hidden;z-index:1}.od-PeopleCard-coverPhoto,.od-PeopleCard-coverPhotoColor{position:absolute;width:100%}.od-PeopleCard-coverPhotoColor{height:200%}.od-PeopleCard-coverPhotoColor-gradient{width:100%;height:100%;background:0 0;background:linear-gradient(to bottom,transparent,"},{theme:"white",defaultValue:"#ffffff"},{rawString:")}.od-PeopleCard-userPhoto{position:absolute;width:100px;height:100px;background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border:6px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:50%;top:12px;z-index:4;cursor:pointer;transition:all 267ms cubic-bezier(.175,.885,.32,1.275);-ms-transform:scale(.5);transform:scale(.5);-ms-transform-origin:top right;transform-origin:top right}[dir=ltr] .od-PeopleCard-userPhoto{right:16px}[dir=rtl] .od-PeopleCard-userPhoto{left:16px}.od-PeopleCard-userPhoto .od-Persona-image{line-height:100px;font-size:42px;transition:all 267ms cubic-bezier(.175,.885,.32,1.275)}.od-PeopleCard-userPhoto:hover{transform:scale(1) translate3d(6px,-2px,0);border-width:3px}.od-PeopleCard .od-Persona-image{border-radius:50%!important}html[dir=rtl] .od-PeopleCard-userPhoto{-ms-transform-origin:top left;transform-origin:top left}html[dir=rtl] .od-PeopleCard-userPhoto:hover{transform:scale(1) translate3d(-6px,-2px,0)}.od-PeopleCard-userPhoto .od-Persona-image{width:100%;height:100%}.od-PeopleCard-userName{max-width:250px}.od-PeopleCard-userName,.od-PeopleCard-userTitle{margin:0;line-height:1.5em}.od-PeopleCard-userTitleDivider{color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";font-size:1.3em;margin:0 .5em}.od-PeopleCard-actions{margin:8px 0 0}.od-PeopleCard-actionContainer{display:inline-block}.od-PeopleCard-action,.od-PeopleCard-action-disabled{background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:20px;padding:0;transition:color 167ms}[dir=ltr] .od-PeopleCard-action,[dir=ltr] .od-PeopleCard-action-disabled{margin-right:16px}[dir=rtl] .od-PeopleCard-action,[dir=rtl] .od-PeopleCard-action-disabled{margin-left:16px}.od-PeopleCard-action .ms-Icon.ms-Icon--Message,.od-PeopleCard-action-disabled .ms-Icon.ms-Icon--Message{position:relative;top:2px}.od-PeopleCard-action-disabled:hover,.od-PeopleCard-action:hover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-action-disabled{cursor:default;color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-PeopleCard-action-disabled:hover{color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-PeopleCard-editProfile{display:block;margin-top:10px;line-height:20px;cursor:pointer}.od-PeopleCard-editProfile:focus .od-PeopleCard-editProfileIcon,.od-PeopleCard-editProfile:hover .od-PeopleCard-editProfileIcon{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-editProfile:focus .od-PeopleCard-editProfileText,.od-PeopleCard-editProfile:hover .od-PeopleCard-editProfileText{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-editProfileIcon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";vertical-align:middle;font-size:16px}[dir=ltr] .od-PeopleCard-editProfileIcon{margin-right:5px}[dir=rtl] .od-PeopleCard-editProfileIcon{margin-left:5px}.od-PeopleCard-editProfileText{vertical-align:middle;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-PeopleCard-feed{opacity:0;max-height:0}.od-PeopleCard-feed-fadeIn{opacity:1;padding:8px;overflow-y:hidden;max-height:420px;transition-property:opacity,max-height;transition-duration:467ms;transition-timing-function:cubic-bezier(.175,.885,.32,1.275)}.od-PeopleCard-feed-scrollable{overflow-y:auto}.od-PeopleCard-contentBlock,.od-PeopleCard-contentBlock--loading{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid rgba(0,0,0,.15);margin-bottom:8px;overflow:hidden;padding:16px;position:relative;min-height:105px;transition-property:border-color,box-shadow;transition-duration:167ms}.od-PeopleCard-contentBlock--loading:hover,.od-PeopleCard-contentBlock:hover{border-color:rgba(0,0,0,.3)}.od-PeopleCard-contentBlock--loading:before{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:';content:"";opacity:1;position:absolute;top:0;right:0;bottom:0;left:0;animation-name:anim-loading;animation-duration:2s;animation-timing-function:ease-out;animation-iteration-count:infinite;z-index:1}.od-PeopleCard-contentBlock--loading:after{width:130px;height:10px;background:'},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:';content:"";opacity:1;position:absolute;top:20px;left:50%;z-index:2;-ms-transform:translateX(-50%);transform:translateX(-50%)}.od-PeopleCard-blockTitle{color:'},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:";cursor:pointer;display:block;padding:0 24px;margin:0 0 10px;transition:color .1s;text-align:center}.od-PeopleCard-blockTitle:focus,.od-PeopleCard-blockTitle:hover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-showMore{height:40px;border-top:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";font-size:12px;line-height:38px;margin:10px -10px -16px;padding:0 10px}.od-PeopleCard-showMoreLink{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer}.od-PeopleCard-showMoreLink:focus,.od-PeopleCard-showMoreLink:hover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-interactiveContentItem{background-color:inherit;cursor:pointer;margin:0 -10px;padding:0 10px}.od-PeopleCard-interactiveContentItem:focus,.od-PeopleCard-interactiveContentItem:hover{background-color:"},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:"}.od-PeopleCard-escapeValve{text-align:center}.od-PeopleCard-viewProfileLink{display:inline-block;line-height:32px;padding:0 8px;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";text-decoration:none}@keyframes anim-loading{0%{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}60%{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}100%{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}.od-PeopleCard-documentsContext{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;padding:0;border:none;background-color:transparent}.od-PeopleCard-documentsContext .ms-Icon.ms-Icon--ChevronDown{position:relative;top:3px}.od-PeopleCard-documentsContextSelector{position:absolute;top:42px;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";z-index:2;min-width:208px;max-width:90%;box-shadow:0 0 20px rgba(0,0,0,.2);border:1px solid rgba(0,0,0,.15)}[dir=ltr] .od-PeopleCard-documentsContextSelector{right:20px}[dir=rtl] .od-PeopleCard-documentsContextSelector{left:20px}.od-PeopleCard-documentsContextSelector ul{list-style:none;padding:10px 0;margin:0}.od-PeopleCard-documentsContextSelectorHidden{display:none}.od-PeopleCard-documentsContextSelectorItem{cursor:pointer;padding:5px 20px;border:none;background-color:transparent}html[dir=ltr] .od-PeopleCard-documentsContextSelectorItem{text-align:left}html[dir=rtl] .od-PeopleCard-documentsContextSelectorItem{text-align:right}.od-PeopleCard-documentsContextSelectorItem:focus,.od-PeopleCard-documentsContextSelectorItem:hover{background:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-PeopleCard-documentsContextSelectorItemSelected{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PeopleCard-documentsContextSelectorCheck{line-height:20px}html[dir=ltr] .od-PeopleCard-documentsContextSelectorCheck{float:right}html[dir=rtl] .od-PeopleCard-documentsContextSelectorCheck{float:left}.od-PeopleCard-docFeedItem{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:solid rgba(0,0,0,.1);border-width:1px 0 0 0;cursor:pointer;padding:4px}.od-PeopleCard-docFeedItem:hover{z-index:2}.od-PeopleCard-docFeedItemSelected{z-index:1}.od-PeopleCard-docFeedItem:last-child{border-bottom-width:1px}.od-PeopleCard-documentSecondaryActionsButton{display:block;position:absolute;padding:8px;bottom:-2px;font-size:16px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background-color:transparent;border:0;cursor:pointer}[dir=ltr] .od-PeopleCard-documentSecondaryActionsButton{right:0}[dir=rtl] .od-PeopleCard-documentSecondaryActionsButton{left:0}.od-PeopleCard-documentSecondaryActionsButton:focus,.od-PeopleCard-documentSecondaryActionsButton:hover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-documentSecondaryActionsPane{position:absolute;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 5px 0 rgba(0,0,0,.4);width:75%;border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";z-index:2}[dir=ltr] .od-PeopleCard-documentSecondaryActionsPane{right:2px}[dir=rtl] .od-PeopleCard-documentSecondaryActionsPane{left:2px}.od-PeopleCard-documentSecondaryActionsPane hr{border:none;border-bottom:1px solid #eaeaea;margin:0}.od-PeopleCard-documentSecondaryActionsPaneAbove{bottom:25px}.od-PeopleCard-documentSecondaryActionsPaneBelow{top:70px}.od-PeopleCard-documentSecondaryAction{padding:10px 20px}.od-PeopleCard-documentSecondaryAction:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-PeopleCard-docFeedLink{-webkit-display:flex;display:-ms-flexbox;display:flex;position:relative}.od-PeopleCard-docFeedLink:focus,.od-PeopleCard-docFeedLink:hover{background:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-PeopleCard-docPreview{width:100px;height:70px;-ms-flex:none;flex:none;position:relative;background-color:rgba(0,0,0,.04);border:1px solid rgba(0,0,0,.04)}[dir=ltr] .od-PeopleCard-docPreview{margin-right:12px}[dir=rtl] .od-PeopleCard-docPreview{margin-left:12px}.od-PeopleCard-docPreviewIcon{position:absolute;top:50%;transform:translate3d(-50%,-50%,0)}[dir=ltr] .od-PeopleCard-docPreviewIcon{left:50%}[dir=rtl] .od-PeopleCard-docPreviewIcon{right:50%}html[dir=rtl] .od-PeopleCard-docPreviewIcon{transform:translate3d(50%,-50%,0)}.od-PeopleCard-docPreviewImageWrapper{position:absolute;bottom:0;width:100%;height:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";visibility:hidden;opacity:0;z-index:1;transition:opacity .5s,transform 167ms cubic-bezier(.175,.885,.32,1.275);-ms-transform-origin:bottom left;transform-origin:bottom left}.od-PeopleCard-docPreviewImageWrapper:hover{box-shadow:0 0 5px rgba(0,0,0,.2);transform:scale(2.4) translate3d(-2px,2px,0);z-index:2}.od-PeopleCard-docPreviewImageWrapper:hover .od-PeopleCard-docPreviewIconSmall{opacity:0;transition:opacity 0s}.od-PeopleCard-docPreviewImageWrapper:hover+.od-PeopleCard-docPreviewIcon{opacity:0}html[dir=rtl] .od-PeopleCard-docPreviewImageWrapper{-ms-transform-origin:bottom right;transform-origin:bottom right}.od-PeopleCard-docPreviewImageWrapper.od-PeopleCard-docPreviewImageWrapperZoomDown{-ms-transform-origin:top left;transform-origin:top left}.od-PeopleCard-docPreviewImageWrapper.od-PeopleCard-docPreviewImageWrapperZoomDown:hover{transform:scale(2.4) translate3d(-2px,-2px,0)}html[dir=rtl] .od-PeopleCard-docPreviewImageWrapper.od-PeopleCard-docPreviewImageWrapperZoomDown{-ms-transform-origin:top right;transform-origin:top right}.od-PeopleCard-docPreviewImage{position:absolute;width:100%;height:100%;object-fit:contain}.od-PeopleCard-docPreviewIconSmall{position:absolute;opacity:1;bottom:0;padding:4px;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";transition:opacity 267ms}[dir=ltr] .od-PeopleCard-docPreviewIconSmall{left:0}[dir=rtl] .od-PeopleCard-docPreviewIconSmall{right:0}.od-PeopleCard-docPreviewDetails{overflow:hidden;text-overflow:ellipsis;width:100%}.od-PeopleCard-docPreviewTitle{display:block;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";max-height:38px;line-height:19px;margin-bottom:2px;overflow:hidden}.od-PeopleCard-docPreviewTimestamp{display:block;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";max-width:140px}.od-PeopleCard-expandedDocumentsError.od-PeopleCard-errorPanel{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKwAAACsCAYAAADmMUfYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAxpJREFUeNrs3TFq22AYgGHbkSAGQxuyCUJzCIOGLvXaoWfoTZoj9BK9QIeuzvpD7DOki1d1CcR2GlXKAUrrNpY+5XkhyIuR/OlB+fkNybiu65EUpYkRCFgJWAlYASsBKwGreGXHOlFK6WNzuDTy0Y+yLD8bw2GNj/XFwXq9vp3NZm9e+sDv7u5+Nn2bz+cf8Os52IuLixcP9vHxcbTZbKC1hg0y8MlkVBTFSdP7m5ubryYCLLTAClpgDR9aYKEFVtACK2gPqXf7sJvNZhCDbfAd9D77tL8v69sF3d/ft4dF8Lku//VJ26B9etJC23OwbWVZXkceakrpvywPoLWGtaYFVtACK2iB7VPtbkD7Ay2wIdput09beNACG6bdbve05wotsCHK8/x7+wUBtMCGqd1jhRZYaIEVtMAKWmChBVbQAitogYV20GiBhRZYQQsstNACCy2wghZYQQsstMAKWmAFLbDQxkQLLLSh0AILbSi0wEIbCi2w0IZCCyy0odACC20otMBCGwotsNCGQgsstKHQAgttKLTAQhsKbeYWdlcD53VK6aqDU6+bcy8atNMWYgvyT9F2/Y9CgO2oPM9Hr5qal5+6vI72DytPp9O/etJ2iRbYrn61Zdno7Ows3HV3jdYaVgejbde0q9XqC7AKgfb8/PxkPB6/BVYCVsBKwErAaiDZh32mqqoK/xn6uE8M7PO0GADYJbAvpLIsr6N/hpSSNawErICVgJWAFbASsBKwAlYCVgJWwErASsAKWAlYCVgBKwErAStgJWAlYCVgBawErASsgJWAlYAVsBKwErACVgJWAlbASsBKwApYCVgJWAErASsBK2AlYCVgBawErASsgJWAlYAVsBKwErACVgJWAlbASsBKwApYCVgJWAErASsBK2AlYCVgBawErASsgJWAlYAVsBKwErACVgJWAlbASn0s6+NFpZTeuTUKAfb09LQ9LN0ahQBbFIW7ImtYASsBKwErYCVgJWA1pI66D1tVlYkPqIeHh+GC3e/3Vw3YS7d5cN0e82Tjuq6NXNawErAC1ggErPRM/RJgAOYCqmwINSIgAAAAAElFTkSuQmCC)}"}])});define("Rv",[],function(){return'<div class=od-PeopleCard data-bind="css: { \'od-PeopleCard-fadeIn\': fadeIn() }, event: { mouseleave: mouseLeftCard }, template: { afterRender: $component.afterRender.bind($component) }"><div class=od-PeopleCard-coverPhotoWrapper data-bind="click: coverPhotoClick, clickBubble: false">\x3c!--ko if: coverPhoto()--\x3e\x3c!--ko if: coverPhoto().isColor--\x3e<div class=od-PeopleCard-coverPhotoColor data-bind="style: { backgroundColor: coverPhoto().colorValue }"><div class=od-PeopleCard-coverPhotoColor-gradient></div></div>\x3c!--/ko--\x3e\x3c!--ko if: !coverPhoto().isColor && !!coverPhoto().url--\x3e<img class=od-PeopleCard-coverPhoto data-bind="imageLoader: { src: coverPhoto().url, isLoaded: isCoverPhotoLoaded, scenarioName: \'peopleCardCoverPhoto\' }">\x3c!--/ko--\x3e\x3c!--/ko--\x3e<button class=od-PeopleCard-closeExpandedView data-bind="click: closeExpandedViewClick, css: { \'od-PeopleCard--closeExpandedViewActive\': animateBackButton() }"><span class="od-PeopleCard-iconGoBack ms-Icon ms-Icon--Back" data-bind="icon: true"></span> <span class="od-PeopleCard-userName od-PeopleCard-nowrap ms-font-l ms-fontWeight-semilight" data-bind="text: personData().person.name"></span></button> <button class=od-PeopleCard-backBtn data-bind="click: backClick, css: { \'od-PeopleCard-backBtnEnabled\': $component.backEnabled() }, attr: { \'aria-label\': strings.backButtonLabel }"><span class="od-PeopleCard-iconGoBack ms-Icon ms-Icon--Back" data-bind="icon: true"></span></button></div><div class=od-PeopleCard-userPhoto tabindex=0 role=img data-bind="event: { click: userPhotoClick, mouseenter: $component.userPhotoHoverStart.bind($component), mouseleave: $component.userPhotoHoverEnd.bind($component) }, clickBubble: false, attr: { \'aria-label\': personData().person.name }">\x3c!--ko if: isBasicDataReady--\x3e\x3c!--ko component: {\r\n name: personaImageTagName,\r\n params: personaImageParams\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class=od-PeopleCard-cardContentWrapper><section class=od-PeopleCard-contentOverlay data-bind="css: { \'od-PeopleCard--active\': animateOverlay() }, style: overlayStyle"><div class=od-PeopleCard-expandedContent data-bind="css: { \'od-PeopleCard--active\': fadeInOverlay(), \'od-PeopleCard--scrollable\': fadeInOverlay() }">\x3c!--ko if: hasError()--\x3e<div class=od-PeopleCard-errorPanel><span class="od-PeopleCard-errorHeader ms-font-m-plus" data-bind="text: strings.errorHeader"></span> <span class="od-PeopleCard-errorSubHeader ms-font-s" data-bind="text: errorMessage()"></span> <a href=javascript:; class="od-PeopleCard-errorRetry ms-fontColor-themeSecondary" data-bind="text: strings.errorRetryButton, click: retryClick"></a>\x3c!--ko component: { name: errorDetailsTagName, params: {} }--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: !hasError()--\x3e\x3c!--ko if: activeExpandedView() === 1--\x3e\x3c!--ko component: {\r\n name: orgChartTagName,\r\n params: {\r\n personInFocus: personData,\r\n managerChain: managerChain,\r\n directReports: directReports,\r\n navigatePersonCallback: $component.navigatePerson.bind($component),\r\n retryCallback: $component.showOrgClick.bind($component),\r\n selfClickCallback: $component.closeExpandedViewClick.bind($component)\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: activeExpandedView() === 2--\x3e\x3c!--ko component: {\r\n name: expandedDocumentsTagName,\r\n params: {\r\n documentSet: recentDocumentsExpanded(),\r\n isDocumentsDataReady: isDocumentsDataReady,\r\n availableContextTypes: availableContextTypes,\r\n scenarioContextType: scenarioContextType,\r\n personName: personData().person.name,\r\n isMeCard: isMeCard,\r\n changeContextTypeCallback: $component.changeScenarioContext.bind($component)\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class="od-PeopleCard-escapeValve od-PeopleCard-escapeValveExpanded" data-bind="css: { \'od-PeopleCard--active\': activeExpandedView() }"><a class="od-PeopleCard-viewProfileLink ms-font-s ms-fontWeight-semibold" data-bind="text: expandedLinkText(), attr: {\'href\': expandedLinkUrl(), target: \'_blank\', rel: \'noopener noreferrer\', tabindex: $component.isOverlayDisplayed() ? \'0\' : \'-1\' }, click: $component.logProfileExpandedClick.bind($component)"></a></div></section>\x3c!--header--\x3e<section class=od-PeopleCard-header data-bind="css: { \'od-PeopleCard-header--animateOut\': activeExpandedView() }"><div class="od-PeopleCard-userName od-PeopleCard-nowrap ms-font-xl ms-fontWeight-semilight" data-bind="text: personData().person.name"></div><div class="od-PeopleCard-userTitle od-PeopleCard-nowrap ms-font-s ms-fontColor-neutralSecondaryAlt"><span data-bind="text: personData().person.job"></span> <span class=od-PeopleCard-userTitleDivider data-bind="style: { opacity: personData().person.job ? 1 : 0 }">•</span> <span data-bind="text: personData().person.department"></span></div>\x3c!--ko if: isMeCard()--\x3e<a class="od-PeopleCard-editProfile od-PeopleCard-nowrap" data-bind="attr: {\'href\': editProfileLink, target: \'_blank\', rel: \'noopener noreferrer\', tabindex: $component.isOverlayDisplayed() ? \'-1\' : \'0\' }, click: $component.logEditProfileClick.bind($component)"><span class="ms-Icon ms-Icon--Edit od-PeopleCard-editProfileIcon" data-bind="icon: true"></span> <span class="ms-fontWeight-semibold od-PeopleCard-editProfileText ms-font-s" data-bind="text: strings.improveProfileLabel"></span></a>\x3c!--/ko--\x3e\x3c!--actions--\x3e\x3c!--ko if: !isMeCard()--\x3e<ul class="od-PeopleCard-actions od-PeopleCard-resetList"><li class=od-PeopleCard-actionContainer><a data-bind="class: hasError() ? \'od-PeopleCard-action-disabled\' : \'od-PeopleCard-action\', attr: {\'title\': sendImText, href: \'sip:\'+ personData().person.sip, tabindex: $component.isOverlayDisplayed() ? \'-1\' : \'0\' }, click: logStartChatClick"><span class="ms-Icon ms-Icon--Message" data-bind="icon: true"></span></a></li><li class=od-PeopleCard-actionContainer><a data-bind="class: hasError() ? \'od-PeopleCard-action-disabled\' : \'od-PeopleCard-action\', attr: {\'title\': sendMailText, href: \'mailto:\'+ personData().person.email, tabindex: $component.isOverlayDisplayed() ? \'-1\' : \'0\' }, click: logSendEmailClick"><span class="ms-Icon ms-Icon--Mail" data-bind="icon: true"></span></a></li></ul>\x3c!--/ko--\x3e</section><section class=od-PeopleCard-feed data-bind="css: { \'od-PeopleCard-feed-fadeIn\': fadeInFeed(), \'od-PeopleCard-feed-scrollable\': scrollableFeed() }">\x3c!--ko if: hasError()--\x3e<div class=od-PeopleCard-errorPanel><span class="od-PeopleCard-errorHeader ms-font-m-plus" data-bind="text: strings.errorHeader"></span> <span class="od-PeopleCard-errorSubHeader ms-font-s" data-bind="text: errorMessage()"></span> <a href=javascript:; class="od-PeopleCard-errorRetry ms-fontColor-themeSecondary" data-bind="text: strings.errorRetryButton, click: retryClick"></a>\x3c!--ko component: { name: errorDetailsTagName, params: {} }--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: !hasError()--\x3e<ol class="od-PeopleCard-feedContent od-PeopleCard-resetList">\x3c!--ko if: isMeCard()--\x3e\x3c!--ko if: !activeRecentDocs().failed--\x3e\x3c!--ko component: {\r\n name: recentDocumentsTagName,\r\n params: {\r\n documents: recentDocumentsSummary(),\r\n showMoreDocumentsCallback: $component.showMoreDocumentsClick.bind($component),\r\n personName: personData().person.name,\r\n noDocsLink: personData().person.profilePage,\r\n isDataReady: isDocumentsDataReady,\r\n scenarioContextType: scenarioContextType,\r\n isMeCard: isMeCard,\r\n isKeyboardNavigatable: !$component.isOverlayDisplayed()\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: activeRecentDocs().failed--\x3e<div class="od-PeopleCard-contentBlock od-PeopleCard-errorSection od-PeopleCard-errorSection-docs"><div class="od-PeopleCard-errorSection-inner ms-font-s"><span class=od-PeopleCard-errorHeader data-bind="text: strings.errorDocs"></span> <a href=javascript:; class="od-PeopleCard-errorRetry ms-fontColor-themeSecondary" data-bind="text: strings.errorRetryButton, click: retryClick"></a>\x3c!--ko component: { name: errorDetailsTagName, params: {} }--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !manager().name && (managerChain().failed || directReports().failed)--\x3e<div class="od-PeopleCard-contentBlock od-PeopleCard-errorSection"><div class="od-PeopleCard-errorSection-inner ms-font-s"><span class=od-PeopleCard-errorHeader data-bind="text: strings.errorOrg"></span> <a href=javascript:; class="od-PeopleCard-errorRetry ms-fontColor-themeSecondary" data-bind="text: strings.errorRetryButton, click: retryClick"></a>\x3c!--ko component: { name: errorDetailsTagName, params: {} }--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if: !managerChain().failed--\x3e\x3c!--ko if: !!manager().name || !isManagerDataReady()--\x3e\x3c!--ko component: {\r\n name: reportsToTagName,\r\n params: {\r\n manager: manager,\r\n navigatePersonCallback: $component.navigatePerson.bind($component),\r\n showOrgCallback: $component.showOrgClick.bind($component),\r\n isDataReady: isManagerDataReady,\r\n isMeCard: isMeCard,\r\n isKeyboardNavigatable: !$component.isOverlayDisplayed()\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !manager().name && !!directReports() && !directReports().failed && directReports().directs.length > 0--\x3e\x3c!--ko component: {\r\n name: staffTagName,\r\n params: {\r\n directs: directReports,\r\n navigatePersonCallback: $component.navigatePerson.bind($component),\r\n showOrgCallback: $component.showOrgClick.bind($component),\r\n isDataReady: isDirectsDataReady,\r\n isKeyboardNavigatable: !$component.isOverlayDisplayed()\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !isMeCard()--\x3e\x3c!--ko if: !activeRecentDocs().failed--\x3e\x3c!--ko component: {\r\n name: recentDocumentsTagName,\r\n params: {\r\n documents: recentDocumentsSummary(),\r\n showMoreDocumentsCallback: $component.showMoreDocumentsClick.bind($component),\r\n personName: personData().person.name,\r\n noDocsLink: personData().person.profilePage,\r\n isDataReady: isDocumentsDataReady,\r\n scenarioContextType: scenarioContextType,\r\n isMeCard: isMeCard,\r\n isKeyboardNavigatable: !$component.isOverlayDisplayed()\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: activeRecentDocs().failed--\x3e<div class="od-PeopleCard-contentBlock od-PeopleCard-errorSection od-PeopleCard-errorSection-docs"><div class="od-PeopleCard-errorSection-inner ms-font-s"><span class=od-PeopleCard-errorHeader data-bind="text: strings.errorDocs"></span> <a href=javascript:; class="od-PeopleCard-errorRetry ms-fontColor-themeSecondary" data-bind="text: strings.errorRetryButton, click: retryClick"></a>\x3c!--ko component: { name: errorDetailsTagName, params: {} }--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e<li class=od-PeopleCard-escapeValve><a class="od-PeopleCard-viewProfileLink ms-fontWeight-semibold" data-bind="text: moreAboutText(), attr: {\'href\': personData().person.profilePage, target: \'_blank\', rel: \'noopener noreferrer\', tabindex: $component.isOverlayDisplayed() ? \'-1\' : \'0\' }, click: $component.logProfileClick.bind($component)"></a></li></ol>\x3c!--/ko--\x3e</section></div></div>'});define("Ru",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-PeopleCard-resetList{list-style:none;margin:0;padding:0}.od-PeopleCard-nowrap{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-PeopleCard-personToggles{margin-top:30px;text-align:center}.od-PeopleCard-personToggles .od-PeopleCard-personControl{width:42px;height:42px}.od-PeopleCard-errorPanel{min-height:150px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKoAAACsCAYAAADrLzefAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAdHElEQVR4Xu2dCbR2VVnHZQYZRAEtFBxSNAcyxQTXCgKHcgDUlCVoLi1bKVAROSAisXAOSRJMBTXCgaEVmilOWWYyz3xMH4NBmZCh5jwg3P6/fZ/3ruee73nfs8873fOes/9r/Rf6fHfvfZ69/+8enr3PPvdZWloqLGw9Q2NhYdsYGgsL28bQWFjYNobGwsK2MTYWjI0LLrhgI/G+9n8LxkCoydBYsAKJbnNxd/Eg8UjxXeLHxH8WbxBvE78r/p+4VOHPROx3ivzdJeKnxQ+IfyH+kfhM8cFWXIEQajI09hQSzP3EZ4vHi+eKN4q/EKsCnAUR9PniaeJhIj+Oje3ReoVQk6GxJ5AQthdfJL5XvFK8R9xARBdddNHSZZddtnTllVcuXX311Uvr1q1buv7665duvPHGpfXr1y/ddNNNSzfffPPSLbfcknjrrbeu/G/+DfJ3N9xww9J11123dM011yxdddVVS1dcccXSJZdcsnThhRduUKbxO+JnxDeITxF7IdxQk6Gxw1Bj7yoeLjJ03y2uEgfCQZDXXnttEhYCRHizJmJG/Ij48ssvTz+O6rOJ3xQ/KNLrb2EudQ6hJkNjx6BG3Ulkfnm5uKrxESa9GyKZlyhzSS/MD4aeNxDuD8Qzxd8WO9XThpoMjR2AGm9TcX+RueaqnpNhnOGbXiwSSFtJD8+P6uKLL/aChf8lvkX8FXN/oRFqMjQuMNRYzDuPFhkmVxrz0ksvTb3TYA656KS3RbRBT/sF8ZlWHQuJUJOhcQGhxmHu+R7xh2JqNBqRxc+i9ZxNybSFee3Ab+NV4kvFTa2KFgahJkPjAkEN8UjxdHEljETvyeo6atQukx8kvWwlivCf4qvFzazKWo9Qk6FxAaCKf5D4fnFl/kmvwjwuasQ+kekN0YPKtOAW8RBxI6vC1iLUZGhsMVTRW4pvEln1pkZgccScLWq0aZPIAGUx3DLnRRBML+jJCGt5YoOD2Cu9PLFXer55zJUpg3IrgmV37GlWna1EqMnQ2FKogp8j3moVnob4WfWgNDJ509CIjrJGBObHIqt3RgGEjIhn9WMb9LCV5/+I+ECr2lYh1GRobBmoUPEcq+DUwNOeg9KY9JL0gIhyUFZA9u/Zt79Q5JlOEd8qHif+uXiE+Br7L9EH7O8WEcbnxWvEb4lR3qn3Q7z8QKYtXEYDfnSuvG+Lr7Bqbg1CTYbGFkEVebBVaKpchDStYZOGY/hm6jCkt7xOPEM8Snyu+DBxKnM85bONyLboK8W/EgkrfU9c9Qz8KPF5miMH0w82Olw5XxRbczAm1GRobAFUcQ8Qz7KKTL0cFRxVfBMi8oE4B3k7Xi2eJP6uuJM9ytygMjcRnyzSG39KXCVceltEO416gJXpACfADrZHWVOEmgyNawxV2F4iYZVUiVRoVNFNSOMy7FV6Tg6hfFVke/XhVnxroGfiiCFbpBwLXLWBQY/I9GDSbV8WdpWpDlOUre0R1gShJkPjGkKVhGhSyInGmHSexrwzmHMypDOffJAV23roWTcW9xb/TvyRmHzhh0cvO+mmBp3BIE+R+nm0FT13hJoMjWsAVczW4spQz0GMSeaiDO+VedhPRM567mlFLizkw7biq8RVh2yos0l+2Iw6LpRF+O8AK3KuCDUZGucMVcjO4hVWQUlkUUXmkB60ItC7RA5Cz33OOQ/Ir/3E88QVn5nijNvDMpWozN+PsqLmhlCToXGOUEU8UfxvKoVf87gLBdJVhnhe//hTcU3nW/OC/HyCeLaY/GdKQHx23FGJ6cQgL5F569y2YENNhsY5Qc7vK36fyqAXHKcXCGKDHEo5VtzGiukV5DdRAw6Fp/rgxz9uzJmRbZCP+DlxLi8thpoMjXOAnD5A/DmVwFAzzi+fBnBzqntF9v5budsyb6geeGnwejHVD5sI43QExG9dpOQi8X5WxMwQajI0zhhyluNnSaTjLJroRSvH2oh/LvwiadpQnRDeOkb8qZgEN878v7LIYgE30/l+qMnQOEPISUSaXqJjyI4qZhT5hbtK+7H4WnHhzlzOE6ofjkJ+WUz1RufQNP5KNMHV+zpxR8t+6gg1GRpnBDnHcD+2SCsTfHrRx1rWBTVQXXExxp+JnFVIW7NNF65MHZxYLxZnMg0INRkaZwA59QwxDfdNRRqETDjJ39m3MGcJ1duvi1yckeqy6VSgIlZ29aa+wAo1GRqnDDnDSjSdH2XYiSpgGBly3Mts7H3vb9kWjAnV4X3Fj1udppEqqvthpE3cAoszCZtY1lNBqMnQOEXICd5lugOnmq7uCd67CrlZfIxlWzAFqD652CJNxZq2DdMG1zYnW5ZTQajJ0DglyAGOsnH+MsVJm1REJYb3JfH+lm3BFKF6fZ64EstussiiIyGd8XDLcmKEmgyNU4AenMk779SnOU2TCqiI9KPiVIeWgtVQ/XLPVTrMzTSrSbyVE1ykE3m5cl/LciKEmgyNU4Aemvea0vDQZHVZOcVzstj6l9G6ANUzIazbqfemYnU7g/8r7mpZjo1Qk6FxQuhh9xHT3KfJqrLSk77FsiuYE1TnDxG5wbCRWJnSuXMWvKIz0bmAUJOhcQLoIbnnKR3ybRKGqoj0WMuuYM5Q3dN+vFqdxJo7ZauErU6w7MZCqMnQOAH0kFxU22jxVJmUv8uyKlgjqA3oWb9Oe9BTjtGOnLvYz7JrjFCToXFM6OE4zJvmpbkHeCsxuQ+LZU7aAqgdmLMy50znKqK2i+h2D7m4bXvLrhFCTYbGMaCH2kVMQX1WgpETVTKsuGA+b0KW1X2LoPZ4qpgOtHC2NWrDKul93cH1D1tWjRBqMjSOAT3UZ3k4horIgSpxyG2LrhfH+vUVzBZqFw4RpXbKPddKlGeQRmx8s2CoydDYEHqYFw8eLHfId0MEr+mu2YtkBfVQ+7yTtmoypXMhK2622dKyykKoydDYAHoIXjT7Bg+VOzxUFk+/Y1kVtBRqI96A5YR/9iKZv3FRgOMsqyyEmgyNDaCHeAcPw1wzxwHmpc6BEy2bgpZDbcW1SryHln2IhamCtTNvAD/UsqpFqMnQmAkVzhU3abJNLxk9bJVuXspbp5tbVgULALXXs6ztxmnvMy2bWoSaDI2ZUOGf4CF4mOghq3RBfV7A282yWVjIh8FlaLnswp0CXPiWPYJWFlZPsWxGItRkaMyACuX1XAK7WXv5lSH/SMtmoSE/oq/1jWKjuVobIR+4n5Yjl9lTAM4gm/9ftGxGItRkaMyACuXAbPZBaPewvBzWiXip/EhCZYVLow2j2wdfeKEC+fF08yerk2J7dfD34j6WzVCEmgyNNVBhvyqm3jTn4AIv5NlDchTsyZbNwkO+JKHWDYFEQ8z/TggVyBe+m5AdN+cHa3VwnmUxFKEmQ2MNVBhbndm9qetR3mtZdALyp89C3XHgf85GQKVXfYJlEyLUZGgcARXCPVHpJb2cbt+FKHBqZq/YrgXMp14KFcif1+FX7sLKTf8+almECDUZGkdAhfwlheWs9Hl4t5f/JsuiM5BPfRfqVmK6xzbnfAe7WlYPd4tDD1iHmgyNQ6DMWfGlxsmJo7lwFJegbWXZdAaDuuirUIF8egW+EdHJ6VVdXPXtlsUGCDUZGodAmacDCvSS0UNU6XrTQy2LTkF+FaEub69yqCirV3Xb5xyuD6M/oSZD4xAo43QtTM5V5W5uypnGzvWmQH71XqhAfv0h/uV2YC6e/jzLYhVCTYbGAMr0EWIKSeW8nuBW+m+2LDoH+ZaEyooWsQ5jD4S6hZjubsiJALj6ONeyWIVQk6ExgDLlM9tZp73dthlbpTtYFp2DfEtCbcBOChXItzfiY05ctbKo2uCa0FCToTGAMkzbZjm/GHcW8VRL3knIvyJUg3zjc0vpAracM6tuxH2NZbGCUJOhsQJl9jgy5eAsQ1lU8ID8u3sHKusQQkE3oPY+k3ZnFyrShqe7uOILlnwFoSZDYwXKLF0mkTPsu5DUOkte0BOozbmxMStU5Xaq2DxadX1lqMnQWIEyupRMEWFUqKfr0o+w5AU9gdqcUNV/0P45U0T3EuAhlkVCqMnQ6KBMeMc7ZVi32uff7W+5JaXcpd9DqN35gHHWORC3+j/HkieEmgyNDsrkD8gsZ8vUDfv/bskLega1PXfhZq1nXHToO+JK8D/UZGh0UAbpwlfUHxXm6bbHOnEwuqA51Pbc4pj2/3O+iO0W3ntYFrEmQ6ODMkiB3LpC+fVYgbB1H8AtmB/U/u9FBzl3j7mv27zWkseaDI0GJeblvZRRXTfu9nCvteQFPYU0kFb/OVuq7prRlV2qUJOh0aDEB5NJzm6DO8F9iiXvPOQr0yJeycnlSyxppyE/+UZAOrNc9waIm6feYcljTYZGgxKfQCY5AVwXlnqRJe885GvZmRoC+Qpqw1SVKePOpA01GRoNSpi+WlwXP60UtjDfwJ8U8jUJlV0W6mgY3TysT0JN1wDlzFNdPDXdUxVqMjQalDCt3upeOXEv7623pL2A/E1CrZu/d/30VAT5+mx8RoRRnXi6V1TSJlGoydC4XNB2lri2Idy+7dkpcU8gf4tQh0C+Pth8DuvE0y2oTiNtqMnQuFzQniTOWbm501K9utJc/hahjoD8JZBfe5rKRYzOJ12oydC4XMjLSZxzEMUtpJ6fEvcE8rcIdQTkL5+grF1QufOp3yJdqMnQuFwIX3XLmgy73YVHpcQ9gfwtQh0B+fs+/Mb/qF4GpP6sfuDmoSZD43IhJzUshNdUevU5cvlbhDoC8pdP1Dft7HYNNRkalws5m4SEV6KMB3Td9p0pYY8gn4tQR0D+pg2jnANN7o3lPUNNhsblQr5Gwrr3911o6vKUsEeQz0WoIyB/98bvnBCVO9D0wlCToXG5kPSOVF0MlYmyFfCZlLBHkM9FqCMgf3fDb078R/Xi6WKph4aaDI3LhaRgf11owcVQx/pUyyJDPhehjoD83d78DuvF04U4jwg1GRqXC0mNUHeowDXCSSlhjzCooyLU4TC/a+vIHWo6NtRkaFwuIH3crO71E9cIE33/chEhn4tQayCf06UlDYR6XKjJ0LhcQErYpICUsEeQz0WoNRjUUZOROdRkZNQfb2qJmgj1jfZsvYF8LkKtgXy+C9/rhOr2+xsJlddeU8IGQu3c/ad1kM9FqDWQz2m/fyZCtQJSwgZCLUP/EJahv9HQf2KoydC4XMD3SNhgMdW7r/DJ5yLUGpjfjTq8UJOhcbmArF+C77JTwh5hUEdFqDHkL69OJ98bCPWYUJOhcbmQ20jYIOB/ekrYI8jnItQRkL/c8Jd8j+rFc5KAf7ruusEW6udSwh5BPhehjoD8fQx+N9xCfXWoydC4XMhXSNjgUMo1KWGPIJ+LUEdA/u6H3zmHUtzh+wNCTYbG5ULSXZcM7VHGA1ZPZ/cJ8rkIdQTk7yH43fCY32+EmgyNy4WkrwhTyVHGA9JIVgDs1WfN5W8R6gjI39fjd8OD0zuHmgyNy4Vkn852X7l4XErcE8jfItQRkL+n4jeRoaheBnSdXXpLJNRkaFwuJPt0tjv0elBK3BPI3yLUEZC/5+N33TrHTR/TtT6hJkPjciFPInHOis3FwI5PiXsC+VuEOgLyN20a1cXiXeToK6QLNRkalwvhoqusI1q8V2UFfTIl7gnkbxHqEMjXXfGZuWdUJ56uft5H2lCTodGghLeQQV0s1d3Idrsl7QXkbxHqEMjX/fE55yZIdzfXYaQNNRkaDUrIVYm1b6LSUG7V9jBL3nnI1yLUIZCvKWrEtDCqE093SdpvkTbUZGg0KOHbyCBn5e8Cti+z5J2HfC1CHQL5ehk+N7x28gGkDTUZGg1K+EIyyNlZcI3xIUveecjXItQA8pML9vgyTu3pO7ezeZsljzUZGg1K/MuWSZMCb7XknYd8LUINID+fi78NO7gzLXmsydDooAzSB67qYmE0lpunPt6Sdxryswg1gPz8IP7mzE9dDP5wSx5rMjQ6KIMPkRGVHRXk6VZvnf30uYf8LEKtQD7yGtP/4C+jbFQfAw7r3EJNhkYHZZAOFuSEGVzgthfX+8jPItQK5ONv4mvORpELa666tyzUZGh0UCY7iFkTY/7dCoYPtSw6C/lYhFqBfDwRX3MiRW5H828teUKoydBYgTJKZ1PrjvxBN+fo/PAvH4tQHeTfZuKd+Fq3poHuaN+BlkVCqMnQWIEyOoIMcw6ouOGfRdjGlkUnIf+KUB3k34H4mTPsu4MoPxa3siwSQk2GxgqUUfYX/Ph3d+zv6ZZFJyH/ilAd5N8/4Sf+RvXg6V4K3eB8SKjJ0BhAGV5FxnXbqdDNPVZiY12E/CtCNcg3voLyC/ysOy0F3bbpyy2LFYSaDI0BlOHryDhn+Hfd+t3iLpZF5yDfilAN8u0d+JijD7faZ9jfzrJYQajJ0BhAGf6SiPCyfjFuUdXZiynkWxGqIL+2FdPZ05xFlHs1+gzLYhVCTYbGIVDG/0gBOXMQt6X6I3F7y6JTkF9FqIL8SqNtzpYpdeWC/PtYFqsQajI0DoEyPoACclZ10J2oOtqy6BTkV++FKp+2EL+Jf3UnpaCLCnHWeSPLZhVCTYbGIVDGXEd5BwU1fCiGhXSEq0uQT0WoF1xwJL7lfOERus5r6DWloSZD4wiogKMpKGdLFbrVXefmqvKp10KVP9zRn66VzOm4KtPBHS2bDRBqMjSOgArg4X5IgXWHDqB7uJ+JndpWlT99F+q78CtnbgrdoaWTLYsQoSZDYw1UUNrPzQlFQBcB+IRl0QnIn94KVb6wCfRT/MrpsFzIkljryNeVQk2GxhqooF3En1Nw3Yt/0D0kfKZls/CQL30W6nn4lNtZuUvQajurUJOhMQMq8PQmD+p2q74urtrbXVTIjyRUhrRRdPP0TghVfrwEfwgz5cTUXUfF6/dPtGyGItRkaMyACnyomHrVnCAvvY47LfNOy2ahIT+SUBtw4YUqH1ijpIPRdVf1DOimfmdZNiMRajI0ZkIFn8wD5E6mEbQ9MPOUPS2bhYV84N2g5zfgYyzpwkI+fFzMbnO3mKbNd7NsRiLUZGjMhAreSUy9Ss5hFejmKhwD3GCft6C9UHv9nrVd1toEumnPyJW+R6jJ0NgAeoB06x+7VXVvAMDKFKBTUYAuQ231SDGFJXOHfHdt/nfFHSyrWoSaDI0NoAfgVPf1PFDO6wfQnZ6Bv29ZFbQUaqMtxUtpr9zFM52W29NPV/XkItRkaGwIPci+9kBZMTXoDs6yIHuaZVXQQqh9Pkpb5Y6akGiHtS83pmxiWWUh1GRoHAN6mBSuYk5SF1cc0M1XWUXualkVtAhql6OsjbI7ocqi+UmWVTZCTYbGMaAHImyRXuwiwB05UCWCdpNt3iDY2rIraAHUHtzIl64ezV0s0+O6V5Heblk1QqjJ0DgmzLH0kLm/PgLGzrHPi736DkBboXbYS/wJ7ZJz48mAbshfJ25p2TVCqMnQOAH0cOk6F1b2ufMZFldu4v0JsdGcpmC6UP0/QUynohBe1GYR3YXOHED6NcuuMUJNhsYJoAfcRryRB27ipAsMwzPE8FBtwWyhen+c+G3agaOcuesNtkldZ3OEZTcWQk2GxgmhB+UXmYaN3JgbdJNwyEqz9KxzhOqbdmssUkZOFxv/pDhRJxNqMjROAXrYV9iDZ50FGLAi1rPFMmedA1TPe4iNRQrdXj6vl9zfshwboSZD45Sgh05nATQk3MvQEDkZsSLWL4nbWpYFM4Dq91kip+4bi9SdimPXairXjYaaDI1Tgh6cXasv40iTxRVkzurmPNeJD7dsC6YI1ethYroEj56xiUjdFikhrBdYlhMj1GRonCLkAPHVG3CoyWYApBd2oSv2i/e1bAsmhOpyczFFaCDb303apjLqvc6ynQpCTYbGKUOOPFxMr9Q2/dXSCzMcWYWw0/HHYokITADVH1fef1VM9ZpzS6NnJUJzimU7NYSaDI0zgBxiRZlu02gqVv7W3a4BuQhj6FuMBcOhemNTJi2amFrlbswMaFOytFslniNOPTITajI0zghy6qliEisx1iZihfzy3byV7drOvH81a6iuOAF1itVdGqVyXiPxtI2ZgUg/Lc4kIhNqMjTOEHKOk1ZcjtW4Z4XMW935ACrtA2InrwyaFlQ/+4g3ianecs9ieFZ6UhbIMwsbhpoMjTOGnNxbTD1r03AI5O9dWAR+S3yJZV9gUJ1wrf1HrI7SwrTpUA9ZOFV60vtaETNBqMnQOAfIWaYBaT+ZHrLpMAQZilzvCr8g7m5F9BaqA65eerWY5qKQH3bTDgG6/Xt4rjjzDZhQk6FxTpDTjxW/QSXo135v7ns4VbJN6+au/PI5K9C7863yeSPxRWL62DLkhzxuvbr7CCChrLlsaYeaDI1zhJx/iJhus2Z4ybnDKCI9sjuIDTnB89di5wUrH/m2EzctptdFIMN87hnSKul53XE9eIwVNReEmgyNc4YqgotgPzOomHEm+wOy2HJ7z5Bdl4+JYx87ayvkE1c+vkpcWSgxsjDCjDPMw8pilYNFc5/7h5oMjWsAVcgm4tutgpLYmmy5VsmiodIrwH8VXyqOdaC3LdDz7yZyFTmLyOQbPSg/8EnqjNHMLZpuF/ewIueKUJOhcQ2hynmBmCICzFubnLyKSA9RmRLA74vvE1nQLcQul56TrehXil8TV3zhDAXx5XF7UEjayoYKB4F2sqLnjlCToXGNoUp6hHiJVVrjfeiI9DQMie7c5IBcTEwg/OniZvYIrYCehy+NHCoiHLaPV56b0WLSHzFk5FGdDHpRpknHiGv6fbBQk6GxBVBlcfKKqUA62TON3nVAGgfxM1ySt+MPRObKXKqxp7ipPc5coPL4oMeLRX4414qrno+YM73nJMP7gORR6UWJFLTitfVQk6GxRaDyxPVWmaknGSfmOoyIlhhjIFrIDho4TfwTcT+RKMVEAlb67cTdRW7Fe6v4KTF9br5K5uqIc5o+Mxflh+/K+RtxG3u8NUeoydDYMqgS2adm8ZCGPyb8k6xsh5H5LKJgTjtEuAPSyHeJhNW4J5Q3EbjX4P3iSY7sCmFHiJxWulVMl98OI70miyJGj1n4V4mIEC0Iv0yylgg1GRpbClXq48V/s0pOvcK4scIc0oshGH4UiJewjdtYmIj8EBANvTk+EJSftjAHDGLMhJ3eLG5hVdsqhJoMjS2GKpfdF4bM28RU8RLQ1OavOURQ9E5MGxhGERo9MaQ3hIib/8+/QZ4PMU5jfplLyrIzEX6YP0ts9dsSoSZD4wJAlc10gA9xMQSvCBZRzKpnWhTSg7JQcjFRyKfs97LqazVCTYbGBYIqn4XJceLKAQymBPRo8+y92kB67GCTg7jrQp3bDTUZGhcQaoytxcNFv3q+l7kZQ3TUsF0gP0amGIwm3m/xH8SF6EGrCDUZGhcYahyOuB0kXiQOGi71sswdmVtGDb5IZGrDnNd6Ty9Q4sAcJH+UVcdCItRkaOwI1GBcT/NuMX0cYUB2YlhkLFJPS8/J/BtxVuaekNAX26utiYVOglCTobFjUAOyy3Wg+Pdiut57QDX6PTQ+w+e45zZnQYRJr8kPyr2F68kr6OzcLXTvGSHUZGjsMNSwHI17jniqmD5A7ElvNa/45oCs0und+bGwWq/MNwfEBl4vPtrc6SRCTYbGnkANzoFj7lwizMXdrEO/G6Xpwj0ImMUZIiaqQAyVXg+RIWjmvxDh8V9s/Bvk7xA+82TESC9OT0mPHpVnZOuY7Vvixg+0x+48Qk2Gxp5CYkC4vB7DBW8niJ8VVzYWZkjOFFwh8goNV5HT42d/RaRrCDUZGgtWQaLhzld6Xl734KW540WmDpy0IpDOKyDs+3MCCWFz6Jj/cgIKO7HMfxHZFXqP+AbxZeIzRI40rumxurYh1GRkLCxsG0NjYWHbGBoLC9vG0FhY2DaGxsLCtjE0Fha2jaGxsLBtDI2Fhe3i0n3+H22Nlx55ajZBAAAAAElFTkSuQmCC);background-position:50% 50px;background-repeat:no-repeat;background-size:100px;padding-top:160px;text-align:center}.od-PeopleCard-errorSection{position:relative;text-align:center}.od-PeopleCard-errorSection-inner{position:absolute;top:50%;-ms-transform:translateY(-50%);transform:translateY(-50%);width:290px}.od-PeopleCard-errorSection-inner>.od-PeopleCard-errorHeader{margin-bottom:6px}.od-PeopleCard-errorRetry:hover{cursor:pointer}.od-PeopleCard-errorRetry:before{font-family:FabricMDL2Icons;content:'\\e895';font-size:12px;position:relative;top:2px}[dir=ltr] .od-PeopleCard-errorRetry:before{margin-right:6px}[dir=rtl] .od-PeopleCard-errorRetry:before{margin-left:6px}.od-PeopleCard-errorHeader,.od-PeopleCard-errorSubHeader{display:block;margin-bottom:4px}.od-PeopleCard-errorPanel .od-PeopleCard-errorRetry{display:inline-block;margin:16px 0}.od-PeopleCard-contentBlock.od-PeopleCard-errorSection.od-PeopleCard-errorSection-docs,.od-PeopleCard-errorSection.od-PeopleCard-errorSection-docs.od-PeopleCard-contentBlock--loading{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkQAAAC7CAYAAACEu4G/AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTExIDc5LjE1ODMyNSwgMjAxNS8wOS8xMC0wMToxMDoyMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpiZmQ3YWMwZC1iZGZmLTlkNDMtYmZkZi02NmZhNzY2NWFiZGQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE4NEIxODgwNzlCMTFFNjg1RjQ4RDdDNjNCM0QwOUEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE4NEIxODcwNzlCMTFFNjg1RjQ4RDdDNjNCM0QwOUEiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6YmZkN2FjMGQtYmRmZi05ZDQzLWJmZGYtNjZmYTc2NjVhYmRkIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmJmZDdhYzBkLWJkZmYtOWQ0My1iZmRmLTY2ZmE3NjY1YWJkZCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pp6EKp8AACJfSURBVHja7J2JcyPHlaezCjdv9qVu6mp3S7IuqyW1PSN7Zid2JmZiN2L/592d2NhjYoPhldce2WtbGskSWlcfYJPEjdr3AxLdIFjg1SBQx/dFpKp5iCwmCpVfvXz50jkAAAAAAAAAAAAAAACA3FJvtHdCugEAAAByLEM1O3yAEAEAAECeuWethBABAABALtFUmR2u698IEQAAAORRhop2eG/8MUIEAAAAeeQta1WECAAAAHJJvdGWCP1k8nMIEQAAAOSNt6YdCCECAACATLNbb5asDZ2n3miv2uHV6e8p0k0AAACQcX5q7ZZJ0eeDyK2FwfGAUEAfAQAAQFYxCVLw55+cDwIFZj6rxcCtlsyKJiyICBEAAADEicSHdnjZWn+i9ax1fGv7Y3Oy3d+pRQn7U16Z9J3Izm6/Gzmd5EY5QIgAAABSLCua8lmztu6b/q3cmBVr/9mkpD2nXxX6Vjrj90d2bhKjpxNtz85nb4nd9WrcJ1eKRyfJECIAAIDky8+mb1v+KAmalfaivblihajeaAdeboq+FdzzBVbFyZ/5/eGg2j9/rCfwUqb2kv/cE2v/bUl9t+r77AiVQuCKU1lECBEAAEDyBOiqb1esbbtzrApfKQYvm/jo/636JkEq+3bWSI8rhYHr9+cy+9VYYne+HGuMMfaDEAEAACxfgjQe37Z2zYvQhcviFEJ3J0l/mwlayQRNUre3s1npL1uIFMKqFgOECAAAIIFIFN5w54jgzPxBg/mcULUouQqGycdKRB4f+/afgR0HZwwerZQCbaCqFpkYKafoobVHOpogtS+rQ00yNW23dvzvCmLnGhEiAACAJaOVWTaA/+DF4dxo+bhyYgpB4MqF+ZxTzcShFvuV5zoxGAqSJCwaHa31Bmqjj4eiER75Hzd8G26bYYKkZGv93d9LkkyQBnPs1uuzRM8hRAAAAMnCpEAKc2O/G1Wfdk4Pu0gwyuEoKbgU6uOj9XQWiX6vWunYCQTPZOmUUxsL0l1rXesLidG31r6bnl4zYdR2G0om/zcTyIdnOL0bcZ+szOgsCjMCAAAsXoIUkLhp7ZYfuEMJxHeHg2PCIflR1KdUCIYClJOBu+/F6Btr3z84GPbLP7rnu9Nr6u1za1+bHB2LKpk8qZv+o5sK/JStD69WESIAAIBlSpDGXCVNv+pl6Njk1sPWwCnDpVIYDd4ldhwVrYNu9GivE8VNJyoH6Qs3ihp1J4RIuUN/P/3N6+XArZXi1YcpMwAAgMsVIUU1XrP2unse4YjlahUDiqHa6c/MrapYe9vaXZMgidHnXow24765fEL3EiECAAC4IH5qZssG4ccxIqQaQloCf5Px9uLETSWegGToT25Ue+n29BdvroTDvcwQIgAAgPnJkPJ/FJ0Yb5fR9CKkCs1aQn+FXpqPEB32InfYfb5y7Sz/m5uq5aQk9Ou12SEihAgAAOB8IqTpmPenhOerW6uhlo+PV0LBJdAyMdLGrN0LLM5X/aHtSoAQAQAAvKAIaeuLd9woH+gYij4USQFaCJ3+aMf69jlCRkqmXi/P1h6SqgEAAE6Xode8DJVnfY8G6K0KcYZFoDIEVwqB6w4Ct9+JXOsMYlQ4RVYRIgAAgNkipPyge260XP5EesO9LBCiRaKyBNvVkRjtmRh1psSoHLp2qRCU7KUJS6dUr0SIAAAA4mVIy+TfczH1giYpBKP6NrUiMrRMMVLBxXbfDcVI24fodblSC1vB6PXbd6OK2DPh1QMAADgqQqpto6jQSycOoMEoL2W1FDCYLo+etZY/Ck2MFQ66UaUYurBSCCYnyg7caPPcMkIEAABwsgxpG42P3Am5QkLRoI3y8vYQyzEt3yQ6NS8450Hr07TtxyZCBAAAcFyENB7+1NqbJ32fpmE2K9pag+FzgSiyo4KLK6eJ6jnQFFplUqjIIQIAAGTIuU/cKYnTq37ZNiq0ELS561MvQauX8PO111nP/45h3SgqJgAAQK65v1PT0qTvZ31dwSAl7G4gQ4tAm7XueT/ZcvOLCMVR9DLUsBbx2gIAABi/ftD8ZBC565OfI1doYWhKTFufbCzp9x8yZQYAALmn3mjfjCK3/WNrMFyyLf/ZqARuhaX0l42ic3tehDaWeB4rvNIAAJB3GVIitTZpHcrQk/bAbVXYhmMBKCIkD6km4WQQIgAAyKsISXk+tPYyvbFwlLezmaQTYsoMAADyKENabv1X7uiO9XD5qA7QQdJkCCECAIA8ypAK+mmZ/Rq9sVCUOK2l7utJPDmECAAA8iRD616GqvTGQtFyeqXp1JJ6gggRAADkRYY2vQyV6Y2Fy5DytUpJPkmECAAA8iBD216GGPcWy3jT1VLST5RFhQAAgAzBZaAaQ4oOVdJwsggRAABkWYY2kaGloX3CVtNyslwgAACQCXbrTT3k37b2hfYnm0igZqxbjgxtpOmEuUgAACArjIssXvnqcfszRwL1slDeUC1tJ02lagAASD279aa23nhz/HEpdP2r1bAQMMotg/HeZKmCHCIAAEi7DL0yKUOiO3CFh62BG0T0z4I5SKMMIUQAAJB2Gdqyw724r/VNhiKECK9AiAAAIOMypOXcv4gbyzRTtl0JXYFRbpHsuxTmDiFEAACQZhmS83zsZmzBsVUJXLlAP+EUCBEAAGQb5Qxdi/vCWilw1SLZ1Avm0NoKQgQAALAgduvNq3Z4K+5r1ULg1svI0BLopv0PQIgAACBNMqS6QpoqO2Y9xXA0VQYLR6nr6wgRAADA4lDxxWN5Q9KgrUroqDu0FPaz4BMIEQAApILdevNVO7wU97WNcqBijLAc+ln4I7h8AAAgDTKkqNB7cV9TAvVKidDQEqkiRAAAAItBxRdL058smAdtkkS9TAYIEQAAwALwU2U34r6mJOoQH1omzaz8IQgRAAAkHZVYPJanommycgEbWjLdrPwhCBEAACSa+zu1f7PDfy2Ew41DR4ZkHrRB3hDMkSJdAAAASefWaqhaN9VmL3J7nWg4VcYS+0SQmVcBIQIAgDSgFWaFWnG0LQculBgys2McU2YAAJBo6o32dTvcGn+MDCWKzLwcCBEAACRZhjTgvk9PJBYiRAAAAAvgtrU1ugEQIgAAyCX1Rlt5rm/RE4kmQogAAAAulzeslemGRDNAiAAAAC6JeqOt7SDu0BMIEUIEAAB55q7LUMIuIEQAAADnwkeHbtMTqYAIEQAAwCVxl/EJIUKIAAAgt9Qb7YojOpQmKMwIAABwCfyEsQmP4A8BAIDcUm+0lUR9m55IFZnZExUhAgCApbFbb65bGw+qr1kr0SupoorZAQAAvDgfW1sxKfqqN3C3ijympw29Yt0siCxCBAAAS8EkaNsOG/7DOz80B65aCNxaOXAlxChNNLMgRFxyAACwLG5Pf6LVj1x/ENEz6SITS+8RIgAAWDi79aYiCjvHBqXAuWoxoIPSRSb2m0OIAABgGbwcNwatIENpZMVlIEqEEAEAwDJ4JXZkLSFEKWUfIQIAADgHu/Xmmh22pz9fKQSugA8BQgQAADkhNjpUY91zmpHkpnraDCECAIBFc2v6EwHJ1GlHPrGf9j8AAABgIezWm6o7tDb9edUfQodSTwEhAgAAOBu34j5ZZbosC6y6UZFGhAgAAOAUbk5/QtNlFbKps0IXIQIAADiB3Xqz5p5v1fEMpssyhV7fNkIEAAAwm5fiPlkt0DEZo4MQAQAAzOZ63CeZLssc69YOECIAAIApdutNWc+16c+XNV2GD2URpcmnapdehAgAABbBth8kj1BhuiyrVKztIUQAADnER0EgHiXa/sna46NCRJdlmE2XomKNXIkAAOcXn9Df7MdNORMqNviH+zu1L+b08//BDyZP/VFP2w37+anfVfybJ+3/0BlE5U7fOq7MMJRx7FV2PTeKGCUaSmEBAJwuKBq1NeWjHBglBm+5+Aj7ypx+pX5OzbfJROSBnYvESFGWh9Z+NEFKVd2XeqMtcSwrMsR0WS7Qq9z1UpRo50DNAQBmS5BkRJWVVUywfOqdP3CPb6yEdf80PG4lPygEEwPCwD85j4+aTtJS5ZaOjXZUPuxFb5/hNJW0+sTat9YemBwlfmWPCdHrdviAKyx3HFqrugSn6iBEAABHRUjbD9y29rI7Z5i/ZLf6a7UXv98fdCO317nQAh1Fj/5i7RuTo0QWxzMhumeH17jSkKKkwZQZAMBIhG7Y4Y6bUSvnLPTmtMi4f/GfoyrB71l71/6eB3b8wsToUcK6eourLbdoKrjp3aOUtJNjlRkAIEP1pqIWf31RGdJCKW0/sVqcT9BdkSbl2LzAAiz9nzvWfml/W2KSWeuNtqYO17nico3y4iKXwE1giRABANhY7c44jSPTUDHBcmEkLcVw/rkHNROrWnH02zRy9AbOdfqR6/rjOSJISZs623SkasAoH09XsaZ4NxAiAICEYNLww68fNA8GkVuN+3oYjCRFUaBSYbEjun6XIkalMHj2GQlR2/7T6o0EaZYfrZeDhwnr6jWuNpi4tCVDKikxXnyw9BMCAMgt9Ub7qh3ebvWjK49b0ZGb41CCiskuHhjZKdu5u2ZvJEljdM5XqsPz1hL9P+xsVn5IQF8rv+kOVx1ModWWqre1ucyTIEIEAHkVIUUrNEArmXoY/SmG0VAwVkuBWymmY4+tIHg+xdaPAnfYjdxhL7K/4dm3qH7SJ/b3Klr0ryZGT5Z4uuQPQRzjQqfj0hNLmUYjQgQAeRMhJfa+ae2um1pYogBLFnaSiE6+uX9l7TMTo84S+v6f3GjZNcBJtL0YrbsFLv5CiAAgTzKkVWQqCriS866QDP3WpOibBfa9Brb/xFUI52A8labZrNXL/mVMmQFAHkRIg/E7jvyVMVrl87H1i6pwf2pitIjtP2p0O5yT8VSa0NYfqsQe+AeaufsLQgQAWZchhd3vO/JX4pAQbVsf7ZoUXXYBxxW6G17QVyaTrsf5RgMvTsqaq7gXmGJDiAAgyzKkAf8jN9pLDOJRTs+vrK+UV/RnhAhSQtnN3l+w51vffxz5hhABQO5ESGH1n7pR8jScjvrrXes3PYFrCm04kOzWm5KY7v2d2jym1EimhkVRvIjfkFQNAKnGBm2FyD+09mcbuBs+X+hjN5oOgvOjZfn/8uBgoPHhb9xoSuJ/WN92TngNNFUxblX3vNDeeM+q4rVa2CuFww1zARL7VAAAkGYZ+rm1l6x1ygX3L1er4bv276v0zsUZRO7g+8OBHZ7lXSmZ9X962Vn3TdGjVX88dUpysxw8rhaD7ZBRBxAiAIBLk6EhNtgOrtXCsMCd7cIo0eJRKxpuCXJZ3FplX3FIHlyVAJBWPpyUITGIXPiwNdARLsjTzuXKUICsAkIEADAfdutN1RSKzUfR1hsI0cVZK2kLk2OfHjDoQNZhlRkAxAnHuPhZzTfljpR8K7ijOSN9P2BqmasSb1V2v2nt6f2dWvMSzu22Hd6IHWztrK9Ww7gBHc4qLKM+bD1sDUq9gStYX0aVQhAddM9vmYoGhRNHJWmUSCIChAgAUiBCV+zwMwUK5vAw/3trf5zz+WnrjfeRobkjkT30r/mq9WVVfbnXidxGOQi6g6hwMLXwXnlaBfvuotmOjvpYr0HBPg79vwEQIgBIKxr25rXT9OGcZUiRqo9dzGIQfWIbGbrI6yMRqvpWnhbMrcqoqxXVWS0NpadVLgTVYkAuECBEAJBt9t1oCuyFKztvVoLNeqOtAfdgZ7PyQnI0saIstjLtVjVwZWToLGgKU1Oa4+XyZ6oeLTnaKA8NSOLUcEe3UABAiAAg/Zi0aJC7YU3TZds/NgeF7hxSaKuF4K4d7vrfofyiJ34wVfvRJKl9jh/3nrwn7gsaqKussz+Jnhddvc7jnLAXcl03qku0StdCluAuApBPCVKOkFZpqZrzkU1PG53IHc5IoFWkQDeNIHh+8xiv6NIxmrix3Dy91owG6YfWvrP2gwlSrIb5vKFP4r5WKwbPpnXgGJKWgbucTW27/mXmoRoQIgBInQQVvATddidMebT6kWv1lDfifLJs8Cxh9jS05L3vxah0viksRTG+t/aNBMnkKPIypFVt/97F7IOln3+1FnITO86eG60GrF3y75HQrtHdgBBlGLsJF/wNuDD1FKSnIt2oD+/v1Pr0FKREhJR3c8eLUCkFp9yy9qW1rx4cDN51MfWGFKG6Xg2HwgYjF/UitLLg11i/c4PuhyyQ23Cnr7OiUPKWP676p52xCJ3E/7L2A5cPJOh61vXbN1FvTYiQBsa7XoYKKfpz9B4c7lRfLrjDTsyjx2Y5QIae0/AitIxE5zX/oFjiZQCEKF2Dhp5kVOr/uhehiw4SHS4dSNB1/bobJR1L0v+3iZBk/zVrb7sZq7LSgLbh6PaPT8lozbdyh8A99a/vMld8SUsPESLIArm5q9igoSfOt+bxs65Ug3+tFALdjPQ0vj8rGRTgkq9pPdB8ZO3m+HPlQvDZ1Wqw4zKwLFp7au1PJXcrj+l6Lcx70T/ddxQ3S9IqL90P13lXQprJU4To+3kJUTkM3p382J7I9YSksLWWFT+y9nicFApwSTKkwUd1eY5EUHqD6J1BFGRCGFZLwTAxZnLLiM1KkGcZGnjxSKLsKlIVOfJSIcXk5uL9+km7+P3h4B+jOYR2b52+nLjrBayuIxEkmLMMXbPDL2Y90GRtKXpvMIoW6W61nd8l9lrRVXHJnpqiYCMgREmm3mir2JzyKXb2OtqPJz5wo2XFxTB4tj9POLEZ4biT9H9qWfE58xckR3+x9sV0tV5fX6Vxf6dGThKcVYY0HaZpsplWrsiKryoM6SfJUaFpxunvBV42QIiSJULKq1De0LMloVqt8rA1GP7RZTOfcsENy/1rn54F7Msjn/rW2h9MjJ7awKanvX/wn/+dSdFfuBzhFBl62ctQMEvqFRkqU7U5Kxx6uaik6JyVNrDFSwcIUTJESFsQvONm1MZo96PhgLHEP1wC9PW3h4Mwio7UV5EsfUq0CC4iQ5L77UrIDuPZoeHvYWl7RQf+HkeUCBCiJYqQape870ZbESQa7RP1YzM2rUirR3ZNih5xacKEDCna+fNZ79eVYjBMNoZMoBuDttxI84otokSAEC1Rhl71MpSKVXMPTYY6gxNviL81KfqSyxNMhrbt8MtZT9xrpcCtky+UFTr+/V9N+d9BoUZAiJYgQhKgD1xMaf+kolhyox25Zu/UVfl/Min6jEs01zKkgfHv3IwcEomQhAgywYF/nbNSCoUtPQAhWqAMqVS9dsBeTeP5K5dJYtQ/2Yu+tvZ/TIyoaZQ/GdIqsl9Z20aGMo9Wka25bOV0KiF8hZcW0kQqdgOywWHTJ5WOZUiDxL9LqwyJSiFw12qhq568IugVax/5fdcgX7w9S4a0rB4ZygyKpKy77C1wkQw1eXkhTSQ+PGsyoCcnRYJK9u++L4p4Py0yd6KNqtBcNXD7XV94Lh6JoOp7fMrlmg984cW7cV+TQFNjKDNkvZChcqJqvMyAEM1nYFAOhRJKxxtU/rzVjzQoZGpE0NO+aj0+aUduhha9Zn3Rvr9T+/0L9mfRP7kVJ55Ie164dOzY76Cq9vLRdMNDa1ePvFntEWCrigwhQ+m5tTm284AUkdgL1edQ/I2LWb6pqEo1g8XnVDjyUXswrIY9g1+bsHz9An2qGk1/fcK36De33SinQW24N5v9TkLfS+B337XutfvRa+MRRVOsxZB+yQB5Sjhm01dIDUmOEN1zM2pZtHqaOsjei6Hieler4bCa9gwpumdSc2CC8viCv6J7BkGu+nZ9QqS0j5L2ZvvGfvcT3jaXT73R1rLll3qDwDU6g+F2McgQMpRCiDhDakhkmMUG4GEycdzXlIysCFGWY7CdfuQetWZOnyla888mJt2z/CwbWDWMKvm81u5Hm/Zz357DE59qJP3FzqHHW+jShEjlJF6nJzLFvn8v5mkKSUKEykMqSFyEyGRIN4yfxX2tFI52u8763URbi2xVnHvcjlUiJSmqEOXnMYOoukZ5CVf9cXPyBlwe7uvwwiv4Ff5+3//c3/IWuhQZUgThNXoiU+hBZsXlL59GMnTgUrwiGBCiZfJh3HmNVmSFLsjJ7aRaDNx6dGz1mZKffzOZR2SDpyYPlRu0448zX9M59l0UJ2QwN95xJKJmCUVSCy6/kZIulwAgROdkt97UU/GVuK9pF++8beKt1WdKtFYRR0XHtirh02LovvEipBUct90oWnTm13E83TiOFQ2b/WdgTcWz+wM7Dk4uGGnn0rhWC1u8feaPva5XvNhCdtBChTxHSMpcApAGEqMYJkN60/x93JtHhejyWntFonJopjJRiO/PbjRttnOZv1dCpFymtgmZSh1MJnlfH6120hTAH619tbNZoZL2/IRIZSau0ROZIQ/L6890K3PkEkHCSVKE6K04GdLKmjxvXqmpwqmqxHcX8XsVjdPKplpRUaTAtUzKDnujO5pf7SQpU+LvbRvEPzUpYvXZi8vQBjKUKfaRoWeottYa3QAI0Sns1psaXGNX1GyWA5Iploz6/7kcHUOD+N/aYK5o0f8jWvRC3KULMoPyhqp0w5H+AEh2ACIh5/HTuHPRIFwuoENJk6MZn1aE75cmRuQLXADfbzv0RGZouezsXJ+lsQYguRfpbr2ppaivxI2w6+zZlDa03P/vbHBnie35eYVBIzOo+CLTQ0fhQQkQojNw28UEHlZK+VtVlhE0/fm3Ph8GzidEkH40NbRCNxyD6UNAiE5it95UbY5jBejkQVOJxJC+p0FNn7GH0RnwETWSb7OBkoeZKounQxcAQnTyU8PT6U8qdyjEh7IgRZ/YYM+T4emQO5QNVJGZyOhsKNAICNEs7u/UtFHpfzf3+S8rpaA7lqBVokNZQTL0C7+fGszmJbqA+2kOYKUZJJpEhHZvroaKJpRUfFHFANnVO1NsWXvP2v+lK47jd7XfoidST952sb8IlOQAhOgMvKz/KC5UIZM6i6h447cPDgaP3KjEQuf+Tu1Pee2M3Xqz4kbTZA9thFgN2LcsCwN9jW44FT3qqhyBHgIKdAcgRMefkANHDkXmafWij9yofL8Gjr5JwdcmRXndD03lCd7XP747GAxUa6tSIHcuxSg6RFL86UxH0HQ/UF6Rkq37E2NSDWGCXAqRv5FQoyKjaE+0vU4kIapMfFo3uzddfqfRtiZCC2Hb7xknIYLUoUGdulsXQxGjim/HnqHcaFNcoTIGJboL8iBE13kZsos2hdU+aDG8tltv/nGZUSL7/a/4AU3ncLjAczkWTdBMMdGhVLLnyAG7DKruaO0iyVHTPzxT5wkyK0RsZpnlC8yeAVeKgTs8LkV6OvyJtc+WeHrvuYnopAmSwvfanfyxtR+tPTJJGixCiErkzqUVokOLYTKSpCm2Qy9GzC5ANoTI5w9t8zJkm7Vy4JomRDFxIkWJ/nBJ0nGR67/kBV1NU3o9O79v7fi1BMnO84VXydjPK7uY8H+JlZVphJVly6E8IUJP/cMVYgrpFiJv+CTPZRwFP6rFkRTF3NhuWftmzqKtJ0lVyV7z19j46TL0LdJU3reHg/AM749XfDs0mfncjl+ZGPXnHVEgfYj7J1yIcTV8Taf1HXvIQYrf0KzMyAkqttmMzyXaOYsQmYwoqqKojYp5fhkjQDd8U8Tx1CXQFwj1SKy0MuxN5T7Z8csLRrZihahAAlHaaDlyWZLE+D1/OPF+BUiVELHXVU7QlJBa97hC3DDBKJpc9E6Qodft8I4bTTW1tWT/1moYeZnSXnhXz3s+g4tPflW8GN228/iNnffDC964j74R8aE0ChHb0iSPsQjt+X8TxYPlC5HfuFWrLxQF0jy76s78OPVt3FDy9Ahno363E5tcrZWGD2KuIcnDx9auTArJSjEYf+7CCZVK9r6xErr+QKUBomF5gE5fwhadVZYUmv+VneMXdvzsHNNox85ZLhQgRGmDqZlkozGn78jzgmUJkQ0Okp+bfoDbckcr8CqUiRDlGOUR7XVibeOYENm1pOvoQxeTgNzuRzcju7Re1CGU21QouOeXaWn0b0WxVCpAU3z90+VI0auv/I33LByrucJsWerYR4hSQcHLkBKvVx17zcFlC5F/itegoO03Tpq3Xa032qvueYJrCXPP2d0pGEVmesenza5MXVPa3uOtWT9HkiJZWbmkeabh9F45cOvWVDRxv+uGe+zN4Pf3d2p75/jxZYQo9fTpglSh1AzVMYp4CIdLESIbtJS38YYbJbKePgoUnq3WgRxTttG/d3xOat0nTWuguXfadaJIU3lBFlHx22p0+opuDY7kQJULweBqNXh8zh8ZHhcijChlkLCbPvQQrnfvU0fuKsxLiGzg0tP82+6ciay9AZ0NQzF2h/Hp05puvWPtpZkXq6nEZjmQiCzlvK/VQnfYjdxeNxpOsm1XAsnNL+uN9m93NitfnvFHHZsCRIdShZZ3s5FrOgm9DJFXBC8mRCZCCjW+4y4Y5dEDfcTNP/eUhpGd2Omn9066SWl6bKMSLP36WSkFrmLnomRsH6TSTfYDk6IVk6LPeIUzTxshSj26zzQcZV/gIkJkMqTlzR+4M26wpxmASjiaatCWBFThhWcXXHjiTer4taS7lolQkjY+fZ6MfYQ3TIpKJkW/Oe97jhmzdDk9XZAJNpEiOLcQmQypzsu9UyXIjXI7asVR3gXASVJ0lilURWC2K+FwuiolvG5S1Dcp+t0J33MsITfikkgLeqnIH8qWFDF9Bs/HnDN8T92NlpnOHLQ2ysGwpstWJUCG4FQKZwiJ6Lq6Wk2VDI25Y1J0Z8bDhd5vx5ZrRxhRWjh0zPpnjY2TxjdAiI6gCsI2KH0aTD3IToqQtmVg6TCcXYhGbdYlE3gZKqZ3qvVdk6IbMe8lxcW6058fRJHSzJ+4UQh/3w+8qoSsBN4DN1oZ0/Dfsxf3M2Ah0O/ZRFG/Nt0Ap2qM3dhl0L9o9qKVJ+2REynBVTVakCC4KA27lg7j9zZzV6qZiDRq8Pznnc1Kc+K9VPyxGf2sO4iGCxO2K2FUKrjhUrUL5BG1vTCVHdM4C7tsHTknWUUPIBVHBBAhOkGGrkmGnM81UpVhTWFUmRaDF+SxCVErRogUdVTEMSP8YO1bNypRIXGpDSK3+t3hKIFKyeJzKi7Z8oLEYH35gyaF/bIL+UQI0Yky9FduVP4cYO6oCvSTdjQwSRhOjikqpOhQytH0175/2qz5m2zVTVSoftSKhn+7xE8COEc6ftDmpj5/qBqSDzRFvUo3IESTMqR9yH6FDMEl07RRJnraiVa0Fcf1Wpjmadi2b+unDZyqdq1vuMQcKd3Uiy5m3zS4MESHcvKc5h9ekN8cEsbIkN70RIZgEQzsrhMOk/PTK0OKCO15+dg4y41UdbkuOWFcT7iql/OUS2xudOiCXFBxZ9+oGbIsRCZDupnf58kSFsB4B2o9kT0JguE0U9o2zWz499BGQt/b6/4cYQ7yThfkBr1vWFGYQ6YLM/7ETe08DnBJjCOQ04nAaVg91fbyloYkZorPAZz/YeKpY5FCLl/4IfVGW0/rb9MlsAAOT5AdRSe33PPaIEmLcOhGWXLpWuq+4YgUze1eCblAMsQ0aY7f5O868oZgMfTO+H2ViRtTEqrJSirWUzo4jiNFcDG4N+aPJl2QQyGqN9rbdrhJd8ACGHipOA+aPtOWF0/d8nI59lz6Q+jr3OQRIjjX+4XcsbwJkWOqDBaHpOai68nGyY6tJchQFnJwAt/YPe38FOmCXI6PrNTMEf9fgAEADtvA3YJ5ORcAAAAASUVORK5CYII=);background-repeat:no-repeat;background-position:right bottom;background-size:cover}.od-PeopleCard{position:relative;width:340px;opacity:0;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";box-shadow:0 0 20px rgba(0,0,0,.2);border:1px solid rgba(0,0,0,.15);margin-top:-20px;overflow:hidden;-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;z-index:2}[dir=ltr] .od-PeopleCard{left:50%}[dir=rtl] .od-PeopleCard{right:50%}[dir=ltr] .od-PeopleCard{margin-left:-180px}[dir=rtl] .od-PeopleCard{margin-right:-180px}.od-PeopleCard-fadeIn{opacity:1;transition:opacity 267ms ease-out}.od-PeopleCard-cardContentWrapper{position:relative}.od-PeopleCard-contentOverlay{position:absolute;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;opacity:0;padding-bottom:44px;visibility:hidden;z-index:3}.od-PeopleCard-contentOverlay.od-PeopleCard--active{transition:all 267ms ease-out;opacity:1;visibility:visible}.od-PeopleCard-closeExpandedView{position:absolute;visibility:hidden;display:inline-block;background:rgba(0,0,0,.5);cursor:pointer;height:40px;line-height:40px;opacity:0;border:0;padding:0 12px;-ms-transform:translateY(100%);transform:translateY(100%);transition-property:opacity transform;transition-duration:167ms;transition-timing-function:ease-out;z-index:2}.od-PeopleCard-closeExpandedView .od-PeopleCard-userName{display:inline-block;color:#fff;line-height:38px;vertical-align:top;max-width:230px}[dir=ltr] .od-PeopleCard-closeExpandedView .od-PeopleCard-userName{margin-left:4px}[dir=rtl] .od-PeopleCard-closeExpandedView .od-PeopleCard-userName{margin-right:4px}.od-PeopleCard--closeExpandedViewActive{visibility:visible;opacity:1;-ms-transform:translateY(0);transform:translateY(0)}.od-PeopleCard--closeExpandedViewActive:focus,.od-PeopleCard--closeExpandedViewActive:hover{background:rgba(0,0,0,.75)}.od-PeopleCard-backBtn{position:absolute;visibility:hidden;display:inline-block;color:#fff;background:rgba(0,0,0,.5);height:40px;line-height:40px;opacity:0;border:0;padding:0 12px;transition-property:opacity;transition-duration:167ms;transition-timing-function:ease-out}.od-PeopleCard-backBtn:focus,.od-PeopleCard-backBtn:hover{background:rgba(0,0,0,.75)}.od-PeopleCard-backBtnEnabled{visibility:visible;opacity:1;cursor:pointer}.od-PeopleCard-iconGoBack{display:inline-block;position:relative;color:#fff;font-size:20px}.od-PeopleCard-expandedHeader{max-width:270px;margin-bottom:20px}.od-PeopleCard-expandedContent{position:relative;height:100%;box-sizing:border-box;opacity:0;overflow:hidden;padding:16px;transition:none}.od-PeopleCard-expandedContent.od-PeopleCard--active{opacity:1;transition:opacity 267ms ease-out}.od-PeopleCard-expandedContent.od-PeopleCard--scrollable{overflow-y:auto}.od-PeopleCard-escapeValveExpanded{border-top:1px solid rgba(0,0,0,.1);opacity:0;padding-top:4px;transition:none}.od-PeopleCard-escapeValveExpanded.od-PeopleCard--active{opacity:1;transition:opacity 267ms ease-out 167ms}.od-PeopleCard-cardContentWrapper{position:relative}.od-PeopleCard-header{position:relative;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:1px solid rgba(0,0,0,.15);overflow:hidden;padding-top:8px;padding-bottom:16px;-ms-transform:translateY(0);transform:translateY(0);transition-property:opacity transform;transition-duration:167ms;transition-timing-function:ease-out}[dir=ltr] .od-PeopleCard-header{padding-right:16px}[dir=rtl] .od-PeopleCard-header{padding-left:16px}[dir=ltr] .od-PeopleCard-header{padding-left:24px}[dir=rtl] .od-PeopleCard-header{padding-right:24px}.od-PeopleCard-header--animateOut{-ms-transform:translateY(-100%);transform:translateY(-100%)}.od-PeopleCard-coverPhotoWrapper{position:relative;height:40px;background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 50% 50% no-repeat;background-size:cover;overflow:hidden;z-index:1}.od-PeopleCard-coverPhoto,.od-PeopleCard-coverPhotoColor{position:absolute;width:100%}.od-PeopleCard-coverPhotoColor{height:200%}.od-PeopleCard-coverPhotoColor-gradient{width:100%;height:100%;background:0 0;background:linear-gradient(to bottom,transparent,"},{theme:"white",defaultValue:"#ffffff"},{rawString:")}.od-PeopleCard-userPhoto{position:absolute;width:100px;height:100px;background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border:6px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:50%;top:12px;z-index:4;cursor:pointer;transition:all 267ms cubic-bezier(.175,.885,.32,1.275);-ms-transform:scale(.5);transform:scale(.5);-ms-transform-origin:top right;transform-origin:top right}[dir=ltr] .od-PeopleCard-userPhoto{right:16px}[dir=rtl] .od-PeopleCard-userPhoto{left:16px}.od-PeopleCard-userPhoto .od-Persona-image{line-height:100px;font-size:42px;transition:all 267ms cubic-bezier(.175,.885,.32,1.275)}.od-PeopleCard-userPhoto:hover{transform:scale(1) translate3d(6px,-2px,0);border-width:3px}.od-PeopleCard .od-Persona-image{border-radius:50%!important}html[dir=rtl] .od-PeopleCard-userPhoto{-ms-transform-origin:top left;transform-origin:top left}html[dir=rtl] .od-PeopleCard-userPhoto:hover{transform:scale(1) translate3d(-6px,-2px,0)}.od-PeopleCard-userPhoto .od-Persona-image{width:100%;height:100%}.od-PeopleCard-userName{max-width:250px}.od-PeopleCard-userName,.od-PeopleCard-userTitle{margin:0;line-height:1.5em}.od-PeopleCard-userTitleDivider{color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";font-size:1.3em;margin:0 .5em}.od-PeopleCard-actions{margin:8px 0 0}.od-PeopleCard-actionContainer{display:inline-block}.od-PeopleCard-action,.od-PeopleCard-action-disabled{background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:20px;padding:0;transition:color 167ms}[dir=ltr] .od-PeopleCard-action,[dir=ltr] .od-PeopleCard-action-disabled{margin-right:16px}[dir=rtl] .od-PeopleCard-action,[dir=rtl] .od-PeopleCard-action-disabled{margin-left:16px}.od-PeopleCard-action .ms-Icon.ms-Icon--Message,.od-PeopleCard-action-disabled .ms-Icon.ms-Icon--Message{position:relative;top:2px}.od-PeopleCard-action-disabled:hover,.od-PeopleCard-action:hover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-action-disabled{cursor:default;color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-PeopleCard-action-disabled:hover{color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-PeopleCard-editProfile{display:block;margin-top:10px;line-height:20px;cursor:pointer}.od-PeopleCard-editProfile:focus .od-PeopleCard-editProfileIcon,.od-PeopleCard-editProfile:hover .od-PeopleCard-editProfileIcon{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-editProfile:focus .od-PeopleCard-editProfileText,.od-PeopleCard-editProfile:hover .od-PeopleCard-editProfileText{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-editProfileIcon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";vertical-align:middle;font-size:16px}[dir=ltr] .od-PeopleCard-editProfileIcon{margin-right:5px}[dir=rtl] .od-PeopleCard-editProfileIcon{margin-left:5px}.od-PeopleCard-editProfileText{vertical-align:middle;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-PeopleCard-feed{opacity:0;max-height:0}.od-PeopleCard-feed-fadeIn{opacity:1;padding:8px;overflow-y:hidden;max-height:420px;transition-property:opacity,max-height;transition-duration:467ms;transition-timing-function:cubic-bezier(.175,.885,.32,1.275)}.od-PeopleCard-feed-scrollable{overflow-y:auto}.od-PeopleCard-contentBlock,.od-PeopleCard-contentBlock--loading{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid rgba(0,0,0,.15);margin-bottom:8px;overflow:hidden;padding:16px;position:relative;min-height:105px;transition-property:border-color,box-shadow;transition-duration:167ms}.od-PeopleCard-contentBlock--loading:hover,.od-PeopleCard-contentBlock:hover{border-color:rgba(0,0,0,.3)}.od-PeopleCard-contentBlock--loading:before{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:';content:"";opacity:1;position:absolute;top:0;right:0;bottom:0;left:0;animation-name:anim-loading;animation-duration:2s;animation-timing-function:ease-out;animation-iteration-count:infinite;z-index:1}.od-PeopleCard-contentBlock--loading:after{width:130px;height:10px;background:'},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:';content:"";opacity:1;position:absolute;top:20px;left:50%;z-index:2;-ms-transform:translateX(-50%);transform:translateX(-50%)}.od-PeopleCard-blockTitle{color:'},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:";cursor:pointer;display:block;padding:0 24px;margin:0 0 10px;transition:color .1s;text-align:center}.od-PeopleCard-blockTitle:focus,.od-PeopleCard-blockTitle:hover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-showMore{height:40px;border-top:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";font-size:12px;line-height:38px;margin:10px -10px -16px;padding:0 10px}.od-PeopleCard-showMoreLink{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer}.od-PeopleCard-showMoreLink:focus,.od-PeopleCard-showMoreLink:hover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-PeopleCard-interactiveContentItem{background-color:inherit;cursor:pointer;margin:0 -10px;padding:0 10px}.od-PeopleCard-interactiveContentItem:focus,.od-PeopleCard-interactiveContentItem:hover{background-color:"},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:"}.od-PeopleCard-escapeValve{text-align:center}.od-PeopleCard-viewProfileLink{display:inline-block;line-height:32px;padding:0 8px;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";text-decoration:none}@keyframes anim-loading{0%{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}60%{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}100%{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}"}])});define("R2",["require","exports","ap","kx","R5","R4","R3","oc","ci","dZ","aC","a0","aI","V","dI","OY","qY","ba","eX"],function(e,t,i,r,l,d,c,o,n,a,u,p,m,s,h,f,g,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _;!function(e){e[e.None=0]="None";e[e.ItemIdParamMissing=1]="ItemIdParamMissing";e[e.ItemNotFound=2]="ItemNotFound";e[e.NoPolicyTipInitial=3]="NoPolicyTipInitial";e[e.GetItemServerError=4]="GetItemServerError";e[e.GetInfoServerError=5]="GetInfoServerError";e[e.UpdateServerNoResult=6]="UpdateServerNoResult";e[e.UpdateServerError=7]="UpdateServerError";e[e.NoPolicyTipFinal=8]="NoPolicyTipFinal";e[e.NoNotifyAction=9]="NoNotifyAction"}(_||(_={}));var b=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="PolicyTip";t._dialogProvider=t.resources.consume(n.resourceKey);t._policyTipDataSource=t.resources.consume(a.policyTip);t._panelProvider=t.resources.consume(g.resourceKey);t._item=t.observables.create(null);if(e.item&&e.item())t._itemPromise=u.default.wrap([e.item()]);else if(e.itemKey){var i=t.resources.consume(v.resourceKey);t._itemPromise=i.getSpecifiedItems({itemKeys:[e.itemKey],recurseInFolders:!0}).then(function(e){return e.children})}else{t._errorType=_.ItemIdParamMissing;t._itemPromise=u.default.wrapError()}return t}e.prototype.onExecute=function(e,t){var i,r=this,o=c.strings;if(y.isFeatureEnabled(y.PolicyTipPanel))return this._itemPromise.then(function(e){if(e[0]){i=e[0];return r._policyTipDataSource.getPolicyTip(i)}}).then(function(e){if(e){var t={item:i,policyTipInfo:e};r._panel=r._panelProvider.requestPanel({component:{name:f.default.tagName,params:t}});return r._panel.wait()}}).then(function(){return r._evtEndObj});this._state=this.observables.create(d.default.loading);this._buttonsAvailable=this.observables.create(!0);this._justificationText=this.observables.create("");this._justificationError=this.observables.create("");this._messageText=this.observables.create("");this._titleOverride="";this._action=this.observables.create(null);this._info=this.observables.create(null);this._logEvt=t;this._title=this.createPureComputed(function(){var e=r._state();e!==d.default.status&&e!==d.default.error&&(r._titleOverride="");switch(e){case d.default.loading:return o.TipHeadingNoFile;case d.default.tip:return r._getDocNameTitle();case d.default.resolve:return o.ResolveTitle;case d.default.justify:return o.OverrideTitle;case d.default.status:return r._titleOverride||r._getDocNameTitle();case d.default.error:return r._titleOverride||o.ErrorTitle}return""});this.subscribe(this._action,function(e){0===e?r._handleOverrideClick():1===e&&r._updateServer()});this._itemPromise.done(function(e){var t=e[0];if(t)if(2!==t.policyTip){r._item(t);r._policyTipDataSource.getPolicyTip(t).done(function(e){if(e){e.issueDescriptions&&e.issueDescriptions.length&&p.Engagement.logData({name:"PolicyTip.ItemWithIssues",extraData:{count:e.issueDescriptions.length}});r._info(e);r._state(d.default.tip)}else{r._errorType=_.NoPolicyTipInitial;r._showError()}},function(e){r._errorType=_.GetInfoServerError;r._showError(e)})}else{r._errorType=_.NoNotifyAction;r._showError()}else{r._errorType=_.ItemNotFound;r._showError()}},function(e){r._errorType||(r._errorType=_.GetItemServerError);r._showError(e)});var n={item:this._item,policyInfo:this._info,state:this._state,buttonsAvailable:this._buttonsAvailable,justificationText:this._justificationText,justificationError:this._justificationError,messageText:this._messageText,action:this._action,logEvt:this._logEvt},a=function(e){return r.createPureComputed(function(){return r._state()===e})},s=this.observables.create(!1);this.subscribe(s,function(e){r._buttonsAvailable(!e)});return this._dialogProvider.requestDialog({title:this._title,size:"Medium",component:{name:l.default.tagName,params:n},actions:[{name:o.TipResolve,execute:function(){return r._showState(d.default.resolve,"Resolve")},isVisible:a(d.default.tip),isAvailable:this._buttonsAvailable,isDefault:!0,icon:new h.default("Save"),automationId:"PolicyTipDialogResolve"},{name:o.TipClose,execute:function(){return r._dismissWithButton("Close")},isVisible:this.createPureComputed(function(){var e=r._state();return e===d.default.tip||e===d.default.error}),isAvailable:this._buttonsAvailable,icon:new h.default("Cancel"),automationId:"PolicyTipDialogClose"},{name:o.ResolveBack,execute:function(){return r._showState(d.default.tip,"Back")},isVisible:a(d.default.resolve),isAvailable:this._buttonsAvailable,icon:new h.default("Cancel"),automationId:"PolicyTipDialogBack"},{name:o.OverrideSubmit,execute:function(){r._logClick("Submit");return r._submitOverride()},isVisible:a(d.default.justify),isAvailable:this._buttonsAvailable,isDefault:!0,icon:new h.default("Save"),automationId:"PolicyTipDialogSubmit",isExecuting:s},{name:o.OverrideCancel,execute:function(){return r._dismissWithButton("Cancel")},isVisible:a(d.default.justify),isAvailable:this._buttonsAvailable,icon:new h.default("Cancel"),automationId:"PolicyTipDialogCancel"},{name:o.StatusOK,execute:function(){r._logClick("OK");return u.default.wrap(2)},isVisible:a(d.default.status),isAvailable:this._buttonsAvailable,isDefault:!0,icon:new h.default("Save"),automationId:"PolicyTipDialogOK"}]}).wait().then(function(){return u.default.wrap(r._evtEndObj)},function(){r._dismissedByButton||r._logClick("Dismiss");r._evtEndObj||(r._evtEndObj={resultType:m.ResultTypeEnum.ExpectedFailure,resultCode:"CanceledOrClosed"});return u.default.wrap(r._evtEndObj)})};e.prototype._showState=function(e,t){this._logClick(t);this._state(e);return u.default.wrap(1)};e.prototype._dismissWithButton=function(e){this._logClick("Close");this._dismissedByButton=!0;return u.default.wrap(3)};e.prototype._logClick=function(e){var t=d.default[this._state()],i="PolicyTip."+(t=t.charAt(0).toUpperCase()+t.slice(1))+"State."+e+".Click";p.Engagement.logData({name:i},this._logEvt)};e.prototype._getDocNameTitle=function(){var e=this._item();return s.format(c.strings.TipHeading,e?e.displayName||e.name:"")};e.prototype._handleOverrideClick=function(){if(2!==this._info().overrideOption)return this._submitOverride();this._justificationError("");this._state(d.default.justify)};e.prototype._submitOverride=function(){if(2!==this._info().overrideOption||this._justificationText()){this._justificationError("");this._updateServer()}else this._justificationError(c.strings.OverrideError);return u.default.wrap(1)};e.prototype._updateServer=function(){var t=this,i=c.strings;this._buttonsAvailable(!1);var e={item:this._item(),action:this._action(),justification:this._justificationText()};this._policyTipDataSource.updatePolicy(e).done(function(e){if(null===e){t._errorType=_.UpdateServerNoResult;t._showError()}else if(0===e){t._errorType=_.NoPolicyTipFinal;t._showError()}else{t._titleOverride=i.StatusTitle;1===e?t._messageText(i.StatusReportSuccess):t._messageText(i.StatusOverrideSuccess);t._evtEndObj={resultType:m.ResultTypeEnum.Success};t._state(d.default.status);t._buttonsAvailable(!0)}},function(e){t._errorType=_.UpdateServerError;t._showError(e)})};e.prototype._showError=function(e){var t,i=c.strings;try{"string"==typeof e&&(e=JSON.parse(e))}catch(e){}switch(this._errorType){case _.ItemNotFound:this._titleOverride=i.FileNotFoundTitle;this._messageText(i.FileNotFoundMessage);t=m.ResultTypeEnum.Failure;break;case _.NoPolicyTipInitial:case _.NoPolicyTipFinal:this._titleOverride=this._getDocNameTitle();this._messageText(i.StatusNoPolicyTip);t=m.ResultTypeEnum.ExpectedFailure;break;case _.NoNotifyAction:this._titleOverride=this._getDocNameTitle();this._messageText(o.strings.policyTipBlockText);t=m.ResultTypeEnum.ExpectedFailure;break;default:this._messageText(e&&e.error&&e.error.message&&e.error.message.value||e&&e.detailedText||"string"==typeof e&&e||i.ErrorText);t=m.ResultTypeEnum.Failure}this._evtEndObj={resultCode:_[this._errorType],resultType:t,error:this._messageText(),extraData:{error:e}};this._buttonsAvailable(!0);this._state(d.default.error)};return e}(r.default);t.default=b});define("R5",["require","exports","Se","Sd","b5","Sc","Sb","Sa","R9","R8","R7","R6","lB"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o.registerComponent({tagName:"od-policy-tip-dialog",template:e("Sc"),viewModel:i.default});o.registerTemplate(r.default.LOADING,e("Sb"));o.registerTemplate(r.default.TIP,e("Sa"));o.registerTemplate(r.default.RESOLVE,e("R9"));o.registerTemplate(r.default.JUSTIFY,e("R8"));o.registerTemplate(r.default.MESSAGE,e("R7"));t.default=n});define("Se",["require","exports","ap","R4","Sd","R3","bF","Sf","qH","cJ","bX","cS","hs","a0","V","d5","lB"],function(e,t,i,o,n,a,r,s,l,d,c,u,p,m,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=0,v=function(r){i.__extends(e,r);function e(e){var i=r.call(this,e)||this;i.loadingSpinnerTagName=g.default.tagName;i.addBindingHandlers({bindableHtml:l.default,keyboard:d.default,visibility:s.default});y++;i.strings=a.strings;i.info=e.policyInfo;i._state=e.state;i.buttonsAvailable=e.buttonsAvailable;i._action=e.action;i._item=e.item;i.justificationText=e.justificationText;i.justificationError=e.justificationError;i.messageText=e.messageText;i.justificationTextId="ms-policy-tip-justify-"+y;i._parentEvt=e.logEvt;i.resolveSections=[{heading:i.strings.ResolveOverrideHeading,descriptionHtml:h.format(i.strings.ResolveOverrideInfo,'<span class="ms-fontWeight-semibold">',"</span>"),buttonText:i.strings.ResolveOverride,buttonClick:function(){return i._overrideClick()},automationId:"PolicyTipDialogOverride",isVisible:function(){return!!i.info().overrideOption},isSpinnerVisible:i.createPureComputed(function(){return!i.buttonsAvailable()&&0===i._action()})},{heading:i.strings.ResolveReportHeading,descriptionHtml:h.format(i.strings.ResolveReportInfo,'<span class="ms-fontWeight-semibold">',"</span>"),buttonText:i.strings.ResolveReport,buttonClick:function(){return i._reportClick()},automationId:"PolicyTipDialogReport",isVisible:function(){return!0},isSpinnerVisible:i.createPureComputed(function(){return!i.buttonsAvailable()&&1===i._action()})}];var t=i.resources.consume(f.resourceKey);i.resolveDescriptionFirst=i.createPureComputed(function(){var e=t.formFactorSize();return"Small"===e||"Medium"===e});i.templateName=i.createPureComputed(function(){return n.default.getTemplateName(i._state())});i.resolutionTemplate=i.createPureComputed(function(){var e=i.info();if(e){var t="";if(e.policyInfoUrl){t=h.format(i.strings.TipLearnMore,'<a href="javascript:" data-bind="click: $component.learnMoreClick.bind($component), keyboard: learnMoreKeyboardInfo">',"</a>");i.learnMoreKeyboardInfo={mappings:{Enter:i.learnMoreClick.bind(i),Space:i.learnMoreClick.bind(i)},preventDefault:!0}}i.openKeyboardInfo={mappings:{Enter:i.openClick.bind(i),Space:i.openClick.bind(i)},preventDefault:!0};return h.format(i.strings.TipText,'<a href="javascript:" data-bind="click: openClick, keyboard: openKeyboardInfo">',"</a>",'<span class="ms-fontWeight-semibold">',"</span>",t)}return""});i.lastScannedText=i.createPureComputed(function(){var e=i.info();if(e)try{return i.strings.TipLastScanned+": "+p.getRelativeDateTimeStringPast(e.lastScanned)}catch(e){}return""});i.subscribe(i._state,function(){var e=document.getElementsByClassName("od-Dialog")[0];e&&u.focusFirstTabStop(e)});m.Engagement.logData({name:"PolicyTip.DialogRendered",extraData:{screenSize:t.formFactorSize()}},i._parentEvt);return i}e.prototype.openClick=function(e){this._logClick("OpenItem");var t=this.resources.consume(c.actionMap),i=new(this.child(t.DefaultClickAction))({item:this._item,userInvokedItem:!0,sourceEngagement:"PolicyTip.Open.Click"});i.isAvailable()&&i.execute(e);i.dispose()};e.prototype.learnMoreClick=function(){this._logClick("LearnMore");window.open(this.info().policyInfoUrl,"_blank");return!1};e.prototype._overrideClick=function(){this._logClick("Override");this._action(0);return!1};e.prototype._reportClick=function(){this._logClick("Report");this._action(1);return!1};e.prototype._logClick=function(e){var t=o.default[this._state()],i="PolicyTip."+(t=t.charAt(0).toUpperCase()+t.slice(1))+"State."+e+".Click";m.Engagement.logData({name:i},this._parentEvt)};return e}(r.default);t.default=v});define("R4",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.loading=0]="loading";e[e.tip=1]="tip";e[e.resolve=2]="resolve";e[e.justify=3]="justify";e[e.status=4]="status";e[e.error=5]="error"}(i||(i={}));t.default=i});define("Sd",["require","exports","R4"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function t(){}t.getTemplateName=function(e){switch(e){case i.default.loading:return t.LOADING;case i.default.tip:return t.TIP;case i.default.resolve:return t.RESOLVE;case i.default.justify:return t.JUSTIFY;case i.default.status:case i.default.error:return t.MESSAGE;default:return t.LOADING}};t.LOADING="od-policy-tip-loading";t.TIP="od-policy-tip-tip";t.RESOLVE="od-policy-tip-resolve";t.JUSTIFY="od-policy-tip-justify";t.MESSAGE="od-policy-tip-message";return t}();t.default=r});define("Sf",["require","exports","aq"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.update=function(e,t){var i=r.unwrap(t());e.style.visibility=i?"inherit":"hidden"};return e}();t.default=i});define("Sc",[],function(){return'<div class=od-PolicyTip data-bind="template: { name: templateName }"></div>'});define("Sb",[],function(){return'<div class=od-PolicyTip-loading data-bind="component: { name: $component.loadingSpinnerTagName, params: { loadingText: strings.TipLoadingText } }"></div>'});define("Sa",[],function(){return'<div class=od-PolicyTip-issuesExplanation>\x3c!--ko if: info().explanationText--\x3e<span data-bind="text: info().explanationText"></span><br><br>\x3c!--/ko--\x3e<span data-bind="bindableHtml: resolutionTemplate"></span></div><i class="od-PolicyTip-issuesIcon ms-Icon ms-Icon--DRM" data-bind="icon: true"></i><h3 class="od-PolicyTip-issuesHeader ms-font-m ms-fontWeight-semibold" data-bind="text: strings.TipIssues"></h3><ul class=od-PolicyTip-issueList data-bind="foreach: info().issueDescriptions"><li data-bind="text: $data"></li></ul><div class=od-PolicyTip-lastScannedRow data-bind="attr: { title: strings.TipLastScannedHelp, alt: strings.TipLastScannedHelp }, text: lastScannedText"></div>'});define("R9",[],function(){return'\x3c!--ko foreach: resolveSections--\x3e<div class=od-PolicyTip-resolveSection data-bind="visible: isVisible()"><h3 class="od-PolicyTip-resolveHeading ms-font-m" data-bind="text: heading"></h3>\x3c!--ko if: $parent.resolveDescriptionFirst--\x3e<div data-bind="html: descriptionHtml"></div>\x3c!--/ko--\x3e<div class=od-PolicyTip-resolveButton><span class=od-Dialog-actionsLoading data-bind="component: { name: $component.loadingSpinnerTagName, params: { loadingText: \'\' } }, visibility: isSpinnerVisible"></span> <button class="od-Dialog-action od-Button od-Button--primary" data-bind="click: buttonClick, keyboard: { mappings: { Enter: buttonClick, Space: buttonClick }, preventDefault: true }, enable: $parent.buttonsAvailable(), automation: automationId"><span class=od-Button-label data-bind="text: buttonText"></span></button></div>\x3c!--ko ifnot: $parent.resolveDescriptionFirst--\x3e<div data-bind="html: descriptionHtml"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});define("R8",[],function(){return'<div class="od-TextField od-TextField--multiline"><label class="ms-Label od-PolicyTip-justifyLabel" data-bind="attr: { \'for\': justificationTextId }, text: strings.OverrideDescription"></label> <textarea class="od-PolicyTip-justifyText od-TextField-field" required aria-required=true maxlength=255 data-bind="value: justificationText, hasFocus: true, attr: { id: justificationTextId, placeholder: strings.OverridePlaceholder }, css: { \'od-PolicyTip-justifyText--error\': justificationError }"></textarea></div><div class=od-PolicyTip-justifyError aria-live=assertive data-bind="text: justificationError"></div>'});define("R7",[],function(){return'<div class=od-PolicyTip-section data-bind="text: messageText"></div>'});define("R6",["c","az"],function(e,t){e.loadStyles([{rawString:".od-PolicyTip{height:255px;overflow-x:hidden;position:relative;margin-top:8px}.od-PolicyTip .od-TextField.od-TextField--multiline{margin:0}.od-PolicyTip .od-TextField.od-TextField--multiline .ms-Label{padding-top:0}.od-PolicyTip-loading{text-align:center;position:relative;top:102.5px}.od-PolicyTip-issuesExplanation{margin-bottom:24px}.od-PolicyTip-issuesHeader{padding:0;margin:0 32px}.od-PolicyTip-issuesIcon{padding:2px 8px 0;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:17px;height:16px;width:16px;cursor:default}html[dir=ltr] .od-PolicyTip-issuesIcon{float:left}html[dir=rtl] .od-PolicyTip-issuesIcon{float:right}.od-PolicyTip-issueList{margin:8px 0 24px}[dir=ltr] .od-PolicyTip-issueList{padding-left:29px}[dir=rtl] .od-PolicyTip-issueList{padding-right:29px}[dir=ltr] .od-PolicyTip-issueList li{padding-left:3px}[dir=rtl] .od-PolicyTip-issueList li{padding-right:3px}.od-PolicyTip-lastScannedRow{cursor:default;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-PolicyTip-resolveSection{margin-bottom:24px}.od-PolicyTip-resolveHeading{color:"},{theme:"themeSecondary",defaultValue:"#2f69c0"},{rawString:";margin:0;padding:0 0 8px}.lg .od-PolicyTip-resolveButton,.xlg .od-PolicyTip-resolveButton,.xxlg .od-PolicyTip-resolveButton,.xxxlg .od-PolicyTip-resolveButton,.xxxxlg .od-PolicyTip-resolveButton{margin-bottom:2em}html[dir=ltr] .lg .od-PolicyTip-resolveButton,html[dir=ltr] .xlg .od-PolicyTip-resolveButton,html[dir=ltr] .xxlg .od-PolicyTip-resolveButton,html[dir=ltr] .xxxlg .od-PolicyTip-resolveButton,html[dir=ltr] .xxxxlg .od-PolicyTip-resolveButton{float:right}html[dir=rtl] .lg .od-PolicyTip-resolveButton,html[dir=rtl] .xlg .od-PolicyTip-resolveButton,html[dir=rtl] .xxlg .od-PolicyTip-resolveButton,html[dir=rtl] .xxxlg .od-PolicyTip-resolveButton,html[dir=rtl] .xxxxlg .od-PolicyTip-resolveButton{float:left}[dir=ltr] .lg .od-PolicyTip-resolveButton,[dir=ltr] .xlg .od-PolicyTip-resolveButton,[dir=ltr] .xxlg .od-PolicyTip-resolveButton,[dir=ltr] .xxxlg .od-PolicyTip-resolveButton,[dir=ltr] .xxxxlg .od-PolicyTip-resolveButton{margin-left:24px}[dir=rtl] .lg .od-PolicyTip-resolveButton,[dir=rtl] .xlg .od-PolicyTip-resolveButton,[dir=rtl] .xxlg .od-PolicyTip-resolveButton,[dir=rtl] .xxxlg .od-PolicyTip-resolveButton,[dir=rtl] .xxxxlg .od-PolicyTip-resolveButton{margin-right:24px}.md .od-PolicyTip-resolveButton,.sm .od-PolicyTip-resolveButton{display:inline-block;width:100%;margin-top:8px}html[dir=ltr] .md .od-PolicyTip-resolveButton,html[dir=ltr] .sm .od-PolicyTip-resolveButton{text-align:right}html[dir=rtl] .md .od-PolicyTip-resolveButton,html[dir=rtl] .sm .od-PolicyTip-resolveButton{text-align:left}.od-PolicyTip-resolveButton button{min-width:100px}.od-PolicyTip-justifyLabel.ms-Label{padding-bottom:16px}.od-PolicyTip-justifyText{overflow:auto}.od-TextField.od-TextField--multiline .od-PolicyTip-justifyText.od-TextField-field{min-height:150px;font-size:12px}.od-PolicyTip-justifyText--error.od-TextField-field{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-PolicyTip-justifyError{padding-top:2px;height:2em;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}"}])});define("Sg",["require","exports","ap","Sj","Sh","eO","bA"],function(e,t,i,o,n,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={1000:!0,1012:!0},l=1,d=2,c=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._fileSystemProvider=t.fileSystemProvider;i._context=e;i.registerActions({overwrite:i._onOverwrite,rename:i._onRename});return i}e.prototype.getOperationDetails=function(e){var t=r.prototype.getOperationDetails.call(this,e),i=e.input;t.name=i.name;t.iconName=i.iconName;t.type=o.OperationType.restoreItems;t.payloads={restoreItems:{item:i}};2===e.status&&e.error&&e.error.code in s&&i.type!==a.default.Folder&&t.actions.push(this._onOverwrite,this._onRename);return t};e.prototype.onStart=function(e){var t=this._context.items.map(function(e){return new o.Task(e.key,e)});e.update(t);return this._fileSystemProvider.restoreItems({parentKey:this._context.parentKey,retainAcls:this._context.retainAcls,items:t.map(function(e){return e.input})},e)};e.prototype._onRename=function(e,t){e=e.map(function(e){return e.restart()});t.update(e);return this._fileSystemProvider.restoreItems({parentKey:this._context.parentKey,items:e.map(function(e){return e.input}),retainAcls:this._context.retainAcls,nameConflict:d},t)};e.prototype._onOverwrite=function(e,t){e=e.map(function(e){return e.restart()});t.update(e);return this._fileSystemProvider.restoreItems({parentKey:this._context.parentKey,items:e.map(function(e){return e.input}),retainAcls:this._context.retainAcls,nameConflict:l},t)};e.dependencies=i.__assign({},o.default.dependencies,{fileSystemProvider:n.resourceKey});return e}(o.default);t.default=c;t.typeResourceKey=r.createResolvedTypeResourceKey(e("module").id,c)});define("Sj",["require","exports","ap","bN","eS","Sk","aC","bE","dR","dY","eQ","cg","dW"],function(e,t,i,r,o,a,s,l,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Task=o.default;t.TaskObserver=a.default;t.OperationType=p.default;var h="_BaseOperator_actionName",n=function(n){i.__extends(e,n);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=n.call(this,e,t)||this;i._actionsByName={};var r=t.operationProvider,o=void 0===r?i.resources.consume(d.resourceKey):r;i._operationProvider=o;i._operationBatch=new m.default;i._operationsByKey={};i._completionSignal=new l.default;i._completionSignal.getPromise().done(function(){i.dispose()},function(){i.dispose()});i._observer=i.addDisposable(new a.default(i._onTaskChanges.bind(i)));i._throttleExecuteAllActions=i.async.debounce(i._executeAllActions);i.registerActions({cancel:i.onCancel});i.addDisposable(i._operationProvider.groups.subscribe(i._onOperationProviderGroupsChanged,i,"arrayChange"));return i}e.prototype.dispose=function(){n.prototype.dispose.call(this);this._observer=null;this._actionsByName={};this._getActionExecutor=null;this._onTaskChanges=null;this._operationsByKey={};this._groupOperation=null;this._throttleExecuteAllActions=null};e.prototype.start=function(){var t=this;return this.onStart(this._observer).then(function(){t._completeIfNoGroupCreated()},function(e){t._completeIfNoGroupCreated();return s.default.wrapError(e)})};e.prototype.wait=function(){return this._completionSignal.getPromise()};e.prototype.onStart=function(e){return s.default.wrap()};e.prototype.onCancel=function(e,t){e=e.map(function(e){return e.cancel()});t.update(e);return s.default.wrap()};e.prototype.registerActions=function(e){for(var t in e){var i=e[t];if(i){i[h]=t;this._actionsByName[t]={action:e[t],callback:e[t].bind(this),queue:[],signal:new l.default}}else delete this._actionsByName[t]}};e.prototype.getOperationDetails=function(e){var t;t=1===e.status?c.default.completed:2===e.status?c.default.failed:3===e.status?c.default.canceled:c.default.started;return{type:p.default.multiple,name:"",iconName:null,error:e.error&&new u.default({message:e.error.message,payloads:{}})||null,state:t,progress:{minimum:0,maximum:3!==e.status?1:0,current:1===e.status?1:0},visibility:0,payloads:{},actions:[]}};e.prototype.onOperationFinished=function(e){};e.prototype._queueTaskForAction=function(e,t){var i=this._actionsByName[e];i.queue.push(t);this._throttleExecuteAllActions();return i.signal.getPromise()};e.prototype._executeAllActions=function(){for(var e in this._actionsByName){var t=this._actionsByName[e],i=t.signal;t.signal=new l.default;if(t.queue.length){var r=t.queue.splice(0,t.queue.length);t.callback(r,this._observer).done(f(i),g(i))}}};e.prototype._onTaskChanges=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];this._updateOperationForTask(r)}};e.prototype._updateOperationForTask=function(e){var t,i=e.current,r=this.getOperationDetails(i),o=this._operationsByKey[i.key];t={};for(var n=0,a=r.actions;n<a.length;n++){var s=a[n],l=s[h],d=this._actionsByName[l];d&&d.action===s&&(t[l]=!0)}if(!o){var c={};for(var l in this._actionsByName)c[l]={isAvailable:this.createObservable(l in t),execute:this._getActionExecutor(l,i)};var u={batch:this._operationBatch,type:r.type,name:r.name,iconName:r.iconName,payloads:r.payloads,progress:r.progress,visibility:r.visibility,actions:c};o=this._operationsByKey[i.key]=this._operationProvider.register(u)}if(o.name!==r.name){o.name=r.name;o.payloads(r.payloads)}o.progress.minimum(r.progress.minimum);o.progress.maximum(r.progress.maximum);o.progress.current(r.progress.current);o.type(r.type);o.error(r.error);o.state(r.state);for(var l in this._actionsByName)o.actions.peek()[l].isAvailable(l in t)};e.prototype._getActionExecutor=function(e,t){var i=this;return function(){return i._queueTaskForAction(e,t)}};e.prototype._createGroupOperationSubscription=function(t){var e=this,i=this.createPureComputed(function(){var e=t.state();return e===c.default.completed||e===c.default.canceled||e===c.default.failed||e===c.default.expired});this.createBackgroundComputed(function(){i()&&e.observables.ignore(function(){e.onOperationFinished(t)})})};e.prototype._onOperationProviderGroupsChanged=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t],o=r.value;if(o.batch===this._operationBatch)if("added"===r.status){if(!this._groupOperation){this._groupOperation=o;this._createGroupOperationSubscription(o)}}else"deleted"!==r.status||r.moved||this._completionSignal.complete()}};e.prototype._completeIfNoGroupCreated=function(){this._groupOperation||this._completionSignal.complete()};e.dependencies=i.__assign({},r.default.dependencies,{operationProvider:d.resourceKey});return e}(r.default);t.default=n;function f(e){return function(){return e.complete()}}function g(t){return function(e){return t.error(e)}}});define("Sk",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._tasksByKey={};this._onChanges=e}e.map=function(i,r){return{update:function(e,t){void 0===t&&(t=!1);i.update(e.map(function(e){return r(e)}),t)}}};e.prototype.dispose=function(){this._tasksByKey={};this._onChanges=null};e.prototype.getTasks=function(){var e=[];for(var t in this._tasksByKey)e.push(this._tasksByKey[t]);return e};e.prototype.getTask=function(e){return this._tasksByKey[e]};e.prototype.update=function(e,t){void 0===t&&(t=!1);var i,r,o;i={};for(var n in this._tasksByKey)i[n]=this._tasksByKey[n];o=[];for(var a=0,s=e;a<s.length;a++){var l=s[a],d=i[l.key],c=l.compare(d);c&&o.push(c);delete i[l.key];this._tasksByKey[l.key]=l}if(t)for(var n in i){r=i[n];delete this._tasksByKey[n];o.push({previous:r,current:null})}this.onChanges(o)};e.prototype.onChanges=function(e){this._onChanges&&this._onChanges(e)};return e}();t.default=i});define("Sh",["require","exports","aC","bA","dJ","Si","eT","iJ","eX","eW","eS","dZ","d7","eU"],function(e,t,i,r,n,s,o,a,l,d,p,c,u,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(e,t){this._itemDataSource=t.itemDataSource;this._deleteRestoreDataSource=t.deleteRestoreDataSource;this._itemProvider=t.itemProvider;this._itemTaskObserver=new t.itemTaskObserverType;this._photoProvider=t.photoProvider;this._store=t.itemsStore;this._tagProvider=t.tagProvider;this._updateQuota=t.updateQuota}e.prototype.createFolder=function(e,t){var i=this,r=e.parent.key,o=e.folderName,n=new p.default(r+"&cf="+o,o);return this._performOperation([r],t,n,function(){return i._itemDataSource.createFolder(e)})};e.prototype.renameItem=function(e,t){var i=this,r=e.item,o=r.key,n=new p.default(o,r);return this._performOperation([e.parentKey,o],t,n,function(){return i._itemDataSource.renameItem(e)})};e.prototype.deleteItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleDelete)};e.prototype.restoreItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleRestore)};e.prototype.restoreAll=function(e){var t=this;return this._deleteRestoreDataSource.restoreAll(e).then(function(){t._itemProvider.invalidateItem(e.parentKey);t._updateQuota(!0);return!0})};e.prototype._handleDelete=function(o){var n=this,a=this._itemProvider;return this._deleteRestoreDataSource.deleteItems(o).then(function(e){var t;o.deletionType===s.default.Recycle&&(t={triggerFetch:!1,emptyAllOtherSets:!0});a.invalidateItem(o.parentKey,t);var i=o.items.map(function(e){return new p.default(e.key).succeed({item:{key:e.key,parentKey:m.remove()}})}),r=n._itemTaskObserver;r.update(i);r.flush();return e})};e.prototype._handleRestore=function(t){var i=this;return this._deleteRestoreDataSource.restoreItems(t).then(function(e){i._itemProvider.invalidateItem(t.parentKey);return e})};e.prototype._handleDeleteOrRestore=function(s,l,e){var o=this,d={},c=s.items.map(function(e){return d[e.id]=new p.default(e.key,e)}),u=this._itemProvider;l.update(c);return e.call(this,s).then(function(e){for(var t=0,i=s.items;t<i.length;t++){var r=i[t];o._invalidatePhoto(r)}o._store.invalidateAllPhotos();o._invalidateAllTags();c=c.map(function(e){return e.succeed()});l.update(c)},function(e){u.invalidateItem(s.parentKey);var t=e.data&&e.data.items||[];c=[];for(var i=0,r=t;i<r.length;i++){var o=r[i],n=d[o.id];delete d[o.id];c.push(o.error?n.fail(o.error):n.succeed())}for(var a in d){n=d[a];c.push(n.cancel())}l.update(c)}).then(function(){o._updateQuota(!0)})};e.prototype._invalidatePhoto=function(e){var t=n.deserializeQuery(e.key);delete t.qt;this._store.invalidateItem(n.serializeQuery(t));if(e.tags)for(var i=0,r=e.tags;i<r.length;i++){var o=r[i];this._store.invalidateLocation(o.tag)}};e.prototype._invalidateAllTags=function(){var e=this._photoProvider,t=this._tagProvider;if(e&&t){var i=e.getAllPhotosSettings().peek();t.invalidateAllTags(i.rootId)}};e.prototype._performOperation=function(o,n,a,e){var s=this;n.update([a]);return e().then(function(e){for(var t=0,i=o;t<i.length;t++){var r=i[t];s._itemProvider.invalidateItem(r)}n.update([a.succeed(e)])},function(e){var t=new Error(e);n.update([a.fail(t)]);return i.default.wrapError(t)})};e.dependencies={itemDataSource:c.items,deleteRestoreDataSource:c.deleteRestore,itemProvider:l.resourceKey,itemsStore:a.resourceKey,itemTaskObserverType:o.resourceKey,photoProvider:u.photo.optional,tagProvider:u.tag.optional,updateQuota:d.resourceKey};return e}();t.default=h;t.resourceKey=r.createResolvedResourceKey(e("module").id,h)});define("Si",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Recycle=2]="Recycle";e[e.PermanantDelete=3]="PermanantDelete";e[e.MoveToSecondStage=4]="MoveToSecondStage"}(i||(i={}));t.default=i});define("Sl",["require","exports","ap","Sj","cg","vB","bA"],function(e,t,i,o,n,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,{},t)||this;i._context=e;i._clientFormProvider=t.clientFormProvider;return i}e.prototype.getOperationDetails=function(e){var t=r.prototype.getOperationDetails.call(this,e),i=e.input;t.type=n.default.updateMetadata;t.name=i.name;t.iconName=i.iconName;return t};e.prototype.onStart=function(e){return this._clientFormProvider.updateItemMetadata(this._context,e)};e.dependencies=i.__assign({},o.default.dependencies,{clientFormProvider:a.resourceKey});return e}(o.default);t.default=s;t.typeResourceKey=r.createResolvedTypeResourceKey(e("module").id,s)});define("Sm",["require","exports","ap","Sn","aq","eX","d7","bX","bA"],function(e,t,i,r,o,n,s,l,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=4e3,c=function(a){i.__extends(e,a);function e(e,t){var i=a.call(this,e,t)||this,r=t.itemProvider,o=t.uploadTeachingBubbleProvider,n=t.didUserUploadOrCreateFile;i.itemProvider=r;i._uploadTeachingBubbleProvider=o;i._invalidateItem=i.createBackgroundComputed(i._computeInvalidateItem).extend({rateLimit:{timeout:d}});i._shouldInvalidate=!e.skipInvalidation;i._context.itemSet&&(i._currentItem=i._context.itemSet.item.peek());i._didUserUploadOrCreateFile=n;i._itemCount=0;return i}e.prototype.dispose=function(){this._shouldInvalidate&&this._invalidateItem();a.prototype.dispose.call(this)};e.prototype.onItemUploaded=function(e){if(this._currentItem){this._itemCount++;var t=this._uploadTeachingBubbleProvider;if(t&&t.isUserInUploadFRE())switch(this._itemCount){case 1:t.addBubbleToItem(e,this._currentItem,this._itemCount);break;case 2:t.updateActiveBubble(e,this._currentItem,this._itemCount)}this._didUserUploadOrCreateFile&&this._didUserUploadOrCreateFile(!0)}};e.prototype.onOperationFinished=function(e){this._shouldInvalidate&&this._invalidateItem();a.prototype.onOperationFinished.call(this,e)};e.prototype._computeInvalidateItem=function(){this._lastUploadedItem();if(!o.computedContext.isInitial()&&this._shouldInvalidate){this.itemProvider.invalidateItem(this._context.parentItem.key,{triggerFetch:!0});this._context.item&&this.itemProvider.invalidateItem(this._context.item.key,{triggerFetch:!0})}};e.dependencies=i.__assign({},r.default.dependencies,{itemProvider:n.resourceKey,uploadTeachingBubbleProvider:s.uploadTeachingBubble.optional,didUserUploadOrCreateFile:l.didUserUploadOrCreateFile.optional});return e}(r.default);t.default=c;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,c)});define("Sn",["require","exports","ap","Sj","cg","dY","tb","aC","aI","dG","fm","gL","eW","dZ","bA"],function(e,t,i,s,n,l,d,a,c,u,r,p,m,h,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,{},t)||this;i._context=e;i._uploader=new(i.scope.attached(t.batchUploaderType))(e);i._updateQuota=t.updateQuota;i.registerActions({cancel:i.onCancel,overwrite:i._onOverwrite,rename:i._onRename,restart:i._onRestart});i._lastUploadedItem=i.createObservable();return i}e.prototype.getOperationDetails=function(e){var t=o.prototype.getOperationDetails.call(this,e),i=e.input,r=e.error;t.type=n.default.uploadItems;t.name=i.fileName.peek();t.iconName=i.iconName.peek();t.payloads.uploadItems={parent:this._context.parentItem,name:e.output.name};0===e.output.state&&(t.state=l.default.created);0===e.status&&e.output.uploadedBytes<e.output.totalBytes&&t.actions.push(this.onCancel);t.progress.maximum=e.output.totalBytes;t.progress.current=e.output.uploadedBytes;if(2===e.status){r&&(t.error.payloads.upload={error:r});if(!i.nameConflictBehavior.peek()&&r&&r.errorType===d.UploadErrorType.conflict){t.actions.push(this._onOverwrite);i.allowRename&&t.actions.push(this._onRename)}}2!==e.status||r&&r.errorType!==d.UploadErrorType.general||t.actions.push(this._onRestart);return t};e.prototype.onStart=function(e){this._event=new r.UploadOperation({name:"UploadOperation",dragAndDrop:this._context.wasDragAndDropped,uploadType:u.UploadProcessorType[this._context.type]});this._processUploader(this._uploader,e);return this._uploader.start()};e.prototype.onCancel=function(e,t){for(var i=0,r=e;i<r.length;i++){r[i].input.abort()}return a.default.wrap()};e.prototype.onOperationFinished=function(e){var t,i,r,o=e.state.peek(),n=e.states.peek(),a=e.operations.peek(),s=e.error.peek();if(o===l.default.completed){t=c.ResultTypeEnum.Success;this._updateQuota(!0)}else t=o===l.default.canceled?c.ResultTypeEnum.ExpectedFailure:c.ResultTypeEnum.Failure;i=1===a.length?p.getFileExtension(e.payloads.peek().uploadItems.name):"";r=s?s.payloads.upload?s.payloads.upload.error.errorType:d.UploadErrorType.other:d.UploadErrorType.none;this._event&&this._event.end({size:e.progress.maximum.peek(),count:a.length,failCount:n.failed,successCount:n.completed,abortCount:n.canceled,resultType:t,dragAndDrop:this._context.wasDragAndDropped,uploadType:u.UploadProcessorType[this._context.type],extension:i,extraData:{uploadOperation_ErrorType:d.UploadErrorType[r]}})};e.prototype.onItemUploaded=function(e){};e.prototype._updateTaskOutput=function(e,t){return t};e.prototype._processUploader=function(e,t){var o=this;this.addDisposable(e);var n=function(e){t.update([e])},a=0;this.addDisposable(e.filesUploading.map({mappingWithDisposeCallback:function(t){var i="&u="+ ++a,r=o._createUploaderTaskSubscription(t,i,n);return{mappedValue:i,dispose:function(){r.dispose();var e=o._computeTask(t,i);0===e.status&&(e=e.cancel());n(e)}}}}))};e.prototype._onRestart=function(e,t){for(var i=0,r=e;i<r.length;i++){r[i].input.restart()}return a.default.wrap()};e.prototype._onOverwrite=function(e,t){for(var i=0,r=e;i<r.length;i++){var o=r[i];o.input.nameConflictBehavior(1);o.input.restart()}return a.default.wrap()};e.prototype._onRename=function(e,t){for(var i=0,r=e;i<r.length;i++){var o=r[i];o.input.nameConflictBehavior(2);o.input.restart()}return a.default.wrap()};e.prototype._createUploaderTaskSubscription=function(i,r,o){var n=this,a=!1,s=this.createComputed(function(){var e=n._computeTask(i,r);a=1===e.status||3===e.status;if(1===e.status){var t=n.unwrapObservable(i.item);t&&n.onItemUploaded(t);n._lastUploadedItem(t)}o(e);a&&s&&s.dispose()}).extend({rateLimit:{timeout:0}});a&&s.dispose();return s};e.prototype._computeTask=function(t,e){var i=new s.Task(e,t),r=t.state(),o=t.error(),n=t.totalBytes(),a=t.uploadedBytes();3===r?i=i.cancel():4===r?i=i.fail(o):2===r&&(i=i.succeed());i=i.changeOutput(function(e){return{state:r,totalBytes:n,uploadedBytes:a,name:t.fileName()}});return i=this._updateTaskOutput(t,i)};e.dependencies=i.__assign({},s.default.dependencies,{updateQuota:m.resourceKey,batchUploaderType:h.batchUploaderType});return e}(s.default);t.default=f;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,f)});define("So",["require","exports","ap","Sm","cg","dY","tb","aC","Em","bA"],function(e,t,i,r,o,a,s,l,d,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(n){i.__extends(e,n);function e(e,t){var i=this;e.behavior=1;i=n.call(this,e,t)||this;var r=t.itemContentProvider;i._itemContentsProvider=r;i.registerActions({restart:null,compare:i._onCompare,overwrite:i._onReplace});return i}e.prototype.getOperationDetails=function(e){var t=n.prototype.getOperationDetails.call(this,e),i=e.input;t.type=o.default.saveItem;t.name=i.fileName.peek();t.iconName=i.iconName.peek();t.payloads.uploadItems={parent:this._context.parentItem,name:i.fileName.peek()};0===i.state.peek()&&(t.state=a.default.created);t.progress.maximum=i.totalBytes.peek();t.progress.current=i.uploadedBytes.peek();switch(e.status){case 0:this._handleStart(t);break;case 1:this._handleSucceeded(t);break;case 2:this._handleFailed(t,e.error)}return t};e.prototype.onCancel=function(e,t){if(this._context.item){var i=this._itemContentsProvider.getItemContent(this._context.item);i.saveSucceded();for(var r=0,o=e;r<o.length;r++){0===o[r].status&&i.saveFailed()}}return n.prototype.onCancel.call(this,e,t)};e.prototype._handleStart=function(e){e.actions.push(this.onCancel);if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).startingSave()}};e.prototype._handleSucceeded=function(e){if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).saveSucceded()}};e.prototype._handleFailed=function(e,t){t&&(e.error.payloads.upload={error:t});if(t&&t.errorType===s.UploadErrorType.versionMismatch){e.actions.push(this._onCompare);e.actions.push(this._onReplace)}if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).saveFailed()}};e.prototype._onReplace=function(e,t){for(var i=0,r=e;i<r.length;i++){var o=r[i];o.input.nameConflictBehavior(3);o.input.restart()}return l.default.wrap()};e.prototype._onCompare=function(e,t){if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).outDated(!0);this.itemProvider.invalidateItem(this._context.item.key,{triggerFetch:!0})}return this.onCancel(e,t)};e.dependencies=i.__assign({},r.default.dependencies,{itemContentProvider:d.resourceKey});return e}(r.default);t.default=c;t.typeResourceKey=n.createResolvedTypeResourceKey(e("module").id,c)});define("Sp",["require","exports","ap","Sm","dG","dZ","cg","eO","gZ","dc","eT","eT","bA"],function(e,t,i,r,l,o,n,a,d,c,u,p,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(s){i.__extends(e,s);function e(e,t){var i=this,r=new Blob(["\ufeff"],{type:d.TEXT_MIME_TYPE});r.name=e.fileName;i=s.call(this,{files:[r],parentItem:e.parentItem,behavior:0,type:l.UploadProcessorType.Html5file,skipInvalidation:!1,wasDragAndDropped:!1},t)||this;var o=t.itemTaskObserverType,n=t.urlDataSource,a=t.navigation;i._itemTaskObserver=new o;i._urlDataSource=n;i._navigation=a;return i}e.prototype.getOperationDetails=function(e){var t=s.prototype.getOperationDetails.call(this,e);t.type=n.default.createItem;return t};e.prototype.onItemUploaded=function(e){this._itemTaskObserver.update([new u.Task(e.key).succeed({item:{key:e.key,type:u.Graft.backup(a.default.File),extension:u.Graft.backup(".txt"),textEditorMimeType:u.Graft.backup(d.TEXT_MIME_TYPE)}})]);this._itemTaskObserver.flush();e=this.peekUnwrapObservable(this._itemTaskObserver.getItem({key:e.key}));var t=this._urlDataSource.getDefaultClickUrl(e,{viewParams:this._navigation.viewParams,preserveAction:!1});this._navigation.navigateTo({url:t,ignoreHistory:!0})};e.dependencies=i.__assign({},r.default.dependencies,{urlDataSource:o.url,navigation:c.navigation,itemTaskObserverType:p.resourceKey});return e}(r.default);t.default=m;t.typeResourceKey=s.createResolvedTypeResourceKey(e("module").id,m)});var __extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();define("Sq",["require","exports","aN","Sr","fb","a3","a2","fc"],function(e,t,J,$,ee,te,ie,re){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){var s=5e3,l=100,d=5e3,c=1234,a="V1",u=0,p=1,m=2,o=65536,n=1e3,h=4,f=12,g=12,t=116444736e5,y=4294967295,v=2147483647,i=0,r=1,_=16,b=8048,x=7993,S=60,C=function(e){this.Tic=0;this.Vals=null;this.Tic=Z();var t=e.length;this.Vals=new Array(t);for(var i=0;i<t;i++)this.Vals[i]=e[i]},P=function(e,t){this.Id=e;this.Val=t;this.Tic=Z()},k=function(e,t){this.Id=e;this.Width=t;this.Rows=new Array(0)},I=function(){this.StartTime=null;this.EndTime=null;this.Flags=0;this.wsaDatapoints=null;this.wsaStreams=null;this.StartTime=X();this.EndTime=null;this.CorrelationId=null;this.Flags=_;this.wsaDatapoints=new Array(0);this.wsaStreams=new Array(0)},T=0,w=null,E=0,D=0,A=0,M=null,F=null,L=0,R=!1,N=!1,O=!1,B="00000000-0000-0000-0000-000000000000",V="",U=null,H=null,q=null,j=null;0;var W=function(a){__extends(e,a);function e(e,t,i,r,o){void 0===o&&(o=s);var n=a.call(this,"/_layouts/15/WsaUpload.ashx",l,[o],!0,d,$.default.DEFAULT_TOTAL_RETRIES,$.default.DEFAULT_RESET_TOTAL_RETRIES_AFTER,i)||this;V=e;j=t;U=new te.default(re.default.STORE_KEY,ie.default.session);(H=U.getValue(re.default.STORE_SIZE_KEY))||(H=0);r&&(n._cid=r);return n}e.prototype.beacon=function(){if("localhost"!==location.hostname){var e=function(){K();return function(){if(null==w)return"";try{if(R){if(Boolean(N))Q(S,r);else{Q(S,i);N=!0}w.EndTime=X();var e=null;try{e=JSON.stringify(w)}catch(e){J.default.log(e)}!function(){M=new Array(0);F=new Array(0);E=A=L=D=E=0;var e=w.CorrelationId;(w=new I).CorrelationId=e;z(c,1);R=!1}();return e}}catch(e){J.default.log(e);return""}}()}();if(null!=e&&0<e.length){var t={"Content-Type":"application/json"};this.sendBeacon(e,t,1e4)}}else if(!window.disableBeaconLogToConsole)try{console.log('Beacon: Uploaded to COSMOS (To disable logging to the console set "window.disableBeaconLogToConsole = true" in the debug window)')}catch(e){}H=0;U.setValue(re.default.STORE_SIZE_KEY,H)};e.prototype._createBeaconRequest=function(e){!function(e){K();Boolean(w)&&(w.CorrelationId=null!=e?e:B)}(this._correlationId);for(var t=0;t<e.length;t++){var i=e[t];re.default.processAndLogEvent({event:i,logFunc:function(e,t){Y(e,t)},eventNamePrefix:V,handlers:j})}this.beacon()};e.prototype._onNewEvent=function(e){};Object.defineProperty(e.prototype,"_correlationId",{get:function(){if(this._cid)return this._cid;var e=window._spPageContextInfo;return e?e.CorrelationId:B},enumerable:!0,configurable:!0});return e}($.default);e.addToLoggingManager=function(e,t,i,r){if(q)throw new Error("The beacon has already been added to the logging manager with event name prefix "+V+".");var o=!1;if(ee.default.instance){e=ee.default.eventNamePrefix;t=ee.default.handlers;o=!0}if(!e||!t)throw new Error("You have to pass in eventNamePrefix and IBeaconHandlers object if no BeaconCache present.");q=new W(e,t,o,i,r);for(var n=0;n<H;n++){var a=U.getValue(n.toString());a&&a.name&&a.props&&Y(a.name,a.props)}};function K(){if(!O){w=new I;M=new Array(0);F=new Array(0);z(c,1);O=!0}}function z(e,t){if(!Boolean(M[e])){var i=new k(e,t),r=D;w.wsaStreams[r]=i;D++;A+=g;M[e]=r}}function G(e,t){try{var i=new C(t);if(function(){var e=E*f+A;if(o<=e){q.beacon();return o<=(e=E*f+A)}return!1}())return;R=!0;Q(b,e);var r=w.wsaStreams[M[e]];if(Boolean(r)){if(!(L<n))throw"Beacon: MAX_ROWS_IN_STREAM exceeded for stream ID "+String(e);r.Rows[L++]=i;A+=function(e){for(var t=h,i=0;i<e.Vals.length;i++){var r=String(e.Vals[i]);t+=2*r.length}return t+=6*(e.Vals.length-1)}(i);Q(x,L)}}catch(e){J.default.log(e)}}function Q(e,t){if(!(e<1||v<e||t<0||y<t)){var i=null,r=F[e];Boolean(r)&&(i=w.wsaDatapoints[r]);if(null==i){var o=new P(e,t),n=E;w.wsaDatapoints[n]=o;F[e]=n;E++}else i.Val=t}}function Y(e,t){K();if(Boolean(e)&&Boolean(t)){var i=new Array(m+1);i[u]=a;i[p]=e;var r=m;for(var o in t){var n=t[o];if(null!=n){n instanceof Date&&(n=n.getTime());i[r++]=o;i[r++]=n}}G(c,i)}}function Z(){var e=(new Date).getTime();0===T&&(T=e);return 1+e-T&2147483647}function X(){var e=(new Date).getTime();e+=t;return e*=1e4}}(i||(i={}));t.default=i});define("Sr",["require","exports","aU","Ss","fX","fg"],function(e,t,c,u,i,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function d(e,t,i,r,o,n,a,s){var l=this;this._lastSendBeacon=0;this._endPointUrl=e;this._maxCriticalFlushInterval=o;this._totalRetries=void 0===n?d.DEFAULT_TOTAL_RETRIES:n;this._totalRetriesStartValue=this._totalRetries;this._resetTotalRetriesAfter=void 0===a?d.DEFAULT_RESET_TOTAL_RETRIES_AFTER:a;this._ignorePreviousEvents=void 0!==s&&s;this._eventBatchCache=new u.default(t,i,function(e){l._onNewEvent&&l._onNewEvent(e)},function(e){l._createBeaconRequest(e)},r);this.init()}d.prototype.sendBeacon=function(e,t,i){this._sendBeacon(e,t,i,0)};d.prototype._sendBeacon=function(r,o,n,a){var s=this;0===a&&(this._lastSendBeacon=c.Manager.getTime());var e=new i.default({url:this._endPointUrl,json:r,headers:o,requestTimeoutInMS:n}),l=new p.Beacon({retryCount:a,totalRetries:this._totalRetries});e.start(function(e,t){l.end({status:t+"",success:!0});if(++s._successfulLogRequests>=s._resetTotalRetriesAfter){s._successfulLogRequests=s._resetTotalRetriesAfter;s._totalRetries=s._totalRetriesStartValue}},function(e,t,i){s._successfulLogRequests=0;l.end({status:t+"",success:!1});if(-2===t&&0<s._totalRetries){s._totalRetries--;s._sendBeacon(r,o,n,a+1)}})};d.prototype.init=function(){var t=this,e=c.Manager.addLogHandler(function(e){t.addEvent(e)});if(!this._ignorePreviousEvents)for(var i=0;i<e.length;i++)this.addEvent(e[i])};d.prototype.addEvent=function(e){if(e.enabled){this._eventBatchCache.addEvent(e);e.critical&&(!this._lastSendBeacon||c.Manager.getTime()-this._lastSendBeacon>this._maxCriticalFlushInterval)&&this._eventBatchCache.flush()}};d.DEFAULT_TOTAL_RETRIES=3;d.DEFAULT_RESET_TOTAL_RETRIES_AFTER=3;return d}();t.default=r});define("Ss",["require","exports","fg","aN"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t,i,r,o){this._events=[];this._flushCount=0;this._maxSize=e;this._newEventHandler=i;this._flushHandler=r;this._maxFlushTimes=t;this._useSlidingWindow=o}e.prototype.addEvent=function(e){this._events.push(e);if(this._newEventHandler)try{this._newEventHandler(e)}catch(e){r.default.log(e)}i.Beacon.isTypeOf(e)||(this._events.length>=this._maxSize?this.flush():this._setFlushTimeout(!1))};e.prototype.flush=function(){this._setFlushTimeout(!0)};e.prototype._handleFlush=function(){this._clearFlushTimeout();if(this._events.length){this._flushHandler(this._events);this._events=[]}};e.prototype._clearFlushTimeout=function(){if(this._flushTimeoutId){window.clearTimeout(this._flushTimeoutId);this._flushTimeoutId=null}if(this._immediateflushTimeoutId){window.clearTimeout(this._immediateflushTimeoutId);this._immediateflushTimeoutId=null}};e.prototype._setFlushTimeout=function(e){var t=this;if(!this._immediateflushTimeoutId)if(this._useSlidingWindow){this._clearFlushTimeout();e?this._immediateflushTimeoutId=window.setTimeout(function(){t._handleFlush()},0):this._flushTimeoutId=window.setTimeout(function(){t._handleFlush()},this._getFlushTime())}else e?this._immediateflushTimeoutId||(this._immediateflushTimeoutId=window.setTimeout(function(){t._handleFlush()},0)):this._flushTimeoutId||(this._flushTimeoutId=window.setTimeout(function(){t._handleFlush()},this._getFlushTime()))};e.prototype._getFlushTime=function(){if(this._flushCount<this._maxFlushTimes.length){var e=this._flushCount;this._flushCount++;return this._maxFlushTimes[e]}return this._maxFlushTimes[this._maxFlushTimes.length-1]};return e}();t.default=o});define("St",["require","exports","a0","aI","aI","rG","ba","e5"],function(e,t,g,y,v,_,b,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function f(){}f.run=function(e,t,i,r,o,n,a){var s;new y.Qos({name:"NewFeatureExperience.Load"}).setTimeout(5e3,{resultType:v.ResultTypeEnum.Failure,resultCode:"Timeout"});s=f.determineFeatureList(t.lastSeenVersion,i,n,a);if(t.firstVisit){var l=n.getNewUserFeatureSetData();l&&0<l.length&&(s=l)}for(var d,c=[],u=0,p=s.length;u<p;u++){var m=s[u];if(!m.feature||b.isFeatureEnabled(m.feature)){if(m.feature===b.DiscoverViewODB&&f._discoverExperimentVariation===_.VARIATIONS[0])continue;var h=f.loadFeature(m,r);c.push(h)}}a&&0!==a&&8180750622===a&&(d=x.strings.commonQuestions);O365Shell_Shim.NFD.InitNewFeatureItems(c,d);g.Engagement.logData({name:"NewFeatureExperience.LoadedPassively"})};f.determineFeatureList=function(e,t,i,r){var o=[],n=i.getFeatureData();r&&0!==r&&8180750622===r&&(n=i.getExperimentFeatureData());if(e===t)o=o.concat(n[t.valueOf()]);else for(var a=t.valueOf();e<a&&0<a&&o.length<=10;a--)o=o.concat(n[a]);10<o.length&&(o=o.slice(0,10));return o};f.loadFeature=function(e,t){var i=new O365Shell_Shim.NFD.NewFeature(e.title,e.description);e.body&&0<e.body.length?i.NewFeatureDetails=1===e.body.length?new O365Shell_Shim.NFD.NewFeatureDetails(e.body[0]):new O365Shell_Shim.NFD.NewFeatureDetails(e.body[0],e.body[1]):i.NewFeatureDetails=new O365Shell_Shim.NFD.NewFeatureDetails;e.imageUrl&&(i.NewFeatureDetails.Image=new O365Shell_Shim.NFD.NewFeatureImage(e.imageUrl,e.imageText));e.videoUrl&&(i.NewFeatureDetails.Image=new O365Shell_Shim.NFD.NewFeatureImage(e.videoThumbnailUrl,e.videoUrl));e.linkUrl&&(i.NewFeatureDetails.Link=new O365Shell_Shim.NFD.NewFeatureLink(e.linkUrl,e.linkText,"link aria label"));e.engagementName&&(i.OnFeatureClicked=function(){g.Engagement.logData({name:"NewFeatureExperience.Click."+e.engagementName,isIntentional:!0})});if(e.callout){i.NewFeatureCallout=new O365Shell_Shim.NFD.NewFeatureCallout(e.callout.calloutDivId,e.callout.calloutTitle,e.callout.calloutBody);e.callout.calloutAnchorAlignment&&(i.NewFeatureCallout.AnchorAlignment=e.callout.calloutAnchorAlignment);e.callout.calloutArrowType&&(i.NewFeatureCallout.ArrowType=e.callout.calloutArrowType)}return i};f._discoverExperimentVariation=0;return f}();t.default=i});define("Su",["require","exports","ap","bN","ER","Eq","Sv","bA"],function(e,t,i,o,n,a,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._dragAndDropRobotExperiment=t.dragAndDropRobotExperiment;i._dragAndDropAnimationExperiment=t.dragAndDropAnimationExperiment;i._guidedTourExperiment=t.guidedTourExperiment;return i}e.prototype.fireUploadEvents=function(){this._dragAndDropRobotExperiment.fireUploadEvents();this._dragAndDropAnimationExperiment.fireUploadEvents();this._guidedTourExperiment.fireUploadEvents()};e.prototype.fireEditEvent=function(){this._dragAndDropRobotExperiment.fireEditEvent();this._dragAndDropAnimationExperiment.fireEditEvent();this._guidedTourExperiment.fireEditEvent()};e.prototype.fireShareEvent=function(e){this._dragAndDropRobotExperiment.fireShareEvent();this._dragAndDropAnimationExperiment.fireShareEvent();this._guidedTourExperiment.fireShareEvent()};e.prototype.fireReadEvent=function(e){this._dragAndDropRobotExperiment.fireReadEvent();this._dragAndDropAnimationExperiment.fireReadEvent();this._guidedTourExperiment.fireReadEvent()};e.prototype.fireDownloadEvent=function(e){};e.prototype.fireDeleteEvent=function(){};e.prototype.fireOpenInOfficeOnlineEvent=function(){};e.prototype.fireOpenInOfficeClientEvent=function(){};e.prototype.fireOfficeInstantPreviewerViewedEvent=function(){};e.dependencies=i.__assign({},o.default.dependencies,{dragAndDropRobotExperiment:s.resourceKey,dragAndDropAnimationExperiment:a.resourceKey,guidedTourExperiment:n.resourceKey});return e}(o.default);t.default=l;t.resourceKey=r.createResolvedResourceKey(e("module").id,l)});define("ER",["require","exports","bA","d7"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EXPERIMENT_ID_ODB=7771191965;var o=function(){function e(e,t){void 0===e&&(e={});this._guidedTourProvider=t.guidedTourProvider}e.prototype.fireUploadEvents=function(){this._fireEvent("WebUploadedFirstSessGuidedTour");var e,t=this._guidedTourProvider;if(t){var i=t.getUploadTimerStartTime(),r=t.getFileUploadedEventFired();if(0!==i&&!r){var o=Date.now()-i,n=(e=o)<6e4?"WebWrite1MinGuidedTour":e<3e5?"WebWrite1To5MinGuidedTour":e<6e5?"WebWrite5To10MinGuidedTour":"WebWriteAfter10MinGuidedTour";this._fireEvent(n);t.setFileUploadedEventFired()}}};e.prototype.fireEditEvent=function(){this._fireEvent("WebFileEditFirstSessGuidedTour")};e.prototype.fireShareEvent=function(){this._fireEvent("WebFileShareFirstSessGuidedTour")};e.prototype.fireReadEvent=function(){this._fireEvent("WebFileReadFirstSessGuidedTour")};e.prototype._fireEvent=function(e){var t=this._guidedTourProvider;t&&t.logOptimizelyEvent(e)};return e}();t.GuidedTourExperiment=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o,{guidedTourProvider:r.guidedTour.optional})});define("Eq",["require","exports","bA","Er","eE","cE","fL"],function(e,t,i,n,r,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ANIMATION_EXPERIMENT_ID=8248284472;var s=function(){function e(e,t){void 0===e&&(e={});this._dragAndDropAnimationHelper=t.dragAndDropAnimationHelper;this._engagement=t.engagement}e.prototype.fireUploadEvents=function(){var e=this._dragAndDropAnimationHelper;this._fireEvent("WebUploadedFirstSess");if(e&&e.getExperimentSeen()){var t=e.getExperimentInitTime(),i=e.getFileUploaded();if(0!==t&&!i){var r=Date.now()-t,o=n.getWriteTimeEventName(r);this._fireEvent(o);e.setFileUploaded()}}};e.prototype.fireEditEvent=function(){this._fireEvent("WebFileEditFirstSess")};e.prototype.fireShareEvent=function(){this._fireEvent("WebFileShareFirstSess")};e.prototype.fireReadEvent=function(){this._fireEvent("WebFileReadFirstSess")};e.prototype._fireEvent=function(e){this._dragAndDropAnimationHelper&&this._eventLoggingHelper(e)};e.prototype._eventLoggingHelper=function(e){this._engagement.logData({name:"DragAndDropAnimation."+e,extraData:{variation:this._dragAndDropAnimationHelper.getOptimizelyVariationId()()}});r.OptimizelyHelper.trackEvent(t.ANIMATION_EXPERIMENT_ID,e)};return e}();t.DragAndDropAnimationExperiment=s;t.resourceKey=i.createResolvedResourceKey(e("module").id,s,{dragAndDropAnimationHelper:a.resourceKey,engagement:o.resourceKey})});define("Er",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getWriteTimeEventName=function(e){return 0<e&&e<6e4?"WebWrite1Min":e<3e5?"WebWrite1To5Min":e<6e5?"WebWrite5To10Min":"WebWriteAfter10Min"}});define("Sv",["require","exports","cE","Er","Ep","bA"],function(e,t,i,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){void 0===e&&(e={});this._animationHelper=t.animationHelper;this._engagement=t.engagement}e.prototype.fireUploadEvents=function(){var e=this._animationHelper;this._fireEvent("WebUploadedFirstSess");if(e.getExperimentSeen()){var t=e.getExperimentInitTime(),i=e.getFileUploaded();if(0!==t&&!i){var r=Date.now()-t,o=n.getWriteTimeEventName(r);this._fireEvent(o);e.setFileUploaded()}}};e.prototype.fireEditEvent=function(){this._fireEvent("WebFileEditFirstSess")};e.prototype.fireShareEvent=function(){this._fireEvent("WebFileShareFirstSess")};e.prototype.fireReadEvent=function(){this._fireEvent("WebFileReadFirstSess")};e.prototype._fireEvent=function(e){var t=this._animationHelper;t.getExperimentSeen()&&this._engagement.logData({name:"DragAndDropRobot."+e,extraData:{variation:t.getOptimizelyVariationId()()}})};return e}();t.DragAndDropRobotExperiment=a;t.resourceKey=o.createResolvedResourceKey(e("module").id,a,{animationHelper:r.resourceKey,engagement:i.resourceKey})});define("Ep",["require","exports","ap","bN","bA"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i.isAnimation=i.createObservable(!1);i.isDialogClosed=i.createObservable(!1);i._isExperimentSeen=!1;i._initTime=null;i._fileUploaded=!1;i._isInitialized=!1;i._variationId=i.createObservable(0);return i}e.prototype.getInitialized=function(){return this._isInitialized};e.prototype.getExperimentSeen=function(){return this._isExperimentSeen};e.prototype.setExperimentSeen=function(){this._isExperimentSeen=!0};e.prototype.setIntializeTime=function(){this._initTime=Date.now()};e.prototype.setOptimizelyVariationId=function(e){this._variationId(e)};e.prototype.setIsInitialized=function(e){this._isInitialized=e};e.prototype.getExperimentInitTime=function(){return this._initTime};e.prototype.setFileUploaded=function(){this._fileUploaded=!0};e.prototype.getFileUploaded=function(){return this._fileUploaded};e.prototype.getOptimizelyVariationId=function(){return this._variationId};e.dependencies=i.__assign({},o.default.dependencies);return e}(o.default);t.default=n;t.resourceKey=r.createResolvedResourceKey(e("module").id,n)});define("Sw",["require","exports","hF","p3","ex","im","iG","bX"],function(e,t,o,S,g,C,P,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function x(){}x.getFilterMenuItems=function(e,t,i,r,o,n){var a=[],s=e.consume(P.rumOneHelper),l=function(){s.logFilterSort("Filter")};i=i.split("<br>")[0];var d=document.createElement("DIV");d.innerHTML=i;var c=d.querySelector("#diidFilter"+o);if(null!=c){for(var u=c.childNodes.length,p=c.childNodes,m=C.default.getFilterFieldByName(r,o),h=!1,f=e.consume(k.actionMap),g=1;g<u;g++){var y=C.default.getText(p[g]),v=p[g].value.toString(),_=m&&C.default.isFieldValueInUrl(r,o,v,y);_&&(h=!0);var b=new S.default({text:y,isToggleable:!0,action:new(e.injected(f.FilterAction))({field:[o],value:[v],isFilterOn:!!_}),reportClickingTime:l});a[g-1]=b}h&&!n&&a.unshift(x.getClearFilterCommand(e,o))}else a=x.getTaxonomyFilterMenuItems(e,t,i,r,o,n,l);return a};x.getTaxonomyFilterMenuItems=function(e,t,i,r,o,n,a){var s=[];if(t.fieldType===g.ColumnFieldType.Taxonomy&&"TaxKeyword"!==t.internalName){var l=document.createElement("UL");l.innerHTML=i;for(var d=l.querySelector("#diidFilterCustomTable").firstChild,c=0,u=e.consume(k.actionMap);d;){var p=C.default.getText(d);p&&0!==p.length||(p="0");if(d=d.nextSibling){var m=C.default.getText(d);if(d=d.nextSibling){C.default.getText(d);if((d=d.nextSibling)&&(d=d.nextSibling)){d=d.nextSibling;var h=C.default.getFilterFieldByName(r,o)&&C.default.isFieldValueInUrl(r,o,p),f=new S.default({text:m,isToggleable:!0,action:new(e.injected(u.FilterAction))({field:[o],value:[p],isFilterOn:!!h}),reportClickingTime:a});s[c++]=f}}}}0<s.length&&!n&&s.unshift(x.getClearFilterCommand(e,o))}return s};x.getClearFilterCommand=function(e,t,i){var r=e.consume(k.actionMap);return new S.default({text:o.strings.ClearFilterText,engagementName:i,action:new(e.injected(r.ClearFilterAction))({field:[t]})})};return x}();t.default=i});define("Sx",["require","exports","b3","SA","Sz","Sy"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"ms-search",viewModelType:r.default,template:e("Sz")})});define("SA",["require","exports","ap","bF","d5","rN","US","UM","UD","SB","cm","bW","cJ","cp","b3"],function(e,t,i,r,o,f,g,n,a,s,y,v,_,b,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(h){i.__extends(e,h);function e(e,t){var o=h.call(this,e,t)||this;o.addBindingHandlers({keyboard:_.default,hasChildFocus:y.default,element:v.default,control:x.default});o._responsiveUI=t.responsiveUI;o.rootElement=o.createObservable();o.overlayTagName=b.default.tagName;var i=e.placeholder,r=void 0===i?o.createObservable(f.strings.SearchPlaceholder):i,n=e.searchBoxAriaLabel,a=void 0===n?f.strings.SearchBoxLabel:n,s=e.submitPlaceholder,l=void 0===s?o.createObservable(g.strings.SearchEverything):s,d=e.hasBack,c=void 0===d?o.createObservable(!1):d,u=e.searchText,p=e.submitAction,m=e.submitOnClear;o.context=o.scope.attach(new t.searchContextType({searchParams:{placeholder:r,searchBoxAriaLabel:a,submitPlaceholder:l,hasBack:c,searchText:u,submitAction:p,submitOnClear:m}}));o.searchBoxSpecification=t.searchBoxControl.toSpecification({context:o.context});o.searchResultsSpecification=t.searchResultsControl.toSpecification({context:o.context});o.isMdDown=o.createPureComputed(function(){if(o._responsiveUI){var e=o._responsiveUI.formFactorSize();return"Medium"===e||"Small"===e}return!1});o.resultsStyle=o.createPureComputed(function(){var e=o.context.isFocused(),t=o.isMdDown(),i=o.rootElement();if(e&&t&&i){var r=i.getBoundingClientRect();return{top:String(r.top+r.height)+"px"}}return{}});return o}e.dependencies=i.__assign({},r.default.dependencies,{responsiveUI:o.resourceKey,searchBoxControl:n.resourceKey,searchResultsControl:a.resourceKey,searchContextType:s.typeResourceKey});return e}(r.default);t.default=l});define("UM",["require","exports","b3","UP","UO","UN"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"ms-search-box",viewModelType:r.default,template:e("UN")})});define("UP",["require","exports","ap","bF","bX","UR","cJ","UQ","c1","a9","lS"],function(e,t,i,r,o,s,l,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){i.__extends(e,a);function e(e,t){var i=a.call(this,e,t)||this;i.strings=s.strings;i.addBindingHandlers({focus:d.default,keyboard:l.default,teachingBubble:p.default});var r=t.currentPageType,o=void 0===r?i.createObservable(u.default.Files):r,n=e.context;i.context=n;i.teachingBubbleOptions={campaign:i.createObservable(c.ODC_PHOTOS_SEARCH),isVisible:i._isPhotosPage};i._isPhotosPage=i.createPureComputed(i._computeIsPhotosPage);i._pageType=o;return i}e.prototype.handleClick=function(){var e=this.peekUnwrapObservable(this.teachingBubbleOptions.campaign);if(e&&this._teachingBubbleProvider){this._teachingBubbleProvider.clearCurrentBubble();this._teachingBubbleProvider.markBubbleAsDismissed(e)}this.context.focusInput()};e.prototype._computeIsPhotosPage=function(){return this._pageType()===u.default.Photos};e.dependencies=i.__assign({},r.default.dependencies,{currentPageType:o.currentPage.optional});return e}(r.default);t.default=n});define("UQ",["require","exports","aq","bT"],function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.init=function(e,t,i,r,o){var n=new s.default(null);n.on(e,"focus",a.unwrap(t()).bind(a.dataFor(e)));a.utils.domNodeDisposal.addDisposeCallback(e,function(){n.dispose()})};return e}();t.default=i});define("UO",["c","az"],function(e,t){e.loadStyles([{rawString:".od-SearchBox{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";border-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:40px;position:relative;box-sizing:border-box}@media screen and (-ms-high-contrast:active){.od-SearchBox{border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";z-index:304}}@media screen and (-ms-high-contrast:black-on-white){.od-SearchBox{border-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-SearchBox .ms-Icon--Cancel,.od-SearchBox .ms-Icon--Search{margin-top:12px}.od-SearchBox button.ms-Icon{background:0 0;padding:0;border:none;line-height:16px}.od-SearchBox button.ms-Icon::-moz-focus-inner{padding:0;border:0}html[dir=ltr] .od-SearchBox{border-right-style:solid}html[dir=rtl] .od-SearchBox{border-left-style:solid}html[dir=ltr] .od-SearchBox{border-right-width:1px}html[dir=rtl] .od-SearchBox{border-left-width:1px}.md .od-SearchBox,.sm .od-SearchBox{height:44px}.md .od-SearchBox .ms-Icon--Search,.sm .od-SearchBox .ms-Icon--Search{margin-top:12px;line-height:20px}.sm .od-SearchBox{height:44px}.xlg .od-SearchBox,.xxlg .od-SearchBox,.xxxlg .od-SearchBox,.xxxxlg .od-SearchBox{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:'}.od-SearchBox-search{display:block;box-sizing:border-box;height:100%;position:relative}.od-SearchBox-search:after{content:"";display:block;position:absolute;height:0;left:0;right:0;bottom:0;margin:0 8px;border-bottom:1px solid '},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}input.od-SearchBox-input[type=text]{display:block;height:100%;width:100%;padding:8px 8px 8px 41px;background-color:transparent;box-sizing:border-box;outline:0;font-size:14px;border:none;-webkit-appearance:none;-webkit-border-radius:0}html[dir=rtl] input.od-SearchBox-input[type=text]{padding:8px 41px 8px 8px}input.od-SearchBox-input[type=text]::-ms-clear{display:none}input.od-SearchBox-input[type=text]::-webkit-input-placeholder{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";opacity:1;font-size:14px}input.od-SearchBox-input[type=text]:-ms-input-placeholder{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";opacity:1;font-size:14px}input.od-SearchBox-input[type=text]::placeholder{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";opacity:1;font-size:14px}input.od-SearchBox-input[type=text]:placeholder{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";opacity:1;font-size:14px}.md input.od-SearchBox-input[type=text],.sm input.od-SearchBox-input[type=text]{height:44px}.od-SearchBox-iconSearchWrapper{display:block;top:0}[dir=ltr] .od-SearchBox-iconSearchWrapper{padding-left:17px}[dir=rtl] .od-SearchBox-iconSearchWrapper{padding-right:17px}[dir=ltr] .od-SearchBox-iconSearchWrapper{padding-right:6px}[dir=rtl] .od-SearchBox-iconSearchWrapper{padding-left:6px}[dir=ltr] .md .od-SearchBox-iconSearchWrapper,[dir=ltr] .sm .od-SearchBox-iconSearchWrapper{padding-left:15px}[dir=rtl] .md .od-SearchBox-iconSearchWrapper,[dir=rtl] .sm .od-SearchBox-iconSearchWrapper{padding-right:15px}.od-SearchBox-iconArrowWrapper{display:none;top:12px}[dir=ltr] .od-SearchBox-iconArrowWrapper{padding-left:16px}[dir=rtl] .od-SearchBox-iconArrowWrapper{padding-right:16px}[dir=ltr] .od-SearchBox-iconArrowWrapper{padding-right:7px}[dir=rtl] .od-SearchBox-iconArrowWrapper{padding-left:7px}.od-SearchBox-iconClearWrapper{display:none;top:0}[dir=ltr] .od-SearchBox-iconClearWrapper{padding-left:11px}[dir=rtl] .od-SearchBox-iconClearWrapper{padding-right:11px}[dir=ltr] .od-SearchBox-iconClearWrapper{padding-right:12px}[dir=rtl] .od-SearchBox-iconClearWrapper{padding-left:12px}[dir=ltr] .od-SearchBox-iconClearWrapper{right:0}[dir=rtl] .od-SearchBox-iconClearWrapper{left:0}.od-SearchBox--active{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SearchBox--active,.od-SearchBox:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}[dir=ltr] .od-SearchBox--active .od-SearchBox-input{padding-left:8px}[dir=rtl] .od-SearchBox--active .od-SearchBox-input{padding-right:8px}[dir=ltr] .od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-input{padding-left:48px}[dir=rtl] .od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-input{padding-right:48px}.od-SearchBox--active .od-SearchBox-iconSearchWrapper{display:none}[dir=ltr] .od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-input{padding-right:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-input{padding-left:40px}.od-SearchBox--active.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{display:block}.od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-iconSearchWrapper{display:block}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-input{padding-left:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft .od-SearchBox-input{padding-right:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-input{padding-left:73px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-input{padding-right:73px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{margin-left:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{margin-right:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{padding-left:10px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconLeft.od-SearchBox--hasBack .od-SearchBox-iconSearchWrapper{padding-right:10px}.od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{display:block}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{right:0}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{left:0}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-left:11px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-right:11px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-right:12px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-iconSearchWrapper{padding-left:12px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-input{padding-right:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight .od-SearchBox-input{padding-left:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-input{padding-right:68px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-input{padding-left:68px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{margin-right:40px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{margin-left:40px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-left:6px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-right:6px}[dir=ltr] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-right:5px}[dir=rtl] .od-SearchBox--active.od-SearchBox--searchIconRight.od-SearchBox--hasText .od-SearchBox-iconClearWrapper{padding-left:5px}.od-SearchBox--active.od-SearchBox--hasBack .od-SearchBox-iconArrowWrapper{display:block}.od-SearchBox-iconWrapper{height:40px;cursor:pointer;position:absolute;z-index:1}.od-SearchBox-iconWrapper button{cursor:pointer}.sm .od-SearchBox-iconWrapper{height:44px}.od-SearchBox .ms-Icon::before{font-size:16px;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.md .od-SearchBox .ms-Icon::before,.sm .od-SearchBox .ms-Icon::before{font-size:20px}"}])});define("UN",[],function(){return'<div class=od-SearchBox role=presentation data-bind="click: context.focusInput, css: { \'od-SearchBox--active\': context.isActive, \'od-SearchBox--hasBack\': context.hasBack, \'od-SearchBox--hasText\': context.searchText, \'od-SearchBox--searchIconLeft\': context.searchIconLeft, \'od-SearchBox--searchIconRight\': context.searchIconRight }, teachingBubble: teachingBubbleOptions"><span class="od-SearchBox-iconWrapper od-SearchBox-iconArrowWrapper" data-bind="attr: { title: strings.BackIconLabel }"><button class="ms-Icon ms-Icon--Back" data-bind="icon: true, click: context.onBack, clickBubble: false"></button></span> <span class=od-SearchBox-search><input class=od-SearchBox-input type=text role=search data-bind="hasFocus: context.inputFocused, keyboard: { allowInputEvents: true, preventDefault: true, mappings: { Enter: context.onEnter, Down: context.onArrowDown, Up: context.onArrowUp } }, attr: { placeholder: context.placeholder, name: context.placeholder, \'aria-label\': context.searchBoxAriaLabel }, textInput: context.searchText, automation: \'SearchBox-Input\', click: handleClick, clickBubble: false"></span> <span class="od-SearchBox-iconWrapper od-SearchBox-iconSearchWrapper" data-bind="attr: { title: strings.SearchIconLabel }"><button class="ms-Icon ms-Icon--Search" data-bind="icon: true, click: context.onSearchClick, clickBubble: false, focus: context.focusInput"></button></span> <span class="od-SearchBox-iconWrapper od-SearchBox-iconClearWrapper"><button class="ms-Icon ms-Icon--Cancel" data-bind="icon: true, click: context.clearInput.bind(this, false), clickBubble: false, attr: { \'aria-label\': strings.ClearIconLabel }"></button></span></div>'});define("UD",["require","exports","b5","b3","UL","UK","UJ","UI","sB","UH","UG","UF","UE"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.registerTemplate(n.default.Default,e("UH"));i.registerTemplate(n.default.Expanded,e("UG"));i.registerTemplate(n.default.Glyph,e("UF"));i.registerTemplate(n.default.Upscope,e("UE"));t.resourceKey=r.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"ms-search-results",viewModelType:o.default,template:e("UJ")})});define("UL",["require","exports","ap","bF","hs","aI","UK","US","sB","d0","sk","cJ","dz","Sf","dn","SC","d5"],function(e,t,i,r,l,d,o,c,u,p,m,h,f,g,a,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(s){i.__extends(e,s);function e(e,t){var o=s.call(this,e,t)||this;o.addBindingHandlers({activate:m.default,keyboard:h.default,selection:f.default,visibility:g.default});var r=e.context,i=o.observables,n=o.resources,a=r.searchData;o.accessibleTextNewResults=c.strings.NewSearchResultsAccessibleText;o.accessibleTextNoResults=c.strings.NoResults;o.context=r;o.fadeIn=i.create(!1);o.getRelativeDateTimeStringPast=l.getRelativeDateTimeStringPast;o.iconDesiredSize=i.pureCompute(function(){return o._getIconDesiredSize()});o.imageFrameTagName=u.default.tagName;o.isRenderComplete=i.create(!1);o.noResults=i.pureCompute(function(){var e=r.searchData();return!e.containers||!e.containers.length});o.parentFolderLabel=c.strings.ParentFolderLabel;o.progressSpinnerFlatTagName=p.default.tagName;r.capabilities.showOnlyResults?o.statusMessage=i.create(""):o.statusMessage=i.pureCompute(function(){var e=r.errorMessage(),t=r.searchText,i=r.capabilities.minimumQueryLength;return e||(t&&t().length<i?c.strings.TypeToSearchStatus:r.queryInProgress()?c.strings.SearchingStatus:o.noResults()&&r.capabilities.showNoResults?c.strings.NoResults:"")}).extend({rateLimit:150});o._responsiveUI=n.consume(v.resourceKey);o._tsInstrumentationProvider=n.consume(y.resourceKey.optional);i.compute(function(){if(a()&&o.isRenderComplete()){var e=performance.now(),t=a.peek(),i=t.responseReceived;i&&o._tsInstrumentationProvider&&o._tsInstrumentationProvider.renderedResults(t.traceId,e-i);var r=t.responseToRenderEvent;r&&r.end({resultType:d.ResultTypeEnum.Success})}});return o}e.prototype.getTemplate=function(e){var t;switch(e.type){case 6:t=o.default.Expanded;break;case 3:case 4:t=o.default.Glyph;break;case 7:t=o.default.Upscope;break;default:t=o.default.Default}return{name:t}};e.prototype.onClickResult=function(e,t){this.context.searchResultClicked(e)};e.prototype.getIconImage=function(e){var o=this,n=e.iconName;return{url:n,width:96,height:96,getAligned:function(e,t){var i,r=e.width;i=r<24?16:r<32?24:r<48?32:r<64?48:r<96?64:96;return{url:a.getIconUrl(o.resources,n,i),width:i,height:i}}}};e.prototype.displayOdbMetadata=function(e){return!!e.parentFolder&&!!e.lastModifiedDateDisplay};e.prototype.displayLastModifiedBy=function(e){return!!e.lastModifiedBy};e.prototype.renderComplete=function(){this.isRenderComplete(!0)};e.prototype._getIconDesiredSize=function(){switch(this._responsiveUI.formFactorSize()){case"Small":return{width:20,height:20};default:return{width:48,height:48}}};return e}(r.default);t.default=n});define("UK",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.Default="od-search-result-default";e.Expanded="od-search-result-expanded";e.Glyph="od-search-result-glyph";e.Upscope="od-search-result-upscope";return e}();t.default=i});define("SC",["require","exports","ap","SH","hs","bA","SD"],function(e,t,n,a,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._instrumentationDataSource=t.instrumentationDataSource;this._responseQueue=[]}e.prototype.receivedResponse=function(e,t){this._responseQueue.push({name:"sss_responsereceived",traceid:e,latency:Math.round(t),status:200})};e.prototype.receivedError=function(e,t,i){void 0===i&&(i=400);this._instrumentationDataSource.logEvent({name:"sss_responsereceived",traceid:e,latency:Math.round(t),status:i,rendered:0})};e.prototype.renderedResults=function(t,e){var i=this,r=this._responseQueue,o=a(r,function(e){return e.traceid===t});if(-1<o){r.splice(0,o).forEach(function(e){i._instrumentationDataSource.logEvent(n.__assign({},e,{rendered:0}))});this._instrumentationDataSource.logEvent(n.__assign({},r.shift(),{rendered:1,renderinglatency:Math.round(e)}))}};e.prototype.didSearch=function(e){for(var t=this._responseQueue;t.length;)this._instrumentationDataSource.logEvent(n.__assign({},t.shift(),{rendered:0}));this._instrumentationDataSource.logEvent({name:"sss_searchactions",traceid:e,eventtype:"searchdone",localtime:this._getLocalISODateString()})};e.prototype.selectedEntity=function(e,t){this._instrumentationDataSource.logEvent({name:"sss_searchentityactions",traceid:e,eventtype:"entityclicked",id:t,localtime:this._getLocalISODateString()})};e.prototype._getLocalISODateString=function(){return i.convertDateToISOString((new Date).toString(),!0)};e.dependencies={instrumentationDataSource:o.resourceKey};return e}();t.default=s;t.resourceKey=r.createResolvedResourceKey(e("module").id,s)});define("SH",["UB","SU","SI"],function(n,a,s){var l=Math.max;return function(e,t,i){var r=null==e?0:e.length;if(!r)return-1;var o=null==i?0:s(i);o<0&&(o=l(r+o,0));return n(e,a(t,3),o)}});define("UB",[],function(){return function(e,t,i,r){for(var o=e.length,n=i+(r?1:-1);r?n--:++n<o;)if(t(e[n],n,e))return n;return-1}});define("SU",["Uy","TF","TE","TD","SV"],function(t,i,r,o,n){return function(e){return"function"==typeof e?e:null==e?r:"object"==typeof e?o(e)?i(e[0],e[1]):t(e):n(e)}});define("Uy",["UA","Uz","TG"],function(r,e,o){return function(t){var i=e(t);return 1==i.length&&i[0][2]?o(i[0][0],i[0][1]):function(e){return e===t||r(e,t,i)}}});define("UA",["Us","TQ"],function(m,h){var f,g=1,y=2;return function(e,t,i,r){var o=i.length,n=o,a=!r;if(null==e)return!n;e=Object(e);for(;o--;){var s=i[o];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<n;){var l=(s=i[o])[0],d=e[l],c=s[1];if(a&&s[2]){if(d===f&&!(l in e))return!1}else{var u=new m;if(r)var p=r(d,c,l,e,t,u);if(!(p===f?h(c,d,g|y,r,u):p))return!1}}return!0}});define("Us",["Tn","Ux","Uw","Uv","Uu","Ut"],function(i,e,t,r,o,n){function a(e){var t=this.__data__=new i(e);this.size=t.size}a.prototype.clear=e;a.prototype.delete=t;a.prototype.get=r;a.prototype.has=o;a.prototype.set=n;return a});define("Tn",["Tu","Tt","Ts","Tr","To"],function(e,t,i,r,o){function n(e){var t=-1,i=null==e?0:e.length;this.clear();for(;++t<i;){var r=e[t];this.set(r[0],r[1])}}n.prototype.clear=e;n.prototype.delete=t;n.prototype.get=i;n.prototype.has=r;n.prototype.set=o;return n});define("Tu",[],function(){return function(){this.__data__=[];this.size=0}});define("Tt",["Tp"],function(r){var o=Array.prototype.splice;return function(e){var t=this.__data__,i=r(t,e);if(i<0)return!1;i==t.length-1?t.pop():o.call(t,i,1);--this.size;return!0}});define("Tp",["Tq"],function(r){return function(e,t){for(var i=e.length;i--;)if(r(e[i][0],t))return i;return-1}});define("Tq",[],function(){return function(e,t){return e===t||e!=e&&t!=t}});define("Ts",["Tp"],function(r){var o;return function(e){var t=this.__data__,i=r(t,e);return i<0?o:t[i][1]}});define("Tr",["Tp"],function(t){return function(e){return-1<t(this.__data__,e)}});define("To",["Tp"],function(o){return function(e,t){var i=this.__data__,r=o(i,e);if(r<0){++this.size;i.push([e,t])}else i[r][1]=t;return this}});define("Ux",["Tn"],function(e){return function(){this.__data__=new e;this.size=0}});define("Uw",[],function(){return function(e){var t=this.__data__,i=t.delete(e);this.size=t.size;return i}});define("Uv",[],function(){return function(e){return this.__data__.get(e)}});define("Uu",[],function(){return function(e){return this.__data__.has(e)}});define("Ut",["Tn","Tf","S7"],function(o,n,a){var s=200;return function(e,t){var i=this.__data__;if(i instanceof o){var r=i.__data__;if(!n||r.length<s-1){r.push([e,t]);this.size=++i.size;return this}i=this.__data__=new a(r)}i.set(e,t);this.size=i.size;return this}});define("Tf",["Tg","SR"],function(e,t){return e(t,"Map")});define("Tg",["Ti","Th"],function(r,o){var n;return function(e,t){var i=o(e,t);return r(i)?i:n}});define("Ti",["Tm","Tk","ST","Tj"],function(t,i,r,o){var n=/^\[object .+?Constructor\]$/,e=Function.prototype,a=Object.prototype,s=e.toString,l=a.hasOwnProperty,d=RegExp("^"+s.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return function(e){return!(!r(e)||i(e))&&(t(e)?d:n).test(o(e))}});define("Tm",["SN","ST"],function(i,r){var o="[object AsyncFunction]",n="[object Function]",a="[object GeneratorFunction]",s="[object Proxy]";return function(e){if(!r(e))return!1;var t=i(e);return t==n||t==a||t==o||t==s}});define("SN",["SQ","SP","SO"],function(e,t,i){var r,o="[object Null]",n="[object Undefined]",a=e?e.toStringTag:r;return function(e){return null==e?e===r?n:o:a&&a in Object(e)?t(e):i(e)}});define("SQ",["SR"],function(e){return e.Symbol});define("SR",["SS"],function(e){var t="object"==typeof self&&self&&self.Object===Object&&self;return e||t||Function("return this")()});define("SS",[],function(){return"object"==typeof global&&global&&global.Object===Object&&global});define("SP",["SQ"],function(e){var n,t=Object.prototype,a=t.hasOwnProperty,s=t.toString,l=e?e.toStringTag:n;return function(e){var t=a.call(e,l),i=e[l];try{e[l]=n;var r=!0}catch(e){}var o=s.call(e);r&&(t?e[l]=i:delete e[l]);return o}});define("SO",[],function(){var t=Object.prototype.toString;return function(e){return t.call(e)}});define("ST",[],function(){return function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}});define("Tk",["Tl"],function(e){var t,i=(t=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";return function(e){return!!i&&i in e}});define("Tl",["SR"],function(e){return e["__core-js_shared__"]});define("Tj",[],function(){var t=Function.prototype.toString;return function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}});define("Th",[],function(){var i;return function(e,t){return null==e?i:e[t]}});define("S7",["Te","Td","Tc","Tb","S8"],function(e,t,i,r,o){function n(e){var t=-1,i=null==e?0:e.length;this.clear();for(;++t<i;){var r=e[t];this.set(r[0],r[1])}}n.prototype.clear=e;n.prototype.delete=t;n.prototype.get=i;n.prototype.has=r;n.prototype.set=o;return n});define("Te",["Tv","Tn","Tf"],function(e,t,i){return function(){this.size=0;this.__data__={hash:new e,map:new(i||t),string:new e}}});define("Tv",["TB","TA","Tz","Ty","Tw"],function(e,t,i,r,o){function n(e){var t=-1,i=null==e?0:e.length;this.clear();for(;++t<i;){var r=e[t];this.set(r[0],r[1])}}n.prototype.clear=e;n.prototype.delete=t;n.prototype.get=i;n.prototype.has=r;n.prototype.set=o;return n});define("TB",["Tx"],function(e){return function(){this.__data__=e?e(null):{};this.size=0}});define("Tx",["Tg"],function(e){return e(Object,"create")});define("TA",[],function(){return function(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}});define("Tz",["Tx"],function(r){var o,n="__lodash_hash_undefined__",a=Object.prototype.hasOwnProperty;return function(e){var t=this.__data__;if(r){var i=t[e];return i===n?o:i}return a.call(t,e)?t[e]:o}});define("Ty",["Tx"],function(i){var r,o=Object.prototype.hasOwnProperty;return function(e){var t=this.__data__;return i?t[e]!==r:o.call(t,e)}});define("Tw",["Tx"],function(r){var o,n="__lodash_hash_undefined__";return function(e,t){var i=this.__data__;this.size+=this.has(e)?0:1;i[e]=r&&t===o?n:t;return this}});define("Td",["S9"],function(i){return function(e){var t=i(this,e).delete(e);this.size-=t?1:0;return t}});define("S9",["Ta"],function(r){return function(e,t){var i=e.__data__;return r(t)?i["string"==typeof t?"string":"hash"]:i.map}});define("Ta",[],function(){return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"[object Object]"!==e:null===e}});define("Tc",["S9"],function(t){return function(e){return t(this,e).get(e)}});define("Tb",["S9"],function(t){return function(e){return t(this,e).has(e)}});define("S8",["S9"],function(o){return function(e,t){var i=o(this,e),r=i.size;i.set(e,t);this.size+=i.size==r?0:1;return this}});define("TQ",["TR","SM"],function(a,s){return function e(t,i,r,o,n){return t===i||(null==t||null==i||!s(t)&&!s(i)?t!=t&&i!=i:a(t,i,r,o,e,n))}});define("TR",["Us","Um","Ui","T3","TY","TD","TW","TS"],function(y,v,_,b,x,S,C,P){var k=1,I="[object Arguments]",T="[object Array]",w="[object Object]",E=Object.prototype.hasOwnProperty;return function(e,t,i,r,o,n){var a=S(e),s=S(t),l=a?T:x(e),d=s?T:x(t),c=(l=l==I?w:l)==w,u=(d=d==I?w:d)==w,p=l==d;if(p&&C(e)){if(!C(t))return!1;a=!0;c=!1}if(p&&!c){n||(n=new y);return a||P(e)?v(e,t,i,r,o,n):_(e,t,l,i,r,o,n)}if(!(i&k)){var m=c&&E.call(e,"__wrapped__"),h=u&&E.call(t,"__wrapped__");if(m||h){var f=m?e.value():e,g=h?t.value():t;n||(n=new y);return o(f,g,i,r,n)}}if(!p)return!1;n||(n=new y);return b(e,t,i,r,o,n)}});define("Um",["Up","Uo","Un"],function(g,y,v){var _,b=1,x=2;return function(e,t,i,r,o,n){var a=i&b,s=e.length,l=t.length;if(s!=l&&!(a&&s<l))return!1;var d=n.get(e);if(d&&n.get(t))return d==t;var c=-1,u=!0,p=i&x?new g:_;n.set(e,t);n.set(t,e);for(;++c<s;){var m=e[c],h=t[c];if(r)var f=a?r(h,m,c,t,e,n):r(m,h,c,e,t,n);if(f!==_){if(f)continue;u=!1;break}if(p){if(!y(t,function(e,t){if(!v(p,t)&&(m===e||o(m,e,i,r,n)))return p.push(t)})){u=!1;break}}else if(m!==h&&!o(m,h,i,r,n)){u=!1;break}}n.delete(e);n.delete(t);return u}});define("Up",["S7","Ur","Uq"],function(r,e,t){function i(e){var t=-1,i=null==e?0:e.length;this.__data__=new r;for(;++t<i;)this.add(e[t])}i.prototype.add=i.prototype.push=e;i.prototype.has=t;return i});define("Ur",[],function(){var t="__lodash_hash_undefined__";return function(e){this.__data__.set(e,t);return this}});define("Uq",[],function(){return function(e){return this.__data__.has(e)}});define("Uo",[],function(){return function(e,t){for(var i=-1,r=null==e?0:e.length;++i<r;)if(t(e[i],i,e))return!0;return!1}});define("Un",[],function(){return function(e,t){return e.has(t)}});define("Ui",["SQ","Ul","Tq","Um","Uk","Uj"],function(e,u,p,m,h,f){var g=1,y=2,v="[object Boolean]",_="[object Date]",b="[object Error]",x="[object Map]",S="[object Number]",C="[object RegExp]",P="[object Set]",k="[object String]",I="[object Symbol]",T="[object ArrayBuffer]",w="[object DataView]",t=e?e.prototype:void 0,E=t?t.valueOf:void 0;return function(e,t,i,r,o,n,a){switch(i){case w:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer;t=t.buffer;case T:return!(e.byteLength!=t.byteLength||!n(new u(e),new u(t)));case v:case _:case S:return p(+e,+t);case b:return e.name==t.name&&e.message==t.message;case C:case k:return e==t+"";case x:var s=h;case P:var l=r&g;s||(s=f);if(e.size!=t.size&&!l)return!1;var d=a.get(e);if(d)return d==t;r|=y;a.set(e,t);var c=m(s(e),s(t),r,o,n,a);a.delete(e);return c;case I:if(E)return E.call(e)==E.call(t)}return!1}});define("Ul",["SR"],function(e){return e.Uint8Array});define("Uk",[],function(){return function(e){var i=-1,r=Array(e.size);e.forEach(function(e,t){r[++i]=[t,e]});return r}});define("Uj",[],function(){return function(e){var t=-1,i=Array(e.size);e.forEach(function(e){i[++t]=e});return i}});define("T3",["T4"],function(_){var b,x=1,S=Object.prototype.hasOwnProperty;return function(e,t,i,r,o,n){var a=i&x,s=_(e),l=s.length;if(l!=_(t).length&&!a)return!1;for(var d=l;d--;){var c=s[d];if(!(a?c in t:S.call(t,c)))return!1}var u=n.get(e);if(u&&n.get(t))return u==t;var p=!0;n.set(e,t);n.set(t,e);for(var m=a;++d<l;){var h=e[c=s[d]],f=t[c];if(r)var g=a?r(f,h,c,t,e,n):r(h,f,c,e,t,n);if(!(g===b?h===f||o(h,f,i,r,n):g)){p=!1;break}m||(m="function Object() { [native code] }"==c)}if(p&&!m){var y=e.constructor,v=t.constructor;y!=v&&"function Object() { [native code] }"in e&&"function Object() { [native code] }"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v)&&(p=!1)}n.delete(e);n.delete(t);return p}});define("T4",["Ug","Ud","T5"],function(t,i,r){return function(e){return t(e,r,i)}});define("Ug",["Uh","TD"],function(o,n){return function(e,t,i){var r=t(e);return n(e)?r:o(r,i(e))}});define("Uh",[],function(){return function(e,t){for(var i=-1,r=t.length,o=e.length;++i<r;)e[o+i]=t[i];return e}});define("TD",[],function(){return Array.isArray});define("Ud",["Uf","Ue"],function(e,t){var i=Object.prototype.propertyIsEnumerable,r=Object.getOwnPropertySymbols;return r?function(t){if(null==t)return[];t=Object(t);return e(r(t),function(e){return i.call(t,e)})}:t});define("Uf",[],function(){return function(e,t){for(var i=-1,r=null==e?0:e.length,o=0,n=[];++i<r;){var a=e[i];t(a,i,e)&&(n[o++]=a)}return n}});define("Ue",[],function(){return function(){return[]}});define("T5",["Ub","T7","T6"],function(t,i,r){return function(e){return r(e)?t(e):i(e)}});define("Ub",["Uc","TM","TD","TW","TL","TS"],function(c,u,p,m,h,f){var g=Object.prototype.hasOwnProperty;return function(e,t){var i=p(e),r=!i&&u(e),o=!i&&!r&&m(e),n=!i&&!r&&!o&&f(e),a=i||r||o||n,s=a?c(e.length,String):[],l=s.length;for(var d in e)!t&&!g.call(e,d)||a&&("length"==d||o&&("offset"==d||"parent"==d)||n&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||h(d,l))||s.push(d);return s}});define("Uc",[],function(){return function(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}});define("TM",["TN","SM"],function(e,t){var i=Object.prototype,r=i.hasOwnProperty,o=i.propertyIsEnumerable;return e(function(){return arguments}())?e:function(e){return t(e)&&r.call(e,"callee")&&!o.call(e,"callee")}});define("TN",["SN","SM"],function(t,i){var r="[object Arguments]";return function(e){return i(e)&&t(e)==r}});define("SM",[],function(){return function(e){return null!=e&&"object"==typeof e}});define("TW",["SR","TX"],function(e,t){var i="object"==typeof exports&&exports&&!exports.nodeType&&exports,r=i&&"object"==typeof module&&module&&!module.nodeType&&module,o=r&&r.exports===i?e.Buffer:void 0;return(o?o.isBuffer:void 0)||t});define("TX",[],function(){return function(){return!1}});define("TL",[],function(){var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;return function(e,t){var i=typeof e;return!!(t=null==t?r:t)&&("number"==i||"symbol"!=i&&o.test(e))&&-1<e&&e%1==0&&e<t}});define("TS",["TV","TU","TT"],function(e,t,i){var r=i&&i.isTypedArray;return r?t(r):e});define("TV",["SN","TK","SM"],function(t,i,r){var o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0;o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;return function(e){return r(e)&&i(e.length)&&!!o[t(e)]}});define("TK",[],function(){var t=9007199254740991;return function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=t}});define("TU",[],function(){return function(t){return function(e){return t(e)}}});define("TT",["SS"],function(e){var t="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=t&&"object"==typeof module&&module&&!module.nodeType&&module,r=i&&i.exports===t&&e.process;return function(){try{return r&&r.binding&&r.binding("util")}catch(e){}}()});define("T7",["Ua","T8"],function(r,o){var n=Object.prototype.hasOwnProperty;return function(e){if(!r(e))return o(e);var t=[];for(var i in Object(e))n.call(e,i)&&"function Object() { [native code] }"!=i&&t.push(i);return t}});define("Ua",[],function(){var i=Object.prototype;return function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||i)}});define("T8",["T9"],function(e){return e(Object.keys,Object)});define("T9",[],function(){return function(t,i){return function(e){return t(i(e))}}});define("T6",["Tm","TK"],function(t,i){return function(e){return null!=e&&i(e.length)&&!t(e)}});define("TY",["T2","Tf","T1","T0","TZ","SN","Tj"],function(e,t,i,r,o,n,a){var s="[object Map]",l="[object Promise]",d="[object Set]",c="[object WeakMap]",u="[object DataView]",p=a(e),m=a(t),h=a(i),f=a(r),g=a(o),y=n;(e&&y(new e(new ArrayBuffer(1)))!=u||t&&y(new t)!=s||i&&y(i.resolve())!=l||r&&y(new r)!=d||o&&y(new o)!=c)&&(y=function(e){var t=n(e),i="[object Object]"==t?e.constructor:void 0,r=i?a(i):"";if(r)switch(r){case p:return u;case m:return s;case h:return l;case f:return d;case g:return c}return t});return y});define("T2",["Tg","SR"],function(e,t){return e(t,"DataView")});define("T1",["Tg","SR"],function(e,t){return e(t,"Promise")});define("T0",["Tg","SR"],function(e,t){return e(t,"Set")});define("TZ",["Tg","SR"],function(e,t){return e(t,"WeakMap")});define("Uz",["TH","T5"],function(n,a){return function(e){for(var t=a(e),i=t.length;i--;){var r=t[i],o=e[r];t[i]=[r,o,n(o)]}return t}});define("TH",["ST"],function(t){return function(e){return e==e&&!t(e)}});define("TG",[],function(){var r;return function(t,i){return function(e){return null!=e&&e[t]===i&&(i!==r||t in Object(e))}}});define("TF",["TQ","TP","TI","SX","TH","TG","SW"],function(o,n,a,e,t,s,l){var d,c=1,u=2;return function(i,r){return e(i)&&t(r)?s(l(i),r):function(e){var t=n(e,i);return t===d&&t===r?a(e,i):o(r,t,c|u)}}});define("TP",["SZ"],function(o){var n;return function(e,t,i){var r=null==e?n:o(e,t);return r===n?i:r}});define("SZ",["S0","SW"],function(o,n){var a;return function(e,t){for(var i=0,r=(t=o(t,e)).length;null!=e&&i<r;)e=e[n(t[i++])];return i&&i==r?e:a}});define("S0",["TD","SX","S4","S1"],function(i,r,o,n){return function(e,t){return i(e)?e:r(e,t)?[e]:o(n(e))}});define("SX",["TD","SL"],function(r,o){var n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;return function(e,t){if(r(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!o(e))||a.test(e)||!n.test(e)||null!=t&&e in Object(t)}});define("SL",["SN","SM"],function(t,i){var r="[object Symbol]";return function(e){return"symbol"==typeof e||i(e)&&t(e)==r}});define("S4",["S5"],function(e){var t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g;return e(function(e){var o=[];46===e.charCodeAt(0)&&o.push("");e.replace(t,function(e,t,i,r){o.push(i?r.replace(n,"$1"):t||e)});return o})});define("S5",["S6"],function(r){var o=500;return function(e){var t=r(e,function(e){i.size===o&&i.clear();return e}),i=t.cache;return t}});define("S6",["S7"],function(e){var t="Expected a function";function i(o,n){if("function"!=typeof o||null!=n&&"function"!=typeof n)throw new TypeError(t);var a=function(){var e=arguments,t=n?n.apply(this,e):e[0],i=a.cache;if(i.has(t))return i.get(t);var r=o.apply(this,e);a.cache=i.set(t,r)||i;return r};a.cache=new(i.Cache||e);return a}i.Cache=e;return i});define("S1",["S2"],function(t){return function(e){return null==e?"":t(e)}});define("S2",["SQ","S3","TD","SL"],function(e,r,o,n){var a=1/0,t=e?e.prototype:void 0,s=t?t.toString:void 0;return function e(t){if("string"==typeof t)return t;if(o(t))return r(t,e)+"";if(n(t))return s?s.call(t):"";var i=t+"";return"0"==i&&1/t==-a?"-0":i}});define("S3",[],function(){return function(e,t){for(var i=-1,r=null==e?0:e.length,o=Array(r);++i<r;)o[i]=t(e[i],i,e);return o}});define("SW",["SL"],function(i){var r=1/0;return function(e){if("string"==typeof e||i(e))return e;var t=e+"";return"0"==t&&1/e==-r?"-0":t}});define("TI",["TO","TJ"],function(i,r){return function(e,t){return null!=e&&r(e,t,i)}});define("TO",[],function(){return function(e,t){return null!=e&&t in Object(e)}});define("TJ",["S0","TM","TD","TL","TK","SW"],function(s,l,d,c,u,p){return function(e,t,i){for(var r=-1,o=(t=s(t,e)).length,n=!1;++r<o;){var a=p(t[r]);if(!(n=null!=e&&i(e,a)))break;e=e[a]}return n||++r!=o?n:!!(o=null==e?0:e.length)&&u(o)&&c(a,o)&&(d(e)||l(e))}});define("TE",[],function(){return function(e){return e}});define("SV",["TC","SY","SX","SW"],function(t,i,r,o){return function(e){return r(e)?t(o(e)):i(e)}});define("TC",[],function(){var i;return function(t){return function(e){return null==e?i:e[t]}}});define("SY",["SZ"],function(i){return function(t){return function(e){return i(e,t)}}});define("SI",["SJ"],function(r){return function(e){var t=r(e),i=t%1;return t==t?i?t-i:t:0}});define("SJ",["SK"],function(t){var i=1/0,r=1.7976931348623157e308;return function(e){if(!e)return 0===e?e:0;if((e=t(e))===i||e===-i)return(e<0?-1:1)*r;return e==e?e:0}});define("SK",["ST","SL"],function(r,o){var n=NaN,a=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,d=/^0o[0-7]+$/i,c=parseInt;return function(e){if("number"==typeof e)return e;if(o(e))return n;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var i=l.test(e);return i||d.test(e)?c(e.slice(2),i?2:8):s.test(e)?n:+e}});define("SD",["require","exports","bA","SG","SF","SE"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}e.prototype.logEvent=function(e){switch(e.name){case"sss_responsereceived":r.default.logData(e);return;case"sss_searchactions":o.default.logData(e);return;case"sss_searchentityactions":n.default.logData(e);return;default:return}};e.dependencies={};return e}();t.TsInstrumentationDataSource=a;t.resourceKey=i.createResolvedResourceKey(e("module").id,a)});define("SG",["require","exports","aR"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sss_responsereceived=i.createSingleEvent({eventName:"sss_responsereceived,",shortEventName:"sss_responsereceived"},{traceid:{isPrefixingDisabled:!0,type:1},latency:{isPrefixingDisabled:!0,type:2},status:{isPrefixingDisabled:!0,type:2},rendered:{isPrefixingDisabled:!0,type:2},renderinglatency:{isPrefixingDisabled:!0,type:2}});t.default=t.sss_responsereceived});define("SF",["require","exports","aR"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sss_searchactions=i.createSingleEvent({eventName:"sss_searchactions,",shortEventName:"sss_searchactions"},{traceid:{isPrefixingDisabled:!0,type:1},eventtype:{isPrefixingDisabled:!0,type:1},localtime:{isPrefixingDisabled:!0,type:1}});t.default=t.sss_searchactions});define("SE",["require","exports","aR"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sss_searchentityactions=i.createSingleEvent({eventName:"sss_searchentityactions,",shortEventName:"sss_searchentityactions"},{traceid:{isPrefixingDisabled:!0,type:1},eventtype:{isPrefixingDisabled:!0,type:1},id:{isPrefixingDisabled:!0,type:1},localtime:{isPrefixingDisabled:!0,type:1}});t.default=t.sss_searchentityactions});define("UJ",[],function(){return'<div class=od-SearchResults data-bind="css: { \'od-SearchResults-hasStatus\': !!statusMessage() }, keyboard: { allowInputEvents: true, preventDefault: true, mappings: { Enter: context.onEnter, Down: context.onArrowDown, Up: context.onArrowUp, Space: context.onSpace } },">\x3c!--ko if: !context.queryInProgress() && !statusMessage()--\x3e<div class=ms-accessible role=alert data-bind="text: accessibleTextNewResults"></div>\x3c!--/ko--\x3e\x3c!--ko if: !context.queryInProgress() && noResults()--\x3e<div class=ms-accessible role=alert data-bind="text: accessibleTextNoResults"></div>\x3c!--/ko--\x3e<div class=od-SearchResults-progressBox data-bind="component: {name: progressSpinnerFlatTagName}, visible: context.queryInProgress()"></div><div class=od-SearchResults-status data-bind="text: statusMessage"></div><ul class="od-SearchResults-resultsBox ms-noList" data-bind="attr: { id: context.ariaResultsId }" role=list>\x3c!--ko foreach: context.searchData().containers--\x3e\x3c!--ko foreach: results--\x3e\x3c!--ko template: $component.getTemplate.call($component, $data)--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: ($index() < $parent.context.searchData().containers.length - 1)--\x3e<li class=od-SearchResults-separator role=separator><hr class=od-SearchResults-separator-line></li>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</ul>\x3c!--ko activate: $component.renderComplete()--\x3e\x3c!--/ko--\x3e</div>'});define("UI",["c","az"],function(e,t){e.loadStyles([{rawString:".od-SearchResults-suggestion{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin:0 -16px;padding:8px 16px;min-height:30px;cursor:pointer}.od-SearchResults-suggestion .od-SearchResults-result-glyph,.od-SearchResults-suggestion .od-SearchResults-result-icon{-ms-flex:0 0 48px;flex:0 0 48px;height:48px;margin:0;text-align:center;line-height:48px}.sm .od-SearchResults-suggestion .od-SearchResults-result-glyph,.sm .od-SearchResults-suggestion .od-SearchResults-result-icon{-ms-flex:0 0 20px;flex:0 0 20px;height:20px;line-height:20px}.od-SearchResults-suggestion .od-IconGlyph{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:';font-size:34px}.sm .od-SearchResults-suggestion .od-IconGlyph{font-size:20px}.od-SearchResults-suggestion .od-SearchResults-result-title{position:static;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center;margin:0 0 0 16px}html[dir=rtl] .od-SearchResults-suggestion .od-SearchResults-result-title{margin:0 16px 0 0}[dir=ltr] .od-SearchResults-suggestion .od-SearchResults-result-title{padding-left:0}[dir=rtl] .od-SearchResults-suggestion .od-SearchResults-result-title{padding-right:0}.od-SearchResults-suggestion .od-SearchResults-result-title-text{display:inline;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}.od-SearchResults-suggestion .od-SearchResults-result-metadata{display:-ms-flexbox;display:flex;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SearchResults-suggestion .od-SearchResults-result-metadata{padding-left:0}[dir=rtl] .od-SearchResults-suggestion .od-SearchResults-result-metadata{padding-right:0}.od-SearchResults-suggestion .ms-dotSeparatorBefore{margin-left:4px}.od-SearchResults{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid transparent;padding:0 16px;box-sizing:border-box;box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:';width:432px}.md .od-SearchResults,.sm .od-SearchResults{width:100%}.od-SearchResults-hasStatus>.od-SearchResults-status{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:15px;font-weight:400;display:block}.od-SearchResults-status{display:none;margin:10px auto}.od-SearchResults-hasStatus>.od-SearchResults-resultsBox{display:none}.od-SearchResults-resultsBox{box-sizing:border-box;width:100%}.od-SearchResults-result{text-decoration:none;position:relative;margin-bottom:2px}.od--isNonMobile .od-SearchResults-result-link:hover,.od--isNonMobile .od-SearchResults-suggestion:hover{background:'},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:";outline:1px solid transparent}.od--isNonMobile .od-SearchResults-result-link:hover.is-selected,.od--isNonMobile .od-SearchResults-suggestion:hover.is-selected{background:"},{theme:"themeLightAlt",defaultValue:"#beddf4"},{rawString:"}.od-SearchResults-result-link--focused{background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}.od-focus--enabled .od-SearchResults-result-link--focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:' inset;outline:1px dashed transparent}.od-SearchResults-expanded-result i,.od-SearchResults-result-highlight{font-family:"Segoe UI Semibold WestEuropean","Segoe UI Semibold","Segoe UI",Tahoma,Arial,sans-serif;font-weight:600}.od-SearchResults-expanded-result i{font-style:normal}.od-SearchResults-result-icon{height:24px;width:24px;margin-top:5px;display:inline-block;position:relative}.od-SearchResults-result-parentFolder{display:inline-block;color:'},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:'}.od-SearchResults-result-title{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:15px;font-weight:400;box-sizing:border-box;pointer-events:none}[dir=ltr] .od-SearchResults-result-title{padding-left:40px}[dir=rtl] .od-SearchResults-result-title{padding-right:40px}.od-SearchResults-result-metadata,.od-SearchResults-result-summary{box-sizing:border-box}[dir=ltr] .od-SearchResults-result-metadata,[dir=ltr] .od-SearchResults-result-summary{padding-left:52px}[dir=rtl] .od-SearchResults-result-metadata,[dir=rtl] .od-SearchResults-result-summary{padding-right:52px}.od-SearchResults-result-metadata,.od-SearchResults-result-title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-SearchResults-result-title{position:absolute;top:0;width:100%}[dir=ltr] .od-SearchResults-result-title{left:0}[dir=rtl] .od-SearchResults-result-title{right:0}.od-SearchResults-result-title-text{vertical-align:top;display:inline-block;overflow:hidden;text-overflow:ellipsis;max-width:100%}[dir=ltr] .od-SearchResults-result-title-text{margin-right:6px}[dir=rtl] .od-SearchResults-result-title-text{margin-left:6px}.od-SearchResults-result-link{text-decoration:none;display:block;height:34px;line-height:34px;margin:0 -16px;padding:0 16px;cursor:pointer}.od-SearchResults-result-folderLink{text-decoration:none}.od-SearchResults-upscope-result{text-align:center;margin-bottom:0}.od-SearchResults-upscope-result .od-SearchResults-result-link{display:inline-block;width:100%;height:48px;line-height:48px}.od-SearchResults-upscope-result .ms-Icon--Search{color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-SearchResults-upscope-result .ms-Icon--Search{margin-right:8px}[dir=rtl] .od-SearchResults-upscope-result .ms-Icon--Search{margin-left:8px}.od-SearchResults-upscope-result .od-SearchResults-result-title{position:relative;top:-2px}[dir=ltr] .od-SearchResults-upscope-result .od-SearchResults-result-title{padding-left:0}[dir=rtl] .od-SearchResults-upscope-result .od-SearchResults-result-title{padding-right:0}.od-SearchResults-progressBox{position:absolute;width:100%;top:2px}[dir=ltr] .od-SearchResults-progressBox{left:0}[dir=rtl] .od-SearchResults-progressBox{right:0}.od-SearchResults-separator-line{margin:0 -16px;border:0;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ms-noList ol,.ms-noList ul,ol.ms-noList,ul.ms-noList{list-style-type:none;margin-top:0;margin-bottom:0}[dir=ltr] .ms-noList ol,[dir=ltr] .ms-noList ul,[dir=ltr] ol.ms-noList,[dir=ltr] ul.ms-noList{padding-left:0}[dir=rtl] .ms-noList ol,[dir=rtl] .ms-noList ul,[dir=rtl] ol.ms-noList,[dir=rtl] ul.ms-noList{padding-right:0}.ms-dotSeparatorAfter::after{content:'\\a0\\b7'}.ms-dotSeparatorBefore::before{content:'\\b7\\a0'}.ms-enquote::before{content:'\\93'}.ms-enquote::after{content:'\\94'}"}])});define("UH",[],function(){return'<li class=od-SearchResults-suggestion tabindex=-1 data-bind="attr: { \'aria-label\': titleAriaLabel || title, id: ariaId() }, click: $component.onClickResult.bind($component), clickBubble: false, css: { \'od-SearchResults-result-link--focused\': isFocused }, hasFocus: isFocused"><div class=od-SearchResults-result-icon data-bind="component: { name: $component.imageFrameTagName, params: { desiredSize: $component.iconDesiredSize, fadeIn: $component.fadeIn, image: $component.getIconImage($data) } }"></div><div class=od-SearchResults-result-title><div class=od-SearchResults-result-title-text data-bind="html: title"></div>\x3c!--ko if: $component.displayOdbMetadata($data)--\x3e<div class=od-SearchResults-result-metadata><div data-bind="text: parentFolder"></div><div data-bind="text: lastModifiedDateDisplay" class=ms-dotSeparatorBefore></div>\x3c!--ko if: $component.displayLastModifiedBy($data)--\x3e<div data-bind="text: lastModifiedBy" class=ms-dotSeparatorBefore></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></li>'});define("UG",[],function(){return'<li class="od-SearchResults-result od-SearchResults-expanded-result"><div class=od-SearchResults-result-link tabindex=-1 role=listitem data-bind="click: $component.onClickResult.bind($component), clickBubble: false, css: { \'od-SearchResults-result-link--focused\': isFocused }, attr: { id: ariaId(), \'aria-label\': titleAriaLabel || title }, hasFocus: isFocused"><div class=od-SearchResults-result-icon data-bind="component: { name: $component.imageFrameTagName, params: { image: { url: iconUrl }, desiredSize: { width: 24, height: 24 }, fadeIn: $component.fadeIn } }"></div><span class=od-SearchResults-result-title data-bind="html: title"></span></div>\x3c!--ko if: !!$data.lastModifiedBy && !!$data.lastModifiedDate && !!$data.parentFolder--\x3e<div class="od-SearchResults-result-metadata ms-font-s ms-fontColor-neutralSecondary"><span data-bind="text: lastModifiedBy" class=ms-dotSeparatorAfter></span> <a data-bind="text: parentFolder, attr: { href: parentUrl, \'aria-label\': $component.parentFolderLabel }" class="od-SearchResults-result-folderLink ms-font-s ms-fontColor-themePrimary" target=_blank tabindex=-1></a> <span data-bind="text: $component.getRelativeDateTimeStringPast(lastModifiedDate)" class=ms-dotSeparatorBefore></span></div>\x3c!--/ko--\x3e\x3c!--ko if: $data.showSummary && !!$data.summary--\x3e<div class="od-SearchResults-result-summary ms-font-s ms-fontColor-neutralSecondary"><span data-bind="html: summary" class=ms-enquote></span></div>\x3c!--/ko--\x3e</li>'});define("UF",[],function(){return"<li class=od-SearchResults-suggestion tabindex=-1 data-bind=\"attr: { 'aria-label': titleAriaLabel, id: ariaId() }, click: $component.onClickResult.bind($component), clickBubble: false, css: { 'od-SearchResults-result-link--focused': isFocused }, hasFocus: isFocused\"><div class=od-SearchResults-result-glyph data-bind=\"component: { name: 'od-icon-glyph', params: { icon: glyph } }\"></div><div class=od-SearchResults-result-title><div class=od-SearchResults-result-title-text data-bind=\"html: title\"></div></div></li>"});define("UE",[],function(){return"<li class=\"od-SearchResults-result od-SearchResults-upscope-result\" role=presentation><div class=od-SearchResults-result-link tabindex=0 role=link data-bind=\"click: $component.onClickResult.bind($component), clickBubble: false, css: { 'od-SearchResults-result-link--focused': isFocused }, attr: { id: ariaId(), 'aria-label': titleAriaLabel }, hasFocus: isFocused\">\x3c!--ko component: { name: 'od-icon-glyph', params: { icon: glyph }}--\x3e\x3c!--/ko--\x3e<span class=od-SearchResults-result-title data-bind=\"text: title\"></span></div></li>"});define("SB",["require","exports","ap","aq","bN","dc","eu","aC","bT","aI","bA","cE","UC","SC","bX","dZ","d7","iE","dH","d5","ba","dI"],function(e,t,i,s,r,o,l,d,c,u,n,p,m,h,f,g,y,v,_,b,x,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(n){i.__extends(a,n);function a(e,t){var o=n.call(this,e,t)||this;o._currentItem=t.currentItem;var i=o._engagement=t.engagement;o._instrumentationProvider=t.instrumentationProvider;o._navigation=t.navigation;o._searchProvider=t.searchProvider;var r=t.spPageContext;o._tsInstrumentationProvider=t.tsInstrumentationProvider;o._urlDataSource=t.urlDataSource;o._viewParams=t.viewParams;o.search=function(){var e=o.searchText.peek();if(o._searchProvider&&e){o._tsLogSearchDone(e);i.logData({name:"Upscope.Search.Click",isIntentional:!0});o._onNavigateAway();o._searchProvider.upscopeSearch(e);o.unfocusInput()}};o.onSpace=function(){var e=o.focusedItem.peek();e&&7===e.type&&o.searchResultClicked(e)};o.onEnter=function(){var e=o.focusedItem.peek();e?o.searchResultClicked(e):o._logAndSubmit()};o.clearInput=function(e){o.searchText("");o._tsResetSearchSession();o._submitOnClear&&!e&&o._logAndSubmit();e||o.focusInput()};o.focusInput=function(){if(r){l.ABExperiment.Init(r);new l.ABExperiment({name:"A/A - E2E data flow for Search, both QF and Query",startDate:"02/02/2018"}).IsExperimentOn()}if(o._instrumentationProvider){o._instrumentationProvider.onSearchFocus();i.logData({name:"Focus.SearchBox.SearchBox.Click",isIntentional:!0})}o.inputFocused(!0);o._setFocusItem(null);o.isActive(!0);""===o.searchText.peek()&&o._autoSuggest("")};o.onSearchClick=function(){o.isActive.peek()?o._logAndSubmit():o.focusInput()};o.unfocusInput=function(){o.inputFocused(!0);o.inputFocused(!1);o.isActive(!1)};o.onBack=function(){o.clearInput();o.unfocusInput()};o.onArrowDown=function(){if(o.showResults.peek()){var e=o.allResults.peek();if(e&&e.length){var t=o.focusedItem.peek(),i=e[0];if(null!==t){var r=e.indexOf(t);i=(r+=1)===e.length?null:e[r]}o._setFocusItem(i)}return!1}};o.onArrowUp=function(){if(o.showResults.peek()){var e=o.allResults.peek();if(e&&e.length){var t=o.focusedItem.peek(),i=e[e.length-1];if(null!==t){var r=e.indexOf(t);i=0!==r?e[r-=1]:null}o._setFocusItem(i)}return!1}};o.searchResultClicked=function(e){o._setFocusItem(null);if(o._searchProvider&&e)if(7===e.type)o._logAndSubmit();else{o._tsLogEntitySelected(e);o._engagement.logData({name:"InlineResult.Search.Click",isIntentional:!0});o._searchProvider.searchResultClicked(e);o._updateText(e,!1);o._instrumentationProvider&&e.instrumentationUrl&&o._instrumentationProvider.userClickSuggestion(e.instrumentationUrl);var t=e.key,i=e.url;if(t){o._onNavigateAway();o._navigation.navigateTo({url:x.isFeatureEnabled(x.UseQfSearch)?"#"+t:o._urlDataSource.getItemUrl(t)})}else if(i){o._onNavigateAway();o._navigation.navigateTo({url:i,frameId:"_blank"})}}o.unfocusInput()};o.placeholder=e.searchParams.placeholder;o.submitPlaceholder=e.searchParams.submitPlaceholder;o.hasBack=e.searchParams.hasBack;o.hideResultsUntilChange=s.observable(!1);o.submitAction=e.searchParams.submitAction||o.search;o.searchIconLeft=s.observable(!1);o.searchIconRight=s.observable(!1);o.createBackgroundComputed(function(){o._urlDataSource.getQueryType(o._viewParams&&o._viewParams())!==_.default.Search&&o.clearInput(!0)});o.capabilities=o._searchProvider.getCapabilities();o.isFocused=s.observable(!1);o.isActive=s.observable(!1);o.ariaAutoComplete=o.capabilities.supportsResultsWheeling?"list":"none";o.ariaResultsId="od-searchResults-list-"+a.resultsId++;o.searchBoxAriaLabel=e.searchParams.searchBoxAriaLabel;o.searchText=e.searchParams.searchText||s.observable("");o.searchText.peek()&&o.async.setImmediate(function(){o._logAndSubmit()});o.inputFocused=s.observable(!1);o._hadResults=!1;o._ignorableTextUpdateCount=0;o._isTemporarySuggestion=!1;o._submitOnClear=!!e.searchParams.submitOnClear;o._tsLastTraceId="";o.searchData=s.observable({});o.allResults=s.observableArray();o.focusedItem=s.observable(null);o.subscribe(o.allResults,function(){o._setFocusItem(null)});o.queryInProgress=s.observable(!1);o.errorMessage=s.observable("");o.createComputed(o._computeSearchTextChanged).extend({rateLimit:o.capabilities.maxQueryRate});o.createComputed(function(){o.isFocused()?o.isActive(!0):o.isActive(!1)});o.showResults=o.addDisposable(s.pureComputed({read:function(){var e=o.searchText();if(o.hideResultsUntilChange())return!1;var t=!0;if(o.capabilities.showOnlyResults){var i=o.allResults();if(i&&i.length&&(o._hadResults||1<i.length)){t=!0;o._hadResults=!0}else t=!1}else e.length<o.capabilities.minimumQueryLength&&(t=!1);return o.capabilities.supportsResultsWheeling&&o.isFocused()&&t},write:function(){}}));o.createComputed(function(){o.isFocused()||o.hideResultsUntilChange(!1)});o.createBackgroundComputed(function(){o.isActive();var e=b.default.determineWindowSize(window.innerWidth);b.default.DEFAULT_BREAKPOINTS[e]<=b.default.DEFAULT_BREAKPOINTS.Large&&o.async.setTimeout(function(){c.default.raise(document.body,"resize",void 0,!0)},400)});o.observables.compute(function(){var e,t=o.searchData();t&&(e=t.traceId)&&(o._tsLastTraceId=e)});return o}a.prototype._computeSearchTextChanged=function(){var e=this.searchText();this.hideResultsUntilChange(!1);if(this.capabilities.supportsResultsWheeling&&this.isFocused.peek()&&this._previousSearchText!==e&&0===this._ignorableTextUpdateCount){this._isTemporarySuggestion=!1;this._autoSuggest(e)}this._ignorableTextUpdateCount&&this._ignorableTextUpdateCount--};a.prototype._autoSuggest=function(e){this.queryInProgress.peek()&&this._searchResultsRequestPromise&&this._searchResultsRequestPromise.cancel();this.queryInProgress(!0);if(this._searchProvider.getItems){this._searchResultsRequestPromise=u.Qos.instrumentPromise({name:"SearchResultsRequest"},this._searchProvider.getItems.bind(this._searchProvider,e,this._currentItem?this._currentItem.peek():null),null,function(e){return d.default.isCanceled(e)?{resultType:u.ResultTypeEnum.Success}:{resultType:u.ResultTypeEnum.Failure,error:e}});this._searchResultsRequestPromise.done(this._resultCallback(),this._errorCallback());this._previousSearchText=e}};a.prototype._logAndSubmit=function(){this._instrumentationProvider.logStartSearchOnSubmit();this.submitAction(this)};a.prototype._clearResults=function(){this.searchData({});this.allResults.removeAll()};a.prototype._resultCallback=function(){var o=this;return function(e){o.queryInProgress(!1);o.errorMessage("");if(e.upscopeAvailable){var t=o.submitPlaceholder.peek();e.containers.push({results:[{type:7,title:t,titleAriaLabel:t,glyph:new S.default("Search")}]})}var i=o._viewFromISearchResult(e),r=i.containers.reduce(function(e,t){return e.concat(t.results)},[]);o.capabilities.showOnlyResults&&!r.length&&o.showResults(!1);o.searchData(i);o.allResults(r)}};a.prototype._errorCallback=function(){var t=this;return function(e){if(!d.default.isCanceled(e)){t.queryInProgress(!1);t.errorMessage(String(e));t._clearResults()}}};a.prototype._viewFromISearchResult=function(e){var t=e.containers.map(function(e){return{results:e.results.map(function(e,t){return i.__assign({},e,{isFocused:s.observable(!1),ariaId:s.observable("od-searchResults-result-"+t)})})}});return i.__assign({},e,{containers:t})};a.prototype._onNavigateAway=function(){this._tsResetSearchSession();this._isTemporarySuggestion=!1;this._searchResultsRequestPromise&&this._searchResultsRequestPromise.cancel()};a.prototype._setFocusItem=function(e){var t=this.focusedItem.peek();if(t!==e){t&&t.isFocused(!1);this.focusedItem(e);if(e){e.isFocused(!0);this._updateText(e,!0)}else this.focusInput()}};a.prototype._updateText=function(e,t){if(4===e.type){this._ignorableTextUpdateCount++;this.searchText(e.titleText);this._isTemporarySuggestion=t}else if(this._isTemporarySuggestion){this._ignorableTextUpdateCount++;this.searchText(this._previousSearchText);this._isTemporarySuggestion=!1}};a.prototype._tsLogEntitySelected=function(e){x.isFeatureEnabled(x.UseQfSearch)&&this._tsInstrumentationProvider&&this._tsInstrumentationProvider.selectedEntity(this.searchData.peek().traceId,e.referenceId)};a.prototype._tsLogSearchDone=function(e){x.isFeatureEnabled(x.UseQfSearch)&&this._tsInstrumentationProvider&&e!==this._navigation.viewParams.q&&this._tsInstrumentationProvider.didSearch(this._tsLastTraceId)};a.prototype._tsResetSearchSession=function(){this._tsLastTraceId="";x.isFeatureEnabled(x.UseQfSearch)&&this._tsInstrumentationProvider&&this._tsInstrumentationProvider.renderedResults("",-1)};a.dependencies=i.__assign({},r.default.dependencies,{currentItem:f.currentItem,engagement:p.resourceKey,instrumentationProvider:y.instrumentation,navigation:o.navigation,searchProvider:m.resourceKey,spPageContext:v.pageContext.optional,tsInstrumentationProvider:h.resourceKey.optional,urlDataSource:g.url,viewParams:f.viewParams});a.resultsId=0;return a}(r.default);t.default=a;t.typeResourceKey=n.createResolvedTypeResourceKey(e("module").id,a)});define("UC",["require","exports","dZ","bA"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.AliasResourceFactory(i.search)})});define("Sz",[],function(){return"<div class=od-Search id=od-Search-div data-bind=\"keyboard: { allowInputEvents: true, mappings: { Esc: context.clearInput } }, css: { 'od-Search--active': context.isActive }, hasChildFocus: context.isFocused, element: rootElement\">\x3c!--ko control: searchBoxSpecification--\x3e\x3c!--/ko--\x3e\x3c!--ko if: context.showResults()--\x3e\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n alignToParent: !isMdDown()\r\n }\r\n }--\x3e<div class=od-Search-overlay data-bind=\"control: searchResultsSpecification, css: { 'od-Search--active': context.isActive, 'od-Search--maximized': isMdDown() }, style: resultsStyle\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>"});define("Sy",["c","az"],function(e,t){e.loadStyles([{rawString:".lg .od-Search-overlay .od-SearchResults,.xlg .od-Search-overlay .od-SearchResults,.xxlg .od-Search-overlay .od-SearchResults,.xxxlg .od-Search-overlay .od-SearchResults,.xxxxlg .od-Search-overlay .od-SearchResults{position:absolute;top:40px}.od-Search--maximized{position:absolute;left:0;right:0;bottom:0;overflow:auto}.od-Search--maximized .od-SearchBox{border-color:transparent}"}])});define("UT",["require","exports","ap","fZ","bN","ex","ir","bX","gl","dZ","iq","ib","ba","il","aZ","dq","if","iJ","eO","fO","cL","dk","gK","cY","by","dH","vP","iE","gA","ia","eT","bA"],function(e,t,i,o,n,y,v,a,s,l,_,b,x,d,S,C,P,c,k,u,I,T,w,E,p,D,A,m,h,f,M,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=["Title","Path","Filename","FileExtension","Created","LastModifiedTime","ModifiedBy","LinkingUrl","SiteTitle","ParentLink","ListID","ListItemID","SPSiteURL","SiteID","WebId","UniqueID","SPWebUrl",".mediaBaseUrl",".spResourceUrl",".callerStack",".correlationId",".thumbnailUrl",".videoManifestUrl",".pdfConversionUrl"],F=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._isShortcutFeatureEnabled=x.isFeatureEnabled(x.ShortcutLink);i._pageContext=t.pageContext;i._apiUrlHelper=t.apiUrlHelper;i._itemUrlHelper=t.itemUrlHelper;i._itemsStore=t.itemsStore;i._urlDataSource=t.urlDataSource;i._microServiceDataSource=t.microServiceDataSource;i._vroomUrlHelper=t.vroomUrlHelper;i._disableCalloutInvoker=t.disableCalloutInvoker;i._platformDetection=t.platformDetection;i._itemTaskObserverType=t.itemTaskObserverType;i._useMobileList=t.useMobileList;i._dataRequestor=new t.dataRequestorType({qosName:"RecentDataSource"});return i}e.prototype.getItem=function(t){var i=this;return this._dataRequestor.getData({url:this._getRequestUrl(),method:"GET",qosName:t.queryType===D.default.Popular?"GetPopularDocs":"GetRecentUnpopular",noRedirect:!0}).then(function(e){return i._processResponse(t,e)})};e.prototype._getRequestUrl=function(){var e=["mht","aspx","html","htm"];this._isShortcutFeatureEnabled&&e.push("url","lnk","website");return this._apiUrlHelper.build().segments("search","query").parameters({querytext:"*",querytemplate:"(AuthorOwsUser:{User.AccountName} OR EditorOwsUser:{User.AccountName}) AND IsDocument:1 AND -Title:OneNote_DeletedPages AND -Title:OneNote_RecycleBin NOT(FileExtension:"+e.join(" OR FileExtension:")+")",rowlimit:50,bypassresulttypes:!1,selectproperties:g.join(","),sortlist:"LastModifiedTime:descending",enablesorting:!0}).toString()};e.prototype._processResponse=function(e,t){var i=this,r=e.queryType,o=void 0===r?D.default.Recent:r,n=e.parentKey,a=t.d.query.PrimaryQueryResult.RelevantResults.Table.Rows.results||[],s=a.length,l=A.createSearchRoot({key:n,queryType:o,name:_.strings.Recent,isPlaceholder:!1,childCount:s});l.permissions=b.default.or([E.PermissionMask.openItems,E.PermissionMask.managePermissions]);this._itemsStore.setItem(l);var d=new this._itemTaskObserverType,c=a.map(function(e){return i._getRecentItem(e,o,d)});d.flush();var u=this._disableCalloutInvoker,p=v.default.fillColumnDefinitionDefaults([{internalName:"IsContainer",key:"type",name:"",isIcon:!0,width:v.default.getIconColumnWidth(this.resources),fieldType:y.ColumnFieldType.FileIcon},{internalName:"FileLeafRef",key:"name",name:_.strings.NameColumnName,isRowHeader:!0,width:250,fieldType:y.ColumnFieldType.Name,hasListItemMenu:!u},{internalName:"Modified",key:"dateModified",name:_.strings.ModifiedColumnName,width:200,fieldType:y.ColumnFieldType.DateTime},{internalName:"ModifiedBy",key:"editorName",name:_.strings.ModifiedByColumnName,width:200,fieldType:y.ColumnFieldType.User}],{isCollapsible:!1},{sortField:"Modified",isAscending:!1}),m=p[0],h=p[1],f=p[2],g=[m,h,f,p[3]];u||g.splice(2,0,{internalName:"_calloutInvoker",key:"_calloutInvoker",name:"",width:18,fieldType:y.ColumnFieldType.DotDotDot});return{item:l,children:c,totalChildren:s,schema:this._platformDetection.isMobile&&this._useMobileList?v.default.getCustomColumns(m,[[h],[f]],[h,f]):g}};e.prototype._getRecentItem=function(e,t,i){var r=A.getProperties(e.Cells),o=this._itemUrlHelper.getUrlParts({path:r.Path,webUrl:r.SPSiteURL}),n=this._urlDataSource.getKey(((f={}).id=decodeURIComponent(o.serverRelativeItemUrl),f.u="search"+(r.UniqueID||""),f.listurl=o.normalizedListUrl,f)),a={key:n};a.id=r.ListItemID;a.name=r.Filename||r.Title;a.parentLink=r.ParentLink;a.displayName=r.Title;a.isPlaceholder=!1;var s=r[".spResourceUrl"];if(s){var l=this._vroomUrlHelper.getUrlParts(s);a.itemId=l.itemId;a.graph={itemId:l.itemId,driveId:l.driveId}}var d=r.FileType&&"one"===r.FileType?k.default.OneNote:k.default.File;a.dateModified=new Date(r.LastModifiedTime).toLocaleDateString(I.default.language);a.queryType=t;a.openUrl=r.LinkingUrl?w.canonicalizeDecodedUrl(r.LinkingUrl):r.Path;a.editorName=P.getModifiedByFromString(r.ModifiedBy);a.defaultSubText=P.getGridSubTitleTextFromModifiedBy(a.editorName);var c,u=r.FileExtension,p=u?"."+u:"";a.extension=p;if(C.getItemTypeFromExtension(u)===k.default.Media){d=k.default.Media;"photo"===C.getIconNameFromExtension(u)&&(c={width:0,height:0})}a.photo=M.Graft.optional(c);a.thumbnail=this._getThumbnail(n,p,r);a.urls=this._getVideoUrl(r);var m=this._getPdfConversionFacet(r);x.isFeatureEnabled(x.UseWebPdfViewer)&&(".pdf"===a.extension||m)&&(d=k.default.Media);m&&(a.pdfConversion=m);a.type=d;a.sharingRole=2;var h,f,g={title:a.editorName,email:"",id:"",sip:""},y=r.EditorOWSUSER;if(y){var v=y.indexOf("|");0<=v&&(g.sip=y.slice(0,v).trim())}a.iconName=C.getIconNameFromItem({extension:p,type:d});a.permissions=b.default.or([E.PermissionMask.openItems,E.PermissionMask.managePermissions]);a.itemFromServer=r;p&&(h=T.OfficeIconFileTypeMap[u]);a.appMap=M.Graft.optional(h);a.properties={ID:r.ListItemID,listId:r.ListID,path:r.Path,editorName:[g],uniqueId:r.UniqueID&&S.default.normalizeLower(r.UniqueID)};i.update([new M.Task(n).succeed({item:a})]);return{key:n}};e.prototype._getPdfConversionFacet=function(e){var t=this._microServiceDataSource.getPdfConversionUrl({fileExtension:e.FileExtension,item:e});if(t)return{url:t}};e.prototype._getThumbnail=function(e,t,i){return this._microServiceDataSource.getThumbnail({itemKey:e,fileExtension:t,item:i})||d.previewImageUrlFromProps(i.SiteID,i.WebId,i.UniqueID,this._pageContext.webAbsoluteUrl,this._pageContext)};e.prototype._getVideoUrl=function(e){var t=this._microServiceDataSource.getVideoUrl({fileExtension:e.FileExtension,item:e}),i={};t&&(i[h.default.video]=t);return i};e.dependencies=i.__assign({},n.default.dependencies,{pageContext:m.pageContext,apiUrlHelper:o.resourceKey,itemUrlHelper:u.resourceKey,itemsStore:c.resourceKey,urlDataSource:l.url,microServiceDataSource:l.microService,vroomUrlHelper:f.resourceKey,dataRequestorType:s.typeResourceKey,platformDetection:p.platformDetection,disableCalloutInvoker:a.disableCalloutInvoker.optional,itemTaskObserverType:M.resourceKey,useMobileList:a.useMobileList.optional});return e}(n.default);t.default=F;t.resourceKey=r.createResolvedResourceKey(e("module").id,F)});define("vP",["require","exports","eV","eO"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getProperties=function(e){for(var t={},i=0,r=e.results;i<r.length;i++){var o=r[i],n=o.Key,a=o.Value;switch(o.ValueType){case"Edm.Boolean":t[n]={false:!1,true:!0}[a];break;case"Edm.Double":t[n]=parseFloat(a);break;case"Edm.Byte":case"Edm.Int32":case"Edm.Int64":t[n]=parseInt(a,10);break;case"Null":t[n]=null;break;case"Edm.String":if("Edges"===n){for(var s=JSON.parse(a),l=0,d=s;l<d.length;l++){var c=d[l];c.Properties.BlobContent&&(c.Properties.BlobContent=JSON.parse(c.Properties.BlobContent.toString()))}t[n]=s}else t[n]=a;break;default:t[n]=a}}return t};t.createSearchRoot=function(e){var t=new i.default(e.key);t.type=r.default.Folder;t.queryType=t.displayType=e.queryType;t.name=t.displayName=e.name;t.isRootFolder=!0;e.isPlaceholder||(t.isPlaceholder=!1);"number"==typeof e.childCount&&(t.folder={childCount:e.childCount});return t};t.getItemStatistics=function(e){return{views:e.ViewsLifeTime||0,viewsUnique:e.ViewsLifeTimeUniqueUsers||0,viewsLast2Weeks:e.ViewsRecent||0,viewsLast2WeeksUnique:e.ViewsRecentUniqueUsers||0,viewsLastMonth:e.ViewsLastMonths1||0,viewsLastMonthUnique:e.ViewsLastMonths1Unique||0,viewsLastWeek:(e.ViewsLast7Days||0)+(e.ViewsLast6Days||0)+(e.ViewsLast5Days||0)+(e.ViewsLast4Days||0)+(e.ViewsLast3Days||0)+(e.ViewsLast2Days||0)+(e.ViewsLast1Days||0),viewsLastWeekUnique:(e.ViewsLast7DaysUniqueUsers||0)+(e.ViewsLast6DaysUniqueUsers||0)+(e.ViewsLast5DaysUniqueUsers||0)+(e.ViewsLast4DaysUniqueUsers||0)+(e.ViewsLast3DaysUniqueUsers||0)+(e.ViewsLast2DaysUniqueUsers||0)+(e.ViewsLast1DaysUniqueUsers||0)}};t.getUserFromOwsString=function(e){var t={title:"",email:"",id:"",sip:""};if(e){var i=e.indexOf("|");t.sip=e.slice(0,i).trim();var r=e.indexOf("|",i+1);t.title=e.slice(i+1,r).trim()}return t}});define("UU",["require","exports","ap","bN","ir","gl","dZ","iq","ba","iJ","eO","aC","dH","bX","eT","by","ex","U1","bA","UZ","UY","bE","b9","cE","hC","UW","UV","cL"],function(e,t,i,r,l,n,a,c,d,s,u,p,m,h,f,g,y,v,o,_,b,x,S,C,P,k,I,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w="MruRecent",E="Last accessed",D=function(o){i.__extends(e,o);function e(e,t){void 0===e&&(e={});var i=o.call(this,e,t)||this;i._itemsStore=t.itemsStore;i._urlDataSource=t.urlDataSource;i._itemResultProcessor=t.itemResultProcessor;i._itemTaskObserver=new t.itemTaskObserverType;i._platform=t.platform;i._engagement=t.engagement;i._loadTime=t.loadTime;i._useMobileList=t.useMobileList;i._disableCalloutInvoker=t.disableCalloutInvoker;i._authTokenFetcher=t.authTokenFetcher;var r=t.dataRequestorType;i._dataRequestor=new r({qosName:"MRURecentListDataSource"});i._children=[];return i}e.prototype.getItem=function(e){var t=this,i=new x.default;this._authTokenFetcher.ensureAuthToken(e.parentKey).then(function(){return t._getItem(e)}).then(function(e){i.complete(e)},function(e){i.error(e)}).done();return i.getPromise()};e.prototype._getItem=function(t){var i=this,r=t.updateGrouping;r?S.default.mark("EUPL.MRURecentList.UpdateItemGroupings.Start"):S.default.mark("EUPL.MRURecentList.GetItems.Start");return(r?p.default.resolve():this.resources.consumeAsync(k.resourceKey).then(function(e){return e.getTokenForMru()}).then(function(e){S.default.mark("EUPL.MRURecentList.GetItems.GotAuthToken");return i._dataRequestor.getData({url:i._getRequestUrl(),method:"GET",qosName:"GetMRU",needsRequestDigest:!1,additionalHeaders:{Authorization:"Bearer "+e}})}).then(function(e){S.default.mark("EUPL.MRURecentList.GetItems.ReceivedMruItems");i._processMruResponseIntoChildren(t,e);S.default.mark("EUPL.MRURecentList.GetItems.ProcessedItems")})).then(function(){var e=i._getItemResultFromChildren(t.isAscending);i._loadTime.peek()||i._loadTime(new Date(Date.now()));r?S.default.mark("EUPL.MRURecentList.UpdateItemGroupings.End"):S.default.mark("EUPL.MRURecentList.GetItems.End");return e},function(e){r?S.default.mark("EUPL.MRURecentList.UpdateItemGroupings.Error.End"):S.default.mark("EUPL.MRURecentList.GetItems.Error.End")})};e.prototype._getRequestUrl=function(){return"https://ocws.officeapps.live.com/ocs/v2/recent?cap=ClassicMru&rs="+T.default.language};e.prototype._processMruResponseIntoChildren=function(e,t){var i=this;S.default.mark("EUPL.MRURecentList.ProcessResponse.Start");var r=e.queryType,o=void 0===r?m.default.Recent:r,n=e.parentKey,a=this._urlDataSource.getRootItemKey(o),s=c.strings.Recent;this._itemTaskObserver.update([new f.Task(a).succeed({item:{key:n,type:u.default.Folder,queryType:o,displayType:o,name:s,displayName:s,isPlaceholder:!1}})]);var l=t.documents&&t.documents.items||[],d=l.length;this._engagement.logData({name:w+".TotalItems",extraData:{count:d}});this._children=l.map(function(e){return i._itemResultProcessor.processItemResult(e,o,i._itemTaskObserver)});this._itemTaskObserver.flush();S.default.mark("EUPL.MRURecentList.ProcessResponse.End")};e.prototype._getItemResultFromChildren=function(e){S.default.mark("EUPL.MRURecentList.GetResult.Start");var t=this._sortItems(),i=t.pinnedItems,r=t.unpinnedItems,o=this._urlDataSource.getRootItemKey(m.default.Recent),n=i.concat(r),a=this._getGroupings(e,i.map(function(e){return e.item}),r.map(function(e){return e.item}));S.default.mark("EUPL.MRURecentList.GetResult.End");return{item:{key:o},children:n,totalChildren:n.length,groupings:[a],schema:this._getSchema()}};e.prototype._sortItems=function(){var t=this,e=this._children.map(function(e){return{key:e.key,item:t._itemsStore.getItem(e.key).peek()}}),i=e.filter(function(e){return e.item.mruState.isPinnedToMru});i.sort(function(e,t){var i=e.item.name&&e.item.name.toUpperCase(),r=t.item.name&&t.item.name.toUpperCase();return i?r?i<r?-1:r<i?1:0:1:-1});var r=e.filter(function(e){return!e.item.mruState.isPinnedToMru});this._engagement.logData({name:w+".PinnedItems",extraData:{count:i.length}});this._engagement.logData({name:w+".UnpinnedItems",extraData:{count:r.length}});return{pinnedItems:i,unpinnedItems:r}};e.prototype._getSchema=function(){var e=l.default.fillColumnDefinitionDefaults([{internalName:"IsContainer",key:"type",name:"",isIcon:!0,width:32,fieldType:y.ColumnFieldType.FileIcon},{internalName:"FileLeafRef",key:"name",name:c.strings.NameColumnName,isRowHeader:!0,width:445,fieldType:y.ColumnFieldType.MruName,hasListItemMenu:!this._disableCalloutInvoker},{internalName:"dateAccessed",key:"dateAccessed",name:c.strings.LastAccessedColumnName,width:200,fieldType:y.ColumnFieldType.DateTime}],{isCollapsible:!1},{sortField:E,isAscending:!1}),t=e[0],i=e[1],r=e[2],o=[t,i,r];if(!d.isFeatureEnabled(d.EnableUpdatedFilesListView)||!d.isFeatureEnabled(d.FlipOnNewGridAndListExperiment)){if(!this._disableCalloutInvoker){var n=l.default.fillColumnDefinitionDefaults([{internalName:"_calloutInvoker",key:"_calloutInvoker",name:"",width:18,fieldType:y.ColumnFieldType.DotDotDot}])[0];o.splice(2,0,n)}var a=l.default.fillColumnDefinitionDefaults([{internalName:"Pin",key:"mruState",name:"",width:20,getValue:function(e){return e.mruState.isPinnedToMru},fieldType:y.ColumnFieldType.PinCommand}])[0];o.splice(2,0,a);var s=l.default.fillColumnDefinitionDefaults([{internalName:"_shareHeroCommand",key:"_shareHeroCommand",name:"",width:18,fieldType:y.ColumnFieldType.ShareCommand}])[0];o.splice(2,0,s)}return this._platform.isMobile&&this._useMobileList?l.default.getCustomColumns(t,[[i],[r]],[i,r]):o};e.prototype._getGroupings=function(e,t,i){var r=(new(this.managed(_.default))).getOrderInfo({items:i,groupBy:E,sortField:E,isAscending:e});r.groupings[0].itemGroups.forEach(function(e){e.startIndex+=t.length});var o,n={name:"",isAllCollapsed:this.createObservable(!1),itemGroups:[]};0<t.length&&n.itemGroups.push({groupingId:"Pinned",name:I.strings.spotlightAriaLabel,count:t.length,startIndex:0,level:0,state:this.createObservable({isCollapsed:!1})});(o=n.itemGroups).push.apply(o,r.groupings[0].itemGroups);return n};e.dependencies=i.__assign({},r.default.dependencies,{itemsStore:s.resourceKey,urlDataSource:a.url,itemResultProcessor:v.resourceKey,itemTaskObserverType:f.resourceKey,dataRequestorType:n.typeResourceKey,platform:g.platformDetection,authTokenFetcher:b.resourceKey,engagement:C.resourceKey,loadTime:P.loadTimeResourceKey,disableCalloutInvoker:h.disableCalloutInvoker.optional,useMobileList:h.useMobileList.optional});return e}(r.default);t.default=D;t.resourceKey=o.createResolvedResourceKey(e("module").id,D)});define("U1",["require","exports","ap","bN","ib","eT","eO","gK","dq","cY","dk","aZ","fO","dZ","bA","hs","ba"],function(e,t,i,r,v,_,b,x,S,C,P,k,o,a,n,I,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(n){i.__extends(e,n);function e(e,t){var i=n.call(this,e,t)||this,r=t.urlDataSource,o=t.itemUrlHelper;i._urlDataSource=r;i._itemUrlHelper=o;return i}e.prototype.processItemResult=function(e,t,i){var r=this._itemUrlHelper.getUrlParts({path:x.canonicalizeDecodedUrl(e.url)}),o=this._urlDataSource.getKey(((f={}).id=r.serverRelativeItemUrl,f.listurl=r.normalizedListUrl,f.u="mru",f)),n={key:o};n.name=e.title;n.displayName=e.title;n.isPlaceholder=!1;n.mruState={isPinnedToMru:e.is_pinned,mruId:e.mru_id&&k.default.normalizeLower(e.mru_id)};var a=e.meta_data;if(a){a["@MRU.ItemId"]&&a["@MRU.DriveId"]&&(n.graph={itemId:a["@MRU.ItemId"],driveId:a["@MRU.DriveId"]});var s=a["@MRU.CreatedDate"];if(s){var l=new Date(s);n.dateCreatedTime=l;n.dateCreated=I.getFriendlyDateTimeStringPast(l);Date.now()-l.getTime()<864e5&&(n.lifeCycleStatus=((g={}).isNew=!0,g))}}n.displayPath={segments:e.display_path};var d="OneNote"===e.app?"one":e.extension,c=d&&"one"===d?b.default.OneNote:b.default.File;n.dateAccessed=I.getFriendlyDateTimeStringPast(new Date(e.time_stamp));n.dateAccessedTime=new Date(e.time_stamp);n.queryType=t;n.openUrl=e.url+"?web=1";n.size=e.file_size;var u=e.url.lastIndexOf("/"),p=-1!==u?e.url.substr(0,u):e.url;n.parentLink=p;var m,h,f,g,y=d?"."+d:"";n.extension=y;if(S.getItemTypeFromExtension(d)===b.default.Media){c=b.default.Media;"photo"===S.getIconNameFromExtension(d)&&(m={width:0,height:0})}n.photo=_.Graft.optional(m);n.type=c;n.iconName=S.getIconNameFromItem({extension:y,type:c});n.permissions=v.default.or([C.PermissionMask.openItems,C.PermissionMask.managePermissions]);n.itemFromServer=e;y&&(h=P.OfficeIconFileTypeMap[d]);n.appMap=_.Graft.optional(h);n.properties={path:e.url,listId:e.meta_data&&e.meta_data["@MRU.SPListId"]&&k.default.normalizeLower(e.meta_data["@MRU.SPListId"]),uniqueId:e.meta_data&&e.meta_data["@MRU.SPListItemUniqueId"]&&k.default.normalizeLower(e.meta_data["@MRU.SPListItemUniqueId"])};i.update([new _.Task(o).succeed({item:n})]);T.isFeatureEnabled(T.EnableNewRecentUXTrendingSignal);return{key:o}};e.dependencies=i.__assign({},r.default.dependencies,{urlDataSource:a.url,itemUrlHelper:o.resourceKey});return e}(r.default);t.default=s;t.resourceKey=n.createResolvedResourceKey(e("module").id,s)});define("UZ",["require","exports","ap","bN","V","ht","U0"],function(e,t,i,r,a,s,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c="LinkFilename",u="DateShared",p="Last accessed",m="SharedBy",o="sharedByUser",h="FileActivity",n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getOrderInfo=function(e){var t,i,r,o=e.items,n=function(e,t){if(t===u){var i=new Date;return g({items:e,getLabel:function(e){return y(e.dateSharedTime,i)},getSortValue:function(e){return e.dateSharedTime?e.dateSharedTime.getTime():void 0}})}if(t===p){var r=new Date;return g({items:e,getLabel:function(e){return y(e.dateAccessedTime,r)},getSortValue:function(e){return e.dateAccessedTime?e.dateAccessedTime.getTime():void 0}})}if(t===m)return g({items:e,getLabel:function(e){return f(e,d.strings.unknown)},getSortValue:function(e){return f(e,void 0)}})}(o,e.groupBy),a=e.sortField||u;if(n){var s=e.groupBy===e.sortField?e.isAscending:e.groupBy!==u;r=-1*(i=s?-1:1),n.sort(function(e,t){return e.sortValue===t.sortValue?0:void 0===e.sortValue?1:void 0===t.sortValue?-1:e.sortValue>t.sortValue?r:i});!function(e,t,i){for(var r=0,o=e;r<o.length;r++){var n=o[r];1<n.items.length&&(n.items=v(n.items,t,i))}}(n,a,e.isAscending);var l=this._generateGroupings(n);o=l.items;t=l.groupings}else o=v(o,a,e.isAscending);return{items:o,groupings:t}};t.prototype._generateGroupings=function(e){for(var t=[],i=[],r=0,o=0,n=e;o<n.length;o++){var a=n[o];i.push(this._getGrouping(a.label,r,a.items.length));r+=a.items.length;t.push.apply(t,a.items)}return{items:t,groupings:[{name:"",isAllCollapsed:this.createObservable(!0),itemGroups:i}]}};t.prototype._getGrouping=function(e,t,i){return{groupingId:e,count:i,startIndex:t,isDropEnabled:!1,level:0,name:e,hideFooter:!0,state:this.createObservable({isCollapsed:!1})}};return t}(r.default);t.default=n;function f(e,t){var i=e.properties[o];return i&&i.title||t}function g(e){for(var t=[],i={},r=0,o=e.items;r<o.length;r++){var n=o[r],a=e.getLabel(n),s=i[a];if(!s){s={label:a,sortValue:e.getSortValue?e.getSortValue(n):a,items:[]};t.push(s);i[a]=s}s.items.push(n)}return t}var l={0:s.strings.january,1:s.strings.february,2:s.strings.march,3:s.strings.april,4:s.strings.may,5:s.strings.june,6:s.strings.july,7:s.strings.august,8:s.strings.september,9:s.strings.october,10:s.strings.november,11:s.strings.december};function y(e,t){if(!e)return d.strings.older;var i=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(i<e)return s.strings.today;i.setDate(i.getDate()-1);if(i<e)return s.strings.yesterday;i.setDate(t.getDate()-t.getDay());if(i<e)return d.strings.thisWeek;i.setDate(i.getDate()-7);if(i<e)return d.strings.lastWeek;var r=new Date(t.getFullYear(),t.getMonth(),1);if(new Date(t.getFullYear(),t.getMonth()-1,1)<=e&&e<r)return d.strings.lastMonth;i.setDate(i.getDate()-7);if(i<e)return d.strings.twoWeeksAgo;i.setDate(i.getDate()-7);if(i<e)return d.strings.threeWeeksAgo;if(r<e)return d.strings.thisMonth;var o=t.getFullYear()===e.getFullYear(),n=l[e.getMonth()];return o?n:a.format(s.strings.MonthAndYear,n,e.getFullYear())}function v(e,o,t){var n=t?-1:1,a=-1*n,s=function(e,t){return e.displayName===t.displayName?0:e.displayName>t.displayName?a:n},l=function(e,t,i){if(e[i]===t[i])return s(e,t);var r=e[i]?e[i].getTime():0;return(t[i]?t[i].getTime():0)<r?a:n};return e.slice().sort(function(e,t){if(o===c)return s(e,t);if(o===u)return l(e,t,"dateSharedTime");if(o===h)return l(e,t,"dateModifiedTime");if(o===m){var i=f(e,""),r=f(t,"");return i===r?s(e,t):i&&r?r<i?a:n:i?-1:1}})}});define("UY",["require","exports","ap","aC","aI","h4","bN","bA","bd","h8","eT","iE","dZ","fO"],function(e,t,i,u,p,m,o,r,h,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e)||this;i._listItemResultProcessor=t.listItemResultProcessor;i._itemTaskObserverType=t.itemTaskObserverType;i.itemUrlHelper=t.itemUrlHelper;i._pageContext=t.pageContext;i._microServiceDataSource=t.microServiceDataSource;return i}e.prototype.ensureAuthToken=function(e){var t=this;return this._microServiceDataSource.hasAuthData()?u.default.wrap(void 0):this._pageContext.isSPO?this.getAuthToken(e,this._pageContext,this.itemUrlHelper).then(function(e){if(!e.ListSchema)return u.default.wrapError("The list response did not contain a list schema value.");t._microServiceDataSource.setBaseInfo({data:e.ListSchema,allowCookies:!1})}):u.default.resolve()};e.prototype.getAuthToken=function(i,e,t){var r=this;if(!e.isSPO)return u.default.reject(new Error("getAuthToken is not supported OnPrem"));var o=new m.SPListItemRetriever({pageContext:e}),n=t.getItemUrlParts(i),a=t.getUrlParts({path:n.serverRelativeListUrl,listUrl:n.fullListUrl}),s=h.getViewXml({pageSize:1}),l={parentKey:i,postDataContext:{viewXml:s,needsSchema:!0,isListDataRenderOptionChangeFeatureEnabled:!0}},d={urlParts:a},c={qosEvent:new p.Qos({name:"GetSingleItem"}),qosName:"GetData"};return o.getItem(l,d,c).then(function(e){var t=new r._itemTaskObserverType;r._listItemResultProcessor.processResponse({response:e,requestKey:i,observer:t});t.flush();return e})};e.dependencies=i.__assign({},o.default.dependencies,{listItemResultProcessor:n.resourceKey,itemTaskObserverType:a.resourceKey,itemUrlHelper:d.resourceKey,pageContext:s.pageContext,microServiceDataSource:l.microService});return e}(o.default);t.default=c;t.resourceKey=r.createResolvedResourceKey(e("module").id,c)});define("UW",["require","exports","ap","UX","bN","bA"],function(e,t,i,o,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e)||this;i._dataSource=t.mruRecentDataSource;return i}e.prototype.changePinStatus=function(e){return this._dataSource.changePinStatus(e)};e.prototype.getTokenForMru=function(){return this._dataSource.getTokenForMru()};e.dependencies=i.__assign({},n.default.dependencies,{mruRecentDataSource:o.resourceKey});return e}(n.default);t.default=a;t.resourceKey=r.createResolvedResourceKey(e("module").id,a)});define("UX",["require","exports","ap","bN","gl","bA","dl","cE","fZ"],function(e,t,i,r,n,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d="https://ocws.officeapps.live.com/ocs",c=function(o){i.__extends(e,o);function e(e,t){void 0===e&&(e={});var i=o.call(this,e)||this,r=t.dataRequestorType;i._engagement=t.engagement;i._apiUrlHelper=t.apiUrlHelper;i._dataRequestor=new r({qosName:"MruRecentDataSource"});return i}e.prototype.changePinStatus=function(e){var t=this,i=e.mruState.isPinnedToMru,r={category:"Document",type:"ClassicMru",app:a.getApp(e),is_pinned:!i,mru_id:e.mruState.mruId,url:e.properties.path};this._engagement.logData({name:"MruRecent"+(i?".UnpinItem":".PinItem"),isIntentional:!0});return this.getTokenForMru().then(function(e){return t._dataRequestor.getData({url:d+"/v2/recent",method:"POST",qosName:i?"SetMRUUnpinned":"SetMRUPinned",needsRequestDigest:!1,additionalHeaders:{Authorization:"Bearer "+e},additionalPostData:JSON.stringify(r)})})};e.prototype.getTokenForMru=function(){var e=this._apiUrlHelper.build().method("SP.OAuth.Token/Acquire").toString();return this._dataRequestor.getData({url:e,method:"POST",qosName:"AcquireToken",additionalHeaders:{Accept:"application/json;odata.metadata=minimal","Odata-Version":"4.0"},additionalPostData:JSON.stringify({resource:"https://officeapps.live.com"})}).then(function(e){return e.access_token})};e.dependencies=i.__assign({},r.default.dependencies,{dataRequestorType:n.typeResourceKey,apiUrlHelper:l.resourceKey,engagement:s.resourceKey});return e}(r.default);t.default=c;t.resourceKey=o.createResolvedResourceKey(e("module").id,c)});define("U2",["require","exports","ap","bN","ib","aC","dq","ex","iE","aZ","bb","gl","fZ","fO","dJ","iJ","eV","eO","eA","gO","dZ","iq","cY","dH","ir","bX","by","Iq","U3","cE","bA"],function(e,t,i,o,l,s,d,S,n,c,u,a,p,r,m,h,f,g,y,v,_,C,b,x,P,k,I,T,w,E,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A="dateDeleted",M="DeletedByName",F="CreatorName";t.recycleBinDataSourceCommonResourceKey=new D.ResourceKey({name:e("module").id+".recycleBinDataSourceCommon",factory:{dependencies:{pageContext:n.pageContext,itemUrlHelper:r.resourceKey,apiUrlHelper:p.resourceKey},create:function(e){return{instance:new w.RecycleBinDataSource({pageContext:e.pageContext,itemUrlHelper:e.itemUrlHelper,apiUrlHelper:e.apiUrlHelper})}}}});var L=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._urlDataSource=t.urlDataSource;i._itemsStore=t.itemsStore;i._pageContext=t.pageContext;i._itemParentHelper=t.itemParentHelper;i._apiUrlHelper=t.apiUrlHelper;i._recycleBinDataSourceCommon=t.recycleBinDataSourceCommon;i._engagement=t.engagement;i._dataRequestor=new t.dataRequestorType({qosName:"RecycleBinDataSource"});return i}e.prototype.getItem=function(t){var i=this;return this._dataRequestor.getData({url:this._getItemRequestUri(t),qosName:"GetItems"}).then(function(e){return i._processData(t,e)})};e.prototype.deleteItems=function(e){if(0===e.items.length)return null;var t=e.items[0],i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list")),r=i?i.list.id:t&&t.properties&&t.properties.listId,o={parentKey:e.parentKey,items:e.items.map(function(e){return v.convertToISPListItem(e)}),deletionType:e.deletionType,allowUndo:e.allowUndo,overrideLock:e.overrideLock,emptyRecycleBin:e.emptyRecycleBin,listId:r};return this._recycleBinDataSourceCommon.deleteItems(o,this._engagement)};e.prototype.restoreItems=function(e){var i=this;if(0===e.items.length)return null;if(1===e.items.length){var t=e.items[0];return this._dataRequestor.getData({url:this._getRestoreSingleItemUrl(t),qosName:"RestoreItemsSingle",method:"POST",additionalHeaders:{"X-HTTP-Method":"RESTORE"}}).then(function(e){return[t.id]}).then(function(e){return s.default.wrapError({data:T.DataBatchOperationHelper.processErrorResponse(e,t.id)})})}return this._performBatchRequest({context:e,getBatchContent:function(e,t){return i._getBatchRestoreContent(e,t)},qosName:"RestoreItemsMultiple"})};e.prototype.restoreAll=function(e){return null};e.prototype._getItemRequestUri=function(e){var t=e.parentKey,i=e.requestToken,r=e.pageSize,o=void 0===r?200:r,n=e.isAscending,a={rowLimit:""+(o+1),isAscending:void 0!==n&&n,itemState:this._urlDataSource.isCurrentQuery(x.default.SecondStageRecycleBin,this._urlDataSource.getKeyParams(t))?2:1,orderby:this._getRecycleBinOrderBy(e)};i&&(a.pagingInfo=i);var s=this._apiUrlHelper.build().segment(this._pageContext.isSiteAdmin?"site":"web");if(this._pageContext.isSiteAdmin)s=s.segment("getrecyclebinitems").parameters(a);else{a.ShowOnlyMyItems=!1;s=s.methodWithAliases("GetRecycleBinItemsByQueryInfo",a)}return s.toString()};e.prototype._getRecycleBinItemApiUrl=function(e){var t=e.properties.uniqueId,i=e.recycleBinProperties.itemState,r=this.resources.consume(k.viewParams).peek(),o=this._getRecycleBinOrderByCore(r.sortField);0===o&&(o=3);var n=this._getOrderByValue(o,e.itemFromServer),a="true"===r.isAscending,s=u.default.isActivated("BC8503A4-C788-43B2-96FA-431AE86AABD5","10/14/2017","Add more Recycle Bin param."),l=this._apiUrlHelper.build().segment(this._pageContext.isSiteAdmin?"site":"web");return l=this._pageContext.isSiteAdmin?l.method("RecycleBin",{guid:t}):s?l.methodWithAliases("GetRecycleBinItemsByQueryInfo",{itemState:i,ShowOnlyMyItems:!1,rowLimit:1,pagingInfo:m.serializeQuery({id:t,title:e.name})}).method("GetById",{guid:t}):l.methodWithAliases("GetRecycleBinItemsByQueryInfo",{itemState:i,ShowOnlyMyItems:!1,rowLimit:1,orderby:o,isAscending:a,pagingInfo:m.serializeQuery({id:t,title:e.name,searchValue:n})}).method("GetById",{guid:t})};e.prototype._processData=function(e,t){var i,r=this,o=t.d.results,n=void 0===o?[]:o,a=e.parentKey,s=e.sortField,l=void 0===s?A:s,d=e.pageSize,c=void 0===d?200:d,u=e.isAscending,p=void 0!==u&&u,m=this._urlDataSource.getQueryType(this._urlDataSource.getKeyParams(a));i=n.length===c+1?this._getNextPageToken(e,n[c]):"";var h=n.slice(0,c),f=this._getRecycleBinRootItem(e,h.length),g=P.default.fillColumnDefinitionDefaults([{internalName:"recycleBinItemType",key:"type",name:"",minWidth:P.default.getIconColumnMinWidth(this.resources),isIcon:!0,width:P.default.getIconColumnWidth(this.resources),sortable:!1,fieldType:S.ColumnFieldType.FileIcon},{internalName:"name",key:"name",name:C.strings.NameColumnName,isRowHeader:!0,width:220,fieldType:S.ColumnFieldType.Name},{internalName:A,key:A,name:C.strings.DeletedDateColumnName,width:150,fieldType:S.ColumnFieldType.DateTime},{internalName:M,key:"editorName",name:C.strings.DeletedByColumnName,width:100,fieldType:S.ColumnFieldType.User},{internalName:F,key:"creatorName",name:C.strings.CreatedByColumnName,width:100,fieldType:S.ColumnFieldType.User},{internalName:"directory",key:"directory",index:5,name:C.strings.LocationColumnName,width:300,sortable:!1,fieldType:S.ColumnFieldType.Text}],{sortable:!0,isCollapsible:!1},{sortField:l,isAscending:p}),y=g[0],v=g[1],_=g[2],b=[y,v,_,g[3],g[4],g[5]],x=this.resources.consume(I.platformDetection).isMobile&&this.resources.consume(k.useMobileList.optional);return{item:f,children:h.map(function(e){return r._getRecycleBinItem(m,e,f)}),totalChildren:h.length,nextRequestToken:i,schema:x?P.default.getCustomColumns(y,[[v],[_]],[v,_]):b}};e.prototype._getRestoreSingleItemUrl=function(e){return this._getRecycleBinItemApiUrl(e).segments("Restore").toString()};e.prototype._getBatchRestoreContent=function(e,t){var i=this,r=e.items,o=T.DataBatchOperationHelper.defaultBatchRequestPostData,n=r.map(function(e){return i._getRestoreSingleItemUrl(e)});return T.DataBatchOperationHelper.getBatchContentExtended(t,n,"POST",o)};e.prototype._convertRecycleBinItemTypeToItemType=function(e){var t;switch(e){case 1:t=g.default.File;break;case 5:case 6:t=g.default.Folder;break;case 11:t=g.default.App;break;case 10:t=g.default.Subsite;break;case 0:t=g.default.Error;break;default:t=g.default.File}return t};e.prototype._getRecycleBinOrderBy=function(e){var t=e.sortField,i=void 0===t?A:t;return this._getRecycleBinOrderByCore(i)};e.prototype._getRecycleBinOrderByCore=function(e){return e===A?3:e===M?5:e===F?2:"size"===e?4:0};e.prototype._getRecycleBinRootItem=function(e,t){var i=e.parentKey,r=this._urlDataSource.getKeyParams(i),o=this._urlDataSource.getQueryType(r),n=this._urlDataSource.isCurrentQuery(x.default.SecondStageRecycleBin,r),a=new f.default(i),s=n?C.strings.SecondStageRecycleBin:C.strings.RecycleBin;a.name=s;a.type=g.default.Folder;a.displayName=s;a.childCount=t;a.recycleBinProperties.itemState=n?2:1;a.isPlaceholder=!1;a.folder={childCount:t};a.queryType=o;a.iconName=d.getIconNameFromItem(a);a.permissions=l.default.or([b.PermissionMask.deleteListItems,b.PermissionMask.managePermissions]);this._itemsStore.setItem(a);return a};e.prototype._getRecycleBinItem=function(e,t,i){var r=this._urlDataSource.getKey(((n={}).id=[t.Id,t.DeletedDateLocalFormatted].join("/"),n)),o=new f.default(r);o.id=t.Id;o.ownerName=t.AuthorName;o.creatorName=t.AuthorName;o.size=parseInt(t.Size,10);o.dateDeleted=t.DeletedDateLocalFormatted;o.name=t.Title;o.properties.uniqueId=t.Id;o.recycleBinProperties.creatorEmail=t.AuthorEmail;o.recycleBinProperties.deletedByName=t.DeletedByName;o.recycleBinProperties.deletedByEmail=t.DeletedByEmail;o.recycleBinProperties.directory=t.DirName;o.recycleBinProperties.itemType=t.ItemType;o.recycleBinProperties.itemState=t.ItemState;o.displayName=t.Title;o.type=this._convertRecycleBinItemTypeToItemType(t.ItemType);o.displayType=e;o.isPlaceholder=!1;o.parent=i;o.parentKey=i.key;3===t.ItemType&&(o.listItem={});var n,a=t.LeafName.indexOf(".");o.extension=-1!==a?t.LeafName.substring(a+1):"";o.queryType=e;o.iconName=d.getIconNameFromItem(o);o.permissions=l.default.or([b.PermissionMask.deleteListItems,b.PermissionMask.managePermissions]);o.properties.editorName=[{title:t.DeletedByName,email:t.DeletedByEmail,id:"",sip:""}];o.properties.creatorName=[{title:t.AuthorName,email:t.AuthorEmail}];o.itemFromServer=t;this._itemsStore.setItem(o);return o};e.prototype._getNextPageToken=function(e,t){var i=this._getRecycleBinOrderBy(e);return m.serializeQuery({id:t.Id,title:t.Title,searchValue:this._getOrderByValue(i,t)})};e.prototype._getOrderByValue=function(e,t){var i="";switch(e){case 3:"Z"===(i=t.DeletedDate)[i.length-1]&&(i=i.slice(0,-1));break;case 5:i=t.DeletedByName;break;case 2:i=t.AuthorName;break;case 4:i=t.Size}return i};e.prototype._performBatchRequest=function(e){var t=e.context,i=e.getBatchContent,r=e.qosName,o=c.default.generate(),n="multipart/mixed; boundary=batch_"+o,a=t.items.map(function(e){return v.convertToISPListItem(e)});return this._dataRequestor.getData({url:T.DataBatchOperationHelper.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),qosName:r,parseResponse:function(e){return T.DataBatchOperationHelper.processBatchResponse(e,a)},additionalPostData:i(t,o),method:"POST",contentType:n}).then(function(e){return e.hasError?s.default.wrapError({data:e}):t.items.map(function(e){return e.id})})};e.dependencies=i.__assign({},o.default.dependencies,{urlDataSource:_.url,itemsStore:h.resourceKey,pageContext:n.pageContext,itemParentHelper:y.resourceKey,apiUrlHelper:p.resourceKey,dataRequestorType:a.typeResourceKey,recycleBinDataSourceCommon:t.recycleBinDataSourceCommonResourceKey,engagement:E.resourceKey});return e}(o.default);t.default=L;t.resourceKey=D.createResolvedResourceKey(e("module").id,L)});define("Iq",["require","exports","aM","aZ"],function(e,t,i,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.getBatchOperationUrl=function(e){return i.default.escapeUrlForCallback(e)+"/_api/$batch"};e.processErrorResponse=function(e,t){var i={id:t};if((e=e.error?e.error:e)&&e.code){var r=e.code?e.code.split(","):e.error.code.split(","),o=Number(r[0]),n=e.message.value;i.error={code:o,message:n}}return{items:[i]}};e.getBatchResponseText=function(e){var t,i,r,o=[];0<e.split("\n").length&&(t=e.split("\n")[0]);if(t){i=(e=e.replace(t.trim()+"--","")).split(t);for(var n=1;n<i.length;n++)2<(r=i[n].split("\n\r")).length&&o.push(r[2])}return o};e.processBatchResponse=function(e,t,i){var r,o,n,a,s=[],l=!1;0<e.split("\n").length&&(r=e.split("\n")[0]);if(r){o=(e=e.replace(r.trim()+"--","")).split(r);for(var d=1;d<o.length;d++)if(2<(n=o[d].split("\n\r")).length){try{a=JSON.parse(n[2])}catch(e){a=n[2]}var c=t?{id:t[d-1].id,newId:i?i+"/"+t[d-1].name:null}:{};if((a=a.error?a.error:a)&&a.code){var u=a.code?a.code.split(","):a.error.code.split(","),p=Number(u[0]),m=a.message.value;c.error={code:p,message:m};l=!0}s.push(c)}}return{items:s,hasError:l}};e.getBatchContent=function(e,t,i,r){for(var o=[],n=0;n<t.length;n++){for(var a=t[n],s=p.default.generate(),l=[],d=0;d<a.length;d++){var c=a[d];l.push("--changeset_"+s);l.push("Content-Type: application/http");l.push("Content-Transfer-Encoding: binary");l.push("");l.push(i+" "+c+" HTTP/1.1");l.push(r);l.push("")}l.push("--changeset_"+s+"--");var u=l.join("\r\n");o.push("--batch_"+e);o.push('Content-Type: multipart/mixed; boundary="changeset_'+s+'"');o.push("Content-Length: "+u.length);o.push("Content-Transfer-Encoding: binary");o.push("");o.push(u);o.push("")}o.push("--batch_"+e+"--");return o.join("\r\n")};e.getBatchContentExtended=function(e,t,i,r,o,n){var a=p.default.generate(),s=[];o&&o.length!==t.length&&(o=null);for(var l=0;l<t.length;l++){var d=t[l];s.push("--changeset_"+a);s.push("Content-Type: application/http");s.push("Content-Transfer-Encoding: binary");s.push("");s.push(i+" "+d+" HTTP/1.1");s.push(r);n&&s.push(n);if(o){s.push("");s.push(o[l])}s.push("")}s.push("--changeset_"+a+"--");var c=s.join("\r\n");(s=[]).push("--batch_"+e);s.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');s.push("Content-Length: "+c.length);s.push("Content-Transfer-Encoding: binary");s.push("");s.push(c);s.push("");s.push("--batch_"+e+"--");return s.join("\r\n")};e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose";e.defaultBatchAcceptData="accept: application/json;odata=verbose";return e}();t.DataBatchOperationHelper=r;t.default=r});define("U3",["require","exports","ap","ef","aC","bl","bj","U4","dp","Iq","aZ","dK","bf","ig"],function(e,t,r,i,s,o,n,l,d,c,u,a,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e.pageContext)||this;t._itemUrlHelper=e.itemUrlHelper||new o.ItemUrlHelper({},{pageContext:e.pageContext});t._apiUrlHelper=e.apiUrlHelper||new n.ApiUrlHelper({},{pageContext:e.pageContext,itemUrlHelper:t._itemUrlHelper});return t}e.prototype.deleteItems=function(e,t){var i=this;if(0===e.items.length)return s.default.resolve([]);null===e.deletionType&&(e.deletionType=l.default.Recycle);if(t){var r=e.items.filter(function(e){return m.default.isShortcutItem(e)}).length;0<r&&t.logData({name:"ShortcutLink.RecycleExecuteAggregate",extraData:{count:r}})}if(e.emptyRecycleBin)return this.getData(function(){return i._getEmptyRecycleBinUrl(e.items[0])},void 0,"EmptyRecycleBin",void 0,"POST",e.deletionType===l.default.PermanantDelete?{"X-HTTP-Method":"DELETE"}:null).then(function(e){return[]});if(1===e.items.length){var o=e.items[0];return this.getData(function(){return i._getDeleteSingleItemUrl(o,e.deletionType,e.listId)},void 0,"DeleteItemsSingle",void 0,"POST",e.deletionType===l.default.PermanantDelete?{"X-HTTP-Method":"DELETE"}:null).then(function(e){return[o.id]},function(e){return s.default.reject({data:c.DataBatchOperationHelper.processErrorResponse(e,o.id)})})}return this._performBatchRequest({context:e,getBatchContent:function(e,t){return i._getBatchDeleteContent(e,t)},qosName:"DeleteItemsMultiple"})};e.prototype._getRecycleBinItemApiUrl=function(e){var t=e.properties.uniqueId,i=e.recycleBinProperties.itemState,r=this._apiUrlHelper.build().segment(this._pageContext.isSiteAdmin?"site":"web");return r=this._pageContext.isSiteAdmin?r.method("RecycleBin",{guid:t}):r.methodWithAliases("GetRecycleBinItemsByQueryInfo",{itemState:i,ShowOnlyMyItems:!1,rowLimit:1,pagingInfo:a.serializeQuery({id:t,title:e.name})}).method("GetById",{guid:t})};e.prototype._getEmptyRecycleBinUrl=function(e){return this._apiUrlHelper.build().segment(this._pageContext.isSiteAdmin?"site":"web").segment("RecycleBin").segment(1===e.recycleBinProperties.itemState?"MoveAllToSecondStage":"DeleteAllSecondStageItems").toString()};e.prototype._getDeleteSingleItemUrl=function(e,t,i){var r,o=e.properties.uniqueId;if(e.recycleBinProperties&&e.recycleBinProperties.itemState){var n=e.recycleBinProperties.itemState;r=this._getRecycleBinItemApiUrl(e).segment(1===n?"MoveToSecondStage":"DeleteObject")}else{var a=!p.Killswitch.isActivated("059471BD-3E64-4230-8415-4BFC210E0BFA","10/20/2017","Use Item Delete."),s=this._itemUrlHelper.getItemUrlParts(e.key);r=this._apiUrlHelper.build().webByItemUrl(s);r=e.type===d.default.Folder||"1"===e.properties.FSObjType?o?r.method("GetFolderById",o):r.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:s.serverRelativeItemUrl}):a&&i?r.method("Lists",i).method("GetItemById",e.properties.ID):r.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:s.serverRelativeItemUrl});t===l.default.Recycle&&(r=r.segment("recycle"))}return r.toString()};e.prototype._getBatchDeleteContent=function(t,e){var i=this,r=t.items,o=t.deletionType===l.default.PermanantDelete?"DELETE":"POST",n=t.deletionType===l.default.PermanantDelete?"If-Match: *":c.DataBatchOperationHelper.defaultBatchRequestPostData,a=r.map(function(e){return i._getDeleteSingleItemUrl(e,t.deletionType,t.listId)});return c.DataBatchOperationHelper.getBatchContentExtended(e,a,o,n)};e.prototype._performBatchRequest=function(e){var t=this,i=e.context,r=e.getBatchContent,o=e.qosName,n=u.default.generate(),a="multipart/mixed; boundary=batch_"+n;return this.getData(function(){return c.DataBatchOperationHelper.getBatchOperationUrl(t._pageContext.webAbsoluteUrl)},function(e){return c.DataBatchOperationHelper.processBatchResponse(e,i.items)},o,function(){return r(i,n)},"POST",void 0,a).then(function(e){return e.hasError?s.default.reject({data:e}):i.items.map(function(e){return e.id})})};return e}(i.default);t.RecycleBinDataSource=h;t.default=h});define("U4",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Recycle=2]="Recycle";e[e.PermanantDelete=3]="PermanantDelete";e[e.MoveToSecondStage=4]="MoveToSecondStage"}(i||(i={}));t.default=i});define("U5",["require","exports","ap","bN","dZ","gl","U9","U8","U7","fZ","dH","iq","U6","iE","eT","bA"],function(e,t,l,i,o,n,a,s,d,c,u,p,m,h,f,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(r){l.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._urlDataSource=t.urlDataSource;i._pageContext=t.pageContext;i._apiUrlHelper=t.apiUrlHelper;i._dataRequestor=new t.dataRequestorType({qosName:"SharedItemDataSource"});i._sharedItemResultProcessor=t.sharedItemResultProcessor;i._sharedColumnHelper=t.sharedColumnHelper;i._sharedByMeColumnHelper=t.sharedByMeColumnHelper;i._itemTaskObserverType=t.itemTaskObserverType;return i}e.prototype.getItem=function(o){var n=this,a=this._getSharedQueryType(o),e=this._getSharedQueryParams(o,a),t=e.apiUrl,i=e.qosName,s=e.rootItemTitle;return this._dataRequestor.getData({url:o.requestToken||t.toString(),qosName:i}).then(function(e){var t=new n._itemTaskObserverType,i=n._sharedItemResultProcessor.processResponse({response:e,requestKey:o.parentKey,rootItemTitle:s,observer:t});t.flush();var r=3===a?n._sharedByMeColumnHelper.getSchema(o):n._sharedColumnHelper.getSchema(o);return l.__assign({},i,{schema:r})})};e.prototype._getSharedQueryParams=function(e,t){var i;switch(t){case 2:i={apiUrl:this._getSharedByUserApiUrl(e),qosName:"GetSharedWithPersonDocs",rootItemTitle:p.strings.DocsInCommon};break;case 1:i={apiUrl:this._getSharedWithGroupApiUrl(e),qosName:"GetSharedWithUsDocs",rootItemTitle:m.strings.SharedWithUs};break;case 3:i={apiUrl:this._getSharedByMeApiUrl(e),qosName:"GetSharedByMeDocs",rootItemTitle:p.strings.SharedByMe};break;default:case 0:i={apiUrl:this._getSharedWithMeApiUrl(e),qosName:"GetSharedWithMeDocs",rootItemTitle:p.strings.SharedWithMe}}return i};e.prototype._getSharedQueryType=function(e){var t,i=e.parentKey;switch(this._urlDataSource.getQueryType(this._urlDataSource.getKeyParams(i))){case u.default.DocsInCommon:t=2;break;case u.default.SharedByMe:t=3;break;default:case u.default.SharedWithMe:t=this._pageContext.groupId?1:0}return t};e.prototype._getSharedByMeApiUrl=function(e){return this._apiUrlHelper.build().segment("web/onedriveshareditems").parameter("$top",100)};e.prototype._getSharedWithMeApiUrl=function(e){return this._addSortParams(this._apiUrlHelper.build().segments("me","getsharedwithmedocs").parameter("allowExternal",!0).parameter("RowLimit",500),e)};e.prototype._getSharedByUserApiUrl=function(e){return this._addSortParams(this._apiUrlHelper.build().segments("me","getsharedwithpersondocs").parameter("allowExternal",!0).parameter("RowLimit",500),e)};e.prototype._getSharedWithGroupApiUrl=function(e){return this._addSortParams(this._apiUrlHelper.build().segment("Microsoft.SharePoint.Portal.UserProfiles.DocumentsSharedWithGroup.GetSharedWithGroupDocs").parameter("GroupId",this._pageContext.groupId).parameter("RowLimit",50),e)};e.prototype._addSortParams=function(e,t){var i=t.sortField,r=void 0===i?"Modified":i,o=t.isAscending,n=void 0!==o&&o;r&&(e=e.parameters({SortFieldName:r,IsAscending:n}));return e};e.dependencies=l.__assign({},i.default.dependencies,{urlDataSource:o.url,pageContext:h.pageContext,apiUrlHelper:c.resourceKey,dataRequestorType:n.typeResourceKey,sharedItemResultProcessor:a.resourceKey,sharedColumnHelper:s.resourceKey,sharedByMeColumnHelper:d.resourceKey,itemTaskObserverType:f.resourceKey});return e}(i.default);t.default=g;t.resourceKey=r.createResolvedResourceKey(e("module").id,g)});define("U9",["require","exports","ap","bN","vP","E6","dZ","iJ","eT","bA"],function(e,t,i,o,n,a,s,l,x,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._urlDataSource=t.urlDataSource;i._itemsStore=t.itemsStore;i._itemResultProcessor=t.itemResultProcessor;return i}e.prototype.processResponse=function(e){var t=e.response.d,i=t.results,r=void 0===i?[]:i,o=t.__next,n=e.requestKey,a=e.rootItemTitle,s=e.observer;return this._getSharedItem({items:r,requestKey:n,nextRequestToken:o,rootItemTitle:a,observer:s})};e.prototype._getSharedItem=function(e){var t=e.items,i=e.requestKey,r=e.nextRequestToken,o=e.rootItemTitle,n=e.observer,a=this._urlDataSource.getQueryType(this._urlDataSource.getKeyParams(i)),s=this._createSharedViewRoot(a,o),l=[];if(t)for(var d=0,c=t;d<c.length;d++){var u=c[d],p=this._itemResultProcessor.processItemResult(this._convertItem(u),{queryType:a,requestKey:i,observer:n}),m=void 0,h=void 0;if(u.Editors){var f=u.Editors,g=f&&f.results;m=g&&g[g.length-1]}else u.Editor&&(h=u.Editor);var y=m?m.Title:h?h.name:"",v=m?m.SipAddress:h?h.email:"",_=m||h,b=m?x.Graft.backup(u.Path):x.Graft.backup(u.UrlPath);n.update([new x.Task(p.key).succeed({item:{properties:{editorName:x.Graft.optional(_&&[{title:y,sip:v}])},openUrl:b}})]);l.push({key:p.key})}return{item:s,children:l,nextRequestToken:r,totalChildren:l.length}};e.prototype._createSharedViewRoot=function(e,t){var i=n.createSearchRoot({key:this._urlDataSource.getRootItemKey(e),queryType:e,name:t,isPlaceholder:!1});this._itemsStore.setItem(i);return i};e.prototype._convertItem=function(e){var t="";if(e.Editors&&e.Editors.results&&0<e.Editors.results.length){t=e.Editors.results[e.Editors.results.length-1].Title}return{ID:e.Id,Path:e.UrlPath,Filename:e.FileLeafRef,ServerRedirectedEmbedUrl:e.ServerRedirectedEmbedUrl,SecondaryFileExtension:e.SecondaryFileExtension||e.Extension,FileExtension:e.Extension,FileRef:e.FileRef,ParentLink:e.ParentLink,Size:0,Description:"",CreatedBy:"",Created:"",ModifiedBy:t,LastModifiedTime:e.Modified,IsContainer:e.IsContainer,Title:e.Title,LinkingUrl:e.LinkingUrl,SharedWithDetails:"",SiteID:e.SiteId,SPSiteURL:e.SiteUrl,WebId:e.WebId,UniqueID:e.UniqueId,SPWebUrl:"",Rank:0,DocId:e.DocId,piSearchResultId:"",Edges:null,PictureURL:"",PreferredName:"",PicturePath:"",EditorsCount:null,ServerRedirectedURL:e.LinkingUrl||e.ServerRedirectedUrl||e.FileRef,ListID:e.ListId,ListItemID:e.ListItemId,ProgId:e.ProgId,".spResourceUrl":e.SpResourceUrl,".mediaBaseUrl":e.MediaBaseUrl,".pushChannelBaseUrl":e.PushChannelBaseUrl,".callerStack":e.CallerStack,".correlationId":e.CorrelationId,".pdfConversionUrl":e.PdfConversionUrl,".thumbnailUrl":e.ThumbnailUrl,".videoManifestUrl":e.VideoManifestURl,".officeBundleGenerate":e.OfficeBundleGenerate,".officeBundleGetFragment":e.OfficeBundleGetFragment}};e.dependencies=i.__assign({},o.default.dependencies,{urlDataSource:s.url,itemsStore:l.resourceKey,itemResultProcessor:a.resourceKey});return e}(o.default);t.default=d;t.resourceKey=r.createResolvedResourceKey(e("module").id,d)});define("E6",["require","exports","ap","hs","dZ","il","if","vP","iE","ba","aZ","dq","eO","fO","dk","dH","ij","ie","ej","gA","bi","eT","ia","f4","bA","bb"],function(e,t,K,i,r,a,z,G,o,Q,Y,Z,X,n,J,$,ee,te,ie,re,oe,ne,s,l,d,ae){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){void 0===e&&(e={});this._pageContext=t.pageContext;this._urlDataSource=t.urlDataSource;this._microServiceDataSource=t.microServiceDataSource;this._vroomUrlHelper=t.vroomUrlHelper;this._itemUrlHelper=t.itemUrlHelper;var i=t.GridPreviewHelpers,r=void 0===i?a:i,o=t.mayInferListUrl,n=void 0!==o&&o;this._mayInferListUrl=n;this._gridPreviewHelpersType=r}e.prototype.processItemResult=function(e,t){var i=t.requestKey,r=void 0===i?"":i,o=t.searchInstrumentationUrl,n=t.getThumbnailByUrl,a=void 0!==n&&n,s=t.useRequestKeyForParentKey,l=void 0!==s&&s,d=t.observer,c=t.queryType,u=void 0===c?this._urlDataSource.getQueryType(this._urlDataSource.getKeyParams(r)):c,p=e.ParentLink;p=p&&p.replace("/Forms/All.aspx","");var m=e.Filename,h=e.Path;!ae.default.isActivated("35572f56-19fd-4c90-b888-4e63e3affefd","01/25/2018","Construct Path from ParentLink and Filename in Search")&&p&&0<=h.indexOf("/Forms/DispForm.aspx?ID=")&&m&&(h=p+"/"+m);var f=new oe.default(e.SPSiteURL),g=new oe.default(h),y=""+f.path,v=this._getKey({path:h,uniqueId:e.UniqueID,entryId:e.ID,siteUrl:y}),_={key:v},b=e[".spResourceUrl"];if(b){var x=this._vroomUrlHelper.getUrlParts(b);_.graph={driveId:x.driveId,itemId:x.itemId}}var S,C=this._getFileType(e);if(Q.isFeatureEnabled(Q.DecodeShareWithMeUrls))S=g.segments.slice().reverse()[1];else{S=new ie.default(h).getPathSegments().slice().reverse()[1]}var P=m||e.Title,k=C!==e.FileExtension,I=this._getFileExtension(e);_.extension=I;_.queryType=u;_.displayType=u;var T,w=e.UniqueID&&Y.default.normalizeLower(e.UniqueID),E=e.EditorOWSUSER,D=E&&G.getUserFromOwsString(E);_.properties={uniqueId:ne.Graft.optional(w),ID:e.ListItemID,listId:e.ListID,path:h,editorName:ne.Graft.optional(D&&[D])};Q.isFeatureEnabled(Q.SharedByMe)&&_.queryType===$.default.SharedByMe&&".one"===I&&(_.location=S);if(p&&y&&!k&&!l){var A=""+g.authority+g.segments.slice(0,-1).join("/");T=this._getKey({path:A,siteUrl:y})}else T=r;_.parentKey=T;_.parentLink=p;var M=this._itemUrlHelper.getItemUrlParts(v);_.id=e.FileRef||M.serverRelativeItemUrl;k||(_.location=S);_.size=e.Size;_.caption=e.Description;_.creatorName=e.CreatedBy;e.Created&&(_.dateCreated=this._getDateString(e.Created));_.editorName=D?D.title:e.ModifiedBy;e.LastModifiedTime&&(_.dateModified=this._getDateString(e.LastModifiedTime));var F,L,R=e.Edges&&e.Edges.filter(function(e){return 1036===e.Properties.Action})[0];R&&R.Properties&&(F=R.Properties.BlobContent.ActorCount)&&(_.viewersCount=parseInt(F,10));_.editorsCount=e.EditorsCount;if(e.PictureURL){_.editorProfilePicUrl=e.PictureURL;_.editorProfileUrl=e.PicturePath;_.editorName=e.PreferredName}_.defaultSubText=z.getGridSubTitleTextFromModifiedBy(e.ModifiedBy);_.name=P;_.displayName=P;if((e.IsContainer||z.isFolderContentType(e.ContentTypeId))&&"one"!==C){L=X.default.Folder;_.folder={};h&&0!==h.indexOf(this._pageContext.webAbsoluteUrl)&&(_.openUrl=h)}else{L=Z.getItemTypeFromExtension(C);"audio"===Z.getIconNameFromExtension(I)&&Q.isFeatureEnabled(Q.EnableAudioPlayer)&&(L=X.default.Media);_.openUrl=e.ServerRedirectedURL||e.LinkingUrl||h}var N=this._getPdfConversionFacet(e);N&&(_.pdfConversion=N);Q.isFeatureEnabled(Q.UseWebPdfViewer)&&("pdf"===C||N)&&(L=X.default.Media);var O=this._get3dFacet(e);if(O){_.model3d=O;L=X.default.Media}_.sharingRole=0;var B=e.SharedWithDetails?ee.default.Shared:ee.default.Private;_.sharingType=B;var V,U=te.isDicomFile("."+C);if((U||"ai"===C||"eps"===C||"psd"===C)&&this._microServiceDataSource.getThumbnail({fileExtension:I,item:e,itemKey:v})){U&&(_.photo={width:0,height:0});L=X.default.Media}if("md"===C){var H=this._microServiceDataSource.getHtmlConversionUrl({fileExtension:this._getFileExtension(e),item:e});if(H){L=X.default.Media;_.htmlConversion={url:H}}}if(!ae.default.isActivated("3ab525c6-be7e-4cc0-8afa-df493d9f3bb7","2/22/2018","Treat small .ts files as TypeScript")&&".ts"===I&&e.Size<1<<19){V="text/typescript";L=X.default.File}if(L===X.default.Media){var q=Z.getIconNameFromExtension(C);q===Z.videoFile?_.video={width:0,height:0,fourCC:"H264"}:q===Z.photoFile?this._pageContext.isSPO?_.photo={width:0,height:0}:L=X.default.File:"audio"===q&&Q.isFeatureEnabled(Q.EnableAudioPlayer)&&(_.audio={})}_.iconName=Z.getIconNameFromItem({extension:I,sharingType:B,type:L,textEditorMimeType:V});_.type=L;C&&(_.appMap=J.OfficeIconFileTypeMap[C]);u===$.default.SharedWithMe&&"pdf"===C&&(_.openUrl=h);_.thumbnail=this._getThumbnail(v,e,a);_.urls=K.__assign({},this._getVideoUrl(e),((j={})[re.default.downloadAsZip]=this._microServiceDataSource.getDownloadAsZipUrl(e),j[re.default.itemUrl]=b,j[re.default[re.default.download]]=ne.Graft.optional(e.SPWebUrl?e.SPWebUrl+"/_layouts/15/download.aspx?SourceUrl="+h:void 0),j[re.default[re.default.bingClickInstrumentation]]=ne.Graft.optional(o&&u===$.default.Search?o:void 0),j));_.itemFromServer=e;_.isPlaceholder=!1;var j,W=[new ne.Task(v).succeed({item:_})];T&&W.push(new ne.Task(T).succeed({item:{key:T,type:ne.Graft.backup(X.default.Folder)}}));d.update(W);return{key:v}};e.prototype._getDateString=function(e){var t=i.iso8601DateTimeToJsDate(e);return i.getRelativeDateTimeStringPast(t)};e.prototype._getFileType=function(e){var t=e.SecondaryFileExtension,i=e.ContentTypeId,r=e.ServerRedirectedURL;if(!t){var o="OneNote.Notebook"===e.ProgId,n=z.isFolderContentType(i)&&r&&-1!==r.toLowerCase().indexOf("wopiframe.aspx?");(o||n)&&(t="one")}return t};e.prototype._getKey=function(e){var t,i=e.path,r=e.uniqueId,o=e.entryId,n=e.siteUrl,a=this._itemUrlHelper.getUrlParts({path:i,webUrl:n,mayInferListUrl:this._mayInferListUrl}),s=["search"];void 0!==r&&s.push(r);void 0!==o&&s.push(""+o);return this._urlDataSource.getKey(((t={}).id=a.serverRelativeItemUrl,t.u=s.join("|"),t.listurl=a.normalizedListUrl,t))};e.prototype._getFileExtension=function(e){var t=this._getFileType(e);return t&&"."+t||""};e.prototype._getPdfConversionFacet=function(e){var t=this._microServiceDataSource.getPdfConversionUrl({fileExtension:this._getFileExtension(e),item:e});if(t)return{url:t}};e.prototype._get3dFacet=function(e){var t=this._getFileExtension(e),i=this._microServiceDataSource.getFbxConversionUrl({fileExtension:t,item:e}),r=l.canRenderNative(t);if(i||r)return{canConvertToFbx:!0,canRenderNative:r,fbxConversionUrl:i}};e.prototype._getThumbnail=function(e,t,i){var r=this._microServiceDataSource.getThumbnail({fileExtension:this._getFileExtension(t),item:t,itemKey:e});if(r)return r;var o=t.SecondaryFileExtension;return o&&this._pageContext.isSPO&&te.fileTypeSupportsPreview("."+o.toLowerCase())?this._gridPreviewHelpersType.previewImageUrl(t,t.SPWebUrl||this._pageContext.webAbsoluteUrl,this._pageContext,!!t.Edges||i):void 0};e.prototype._getVideoUrl=function(e){var t,i=this._microServiceDataSource.getVideoUrl({fileExtension:this._getFileExtension(e),item:e});return(t={})[re.default.video]=i,t};e.dependencies={pageContext:o.pageContext,urlDataSource:r.url,microServiceDataSource:r.microService,vroomUrlHelper:s.resourceKey,itemUrlHelper:n.resourceKey};return e}();t.default=c;t.resourceKey=d.createResolvedResourceKey(e("module").id,c)});define("U8",["require","exports","ap","bN","by","iq","ex","ir","bX","ba","bA"],function(e,t,i,o,n,g,y,v,a,_,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._disableCalloutInvoker=t.disableCalloutInvoker;i._platformDetection=t.platformDetection;i._useMobileList=t.useMobileList;return i}e.prototype.getSchema=function(e){var t=e.sortField,i=void 0===t?_.isFeatureEnabled(_.ODBVroomSharedWithMe)?"DateShared":"Modified":t,r=e.groupBy,o=e.isAscending,n=void 0!==o&&o,a=this._disableCalloutInvoker,s=v.default.fillColumnDefinitionDefaults([{internalName:"IsContainer",key:"type",name:"",minWidth:v.default.getIconColumnMinWidth(this.resources),isIcon:!0,width:v.default.getIconColumnWidth(this.resources),sortable:!1,fieldType:y.ColumnFieldType.FileIcon},{internalName:"LinkFilename",key:"name",name:g.strings.NameColumnName,isRowHeader:!0,width:250,fieldType:y.ColumnFieldType.Name,hasListItemMenu:!a},{internalName:"Modified",key:"dateModified",name:g.strings.ModifiedColumnName,width:200,fieldType:y.ColumnFieldType.DateTime},{internalName:"ModifiedBy",key:"editorName",name:g.strings.ModifiedByColumnName,width:200,fieldType:y.ColumnFieldType.User},{internalName:"DateShared",key:"dateShared",name:g.strings.DateSharedColumnName,width:200,fieldType:y.ColumnFieldType.DateTime,groupable:!0},{internalName:"SharedBy",key:"sharedByUser",name:g.strings.SharedByColumnName,width:200,fieldType:y.ColumnFieldType.User,groupable:!0},{internalName:"FileActivity",key:"dateModified",name:g.strings.ActivityColumnName,width:250,fieldType:y.ColumnFieldType.FileActivity}],{sortable:!0,isCollapsible:!1},{sortField:i,isAscending:n,groupBy:r}),l=s[0],d=s[1],c=s[2],u=s[3],p=s[4],m=s[5],h=s[6],f=[l,d];a||f.push({internalName:"_calloutInvoker",key:"_calloutInvoker",name:"",width:18,sortable:!1,fieldType:y.ColumnFieldType.DotDotDot});if(_.isFeatureEnabled(_.ODBVroomSharedWithMe)){f.push(p);f.push(m);f.push(h)}else{f.push(c);f.push(u)}return this._platformDetection.isMobile&&this._useMobileList?v.default.getCustomColumns(l,[[d],[c]],[d,c]):f};e.dependencies=i.__assign({},o.default.dependencies,{disableCalloutInvoker:a.disableCalloutInvoker.optional,platformDetection:n.platformDetection,useMobileList:a.useMobileList.optional});return e}(o.default);t.default=s;t.resourceKey=r.createResolvedResourceKey(e("module").id,s)});define("U7",["require","exports","ap","bN","by","iq","ex","ir","bX","bA"],function(e,t,i,o,n,s,l,d,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._disableCalloutInvoker=t.disableCalloutInvoker;i._platformDetection=t.platformDetection;i._useMobileList=t.useMobileList;return i}e.prototype.getSchema=function(e){var t=d.default.fillColumnDefinitionDefaults([{internalName:"IsContainer",key:"type",name:"",minWidth:d.default.getIconColumnMinWidth(this.resources),isIcon:!0,width:d.default.getIconColumnWidth(this.resources),sortable:!1,fieldType:l.ColumnFieldType.FileIcon},{internalName:"LinkFilename",key:"name",name:s.strings.NameColumnName,isRowHeader:!0,width:250,sortable:!1,fieldType:l.ColumnFieldType.Name},{internalName:"Location",key:"location",name:s.strings.SearchLocationColumnName,isRowHeader:!0,width:250,sortable:!1,fieldType:l.ColumnFieldType.Text},{internalName:"FileActivity",key:"dateModified",name:s.strings.ActivityColumnName,width:250,sortable:!1,fieldType:l.ColumnFieldType.FileActivity}],{sortable:!1,isCollapsible:!1}),i=t[0],r=t[1],o=t[2],n=t[3],a=[i,r,o,n];this._disableCalloutInvoker||a.push({internalName:"_calloutInvoker",key:"_calloutInvoker",name:"",width:18,sortable:!1,fieldType:l.ColumnFieldType.DotDotDot});return this._platformDetection.isMobile&&this._useMobileList?d.default.getCustomColumns(i,[[r],[o],[n]],[r]):a};e.dependencies=i.__assign({},o.default.dependencies,{disableCalloutInvoker:a.disableCalloutInvoker.optional,platformDetection:n.platformDetection,useMobileList:a.useMobileList.optional});return e}(o.default);t.default=c;t.resourceKey=r.createResolvedResourceKey(e("module").id,c)});define("Va",["require","exports","ap","bE","bN","bA","Vb","UZ","eO","iq","dZ","U8","UY","gf","vq","eT"],function(e,t,i,o,n,r,a,s,m,l,d,c,u,p,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._vroomDataRequestor=t.vroomDataRequestor;i._urlDataSource=t.urlDataSource;i._vroomItemResultProcessor=t.vroomItemResultProcessor;i._itemTaskObserver=new t.itemTaskObserverType;i._itemHelper=new(i.managed(s.default));i._filterHelper=new(i.managed(a.default));i._sharedColumnHelper=t.sharedColumnHelper;i._authTokenFetcher=t.authTokenFetcher;return i}e.prototype.getItem=function(e){var t=new o.default;this._authTokenFetcher.ensureAuthToken(e.parentKey).then(null,function(e){t.error(e)}).done();this._getItem(e).then(function(e){t.complete(e)},function(e){t.error(e)}).done();return t.getPromise()};e.prototype._getItem=function(c){var u=this,p=l.strings.SharedWithMe;return this._vroomDataRequestor.send({apiName:"sharedWithMe",path:"/drive/sharedwithme?expand=formats&allowExternal=true",useAuthorizationHeaders:!0}).then(function(e){var t=u._urlDataSource.getQueryType(u._urlDataSource.getKeyParams(c.parentKey)),i=u._urlDataSource.getRootItemKey(t);u._itemTaskObserver.update([new f.Task(i).succeed({item:{type:m.default.Folder,queryType:t,displayType:t,name:p,displayName:p,isPlaceholder:!1,isRootFolder:!0}})]);for(var r=[],o=0,n=e.value;o<n.length;o++){var a=n[o],s=u._vroomItemResultProcessor.processItem({itemFromServer:a.remoteItem,requestKey:i,observer:u._itemTaskObserver}).key;r.push({key:s})}u._itemTaskObserver.flush();var l=r.map(function(e){return u._itemTaskObserver.getItem({key:e.key})});l=u._filterHelper.filterItems(c.parentKey,l);var d=u._itemHelper.getOrderInfo({items:l,groupBy:c.groupBy,sortField:c.sortField,isAscending:c.isAscending});return{item:{key:i},children:d.items,totalChildren:d.items.length,schema:u._sharedColumnHelper.getSchema(c),groupings:d.groupings}})};e.dependencies=i.__assign({},n.default.dependencies,{vroomDataRequestor:p.resourceKey,itemTaskObserverType:f.resourceKey,urlDataSource:d.url,vroomItemResultProcessor:h.resourceKey,sharedColumnHelper:c.resourceKey,authTokenFetcher:u.resourceKey});return e}(n.default);t.default=g;t.resourceKey=r.createResolvedResourceKey(e("module").id,g)});define("Vb",["require","exports","ap","dq","bN","gP","gQ","dZ"],function(e,t,r,g,i,o,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._urlDataSource=t.resources.consume(n.url);return t}e.prototype.filterItems=function(e,t){for(var i,r,o,n,a,s,l=this._urlDataSource.getKeyParams(e),d=this._urlDataSource.getUsersFilter(l),c=this._getDateFilter(l),u=this._getTypeFilters(l),p=[],m=0,h=t;m<h.length;m++){var f=h[m];d&&!y(f,d)||(!c||(s=c,(a=f).dateModifiedTime&&a.dateModifiedTime>=s))&&(!u||(i=f,r=u,void 0,o=g.getIconNameFromExtension(i.extension),n=v[o],0<=r.indexOf(n)))&&p.push(f)}return p};e.prototype._getDateFilter=function(e){var t=this._urlDataSource.getDateDurationFilter(e);return function(e){var t=new Date,i=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case o.DateTimeSliderValue.today:return i;case o.DateTimeSliderValue.yesterday:return l(i,1);case o.DateTimeSliderValue.last7Days:return l(i,7);case o.DateTimeSliderValue.last30Days:return l(i,30);case o.DateTimeSliderValue.last3Months:return l(i,90)}}(o.DateTimeSliderValue[t])};e.prototype._getTypeFilters=function(e){var t=this._urlDataSource.getItemTypeFilter(e);if(t&&t.filters.length){for(var i=[],r=0,o=t.filters;r<o.length;r++){var n=o[r];"string"==typeof n?a.ItemTypeFilter[n]&&i.push(a.ItemTypeFilter[n]):i.push(n)}return i}};return e}(i.default);t.default=s;function l(e,t){var i=new Date(e.valueOf());i.setDate(i.getDate()-t);return i}function y(e,t){for(var i=0,r=t;i<r.length;i++){var o=r[i];if(e.editorName===o)return!0;var n=e.properties.sharedByUser;if(n&&n.title===o)return!0}return!1}var v={code:a.ItemTypeFilter.text,csv:a.ItemTypeFilter.excel,docx:a.ItemTypeFilter.word,dotx:a.ItemTypeFilter.word,one:a.ItemTypeFilter.onenote,onepkg:a.ItemTypeFilter.onenote,onetoc:a.ItemTypeFilter.onenote,pdf:a.ItemTypeFilter.pdf,photo:a.ItemTypeFilter.media,potx:a.ItemTypeFilter.powerpoint,ppsx:a.ItemTypeFilter.powerpoint,pptx:a.ItemTypeFilter.powerpoint,rtf:a.ItemTypeFilter.text,txt:a.ItemTypeFilter.text,video:a.ItemTypeFilter.media,xlsx:a.ItemTypeFilter.excel,xltx:a.ItemTypeFilter.excel,zip:a.ItemTypeFilter.zip}});define("Vc",["require","exports","eT","fO","dZ","bA","iE"],function(e,t,m,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._pageContext=t.pageContext;this._itemUrlHelper=t.itemUrlHelper}e.prototype.processIdentity=function(e){var t,i=e.itemFromServer,r=e.requestKey,o=e.observer,n=i.webUrl,a=i.webDavUrl,s=this._pageContext.siteSubscriptionId,l=this._itemUrlHelper.getItemUrlParts(r),d=this._itemUrlHelper.getUrlParts({path:decodeURIComponent(a||n),listUrl:l.fullListUrl}),c=this._urlDataSource.getKey(((t={}).id=d.serverRelativeItemUrl,t.listurl=d.normalizedListUrl,t)),u=i.sharepointIds||{},p={isExternal:s&&u.tenantId&&s!==u.tenantId};o.update([new m.Task(c).succeed({item:{key:c,id:d.serverRelativeItemUrl,lifeCycleStatus:p}})]);return{key:c}};e.dependencies={urlDataSource:r.url,pageContext:n.pageContext,itemUrlHelper:i.resourceKey};return e}();t.ItemIdentityProcessor=a;t.resourceKey=o.createResolvedResourceKey(e("module").id,a);t.default=a});define("E5",["require","exports","ap","bN","dZ","eV","iJ","gN","dH","aC","ex","iq","rN","V","E6","vP","jl","aL","gQ","gP","eT","bA"],function(e,g,r,t,i,k,o,I,T,w,a,d,c,u,s,p,y,E,D,A,l,n){"use strict";Object.defineProperty(g,"__esModule",{value:!0});g.dateFilterMap={2:"last month",3:"this week",4:"yesterday",5:"today"};g.searchFilterExtensionMap={word:["doc","dot","odt"],excel:["xls","ods"],powerpoint:["ppt","pps","odp"],onenote:["one","onepkg","onetoc2","notebook"],media:["jpg","mp3","png","mpg","wmv","mp4","jpeg"],zip:["zip","gz","7zip","rar"],text:["txt","log"],pdf:["pdf"]};function M(e){switch(e){case A.DateTimeSliderValue.last3Months:return 90;case A.DateTimeSliderValue.last30Days:return 30;case A.DateTimeSliderValue.last7Days:return 7;case A.DateTimeSliderValue.yesterday:return 2;case A.DateTimeSliderValue.today:return 1}}g.getDays=M;var m=function(n){r.__extends(e,n);function e(e,t){void 0===e&&(e={});var i=n.call(this,e,t)||this;i._urlDataSource=t.urlDataSource;i._itemsStore=t.itemsStore;i._instrumentationDataSource=t.instrumentationDataSource;i._isOLSQueryEnabled=t.isOLSQueryEnabled;i._itemResultProcessor=t.itemResultProcessor;i._searchService=t.searchService;i._itemTaskObserverType=t.itemTaskObserverType;var r=t.SearchRest,o=void 0===r?p:r;i._searchRestType=o;return i}e.prototype.getItem=function(v){var _,b=this,e=this._urlDataSource.getKeyParams(v.parentKey),t=this._urlDataSource.getItemTypeFilter(e),i=this._urlDataSource.getUsersFilter(e),r=this._urlDataSource.getDateDurationFilter(e),o=this._urlDataSource.getQueryType(e),n=this._urlDataSource.getQueryParamValue(e),x=this._createSearchRoot(n,o,t,r&&r.toString(),i),S=(v.requestToken&&JSON.parse(v.requestToken)||{startrow:0}).startrow,C="",P=o===T.default.Discover,a=A.DateTimeSliderValue[r],s=this._isOLSQueryEnabled?"modified":"LastModifiedTime";if(a){a=new Date((new Date).getTime()-864e5*M(a)).toISOString();s+=">="}else a=r;var l="";if(i){var d="";i.forEach(function(e){d+=(d?" OR ":"")+'ModifiedBy:"'+e+'"';d+=' OR author:"'+e+'"'});l+=d=(l?" AND ( ":"( ")+d+")"}var c="";if(t&&t.filters.length){for(var u=0,p=t.filters;u<p.length;u++){var m=p[u],h=D.ItemTypeFilter[m],f=g.searchFilterExtensionMap[h];c+=(c?" OR ":"")+(f=f.map(function(e){return"filetype:"+e+(b._isOLSQueryEnabled?"":"*")})).join(" OR ")}c=(l?" AND ( ":"( ")+c+")"}l+=c;a&&(l+=(l?" AND ":"")+s+'"'+a+'"');if(P){C=I.default.DISCOVER_URL_MAIN;_=this._searchService.getSearchResultsForUrl(C,"discover")}else _=this._searchService.query(n,{pageSize:v.pageSize,startRow:S,clientFunction:v.isSuggest?y.QueryBoxSkyDrive:y.FullResults,qosName:v.qosName||"Odb.Item.SearchDataSource.getItem",searchSessionId:this._instrumentationDataSource?this._instrumentationDataSource.searchSessionId:void 0,filterQuery:l});return _.then(function(e){if(!e)return w.default.wrapError(new Error("Search response null or empty"));var t=e.Properties,i=e.PrimaryQueryResult&&e.PrimaryQueryResult.RelevantResults,r=i&&i.Properties||{results:[]},o=i&&i.Table.Rows.results||[],n=i&&i.TotalRows||0,a=b._searchRestType.getProperties(t).piPageImpression,s=b._searchRestType.getProperties(r).piPageImpressionBlockType,l=new k.default(x.key);E.extend(l,x);l.folder={childCount:n};l.isPlaceholder=!1;var d=[],c=[],u=!1;C=I.default.DISCOVER_URL_ACTORS;for(var p=0;p<o.length;p++){var m=o[p],h=d[p]=b._searchRestType.getProperties(m.Cells);if(P&&h.Edges){var f=h.Edges.filter(function(e){return 1039===e.Properties.Action}),g=f&&f[0]&&f[0].Properties.BlobContent;c[p]=g&&parseInt(g.ActorId,10)||0;h.EditorsCount=g&&parseInt(g.ActorCount,10)||0;if(c[p]){u&&(C+="%20OR%20");C+="workid:"+c[p];u=!0}}}C+="%27";var y={items:o,itemsFromServer:d,context:v,rootItem:x,children:[],childCount:n,startRow:S,pageImpression:a,pageImpressionBlockType:s,updatedRootItem:l,actors:void 0,actorItemsFromServer:void 0,getThumbnailByUrl:!1};return P?(_=b._searchService.getSearchResultsForUrl(C,"discover")).then(function(e){var t=[],i=e&&e.PrimaryQueryResult&&e.PrimaryQueryResult.RelevantResults,r=i&&i.Table&&i.Table.Rows;if(r)for(var o=0,n=r.results;o<n.length;o++){var a=n[o];t.push(b._searchRestType.getProperties(a.Cells))}y.actors=c;y.actorItemsFromServer=t;return b._processItemsFromServer(y)}):b._processItemsFromServer(y)})};e.prototype._processItemsFromServer=function(e){for(var t=e.items,i=e.itemsFromServer,r=e.context,o=e.rootItem,n=e.children,a=e.childCount,s=e.startRow,l=e.pageImpression,d=e.pageImpressionBlockType,c=e.updatedRootItem,u=e.actorItemsFromServer,p=e.actors,m=e.getThumbnailByUrl,h=new this._itemTaskObserverType,f=0;f<t.length;f++){var g=p&&p[f],y=i[f];if(g)for(var v=0,_=u;v<_.length;v++){var b=_[v];if(b.DocId===g){y.PictureURL=b.PictureURL;y.PreferredName=b.PreferredName;y.PicturePath=b.Path;break}}var x=this._searchService.getSearchInstrumentationUrl({itemFromServer:y,pageImpression:l,pageImpressionBlockType:d,index:f}),S=this._itemResultProcessor.processItemResult(y,{queryType:r.queryType,requestKey:o.key,searchInstrumentationUrl:x,getThumbnailByUrl:m,observer:h});n.push(S)}h.flush();this._itemsStore.setItem(c);var C=r.needSchema&&this._getSchema(),P=this._urlDataSource.getQueryType(this._urlDataSource.getKeyParams(r.parentKey))!==T.default.Discover;return{item:o,totalChildren:t.length,children:n,nextRequestToken:P&&a>s+t.length?JSON.stringify({startrow:s+t.length}):void 0,schema:C}};e.prototype._createSearchRoot=function(e,t,i,r,o){void 0===t&&(t=T.default.Search);var n=this._urlDataSource.getKey(((s={}).view=""+t,s.q=e,s.typeFilters=i&&i.filters&&i.filters.map(function(e){return D.ItemTypeFilter[e]}).join(","),s.dateFilter=r,s.userFilters=o&&o.join(","),s)),a=u.format(c.strings.SearchItemsTitle,e);(i&&i.filters&&i.filters.length||r||o)&&(a=u.format(c.strings.FilteredSearchItemsTitle,e));t===T.default.Discover&&(a=d.strings.DiscoverRelevantItems);var s,l=p.createSearchRoot({key:n,queryType:t,name:a,isPlaceholder:!0});this._itemsStore.setItem(l);return l};e.prototype._getSchema=function(){return[this._createColumn("type","",{minWidth:16,width:16,fieldType:a.ColumnFieldType.FileIcon}),this._createColumn("name",d.strings.NameColumnName,{minWidth:220,width:440,fieldType:a.ColumnFieldType.Name}),this._createColumn("editorName",d.strings.ModifiedByColumnName,{fieldType:a.ColumnFieldType.Text}),this._createColumn("dateModified",d.strings.DateModifiedColumnName,{fieldType:a.ColumnFieldType.DateTime}),this._createColumn("location",d.strings.SearchLocationColumnName),this._createColumn("size",d.strings.SizeColumnName,{isHtml:!0,fieldType:a.ColumnFieldType.FileSize})]};e.prototype._createColumn=function(e,t,i){return r.__assign({key:e,name:t,minWidth:90,width:130,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:a.ColumnFieldType.Text,filterable:!1,groupable:!1,isFocused:this.createObservable(!1)},i||{})};e.dependencies=r.__assign({},t.default.dependencies,{urlDataSource:i.url,itemsStore:o.resourceKey,itemResultProcessor:s.resourceKey,isOLSQueryEnabled:y.isOLSQueryEnabledResourceKey.optional,searchService:y.resourceKey,itemTaskObserverType:l.resourceKey,instrumentationDataSource:i.instrumentation.optional});return e}(t.default);g.default=m;g.resourceKey=n.createResolvedResourceKey(e("module").id,m)});define("Vd",["require","exports","ap","bN","eO","aC","hs","aM","aZ","aP","eN","Iq","iq","fO","gl","iE","dZ","fZ","eA","ba","eT","eS","Ve","gO","bA","ig","cE"],function(e,t,i,o,p,f,m,a,y,w,E,v,r,n,s,l,d,c,u,h,g,_,b,x,S,C,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.checkFileNameStringsResourceKey=new S.ResourceKey({name:e("module").id+".checkFileNameStrings",factory:new S.ConstantResourceFactory({emptyNameError:r.strings.emptyNameError,invalidNameStartError:r.strings.invalidNameStartError,invalidNameError2:r.strings.invalidNameError2,invalidNameError:r.strings.invalidNameError})});t.fileSystemDataSourceResourceKey=new S.ResourceKey({name:e("module").id+".fileSystemDataSource",factory:{dependencies:{pageContext:l.pageContext,listContext:l.listContext,strings:t.checkFileNameStringsResourceKey,itemUrlHelper:n.resourceKey,apiUrlHelper:c.resourceKey},create:function(e){return{instance:new b.FileSystemDataSource(i.__assign({},e))}}}});var k=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._listContext=t.listContext;i._pageContext=t.pageContext;i._urlDataSource=t.urlDataSource;i._engagement=t.engagement;i._itemUrlHelper=t.itemUrlHelper;i._apiUrlHelper=t.apiUrlHelper;i._itemParentHelper=t.itemParentHelper;i._checkFilenameStrings=t.checkFileNameStrings;i._fileSystemDataSource=t.fileSystemDataSource;i._itemTaskObserverType=t.itemTaskObserverType;i._dataRequestor=new t.dataRequestorType({qosName:"ListItemsDataSourceDeferred"});return i}e.prototype.createDocument=function(e,t,i,r){return this._fileSystemDataSource.createDocument(e,t,i,r)};e.prototype.createCustomDocument=function(e,t,i){var r=this;if("string"==typeof i){var o=this._checkFilename(i);if(o)return o}var n=this._itemUrlHelper.getItemUrlParts(e);return this._dataRequestor.getData({url:this._getCreateCustomDocumentUrl(n,t,i),qosName:"CreateCustomDocument"}).then(function(e){var t=e&&e.d&&e.d.CreateDocumentWithDefaultName;return t&&r._urlDataSource.getKey({id:n.serverRelativeItemUrl+"/"+t,listurl:n.normalizedListUrl})},function(e){return f.default.wrapError(e.message.value)})};e.prototype.createFolder=function(e){var c=this,u=this._itemUrlHelper.getItemUrlParts(e.parent.key),t="";if(this._listContext.isDocLib){t=this._urlDataSource.getKeyParams(e.parent.key).id}var i={parent:x.convertToISPListItem(e.parent),folderName:e.folderName,parentFolderUrl:t,needItemDetails:e.needItemDetails,parseResponse:function(e){var t,i=null;null!=e&&(i=JSON.parse(e).d);if(i&&i.Exists){var r=new c._itemTaskObserverType,o=c._itemUrlHelper.getUrlParts({path:i.ServerRelativeUrl,listUrl:u.normalizedListUrl}),n=c._urlDataSource.getKey(((t={}).id=o.serverRelativeItemUrl,t.listurl=o.normalizedListUrl,t)),a=void 0;i.ListItemAllFields&&(a=""+i.ListItemAllFields.Id);var s=void 0;i.UniqueId&&(s=""+i.UniqueId);var l=i.Name;r.update([new _.default(n).succeed({item:{key:n,id:o.serverRelativeItemUrl,name:l,displayName:l,dateModified:m.getRelativeDateTimeStringForLists(i.TimeLastModified),isDropEnabled:!0,permissions:i.PermMask,properties:{ID:a,uniqueId:s},type:p.default.Folder,itemFromServer:i}})]);r.flush();var d=r.getItem({key:n});r.dispose();return d}return null}};return this._fileSystemDataSource.createFolderAndParseResponse(i)};e.prototype.moveItems=function(t){var i=this;if(0===t.items.length)return null;var e=t.items.filter(function(e){return C.default.isShortcutItem(e)}).length;0<e&&this._engagement.logData({name:"ShortcutLink.MoveExecuteAggregate",extraData:{count:e}});if(1===t.items.length)return this.getData(function(){return i._getMoveSingleItemUrl(t.items[0],t)},function(e){return e},"MoveItemsSingle",function(){return i._getCopyMoveAdditionalHeader(t.items[0],t)},"POST",null,null,null,!0).then(function(e){return i._getMoveCopySingleItemResponse(t.items[0],t.targetId,e)},function(e){return i._getMoveCopySingleItemResponse(t.items[0],t.targetId,e)});var r=y.default.generate(),o="multipart/mixed; boundary=batch_"+r;return this.getData(function(){return v.DataBatchOperationHelper.getBatchOperationUrl(i._pageContext.webAbsoluteUrl)},function(e){return e},"moveItemsMultiple",function(){return i._getBatchMoveContent(t,r)},"POST",null,o,null,!0).then(function(e){return i._getMoveCopyBatchItemsResponse(t.items,t.targetId,e)},function(e){return i._getMoveCopyBatchItemsResponse(t.items,t.targetId,e)})};e.prototype.copyItems=function(t){var i=this;if(0===t.items.length)return null;var e=t.items.filter(function(e){return C.default.isShortcutItem(e)}).length;0<e&&this._engagement.logData({name:"ShortcutLink.CopyExecuteAggregate",extraData:{count:e}});if(1===t.items.length)return this.getData(function(){return i._getCopySingleItemUrl(t.items[0],t)},function(e){return e},"CopyItemsSingle",function(){return i._getCopyMoveAdditionalHeader(t.items[0],t)},"POST",null,null,null,!0).then(function(e){return i._getMoveCopySingleItemResponse(t.items[0],t.targetId,e)},function(e){return i._getMoveCopySingleItemResponse(t.items[0],t.targetId,e)});var r=y.default.generate(),o="multipart/mixed; boundary=batch_"+r;return this.getData(function(){return v.DataBatchOperationHelper.getBatchOperationUrl(i._pageContext.webAbsoluteUrl)},function(e){return e},"copyItemsMultiple",function(){return i._getBatchCopyContent(t,r)},"POST",null,o,null,!0).then(function(e){return i._getMoveCopyBatchItemsResponse(t.items,t.targetId,e)},function(e){return i._getMoveCopyBatchItemsResponse(t.items,t.targetId,e)})};e.prototype.getWorkProgress=function(e){var r=this,o=e&&e.workItemIds&&e.workItemIds[0],t=e&&e.jobInfo&&e.jobInfo.spData;if(!t||0===t.length)return null;var i,n=e&&e.lastProcessedTime,a=e&&e.items,s=e&&e.progressCache,l=1<t.length,d=[],c=y.default.generate(),u=[],p=[],m=v.DataBatchOperationHelper.defaultBatchRequestPostData,h=v.DataBatchOperationHelper.defaultBatchAcceptData;if(l){i="multipart/mixed; boundary=batch_"+c;for(var f=0;f<t.length;f++){var g=t[f];u.push(this._apiUrlHelper.build().segments("site","GetCopyJobProgress").toString());d.push(g.JobId);p.push(JSON.stringify({copyJobInfo:{__metadata:{type:"SP.CopyMigrationInfo"},EncryptionKey:g.EncryptionKey,JobId:g.JobId,JobQueueUri:g.JobQueueUri}}))}}else{i="application/json; odata=verbose";d.push(t[0].JobId)}return this.getData(function(){return l?v.DataBatchOperationHelper.getBatchOperationUrl(r._pageContext.webAbsoluteUrl):r._apiUrlHelper.build().segments("site","GetCopyJobProgress").toString()},function(e){var t=null;try{var i=void 0;i=l?v.DataBatchOperationHelper.getBatchResponseText(e):[e];t=r._parseCopyJobProgressResponse(i,d,o,a,n,s)}catch(e){w.Verbose.logData({name:"ItemDataSource.getWorkProgress.CopyJobProgressParseError",message:e})}return t},"GetPrimeJobStatus",function(){return l?v.DataBatchOperationHelper.getBatchContentExtended(c,u,"POST",m,p,h):JSON.stringify({copyJobInfo:t[0]})},"POST",null,i)};e.prototype.cancelWork=function(e){var t=this,i=e&&e.progressCache,r=i.getCacheData(),o=r&&r[e.workItemIds[0]];if(o&&!o.cancelRequestSent){var n=o.jobInfo.spData,a=1<n.length,s=y.default.generate(),l=void 0,d=[],c=[],u=v.DataBatchOperationHelper.defaultBatchRequestPostData,p=v.DataBatchOperationHelper.defaultBatchAcceptData;if(a){l="multipart/mixed; boundary=batch_"+s;for(var m=0;m<n.length;m++){var h=n[m].JobId;d.push(this._apiUrlHelper.build().segments("site","DeleteMigrationJob").toString());c.push(JSON.stringify({id:h}))}}else l="application/json; odata=verbose";o.cancelRequestSent=!0;r[e.workItemIds[0]]=o;i.setCacheData(r);return this.getData(function(){return a?v.DataBatchOperationHelper.getBatchOperationUrl(t._pageContext.webAbsoluteUrl):t._apiUrlHelper.build().segments("site","DeleteMigrationJob").toString()},function(e){for(var t=!1,i=0,r=a?v.DataBatchOperationHelper.getBatchResponseText(e):[e];i<r.length;i++){var o=r[i],n=void 0;try{(n=JSON.parse(o))&&n.d&&n.d.DeleteMigrationJob&&(t=!0)}catch(e){return!1}}return t},"CancelPrimeJobs",function(){return a?v.DataBatchOperationHelper.getBatchContentExtended(s,d,"POST",u,c,p):JSON.stringify({id:n[0].JobId})},"POST",null,l)}return f.default.wrap(!1)};e.prototype.renameItem=function(e){var i=this,t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e.item,"subsite")),r={newName:e.newName,parentKey:e.parentKey,item:x.convertToISPListItem(e.item),siteRootItem:t};return this._fileSystemDataSource.renameItem(r).then(function(e){var t=new i._itemTaskObserverType;t.update([new _.default(r.item.key).succeed({item:{key:r.item.key,parentKey:g.Graft.remove()}})]);t.flush();t.dispose();return e})};e.prototype.removeFromSharedList=function(e){var t,i=[],r=h.isFeatureEnabled(h.DecodeShareWithMeUrls);if(r){e.items.forEach(function(e,t){i[t]={DecodedUrl:e.itemFromServer.Path||decodeURIComponent(e.itemFromServer.webDavUrl)}});t=JSON.stringify({itemPaths:i})}else{e.items.forEach(function(e,t){i[t]=e.itemFromServer.Path||e.itemFromServer.webDavUrl});t=JSON.stringify({itemUrls:i})}var o=r?"RemoveItemsFromSharedWithMeViewByPath":"RemoveItemsFromSharedWithMeView",n=a.default.escapeUrlForCallback(this._pageContext.webAbsoluteUrl)+"/_api/SP.Sharing.DocumentSharingManager."+o;return this.getData(function(){return n},function(e){var t=JSON.parse(e);if(t&&t.d&&t.d[o]&&t.d[o].results){var i=[];t.d[o].results.forEach(function(e){-3===e.ErrorCode?i.push(""):i.push(e.ErrorMessage)});return i}return[]},"RemoveFromSharedList",function(){return t},"POST")};e.prototype._getCreateCustomDocumentUrl=function(e,t,i){if(!t)throw new Error("document extension is not valid");return this._apiUrlHelper.build().webByItemUrl(e).method("GetList",e.serverRelativeListUrl).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:e.listRelativeItemUrl,extension:t}).toString()};e.prototype._parseCopyJobProgressResponse=function(h,f,i,e,g,t){for(var y,v,_={},b={},x={},r=E.ITaskStatuses[E.ITaskStatuses.Unknown],o=t.getCacheData(),S=o[i],n=function(){var t=f[P];try{y=JSON.parse(h[P])}catch(e){w.Verbose.logData({name:"ItemDataSource.getWorkProgress.InvalidJson",message:e})}var e=y&&y.d&&y.d.GetCopyJobProgress;if(e){var i=e.JobState,r=e.Logs&&e.Logs.results,o=!1;if(S.jobStates[t]===E.ITaskStatuses.Cancelled)return"continue";switch(i){case 0:break;case 2:S.jobStates[t]=E.ITaskStatuses.NotStarted;break;case 4:S.jobStates[t]=E.ITaskStatuses.InProgress}if(r)for(var n=0,a=r;n<a.length;n++){var s=a[n],l=void 0;try{l=JSON.parse(s)}catch(e){w.Verbose.logData({name:"ItemDataSource.getWorkProgress.InvalidLog",message:e});continue}if((!g||l.Time&&new Date(l.Time)>=new Date(g))&&("Copy"===l.MigrationType||"MoveCleanup"===l.MigrationDirection)&&"JobLogFileCreate"!==l.Event){v=l.Time;var d=0;l.BytesProcessed&&(d=Number(l.BytesProcessed));var c=0;l.TotalExpectedBytes&&(c=Number(l.TotalExpectedBytes));var u=void 0;"JobFatalError"!==l.Event&&"JobError"!==l.Event||(u={JobId:l.JobId,ErrorCode:l.ErrorCode});var p=C._engagement;switch(l.Event){case"JobQueued":case"JobStart":break;case"JobProgress":if("Import"===l.MigrationDirection)S.jobCompletedBytes[t].importCompletedBytes=d;else{S.jobCompletedBytes[t].exportCompletedBytes=d;S.jobCompletedBytes[t].exportExpectedBytes=c}break;case"JobFatalError":S.jobStates[t]=E.ITaskStatuses.Failed;x={code:-2147024809};p.logData({name:"CopyItemsAsync.GetCopyJobProgress.FatalError",extraData:u});break;case"JobError":if(l.SourceListItemIntId){b[l.SourceListItemIntId]={code:Number(l.ErrorCode)};o=!0;p.logData({name:"CopyItemsAsync.GetCopyJobProgress.ItemError",extraData:u})}else{S.jobStates[t]=E.ITaskStatuses.Failed;x={code:-2147024809};p.logData({name:"CopyItemsAsync.GetCopyJobProgress.UnknownItemError",extraData:u})}break;case"JobEnd":var m=function(){for(var e in b)_[e]=E.ITaskStatuses[E.ITaskStatuses.Failed];o&&(S.jobCompletedBytes[t].importCompletedBytes=S.jobCompletedBytes[t].exportCompletedBytes);S.jobStates[t]!==E.ITaskStatuses.Failed&&(S.jobStates[t]=E.ITaskStatuses.Completed)};if("Import"===l.MigrationDirection){S.jobCompletedBytes[t].importCompletedBytes=d;S.isMove||m()}else if("Export"===l.MigrationDirection){S.jobCompletedBytes[t].exportCompletedBytes=d;S.jobCompletedBytes[t].isExportDone=!0}else"MoveCleanup"===l.MigrationDirection&&m()}}}}},C=this,P=0;P<f.length;P++)n();var a={};a[E.ITaskStatuses.Cancelled]=6;a[E.ITaskStatuses.Failed]=5;a[E.ITaskStatuses.InProgress]=4;a[E.ITaskStatuses.NotStarted]=3;a[E.ITaskStatuses.Completed]=2;a[E.ITaskStatuses.Unknown]=1;var s,l=0,d=[];for(var c in S.jobStates){var u=S.jobStates[c];d.push(u);if(a[u]>l){l=a[u];s=u}}r=-1!==d.indexOf(E.ITaskStatuses.Completed)&&-1!==d.indexOf(E.ITaskStatuses.NotStarted)&&l<3?E.ITaskStatuses[E.ITaskStatuses.InProgress]:E.ITaskStatuses[s];var p=1/Object.keys(S.jobStates).length,m=0;for(var c in S.jobCompletedBytes){var k=S.jobCompletedBytes[c],I=0;if(k.isExportDone)I=.5+k.importCompletedBytes/k.exportCompletedBytes*.5;else if(k.exportExpectedBytes){var T=k.exportCompletedBytes/k.exportExpectedBytes*.5;I=T<.5?T:.5}m+=I*p}m=Math.round(100*m)/100;if(S.currentProgress&&m<S.currentProgress){w.Verbose.logData({name:"ItemDataSource.getWorkProgress.RetrogradeProgressError",message:"New progress is less than progress in cache"});m=S.currentProgress}o[i]=S;t.setCacheData(o);return{progress:e.map(function(e){var t=e.properties.ID;return{id:i,sourceResourceId:t,status:_[t]?_[t]:r,totalBytes:1,completedBytes:m,error:r===E.ITaskStatuses[E.ITaskStatuses.Failed]?x:b[t],timestamp:v}})}};e.prototype._getMoveSingleItemUrl=function(e,t){var i,r=this._apiUrlHelper.build();i=e.type===p.default.Folder||"1"===e.properties.FSObjType?"MoveFolderByPath":"MoveFileByPath";var o={};t.nameConflict&&1===t.nameConflict&&(o.overwrite=!0);return(r=r.methodWithAliases("SP.MoveCopyUtil."+i,o)).toString()};e.prototype._getCopySingleItemUrl=function(e,t){var i,r=this._apiUrlHelper.build();i=e.type===p.default.Folder||"1"===e.properties.FSObjType?"CopyFolderByPath":"CopyFileByPath";var o={};t.nameConflict&&1===t.nameConflict&&(o.overwrite=!0);return(r=r.methodWithAliases("SP.MoveCopyUtil."+i,o)).toString()};e.prototype._getCopyMoveAdditionalHeader=function(e,t){var i={srcPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl},destPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:this._itemUrlHelper.getItemUrlParts(t.targetKey).fullItemUrl+"/"+e.properties.FileLeafRef}};t.nameConflict&&2===t.nameConflict&&(i.options={__metadata:{type:"SP.MoveCopyOptions"},KeepBoth:!0});return JSON.stringify(i)};e.prototype._getBatchMoveContent=function(e,t){for(var i=e.items,r=[],o=[],n=v.DataBatchOperationHelper.defaultBatchRequestPostData,a=0,s=i;a<s.length;a++){var l=s[a],d=this._getMoveSingleItemUrl(l,e);r.push(d);o.push(this._getCopyMoveAdditionalHeader(l,e))}return v.DataBatchOperationHelper.getBatchContentExtended(t,r,"POST",n,o)};e.prototype._getBatchCopyContent=function(e,t){for(var i=e.items,r=[],o=[],n=v.DataBatchOperationHelper.defaultBatchRequestPostData,a=0;a<i.length;a++){var s=i[a],l=this._getCopySingleItemUrl(s,e);r.push(l);o.push(this._getCopyMoveAdditionalHeader(s,e))}return v.DataBatchOperationHelper.getBatchContentExtended(t,r,"POST",n,o)};e.prototype._checkFilename=function(e){return b.checkFilename(e,this._checkFilenameStrings,this._pageContext.supportPoundStorePath)};e.prototype._getMoveCopySingleItemResponse=function(e,t,i){var r={id:e.id,newId:t+"/"+e.name};if((i=i.error?i.error:i)&&i.code){var o=i.code?i.code.split(","):i.error.code.split(","),n=Number(o[0]),a=i.message.value;r.error={code:n,message:a}}return{items:[r]}};e.prototype._getMoveCopyBatchItemsResponse=function(e,t,i){var r=e.map(function(e){return x.convertToISPListItem(e)});return{items:this._convertToIMoveCopyItemsResponse(v.DataBatchOperationHelper.processBatchResponse(i,r,t)).items}};e.prototype._convertToIMoveCopyItemsResponse=function(e){return{items:e.items.map(function(e){return{id:e.id||void 0,newId:e.newId||void 0,error:e.error?{code:e.error.code,message:e.error.message,debugMessage:void 0,isExpected:void 0,stackTrace:void 0}:void 0}})}};e.prototype.getData=function(e,t,i,r,o,n,a,s,l){return this._dataRequestor.getData({url:e(),parseResponse:t,method:o,qosName:i,noRedirect:l,contentType:a,additionalPostData:r?r():void 0,additionalHeaders:n,maxRetries:s})};e.dependencies=i.__assign({},o.default.dependencies,{listContext:l.listContext,pageContext:l.pageContext,urlDataSource:d.url,engagement:P.resourceKey,dataRequestorType:s.typeResourceKey,itemUrlHelper:n.resourceKey,apiUrlHelper:c.resourceKey,itemParentHelper:u.resourceKey,fileSystemDataSource:t.fileSystemDataSourceResourceKey,checkFileNameStrings:t.checkFileNameStringsResourceKey,itemTaskObserverType:g.resourceKey});return e}(o.default);t.default=k;t.resourceKey=S.createResolvedResourceKey(e("module").id,k)});define("Ve",["require","exports","ap","ef","aC","bl","bj","M5","h6","eq","dp","hs","hJ","Vf"],function(e,t,r,i,l,o,n,s,d,c,a,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e.pageContext)||this;t._listContext=e.listContext;t._itemUrlHelper=e.itemUrlHelper||new o.ItemUrlHelper({},{pageContext:e.pageContext});t._apiUrlHelper=e.apiUrlHelper||new n.ApiUrlHelper({},{pageContext:e.pageContext,itemUrlHelper:t._itemUrlHelper});t._strings=e.strings;return t}e.prototype.createDocument=function(e,r,o,t){var n=this;if("string"==typeof o){var i=f(o,this._strings,this._pageContext.supportPoundStorePath);if(null!==i)return i}return this.getData(function(){return n._getCreateDocumentUrl(r,e,o,t)},function(e){if(null!=e){var t=JSON.parse(e);if(null!==t&&null!==t.d&&null!==t.d.CreateDocumentAndGetEditLink)return n._getRedirectToEditNewDocument(t.d.CreateDocumentAndGetEditLink,r,o);try{var i=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent;return n._getRedirectToEditNewDocument(i,r,o)}catch(e){return""}}return e},"CreateDocument").catch(function(e){return l.default.reject(e.message.value)})};e.prototype.createFolder=function(e){var o=this,n=this._itemUrlHelper.getItemUrlParts(e.parent.key);e.parseResponse=function(e){var t=null;null!=e&&(t=JSON.parse(e).d);if(t&&t.Exists){var i=o._itemUrlHelper.getUrlParts({path:t.ServerRelativeUrl,listUrl:n.normalizedListUrl}),r={key:p.buildItemKey(i.serverRelativeItemUrl,i.normalizedListUrl)};r.type=a.default.Folder;r.id=t.serverRelativeItemUrl;r.name=t.Name;r.dateModified=u.getRelativeDateTimeStringForLists(t.TimeLastModified);r.isDropEnabled=!0;r.permissions=t.PermMask;if(t.ListItemAllFields){r.properties={ID:String(t.ListItemAllFields.Id)};r.isPlaceholder=!0}r.itemFromServer=t;return r}return null};return this.createFolderAndParseResponse(e)};e.prototype.createFolderAndParseResponse=function(t){var e=this,i=f(t.folderName,this._strings,this._pageContext.supportPoundStorePath),r=t.parentFolderUrl||t.parent.key;if(null!==i)return i;t.folderName=t.folderName.trim();return this.getData(function(){return e._getCreateFolderUrl(t)},function(e){return(0,t.parseResponse)(e)},"CreateFolder",function(){if(!e._listContext.isDocLib)return"";""===t.folderName&&(t.folderName="Folder"+Math.floor(100*Math.random())+1)}).catch(function(e){var t=e.message.value;if(-1<e.code.indexOf(-2130575257)){r=r.replace(/^\/+|\/+$/g,"");t=(t=e.message.value.replace(r,"")).replace(/\//g,"")}return l.default.reject(t)})};e.prototype.renameItem=function(e){var t=f(e.newName,this._strings,this._pageContext.supportPoundStorePath);if(null!==t)return t;var i,r=this._getRenameItemUrl(e.item),o={},n={},a=e.newName.trim(),s=this._itemUrlHelper.getItemUrlParts(e.item.key).serverRelativeListUrl;if(e.siteRootItem){i=this._itemUrlHelper.getItemUrlParts(e.siteRootItem.key).serverRelativeItemUrl}else i=c.getSafeWebServerRelativeUrl(this._pageContext);o.__metadata={type:d.getListEntityTypeName(s,i)};o.FileLeafRef=e.item.extension?a+e.item.extension:a;n["X-HTTP-Method"]="MERGE";n["If-Match"]="*";return this.getData(function(){return r},function(e){return e},"RenameItem",function(){return JSON.stringify(o)},"POST",n).catch(function(e){return l.default.reject(e.message.value)})};e.prototype._getRedirectToEditNewDocument=function(e,t,i){return m.getRedirectToEditNewDocument(e,t,i,this._pageContext.env&&"edog"===this._pageContext.env.toLowerCase())};e.prototype._getCreateDocumentUrl=function(e,t,i,r){var o=s.DocumentType.Visio;if(null!==e&&e>=s.DocumentType.Word&&e<=o&&e!==s.DocumentType.Text){e!==s.DocumentType.OneNote||i?e!==s.DocumentType.ExcelSurvey&&e!==s.DocumentType.ExcelForm||(i+=".xlsx"):i="Notebook"+Math.floor(100*Math.random())+1;i||(i="");e===s.DocumentType.ExcelForm&&(e=s.DocumentType.ExcelSurvey);var n=this._itemUrlHelper.getItemUrlParts(t),a=n.listRelativeItemUrl;return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:i,folderPath:a,documentTemplateType:e,templateUrl:r||""}).toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel, 3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")};e.prototype._getRenameItemUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl).method("Items",e.properties.ID).toString()};e.prototype._getCreateFolderUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.parent.key);if(this._listContext.isDocLib){var i=this._apiUrlHelper.build().webByItemUrl(t).segment("folders"),r=t.serverRelativeItemUrl;i=i.methodWithAliases("AddUsingPath",{DecodedUrl:r+"/"+e.folderName,overwrite:!1});e.needItemDetails&&(i=i.oDataParameter("$Expand","ListItemAllFields"));return i.toString()}e.folderName||(e.folderName="Folder"+(Math.floor(100*Math.random())+1));return(i=(i=(i=this._apiUrlHelper.build().webByItemUrl(t)).methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:t.serverRelativeItemUrl})).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:e.folderName})).toString()};return e}(i.default);t.FileSystemDataSource=h;function f(e,t,i){var r=m.checkFilename(e,t,i);return void 0!==r?l.default.reject(r):null}t.checkFilename=f;t.default=h});define("Vf",["require","exports","M5","V","Vg"],function(e,t,a,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.checkFilename=function(e,t,i){var r=void 0;"string"==typeof e?0===(e=e.trim()).length?r=t.emptyNameError:"."===e[0]?r=o.format(t.invalidNameStartError,e[0]):/["\*:<>\?\/\\\|]/.test(e)&&(r=o.format(i?t.invalidNameError2:t.invalidNameError,e)):r=t.emptyNameError;return r};t.getRedirectToEditNewDocument=function(e,t,i,r){var o="",n="action=edit";null!==e&&""!==e&&(o=t===a.DocumentType.ExcelSurvey?e.replace(n,"action=formedit"):t===a.DocumentType.ExcelForm?s.getCreateFormUrlCore(e,i,r):e.replace(n,"action=editnew"));return o}});define("Vg",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="forms.officeppe.com",s="forms.office.com",l="&action=edit";t.GetCreateFormUrl=function(e,t,i){return r(t,i,"edog"===e.env.toLowerCase())};function r(e,t,i){var r=e.replace(l,""),o=i?a:s,n="Action=Create&Host=OneDrive&XlWorkbookId="+encodeURIComponent(r)+"&Title="+encodeURIComponent(t);return"https://"+o+"/Pages/DesignPage.aspx?Action=Create&Fragment="+encodeURIComponent(n)}t.getCreateFormUrlCore=r});define("Vh",["require","exports","ap","dc","aC","hs","U","aZ","dq","aI","bA","V","ip","Vj","fO","Vi","SC","dZ"],function(e,t,a,i,o,r,n,s,l,m,d,c,u,p,h,f,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(){function e(e,t){this._cvid=s.default.generate();this._capabilities={maxQueryRate:200,minimumQueryLength:1,showNoResults:!0,showOnlyResults:!1,supportsResultsWheeling:!0,supportsSearchFiltering:!1};this._itemUrlHelper=t.itemUrlHelper;this._navigation=t.navigation;this._oAuthTokenPromise=t.oAuthTokenProvider.getToken("https://substrate.office.com");this._tsDataRequestor=t.tsDataRequestor;this._tsInstrumentationProvider=t.tsInstrumentationProvider;this._urlDataSource=t.urlDataSource;this._initializeQfSearch()}e.prototype.getItems=function(u,e){var p=this;void 0===u&&(u="");return u.length<this._capabilities.minimumQueryLength?o.default.wrap({query:"",containers:[],upscopeAvailable:!1}):this._oAuthTokenPromise.then(function(e){var d=[],r=s.default.generate(),c=performance.now();return p._tsDataRequestor.postTsData({requestId:r,action:"getsuggestions",token:e,cvid:p._cvid,prefix:u,additionalInfo:{highlight:1}},"Odb.Search.QF.QfSearchDataSource.getItems").then(function(e){var t=performance.now(),i=e.Instrumentation.TraceId;p._tsInstrumentationProvider.receivedResponse(i,t-c);var r=new m.Qos({name:"Odb.Search.QF.QfSearchDataSource.ResponseToRender"}),o=[],n=e.Groups.filter(function(e){return"Files"===e.Type})[0];if(n)for(var a=0,s=n.Suggestions;a<s.length;a++){var l=s[a];o.push(p._makeSuggestionResult(l))}d.push({results:o});return{query:u,containers:d,upscopeAvailable:!0,traceId:i,responseReceived:t,responseToRenderEvent:r}}).catch(function(e){var t=performance.now(),i=o.default.isCanceled(e)?408:e.status;p._tsInstrumentationProvider.receivedError(r,t-c,i);return{query:u,containers:d,upscopeAvailable:!0}})})};e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.searchResultClicked=function(e){this._resetCvid()};e.prototype.upscopeSearch=function(e){if(e){this._navigation.navigateTo({url:this._urlDataSource.getSearchQueryUrl(e)});this._resetCvid()}};e.prototype._initializeQfSearch=function(){var t=this;this._oAuthTokenPromise.then(function(e){t._tsDataRequestor.postTsData({action:"init",token:e,cvid:t._cvid},"Odb.Search.Init.QfSearchDataSource._initializeQfSearch")})};e.prototype._makeSuggestionResult=function(e){var t=e.AccessUrl,i=this._getParentFolder(t),r=this._getLastModifiedDateDisplay(e.DateModified),o={title:this._makeHitHiglightedTitle(e.Text),titleAriaLabel:"",parentFolder:i,lastModifiedDateDisplay:r,type:1,referenceId:e.ReferenceId},n=e.FileName;return"Folder"===e.FileType?a.__assign({},o,{titleAriaLabel:c.format(u.strings.TsFolderAriaLabel,n,i,r),iconName:"folder",key:this._getOneDriveItemKey(t,e.Id)}):a.__assign({},o,{titleAriaLabel:c.format(u.strings.TsFileAriaLabel,n,i,r),iconName:l.getIconNameFromExtension(e.FileExtension),url:t+"?web=1"})};e.prototype._makeHitHiglightedTitle=function(e){var t=n.default.encodeText(e);return t=(t=t.replace(/\ue000/g,'<span class="od-SearchResults-result-highlight">')).replace(/\ue001/g,"</span>")};e.prototype._getParentFolder=function(e){var t=e.split("/");return t[t.length-2]};e.prototype._getLastModifiedDateDisplay=function(e){var t=new Date(e.split("T")[0]);return r.getFriendlyDateTimeStringPast(t)};e.prototype._getOneDriveItemKey=function(e,t){var i,r=this._itemUrlHelper.getUrlParts({path:e}),o=r.serverRelativeItemUrl,n=r.normalizedListUrl;return this._urlDataSource.getKey(((i={}).id=o,i.listurl=n,i))};e.prototype._resetCvid=function(){this._cvid=s.default.generate()};e.dependencies={itemUrlHelper:h.resourceKey,navigation:i.navigation,oAuthTokenProvider:f.resourceKey,tsDataRequestor:p.resourceKey,tsInstrumentationProvider:g.resourceKey,urlDataSource:y.url};return e}();t.default=v;t.resourceKey=d.createResolvedResourceKey(e("module").id,v)});define("Vj",["require","exports","ap","bN","bE","hs","aZ","cL","aI","bA","gx","iE"],function(e,t,n,i,o,a,s,l,d,r,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(r){n.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._tsMailbox={};i.events.on(t.eventWindow||window,"message",function(e){return i._tsDataListener(e.data)});i._iFrame=t.mockIFrame||i._createIFrame();i._searchSession=t.searchSession;i._userEmail=t.pageContext.userEmail;return i}e.prototype.postTsData=function(e,t){var i=e.requestId||s.default.generate(),r=n.__assign({},e,{requestId:i,prefix:e.prefix||"",additionalInfo:n.__assign({},e.additionalInfo,{scenario:"onedriveweb",entitytypes:"file"}),headers:n.__assign({},e.headers,{accept:"application/json","Client-request-id":i,"Client-Session-Id":this._searchSession,"X-AnchorMailbox":this._userEmail,"X-Client-Language":l.default.language,"X-Client-LocalTime":a.convertDateToISOString((new Date).toString(),!0)})}),o=this._makeTsSignal(i);this._tsMailbox[i]={responseSignal:o,qosEvent:new d.Qos({name:t}),timeoutId:this._makeTimeoutId(i)};this._iFrame.contentWindow.postMessage(JSON.stringify(r),"https://substrate.office.com");return o.getPromise()};e.prototype._createIFrame=function(){var e=document.createElement("iframe");e.id="autosuggest";e.src="https://substrate.office.com/autosuggest/api/v2/resources";e.style.display="none";document.body.insertBefore(e,document.body.firstChild);this.scope.attach({dispose:function(){e.remove()}});return e};e.prototype._tsDataListener=function(e){var t;try{t=JSON.parse(e)}catch(e){return}finally{var i=void 0,r=void 0;if(t&&(i=t.requestId)&&(r=this._tsMailbox[i])){this.async.clearTimeout(r.timeoutId);var o=t.statusCode;if(200===o){r.responseSignal.complete(JSON.parse(t.qfResponse));r.qosEvent.end({resultType:d.ResultTypeEnum.Success,resultCode:"200"})}else{r.qosEvent.end({resultType:d.ResultTypeEnum.Failure,resultCode:o.toString()});r.responseSignal.error({status:o})}delete this._tsMailbox[i]}}};e.prototype._makeTsSignal=function(t){var i=this;return new o.default(function(){var e;if(e=i._tsMailbox[t]){i.async.clearTimeout(e.timeoutId);e.qosEvent.end({resultType:d.ResultTypeEnum.ExpectedFailure});delete i._tsMailbox[t]}})};e.prototype._makeTimeoutId=function(t){var i=this;return this.async.setTimeout(function(){var e;if(e=i._tsMailbox[t]){e.qosEvent.end({resultType:d.ResultTypeEnum.Failure,resultCode:"400"});e.responseSignal.error({status:400});delete i._tsMailbox[t]}},3e4)};e.dependencies={eventWindow:void 0,mockIFrame:void 0,pageContext:u.pageContext,searchSession:c.resourceKey};return e}(i.BaseModel);t.TsDataRequestor=p;t.resourceKey=r.createResolvedResourceKey(e("module").id,p)});define("Vi",["require","exports","aC","bA","fZ","gl"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._apiUrlHelper=t.apiUrlHelperKey;this._dataRequestor=new t.dataRequestorKey({qosName:"Odb-OAuthTokenProvider"})}e.prototype.getToken=function(e){return e?this._dataRequestor.getData({method:"POST",url:this._apiUrlHelper.build().method("SP.OAuth.Token/Acquire").toString(),additionalHeaders:{accept:"application/json"},additionalPostData:JSON.stringify({resource:e}),qosName:"getToken"}).then(function(e){return e.access_token}).catch(function(e){return e.toString()}):i.default.wrap("No resource? No token!")};e.dependencies={apiUrlHelperKey:o.resourceKey,dataRequestorKey:n.typeResourceKey};return e}();t.default=a;t.resourceKey=r.createResolvedResourceKey(e("module").id,a)});define("Vk",["require","exports","ap","aI","bN","aC","aN","hs","ej","dn","Vn","Vm","Vl","eO","dZ","iE","bX","eq","cE","dc","aM","h0","iJ","dH","ep","V","ip","bA"],function(e,t,i,c,r,n,o,m,x,h,a,S,g,s,l,d,u,C,p,y,v,_,b,P,k,I,T,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=/\.aspx$/gi,E=function(f){i.__extends(e,f);function e(e,t){void 0===e&&(e={});var i=f.call(this,e,t)||this,r=t.searchBehavior,o=void 0===r?{}:r,n=o.supportsResultsWheeling,a=void 0===n||n,s=o.showSearchPage,l=void 0!==s&&s,d=o.searchScope,c=void 0===d?1:d,u=o.useEnableDynamicGroups,p=void 0!==u&&u,m=o.setPathOnViewChange,h=void 0!==m&&m;i._showSearchPage=l;i._capabilities={supportsResultsWheeling:a,minimumQueryLength:2,maxQueryRate:200,showNoResults:!0,showOnlyResults:!1,supportsSearchFiltering:!1};i._searchScope=c;i._urlDataSource=t.urlDataSource;i._itemsStore=t.itemsStore;i._pageContext=t.pageContext;i._searchCenterDataSource=t.searchCenterDataSource;i._listContext=t.listContext;i._navigation=t.navigation;i._engagement=t.engagement;i._viewParams=t.viewParams;i._useEnableDynamicGroups=p;i._searchResultType=1;switch(i._searchScope){case 0:i._pluginToUse="mydocuments";break;case 1:i._pluginToUse="sitequery";i._searchResultType=6}h&&i.createBackgroundComputed(function(){var e=i._viewParams();i.setPath(e.id)});return i}e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.getItems=function(d,e){var b=this;void 0===d&&(d="");var t,o=!1;if(this._isODBLibrary()&&(d.length>=this._capabilities.minimumQueryLength||!d.length)){var i={parentKey:this._urlDataSource.getKey((t={},t.view=P.default.Search,t.q=d,t)),isSuggest:!0,pageSize:6,qosName:"Odb.Search.QF.SearchDataSource.getItems"};return this._getSearchDataSource().then(function(e){var l=[];return e.getItem(i).then(function(e){var t;d.length&&(t=new c.Qos({name:"Odb.Search.QF.SearchDataSource.ResponseToRender"}));for(var i=[],r=0,o=e.children;r<o.length;r++){var n=o[r],a=b.peekUnwrapObservable(b._itemsStore.getItem(n.key)),s=b._convertIOneDriveItemToISearchResult(a);i.push(s)}l.push({results:i});return{query:d,containers:l,upscopeAvailable:!0,responseToRenderEvent:t}}).catch(function(e){return{query:d,containers:l,upscopeAvailable:!0}})})}return new n.default(function(i,r){new n.default(function(_,e){window.require(["odm"],function(e){window.require(["oil.core","oil.p.myprops","sharedwithme","mydocuments","sitequery","oil.p.export"],function(e,t,i,r,o,n){if(!b._initialized){b._oilCore=e;b._pluginService=new e.PluginService({requiresRawData:!0});if(0===b._searchScope){(new t.MyPropertiesPlugin).initialize(b._pluginService);(new i).initialize(b._pluginService);var a=new r;a._pluginDependency=!1;a.initialize(b._pluginService)}else if(1===b._searchScope){var s=b._pageContext,l=s.listId,d=void 0===l?"":l,c=s.listUrl,u=void 0===c?"":c,p=s.siteId,m=void 0===p?"":p,h=s.webId,f=void 0===h?"":h,g=s.currentLanguage,y=void 0===g?1033:g;d=d||new x.default(window.location.href.toLowerCase()).getQueryParameter("listid");if(u=u||new x.default(window.location.href.toLowerCase()).getQueryParameter("listurl")){var v=C.getSafeWebServerRelativeUrl(b._pageContext);0!==(u=u.substring(v.length)).indexOf("/")&&(u="/"+u);u=b._pageContext.webAbsoluteUrl+u}b._siteQueryPlugin=new o(y,m,f,d,u,b._useEnableDynamicGroups);b._siteQueryPlugin.setPath(b._path);b._siteQueryPlugin.initialize(b._pluginService)}new n.ExportPlugin([b._pluginToUse],b._dataDispatcher(),b._errorDispatcher()).initialize(b._pluginService);b._searchPromises=new S.default;b._initialized=!0}_({oilCore:b._oilCore,pluginService:b._pluginService})})})}).then(function(e){if(!o){var t=new e.oilCore.Query({term:d});b._searchPromises.registerPromise(d,t.getId(),i,r);e.pluginService.setQuery(t)}},function(e){o=!0})},function(){o=!0;b._searchPromises.unregisterPromise(null)})};e.prototype.upscopeSearch=function(e){if(e){var t=this._navigation;if(this._showSearchPage){var i=this._urlDataSource;t.navigateTo({url:i.getSearchQueryUrl(e)})}else this._searchCenterDataSource.getSearchCenterResultsUrl(e).done(function(e){t.navigateTo({url:e,frameId:"_blank"})},function(e){o.default.log(e)})}};e.prototype.searchResultClicked=function(e){};e.prototype.setPath=function(e){if(e){var t=C.getSafeWebServerRelativeUrl(this._pageContext);this._path=x.default.concatenate(this._pageContext.webAbsoluteUrl,e.substring(t.length))}else this._path=null;this._siteQueryPlugin&&this._siteQueryPlugin.setPath(this._path)};e.prototype._convertIOneDriveItemToISearchResult=function(e){var t=this._getAriaLabelForSearchResult(e);return{iconName:e.iconName,parentUrl:e.parentLink,title:e.displayName,titleText:e.displayName,titleAriaLabel:t||e.displayName,url:e.openUrl||e.properties.path,key:e.type===s.default.Folder&&this._pageContext.userDisplayName===e.creatorName?e.key:void 0,type:1,parentFolder:e.location,lastModifiedBy:e.editorName,lastModifiedDateDisplay:e.dateModified}};e.prototype._getAriaLabelForSearchResult=function(e){var t=e.type===s.default.Folder?T.strings.FolderAriaLabel:T.strings.FileAriaLabel;return I.format(t,e.displayName,e.location,e.dateModified,e.editorName)};e.prototype._getSearchDataSource=function(){return this.resources.consumeAsync(_.resourceKey)};e.prototype._isODBLibrary=function(){return Number(this._pageContext.webTemplate)===k.default.mySite&&this._pageContext.isSiteAdmin};e.prototype._isOneNoteFolder=function(e){return e.isContainer&&-1!==e.clickurl.toLowerCase().indexOf("wopiframe")&&-1!==e.clickurl.toLowerCase().indexOf("/_layouts/")};e.prototype._dataDispatcher=function(){var u=this,p=!1;if(this.resources.isExposed(d.listContext)){var e=this._listContext;p=e&&e.isDocLib}return function(e){var c=e.queryId,t=function(e){var t=u._searchPromises.getPromiseData(c);if(t){for(var i=e.length,r=0;r<i;r++){var o,n=e[r];o=p?n.clickurl:n.url;if(n.fileextension&&"one"===n.fileextension.toLowerCase()||u._isOneNoteFolder(n)){o+=-1===o.indexOf("?")?"?":"&";o+="wdsearch="+v.default.encodeURIComponent(t.query)}var a=n.title,s=n.fileextension;if(!p&&"aspx"===s){a=a.replace(w,"");s="listitem"}var l=new g.default(a,o,n.image,u._searchResultType);l.summary=n.summary;l.showSummary=l.summary&&-1<l.summary.indexOf("<i>");l.lastModifiedDate=m.iso8601DateTimeToJsDate(n.lastediteddatetime);l.lastModifiedBy=n.rawEditor;l.parentUrl=n.parentlink;var d=h.getIconUrlFromExtension(u.resources,s,48);n.isContainer&&!u._isOneNoteFolder(n)?d=h.getIconUrl(u.resources,"folder",48):n.isContainer&&(d=h.getIconUrl(u.resources,"onetoc",48));l.iconUrl=d;n.folderbreadcrumb&&0<n.folderbreadcrumb.length&&(l.parentFolder=decodeURI(n.folderbreadcrumb[n.folderbreadcrumb.length-1]));t.results.push(l)}u._engagement.logData({name:"Search.QueryboxNumResults",extraData:{count:i}});u._searchPromises.setPromiseData(c,t)}else;},i={sitequery:t,mydocuments:t};e.processNewData(i);if(e.complete){var r=u._searchPromises.getPromiseData(c);r&&u._searchCenterDataSource.getSearchCenterUrl().done(function(e){var t=u._transferResults(r,e);u._searchPromises.unregisterPromise(c);r.completeCallback(t)},r.errorCallback)}}};e.prototype._errorDispatcher=function(){var n=this;return function(e){console.log("Search error.");var t,i=n._searchPromises.getAllPromiseKeys();for(var r in i){var o=i[r];if(t=n._searchPromises.getPromiseData(o)){n._searchPromises.unregisterPromise(o);if(t.errorCallback){t.errorCallback(e.originalError.message);console.log("Search error details: "+e.originalError.message)}}}}};e.prototype._transferResults=function(e,t){var i;e&&(i={query:e.query,containers:[{results:e.results}],upscopeAvailable:!!e.query&&!!t});return i};e.dependencies=i.__assign({},r.default.dependencies,{urlDataSource:l.url,itemsStore:b.resourceKey,pageContext:d.pageContext,searchCenterDataSource:a.resourceKey,navigation:y.navigation,listContext:d.listContext.optional,engagement:p.resourceKey,searchBehavior:d.searchBehavior.optional,viewParams:u.viewParams});return e}(r.default);t.default=E;t.resourceKey=f.createResolvedResourceKey(e("module").id,E)});define("Vn",["require","exports","aC","dJ","fZ","gl","bA"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._urlCached=!1;this._searchCenterUrl=null;this._apiUrlHelper=t.apiUrlHelper;this._dataRequestor=new t.dataRequestorType({qosName:"SearchCenterDataSource"})}e.prototype.getSearchCenterUrl=function(){var t=this;return this._urlCached?i.default.wrap(this._searchCenterUrl):this._dataRequestor.getData({url:this._apiUrlHelper.build().segment("search").segment("searchCenterUrl").toString(),qosName:"GetSearchCenterUrl",method:"POST"}).then(function(e){return e.d.searchcenterurl}).then(function(e){t._searchCenterUrl=e;t._urlCached=!0;return e})};e.prototype.getSearchCenterResultsUrl=function(t){return this.getSearchCenterUrl().then(function(e){return e?e+"/results.aspx?"+r.serializeQuery({k:t}):i.default.wrapError(new Error("Cannot upscope search. Caller must use the upscopeAvailable property of the returned ISearchData to determine if calling upscopeSearch is acceptable."))})};return e}();t.default=s;t.resourceKey=a.createResolvedResourceKey(e("module").id,s,{apiUrlHelper:o.resourceKey,dataRequestorType:n.typeResourceKey})});define("Vm",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._activePromises={}}e.prototype.registerPromise=function(e,t,i,r){this._activePromises[t];this._activePromises[t]={query:e,id:t,completeCallback:i,errorCallback:r,results:[]}};e.prototype.unregisterPromise=function(e){delete this._activePromises[e]};e.prototype.setPromiseData=function(e,t){this._activePromises[e]=t};e.prototype.getPromiseData=function(e){return this._activePromises[e]};e.prototype.getAllPromiseKeys=function(){return Object.keys(this._activePromises)};return e}();t.default=i});define("Vl",["require","exports","a6"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t,i,r){this.title=e;this.url=t;this.iconUrl=i;this.type=r||6;this.titleText=o.default.getTextFromHtml(e);this.titleAriaLabel=this.titleText};t.default=i});define("Vo",["require","exports","ap","bO","Vs","Vr","Vq","Vp","bA"],function(e,t,i,r,o,n,a,l,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(s){i.__extends(e,s);function e(e,t){var i=s.call(this,e,t)||this,r=t.arrangeCommandHelperType,o=t.filterCommandHelperType,n=t.groupCommandHelperType,a=t.sortCommandHelperType;i._column=e.column;i._engagementName=e.engagementName||"";r&&(i._operationCommandHelper=new(i.scope.attached(r))({column:i._column,engagementName:i._engagementName}));i._column.filterable&&o&&(i._filterCommandHelper=new(i.scope.attached(o))({column:i._column,engagementName:i._engagementName}));i._column.groupable&&(i._groupCommandHelper=new(i.scope.attached(n))({column:i._column,engagementName:i._engagementName}));i._column.sortable&&(i._sortCommandHelper=new(i.scope.attached(a))({column:i._column,engagementName:i._engagementName}));i.commands=i._getCommands();return i}e.prototype.getColumnMenu=function(e){return this.commands};e.prototype._getCommands=function(){var e=[];this._sortCommandHelper&&e.push.apply(e,this._sortCommandHelper.commands);this._filterCommandHelper&&e.push.apply(e,this._filterCommandHelper.commands);this._groupCommandHelper&&e.push(this._groupCommandHelper.command);this._operationCommandHelper&&e.push(this._operationCommandHelper.command);return e};e.dependencies=i.__assign({},r.default.dependencies,{arrangeCommandHelperType:o.typeResourceKey.local.optional,filterCommandHelperType:n.typeResourceKey.local.optional,groupCommandHelperType:a.typeResourceKey.local,sortCommandHelperType:l.typeResourceKey.local});return e}(r.default);t.ColumnMenuHelper=d;t.typeResourceKey=new s.ResourceKey({name:""+e("module").id,factory:new s.ResolvedResourceTypeFactory(d)});t.default=d});define("Vs",["require","exports","ap","bO","hK","rs","ex","bX","or","ot","IO","bA","VD","Vt","ba","bf"],function(e,t,i,r,g,o,y,n,l,v,_,a,d,c,b,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=["Text","Number","Choice","User","Boolean","URL","Title","DateTime","Lookup","Name","ComplianceRecordFlag"],C={Hyperlink:"URL",Image:"URL"},s=function(s){i.__extends(e,s);function e(e,t){var i=s.call(this,e,t)||this,r=e.column;i._engagementName=e.engagementName;i._actionMap=t.actionMap;i._addCommandHelperType=t.addCommandHelperType;i._editCommandHelperType=t.editCommandHelperType;i._canModifySchema=t.canModifySchema;var o=i._commandViewModelType=i.scope.attached(t.commandViewModelType),n=l.getFieldName(r),a=i._getColumnOperationCommands(r,n);i.command=new o({text:v.strings.columnMenuColumnSettings,collapseSingleChildCommands:!1,requiredChildren:1,hasLineBreakBefore:!0,children:a});return i}e.prototype._getColumnOperationCommands=function(e,t){var i=[],r=b.isFeatureEnabled(b.CreateColumnPanels),o=b.isFeatureEnabled(b.CreateCurrencyColumnPanel),n=b.isFeatureEnabled(b.CustomFormatter),a=b.isFeatureEnabled(b.CreateDateTimeColumnPanel);if(this._canModifySchema.peek()){var s=this._actionMap,l=this._commandViewModelType,d=C[y.ColumnFieldType[e.fieldType]]||y.ColumnFieldType[e.fieldType],c=void 0;if(x.Killswitch.isActivated("FE058A0D-BF54-4219-A126-AD48F0CB8C43","03/21/2018","Refactor SupportedPanelTypes")){m=r&&-1!==_.SUPPORTED_PANEL_TYPES.indexOf(d)&&!e.isCalculated&&e.editable;var u=o&&-1!==_.SUPPORTED_PANEL_TYPES_2.indexOf(d)&&!e.isCalculated&&e.editable,p=a&&-1!==_.SUPPORTED_PANEL_TYPES_3.indexOf(d)&&!e.isCalculated&&e.editable;c=m||u||p}else{var m;c=m=-1!==_.FieldTypeSwitcherHelper.getSupportedPanelTypes().indexOf(d)&&!e.isCalculated&&e.editable}c?i.push(new l({text:v.strings.columnMenuEdit,engagementName:"Edit"+(y.ColumnFieldType[e.fieldType]||"Other")+"Field"+this._engagementName,action:new(this.child(s.LaunchColumnManagementPanelAction))({editField:{fieldName:t},isHyperlink:e.fieldType===y.ColumnFieldType.Hyperlink})})):i.push(new l({text:v.strings.columnMenuRename,engagementName:"RenameColumn"+this._engagementName,action:new(this.child(s.RenameColumnAction))({internalName:t,id:e.id,currentDisplayName:e.name})}));n&&-1!==S.indexOf(d)&&i.push(new l({text:v.strings.columnMenuFormat,engagementName:"Customize"+y.ColumnFieldType[e.fieldType]+"Field"+this._engagementName,action:new(this.child(s.LaunchColumnCustomizationPaneAction))({column:e})}));i.push(new l({text:v.strings.columnMenuMoveLeft,engagementName:"MoveLeft"+this._engagementName,action:new(this.child(s.ModifyColumnAction))({action:2,fieldToActOn:t})}),new l({text:v.strings.columnMenuMoveRight,engagementName:"MoveLeft"+this._engagementName,action:new(this.child(s.ModifyColumnAction))({action:3,fieldToActOn:t})}));"LinkFilename"!==t&&"LinkTitle"!==t&&i.push(new l({text:v.strings.columnMenuHideThisColumn,engagementName:"HideColumn"+this._engagementName,action:new(this.child(s.ModifyColumnAction))({action:0,fieldToActOn:t})}));if(e.filterable){i.push(new l({text:v.strings.columnMenuPinToFiltersPane,engagementName:"PinToFiltersPane"+this._engagementName,action:new(this.child(this._actionMap.ModifyShowInFiltersPaneAction))({column:e,showInFiltersPane:g.ShowInFiltersPaneStatus.Pinned})}));i.push(new l({text:v.strings.columnMenuUnpinFromFiltersPane,engagementName:"UnpinFromFiltersPane"+this._engagementName,action:new(this.child(this._actionMap.ModifyShowInFiltersPaneAction))({column:e,showInFiltersPane:g.ShowInFiltersPaneStatus.Auto})}))}var h=new(this.scope.attached(this._editCommandHelperType))({engagementName:this._engagementName});i.push(h.command);var f=new(this.scope.attached(this._addCommandHelperType))({column:e,engagementName:this._engagementName,includeColumnEditor:!1});i.push(new l({text:v.strings.columnMenuCreate,requiredChildren:1,children:f.commands.slice()}))}return i};e.dependencies=i.__assign({},r.default.dependencies,{actionMap:n.actionMap,addCommandHelperType:d.typeResourceKey.local,editCommandHelperType:c.typeResourceKey.local,commandViewModelType:o.typeResourceKey,canModifySchema:n.canModifySchema});return e}(r.default);t.ArrangeColumnCommandHelper=s;t.typeResourceKey=new a.ResourceKey({name:""+e("module").id,factory:new a.ResolvedResourceTypeFactory(s)});t.default=s});define("IO",["require","exports","ap","Jo","IR","IQ","IP"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t)});define("Jo",["require","exports","ap","at","IR","Du","jP","wN","xH","Jp"],function(e,t,i,r,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){return r.createElement(n.Panel,i.__assign({},this.props.panelProps,{className:a.css("ms-ColumnManagementPanel",{hidden:!this.props.showPanel},{loading:this.props.isContentLoading}),onRenderFooterContent:this._onRenderFooterContent}),r.createElement(o.ColumnManagementPanelContent,i.__assign({},this.props.columnManagementPanelContentProps,{ref:this._resolveRef("_panelContent")})))};e.prototype.componentDidMount=function(){this._events.on(window,"keydown",this._onKeyDown.bind(this))};e.prototype.componentDidUpdate=function(e,t){var i=this;e.showPanel||!this.props.showPanel||this.props.isContentLoading?e.isContentLoading&&!this.props.isContentLoading&&this.props.showPanel&&setTimeout(function(){return i._panelContent&&i._panelContent.focusFirstElement()},25):setTimeout(function(){return i._panelContent&&i._panelContent.focusFirstElement()},25)};e.prototype._onRenderFooterContent=function(){return r.createElement("div",{className:"ms-ColumnManagementPanel-footer"},this.props.isEditPanel?this._editFooterButtons():this._createFooterButtons(),r.createElement("div",{role:"region","aria-live":"polite",className:this.props.errorMessage?"ms-ColumnManagementPanel-error":""},this.props.errorMessage&&r.createElement("span",null,this.props.errorMessage)))};e.prototype._createFooterButtons=function(){var e=this.props.columnManagementPanelContentProps.strings;return r.createElement("div",null,r.createElement(s.PrimaryButton,{className:"ms-ColumnManagementPanel-saveButton",disabled:!!this.props.saveDisabled&&this.props.saveDisabled,onClick:this._onSaveClick},e.saveButtonText),r.createElement(s.DefaultButton,{className:"ms-ColumnManagementPanel-cancelButton",onClick:this.props.onDismiss},e.cancelButtonText))};e.prototype._editFooterButtons=function(){var e=this.props.columnManagementPanelContentProps.strings,t=r.createElement(l.Dialog,{className:"ms-ColumnManagementPanel-confirmDeleteDialog",isOpen:this.props.confirmDeleteDialogIsOpen,type:l.DialogType.close,onDismiss:this.props.showHideConfirmDeleteDialog,title:e.confirmDeleteDialogTitle,subText:e.confirmDeleteDialogText,isBlocking:!1,closeButtonAriaLabel:e.closeButtonAriaLabel},r.createElement(l.DialogFooter,null,r.createElement(s.PrimaryButton,{className:"ms-ColumnManagementPanel-confirmDeleteButton",disabled:!!this.props.deleteDisabled&&this.props.deleteDisabled,onClick:this.props.onDelete},e.deleteButtonText),r.createElement(s.DefaultButton,{className:"ms-ColumnManagementPanel-cancelDialogButton",onClick:this.props.showHideConfirmDeleteDialog},e.cancelButtonText))),i=r.createElement(l.Dialog,{className:"ms-ColumnManagementPanel-confirmSaveDialog",isOpen:this.props.confirmSaveDialogIsOpen,type:l.DialogType.close,onDismiss:this.props.hideConfirmSaveDialog,title:e.confirmSaveDialogTitle,subText:this.props.confirmSaveDialogText,isBlocking:!1,closeButtonAriaLabel:e.closeButtonAriaLabel},r.createElement(l.DialogFooter,null,r.createElement(s.PrimaryButton,{className:"ms-ColumnManagementPanel-confirmSaveButton",onClick:this._onSaveConfirmClick},e.saveButtonText),r.createElement(s.DefaultButton,{className:"ms-ColumnManagementPanel-cancelDialogButton",onClick:this.props.hideConfirmSaveDialog},e.cancelButtonText)));return r.createElement("div",null,r.createElement(s.PrimaryButton,{className:"ms-ColumnManagementPanel-saveButton",disabled:!!this.props.saveDisabled&&this.props.saveDisabled,onClick:this._onSaveClick},e.saveButtonText),r.createElement(s.DefaultButton,{className:"ms-ColumnManagementPanel-cancelButton",onClick:this.props.onDismiss},e.cancelButtonText),r.createElement(s.DefaultButton,{className:"ms-ColumnManagementPanel-deleteButton",onClick:this.props.showHideConfirmDeleteDialog},e.deleteButtonText),this.props.confirmDeleteDialogIsOpen?t:null,this.props.confirmSaveDialogIsOpen?i:null)};e.prototype._onSaveClick=function(){var r=this;this._panelContent.onSaveClick().then(function(){var e=r._panelContent.getFieldOptions(),t=r._panelContent.getFieldCreationSchema();if(t){var i=r.props.isEditPanel?r._panelContent.getDataLossWarning(t):null;i?r.props.showConfirmSaveDialog(i):r.props.onSave({fieldData:{fieldSchema:t,fieldOptions:e}})}},function(e){r.props.onSave({error:e})})};e.prototype._onSaveConfirmClick=function(){var e=this._panelContent.getFieldCreationSchema();e&&this.props.onSave({fieldData:{fieldSchema:e}})};e.prototype._onKeyDown=function(e){27===e.which&&this.props.panelProps.onDismiss();e.stopPropagation()};i.__decorate([a.autobind],e.prototype,"_onRenderFooterContent",null);i.__decorate([a.autobind],e.prototype,"_createFooterButtons",null);i.__decorate([a.autobind],e.prototype,"_editFooterButtons",null);i.__decorate([a.autobind],e.prototype,"_onSaveClick",null);i.__decorate([a.autobind],e.prototype,"_onSaveConfirmClick",null);i.__decorate([a.autobind],e.prototype,"_onKeyDown",null);return e}(a.BaseComponent);t.ColumnManagementPanel=d});define("IR",["require","exports","ap","at","aI","IQ","IP","I6","IW","IS","jP","BT","o1","mh","GL","V","aC","bf"],function(e,t,n,r,o,a,s,l,d,c,u,p,m,h,f,g,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _={Choice:{showAllowMultipleToggle:!0,showEnforceUniqueToggle:!0},User:{showAllowMultipleToggle:!0,showEnforceUniqueToggle:!0},Number:{showEnforceUniqueToggle:!0},Note:{showUnlimitedLengthInDocumentLibraryToggle:!0},Text:{showEnforceUniqueToggle:!0},Currency:{showEnforceUniqueToggle:!0},DateTime:{showEnforceUniqueToggle:!0}},b=["Choice","Number","Text","Currency","DateTime"],i=function(i){n.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._defaultsHelper=new a.ColumnManagementPanelDefaultsHelper;t._fieldTypeSwitcherHelper=new s.FieldTypeSwitcherHelper;t.state={isLoading:!0,failedToLoad:!1,isHyperlink:t.props.isHyperlink};t._formulaLearnMoreLink="https://o15.officeredir.microsoft.com/r/rlidOfficeWebHelp?p1=SPOStandard&clid="+t.props.currentLanguage+"&ver=16&HelpId=WSSEndUser_FormulaSyntaxError";t._titleLearnMoreLink="https://o15.officeredir.microsoft.com/r/rlidOfficeWebHelp?p1=SPOStandard&clid="+t.props.currentLanguage+"&ver=16&HelpId=WSSEndUser_CreateColumnPanelTitle";return t}e.prototype.componentDidMount=function(){var i=this,r=this.props.isEditPanel?new o.Qos({name:"ColumnManagementPanel.LoadColumnData"}):null;this._defaultsHelper.getCurrentValues(this.props.strings,this.props.currentValuesPromise,this.props.fieldType,this.props.currentLocale).then(function(e){i._currentValues=e;var t=-1!==b.indexOf(f.FieldType[e.fieldType]);i.setState({isLoading:!1,showMoreOptions:!1,validateMoreOptions:!1,showColumnValidation:!1,supportsValidation:t,showColumnValidationLink:!e.allowMultipleSelection&&t,allowMultipleSelection:e.allowMultipleSelection,name:e.name,fieldType:e.fieldType});i.props.updateParentStateWithCurrentValues&&i.props.updateParentStateWithCurrentValues(e);r&&r.end({resultType:o.ResultTypeEnum.Success})},function(e){i.setState({isLoading:!1,failedToLoad:!0});r&&r.end({resultType:o.ResultTypeEnum.Failure,error:e})})};e.prototype.componentDidUpdate=function(e,t){!e.duplicateColumnName&&this.props.duplicateColumnName&&this._name.focus()};e.prototype.render=function(){var e,t=this.props.strings;this.state.isLoading||this.state.failedToLoad||(e=this.props.isEditPanel?f.FieldType[this._currentValues.fieldType]:"Create");return r.createElement("div",null,this.state.isLoading&&r.createElement(m.Spinner,{className:"ms-ColumnManagementPanel-spinner",type:m.SpinnerType.large}),r.createElement("div",{role:"region","aria-live":"polite",className:"ms-ColumnManagementPanel-loadingError"},this.state.failedToLoad&&r.createElement("span",null,t.failureToLoadEditPanel)),!this.state.isLoading&&!this.state.failedToLoad&&r.createElement("div",{className:"ms-ColumnManagementPanel-content"},r.createElement("div",{className:"ms-ColumnManagementPanel-titleLearnMore"},r.createElement(h.Link,{href:this._titleLearnMoreLink,target:"_blank"},this.props.isEditPanel?t.editPanelTitleLearnMore:t.titleLearnMore)),r.createElement(p.TextField,{className:"ms-ColumnManagementPanel-nameTextField",label:t.nameLabel,required:!0,defaultValue:this.state.name,onChanged:this._nameChanged,errorMessage:this.props.duplicateColumnName?t.duplicateColumnNameError:"",ref:this._resolveRef("_name")}),r.createElement(p.TextField,{className:"ms-ColumnManagementPanel-descriptionTextField",label:t.descriptionLabel,defaultValue:this._currentValues.description,multiline:!0,rows:3,ref:this._resolveRef("_description")}),r.createElement(c.FieldTypeSwitcher,{className:u.css("ms-ColumnManagementPanel-fieldTypeSwitcher",{noUniqueFields:this.state.fieldType===f.FieldType.URL}),strings:this.props.strings,supportedTypes:this._fieldTypeSwitcherHelper.getAllowedTypeSwitches(e),fieldType:this.state.fieldType,updateFieldType:this._updateFieldType,isHyperlink:this.state.isHyperlink}),this.state.fieldType===f.FieldType.Choice&&r.createElement(l.ChoiceColumnUniqueFields,{choicesText:this._currentValues.choicesText,defaultValue:this._currentValues.defaultChoiceValue,defaultFormula:this._currentValues.defaultFormula,useCalculatedDefaultValue:this._currentValues.useCalculatedDefaultValue,formulaLearnMoreLink:this._formulaLearnMoreLink,fillInChoice:this._currentValues.fillInChoice,strings:this.props.strings,updateSaveDisabled:this._componentUpdateSaveDisabled,ref:this._resolveRef("_uniqueFields")}),this.state.fieldType===f.FieldType.User&&r.createElement(l.UserColumnUniqueFields,{strings:this.props.strings,selectionMode:this._currentValues.selectionMode,ref:this._resolveRef("_uniqueFields")}),this.state.fieldType===f.FieldType.Number&&r.createElement(l.NumberColumnUniqueFields,{defaultValue:this._currentValues.defaultValue,defaultFormula:this._currentValues.defaultFormula,useCalculatedDefaultValue:this._currentValues.useCalculatedDefaultValue,showAsPercentage:this._currentValues.showAsPercentage,displayFormat:this._currentValues.displayFormat,formulaLearnMoreLink:this._formulaLearnMoreLink,strings:this.props.strings,ref:this._resolveRef("_uniqueFields")}),this.state.fieldType===f.FieldType.Boolean&&r.createElement(l.BooleanColumnUniqueFields,{defaultValue:this._currentValues.defaultValue,strings:this.props.strings,ref:this._resolveRef("_uniqueFields")}),(this.state.fieldType===f.FieldType.Text||this.state.fieldType===f.FieldType.Note)&&r.createElement(c.DefaultValueEntryField,{defaultValue:this._currentValues.defaultValue,defaultFormula:this._currentValues.defaultFormula,useCalculatedDefaultValue:this._currentValues.useCalculatedDefaultValue,strings:this.props.strings,defaultValuePlaceholder:this.props.strings.defaultValuePlaceholder,defaultValueAriaLabel:this.props.strings.defaultValueAriaLabel,formulaLearnMoreLink:this._formulaLearnMoreLink,ref:this._resolveRef("_uniqueFields")}),this.state.fieldType===f.FieldType.Currency&&r.createElement(l.CurrencyColumnUniqueFields,{defaultValue:this._currentValues.defaultValue,defaultFormula:this._currentValues.defaultFormula,useCalculatedDefaultValue:this._currentValues.useCalculatedDefaultValue,currencyListPromise:this.props.currencyListPromise,displayFormat:this._currentValues.displayFormat,formulaLearnMoreLink:this._formulaLearnMoreLink,strings:this.props.strings,currencyLocaleId:this._currentValues.currencyLocaleId,ref:this._resolveRef("_uniqueFields")}),this.state.fieldType===f.FieldType.DateTime&&r.createElement(l.DateTimeColumnUniqueFields,{pageContext:this.props.pageContext,defaultValue:this._currentValues.defaultValue,defaultFormula:this._currentValues.defaultFormula,useCalculatedDefaultValue:this._currentValues.useCalculatedDefaultValue,regionalDateTimeSchemaPromise:this.props.regionalDateTimeSchemaPromise,displayFormat:this._currentValues.displayFormat,friendlyDisplayFormat:this._currentValues.friendlyDisplayFormat,formulaLearnMoreLink:this._formulaLearnMoreLink,strings:this.props.strings,ref:this._resolveRef("_uniqueFields")}),r.createElement("div",{className:"ms-ColumnManagementPanel-moreOptionsButton"},r.createElement(h.Link,{onClick:this._showHideMoreOptions,"aria-expanded":this.state.showMoreOptions,"aria-controls":"moreOptions"},t.moreOptionsButtonText)),this._moreOptions()))};e.prototype._moreOptions=function(){var e=this.props.strings,t=_[f.FieldType[this.state.fieldType]],i={allowMultipleSelection:this._currentValues.allowMultipleSelection,enforceUniqueValues:this._currentValues.enforceUniqueValues,unlimitedLengthInDocumentLibrary:this._currentValues.unlimitedLengthInDocumentLibrary,required:this._currentValues.required,updateShowColumnValidationState:this._updateShowColumnValidationState,strings:e,fieldType:this.state.fieldType,showEnforceUniqueToggle:t&&t.showEnforceUniqueToggle,showAllowMultipleToggle:t&&t.showAllowMultipleToggle,showUnlimitedLengthInDocumentLibraryToggle:t&&t.showUnlimitedLengthInDocumentLibraryToggle&&this.props.isDocumentLibrary,isEditPanel:this.props.isEditPanel};return r.createElement("div",{className:u.css("ms-ColumnManagementPanel-moreOptions",{hidden:!this.state.showMoreOptions}),id:"moreOptions"},(this.state.fieldType===f.FieldType.Number||this.state.fieldType===f.FieldType.Currency)&&r.createElement(d.NumberColumnMoreOptions,{minimumValue:this._currentValues.minimumValue,maximumValue:this._currentValues.maximumValue,strings:this.props.strings,showMoreOptions:this._showMoreOptions,clearValidateMoreOptions:this._clearValidateMoreOptions,validateMoreOptions:this.state.validateMoreOptions,ref:this._resolveRef("_typeMoreOptions")}),this.state.fieldType===f.FieldType.Text&&r.createElement(d.TextColumnMoreOptions,{maxLength:this._currentValues.maxLength,strings:this.props.strings,showMoreOptions:this._showMoreOptions,ref:this._resolveRef("_typeMoreOptions")}),this.state.fieldType===f.FieldType.Note&&r.createElement(d.NoteColumnMoreOptions,{numberOfLines:this._currentValues.numberOfLines,showMoreOptions:this._showMoreOptions,strings:this.props.strings,isDocumentLibrary:this.props.isDocumentLibrary,richText:this._currentValues.richText,appendOnly:this._currentValues.appendOnly,enableVersions:this.props.enableVersions,ref:this._resolveRef("_typeMoreOptions")}),r.createElement(d.BaseMoreOptions,n.__assign({},i,{ref:this._resolveRef("_baseMoreOptions")})),r.createElement("div",{role:"region","aria-live":"polite","aria-relevant":"all",className:"ms-ColumnManagementPanel-columnValidationButton"},this.state.showColumnValidationLink&&r.createElement(h.Link,{onClick:this._columnValidationClick,"aria-expanded":this.state.showColumnValidation,"aria-controls":"columnValidation"},e.columnValidationButtonText)),this._columnValidation())};e.prototype._columnValidation=function(){var e=this.props.strings;return r.createElement("div",{className:u.css("ms-ColumnManagementPanel-columnValidation",{hidden:!this.state.showColumnValidation}),id:"columnValidation"},r.createElement("div",{className:"ms-ColumnManagementPanel-validationGuideText"},e.columnValidationGuideText),r.createElement("div",{className:"ms-ColumnManagementPanel-learnMoreLink"},r.createElement(h.Link,{href:this._formulaLearnMoreLink,target:"_blank"},e.formulaLearnMoreLink)),r.createElement(p.TextField,{className:"ms-ColumnManagementPanel-formulaTextField",label:e.formulaLabel,defaultValue:this._currentValues.validationFormula,multiline:!0,rows:5,ref:this._resolveRef("_validationFormula")}),r.createElement(c.InfoTeachingIcon,{className:"ms-ColumnManagementPanel-messageGuideText",label:e.userMessageLabel,calloutContent:e.userMessageGuideText,infoButtonAriaLabel:e.infoButtonAriaLabelFormat?g.format(e.infoButtonAriaLabelFormat,e.userMessageLabel):e.infoButtonAriaLabel}),r.createElement(p.TextField,{className:"ms-ColumnManagementPanel-userMessageTextField",ariaLabel:e.userMessageLabel,defaultValue:this._currentValues.validationMessage,multiline:!0,rows:3,ref:this._resolveRef("_userMessage")}))};e.prototype.getFieldCreationSchema=function(){var e,t=this._baseMoreOptions.getSchemaValues(),i=this._typeMoreOptions&&this._typeMoreOptions.getSchemaValues(),r=this._uniqueFields&&this._uniqueFields.getSchemaValues();if(this._typeMoreOptions&&!i||this._uniqueFields&&!r)return!1;e=v.Killswitch.isActivated("2A87C40B-2AF2-44EE-87FE-5CE425BA0AC6","3/29/2018","Add ClientSideComponentId to field schema")?{DisplayName:this.state.name,Title:this.state.name,Description:this._description.value,CustomFormatter:this._currentValues.customFormatter}:{DisplayName:this.state.name,Title:this.state.name,Description:this._description.value,CustomFormatter:this._currentValues.customFormatter,ClientSideComponentId:this._currentValues.clientSideComponentId};!this.state.allowMultipleSelection&&this.state.supportsValidation&&(e.Validation={Formula:this._validationFormula.value,Message:this._userMessage.value});var o=n.__assign({},t,e,r&&r,i&&i);if(this.state.fieldType===f.FieldType.User){o.UserSelectionScope=this._currentValues.selectionGroup;o.ShowField=this._currentValues.lookupField;o.List="UserInfo"}this.state.fieldType===f.FieldType.URL&&(o.Format=this.state.isHyperlink?"Hyperlink":"Image");return o};e.prototype.onSaveClick=function(){return this._uniqueFields&&this._uniqueFields.onSaveClick&&this._uniqueFields.onSaveClick()||y.default.wrap()};e.prototype.getFieldOptions=function(){return this._baseMoreOptions.getFieldOptions()};e.prototype.getDataLossWarning=function(e){var t=this.props.strings,i=f.FieldType[e.Type];if("MultiChoice"===this._currentValues.originalType&&"Choice"===i)return t.multipleToSingleChoiceWarning;if("UserMulti"===this._currentValues.originalType&&"User"===i)return t.multipleToSingleUserWarning;if(!0===this._currentValues.richText&&!1===e.RichText)return t.richTextToPlainTextWarning;if(this._fieldTypeSwitcherHelper.getCouldResultInDataLoss(this._currentValues.originalType,i)){var r=t["displayName"+this._currentValues.originalType.replace("Multi","")],o=t["displayName"+i.replace("Multi","")];return g.format(t.switchTypeWarningFormat,r,o)}return null};e.prototype.focusFirstElement=function(){this._name.focus();var e=this._name.value.length;this._name.setSelectionRange(e,e)};e.prototype._showHideMoreOptions=function(){var t=!(!this._validationFormula.value&&!this._userMessage.value);this.setState(function(e){return n.__assign({showMoreOptions:!e.showMoreOptions},!e.showMoreOptions&&{showColumnValidation:e.supportsValidation&&t})})};e.prototype._showMoreOptions=function(e){var t=!(!this._validationFormula.value&&!this._userMessage.value);this.setState(function(e){return{showMoreOptions:!0,showColumnValidation:e.supportsValidation&&t,validateMoreOptions:!0}},e)};e.prototype._clearValidateMoreOptions=function(){this.setState({validateMoreOptions:!1})};e.prototype._updateFieldType=function(t,i){var r=-1!==b.indexOf(f.FieldType[t]),e=_[f.FieldType[t]],o=e&&e.showAllowMultipleToggle;this.setState(function(e){return n.__assign({fieldType:t,supportsValidation:r,showMoreOptions:!1,showColumnValidationLink:o?!e.allowMultipleSelection&&r:r},void 0!==i&&{isHyperlink:i})})};e.prototype._updateShowColumnValidationState=function(t){var i=!(!this._validationFormula.value&&!this._userMessage.value);this.setState(function(e){return{allowMultipleSelection:t,showColumnValidationLink:!t&&e.supportsValidation,showColumnValidation:!t&&(e.supportsValidation&&i)}})};e.prototype._columnValidationClick=function(){this.setState(function(e){return{showColumnValidation:!e.showColumnValidation}})};e.prototype._componentUpdateSaveDisabled=function(e){this.props.updateSaveDisabled(this.state.name,e)};e.prototype._nameChanged=function(e){this.props.duplicateColumnName&&this.props.onClearError&&this.props.onClearError();this.setState({name:e});var t=this._uniqueFields&&this._uniqueFields.getRequiredValues&&this._uniqueFields.getRequiredValues();this.props.updateSaveDisabled(e,t)};n.__decorate([u.autobind],e.prototype,"componentDidMount",null);n.__decorate([u.autobind],e.prototype,"_moreOptions",null);n.__decorate([u.autobind],e.prototype,"_columnValidation",null);n.__decorate([u.autobind],e.prototype,"getFieldCreationSchema",null);n.__decorate([u.autobind],e.prototype,"getFieldOptions",null);n.__decorate([u.autobind],e.prototype,"getDataLossWarning",null);n.__decorate([u.autobind],e.prototype,"focusFirstElement",null);n.__decorate([u.autobind],e.prototype,"_showHideMoreOptions",null);n.__decorate([u.autobind],e.prototype,"_showMoreOptions",null);n.__decorate([u.autobind],e.prototype,"_clearValidateMoreOptions",null);n.__decorate([u.autobind],e.prototype,"_updateFieldType",null);n.__decorate([u.autobind],e.prototype,"_updateShowColumnValidationState",null);n.__decorate([u.autobind],e.prototype,"_columnValidationClick",null);n.__decorate([u.autobind],e.prototype,"_componentUpdateSaveDisabled",null);n.__decorate([u.autobind],e.prototype,"_nameChanged",null);return e}(u.BaseComponent);t.ColumnManagementPanelContent=i});define("IQ",["require","exports","GL","aC"],function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._formatDefaults={allowMultipleSelection:{serverProperty:"TypeAsString",translateServerValue:function(e){return e&&-1!==e.indexOf("Multi")}},choicesText:{serverProperty:"Choices",translateServerValue:function(e){return e&&e.results&&e.results.join("\n")}},defaultChoiceValue:{serverProperties:["DefaultValue","Choices"],translateServerValue:function(e,t){var i=t&&t.results&&t.results.indexOf(e);return e&&void 0!==i&&-1!==i?{key:String(i+1),text:e}:null}},fieldType:{serverProperty:"TypeAsString",translateServerValue:function(e){return r.FieldType[e.replace("Multi","")]}},maximumValue:{translateServerValue:function(e){return e&&"1.8e+308"!==e.toPrecision(2)?String(e):null}},minimumValue:{translateServerValue:function(e){return e&&"-1.8e+308"!==e.toPrecision(2)?String(e):null}},name:{serverProperty:"Title"},originalType:{serverProperty:"TypeAsString"},useCalculatedDefaultValue:{serverProperty:"DefaultFormula",translateServerValue:function(e){return!!e}}}}e.prototype.getCurrentValueDefaults=function(e,t,i){return{allowMultipleSelection:!1,appendOnly:!1,choicesText:e.choicesPlaceholder,clientSideComponentId:"",currencyLocaleId:i||1033,customFormatter:"",defaultChoiceValue:{key:0,text:e.choiceDefaultValue},defaultFormula:"",defaultValue:"",description:"",displayFormat:-1,enforceUniqueValues:!1,fieldType:t,fillInChoice:!1,friendlyDisplayFormat:-1,lookupField:null,maximumValue:"",maxLength:"255",minimumValue:"",name:"",numberOfLines:"6",originalType:r.FieldType[t],required:!1,richText:!0,selectionGroup:0,selectionMode:0,showAsPercentage:!1,unlimitedLengthInDocumentLibrary:!1,useCalculatedDefaultValue:!1,validationFormula:"",validationMessage:""}};e.prototype.getCurrentValues=function(e,t,i,r){var o=this,n=this.getCurrentValueDefaults(e,i,r);return t?t.then(function(e){for(var t in n){var i=o._getValue(t,e);null!=i&&(n[t]=i)}return n}):a.default.resolve(n)};e.prototype._getValue=function(e,t){var i=this._formatDefaults[e],r=e.charAt(0).toUpperCase()+e.slice(1);if(i&&i.serverProperties&&i.translateServerValue){for(var o=[],n=0,a=i.serverProperties;n<a.length;n++){var s=a[n];o.push(t[s])}return i.translateServerValue.apply(i,o)}var l=i&&i.serverProperty?t[i.serverProperty]:t[r];return void 0!==l&&i&&i.translateServerValue?i.translateServerValue(l):l};return e}();t.ColumnManagementPanelDefaultsHelper=i});define("GL",["require","exports","ap","GM","la"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("GM",["require","exports","ap","ef","GN","bl","bj"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._fieldSchemaXmlHelper=new o.default;t._itemUrlHelper=new n.ItemUrlHelper({},{pageContext:e});t._apiUrlHelper=new a.ApiUrlHelper({},{pageContext:e,itemUrlHelper:t._itemUrlHelper});return t}e.prototype.createField=function(e,t,i){var r=this,o={parameters:{__metadata:{type:"SP.XmlSchemaFieldCreationInformation"},SchemaXml:this._fieldSchemaXmlHelper.getFieldSchemaXml(e),Options:i}};return this.getData(function(){return r._getListApiUrl(t).segment("Fields").segment("CreateFieldAsXml").toString()},function(e){return JSON.parse(e).d.InternalName},"CreateField",function(){return JSON.stringify(o)},"POST")};e.prototype.getFields=function(e){var t=this;return this.getData(function(){return t._getListApiUrl(e).segment("Fields").oDataParameter("$select","Id,InternalName,StaticName,Hidden,Required,Title").toString()},function(e){return JSON.parse(e).d.results.map(function(e){return{id:e.Id,internalName:e.InternalName,isHidden:e.Hidden,isRequired:e.Required,staticName:e.StaticName,title:e.Title}})},"GetFields",null,"GET")};e.prototype.getField=function(e,t){var i=this;return this.getData(function(){return i._getListApiUrl(t).segment("Fields").method("GetByInternalNameOrTitle",e).toString()},function(e){var t=JSON.parse(e);return t&&t.d},"GetField",null,"GET")};e.prototype.editField=function(e,t,i){var r=this,o={__metadata:{type:"SP.Field"},SchemaXml:this._fieldSchemaXmlHelper.getFieldSchemaXml(t)};return this.getData(function(){return r._getListApiUrl(i).segment("Fields").method("GetByInternalNameOrTitle",e).toString()},function(e){return e},"EditField",function(){return JSON.stringify(o)},"MERGE")};e.prototype.deleteField=function(e,t){var i=this;return this.getData(function(){return i._getListApiUrl().segment("Fields").method("GetByInternalNameOrTitle",e).segment("DeleteObject").toString()},function(e){return e},"DeleteField",null,"POST")};e.prototype.getCurrencyList=function(){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/SP.CurrencyList.GetList"},function(e){return JSON.parse(e).d.GetList.Items.results},"SP.CurrencyList.GetList",null,"POST")};e.prototype.getRegionalDateTimeSchema=function(){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/web/GetRegionalDateTimeSchema"},function(e){var t=JSON.parse(e);return JSON.parse(t.d.GetRegionalDateTimeSchema)},"GetRegionalDateTimeSchema",null,"POST")};e.prototype.parseDateTime=function(e,t,i){var r=this,o={value:e,displayFormat:t,calendarType:i};return this.getData(function(){return r._pageContext.webAbsoluteUrl+"/_api/web/ParseDateTime"},function(e){var t=JSON.parse(e);return JSON.parse(t.d.ParseDateTime)},"ParseDateTime",function(){return JSON.stringify(o)},"POST")};e.prototype.setFieldPropertyValueAsString=function(e,t,i,r){var o=this,n={__metadata:{type:"SP.Field"}};n[t]=i;return this.getData(function(){return o._getListApiUrl(r).segment("Fields").method("GetByInternalNameOrTitle",e).toString()},function(e){return e},"setFieldPropertyValueAsString",function(){return JSON.stringify(n)},"MERGE")};e.prototype._getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e||this._pageContext.listUrl,listUrl:e||this._pageContext.listUrl});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)};return e}(i.default);t.ListDataSource=s;t.default=s});define("GN",["require","exports","la","V","U"],function(e,t,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=["AppendOnly","ClientSideComponentId","CustomFormatter","Decimals","Description","DisplayName","EnforceUniqueValues","FillInChoice","FriendlyDisplayFormat","Format","Indexed","IsolateStyles","InternalName","LCID","List","Max","MaxLength","Min","Mult","NumLines","Percentage","Required","RichText","RichTextMode","ShowField","StaticName","Title","Type","UnlimitedLengthInDocumentLibrary","UserSelectionMode","UserSelectionScope"],n=["Choices","DefaultValue","DefaultFormula","Validation"],s=" {0}='{1}'",l="<{0}>{1}</{2}>",d="{0}{1}",c=function(){function e(){var t=this;this._formatProperties={Field:{attributeKeys:o,childElementKeys:n,valueTransformer:function(e){return t.assembleChildElements("Field",e)}},Type:{valueTransformer:function(e){return i.FieldType[e]}},DefaultValue:{nameOverride:"Default"},Choices:{nameOverride:"CHOICES",childElementKeys:["CHOICE"],valueTransformer:function(e){return t.assembleChildElements("Choices",{CHOICE:e},!0)}},Validation:{attributeKeys:["Message"],valueTransformer:function(e){return e.Formula}}}}e.prototype.getFieldSchemaXml=function(e){return this.makeElementSegment("Field",e)};e.prototype.assembleChildElements=function(e,i,r){var o=this;void 0===r&&(r=!1);for(var n="",t=this._formatProperties[e].childElementKeys.filter(function(e){return void 0!==i[e]}),a=function(t){Array.isArray(i[t])&&r?i[t].forEach(function(e){return n+=o.makeElementSegment(t,e)}):n+=s.makeElementSegment(t,i[t])},s=this,l=0,d=t;l<d.length;l++){a(d[l])}return n};e.prototype.assembleAttributes=function(e,t){for(var i="",r=0,o=this._formatProperties[e].attributeKeys.filter(function(e){return void 0!==t[e]});r<o.length;r++){var n=o[r];i+=this.makeAttributeSegment(n,t[n])}return a.format(d,this.getName(e),i)};e.prototype.makeElementSegment=function(e,t){var i=this.getValue(e,t),r=this.getName(e,t),o=this.getName(e);return i||r!==o?a.format(l,r,i,o):""};e.prototype.makeAttributeSegment=function(e,t){var i=this.getValue(e,t),r=this.getName(e);return i?a.format(s,r,i):""};e.prototype.getName=function(e,t){var i=this._formatProperties[e];return i&&i.attributeKeys&&t?this.assembleAttributes(e,t):i&&i.nameOverride?i.nameOverride:e};e.prototype.getValue=function(e,t){var i=this._formatProperties[e],r=i&&i.valueTransformer?i.valueTransformer(t):t;return i&&i.childElementKeys?r:this.formatValue(r)};e.prototype.formatValue=function(e){return"boolean"==typeof e?e.toString().toUpperCase():"string"==typeof e&&e?r.default.encodeText(e):"number"==typeof e?e.toString():null};return e}();t.default=c});define("IP",["require","exports","aW","bf"],function(e,n,a,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.SUPPORTED_PANEL_TYPES=["Choice","User","Boolean","Number","URL","Text","Note"];n.SUPPORTED_PANEL_TYPES_2=["Currency"];n.SUPPORTED_PANEL_TYPES_3=["DateTime"];var t={Create:["Text","Note","Number","Boolean","User","DateTime","Choice","URL","Calculated","Currency","Lookup"],Text:["Text","Note","Choice","Number","Currency","DateTime"],Note:["Text","Note","Choice","Number","Currency","DateTime"],Number:["Text","Note","Choice","Number","Currency","Boolean"],Boolean:["Text","Note","Choice","Number","Currency","Boolean"],User:["User"],Choice:["Text","Note","Choice","Number","Currency","DateTime"],URL:["URL"],Calculated:["Calculated"],Currency:["Text","Note","Choice","Number","Currency","Boolean"],DateTime:["Text","Note","Choice","DateTime"],Lookup:["Lookup"]},i=function(){function o(){}o.prototype.getAllowedTypeSwitches=function(e){return t[e].filter(function(e){if(s.Killswitch.isActivated("FE058A0D-BF54-4219-A126-AD48F0CB8C43","03/21/2018","Refactor SupportedPanelTypes")){r=-1!==n.SUPPORTED_PANEL_TYPES.indexOf(e)&&a.default.isFeatureEnabled({ODB:147});var t=-1!==n.SUPPORTED_PANEL_TYPES_2.indexOf(e)&&a.default.isFeatureEnabled({ODB:702}),i=-1!==n.SUPPORTED_PANEL_TYPES_3.indexOf(e)&&a.default.isFeatureEnabled({ODB:331});return r||t||i}var r;return r=-1!==o.getSupportedPanelTypes().indexOf(e)})};o.prototype.getCouldResultInDataLoss=function(e,t){switch(e){case"Text":case"Choice":switch(t){case"Number":case"Currency":case"DateTime":return!0}break;case"Note":switch(t){case"Text":case"Choice":case"MultiChoice":case"Number":case"Currency":case"DateTime":return!0}break;case"MultiChoice":switch(t){case"Text":case"Note":case"Choice":case"Number":case"Currency":case"DateTime":return!0}break;case"DateTime":switch(t){case"Text":case"Note":case"Choice":case"MultiChoice":return!0}break;case"Number":case"Currency":switch(t){case"Text":case"Note":case"Choice":case"MultiChoice":case"Boolean":return!0}}return!1};o.getSupportedPanelTypes=function(){if(!this.supportedTypes){this.supportedTypes=new Array;a.default.isFeatureEnabled({ODB:147})&&(this.supportedTypes=this.supportedTypes.concat(["Choice","User","Boolean","Number","URL","Text","Note"]));a.default.isFeatureEnabled({ODB:702})&&(this.supportedTypes=this.supportedTypes.concat(["Currency"]));a.default.isFeatureEnabled({ODB:331})&&(this.supportedTypes=this.supportedTypes.concat(["DateTime"]))}return this.supportedTypes};return o}();n.FieldTypeSwitcherHelper=i;n.default=i});define("I6",["require","exports","ap","Jn","Jm","Jl","Jk","Jj","I7"],function(e,t,i,r,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t)});define("Jn",["require","exports","ap","at","jP","Dn"],function(e,t,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._dropdownOptions=[{key:"0",text:t.props.strings.toggleOnText},{key:"1",text:t.props.strings.toggleOffText}];var i=t.props.defaultValue&&"0"===t.props.defaultValue;t.state={defaultValue:i?t._dropdownOptions[1]:t._dropdownOptions[0]};return t}e.prototype.render=function(){var e=this.props.strings;return o.createElement("div",{className:this.props.className?this.props.className+" ms-ColumnManagementPanel-uniqueFields":"ms-ColumnManagementPanel-uniqueFields"},o.createElement(a.Dropdown,{className:"ms-ColumnManagementPanel-booleanDefaultValue",label:e.defaultValueHeader,ariaLabel:e.defaultValueDropdownAriaLabel,options:this._dropdownOptions,selectedKey:this.state.defaultValue.key,onChanged:this._defaultValueChanged}))};e.prototype.getSchemaValues=function(){return{DefaultValue:this.state.defaultValue.text===this.props.strings.toggleOffText?"0":"1"}};e.prototype._defaultValueChanged=function(e){this.setState({defaultValue:e})};i.__decorate([n.autobind],e.prototype,"getSchemaValues",null);i.__decorate([n.autobind],e.prototype,"_defaultValueChanged",null);return e}(n.BaseComponent);t.BooleanColumnUniqueFields=r});define("Dn",["require","exports","ap","Do"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Do",["require","exports","ap","Dr","Dp"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("Dr",["require","exports","ap","at","Dp","Dz","wE","BZ","wN","Du","mo","o7","yg","jP","Dq","Dt","Ds","d"],function(e,t,P,k,n,p,l,I,m,d,o,a,h,T,s,i,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=i,r=function(r){P.__extends(e,r);function e(e){var c=r.call(this,e)||this;c._host=T.createRef();c._focusZone=T.createRef();c._dropDown=T.createRef();c._scrollIdleDelay=250;c._onRenderTitle=function(e){var t=c.props.multiSelectDelimiter,i=void 0===t?", ":t,r=e.map(function(e){return e.text}).join(i);return k.createElement("span",null,r)};c._onRenderPlaceHolder=function(e){return e.placeHolder?k.createElement("span",null,e.placeHolder):null};c._onRenderContainer=function(e){var t=c.props,i=t.onRenderList,r=void 0===i?c._onRenderList:i,o=t.responsiveMode,n=t.calloutProps,a=t.panelProps,s=t.dropdownWidth;return o<=h.ResponsiveMode.medium?k.createElement(d.Panel,P.__assign({className:T.css("ms-Dropdown-panel",w.panel,!!a&&a.className),isOpen:!0,isLightDismiss:!0,onDismissed:c._onDismiss,hasCloseButton:!1},a),r(e,c._onRenderList)):k.createElement(l.Callout,P.__assign({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHintFixed:!0,directionalHint:4},n,{className:T.css("ms-Dropdown-callout",w.callout,!!n&&n.className),target:c._dropDown.current,onDismiss:c._onDismiss,onScroll:c._onScroll,onPositioned:c._onPositioned,calloutWidth:s||(c._dropDown.current?c._dropDown.current.clientWidth:0)}),r(e,c._onRenderList))};c._onRenderCaretDown=function(e){return k.createElement(o.Icon,{className:T.css("ms-Dropdown-caretDown",w.caretDown),iconName:"ChevronDown"})};c._onRenderList=function(e){var t=c.props.onRenderItem,i=void 0===t?c._onRenderItem:t,r=c._id,o=c.state.selectedIndices,n=void 0===o?[]:o;return k.createElement("div",{className:w.listWrapper,onKeyDown:c._onZoneKeyDown,ref:c._host,tabIndex:0},k.createElement(a.FocusZone,{ref:c._focusZone,direction:a.FocusZoneDirection.vertical,defaultActiveElement:void 0!==n[0]?"#"+r+"-list"+n[0]:void 0,id:r+"-list",className:T.css("ms-Dropdown-items",w.items),"aria-labelledby":r+"-label",role:"listbox"},c.props.options.map(function(e,t){return i(P.__assign({},e,{index:t}),c._onRenderItem)})))};c._onRenderItem=function(e){switch(e.itemType){case s.SelectableOptionMenuItemType.Divider:return c._renderSeparator(e);case s.SelectableOptionMenuItemType.Header:return c._renderHeader(e);default:return c._renderOption(e)}};c._renderOption=function(e){var t,i,r=c.props.onRenderOption,o=void 0===r?c._onRenderOption:r,n=c.state.selectedIndices,a=void 0===n?[]:n,s=c._id,l=!(void 0===e.index||!a)&&-1<a.indexOf(e.index),d=f.getStyles(g.getTheme());return c.props.multiSelect?k.createElement(p.Checkbox,{id:s+"-list"+e.index,ref:u.Option+e.index,key:e.key,"data-index":e.index,"data-is-focusable":!e.disabled,disabled:e.disabled,onChange:c._onItemClick(e),inputProps:{onMouseEnter:c._onItemMouseEnter.bind(c,e),onMouseLeave:c._onMouseItemLeave.bind(c,e),onMouseMove:c._onItemMouseMove.bind(c,e)},label:e.text,onRenderLabel:c._onRenderLabel.bind(c,e),className:T.css("ms-ColumnManagementPanel-checkbox",w.dropdownCheckbox,"ms-Dropdown-item",w.item,(i={},i["is-selected "+w.itemIsSelected]=l,i["is-disabled "+w.itemIsDisabled]=e.disabled,i)),role:"option","aria-selected":l?"true":"false",checked:l,styles:{checkboxHovered:d.checkbox,checkboxCheckedHovered:d.checkboxChecked,textHovered:d.text}}):k.createElement(m.CommandButton,{id:s+"-list"+e.index,ref:u.Option+e.index,key:e.key,"data-index":e.index,"data-is-focusable":!e.disabled,disabled:e.disabled,className:T.css("ms-Dropdown-item",w.item,(t={},t["is-selected "+w.itemIsSelected]=l,t["is-disabled "+w.itemIsDisabled]=!0===e.disabled,t)),onClick:c._onItemClick(e),onMouseEnter:c._onItemMouseEnter.bind(c,e),onMouseLeave:c._onMouseItemLeave.bind(c,e),onMouseMove:c._onItemMouseMove.bind(c,e),role:"option","aria-selected":l?"true":"false",ariaLabel:e.ariaLabel||e.text},o(e,c._onRenderOption))};c._onRenderOption=function(e){return k.createElement("span",{className:T.css("ms-Dropdown-optionText",w.optionText)},e.text)};c._onRenderLabel=function(e){var t=c.props.onRenderOption;return(void 0===t?c._onRenderOption:t)(e,c._onRenderOption)};c._onPositioned=function(){c._focusZone.current&&c._async.requestAnimationFrame(function(){return c._focusZone.current.focus()})};c._onItemClick=function(e){return function(){if(!e.disabled){c.setSelectedIndex(e.index);c.props.multiSelect||c.setState({isOpen:!1})}}};c._onScroll=function(){if(c._isScrollIdle||void 0===c._scrollIdleTimeoutId)c._isScrollIdle=!1;else{c._async.clearTimeout(c._scrollIdleTimeoutId);c._scrollIdleTimeoutId=void 0}c._scrollIdleTimeoutId=c._async.setTimeout(function(){c._isScrollIdle=!0},c._scrollIdleDelay)};c._onMouseItemLeave=function(e,t){c._isScrollIdle&&c._host.current&&(c._host.current.setActive?c._host.current.setActive():c._host.current.focus())};c._onDismiss=function(){c.setState({isOpen:!1});c._dropDown.current&&c._dropDown.current.focus()};c._onDropdownBlur=function(e){c.state.isOpen||c.props.onBlur&&c.props.onBlur(e)};c._onDropdownKeyDown=function(e){if(c.props.onKeyDown){c.props.onKeyDown(e);if(e.defaultPrevented)return}var t,i=c.state.selectedIndices.length?c.state.selectedIndices[0]:-1;switch(e.which){case 13:c.setState({isOpen:!c.state.isOpen});break;case 27:if(!c.state.isOpen)return;c.setState({isOpen:!1});break;case 38:c.props.multiSelect?c.setState({isOpen:!0}):t=c._moveIndex(-1,i-1,i);break;case 40:e.altKey||e.metaKey||c.props.multiSelect?c.setState({isOpen:!0}):t=c._moveIndex(1,i+1,i);break;case 36:c.props.multiSelect||(t=c._moveIndex(1,0,i));break;case 35:c.props.multiSelect||(t=c._moveIndex(-1,c.props.options.length-1,i));break;case 32:break;default:if(e.altKey||e.metaKey){c.setState({isOpen:!1});e.stopPropagation();e.preventDefault()}return}if(t!==i){e.stopPropagation();e.preventDefault()}};c._onDropdownKeyUp=function(e){if(c.props.onKeyUp){c.props.onKeyUp(e);if(e.preventDefault)return}switch(e.which){case 32:c.setState({isOpen:!c.state.isOpen});break;default:return}e.stopPropagation();e.preventDefault()};c._onZoneKeyDown=function(e){var t;switch(e.which){case 38:e.altKey||e.metaKey?c.setState({isOpen:!1}):c._host.current&&(t=T.getLastFocusable(c._host.current,c._host.current.lastChild,!0));break;case 36:case 35:case 33:case 34:break;case 40:c._host.current&&(t=T.getFirstFocusable(c._host.current,c._host.current.firstChild,!0));break;case 27:c.setState({isOpen:!1});break;case 9:c.setState({isOpen:!1});return;default:if(e.altKey||e.metaKey){c.setState({isOpen:!1});break}return}t&&t.focus();e.stopPropagation();e.preventDefault()};c._onDropdownClick=function(e){if(c.props.onClick){c.props.onClick(e);if(e.preventDefault)return}var t=c.props.disabled,i=c.props.isDisabled,r=c.state.isOpen;void 0!==i&&(t=i);t||c.setState({isOpen:!r})};e.options.forEach(function(e){e.itemType||(e.itemType=n.DropdownMenuItemType.Normal)});(c=r.call(this,e)||this)._warnDeprecations({isDisabled:"disabled"});c._warnMutuallyExclusive({defaultSelectedKey:"selectedKey",defaultSelectedKeys:"selectedKeys",selectedKeys:"selectedKey",multiSelect:"defaultSelectedKey",selectedKey:"multiSelect"});c._id=e.id||T.getId("Dropdown");c._isScrollIdle=!0;c.state={isOpen:!1};if(c.props.multiSelect){var t=void 0!==e.defaultSelectedKeys?e.defaultSelectedKeys:e.selectedKeys;c.state={selectedIndices:c._getSelectedIndexes(e.options,t)}}else{var i=void 0!==e.defaultSelectedKey?e.defaultSelectedKey:e.selectedKey;c.state={selectedIndices:c._getSelectedIndexes(e.options,i)}}return c}(u=e).prototype.componentWillReceiveProps=function(e){var t=this.props.multiSelect?"selectedKeys":"selectedKey";void 0===e[t]||e[t]===this.props[t]&&e.options===this.props.options||this.setState({selectedIndices:this._getSelectedIndexes(e.options,e[t])})};e.prototype.componentDidUpdate=function(e,t){if(!0===t.isOpen&&!1===this.state.isOpen){this._dropDown.current&&this._dropDown.current.focus();this.props.onDismiss&&this.props.onDismiss()}};e.prototype.render=function(){var e=this._id,t=this.props.disabled,i=this.props,r=i.className,o=i.label,n=i.options,a=i.isDisabled,s=i.ariaLabel,l=i.required,d=i.errorMessage,c=i.onRenderTitle,u=void 0===c?this._onRenderTitle:c,p=i.onRenderContainer,m=void 0===p?this._onRenderContainer:p,h=i.onRenderPlaceHolder,f=void 0===h?this._onRenderPlaceHolder:h,g=i.onRenderCaretDown,y=void 0===g?this._onRenderCaretDown:g,v=this.state,_=v.isOpen,b=v.selectedIndices,x=void 0===b?[]:b,S=this._getAllSelectedOptions(n,x),C=T.getNativeProps(this.props,T.divProperties);void 0!==a&&(t=a);return k.createElement("div",{className:T.css("ms-Dropdown-container")},o&&k.createElement(I.Label,{className:T.css("ms-Dropdown-label"),id:e+"-label",htmlFor:e,required:l},o),k.createElement("div",P.__assign({"data-is-focusable":!t,ref:this._dropDown,id:e,tabIndex:t?-1:0,"aria-expanded":_?"true":"false",role:"listbox","aria-autocomplete":"none","aria-live":t||_?"off":"assertive","aria-label":s,"aria-describedby":e+"-option","aria-activedescendant":_&&1===x.length&&0<=x[0]?this._id+"-list"+x[0]:void 0,"aria-disabled":t,"aria-owns":_?e+"-list":void 0},C,{className:T.css("ms-Dropdown",w.root,r,_&&"is-open",t&&"is-disabled "+w.rootIsDisabled,l&&"is-required"),onBlur:this._onDropdownBlur,onKeyDown:this._onDropdownKeyDown,onKeyUp:this._onDropdownKeyUp,onClick:this._onDropdownClick}),k.createElement("span",{id:e+"-option",className:T.css("ms-Dropdown-title",w.title,!S.length&&"ms-Dropdown-titleIsPlaceHolder",!S.length&&w.titleIsPlaceHolder,d&&0<d.length?w.titleIsError:null),"aria-atomic":!0,role:"listbox","aria-readonly":"true"},S.length?u(S,this._onRenderTitle):f(this.props,this._onRenderPlaceHolder)),k.createElement("span",{className:T.css("ms-Dropdown-caretDownWrapper",w.caretDownWrapper)},y(this.props,this._onRenderCaretDown))),_&&m(this.props,this._onRenderContainer),d&&k.createElement("div",{className:T.css(w.errorMessage)},d))};e.prototype.focus=function(e){if(this._dropDown.current&&-1!==this._dropDown.current.tabIndex){this._dropDown.current.focus();e&&this.setState({isOpen:!0})}};e.prototype.setSelectedIndex=function(e){var t=this.props,i=t.onChanged,r=t.options,o=t.selectedKey,n=t.selectedKeys,a=t.multiSelect,s=this.state.selectedIndices,l=void 0===s?[]:s,d=!!l&&-1<l.indexOf(e);e=Math.max(0,Math.min(r.length-1,e));if(a||e!==l[0]){if(a||void 0!==o){if(a&&void 0===n){var c=l?this._copyArray(l):[];if(d){var u=c.indexOf(e);-1<u&&c.splice(u,1)}else c.push(e);this.setState({selectedIndices:c})}}else this.setState({selectedIndices:[e]});if(i){i(a?P.__assign({},r[e],{selected:!d}):r[e],e)}}};e.prototype._copyArray=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var o=r[i];t.push(o)}return t};e.prototype._moveIndex=function(e,t,i){var r=this.props.options;if(i===t||0===r.length)return i;t<0&&(t=0);t>=r.length&&(t=r.length-1);for(var o=0;r[t].itemType===n.DropdownMenuItemType.Header||r[t].itemType===n.DropdownMenuItemType.Divider||r[t].disabled;){if(o>=r.length)return i;t+e<0?t=r.length:t+e>=r.length&&(t=-1);t+=e;o++}this.setSelectedIndex(t);return t};e.prototype._renderSeparator=function(e){var t=e.index,i=e.key;return 0<t?k.createElement("div",{role:"separator",key:i,className:T.css("ms-Dropdown-divider",w.divider)}):null};e.prototype._renderHeader=function(e){var t=this.props.onRenderOption,i=void 0===t?this._onRenderOption:t,r=e.key;return k.createElement("div",{key:r,className:T.css("ms-Dropdown-header",w.header)},i(e,this._onRenderOption))};e.prototype._onItemMouseEnter=function(e,t){if(this._isScrollIdle){t.currentTarget.focus()}};e.prototype._onItemMouseMove=function(e,t){var i=t.currentTarget;this._isScrollIdle&&document.activeElement!==i&&i.focus()};e.prototype._getSelectedIndexes=function(e,t){if(void 0===t){if(this.props.multiSelect)return this._getAllSelectedIndices(e);var i=this._getSelectedIndex(e,null);return-1!==i?[i]:[]}if(!Array.isArray(t))return[this._getSelectedIndex(e,t)];for(var r=[],o=0,n=t;o<n.length;o++){var a=n[o];r.push(this._getSelectedIndex(e,a))}return r};e.prototype._getAllSelectedOptions=function(e,t){for(var i=[],r=0,o=t;r<o.length;r++){var n=e[o[r]];n&&i.push(n)}return i};e.prototype._getAllSelectedIndices=function(e){return e.map(function(e,t){return e.selected?t:-1}).filter(function(e){return-1!==e})};e.prototype._getSelectedIndex=function(e,t){return T.findIndex(e,function(e){return null!=t?e.key===t:!!e.isSelected||!!e.selected})};e.defaultProps={options:[]};e.Option="option";return e=u=P.__decorate([h.withResponsiveMode],e);var u}(T.BaseComponent);t.Dropdown=r});define("Dp",["require","exports","Dq"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DropdownMenuItemType=i.SelectableOptionMenuItemType});define("Dq",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Normal=0]="Normal";e[e.Divider=1]="Divider";e[e.Header=2]="Header"}(t.SelectableOptionMenuItemType||(t.SelectableOptionMenuItemType={}))});define("Dz",["require","exports","ap","DA"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("DA",["require","exports","ap","DB"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("DB",["require","exports","ap","at","jP","mo","DC","Ds"],function(e,t,b,x,r,S,C,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){b.__extends(e,i);function e(e,t){var n=i.call(this,e,t)||this;n._checkBox=r.createRef();n._onFocus=function(e){var t=n.props.inputProps;t&&t.onFocus&&t.onFocus(e)};n._onBlur=function(e){var t=n.props.inputProps;t&&t.onBlur&&t.onBlur(e)};n._onClick=function(e){var t=n.props,i=t.disabled,r=t.onChange,o=n.state.isChecked;e.preventDefault();e.stopPropagation();if(!i){r&&r(e,!o);void 0===n.props.checked&&n.setState({isChecked:!o})}};n._onRenderLabel=function(e){var t=e.label;return t?x.createElement("span",{className:n._classNames.text},t):null};n._warnMutuallyExclusive({checked:"defaultChecked"});n._id=r.getId("checkbox-");n.state={isChecked:!!(void 0!==e.checked?e.checked:e.defaultChecked)};return n}e.prototype.componentWillReceiveProps=function(e){void 0!==e.checked&&this.setState({isChecked:!!e.checked})};e.prototype.render=function(){var e=this.props,t=e.checked,i=e.className,r=e.defaultChecked,o=e.disabled,n=e.inputProps,a=e.name,s=e.boxSide,l=e.theme,d=e.ariaLabel,c=e.ariaLabelledBy,u=e.ariaDescribedBy,p=e.styles,m=e.onRenderLabel,h=void 0===m?this._onRenderLabel:m,f=e.checkmarkIconProps,g=e.ariaPositionInSet,y=e.ariaSetSize,v=void 0===t?this.state.isChecked:t,_="start"!==s;this._classNames=this.props.getClassNames?this.props.getClassNames(l,!!o,!!v,!!_,i):C.getClassNames(P.getStyles(l,p),!!o,!!v,!!_,i);return x.createElement("button",b.__assign({},n,void 0!==t&&{checked:t},void 0!==r&&{defaultChecked:r},{disabled:o,ref:this._checkBox,name:a,id:this._id,role:"checkbox",type:"button",className:this._classNames.root,onClick:this._onClick,onFocus:this._onFocus,onBlur:this._onBlur,"aria-checked":v,"aria-disabled":o,"aria-label":d,"aria-labelledby":c,"aria-describedby":u,"aria-posinset":g,"aria-setsize":y}),x.createElement("label",{className:this._classNames.label,htmlFor:this._id},x.createElement("div",{className:this._classNames.checkbox},x.createElement(S.Icon,b.__assign({iconName:"CheckMark"},f,{className:this._classNames.checkmark}))),h(this.props,this._onRenderLabel)))};Object.defineProperty(e.prototype,"checked",{get:function(){return this.state.isChecked},enumerable:!0,configurable:!0});e.prototype.focus=function(){this._checkBox.current&&this._checkBox.current.focus()};e.defaultProps={boxSide:"start"};return e=b.__decorate([r.customizable("Checkbox",["theme"])],e)}(r.BaseComponent);t.Checkbox=i});define("DC",["require","exports","jP","d"],function(e,t,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getClassNames=i.memoizeFunction(function(e,t,i,r,o){return{root:n.mergeStyles("ms-Checkbox",r&&"reversed",i&&"is-checked",!t&&"is-enabled",t&&"is-disabled",o,e.root,!t&&[!i&&{selectors:{":hover .ms-Checkbox-checkbox":e.checkboxHovered,":focus .ms-Checkbox-checkbox":e.checkboxFocused}},i&&{selectors:{":hover .ms-Checkbox-checkbox":e.checkboxCheckedHovered,":focus .ms-Checkbox-checkbox":e.checkboxCheckedFocused}},{selectors:{":hover .ms-Checkbox-text":e.textHovered,":focus .ms-Checkbox-text":e.textFocused}}]),label:n.mergeStyles("ms-Checkbox-label",e.label,r&&e.labelReversed,t&&e.labelDisabled),checkbox:n.mergeStyles("ms-Checkbox-checkbox",e.checkbox,!t&&i&&e.checkboxChecked,t&&!i&&e.checkboxDisabled,t&&i&&e.checkboxCheckedDisabled),checkmark:n.mergeStyles(e.checkmark,!t&&i&&e.checkmarkChecked,t&&!i&&e.checkmarkDisabled,t&&i&&e.checkmarkCheckedDisabled),text:n.mergeStyles("ms-Checkbox-text",e.text,t&&e.textDisabled)}})});define("Ds",["require","exports","d","jP"],function(e,t,y,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=i.memoizeFunction(function(e,t){var i=e.semanticColors,r=e.palette,o=i.inputForegroundChecked,n=i.disabledBackground,a=i.smallInputBorder,s=i.inputBackgroundChecked,l=i.disabledBodyText,d=i.inputBorderHovered,c=i.inputBackgroundChecked,u=i.inputBackgroundCheckedHovered,p=i.inputBackgroundCheckedHovered,m=i.disabledBodyText,h=i.bodyText,f=i.disabledText,g={root:[y.getFocusStyle(e,-2),e.fonts.medium,{padding:"0",border:"none",background:"none",margin:"0",outline:"none",display:"block",cursor:"pointer"}],label:{display:"inline-flex",margin:"0 -4px",alignItems:"center",cursor:"pointer",position:"relative",textAlign:"left"},labelReversed:{flexDirection:"row-reverse",justifyContent:"flex-end"},labelDisabled:{cursor:"default"},checkbox:{display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:"20px",width:"20px",borderWidth:"1px",borderStyle:"solid",borderColor:a,margin:"0 4px",boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)",userSelect:"none",overflow:"hidden"},checkboxHovered:{borderColor:d},checkboxFocused:{borderColor:d},checkboxChecked:{background:c,borderColor:s},checkboxCheckedHovered:{background:u,borderColor:p},checkboxCheckedFocused:{background:u,borderColor:p},checkboxDisabled:{borderColor:l},checkboxCheckedDisabled:{background:m,borderColor:l},checkmark:{opacity:"0",color:o},checkmarkChecked:{opacity:"1"},checkmarkDisabled:{},checkmarkCheckedDisabled:{opacity:"1",color:n},text:{color:h,margin:"0 4px",fontSize:y.FontSizes.medium},textHovered:{color:r.black},textFocused:{color:r.black},textDisabled:{color:f}};return y.concatStyleSets(g,t)})});define("Du",["require","exports","ap","Dv"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Dv",["require","exports","ap","Dx","Dw"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("Dx",["require","exports","ap","at","jP","x0","Dw","pq","xV","wm","wN","d","Dy"],function(e,t,O,B,V,U,H,q,j,W,i,K,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var z=r,n=K.getTheme(),o=function(t){O.__extends(e,t);function e(e){var o=t.call(this,e)||this;o._content=V.createRef();o.dismiss=function(){if(o.state.isOpen){o.setState({isOpen:!1,isAnimating:!0},function(){o._async.setTimeout(o._onTransitionComplete,200)});o.props.onDismiss&&o.props.onDismiss()}};o._onRenderNavigation=function(e){var t=e.closeButtonAriaLabel;return e.hasCloseButton?B.createElement("div",{className:V.css("ms-Panel-navigation",z.navigation)},B.createElement(i.IconButton,{styles:{root:{height:"auto",width:"44px",color:n.palette.neutralSecondary,fontSize:K.IconFontSizes.large},rootHovered:{color:n.palette.neutralPrimary}},className:V.css("ms-Panel-closeButton ms-PanelAction-close"),onClick:o._onPanelClick,ariaLabel:t,"data-is-visible":!0,iconProps:{iconName:"Cancel"}})):null};o._onRenderHeader=function(e,t,i){var r=e.headerText,o=e.headerClassName,n=void 0===o?"":o;return r?B.createElement("div",{className:V.css("ms-Panel-header",z.header)},B.createElement("p",{className:V.css("ms-Panel-headerText",z.headerText,n),id:i,role:"heading"},r)):null};o._onRenderBody=function(e){var t=V.css("ms-Panel-content",z.content,e.isFooterAtBottom&&z.contentGrow);return B.createElement("div",{ref:o._content,className:t,"data-is-scrollable":!0},e.children)};o._onRenderFooter=function(e){var t=o.state.isFooterSticky,i=o.props.onRenderFooterContent,r=void 0===i?null:i;return r?B.createElement("div",{className:V.css("ms-Panel-footer",z.footer,t&&z.footerIsSticky)},B.createElement("div",{className:V.css("ms-Panel-footerInner",z.footerInner)},r())):null};o._onPanelClick=function(){o.dismiss()};o._onTransitionComplete=function(){o.setState({isAnimating:!1});!o.state.isOpen&&o.props.onDismissed&&o.props.onDismissed()};o._warnDeprecations({ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"});o.state={isFooterSticky:!1,isOpen:!1,isAnimating:!1,id:V.getId("Panel")};return o}e.prototype.componentDidMount=function(){this._events.on(window,"resize",this._updateFooterPosition);this.props.isOpen&&this.open()};e.prototype.componentWillReceiveProps=function(e){e.isOpen!==this.state.isOpen&&(e.isOpen?this.open():this.dismiss())};e.prototype.render=function(){var e,t=this.props,i=t.className,r=void 0===i?"":i,o=t.elementToFocusOnDismiss,n=t.firstFocusableSelector,a=t.focusTrapZoneProps,s=t.forceFocusInsideTrap,l=t.hasCloseButton,d=t.headerText,c=t.ignoreExternalFocusing,u=t.isBlocking,p=t.isLightDismiss,m=t.isHiddenOnDismiss,h=t.layerProps,f=t.type,g=t.customWidth,y=t.onLightDismissClick,v=void 0===y?this._onPanelClick:y,_=t.onRenderNavigation,b=void 0===_?this._onRenderNavigation:_,x=t.onRenderHeader,S=void 0===x?this._onRenderHeader:x,C=t.onRenderBody,P=void 0===C?this._onRenderBody:C,k=t.onRenderFooter,I=void 0===k?this._onRenderFooter:k,T=this.state,w=T.isOpen,E=T.isAnimating,D=T.id,A=f===H.PanelType.smallFixedNear,M=V.getRTL()?A:!A,F=d&&D+"-headerText",L=f===H.PanelType.custom?{width:g}:{},R=V.getNativeProps(this.props,V.divProperties);if(!w&&!E&&!m)return null;u&&w&&(e=B.createElement(j.Overlay,{className:V.css(z.overlay,w&&E&&K.AnimationClassNames.fadeIn200,!w&&E&&K.AnimationClassNames.fadeOut200),isDarkThemed:!1,onClick:p?v:void 0}));var N=S(this.props,this._onRenderHeader,F);return B.createElement(q.Layer,O.__assign({},h),B.createElement(W.Popup,{role:"dialog",ariaLabelledBy:N?F:void 0,onDismiss:this.dismiss,className:V.css(!w&&!E&&m&&z.hiddenPanel)},B.createElement("div",O.__assign({},R,{className:V.css("ms-Panel",z.root,r,w&&"is-open "+z.rootIsOpen,f===H.PanelType.smallFluid&&"ms-Panel--smFluid "+z.rootIsSmallFluid,f===H.PanelType.smallFixedNear&&"ms-Panel--smLeft "+z.rootIsSmallLeft,f===H.PanelType.smallFixedFar&&"ms-Panel--sm "+z.rootIsSmall,f===H.PanelType.medium&&"ms-Panel--md "+z.rootIsMedium,(f===H.PanelType.large||f===H.PanelType.largeFixed)&&"ms-Panel--lg "+z.rootIsLarge,f===H.PanelType.largeFixed&&"ms-Panel--fixed "+z.rootIsFixed,f===H.PanelType.extraLarge&&"ms-Panel--xl "+z.rootIsXLarge,f===H.PanelType.custom&&"ms-Panel--custom "+z.rootIsCustom,l&&"ms-Panel--hasCloseButton "+z.rootHasCloseButton,!w&&!E&&m&&z.hiddenPanel)}),e,B.createElement(U.FocusTrapZone,O.__assign({ignoreExternalFocusing:c,forceFocusInsideTrap:s,firstFocusableSelector:n},a,{className:V.css("ms-Panel-main",z.main,w&&E&&!M&&K.AnimationClassNames.slideRightIn40,w&&E&&M&&K.AnimationClassNames.slideLeftIn40,!w&&E&&!M&&K.AnimationClassNames.slideLeftOut40,!w&&E&&M&&K.AnimationClassNames.slideRightOut40,a?a.className:void 0),style:L,elementToFocusOnDismiss:o,isClickableOutsideFocusTrap:!(a&&!a.isClickableOutsideFocusTrap)}),B.createElement("div",{className:V.css("ms-Panel-commands"),"data-is-visible":!0},b(this.props,this._onRenderNavigation)),B.createElement("div",{className:V.css("ms-Panel-contentInner",z.contentInner)},N,P(this.props,this._onRenderBody),I(this.props,this._onRenderFooter))))))};e.prototype.open=function(){var e=this;this.state.isOpen||this.setState({isOpen:!0,isAnimating:!0},function(){e._async.setTimeout(e._onTransitionComplete,200)})};e.prototype._updateFooterPosition=function(){var e=this._content.current;if(e){var t=e.clientHeight,i=e.scrollHeight;this.setState({isFooterSticky:t<i})}};e.defaultProps={isHiddenOnDismiss:!1,isOpen:!1,isBlocking:!0,hasCloseButton:!0,type:H.PanelType.smallFixedFar};return e}(V.BaseComponent);t.Panel=o});define("Dw",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.smallFluid=0]="smallFluid";e[e.smallFixedFar=1]="smallFixedFar";e[e.smallFixedNear=2]="smallFixedNear";e[e.medium=3]="medium";e[e.large=4]="large";e[e.largeFixed=5]="largeFixed";e[e.extraLarge=6]="extraLarge";e[e.custom=7]="custom"}(t.PanelType||(t.PanelType={}))});define("xV",["require","exports","ap","xW"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("xW",["require","exports","ap","xY","xX"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("xY",["require","exports","jP","xX","xZ"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Overlay=i.styled(r.OverlayBase,o.getStyles)});define("xX",["require","exports","ap","at","jP"],function(e,t,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=d.classNamesFunction(),i=function(e){s.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){d.disableBodyScroll()};t.prototype.componentWillUnmount=function(){d.enableBodyScroll()};t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,i=e.className,r=e.theme,o=e.getStyles,n=d.getNativeProps(this.props,d.divProperties),a=c(o,{theme:r,className:i,isDark:t});return l.createElement("div",s.__assign({},n,{className:a.root}))};return t=s.__decorate([d.customizable("Overlay",["theme"])],t)}(d.BaseComponent);t.OverlayBase=i});define("xZ",["require","exports","d"],function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t,i=e.className,r=e.theme,o=e.isNone,n=e.isDark,a=r.palette;return{root:["ms-Overlay",{backgroundColor:a.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[s.HighContrastSelector]={border:"1px solid WindowText"},t)},o&&{visibility:"hidden"},n&&["ms-Overlay--dark",{backgroundColor:a.blackTranslucent40}],i]}}});define("Dy",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".hiddenPanel_b9d9951a{visibility:hidden}.root_b9d9951a{pointer-events:none;position:absolute;top:0;left:0;right:0;bottom:0}.root_b9d9951a .overlay_b9d9951a{pointer-events:none;opacity:1;cursor:pointer;-webkit-transition:opacity .367s cubic-bezier(0.1, 0.9, 0.2, 1);transition:opacity .367s cubic-bezier(0.1, 0.9, 0.2, 1)}.main_b9d9951a{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;width:100%;bottom:0;top:0;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch}[dir='ltr'] .main_b9d9951a{right:0}[dir='rtl'] .main_b9d9951a{left:0}@media (min-width: 480px){.main_b9d9951a{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";pointer-events:auto;width:340px}[dir='ltr'] .main_b9d9951a{-webkit-box-shadow:-30px 0px 30px -30px rgba(0,0,0,0.2);box-shadow:-30px 0px 30px -30px rgba(0,0,0,0.2)}[dir='rtl'] .main_b9d9951a{-webkit-box-shadow:30px 0px 30px -30px rgba(0,0,0,0.2);box-shadow:30px 0px 30px -30px rgba(0,0,0,0.2)}[dir='ltr'] .main_b9d9951a{left:auto}[dir='rtl'] .main_b9d9951a{right:auto}}.root_b9d9951a.rootIsSmall_b9d9951a .main_b9d9951a{width:272px}@media (min-width: 480px){.root_b9d9951a.rootIsSmall_b9d9951a .main_b9d9951a{width:340px}}.root_b9d9951a.rootIsSmallLeft_b9d9951a .main_b9d9951a{width:272px}[dir='ltr'] .root_b9d9951a.rootIsSmallLeft_b9d9951a .main_b9d9951a{right:auto}[dir='rtl'] .root_b9d9951a.rootIsSmallLeft_b9d9951a .main_b9d9951a{left:auto}[dir='ltr'] .root_b9d9951a.rootIsSmallLeft_b9d9951a .main_b9d9951a{left:0}[dir='rtl'] .root_b9d9951a.rootIsSmallLeft_b9d9951a .main_b9d9951a{right:0}[dir='ltr'] .root_b9d9951a.rootIsSmallLeft_b9d9951a .main_b9d9951a{-webkit-box-shadow:30px 0px 30px -30px rgba(0,0,0,0.2);box-shadow:30px 0px 30px -30px rgba(0,0,0,0.2)}[dir='rtl'] .root_b9d9951a.rootIsSmallLeft_b9d9951a .main_b9d9951a{-webkit-box-shadow:-30px 0px 30px -30px rgba(0,0,0,0.2);box-shadow:-30px 0px 30px -30px rgba(0,0,0,0.2)}.root_b9d9951a.rootIsSmallFluid_b9d9951a .main_b9d9951a{width:100%}@media (min-width: 768px){.root_b9d9951a.rootIsMedium_b9d9951a .main_b9d9951a,.root_b9d9951a.rootIsLarge_b9d9951a .main_b9d9951a,.root_b9d9951a.rootIsXLarge_b9d9951a .main_b9d9951a,.root_b9d9951a.rootIsCustom_b9d9951a .main_b9d9951a{width:auto}[dir='ltr'] .root_b9d9951a.rootIsMedium_b9d9951a .main_b9d9951a,[dir='ltr'] .root_b9d9951a.rootIsLarge_b9d9951a .main_b9d9951a,[dir='ltr'] .root_b9d9951a.rootIsXLarge_b9d9951a .main_b9d9951a,[dir='ltr'] .root_b9d9951a.rootIsCustom_b9d9951a .main_b9d9951a{left:48px}[dir='rtl'] .root_b9d9951a.rootIsMedium_b9d9951a .main_b9d9951a,[dir='rtl'] .root_b9d9951a.rootIsLarge_b9d9951a .main_b9d9951a,[dir='rtl'] .root_b9d9951a.rootIsXLarge_b9d9951a .main_b9d9951a,[dir='rtl'] .root_b9d9951a.rootIsCustom_b9d9951a .main_b9d9951a{right:48px}}@media (min-width: 1024px){.root_b9d9951a.rootIsMedium_b9d9951a .main_b9d9951a{width:643px}[dir='ltr'] .root_b9d9951a.rootIsMedium_b9d9951a .main_b9d9951a{left:auto}[dir='rtl'] .root_b9d9951a.rootIsMedium_b9d9951a .main_b9d9951a{right:auto}}@media (min-width: 1366px){[dir='ltr'] .root_b9d9951a.rootIsLarge_b9d9951a .main_b9d9951a{left:428px}[dir='rtl'] .root_b9d9951a.rootIsLarge_b9d9951a .main_b9d9951a{right:428px}}@media (min-width: 1366px){.root_b9d9951a.rootIsLarge_b9d9951a.rootIsFixed_b9d9951a .main_b9d9951a{width:940px}[dir='ltr'] .root_b9d9951a.rootIsLarge_b9d9951a.rootIsFixed_b9d9951a .main_b9d9951a{left:auto}[dir='rtl'] .root_b9d9951a.rootIsLarge_b9d9951a.rootIsFixed_b9d9951a .main_b9d9951a{right:auto}}@media (min-width: 1366px){[dir='ltr'] .root_b9d9951a.rootIsXLarge_b9d9951a .main_b9d9951a{left:176px}[dir='rtl'] .root_b9d9951a.rootIsXLarge_b9d9951a .main_b9d9951a{right:176px}}@media (min-width: 1024px){[dir='ltr'] .root_b9d9951a.rootIsCustom_b9d9951a .main_b9d9951a{left:auto}[dir='rtl'] .root_b9d9951a.rootIsCustom_b9d9951a .main_b9d9951a{right:auto}}.root_b9d9951a.rootIsOpen_b9d9951a .main_b9d9951a{pointer-events:auto}.root_b9d9951a.rootIsOpen_b9d9951a .overlay_b9d9951a{cursor:pointer;pointer-events:auto}@media screen and (-ms-high-contrast: active){.root_b9d9951a.rootIsOpen_b9d9951a .overlay_b9d9951a{opacity:0}}.navigation_b9d9951a{padding:0 5px;height:44px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.contentInner_b9d9951a{position:absolute;top:0;bottom:0;left:0;right:0;overflow-y:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-overflow-scrolling:touch;-webkit-transform:translateZ(0);transform:translateZ(0)}.rootHasCloseButton_b9d9951a .contentInner_b9d9951a{top:44px}.header_b9d9951a,.content_b9d9951a,.footerInner_b9d9951a{padding-left:16px;padding-right:16px}@media (min-width: 768px){.header_b9d9951a,.content_b9d9951a,.footerInner_b9d9951a{padding-left:32px;padding-right:32px}}@media (min-width: 1366px){.header_b9d9951a,.content_b9d9951a,.footerInner_b9d9951a{padding-left:40px;padding-right:40px}}.header_b9d9951a{margin:14px 0;-webkit-box-flex:0;-ms-flex-positive:0;flex-grow:0}@media (min-width: 1024px){.header_b9d9951a{margin-top:30px}}.content_b9d9951a{margin-bottom:0;padding-bottom:20px;overflow-y:auto}.contentGrow_b9d9951a{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.footer_b9d9951a{-webkit-box-flex:0;-ms-flex-positive:0;flex-grow:0;border-top:1px solid transparent;-webkit-transition:border .367s cubic-bezier(0.1, 0.25, 0.75, 0.9);transition:border .367s cubic-bezier(0.1, 0.25, 0.75, 0.9)}.footerInner_b9d9951a{padding-bottom:20px;padding-top:20px}.footerIsSticky_b9d9951a{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.headerText_b9d9951a{font-size:21px;font-weight:100;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";line-height:32px;margin:0}\n"}]);t.hiddenPanel="hiddenPanel_b9d9951a";t.root="root_b9d9951a";t.overlay="overlay_b9d9951a";t.main="main_b9d9951a";t.rootIsSmall="rootIsSmall_b9d9951a";t.rootIsSmallLeft="rootIsSmallLeft_b9d9951a";t.rootIsSmallFluid="rootIsSmallFluid_b9d9951a";t.rootIsMedium="rootIsMedium_b9d9951a";t.rootIsLarge="rootIsLarge_b9d9951a";t.rootIsXLarge="rootIsXLarge_b9d9951a";t.rootIsCustom="rootIsCustom_b9d9951a";t.rootIsFixed="rootIsFixed_b9d9951a";t.rootIsOpen="rootIsOpen_b9d9951a";t.navigation="navigation_b9d9951a";t.contentInner="contentInner_b9d9951a";t.rootHasCloseButton="rootHasCloseButton_b9d9951a";t.header="header_b9d9951a";t.content="content_b9d9951a";t.footerInner="footerInner_b9d9951a";t.contentGrow="contentGrow_b9d9951a";t.footer="footer_b9d9951a";t.footerIsSticky="footerIsSticky_b9d9951a";t.headerText="headerText_b9d9951a"});define("Dt",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_0c172421{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0;font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";position:relative;outline:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_0c172421:hover .title_0c172421,.root_0c172421:hover .caretDown_0c172421,.root_0c172421:focus .title_0c172421,.root_0c172421:focus .caretDown_0c172421,.root_0c172421:active .title_0c172421,.root_0c172421:active .caretDown_0c172421{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.root_0c172421:hover .titleIsPlaceHolder_0c172421,.root_0c172421:focus .titleIsPlaceHolder_0c172421,.root_0c172421:active .titleIsPlaceHolder_0c172421{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.root_0c172421:hover .title_0c172421{border-color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_0c172421:hover .title_0c172421{border-color:Highlight}}.root_0c172421:hover .titleIsError_0c172421{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.root_0c172421:active .title_0c172421{border-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_0c172421:active .title_0c172421{border-color:Highlight}}.root_0c172421:active .titleIsError_0c172421{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.root_0c172421:focus .title_0c172421{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_0c172421:focus .title_0c172421{background-color:Highlight;border-color:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast: active), screen and (-ms-high-contrast: black-on-white){.root_0c172421:focus .title_0c172421{-ms-high-contrast-adjust:none}}.root_0c172421:focus .caretDown_0c172421{color:HighlightText}@media screen and (-ms-high-contrast: active), screen and (-ms-high-contrast: black-on-white){.root_0c172421:focus .caretDown_0c172421{-ms-high-contrast-adjust:none}}.root_0c172421:focus .titleIsError_0c172421{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.root_0c172421 .titleIsError_0c172421{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.root_0c172421 .ms-Label{display:inline-block;margin-bottom:8px}.root_0c172421.rootIsDisabled_0c172421 .title_0c172421{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";border:none;color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";cursor:default}@media screen and (-ms-high-contrast: active){.root_0c172421.rootIsDisabled_0c172421 .title_0c172421{border:1px solid GrayText;color:GrayText}}.root_0c172421.rootIsDisabled_0c172421 .title_0c172421.titleIsError_0c172421{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.root_0c172421.rootIsDisabled_0c172421 .caretDown_0c172421{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_0c172421.rootIsDisabled_0c172421 .caretDown_0c172421{color:GrayText}}.listWrapper_0c172421:focus{outline:0}.caretDownWrapper_0c172421{position:absolute;top:1px;height:32px;line-height:30px}[dir='ltr'] .caretDownWrapper_0c172421{right:12px}[dir='rtl'] .caretDownWrapper_0c172421{left:12px}.caretDown_0c172421{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px;pointer-events:none}.title_0c172421{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";cursor:pointer;display:block;height:32px;line-height:30px;padding:0 32px 0 12px;position:relative;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}html[dir='rtl'] .title_0c172421{padding:0 12px 0 32px}.title_0c172421.titleIsPlaceHolder_0c172421{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir='ltr'] .panel_0c172421 .ms-Panel-main{-webkit-box-shadow:-30px 0px 30px -30px rgba(0,0,0,0.2);box-shadow:-30px 0px 30px -30px rgba(0,0,0,0.2)}[dir='rtl'] .panel_0c172421 .ms-Panel-main{-webkit-box-shadow:30px 0px 30px -30px rgba(0,0,0,0.2);box-shadow:30px 0px 30px -30px rgba(0,0,0,0.2)}.panel_0c172421 .ms-Panel-contentInner{padding:0 0 20px}.callout_0c172421.callout_0c172421{-webkit-box-shadow:0 0px 2px 0px rgba(0,0,0,0.2);box-shadow:0 0px 2px 0px rgba(0,0,0,0.2);border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.errorMessage_0c172421{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:12px;font-weight:400;padding-top:5px}.items_0c172421{display:block}.item_0c172421{background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;cursor:pointer;display:block;width:100%;min-height:32px;line-height:20px;height:auto !important;padding:4px 16px !important;position:relative;border:1px solid transparent;word-wrap:break-word;overflow-wrap:break-word;text-align:left}@media screen and (-ms-high-contrast: active){.item_0c172421{border-color:Window}}.item_0c172421:hover{color:inherit}.item_0c172421:focus{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast: active){.item_0c172421:focus{background-color:Highlight;border-color:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast: active), screen and (-ms-high-contrast: black-on-white){.item_0c172421:focus{-ms-high-contrast-adjust:none}}.item_0c172421:active{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.item_0c172421.itemIsDisabled_0c172421{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";cursor:default}.item_0c172421 .ms-Button-flexContainer{-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.item_0c172421.itemIsSelected_0c172421{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:";color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}@media screen and (-ms-high-contrast: active){.item_0c172421.itemIsSelected_0c172421{background-color:Highlight;border-color:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast: active), screen and (-ms-high-contrast: black-on-white){.item_0c172421.itemIsSelected_0c172421{-ms-high-contrast-adjust:none}}.item_0c172421.itemIsSelected_0c172421.itemIsDisabled_0c172421{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";background-color:transparent}.header_0c172421{font-size:14px;font-weight:400;font-weight:600;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background:none;border:none;height:32px;line-height:32px;cursor:default;padding:0px 16px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html[dir='ltr'] .header_0c172421{text-align:left}html[dir='rtl'] .header_0c172421{text-align:right}.divider_0c172421{height:1px;background-color:"},{theme:"bodyDivider",defaultValue:"#c8c8c8"},{rawString:"}.optionText_0c172421{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;min-width:0px;max-width:100%;word-wrap:break-word;overflow-wrap:break-word;margin:1px}\n"}]);t.root="root_0c172421";t.title="title_0c172421";t.caretDown="caretDown_0c172421";t.titleIsPlaceHolder="titleIsPlaceHolder_0c172421";t.titleIsError="titleIsError_0c172421";t.rootIsDisabled="rootIsDisabled_0c172421";t.listWrapper="listWrapper_0c172421";t.caretDownWrapper="caretDownWrapper_0c172421";t.panel="panel_0c172421";t.callout="callout_0c172421";t.errorMessage="errorMessage_0c172421";t.items="items_0c172421";t.item="item_0c172421";t.itemIsDisabled="itemIsDisabled_0c172421";t.itemIsSelected="itemIsSelected_0c172421";t.header="header_0c172421";t.divider="divider_0c172421";t.optionText="optionText_0c172421"});define("Jm",["require","exports","ap","at","BT","Dz","IS","Dn","jP","V"],function(e,t,r,o,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={choicesText:t.props.choicesText,useCalculatedDefaultValue:t.props.useCalculatedDefaultValue,defaultValueDropdownOptions:[t.props.defaultValue],defaultFormula:t.props.defaultFormula,defaultValue:t.props.defaultValue};return t}e.prototype.componentWillMount=function(){this._choicesChanged(this.state.choicesText)};e.prototype.render=function(){var e=this.props.strings;return o.createElement("div",{className:this.props.className?this.props.className+" ms-ColumnManagementPanel-uniqueFields":"ms-ColumnManagementPanel-uniqueFields"},o.createElement(n.TextField,{className:"ms-ColumnManagementPanel-choicesTextField",label:e.choicesLabel,value:this.state.choicesText,ariaLabel:e.choicesAriaLabel,onChanged:this._choicesChanged,required:!0,multiline:!0,rows:9}),o.createElement("div",{className:"ms-ColumnManagementPanel-allowManuallyAddValues"},o.createElement(a.Checkbox,{className:"ms-ColumnManagementPanel-checkbox",label:e.manuallyAddValuesCheckbox,defaultChecked:this.props.fillInChoice,componentRef:this._resolveRef("_fillInChoice")}),o.createElement(s.InfoTeachingIcon,{className:"ms-ColumnManagementPanel-checkboxInfo",infoButtonAriaLabel:e.infoButtonAriaLabelFormat?c.format(e.infoButtonAriaLabelFormat,e.manuallyAddValuesCheckbox):e.infoButtonAriaLabel,calloutContent:e.manuallyAddValuesTeachingBubble})),o.createElement("div",{className:"ms-ColumnManagementPanel-defaultValueContainer"},this.state.useCalculatedDefaultValue?o.createElement(n.TextField,{className:"ms-ColumnManagementPanel-defaultValueEntryField",placeholder:e.defaultFormulaPlaceholder,ariaLabel:e.defaultFormulaAriaLabel,label:e.defaultValueHeader,value:this.state.defaultFormula,onChanged:this._defaultFormulaChanged}):o.createElement(l.Dropdown,{className:"ms-ColumnManagementPanel-defaultValueDropdown",label:e.defaultValueHeader,ariaLabel:e.defaultValueDropdownAriaLabel,options:this.state.defaultValueDropdownOptions,selectedKey:this.state.defaultValue.key,onChanged:this._choiceDropdownChanged}),o.createElement("div",{className:"ms-ColumnManagementPanel-useCalculatedValue"},o.createElement(a.Checkbox,{className:"ms-ColumnManagementPanel-checkbox",label:e.useCalculatedValue,checked:this.state.useCalculatedDefaultValue,onChange:this._onUseCalculatedValueChanged}),o.createElement(s.InfoTeachingIcon,{className:"ms-ColumnManagementPanel-checkboxInfo",infoButtonAriaLabel:e.infoButtonAriaLabelFormat?c.format(e.infoButtonAriaLabelFormat,e.useCalculatedValue):e.infoButtonAriaLabel,calloutContent:e.useCalculatedValueTeachingBubble,helpLink:{href:this.props.formulaLearnMoreLink,displayText:e.formulaLearnMoreLink}}))))};e.prototype.getSchemaValues=function(){return{Choices:this.state.choicesText.split(/\r\n|\r|\n/g).filter(function(e){return e}),DefaultValue:this.state.useCalculatedDefaultValue||"0"===this.state.defaultValue.key?null:this.state.defaultValue.text,DefaultFormula:this.state.useCalculatedDefaultValue?this.state.defaultFormula:null,FillInChoice:this._fillInChoice.checked}};e.prototype.getRequiredValues=function(){return{choicesText:this.state.choicesText}};e.prototype._choicesChanged=function(e){for(var t=e.split(/\r\n|\r|\n/g),i=[{key:"0",text:this.props.strings.choiceDefaultValue}],r=0;r<t.length;r++)t[r]&&i.push({key:String(r+1),text:t[r]});var o=this.state.defaultValue,n=t.indexOf(o.text);-1===n?o=i[0]:o.key!==String(n+1)&&(o.key=String(n+1));this.setState({choicesText:e,defaultValueDropdownOptions:i,defaultValue:o});this.props.updateSaveDisabled({choicesText:e})};e.prototype._onUseCalculatedValueChanged=function(){this.setState(function(e){return{useCalculatedDefaultValue:!e.useCalculatedDefaultValue}})};e.prototype._defaultFormulaChanged=function(e){this.setState({defaultFormula:e})};e.prototype._choiceDropdownChanged=function(e){this.setState({defaultValue:e})};r.__decorate([d.autobind],e.prototype,"getSchemaValues",null);r.__decorate([d.autobind],e.prototype,"getRequiredValues",null);r.__decorate([d.autobind],e.prototype,"_choicesChanged",null);r.__decorate([d.autobind],e.prototype,"_onUseCalculatedValueChanged",null);r.__decorate([d.autobind],e.prototype,"_defaultFormulaChanged",null);r.__decorate([d.autobind],e.prototype,"_choiceDropdownChanged",null);return e}(d.BaseComponent);t.ChoiceColumnUniqueFields=i});define("IS",["require","exports","ap","IV","IU","IT"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t)});define("IV",["require","exports","ap","at","wE","BM","mh","wN","jP"],function(e,t,r,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isCalloutOpen:!1};return t}e.prototype.render=function(){var e={beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:1,onDismiss:this._showHideCallout,target:this._infoButton,role:"alertdialog",ariaDescribedBy:"callout-description"};return o.createElement("div",{className:this.props.className?this.props.className+" ms-ColumnManagementPanel-infoTeachingIcon":"ms-ColumnManagementPanel-InfoTeachingIcon"},this.props.label&&o.createElement("span",{className:"ms-ColumnManagementPanel-infoLabel"},this.props.label),o.createElement("span",{className:"ms-ColumnManagementPanel-infoIconContainer",ref:this._resolveRef("_infoButton")},o.createElement(l.IconButton,{className:"ms-ColumnManagementPanel-infoIcon",iconProps:{iconName:"Info"},ariaLabel:this.props.infoButtonAriaLabel,onClick:this._showHideCallout})),this.state.isCalloutOpen&&o.createElement(n.Callout,r.__assign({className:"ms-ColumnManagementPanel-callout"},e),o.createElement(a.FocusTrapZone,{isClickableOutsideFocusTrap:!0},o.createElement("div",{className:"ms-ColumnManagementPanel-calloutInner",tabIndex:1},o.createElement("div",{className:"ms-ColumnManagementPanel-calloutContent"},o.createElement("p",{className:"ms-ColumnManagementPanel-calloutSubText",id:"callout-description"},this.props.calloutContent)),this.props.helpLink&&o.createElement("div",{className:"ms-ColumnManagementPanel-calloutActions"},o.createElement(s.Link,{className:"ms-ColumnManagementPanel-calloutLink",href:this.props.helpLink.href,target:"_blank",tabIndex:1},this.props.helpLink.displayText))))))};e.prototype._showHideCallout=function(){this.setState(function(e){return{isCalloutOpen:!e.isCalloutOpen}})};r.__decorate([d.autobind],e.prototype,"_showHideCallout",null);return e}(d.BaseComponent);t.InfoTeachingIcon=i});define("IU",["require","exports","ap","at","jP","BT","Dz","IV","V"],function(e,t,r,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={useCalculatedDefaultValue:t.props.useCalculatedDefaultValue,defaultFormula:t.props.defaultFormula,defaultValue:t.props.defaultValue,defaultValueErrorMessage:""};return t}e.prototype.render=function(){var e=this.props.strings;return o.createElement("div",{className:"defaultValueEntryField ms-ColumnManagementPanel-uniqueFields"},this.state.useCalculatedDefaultValue?o.createElement(a.TextField,{className:"ms-ColumnManagementPanel-defaultFormulaEntryField",placeholder:e.defaultFormulaPlaceholder,ariaLabel:e.defaultFormulaAriaLabel,label:e.defaultValueHeader,value:this.state.defaultFormula,onChanged:this._defaultFormulaChanged}):o.createElement(a.TextField,{className:"ms-ColumnManagementPanel-defaultValueEntryField",placeholder:this.props.defaultValuePlaceholder,ariaLabel:this.props.defaultValueAriaLabel,label:e.defaultValueHeader,value:this.state.defaultValue,onChanged:this._defaultValueChanged,errorMessage:this.state.defaultValueErrorMessage}),o.createElement("div",{className:"ms-ColumnManagementPanel-useCalculatedValue"},o.createElement(s.Checkbox,{className:"ms-ColumnManagementPanel-checkbox",label:e.useCalculatedValue,checked:this.state.useCalculatedDefaultValue,onChange:this._onUseCalculatedValueChanged}),o.createElement(l.InfoTeachingIcon,{className:"ms-ColumnManagementPanel-checkboxInfo",infoButtonAriaLabel:e.infoButtonAriaLabelFormat?d.format(e.infoButtonAriaLabelFormat,e.useCalculatedValue):e.infoButtonAriaLabel,calloutContent:e.useCalculatedValueTeachingBubble,helpLink:{href:this.props.formulaLearnMoreLink,displayText:e.formulaLearnMoreLink}})))};e.prototype.getSchemaValues=function(){return!(!this.state.useCalculatedDefaultValue&&this.state.defaultValueErrorMessage)&&{DefaultValue:this.state.useCalculatedDefaultValue?null:this.state.defaultValue,DefaultFormula:this.state.useCalculatedDefaultValue?this.state.defaultFormula:null}};e.prototype._onUseCalculatedValueChanged=function(){this.setState(function(e){return{useCalculatedDefaultValue:!e.useCalculatedDefaultValue}})};e.prototype._defaultFormulaChanged=function(e){this.setState({defaultFormula:e})};e.prototype._defaultValueChanged=function(e){this.setState({defaultValue:e,defaultValueErrorMessage:this.props.checkIsNumber&&isNaN(Number(e))?this.props.strings.defaultNumberNotValid:""})};r.__decorate([n.autobind],e.prototype,"getSchemaValues",null);r.__decorate([n.autobind],e.prototype,"_onUseCalculatedValueChanged",null);r.__decorate([n.autobind],e.prototype,"_defaultFormulaChanged",null);r.__decorate([n.autobind],e.prototype,"_defaultValueChanged",null);return e}(n.BaseComponent);t.DefaultValueEntryField=i});define("IT",["require","exports","ap","at","jP","Dn","GL"],function(e,t,i,r,o,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this;t._fieldTypeDropdownOptions=[];for(var i=0;i<t.props.supportedTypes.length;i++){var r=t.props.supportedTypes[i];if(l.FieldType[r]===l.FieldType.URL){var o={key:"Hyperlink",text:t.props.strings.displayNameHyperlink},n={key:"Picture",text:t.props.strings.displayNamePicture};t._fieldTypeDropdownOptions.push(o);t._fieldTypeDropdownOptions.push(n)}else{var a={key:r,text:t.props.strings["displayName"+r]};t._fieldTypeDropdownOptions.push(a)}}return t}e.prototype.render=function(){var e=this.props.strings,t=l.FieldType[this.props.fieldType];this.props.fieldType===l.FieldType.URL&&(t=this.props.isHyperlink?"Hyperlink":"Picture");return r.createElement("div",{className:this.props.className},r.createElement(n.Dropdown,{className:"ms-ColumnManagementPanel-typeDropdown",label:e.fieldTypeDropdownLabel,ariaLabel:e.fieldTypeDropdownAriaLabel,options:this._fieldTypeDropdownOptions,disabled:1===this._fieldTypeDropdownOptions.length,selectedKey:t,onChanged:this._fieldTypeChanged}))};e.prototype._fieldTypeChanged=function(e){var t,i=e.key;if("Hyperlink"===e.key){i="URL";t=!0}else if("Picture"===e.key){i="URL";t=!1}this.props.updateFieldType(l.FieldType[i],t)};i.__decorate([o.autobind],e.prototype,"_fieldTypeChanged",null);return e}(o.BaseComponent);t.FieldTypeSwitcher=a});define("Jl",["require","exports","ap","at","jP","IS","Dn","Dz"],function(e,t,i,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._decimalPlacesDropdownOptions=[{key:"0",text:t.props.strings.decimalPlacesAutomatic}];for(var i=0;i<6;i++)t._decimalPlacesDropdownOptions.push({key:String(i+1),text:String(i)});t.state={decimalPlaces:t._decimalPlacesDropdownOptions[t.props.displayFormat+1]};return t}e.prototype.render=function(){var e=this.props.strings;return o.createElement("div",{className:this.props.className?this.props.className+" ms-ColumnManagementPanel-uniqueFields":"ms-ColumnManagementPanel-uniqueFields"},o.createElement(s.Dropdown,{className:"ms-ColumnManagementPanel-decimalsDropdown",label:e.decimalPlacesDropdownLabel,ariaLabel:e.decimalPlacesDropdownAriaLabel,options:this._decimalPlacesDropdownOptions,selectedKey:this.state.decimalPlaces.key,onChanged:this._decimalDropdownChanged}),o.createElement(l.Checkbox,{className:"ms-ColumnManagementPanel-showAsPercentageCheckbox ms-ColumnManagementPanel-checkboxNoInfo",label:e.showAsPercentageCheckbox,defaultChecked:this.props.showAsPercentage,componentRef:this._resolveRef("_showAsPercentage")}),o.createElement(a.DefaultValueEntryField,{defaultValue:this.props.defaultValue,defaultFormula:this.props.defaultFormula,useCalculatedDefaultValue:this.props.useCalculatedDefaultValue,formulaLearnMoreLink:this.props.formulaLearnMoreLink,strings:e,defaultValuePlaceholder:e.enterNumberPlaceholder,defaultValueAriaLabel:e.defaultNumberAriaLabel,checkIsNumber:!0,ref:this._resolveRef("_defaultValue")}))};e.prototype.getSchemaValues=function(){var e=this._defaultValue.getSchemaValues();if(e){e.Percentage=this._showAsPercentage.checked;e.Decimals="0"===this.state.decimalPlaces.key?null:Number(this.state.decimalPlaces.text);return e}return!1};e.prototype._decimalDropdownChanged=function(e){this.setState({decimalPlaces:e})};i.__decorate([n.autobind],e.prototype,"getSchemaValues",null);i.__decorate([n.autobind],e.prototype,"_decimalDropdownChanged",null);return e}(n.BaseComponent);t.NumberColumnUniqueFields=r});define("Jk",["require","exports","ap","at","jP","Dz"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){var e=this.props.strings;return r.createElement("div",{className:this.props.className?this.props.className+" ms-ColumnManagementPanel-uniqueFields":"ms-ColumnManagementPanel-uniqueFields"},r.createElement(n.Checkbox,{className:"ms-ColumnManagementPanel-allowGroupsCheckbox ms-ColumnManagementPanel-checkboxNoInfo",label:e.allowSelectionOfGroupsCheckbox,defaultChecked:1===this.props.selectionMode,componentRef:this._resolveRef("_userSelectionMode")}))};e.prototype.getSchemaValues=function(){return{UserSelectionMode:this._userSelectionMode.checked?"1":"0"}};i.__decorate([o.autobind],e.prototype,"getSchemaValues",null);return e}(o.BaseComponent);t.UserColumnUniqueFields=a});define("Jj",["require","exports","ap","at","jP","IS","Dn","o1"],function(e,t,i,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._decimalPlacesDropdownOptions=[{key:"0",text:t.props.strings.decimalPlacesAutomatic}];for(var i=0;i<6;i++)t._decimalPlacesDropdownOptions.push({key:String(i+1),text:String(i)});t.state={decimalPlaces:t._decimalPlacesDropdownOptions[t.props.displayFormat+1],currencyListItem:{key:1033,text:"$123,456.00 (United States)"},currencyInformationDropdownOptions:[{key:1033,text:"$123,456.00 (United States)"}],isLoading:!0,failedToLoad:!1};return t}e.prototype.componentDidMount=function(){var s=this;this.props.currencyListPromise.then(function(e){for(var t=[],i=s.state.currencyListItem,r=0,o=e;r<o.length;r++){var n=o[r],a={key:Number(n.LCID),text:n.DisplayString};t.push(a);Number(n.LCID)===s.props.currencyLocaleId&&(i=a)}s.setState({isLoading:!1,currencyListItem:i,currencyInformationDropdownOptions:t})},function(e){s.setState({isLoading:!1,failedToLoad:!0})})};e.prototype.render=function(){var e=this.props.strings;return o.createElement("div",{className:this.props.className?this.props.className+" ms-ColumnManagementPanel-uniqueFields":"ms-ColumnManagementPanel-uniqueFields"},o.createElement(s.Dropdown,{className:"ms-ColumnManagementPanel-decimalsDropdown",label:e.decimalPlacesDropdownLabel,ariaLabel:e.decimalPlacesDropdownAriaLabel,options:this._decimalPlacesDropdownOptions,selectedKey:this.state.decimalPlaces.key,onChanged:this._decimalDropdownChanged}),o.createElement("div",{className:"ms-ColumnManagementPanel-currencyListLabel"},e.currencyListItemDropdownLabel),o.createElement("div",{className:"ms-ColumnManagementPanel-currencyDropdownContainer"},this.state.isLoading&&o.createElement(l.Spinner,{className:"ms-ColumnManagementPanel-currencySpinner",type:l.SpinnerType.normal}),o.createElement(s.Dropdown,{className:n.css("ms-ColumnManagementPanel-currenciesDropdown",{hidden:this.state.isLoading}),ariaLabel:e.currencyListDropdownAriaLabel,options:this.state.currencyInformationDropdownOptions,selectedKey:this.state.currencyListItem.key,onChanged:this._currencyDropdownChanged,disabled:this.state.failedToLoad}),o.createElement("div",{role:"region","aria-live":"polite",className:"ms-ColumnManagementPanel-currenciesLoadingError"},this.state.failedToLoad&&o.createElement("span",null,e.failureToLoadCurrencyList))),o.createElement(a.DefaultValueEntryField,{defaultValue:this.props.defaultValue,defaultFormula:this.props.defaultFormula,useCalculatedDefaultValue:this.props.useCalculatedDefaultValue,formulaLearnMoreLink:this.props.formulaLearnMoreLink,strings:e,defaultValuePlaceholder:e.enterNumberPlaceholder,defaultValueAriaLabel:e.defaultNumberAriaLabel,checkIsNumber:!0,ref:this._resolveRef("_defaultValue")}))};e.prototype.getSchemaValues=function(){var e=this._defaultValue.getSchemaValues();if(e){e.Decimals="0"===this.state.decimalPlaces.key?null:Number(this.state.decimalPlaces.text);e.LCID=Number(this.state.currencyListItem.key);return e}return!1};e.prototype._decimalDropdownChanged=function(e){this.setState({decimalPlaces:e})};e.prototype._currencyDropdownChanged=function(e){this.setState({currencyListItem:e})};i.__decorate([n.autobind],e.prototype,"getSchemaValues",null);i.__decorate([n.autobind],e.prototype,"_decimalDropdownChanged",null);i.__decorate([n.autobind],e.prototype,"_currencyDropdownChanged",null);return e}(n.BaseComponent);t.CurrencyColumnUniqueFields=r});define("I7",["require","exports","ap","at","jP","IY","Dn","BT","Dz","IS","Ji","I8","V","GL","aC"],function(e,t,i,h,r,f,g,y,v,_,b,x,S,c,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,u="[today]";!function(e){e[e.None=0]="None";e[e.Today=1]="Today";e[e.SelectDate=2]="SelectDate"}(o||(o={}));!function(e){e[e.Disabled=1]="Disabled";e[e.Relative=2]="Relative"}(t.DateTimeFieldFriendlyFormatType||(t.DateTimeFieldFriendlyFormatType={}));var n=function(d){i.__extends(e,d);function e(e){var i=d.call(this,e)||this;i._displayFormatChanged=function(e){i.setState({displayFormat:Number(e)})};i._friendlyFormatChanged=function(e){var t;t=e?2:1;i.setState({friendlyDisplayFormat:t})};i._defaultOptionDropdownChanged=function(e){i.setState({defaultOption:e})};i._defaultFormulaChanged=function(e){i.setState({defaultFormula:e})};i._onUseCalculatedValueChanged=function(){i.setState(function(e){return{useCalculatedDefaultValue:!e.useCalculatedDefaultValue}})};var t,r=i.props,o=r.defaultValue,n=r.displayFormat,a=r.friendlyDisplayFormat,s=r.useCalculatedDefaultValue,l=r.defaultFormula;i._listDataSource=new c.ListDataSource(i.props.pageContext);i._dropdownOptions=[{key:0,text:b.default.noneDropdownOption},{key:1,text:b.default.todayDropdownOption},{key:2,text:b.default.selectDateTimeDropdownOption}];if(o)if(o===u){t=1;o=""}else t=2;else t=0;i.state={displayFormat:n<0?0:n,friendlyDisplayFormat:a<0?1:a,defaultOption:i._dropdownOptions[t],useCalculatedDefaultValue:s,defaultFormula:l,defaultValue:o};return i}e.prototype.componentDidMount=function(){var t=this;this.props.regionalDateTimeSchemaPromise.then(function(e){t.setState({schema:e})})};e.prototype.render=function(){var e=this.props,t=e.strings,i=e.pageContext,r=e.formulaLearnMoreLink,o=this.state,n=o.defaultOption,a=o.defaultValue,s=o.displayFormat,l=o.schema,d=o.defaultDateErrorMessage,c=o.defaultFormula,u=o.useCalculatedDefaultValue,p=h.createElement("div",{className:"ms-ColumnManagementPanel-useCalculatedValue"},h.createElement(v.Checkbox,{className:"ms-ColumnManagementPanel-checkbox",label:t.useCalculatedValue,checked:u,onChange:this._onUseCalculatedValueChanged}),h.createElement(_.InfoTeachingIcon,{className:"ms-ColumnManagementPanel-checkboxInfo",infoButtonAriaLabel:t.infoButtonAriaLabelFormat?S.format(t.infoButtonAriaLabelFormat,t.useCalculatedValue):t.infoButtonAriaLabel,calloutContent:t.useCalculatedValueTeachingBubble,helpLink:{href:r,displayText:t.formulaLearnMoreLink}})),m=u?h.createElement("div",null,h.createElement(y.TextField,{className:"ms-ColumnManagementPanel-defaultValueEntryField",placeholder:t.defaultFormulaPlaceholder,ariaLabel:t.defaultFormulaAriaLabel,label:t.defaultValueHeader,value:c,onChanged:this._defaultFormulaChanged}),p):h.createElement("div",null,h.createElement(g.Dropdown,{className:"ms-ColumnManagementPanel-defaultValueDropdown",label:t.defaultValueHeader,ariaLabel:t.defaultValueHeader,options:this._dropdownOptions,selectedKey:this.state.defaultOption.key,onChanged:this._defaultOptionDropdownChanged}),l&&n===this._dropdownOptions[2]&&h.createElement(x.DateTimePicker,{className:"ms-ColumnManagementPanel-dateTimePicker",schema:l,data:a,pageContext:i,displayFormat:s,errorMessage:d,ref:this._resolveRef("_dateTimePicker")}),p);return h.createElement("div",{className:this.props.className?this.props.className+" ms-ColumnManagementPanel-uniqueFields":"ms-ColumnManagementPanel-uniqueFields"},h.createElement(f.Toggle,{className:"ms-ColumnManagementPanel-toggle",checked:1===this.state.displayFormat,label:b.default.includeTimeToggle,onText:t.toggleOnText,offText:t.toggleOffText,onChanged:this._displayFormatChanged}),h.createElement(f.Toggle,{className:"ms-ColumnManagementPanel-toggle",checked:2===this.state.friendlyDisplayFormat,label:b.default.friendlyFormatToggle,onText:t.toggleOnText,offText:t.toggleOffText,onChanged:this._friendlyFormatChanged}),m)};e.prototype.onSaveClick=function(){var i=this,e=this.state,t=e.useCalculatedDefaultValue,r=e.defaultOption,o=e.displayFormat,n=e.schema;if(t)return s.default.wrap();if(r===this._dropdownOptions[2]){var a=this._dateTimePicker&&this._dateTimePicker.getData();this.setState({defaultValue:a});return this._listDataSource.parseDateTime(a,o,n.CalendarType).then(function(e){i.setState({defaultDateErrorMessage:""})},function(e){if(-2146232832!==(e&&e.code&&Number(e.code.split(",")[0])))return s.default.wrapError(e);var t=e&&e.message&&e.message.value;i.setState({defaultDateErrorMessage:t})})}};e.prototype.getSchemaValues=function(){var e,t,i=this.state,r=1===i.displayFormat?"DateTime":"DateOnly",o=1===i.friendlyDisplayFormat?"Disabled":"Relative";if(i.defaultDateErrorMessage)return!1;this.state.useCalculatedDefaultValue?t=this.state.defaultFormula:e=this._computeDefaultValue();return{DefaultValue:e,DefaultFormula:t,Format:r,FriendlyDisplayFormat:o}};e.prototype._computeDefaultValue=function(){var e;1===this.state.defaultOption.key?e=u:2===this.state.defaultOption.key&&(e=this.state.defaultValue);return e};i.__decorate([r.autobind],e.prototype,"getSchemaValues",null);return e}(r.BaseComponent);t.DateTimeColumnUniqueFields=n});define("IY",["require","exports","ap","IZ"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("IZ",["require","exports","ap","I0"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("I0",["require","exports","ap","at","jP","BZ","jP","I1"],function(e,t,f,g,y,v,i,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){f.__extends(e,t);function e(e){var s=t.call(this,e)||this;s._toggleButton=y.createRef();s._onClick=function(e){var t=s.props,i=t.disabled,r=t.checked,o=t.onChanged,n=t.onClick,a=s.state.isChecked;if(!i){void 0===r&&s.setState({isChecked:!a});o&&o(!a);n&&n(e)}};s._warnMutuallyExclusive({checked:"defaultChecked"});s.state={isChecked:!(!e.checked&&!e.defaultChecked)};s._id=e.id||y.getId("Toggle");return s}Object.defineProperty(e.prototype,"checked",{get:function(){return this.state.isChecked},enumerable:!0,configurable:!0});e.prototype.componentWillReceiveProps=function(e){void 0!==e.checked&&this.setState({isChecked:!!e.checked})};e.prototype.render=function(){var e=this.props,t=e.className,i=e.theme,r=e.styles,o=e.disabled,n=e.label,a=e.offAriaLabel,s=e.offText,l=e.onAriaLabel,d=e.onText,c=this.state.isChecked,u=c?d:s,p=c?l:a,m=y.getNativeProps(this.props,y.inputProperties,["defaultChecked"]),h=_.getClassNames(i,r,t,o,c);return g.createElement("div",{className:h.root},n&&g.createElement(v.Label,{htmlFor:this._id,className:h.label},n),g.createElement("div",{className:h.container},g.createElement("button",f.__assign({},m,{className:h.pill,disabled:o,id:this._id,type:"button",ref:this._toggleButton,"aria-disabled":o,"aria-pressed":c,"aria-label":p||n,"data-is-focusable":!0,onChange:this._noop,onClick:this._onClick}),g.createElement("div",{className:h.thumb})),u&&g.createElement(v.Label,{htmlFor:this._id,className:h.text},u)))};e.prototype.focus=function(){this._toggleButton.current&&this._toggleButton.current.focus()};e.prototype._noop=function(){};return e=f.__decorate([i.customizable("Toggle",["theme"])],e)}(y.BaseComponent);t.Toggle=r});define("I1",["require","exports","jP","d"],function(e,t,i,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getClassNames=i.memoizeFunction(function(e,t,i,r,o){var n,a,s,l,d=e.semanticColors,c=d.bodyBackground,u=d.inputBackgroundChecked,p=d.inputBackgroundCheckedHovered,m=d.disabledBodyText,h=d.inputBorderHovered,f=d.inputForegroundChecked,g=d.disabledBodyText,y=d.disabledBackground,v=d.smallInputBorder,_=d.inputBorderHovered,b=d.disabledBodyText,x=d.disabledText;t=t||{};return S.mergeStyleSets({root:["ms-Toggle",o&&"is-checked",!r&&"is-enabled",r&&"is-disabled",e.fonts.medium,{marginBottom:"8px"},i,t.root],label:["ms-Toggle-label",t.label,r&&{color:x,selectors:(n={},n[S.HighContrastSelector]={color:"GrayText"},n)}],container:["ms-Toggle-innerContainer",{display:"inline-flex",position:"relative"},t.container],pill:["ms-Toggle-background",S.getFocusStyle(e,-3),{fontSize:"20px",boxSizing:"border-box",width:"2.2em",height:"1em",borderRadius:"1em",transition:"all 0.1s ease",borderWidth:"1px",borderStyle:"solid",background:c,borderColor:v,cursor:"pointer",display:"flex",alignItems:"center",padding:"0 .2em"},t.pill,!r&&[!o&&{selectors:{":hover":[{borderColor:_},t.pillHovered],":hover .ms-Toggle-thumb":t.thumbHovered}},o&&[{background:u,borderColor:"transparent",justifyContent:"flex-end"},t.pillChecked,{selectors:(a={":hover":[{backgroundColor:p,borderColor:"transparent"},t.pillCheckedHovered],":hover .ms-Toggle-thumb":[t.thumbCheckedHovered]},a[S.HighContrastSelector]={backgroundColor:"WindowText"},a)}]],r&&[{cursor:"default"},!o&&[{borderColor:b},t.pillDisabled],o&&[{backgroundColor:m,borderColor:"transparent",justifyContent:"flex-end"},t.pillCheckedDisabled]]],thumb:["ms-Toggle-thumb",{width:".5em",height:".5em",borderRadius:".5em",transition:"all 0.1s ease",backgroundColor:h,borderColor:"transparent",borderWidth:".28em",borderStyle:"solid",boxSizing:"border-box"},t.thumb,!r&&o&&[{backgroundColor:f,selectors:(s={},s[S.HighContrastSelector]={backgroundColor:"Window",borderColor:"Window"},s)},t.thumbChecked],r&&[!o&&[{backgroundColor:g},t.thumbDisabled],o&&[{backgroundColor:y},t.thumbCheckedDisabled]]],text:["ms-Toggle-stateText",{selectors:{"&&":{padding:"0",margin:"0 10px",userSelect:"none"}}},r&&{selectors:{"&&":{color:x,selectors:(l={},l[S.HighContrastSelector]={color:"GrayText"},l)}}},t.text]})})});define("I8",["require","exports","ap","at","BT","jP","wN","wE","Jc","eq","U","aM","d","Jb","Ja","I9"],function(e,t,i,h,f,g,y,v,_,r,o,n,a,b,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=a.getTheme(),s=function(t){i.__extends(e,t);function e(e){var o=t.call(this,e)||this;o._isAMPMFirst=null;o._onDateEditorFocus=function(e){o._setEditorFocusStatus();o._dateEditor&&o._dateEditor.select();o.setState({isDateContainerFocused:!0})};o._onDateEditorBlur=function(e){o.setState({isDateContainerFocused:!1});o._onDateTimeEditorBlur(e)};o._onDateTimeEditorBlur=function(e){o._editorHasFocus=!1;o._timeOut=o._async.setTimeout(function(){return o._endEdit(e)},100)};o._onDatePickerButtonFocus=function(e){o.setState({isDateContainerFocused:!0});o._setEditorFocusStatus()};o._onDatePickerButtonBlur=function(e){o._editorHasFocus=!1;o.setState({isDateContainerFocused:!1})};o._dateEditButtonOnClick=function(){o._async.clearTimeout(o._timeOut);o._editorHasFocus=!0;var e=o.state.isEditingPanelOpen;o.setState({isEditingPanelOpen:!e})};o._setEditorFocusStatus=function(){o._editorHasFocus=!0;o._timeOut&&o._async.clearTimeout(o._timeOut)};o._endEdit=function(e){o.props.endEdit&&o.props.endEdit(e)};o._onTimeChange=function(e,t,i){var r=e&&e.text;r||(r=i);o.setState({latestTime:r});o._timeOut=o._async.setTimeout(function(){return o._endEdit(null)},100)};o._onDateEditorChanged=function(e){o.setState({latestDate:e})};o._onDatePickerLoad=function(){if(o._frame){o._frame.resultfield||(o._frame.resultfield=o._dateEditor);void 0===o._frame.firstUp&&(o._frame.firstUp=!0);o._frame.OnSelectDateCallback||(o._frame.OnSelectDateCallback=function(e,t,i){o._dateEditor.focus();o.setState({isEditingPanelOpen:!1,latestDate:t})})}};o._onDatePickerDismiss=function(){o._editorHasFocus=!1;o.setState({isEditingPanelOpen:!1})};o._dateEditorElement=null;o._iframeBaseUrl=null;o._editorHasFocus=!1;o._isAMPMFirst=c.default.isAMPMFirst(o.props.schema);o.state=o._computeState(o.props);return o}e.prototype.getData=function(){return this._getLatestDateTimeValue()};e.prototype.render=function(){var t=this,e=this.props,i=e.underlined,r=void 0===i||i,o=e.className,n=this.state,a=n.isDateContainerFocused,s=n.isEditingPanelOpen,l=n.errorMessage,d=this._getDateTimeIframeControlUrl(),c=d?h.createElement(y.IconButton,{className:"sp-DateTimePicker-DateButton",iconProps:{iconName:"Calendar"},title:b.default.calendarButtonTitle,ariaLabel:b.default.openCalendarButtonLabel,onClick:function(){return t._dateEditButtonOnClick()},onFocus:this._onDatePickerButtonFocus,onBlur:this._onDatePickerButtonBlur}):null,u=this.state.isEditingPanelOpen&&d?h.createElement(v.Callout,{isBeakVisible:!1,gapSpace:0,directionalHint:4,directionalHintFixed:!0,target:this._dateEditorElement,onDismiss:this._onDatePickerDismiss},h.createElement("iframe",{className:"ms-slideDownIn20 sp-DateTimePicker-iFrame",src:d,onLoad:this._onDatePickerLoad,ref:function(e){t._frame=e}})):null,p=this.state.dateOnly?null:h.createElement(_.ComboBox,{styles:{root:{borderColor:x.semanticColors.inputBorder,borderTopWidth:0,borderLeftWidth:0,borderRightWidth:0,marginBottom:0}},className:"sp-DateTimePicker-Time",allowFreeform:!0,value:this.state.latestTime,options:this._timeChoices,onChanged:this._onTimeChange,onBlur:this._onDateTimeEditorBlur,onFocus:this._setEditorFocusStatus,ariaLabel:b.default.timeInputLabel}),m=l?h.createElement("div",{className:"sp-DateTimePicker-errorMessage"},l):null;return h.createElement("div",{className:g.css("sp-DateTimePicker",o)},h.createElement("div",{ref:function(e){return t._dateEditorElement=e},className:g.css("sp-DateTimePicker-DateContainer",{"is-focused":a||s})},h.createElement(f.TextField,{placeholder:b.default.datePlaceHolder,ariaLabel:b.default.dateInputLabel,className:"sp-DateTimePicker-Date",value:this.state.latestDate,onChanged:this._onDateEditorChanged,borderless:!0,underlined:r,onBlur:this._onDateEditorBlur,onFocus:this._onDateEditorFocus,componentRef:function(e){return t._dateEditor=e}}),c),p,u,m)};e.prototype.componentWillReceiveProps=function(e){e.displayFormat===this.props.displayFormat&&e.errorMessage===this.props.errorMessage||this.setState(this._computeState(e))};e.prototype.componentWillUnmount=function(){this._frame&&(this._frame.src="")};e.prototype.focusOnEditorIfNeeded=function(){if(this._dateEditor&&!this._editorHasFocus){this._dateEditor.focus();this._dateEditor.select()}};e.prototype.cancelEdit=function(e){var t=c.default.parseDate(e,this.props.schema);this.setState({latestDate:t.Date})};e.prototype._computeState=function(e){var t=e.schema,i=e.data,r=e.displayFormat,o=e.errorMessage,n=0===r,a=c.default.parseDate(i,t),s=a.Date,l="";if(!n){l=t.HoursOptions[Number(a.Hour)];if(t.HoursMode24||!1!==this._isAMPMFirst){-1===l.indexOf(t.TimeSeparator)&&(l+=t.TimeSeparator);l+=a.Minute}else{var d=l.split(" ");l=d[0]+t.TimeSeparator+a.Minute+" "+d[1]}this._populateTimeChoiceArray(t)}return{schema:t,data:i,latestDate:s,latestTime:l,dateOnly:n,errorMessage:o}};e.prototype._getLatestDateTimeValue=function(e){var t=e?e.trim():this._dateEditor.value.trim(),i=this.state.schema;if(!this.state.dateOnly){var r=i.HoursMode24?this.state.latestTime:this._convertTimeTo24Hour(this.state.latestTime);t=""===t?"":t+" "+r}return t};e.prototype._convertTimeTo24Hour=function(e){var t=e.toUpperCase(),i=this._AMDesignator.toUpperCase(),r=this._PMDesignator.toUpperCase(),o=t.indexOf(i),n=t.indexOf(r);if(-1!==o){var a=(t=t.replace(i,"")).split(":");if(12===(s=Number(a[0]))){a[0]=String(0);t=a.join(":")}}else if(-1!==n){var s;a=(t=t.replace(r,"")).split(":");if(12!==(s=Number(a[0]))){a[0]=String(s+12);t=a.join(":")}}return t.replace(/\s+/g,"")};e.prototype._populateTimeChoiceArray=function(e){this._timeChoices=[];if(e.HoursMode24)for(var t=0,i=e.HoursOptions;t<i.length;t++){var r=i[t];this._timeChoices.push({key:r+"00",text:r+"00"});this._timeChoices.push({key:r+"30",text:r+"30"})}else for(var o=e.TimeSeparator,n=0;n<e.HoursOptions.length;n++){var a=(r=e.HoursOptions[n]).split(" ");0===n&&(this._AMDesignator=this._isAMPMFirst?a[0]:a[1]);12===n&&(this._PMDesignator=this._isAMPMFirst?a[0]:a[1]);this._timeChoices.push({key:n+o+"00",text:this._isAMPMFirst?r+o+"00":a[0]+o+"00 "+a[1]});this._timeChoices.push({key:n+o+"30",text:this._isAMPMFirst?r+o+"30":a[0]+o+"30 "+a[1]})}};e.prototype._getDateTimeIframeControlUrl=function(){null===this._iframeBaseUrl&&(this._iframeBaseUrl=this._getDateTimeIframeControlBaseUrl());if(this._iframeBaseUrl){var e=c.default.parseDate(this.state.data,this.state.schema);return this._iframeBaseUrl+"&date="+n.default.encodeURIComponent(e.Date)}return""};e.prototype._getDateTimeIframeControlBaseUrl=function(){var e=this.state.schema,t=this._getDateTimeControlIframeUrl();return t?t+"?cal="+o.default.encodeText(String(e.CalendarType))+"&lcid="+o.default.encodeText(String(e.LocaleId))+"&langid="+o.default.encodeText(String(e.LanguageId))+"&&tz="+o.default.encodeText(String(e.TimeZoneDifference))+"&ww="+o.default.encodeText(String(e.WorkWeek))+"&fdow="+o.default.encodeText(String(e.FirstDayOfWeek))+"&fwoy="+o.default.encodeText(String(e.FirstWeekOfYear))+"&hj="+o.default.encodeText(String(e.HijriAdjustment))+"&swn="+o.default.encodeText(String(e.ShowWeekNumber))+"&minjday="+o.default.encodeText(String(e.MinJDay))+"&maxjday="+o.default.encodeText(String(e.MaxJDay)):""};e.prototype._getDateTimeControlIframeUrl=function(){return this.props.pageContext&&this.props.pageContext.layoutsUrl?r.getSafeWebServerRelativeUrl(this.props.pageContext)+"/"+this.props.pageContext.layoutsUrl+"/iframe.aspx":""};return e}(g.BaseComponent);t.DateTimePicker=s});define("Jc",["require","exports","ap","Jd"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Jd",["require","exports","ap","Dq","Jf","Je"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SelectableOptionMenuItemType=r.SelectableOptionMenuItemType;i.__exportStar(o,t);i.__exportStar(n,t)});define("Jf",["require","exports","ap","at","wE","BZ","Dz","wN","CP","jP","Dq","Jh","Jg"],function(e,t,E,D,s,A,l,M,F,L,d,R,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u,p;!function(e){e[e.backward=-1]="backward";e[e.none=0]="none";e[e.forward=1]="forward"}(u||(u={}));!function(e){e[e.clearAll=-2]="clearAll";e[e.default=-1]="default"}(p||(p={}));var c=function(e){E.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.children};t.prototype.shouldComponentUpdate=function(e){return!L.shallowCompare(E.__assign({},this.props,{children:void 0}),E.__assign({},e,{children:void 0}))};return t}(D.Component),i=function(r){E.__extends(e,r);function e(e){var y=r.call(this,e)||this;y._root=L.createRef();y._autofill=L.createRef();y._comboBoxWrapper=L.createRef();y._comboBoxMenu=L.createRef();y._selectedElement=L.createRef();y._readOnlyPendingAutoCompleteTimeout=1e3;y._scrollIdleDelay=250;y.focus=function(e){if(y._autofill.current){y._autofill.current.focus();e&&y.setState({isOpen:!0})}};y.dismissMenu=function(){y.state.isOpen&&y.setState({isOpen:!1})};y._onUpdateValueInAutofillWillReceiveProps=function(){var e=y._autofill.current;return e?null===e.value||void 0===e.value?null:y._currentVisibleValue&&""!==y._currentVisibleValue&&e.value!==y._currentVisibleValue?y._currentVisibleValue:e.value:null};y._onShouldSelectFullInputValueInAutofillComponentDidUpdate=function(){return y._currentVisibleValue===y.state.suggestedDisplayValue};y._getVisibleValue=function(){var e=y.props,t=e.value,i=e.allowFreeform,r=e.autoComplete,o=y.state,n=o.selectedIndices,a=o.currentPendingValueValidIndex,s=o.currentOptions,l=o.currentPendingValue,d=o.suggestedDisplayValue,c=o.isOpen,u=o.focused,p=y._indexWithinBounds(s,a);if((!c||!p)&&t&&!l)return t;var m=[];if(y.props.multiSelect)if(u){var h=-1;"on"===r&&p&&(h=a);m.push(""!==l?l:y._indexWithinBounds(s,h)?s[h].text:"")}else for(var f=0;n&&f<n.length;f++){h=n[f];m.push(y._indexWithinBounds(s,h)?s[h].text:d)}else{h=y._getFirstSelectedIndex();if(i){"on"===r&&p&&(h=a);m.push(""!==l?l:y._indexWithinBounds(s,h)?s[h].text:"")}else if(p&&"on"===r){h=a;m.push(l)}else m.push(y._indexWithinBounds(s,h)?s[h].text:d)}var g="";for(f=0;f<m.length;f++){0<f&&(g+=", ");g+=m[f]}return g};y._onInputChange=function(e){y.props.disabled?y._handleInputWhenDisabled(null):y.props.allowFreeform?y._processInputChangeWithFreeform(e):y._processInputChangeWithoutFreeform(e)};y._select=function(){y._autofill.current&&y._autofill.current.inputElement&&y._autofill.current.inputElement.select();y.state.focused||y.setState({focused:!0})};y._onResolveOptions=function(){if(y.props.onResolveOptions){var e=y.props.onResolveOptions(E.__assign({},y.state.currentOptions));if(Array.isArray(e))y.setState({currentOptions:e});else if(e&&e.then){var t=y._currentPromise=e;t.then(function(e){t===y._currentPromise&&y.setState({currentOptions:e})})}}};y._onBlur=function(e){if(e.relatedTarget&&(y._root.current&&y._root.current.contains(e.relatedTarget)||y._comboBoxMenu.current&&y._comboBoxMenu.current.contains(e.relatedTarget))){e.preventDefault();e.stopPropagation()}else if(y.state.focused){y.setState({focused:!1});y.props.multiSelect||y._submitPendingValue(e)}};y._onRenderContainer=function(e){var t=e.onRenderList,i=e.calloutProps,r=e.dropdownWidth,o=e.onRenderLowerContent,n=void 0===o?y._onRenderLowerContent:o,a=e.useComboBoxAsMenuWidth;return D.createElement(s.Callout,E.__assign({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHint:4,directionalHintFixed:!0},i,{className:L.css(y._classNames.callout,i?i.className:void 0),target:y._comboBoxWrapper.current,onDismiss:y._onDismiss,onScroll:y._onScroll,setInitialFocus:!1,calloutWidth:a&&y._comboBoxWrapper.current?y._comboBoxWrapper.current.clientWidth+2:r}),D.createElement("div",{className:y._classNames.optionsContainerWrapper,ref:y._comboBoxMenu},t(E.__assign({},e),y._onRenderList)),n(y.props,y._onRenderLowerContent))};y._onRenderList=function(e){var t=e.onRenderItem,i=e.options,r=y._id;return D.createElement("div",{id:r+"-list",className:y._classNames.optionsContainer,"aria-labelledby":r+"-label",role:"listbox"},i.map(function(e){return t(e,y._onRenderItem)}))};y._onRenderItem=function(e){switch(e.itemType){case d.SelectableOptionMenuItemType.Divider:return y._renderSeparator(e);case d.SelectableOptionMenuItemType.Header:return y._renderHeader(e);default:return y._renderOption(e)}};y._onRenderLowerContent=function(){return null};y._renderOption=function(e){var t=y.props.onRenderOption,i=void 0===t?y._onRenderOptionContent:t,r=y._id,o=y._isOptionSelected(e.index),n=y._getCurrentOptionStyles(e),a={key:e.key,index:e.index,styles:n,disabled:e.disabled,isSelected:o,text:e.text};return y.props.multiSelect?D.createElement(c,E.__assign({},a),D.createElement(l.Checkbox,{id:r+"-list"+e.index,ref:"option"+e.index,ariaLabel:y._getPreviewText(e),key:e.key,"data-index":e.index,styles:n,className:"ms-ComboBox-option","data-is-focusable":!0,onChange:y._onItemClick(e.index),label:e.text,role:"option","aria-selected":o?"true":"false",checked:o},i(e,y._onRenderOptionContent))):D.createElement(c,E.__assign({},a),D.createElement(M.CommandButton,{id:r+"-list"+e.index,key:e.key,"data-index":e.index,styles:n,checked:o,className:"ms-ComboBox-option",onClick:y._onItemClick(e.index),onMouseEnter:y._onOptionMouseEnter.bind(y,e.index),onMouseMove:y._onOptionMouseMove.bind(y,e.index),onMouseLeave:y._onOptionMouseLeave,role:"option","aria-selected":o?"true":"false",ariaLabel:e.text,disabled:e.disabled}," ",D.createElement("span",{ref:o?y._selectedElement:void 0},i(e,y._onRenderOptionContent))))};y._onScroll=function(){if(y._isScrollIdle||void 0===y._scrollIdleTimeoutId)y._isScrollIdle=!1;else{y._async.clearTimeout(y._scrollIdleTimeoutId);y._scrollIdleTimeoutId=void 0}y._scrollIdleTimeoutId=y._async.setTimeout(function(){y._isScrollIdle=!0},y._scrollIdleDelay)};y._onRenderOptionContent=function(e){var t=N.getComboBoxOptionClassNames(y._getCurrentOptionStyles(e));return D.createElement("span",{className:t.optionText},e.text)};y._onDismiss=function(){y._resetSelectedIndex();y.setState({isOpen:!1});y._autofill.current&&y._focusInputAfterClose&&y._autofill.current.focus()};y._onInputKeyDown=function(e){var t=y.props,i=t.disabled,r=t.allowFreeform,o=t.autoComplete,n=y.state,a=n.isOpen,s=n.currentOptions,l=n.currentPendingValueValidIndexOnHover;if(i)y._handleInputWhenDisabled(e);else{var d=y._getPendingSelectedIndex(!1);switch(e.which){case 13:y._submitPendingValue(e);y.props.multiSelect&&a?y.setState({currentPendingValueValidIndex:d}):(a||(!r||void 0===y.state.currentPendingValue||null===y.state.currentPendingValue||y.state.currentPendingValue.length<=0)&&y.state.currentPendingValueValidIndex<0)&&y.setState({isOpen:!a});break;case 9:y.props.multiSelect||y._submitPendingValue(e);a&&y._setOpenStateAndFocusOnClose(!a,!1);return;case 27:y._resetSelectedIndex();if(!a)return;y.setState({isOpen:!1});break;case 38:l===p.clearAll&&(d=y.state.currentOptions.length);if((e.altKey||e.metaKey)&&a){y._setOpenStateAndFocusOnClose(!a,!0);return}y._setPendingInfoFromIndexAndDirection(d,u.backward);break;case 40:if(e.altKey||e.metaKey)y._setOpenStateAndFocusOnClose(!0,!0);else{l===p.clearAll&&(d=-1);y._setPendingInfoFromIndexAndDirection(d,u.forward)}break;case 36:case 35:if(r)return;d=-1;var c=u.forward;if(35===e.which){d=s.length;c=u.backward}y._setPendingInfoFromIndexAndDirection(d,c);break;case 32:if(!r&&"off"===o)break;default:if(112<=e.which&&e.which<=123)return;(e.altKey||e.metaKey)&&a&&y._setOpenStateAndFocusOnClose(!a,!0);if(!r&&"on"===o){y._onInputChange(String.fromCharCode(e.which));break}return}e.stopPropagation();e.preventDefault()}};y._onInputKeyUp=function(e){var t=y.props,i=t.disabled,r=t.allowFreeform,o=t.autoComplete;if(i)y._handleInputWhenDisabled(e);else{switch(e.which){case 32:if(!r&&"off"===o){var n=y.state.isOpen;y._setOpenStateAndFocusOnClose(!n,!!n);return}break;default:return}e.stopPropagation();e.preventDefault()}};y._onOptionMouseLeave=function(){y._isScrollIdle&&y.setState({currentPendingValueValidIndexOnHover:p.clearAll})};y._onComboBoxClick=function(){var e=y.props.disabled,t=y.state.isOpen;e||y._setOpenStateAndFocusOnClose(!t,!1)};y._onAutofillClick=function(){y.props.allowFreeform?y.focus(y.state.isOpen):y._onComboBoxClick()};y._warnMutuallyExclusive({defaultSelectedKey:"selectedKey",value:"defaultSelectedKey",selectedKey:"value",dropdownWidth:"useComboBoxAsMenuWidth"});y._id=e.id||L.getId("ComboBox");var t=y._getSelectedKeys(e.defaultSelectedKey,e.selectedKey);y._isScrollIdle=!0;var i=y._getSelectedIndices(e.options,t);y.state={isOpen:!1,selectedIndices:i,focused:!1,suggestedDisplayValue:"",currentOptions:y.props.options,currentPendingValueValidIndex:-1,currentPendingValue:"",currentPendingValueValidIndexOnHover:p.default};return y}e.prototype.componentDidMount=function(){this._events.on(this._comboBoxWrapper.current,"focus",this._onResolveOptions,!0)};e.prototype.componentWillReceiveProps=function(e){if(e.selectedKey!==this.props.selectedKey||e.value!==this.props.value||e.options!==this.props.options){var t=this._getSelectedKeys(void 0,e.selectedKey),i=this._getSelectedIndices(e.options,t);this.setState({selectedIndices:i,currentOptions:e.options})}};e.prototype.componentDidUpdate=function(e,t){var i=this,r=this.props,o=r.allowFreeform,n=r.value,a=r.onMenuOpen,s=r.onMenuDismissed,l=this.state,d=l.isOpen,c=l.focused,u=l.selectedIndices,p=l.currentPendingValueValidIndex;!d||t.isOpen&&t.currentPendingValueValidIndex===p||this._async.setTimeout(function(){return i._scrollIntoView()},0);(d||t.isOpen&&!d&&this._focusInputAfterClose&&c&&this._autofill.current&&document.activeElement!==this._autofill.current.inputElement)&&this.focus();this._focusInputAfterClose&&(t.isOpen&&!d||c&&(!d&&!this.props.multiSelect&&t.selectedIndices&&u&&t.selectedIndices[0]!==u[0]||!o||n!==e.value))&&this._select();this._notifyPendingValueChanged(t);d&&!t.isOpen&&a&&a();!d&&t.isOpen&&s&&s()};e.prototype.componentWillUnmount=function(){r.prototype.componentWillUnmount.call(this);this._events.off(this._comboBoxWrapper.current)};e.prototype.render=function(){var e=this._id,t=this.props,i=t.className,r=t.label,o=t.disabled,n=t.ariaLabel,a=t.required,s=t.errorMessage,l=t.onRenderContainer,d=void 0===l?this._onRenderContainer:l,c=t.onRenderList,u=void 0===c?this._onRenderList:c,p=t.onRenderItem,m=void 0===p?this._onRenderItem:p,h=t.onRenderOption,f=void 0===h?this._onRenderOptionContent:h,g=t.allowFreeform,y=t.buttonIconProps,v=t.isButtonAriaHidden,_=void 0===v||v,b=t.styles,x=t.theme,S=t.title,C=this.state,P=C.isOpen,k=C.focused,I=C.suggestedDisplayValue;this._currentVisibleValue=this._getVisibleValue();var T=L.getNativeProps(this.props,L.divProperties),w=!!(s&&0<s.length);this._classNames=this.props.getClassNames?this.props.getClassNames(x,!!P,!!o,!!a,!!k,!!g,!!w,i):N.getClassNames(R.getStyles(x,b),i,!!P,!!o,!!a,!!k,!!g,!!w);return D.createElement("div",E.__assign({},T,{ref:this._root,className:this._classNames.container}),r&&D.createElement(A.Label,{id:e+"-label",disabled:o,required:a,htmlFor:e+"-input",className:this._classNames.label},r),D.createElement("div",{ref:this._comboBoxWrapper,id:e+"wrapper",className:this._classNames.root},D.createElement(F.Autofill,{"data-is-interactable":!o,componentRef:this._autofill,id:e+"-input",className:this._classNames.input,type:"text",onFocus:this._select,onBlur:this._onBlur,onKeyDown:this._onInputKeyDown,onKeyUp:this._onInputKeyUp,onClick:this._onAutofillClick,onInputValueChange:this._onInputChange,"aria-expanded":P,"aria-autocomplete":this._getAriaAutoCompleteValue(),role:"combobox","aria-readonly":g||o?void 0:"true",readOnly:o||!g,"aria-labelledby":r&&e+"-label","aria-label":n&&!r?n:void 0,"aria-describedby":e+"-option","aria-activedescendant":this._getAriaActiveDescentValue(),"aria-disabled":o,"aria-owns":e+"-list",spellCheck:!1,defaultVisibleValue:this._currentVisibleValue,suggestedDisplayValue:I,updateValueInWillReceiveProps:this._onUpdateValueInAutofillWillReceiveProps,shouldSelectFullInputValueInComponentDidUpdate:this._onShouldSelectFullInputValueInAutofillComponentDidUpdate,title:S}),D.createElement(M.IconButton,{className:"ms-ComboBox-CaretDown-button",styles:this._getCaretButtonStyles(),role:"presentation","aria-hidden":_,"data-is-focusable":!1,tabIndex:-1,onClick:this._onComboBoxClick,iconProps:y,disabled:o,checked:P})),P&&d(E.__assign({},this.props,{onRenderList:u,onRenderItem:m,onRenderOption:f,options:this.state.currentOptions.map(function(e,t){return E.__assign({},e,{index:t})})}),this._onRenderContainer),s&&D.createElement("div",{className:this._classNames.errorMessage},s))};e.prototype._indexWithinBounds=function(e,t){return!!e&&(0<=t&&t<e.length)};e.prototype._processInputChangeWithFreeform=function(t){var i=this,e=this.state.currentOptions;if(""!==t){var r=t;t=t.toLocaleLowerCase();var o="",n=-1;if("on"===this.props.autoComplete){if(0<(s=e.map(function(e,t){return E.__assign({},e,{index:t})}).filter(function(e){return e.itemType!==d.SelectableOptionMenuItemType.Header&&e.itemType!==d.SelectableOptionMenuItemType.Divider}).filter(function(e){return 0===i._getPreviewText(e).toLocaleLowerCase().indexOf(t)})).length){var a=this._getPreviewText(s[0]);o=a.toLocaleLowerCase()!==t?a:"";n=s[0].index}}else{var s;1===(s=e.map(function(e,t){return E.__assign({},e,{index:t})}).filter(function(e){return e.itemType!==d.SelectableOptionMenuItemType.Header&&e.itemType!==d.SelectableOptionMenuItemType.Divider}).filter(function(e){return i._getPreviewText(e).toLocaleLowerCase()===t})).length&&(n=s[0].index)}this._setPendingInfo(r,n,o)}};e.prototype._processInputChangeWithoutFreeform=function(t){var e=this,i=this.state,r=i.currentPendingValue,o=i.currentPendingValueValidIndex,n=i.currentOptions;if("on"!==this.props.autoComplete||""===t){var a=0<=o?o:this._getFirstSelectedIndex();this._setPendingInfoFromIndex(a)}else{if(void 0!==this._lastReadOnlyAutoCompleteChangeTimeoutId){this._async.clearTimeout(this._lastReadOnlyAutoCompleteChangeTimeoutId);this._lastReadOnlyAutoCompleteChangeTimeoutId=void 0;t=r+t}var s=t;t=t.toLocaleLowerCase();var l=n.map(function(e,t){return E.__assign({},e,{index:t})}).filter(function(e){return e.itemType!==d.SelectableOptionMenuItemType.Header&&e.itemType!==d.SelectableOptionMenuItemType.Divider}).filter(function(e){return 0===e.text.toLocaleLowerCase().indexOf(t)});0<l.length&&this._setPendingInfo(s,l[0].index,this._getPreviewText(l[0]));this._lastReadOnlyAutoCompleteChangeTimeoutId=this._async.setTimeout(function(){e._lastReadOnlyAutoCompleteChangeTimeoutId=void 0},this._readOnlyPendingAutoCompleteTimeout)}};e.prototype._getFirstSelectedIndex=function(){return this.state.selectedIndices&&0<this.state.selectedIndices.length?this.state.selectedIndices[0]:-1};e.prototype._getNextSelectableIndex=function(e,t){var i=this.state.currentOptions,r=e+t;r=Math.max(0,Math.min(i.length-1,r));if(!this._indexWithinBounds(i,r))return-1;var o=i[r];if(o.itemType===d.SelectableOptionMenuItemType.Header||o.itemType===d.SelectableOptionMenuItemType.Divider){if(t===u.none||!(0<r&&t<u.none||0<=r&&r<i.length&&t>u.none))return e;r=this._getNextSelectableIndex(r,t)}return r};e.prototype._setSelectedIndex=function(t,e,i){void 0===i&&(i=u.none);var r=this.props,o=r.onChanged,n=r.onPendingValueChanged,a=this.state.currentOptions,s=this.state.selectedIndices;s||(s=[]);t=this._getNextSelectableIndex(t,i);if(this._indexWithinBounds(a,t)&&(this.props.multiSelect||s.length<1||1===s.length&&s[0]!==t)){var l=a[t];if(!l)return;if(this.props.multiSelect){l.selected=!l.selected;l.selected&&s.indexOf(t)<0?s.push(t):!l.selected&&0<=s.indexOf(t)&&(s=s.filter(function(e){return e!==t}))}else s[0]=t;this.setState({selectedIndices:s});if(this._hasPendingValue&&n){n();this._hasPendingValue=!1}o&&o(l,t,void 0,e);this._clearPendingInfo()}};e.prototype._submitPendingValue=function(e){var t=this.props,i=t.onChanged,r=t.allowFreeform,o=t.autoComplete,n=this.state,a=n.currentPendingValue,s=n.currentPendingValueValidIndex,l=n.currentOptions,d=n.currentPendingValueValidIndexOnHover,c=this.state.selectedIndices;if(r&&""!==a){if(this._indexWithinBounds(l,s)){var u=l[s].text.toLocaleLowerCase();if(a.toLocaleLowerCase()===u||o&&0===u.indexOf(a.toLocaleLowerCase())&&this._autofill.current&&this._autofill.current.isValueSelected&&a.length+(this._autofill.current.selectionEnd-this._autofill.current.selectionStart)===u.length||this._autofill.current&&this._autofill.current.inputElement&&this._autofill.current.inputElement.value.toLocaleLowerCase()===u){this._setSelectedIndex(s,e);this._clearPendingInfo();return}}if(i)i(void 0,void 0,a,e);else{var p={key:a,text:a},m=l.concat([p]);if(c){this.props.multiSelect||(c=[]);c.push(m.length-1)}this.setState({currentOptions:m,selectedIndices:c})}}else 0<=s?this._setSelectedIndex(s,e):0<=d&&this._setSelectedIndex(d,e);this._clearPendingInfo()};e.prototype._renderSeparator=function(e){var t=e.index,i=e.key;return t&&0<t?D.createElement("div",{role:"separator",key:i,className:this._classNames.divider}):null};e.prototype._renderHeader=function(e){var t=this.props.onRenderOption,i=void 0===t?this._onRenderOptionContent:t;return D.createElement("div",{key:e.key,className:this._classNames.header,role:"heading"},i(e,this._onRenderOptionContent))};e.prototype._isOptionSelected=function(e){if(this.state.currentPendingValueValidIndexOnHover===p.clearAll)return!1;if(!this.props.multiSelect&&this._getPendingSelectedIndex(!0)===e)return!0;var t=-1;void 0!==e&&this.state.selectedIndices&&(t=this.state.selectedIndices.indexOf(e));return 0<=t};e.prototype._getPendingSelectedIndex=function(e){var t=this.state,i=t.currentPendingValueValidIndexOnHover,r=t.currentPendingValueValidIndex,o=t.currentPendingValue;return 0<=i?i:0<=r||e&&""!==o?r:this.props.multiSelect?0:this._getFirstSelectedIndex()};e.prototype._scrollIntoView=function(){var e=this.props,t=e.onScrollToItem,i=e.scrollSelectedToTop,r=this.state,o=r.currentPendingValueValidIndex,n=r.currentPendingValue;if(t)t(0<=o||""!==n?o:this._getFirstSelectedIndex());else if(this._selectedElement.current&&this._selectedElement.current.offsetParent)if(i)this._selectedElement.current.offsetParent.scrollIntoView(!0);else{var a=!0;if(this._comboBoxMenu.current&&this._comboBoxMenu.current.offsetParent){var s=this._comboBoxMenu.current.offsetParent.getBoundingClientRect(),l=this._selectedElement.current.offsetParent.getBoundingClientRect();if(s.top<=l.top&&s.top+s.height>=l.top+l.height)return;s.top+s.height<=l.top+l.height&&(a=!1)}this._selectedElement.current.offsetParent.scrollIntoView(a)}};e.prototype._onItemClick=function(t){var i=this;return function(e){i._setSelectedIndex(t,e);i.props.multiSelect||i.setState({isOpen:!1})}};e.prototype._getSelectedIndices=function(i,e){var r=[];if(void 0===i||void 0===e)return r;for(var t=function(t){var e=L.findIndex(i,function(e){return e.selected||e.key===t});-1<e&&r.push(e)},o=0,n=e;o<n.length;o++){t(n[o])}return r};e.prototype._resetSelectedIndex=function(){var e=this.state.currentOptions;this._autofill.current&&this._autofill.current.clear();this._clearPendingInfo();var t=this._getFirstSelectedIndex();0<t&&t<e.length?this.setState({suggestedDisplayValue:e[t].text}):this.props.value&&this.setState({suggestedDisplayValue:this.props.value})};e.prototype._clearPendingInfo=function(){this._setPendingInfo("",-1,"")};e.prototype._setPendingInfo=function(e,t,i){this.setState({currentPendingValue:e,currentPendingValueValidIndex:t,suggestedDisplayValue:i,currentPendingValueValidIndexOnHover:p.default})};e.prototype._setPendingInfoFromIndex=function(e){var t=this.state.currentOptions;if(0<=e&&e<t.length){var i=t[e];this._setPendingInfo(this._getPreviewText(i),e,this._getPreviewText(i))}else this._clearPendingInfo()};e.prototype._setPendingInfoFromIndexAndDirection=function(e,t){var i=this.state.currentOptions;t===u.forward&&e>=i.length-1?e=-1:t===u.backward&&e<=0&&(e=i.length);var r=this._getNextSelectableIndex(e,t);e===r?t===u.forward?e=this._getNextSelectableIndex(-1,t):t===u.backward&&(e=this._getNextSelectableIndex(i.length,t)):e=r;this._indexWithinBounds(i,e)&&this._setPendingInfoFromIndex(e)};e.prototype._notifyPendingValueChanged=function(e){var t=this.props.onPendingValueChanged;if(t){var i=this.state,r=i.currentPendingValue,o=i.currentOptions,n=i.currentPendingValueValidIndex,a=i.currentPendingValueValidIndexOnHover,s=void 0,l=void 0;a!==e.currentPendingValueValidIndexOnHover&&this._indexWithinBounds(o,a)?s=a:n!==e.currentPendingValueValidIndex&&this._indexWithinBounds(o,n)?s=n:r!==e.currentPendingValue&&""!==r&&(l=r);if(void 0!==s||l||this._hasPendingValue){t(s?o[s]:void 0,s,l);this._hasPendingValue=void 0!==s||void 0!==l}}};e.prototype._setOpenStateAndFocusOnClose=function(e,t){this._focusInputAfterClose=t;this.setState({isOpen:e})};e.prototype._onOptionMouseEnter=function(e){this._isScrollIdle&&this.setState({currentPendingValueValidIndexOnHover:e})};e.prototype._onOptionMouseMove=function(e){this._isScrollIdle&&this.state.currentPendingValueValidIndexOnHover!==e&&this.setState({currentPendingValueValidIndexOnHover:e})};e.prototype._handleInputWhenDisabled=function(e){if(this.props.disabled){this.state.isOpen&&this.setState({isOpen:!1});if(null!==e&&9!==e.which&&27!==e.which&&(e.which<112||123<e.which)){e.stopPropagation();e.preventDefault()}}};e.prototype._getCaretButtonStyles=function(){var e=this.props.caretDownButtonStyles;return R.getCaretDownButtonStyles(this.props.theme,e)};e.prototype._getCurrentOptionStyles=function(e){var t=this.props.comboBoxOptionStyles,i=e.styles;return R.getOptionStyles(this.props.theme,t,i,this._isPendingOption(e))};e.prototype._getAriaActiveDescentValue=function(){var e=this.state.isOpen&&this.state.selectedIndices&&0<=this.state.selectedIndices.length?this._id+"-list"+this.state.selectedIndices[0]:void 0;this.state.isOpen&&this.state.focused&&-1!==this.state.currentPendingValueValidIndex&&(e=this._id+"-list"+this.state.currentPendingValueValidIndex);return e};e.prototype._getAriaAutoCompleteValue=function(){return!this.props.disabled&&"on"===this.props.autoComplete?this.props.allowFreeform?"inline":"both":"none"};e.prototype._isPendingOption=function(e){return e&&e.index===this.state.currentPendingValueValidIndex};e.prototype._getSelectedKeys=function(e,t){var i=[];e?e instanceof Array?i=e:"string"==typeof e?i=[e]:"number"==typeof e&&(i=[e]):t&&(t instanceof Array?i=t:"string"==typeof t?i=[t]:"number"==typeof t&&(i=[t]));return i};e.prototype._getPreviewText=function(e){return e.useAriaLabelAsText&&e.ariaLabel?e.ariaLabel:e.text};e.defaultProps={options:[],allowFreeform:!1,autoComplete:"on",buttonIconProps:{iconName:"ChevronDown"}};return e=E.__decorate([L.customizable("ComboBox",["theme"])],e)}(L.BaseComponent);t.ComboBox=i});define("CP",["require","exports","ap","CQ"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("CQ",["require","exports","ap","at","jP"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(e){var i=t.call(this,e)||this;i._inputElement=o.createRef();i._autoFillEnabled=!0;i._onCompositionStart=function(e){i._autoFillEnabled=!1};i._onCompositionEnd=function(e){var t=i._getCurrentInputValue();i._tryEnableAutofill(t,i.value,!1,!0);i._async.setTimeout(function(){return i._updateValue(t)},0)};i._onClick=function(){i._value&&""!==i._value&&i._autoFillEnabled&&(i._autoFillEnabled=!1)};i._onKeyDown=function(e){i.props.onKeyDown&&i.props.onKeyDown(e);if(!e.nativeEvent.isComposing)switch(e.which){case 8:i._autoFillEnabled=!1;break;case 37:case 39:if(i._autoFillEnabled){i._value=i.state.displayValue;i._autoFillEnabled=!1}break;default:i._autoFillEnabled||-1!==i.props.enableAutofillOnKeyPress.indexOf(e.which)&&(i._autoFillEnabled=!0)}};i._onInputChanged=function(e){var t=i._getCurrentInputValue(e);i._tryEnableAutofill(t,i._value,e.nativeEvent.isComposing);i._updateValue(t)};i._onChanged=function(){};i._updateValue=function(e){i._value=i.props.onInputChange?i.props.onInputChange(e):e;i.setState({displayValue:i._getDisplayValue(i._value,i.props.suggestedDisplayValue)},function(){return i._notifyInputChange(i._value)})};i._value="";i.state={displayValue:e.defaultVisibleValue||""};return i}Object.defineProperty(e.prototype,"cursorLocation",{get:function(){if(this._inputElement.current){var e=this._inputElement.current;return"forward"!==e.selectionDirection?e.selectionEnd:e.selectionStart}return-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isValueSelected",{get:function(){return Boolean(this.inputElement&&this.inputElement.selectionStart!==this.inputElement.selectionEnd)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this._inputElement.current?this._inputElement.current.selectionStart:-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this._inputElement.current?this._inputElement.current.selectionEnd:-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"inputElement",{get:function(){return this._inputElement.current},enumerable:!0,configurable:!0});e.prototype.componentWillReceiveProps=function(e){var t;this.props.updateValueInWillReceiveProps&&(t=this.props.updateValueInWillReceiveProps());"string"==typeof(t=this._getDisplayValue(t||this._value,e.suggestedDisplayValue))&&this.setState({displayValue:t})};e.prototype.componentDidUpdate=function(){var e=this._value,t=this.props,i=t.suggestedDisplayValue,r=t.shouldSelectFullInputValueInComponentDidUpdate,o=0;if(this._autoFillEnabled&&e&&i&&this._doesTextStartWith(i,e)){var n=!1;r&&(n=r());if(n&&this._inputElement.current)this._inputElement.current.setSelectionRange(0,i.length,"backward");else{for(;o<e.length&&e[o].toLocaleLowerCase()===i[o].toLocaleLowerCase();)o++;0<o&&this._inputElement.current&&this._inputElement.current.setSelectionRange(o,i.length,"backward")}}};e.prototype.render=function(){var e=this.state.displayValue,t=o.getNativeProps(this.props,o.inputProperties);return r.createElement("input",i.__assign({},t,{ref:this._inputElement,value:e,autoCapitalize:"off",autoComplete:"off",onCompositionStart:this._onCompositionStart,onCompositionEnd:this._onCompositionEnd,onChange:this._onChanged,onInput:this._onInputChanged,onKeyDown:this._onKeyDown,onClick:this.props.onClick?this.props.onClick:this._onClick,"data-lpignore":!0}))};e.prototype.focus=function(){this._inputElement.current&&this._inputElement.current.focus()};e.prototype.clear=function(){this._autoFillEnabled=!0;this._updateValue("");this._inputElement.current&&this._inputElement.current.setSelectionRange(0,0)};e.prototype._getCurrentInputValue=function(e){return e&&e.target&&e.target.value?e.target.value:this.inputElement&&this.inputElement.value?this.inputElement.value:""};e.prototype._tryEnableAutofill=function(e,t,i,r){!i&&e&&this._inputElement.current&&this._inputElement.current.selectionStart===e.length&&!this._autoFillEnabled&&(e.length>t.length||r)&&(this._autoFillEnabled=!0)};e.prototype._notifyInputChange=function(e){this.props.onInputValueChange&&this.props.onInputValueChange(e)};e.prototype._getDisplayValue=function(e,t){var i=e;t&&e&&this._doesTextStartWith(t,i)&&this._autoFillEnabled&&(i=t);return i};e.prototype._doesTextStartWith=function(e,t){return!(!e||!t)&&0===e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())};e.defaultProps={enableAutofillOnKeyPress:[40,38]};return e}(o.BaseComponent),a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t}(t.Autofill=n);t.BaseAutoFill=a});define("Jh",["require","exports","d","jP"],function(e,t,x,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=i.memoizeFunction(function(e){var t,i=e.semanticColors;return{backgroundColor:i.disabledBackground,borderColor:i.disabledBackground,color:i.disabledText,cursor:"default",selectors:(t={},t[x.HighContrastSelector]={borderColor:"GrayText",color:"GrayText"},t)}}),m=i.memoizeFunction(function(e){return{selectors:(t={},t[x.HighContrastSelector]={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText",MsHighContrastAdjust:"none"},t)};var t});t.getOptionStyles=i.memoizeFunction(function(e,t,i,r){var o,n=e.semanticColors,a=e.palette,s=n.menuItemBackgroundHovered,l=n.bodyText,d=a.black,c=n.disabledText,u=n.bodyBackground,p={root:[{backgroundColor:r?s:"transparent",boxSizing:"border-box",cursor:"pointer",display:"block",width:"100%",height:"auto",minHeight:"32px",lineHeight:"20px",padding:"5px 16px",position:"relative",borderWidth:"1px",borderStyle:"solid",borderColor:"transparent",wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",selectors:(o={},o[x.HighContrastSelector]={borderColor:"Background"},o)},x.getFocusStyle(e)],rootHovered:{backgroundColor:s,color:l},rootFocused:{backgroundColor:s},rootChecked:[{backgroundColor:s,color:d},x.getFocusStyle(e),m(e)],rootDisabled:{backgroundColor:u,color:c,cursor:"default",selectors:{"& .ms-Button-flexContainer":{justifyContent:"flex-start"}}},optionText:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:"0px",maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",margin:"1px"}};return x.concatStyleSets(p,t,i)});t.getCaretDownButtonStyles=i.memoizeFunction(function(e,t){var i,r=e.semanticColors,o=r.bodySubtext,n=r.buttonTextChecked,a=r.listItemBackgroundHovered,s=r.listItemBackgroundChecked,l=r.listItemBackgroundCheckedHovered,d={root:{color:o,fontSize:x.FontSizes.small,position:"absolute",top:"-1px",right:"-1px",height:"32px",lineHeight:"30px",width:"32px",textAlign:"center",cursor:"default",selectors:(i={},i[x.HighContrastSelector]={backgroundColor:"ButtonFace",borderColor:"ButtonText",color:"ButtonText",MsHighContrastAdjust:"none"},i)},icon:{fontSize:x.FontSizes.small},rootHovered:{backgroundColor:a,color:n,cursor:"pointer"},rootPressed:{backgroundColor:s,color:n},rootChecked:{backgroundColor:s,color:n},rootCheckedHovered:{backgroundColor:l,color:n},rootDisabled:S(e)};return x.concatStyleSets(d,t)});t.getStyles=i.memoizeFunction(function(e,t,i){var r,o,n,a,s=e.semanticColors,l=e.fonts,d=e.palette,c=s.bodyBackground,u=s.bodyText,p=s.inputBorder,m=s.inputBorderHovered,h=s.inputFocusBorderAlt,f=s.errorText,g=d.neutralLight,y=s.menuHeader,v=s.bodyDivider,_={color:"HighlightText",borderColor:"Highlight",backgroundColor:"Window",borderWidth:"2px",MsHighContrastAdjust:"none",paddingLeft:"11px",paddingTop:"0",paddingBottom:"0",selectors:{".ms-ComboBox-CaretDown-button":{right:"-2px",top:"-2px"}}},b={container:{},label:{},labelDisabled:{},root:[l.medium,{boxShadow:"none",marginLeft:"0",paddingTop:"1px",paddingBottom:"1px",paddingRight:"32px",paddingLeft:"12px",color:u,position:"relative",outline:"0",userSelect:"none",backgroundColor:c,borderWidth:"1px",borderStyle:"solid",borderColor:p,cursor:"text",display:"block",height:"32px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",boxSizing:"border-box",selectors:{".ms-Label":{display:"inline-block",marginBottom:"8px"},input:{selectors:{"::-ms-clear":{display:"none"}}},"&.is-open":{borderColor:h,selectors:(r={},r[x.HighContrastSelector]=_,r)}}}],rootHovered:{borderColor:m,selectors:(o={},o[x.HighContrastSelector]={color:"HighlightText",borderColor:"Highlight",backgroundColor:"Window",MsHighContrastAdjust:"none"},o)},rootPressed:{borderColor:h,selectors:(n={},n[x.HighContrastSelector]=_,n)},rootFocused:{borderColor:h,selectors:(a={},a[x.HighContrastSelector]=_,a)},rootDisabled:S(e),rootError:{borderColor:f,marginBottom:"5px"},rootDisallowFreeForm:{},input:{boxSizing:"border-box",width:"100%",height:"28px",borderStyle:"none",outline:"none",font:"inherit",textOverflow:"ellipsis",padding:"0"},inputDisabled:S(e),errorMessage:{color:f},callout:{boxShadow:"0 0px 5px 0px rgba(0, 0, 0, 0.4)",borderWidth:"1px",borderStyle:"solid",borderColor:g},optionsContainerWrapper:{width:i},optionsContainer:{display:"block"},header:[l.medium,{fontWeight:x.FontWeights.semibold,color:y,backgroundColor:"none",borderStyle:"none",height:"32px",lineHeight:"32px",cursor:"default",padding:"0px 16px",userSelect:"none",textAlign:"left"}],divider:{borderWidth:"1px",borderStyle:"solid",borderColor:v}};return x.concatStyleSets(b,t)})});define("Jg",["require","exports","jP","d"],function(e,t,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getClassNames=i.memoizeFunction(function(e,t,i,r,o,n,a,s){return{container:l.mergeStyles("ms-ComboBox-container",t,e.container),label:l.mergeStyles(e.label,r&&e.labelDisabled),root:l.mergeStyles("ms-ComboBox",s?e.rootError:i&&"is-open",o&&"is-required",e.root,!a&&e.rootDisallowFreeForm,s?e.rootError:!r&&n&&e.rootFocused,!r&&{selectors:{":hover":s?e.rootError:!i&&!n&&e.rootHovered,":active":s?e.rootError:e.rootPressed,":focus":s?e.rootError:e.rootFocused}},r&&["is-disabled",e.rootDisabled]),input:l.mergeStyles("ms-ComboBox-Input",e.input,r&&e.inputDisabled),errorMessage:l.mergeStyles(e.errorMessage),callout:l.mergeStyles("ms-ComboBox-callout",e.callout),optionsContainerWrapper:l.mergeStyles("ms-ComboBox-optionsContainerWrapper",e.optionsContainerWrapper),optionsContainer:l.mergeStyles("ms-ComboBox-optionsContainer",e.optionsContainer),header:l.mergeStyles("ms-ComboBox-header",e.header),divider:l.mergeStyles("ms-ComboBox-divider",e.divider)}});t.getComboBoxOptionClassNames=i.memoizeFunction(function(e){return{optionText:l.mergeStyles("ms-ComboBox-optionText",e.optionText),root:l.mergeStyles("ms-ComboBox-option",e.root,{selectors:{":hover":e.rootHovered,":focus":e.rootFocused,":active":e.rootPressed}})}})});define("Je",["require","exports","ap","at","jP","Jf","oR"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){i.__extends(t,e);function t(){var i=null!==e&&e.apply(this,arguments)||this;i._comboBox=o.createRef();i._list=o.createRef();i._onRenderList=function(e){var t=e.onRenderItem;return r.createElement(a.List,{componentRef:i._list,role:"listbox",items:e.options,onRenderCell:t?function(e){return t(e)}:function(){return null}})};i._onScrollToItem=function(e){i._list.current&&i._list.current.scrollToIndex(e)};return i}t.prototype.dismissMenu=function(){if(this._comboBox.current)return this._comboBox.current.dismissMenu()};t.prototype.focus=function(){if(this._comboBox.current){this._comboBox.current.focus();return!0}return!1};t.prototype.render=function(){return r.createElement(n.ComboBox,i.__assign({},this.props,{componentRef:this._comboBox,onRenderList:this._onRenderList,onScrollToItem:this._onScrollToItem}))};return t}(o.BaseComponent);t.VirtualizedComboBox=s});define("Ja",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.DateOnly=0]="DateOnly";e[e.DateTime=1]="DateTime"}(t.DateTimeDisplayFormat||(t.DateTimeDisplayFormat={}));var i=function(){function a(){}a.isAMPMFirst=function(e){var t=!1,i=e.HoursOptions;if(i&&0<i.length){var r=i[0].split(" ");t=isNaN(parseInt(r[0],10))}return t};a.parseDate=function(e,t){var i={Hour:"0",Minute:"00",Date:e?e.trim():""};if(!e)return i;var r=t.TimeSeparator?e.lastIndexOf(t.TimeSeparator):-1;if(-1===r||r===e.length-1)return i;var o=e.substring(r+1),n=Number(o);if(isNaN(n))return i;i.Minute=n<10?"0"+String(n):o;var a=e.substring(0,r),s=a.lastIndexOf(" ");if(-1===s||s===a.length-1)return i;var l=a.substring(s+1);if(isNaN(Number(l)))return i;i.Hour=l;i.Date=a.substring(0,s);return i};a.getFullDisplayDate=function(e,t){var i=a.parseDate(e,t),r=i.Date,o="";if(1===t.DisplayFormat){o=t.HoursOptions[Number(i.Hour)];if(t.HoursMode24||!1!==a.isAMPMFirst(t)){-1===o.indexOf(t.TimeSeparator)&&(o+=t.TimeSeparator);o+=i.Minute}else{var n=o.split(" ");o=n[0]+t.TimeSeparator+i.Minute+" "+n[1]}r+=" "+o}return r};a.convertTimeZoneDifference=function(e){var t=e.split(":"),i=NaN;3===t.length&&(i=1e3*(3600*Number(t[0])+60*Number(t[1])+Math.round(Number(t[2]))));return i};return a}();t.default=i});define("I9",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".sp-DateTimePicker-DateContainer{display:-ms-flexbox;display:flex}.sp-DateTimePicker-DateContainer.is-focused .ms-TextField-field,.sp-DateTimePicker-DateContainer.is-focused .sp-DateTimePicker-DateButton{border-bottom-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.sp-DateTimePicker-Date{-ms-flex-positive:1;flex-grow:1}.sp-DateTimePicker-DateButton{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-left-width:0;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";-ms-flex-item-align:end;align-self:flex-end}.sp-DateTimePicker-Time{margin-top:8px}.sp-DateTimePicker-iFrame{border-style:none;width:200px;height:212px}.sp-DateTimePicker-errorMessage{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";font-size:12px}"}])});define("IW",["require","exports","ap","I4","I3","I2","IX"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t)});define("I4",["require","exports","ap","at","I5","jP","IY","GL","aW"],function(e,t,r,a,o,n,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c={ODB:530},i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={allowMultipleSelection:t.props.allowMultipleSelection,enforceUniqueValues:t.props.enforceUniqueValues,unlimitedLengthInDocumentLibrary:t.props.unlimitedLengthInDocumentLibrary,required:t.props.required,addToAllContentTypes:!0};return t}e.prototype.render=function(){var e=this.props.strings,t=a.createElement(s.Toggle,{className:"ms-ColumnManagementPanel-toggle allowMultipleSelection",checked:this.state.allowMultipleSelection,label:e.allowMultipleSelectionToggle,onText:e.toggleOnText,offText:e.toggleOffText,onChanged:this._multiSelectChanged}),i=a.createElement(s.Toggle,{className:"ms-ColumnManagementPanel-toggle requiredToggle",checked:this.state.required,label:e.requiredToggle,onText:e.toggleOnText,offText:e.toggleOffText,onChanged:this._requiredChanged}),r=a.createElement(s.Toggle,{className:"ms-ColumnManagementPanel-toggle enforceUniqueValues",checked:this.state.enforceUniqueValues,disabled:this.state.allowMultipleSelection&&this.props.showAllowMultipleToggle,label:e.enforceUniqueValuesToggle,onText:e.toggleOnText,offText:e.toggleOffText,onChanged:this._enforceUniqueValuesChanged}),o=a.createElement(s.Toggle,{className:"ms-ColumnManagementPanel-toggle unlimitedLengthInDocumentLibrary",checked:this.state.unlimitedLengthInDocumentLibrary,label:e.unlimitedLengthInDocumentLibraryToggle,onText:e.toggleOnText,offText:e.toggleOffText,onChanged:this._unlimitedLengthInDocumentLibraryChanged}),n=a.createElement(s.Toggle,{className:"ms-ColumnManagementPanel-toggle addToAllContentTypes",checked:this.state.addToAllContentTypes,label:e.addToAllContentTypesToggle,onText:e.toggleOnText,offText:e.toggleOffText,onChanged:this._addToAllContentTypesChanged});return a.createElement("div",{className:"ms-ColumnManagementPanel-baseMoreOptions"},this.props.showAllowMultipleToggle&&t,!1!==this.props.showRequiredToggle&&i,this.props.showEnforceUniqueToggle&&r,this.props.showUnlimitedLengthInDocumentLibraryToggle&&o,d.default.isFeatureEnabled(c)&&!this.props.isEditPanel&&n)};e.prototype.getSchemaValues=function(){var e={Type:this.props.fieldType,Required:!(!this.state.required||!1===this.props.showRequiredToggle)||null,EnforceUniqueValues:!(!this.state.enforceUniqueValues||!this.props.showEnforceUniqueToggle)||null,Indexed:!(!this.state.enforceUniqueValues||!this.props.showEnforceUniqueToggle)||null,UnlimitedLengthInDocumentLibrary:!(!this.state.unlimitedLengthInDocumentLibrary||!this.props.showUnlimitedLengthInDocumentLibraryToggle)||null};if(this.state.allowMultipleSelection&&this.props.showAllowMultipleToggle)if(this.props.fieldType===l.FieldType.Choice)e.Type=l.FieldType.MultiChoice;else if(this.props.fieldType===l.FieldType.User){e.Type=l.FieldType.UserMulti;e.Mult=!0}return e};e.prototype.getFieldOptions=function(){return d.default.isFeatureEnabled(c)&&!this.props.isEditPanel&&this.state.addToAllContentTypes?o.default.AddToAllContentTypes:void 0};e.prototype._multiSelectChanged=function(e){this.props.updateShowColumnValidationState(e);this.setState({allowMultipleSelection:e,enforceUniqueValues:!1})};e.prototype._enforceUniqueValuesChanged=function(e){this.setState({enforceUniqueValues:e})};e.prototype._requiredChanged=function(e){this.setState({required:e})};e.prototype._unlimitedLengthInDocumentLibraryChanged=function(e){this.setState({unlimitedLengthInDocumentLibrary:e})};e.prototype._addToAllContentTypesChanged=function(e){this.setState({addToAllContentTypes:e})};r.__decorate([n.autobind],e.prototype,"getSchemaValues",null);r.__decorate([n.autobind],e.prototype,"getFieldOptions",null);r.__decorate([n.autobind],e.prototype,"_multiSelectChanged",null);r.__decorate([n.autobind],e.prototype,"_enforceUniqueValuesChanged",null);r.__decorate([n.autobind],e.prototype,"_requiredChanged",null);r.__decorate([n.autobind],e.prototype,"_unlimitedLengthInDocumentLibraryChanged",null);r.__decorate([n.autobind],e.prototype,"_addToAllContentTypesChanged",null);return e}(n.BaseComponent);t.BaseMoreOptions=i});define("I5",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Default=0]="Default";e[e.AddToDefaultContentType=1]="AddToDefaultContentType";e[e.AddToNoContentType=2]="AddToNoContentType";e[e.AddToAllContentTypes=4]="AddToAllContentTypes";e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint";e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView";e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(i=t.AddFieldOptions||(t.AddFieldOptions={}));t.default=i});define("I3",["require","exports","ap","at","jP","BT"],function(e,t,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={minValue:t.props.minimumValue,maxValue:t.props.maximumValue,minValueErrorMessage:"",maxValueErrorMessage:""};return t}e.prototype.componentWillReceiveProps=function(e){e.validateMoreOptions&&this.state.minValue&&this.state.maxValue&&Number(this.state.minValue)>Number(this.state.maxValue)&&this.setState({minValueErrorMessage:this.props.strings.minimumLargerThanMaximum})};e.prototype.render=function(){var e=this.props.strings;return o.createElement("div",{className:"ms-ColumnManagementPanel-numberMoreOptions"},o.createElement(a.TextField,{className:"ms-ColumnManagementPanel-minimumValue",label:e.minimumValueLabel,ariaLabel:e.minimumValueAriaLabel,placeholder:e.enterNumberPlaceholder,value:this.state.minValue,onChanged:this._minValueChanged,errorMessage:this.state.minValueErrorMessage,ref:this._resolveRef("_minValue")}),o.createElement(a.TextField,{className:"ms-ColumnManagementPanel-maximumValue",label:e.maximumValueLabel,ariaLabel:e.maximumValueAriaLabel,placeholder:e.enterNumberPlaceholder,value:this.state.maxValue,onChanged:this._maxValueChanged,errorMessage:this.state.maxValueErrorMessage,ref:this._resolveRef("_maxValue")}))};e.prototype.getSchemaValues=function(){var e=this;if(this.state.minValueErrorMessage)this.props.showMoreOptions(function(){return e._minValue.focus()});else if(this.state.maxValueErrorMessage)this.props.showMoreOptions(function(){return e._maxValue.focus()});else{if(!(this.state.minValue&&this.state.maxValue&&Number(this.state.minValue)>Number(this.state.maxValue)))return{Min:""!==this.state.minValue?Number(this.state.minValue):null,Max:""!==this.state.maxValue?Number(this.state.maxValue):null};this.props.showMoreOptions(function(){return e._minValue.focus()})}return!1};e.prototype._minValueChanged=function(e){this.props.validateMoreOptions&&this.props.clearValidateMoreOptions&&this.props.clearValidateMoreOptions();this.setState({minValue:e,minValueErrorMessage:isNaN(Number(e))?this.props.strings.minimumValueNotValid:""})};e.prototype._maxValueChanged=function(e){this.props.validateMoreOptions&&this.props.clearValidateMoreOptions&&this.props.clearValidateMoreOptions();this.setState({maxValue:e,maxValueErrorMessage:isNaN(Number(e))?this.props.strings.maximumValueNotValid:""})};r.__decorate([n.autobind],e.prototype,"getSchemaValues",null);r.__decorate([n.autobind],e.prototype,"_minValueChanged",null);r.__decorate([n.autobind],e.prototype,"_maxValueChanged",null);return e}(n.BaseComponent);t.NumberColumnMoreOptions=i});define("I2",["require","exports","ap","at","jP","BT"],function(e,t,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={maxLength:t.props.maxLength,maxLengthErrorMessage:""};return t}e.prototype.render=function(){var e=this.props.strings;return o.createElement("div",{className:"ms-ColumnManagementPanel-textMoreOptions"},o.createElement(a.TextField,{className:"ms-ColumnManagementPanel-maxLength",label:e.maximumLengthLabel,value:this.state.maxLength,onChanged:this._maxLengthChanged,errorMessage:this.state.maxLengthErrorMessage,ref:this._resolveRef("_maxLength")}))};e.prototype.getSchemaValues=function(){var e=this;if(!this.state.maxLengthErrorMessage)return{MaxLength:""!==this.state.maxLength?Number(parseInt(this.state.maxLength,10)):null};this.props.showMoreOptions(function(){return e._maxLength.focus()});return!1};e.prototype._maxLengthChanged=function(e){var t;this.setState({maxLength:e,maxLengthErrorMessage:(t=e,isNaN(Number(t))||Number(t)<1&&""!==t||255<Number(t)?this.props.strings.maximumLengthNotValid:"")})};r.__decorate([n.autobind],e.prototype,"getSchemaValues",null);r.__decorate([n.autobind],e.prototype,"_maxLengthChanged",null);return e}(n.BaseComponent);t.TextColumnMoreOptions=i});define("IX",["require","exports","ap","at","jP","BT","IY"],function(e,t,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={numLines:t.props.numberOfLines,numLinesErrorMessage:"",richText:t.props.richText,appendOnly:t.props.appendOnly,appendOnlyErrorMessage:""};return t}e.prototype.render=function(){var e=this.props.strings,t=o.createElement(s.Toggle,{className:"ms-ColumnManagementPanel-toggle richText",checked:this.state.richText,label:e.richTextToggle,onText:e.toggleOnText,offText:e.toggleOffText,onChanged:this._richTextChanged}),i=o.createElement(s.Toggle,{className:"ms-ColumnManagementPanel-toggle appendOnly",checked:this.state.appendOnly,label:e.appendOnlyToggle,onText:e.toggleOnText,offText:e.toggleOffText,onChanged:this._appendOnlyChanged,ref:"_appendOnly"});return o.createElement("div",{className:"ms-ColumnManagementPanel-textMoreOptions"},o.createElement(a.TextField,{className:"ms-ColumnManagementPanel-numberOfLines",label:e.numberOfLinesLabel,ariaLabel:e.numberOfLinesAriaLabel,value:this.state.numLines,onChanged:this._numLinesChanged,errorMessage:this.state.numLinesErrorMessage,ref:this._resolveRef("_numLines")}),!this.props.isDocumentLibrary&&t,!this.props.isDocumentLibrary&&i,o.createElement("div",{role:"region","aria-live":"polite",className:this.state.appendOnlyErrorMessage?"ms-ColumnManagementPanel-error":""},o.createElement("span",null,this.state.appendOnlyErrorMessage)))};e.prototype.getSchemaValues=function(){var e=this;if(!this.state.appendOnlyErrorMessage&&!this.state.numLinesErrorMessage)return{NumLines:""!==this.state.numLines?Number(this.state.numLines):null,RichText:this.state.richText,AppendOnly:this.state.appendOnly,RichTextMode:this.state.richText?"FullHtml":"Compatible",IsolateStyles:this.state.richText};this.state.numLinesErrorMessage&&this.props.showMoreOptions(function(){return e._numLines.focus()});this.state.appendOnlyErrorMessage&&this.props.showMoreOptions(function(){return e._appendOnly.focus()});return!1};e.prototype._numLinesChanged=function(e){var t;this.setState({numLines:e,numLinesErrorMessage:(t=e,isNaN(Number(t))||Number(t)<1&&""!==t||1e3<Number(t)?this.props.strings.numberOfLinesNotValid:"")})};e.prototype._richTextChanged=function(e){this.setState({richText:e})};e.prototype._appendOnlyChanged=function(e){this.setState({appendOnly:e,appendOnlyErrorMessage:this.props.enableVersions||!0!==e?"":this.props.strings.appendOnlyNotValid})};r.__decorate([n.autobind],e.prototype,"getSchemaValues",null);r.__decorate([n.autobind],e.prototype,"_numLinesChanged",null);r.__decorate([n.autobind],e.prototype,"_richTextChanged",null);r.__decorate([n.autobind],e.prototype,"_appendOnlyChanged",null);return e}(n.BaseComponent);t.NoteColumnMoreOptions=i});define("xH",["require","exports","ap","xI","xI"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=o.Dialog});define("xI",["require","exports","ap","x2","xQ","xO","xN","xL","xK","xJ"],function(e,t,i,r,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t);i.__exportStar(d,t)});define("x2",["require","exports","jP","xQ","x3"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Dialog=i.styled(r.DialogBase,o.getStyles)});define("xQ",["require","exports","ap","at","jP","xJ","xR","yg","xO"],function(e,t,I,T,i,r,w,o,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var D=i.classNamesFunction(),A={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:""},M={type:r.DialogType.normal,className:"",topButtonsProps:[]},n=function(t){I.__extends(e,t);function e(e){var a=t.call(this,e)||this;a._getSubTextId=function(){var e=a.props,t=e.ariaDescribedById,i=e.modalProps,r=e.dialogContentProps,o=e.subText,n=t||i&&i.subtitleAriaId;n||(n=(o||r&&r.subText)&&a._defaultSubTextId);return n};a._getTitleTextId=function(){var e=a.props,t=e.ariaLabelledById,i=e.modalProps,r=e.dialogContentProps,o=e.title,n=t||i&&i.titleAriaId;n||(n=(o||r&&r.title)&&a._defaultTitleTextId);return n};a._id=i.getId("Dialog");a._defaultTitleTextId=a._id+"-title";a._defaultSubTextId=a._id+"-subText";a._warnDeprecations({isOpen:"hidden",type:"dialogContentProps.type",subText:"dialogContentProps.subText",contentClassName:"dialogContentProps.className",topButtonsProps:"dialogContentProps.topButtonsProps",className:"modalProps.className",isDarkOverlay:"modalProps.isDarkOverlay",isBlocking:"modalProps.isBlocking",containerClassName:"modalProps.containerClassName",onDismissed:"modalProps.onDismissed",onLayerDidMount:"modalProps.onLayerDidMount",ariaDescribedById:"modalProps.subtitleAriaId",ariaLabelledById:"modalProps.titleAriaId"});return a}e.prototype.render=function(){var e=this.props,t=e.className,i=e.containerClassName,r=e.contentClassName,o=e.elementToFocusOnDismiss,n=e.firstFocusableSelector,a=e.forceFocusInsideTrap,s=e.getStyles,l=e.hidden,d=e.ignoreExternalFocusing,c=e.isBlocking,u=e.isClickableOutsideFocusTrap,p=e.isDarkOverlay,m=e.isOpen,h=e.onDismiss,f=e.onDismissed,g=e.onLayerDidMount,y=e.responsiveMode,v=e.subText,_=e.theme,b=e.title,x=e.topButtonsProps,S=e.type,C=I.__assign({},A,this.props.modalProps),P=I.__assign({},M,this.props.dialogContentProps),k=D(s,{theme:_,className:t||C.className,containerClassName:i||C.containerClassName,hidden:l});return T.createElement(w.Modal,I.__assign({elementToFocusOnDismiss:o,firstFocusableSelector:n,forceFocusInsideTrap:a,ignoreExternalFocusing:d,isClickableOutsideFocusTrap:u,onDismissed:f,onLayerDidMount:g,responsiveMode:y},C,{isDarkOverlay:void 0!==p?p:C.isDarkOverlay,isBlocking:void 0!==c?c:C.isBlocking,isOpen:void 0!==m?m:!l,className:k.root,containerClassName:k.main,onDismiss:h||C.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),T.createElement(E.DialogContent,I.__assign({titleId:this._defaultTitleTextId,subTextId:this._defaultSubTextId,title:b,subText:v,showCloseButton:void 0!==c?!c:!C.isBlocking,topButtonsProps:x||P.topButtonsProps,type:void 0!==S?S:P.type,onDismiss:h||P.onDismiss,className:r||P.className},P),this.props.children))};e.defaultProps={hidden:!0};return e=I.__decorate([i.customizable("Dialog",["theme"]),o.withResponsiveMode],e)}(i.BaseComponent);t.DialogBase=n});define("xJ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.normal=0]="normal";e[e.largeHeader=1]="largeHeader";e[e.close=2]="close"}(t.DialogType||(t.DialogType={}))});define("xR",["require","exports","ap","xS","xS"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=o.Modal});define("xS",["require","exports","ap","xT"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("xT",["require","exports","ap","at","jP","x0","xV","pm","wn","yg","xU"],function(e,t,r,y,v,_,b,x,S,C,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=i,o=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._focusTrapZone=v.createRef();t.state={id:v.getId("Modal"),isOpen:e.isOpen,isVisible:e.isOpen};return t}e.prototype.componentWillReceiveProps=function(e){clearTimeout(this._onModalCloseTimer);e.isOpen&&(this.state.isOpen?this.setState({isVisible:!0}):this.setState({isOpen:!0}));if(!e.isOpen&&this.state.isOpen){this._onModalCloseTimer=this._async.setTimeout(this._onModalClose,1e3*parseFloat(P.duration));this.setState({isVisible:!1})}};e.prototype.componentDidUpdate=function(e,t){e.isOpen||t.isVisible||this.setState({isVisible:!0})};e.prototype.render=function(){var e=this.props,t=e.elementToFocusOnDismiss,i=e.firstFocusableSelector,r=e.forceFocusInsideTrap,o=e.ignoreExternalFocusing,n=e.isBlocking,a=e.isClickableOutsideFocusTrap,s=e.isDarkOverlay,l=e.onDismiss,d=e.onLayerDidMount,c=e.responsiveMode,u=e.titleAriaId,p=e.subtitleAriaId,m=this.state,h=m.isOpen,f=m.isVisible,g=v.css("ms-Modal",P.root,this.props.className,!!h&&"is-open",!!f&&P.rootIsVisible);return h&&c>=C.ResponsiveMode.small?y.createElement(x.Layer,{onLayerDidMount:d},y.createElement(S.Popup,{role:n?"alertdialog":"dialog",ariaLabelledBy:u,ariaDescribedBy:p,onDismiss:l},y.createElement("div",{className:g},y.createElement(b.Overlay,{isDarkThemed:s,onClick:n?void 0:l}),y.createElement(_.FocusTrapZone,{componentRef:this._focusTrapZone,className:v.css("ms-Dialog-main",P.main,this.props.containerClassName),elementToFocusOnDismiss:t,isClickableOutsideFocusTrap:a||!n,ignoreExternalFocusing:o,forceFocusInsideTrap:r,firstFocusableSelector:i},this.props.children)))):null};e.prototype.focus=function(){this._focusTrapZone.current&&this._focusTrapZone.current.focus()};e.prototype._onModalClose=function(){this.setState({isOpen:!1});this.props.onDismissed&&this.props.onDismissed()};e.defaultProps={isOpen:!1,isDarkOverlay:!0,isBlocking:!1,className:"",containerClassName:""};return e=r.__decorate([C.withResponsiveMode],e)}(v.BaseComponent);t.Modal=o});define("xU",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_bf825382{background-color:transparent;position:fixed;height:100%;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:0;pointer-events:none;-webkit-transition:opacity .267s;transition:opacity .267s}.root_bf825382 .ms-Button.ms-Button--compound{display:block}[dir='ltr'] .root_bf825382 .ms-Button.ms-Button--compound{margin-left:0}[dir='rtl'] .root_bf825382 .ms-Button.ms-Button--compound{margin-right:0}@media screen and (-ms-high-contrast: active){.root_bf825382 .ms-Overlay{opacity:0}}.rootIsVisible_bf825382{opacity:1;pointer-events:auto}.main_bf825382{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;outline:3px solid transparent;max-height:100%;overflow-y:auto}[dir='ltr'] .main_bf825382{-webkit-box-shadow:0 0 5px 0 rgba(0,0,0,0.4);box-shadow:0 0 5px 0 rgba(0,0,0,0.4)}[dir='rtl'] .main_bf825382{-webkit-box-shadow:0 0 5px 0 rgba(0,0,0,0.4);box-shadow:0 0 5px 0 rgba(0,0,0,0.4)}[dir='ltr'] .main_bf825382{text-align:left}[dir='rtl'] .main_bf825382{text-align:right}\n"}]);t.duration=".267s";t.root="root_bf825382";t.rootIsVisible="rootIsVisible_bf825382";t.main="main_bf825382"});define("xO",["require","exports","jP","xN","xP"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DialogContent=i.styled(r.DialogContentBase,o.getStyles)});define("xN",["require","exports","ap","at","jP","xJ","wN","xL","yg"],function(e,t,f,g,i,y,v,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=i.classNamesFunction(),n=function(t){f.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){var e,t=this.props,i=t.showCloseButton,r=t.className,o=t.closeButtonAriaLabel,n=t.onDismiss,a=t.subTextId,s=t.subText,l=t.titleId,d=t.title,c=t.type,u=t.getStyles,p=t.theme,m=_(u,{theme:p,className:r,isLargeHeader:c===y.DialogType.largeHeader,isClose:c===y.DialogType.close}),h=this._groupChildren();s&&(e=g.createElement("p",{className:m.subText,id:a},s));return g.createElement("div",{className:m.content},g.createElement("div",{className:m.header},g.createElement("p",{className:m.title,id:l,role:"heading"},d),g.createElement("div",{className:m.topButton},this.props.topButtonsProps.map(function(e){return g.createElement(v.IconButton,f.__assign({},e))}),(c===y.DialogType.close||i&&c!==y.DialogType.largeHeader)&&g.createElement(v.IconButton,{className:m.button,iconProps:{iconName:"Cancel"},ariaLabel:o,onClick:n}))),g.createElement("div",{className:m.inner},g.createElement("div",{className:m.innerContent},e,h.contents),h.footers))};e.prototype._groupChildren=function(){var t={footers:[],contents:[]};g.Children.map(this.props.children,function(e){"object"==typeof e&&null!==e&&e.type===r.DialogFooter?t.footers.push(e):t.contents.push(e)});return t};e.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"};return e=f.__decorate([i.customizable("DialogContent",["theme"]),o.withResponsiveMode],e)}(i.BaseComponent);t.DialogContentBase=n});define("xL",["require","exports","jP","xK","xM"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DialogFooter=i.styled(r.DialogFooterBase,o.getStyles)});define("xK",["require","exports","ap","at","jP"],function(e,t,i,o,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.classNamesFunction(),a=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.className,i=e.getStyles,r=e.theme;this._classNames=n(i,{theme:r,className:t});return o.createElement("div",{className:this._classNames.actions},o.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))};t.prototype._renderChildrenAsActions=function(){var t=this;return o.Children.map(this.props.children,function(e){return e?o.createElement("span",{className:t._classNames.action},e):null})};return t=i.__decorate([r.customizable("DialogFooter",["theme"])],t)}(r.BaseComponent);t.DialogFooterBase=a});define("xM",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){return{actions:["ms-Dialog-actions",{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"20px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},e.className],action:["ms-Dialog-action"],actionsRight:["ms-Dialog-actionsRight",{textAlign:"right",marginRight:"-4px",fontSize:"0",selectors:{$action:{margin:"0 4px"}}}]}}});define("xP",["require","exports","d"],function(e,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t=e.className,i=e.theme,r=e.isLargeHeader,o=e.isClose,n=e.hidden,a=e.isMultiline,s=i.palette,l=i.fonts;return{content:[r&&"ms-Dialog-lgHeader",o&&"ms-Dialog--close",{flexGrow:1},t],subText:["ms-Dialog-subText",r?l.medium:l.small,{margin:"0 0 20px 0",paddingTop:"8px",color:s.neutralPrimary,lineHeight:"1.5",wordWrap:"break-word",fontWeight:d.FontWeights.semilight}],header:["ms-Dialog-header",{position:"relative",width:"100%",boxSizing:"border-box"},r&&["ms-Dialog--lgHeader",{backgroundColor:s.themePrimary}],o&&"ms-Dialog--close"],button:["ms-Dialog-button","ms-Dialog-button--close",n&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:s.neutralSecondary,fontSize:"16px"}}}],inner:["ms-Dialog-inner",{padding:a?"0 20px 20px":"0 28px 20px"}],innerContent:["ms-Dialog-content",{position:"relative",width:"100%",selectors:{".ms-Button.ms-Button--compount":{marginBottom:"20px",selectors:{"&:last-child":{marginBottom:"0"}}}}},t],title:["ms-Dialog-title",{color:s.neutralPrimary,margin:"0",padding:"20px 36px 20px 28px"},l.xLarge,r&&[{color:s.white,marginBottom:"8px",padding:"26px 28px 28px"},l.xxLarge],a&&l.xxLarge],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"12px 12px 0 0",selectors:{"> *":{flex:"0 0 auto"}}}]}}});define("x3",["require","exports","d"],function(e,t,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t,i=e.className,r=e.containerClassName,o=e.dialogDefaultMinWidth,n=void 0===o?"288px":o,a=e.dialogDefaultMaxWidth,s=void 0===a?"340px":a,l=e.hidden;return{root:["ms-Dialog",i],main:[{width:n,selectors:(t={},t["@media (min-width: "+d.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:s,minWidth:n},t)},!l&&{display:"flex"},r]}}});define("Jp",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-ColumnManagementPanel.hidden{display:none}.ms-ColumnManagementPanel .ms-Panel-content{padding-bottom:0}.ms-ColumnManagementPanel-spinner{height:50px}.ms-ColumnManagementPanel-loadingError{font-size:12px;font-weight:400;color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:"}.ms-ColumnManagementPanel-content{margin-bottom:20px}.ms-ColumnManagementPanel-titleLearnMore{margin-bottom:10px}.ms-ColumnManagementPanel-nameTextField{margin-bottom:10px}.ms-ColumnManagementPanel-descriptionTextField{margin-bottom:10px}.ms-ColumnManagementPanel-fieldTypeSwitcher{margin-bottom:10px}.ms-ColumnManagementPanel-fieldTypeSwitcher.noUniqueFields{margin-bottom:18px}.ms-ColumnManagementPanel-choicesTextField{margin-bottom:6px}.ms-ColumnManagementPanel-uniqueFields{margin-bottom:10px}.ms-ColumnManagementPanel-defaultValueDropdown{margin-bottom:6px}.ms-ColumnManagementPanel-decimalsDropdown{margin-bottom:6px}.ms-ColumnManagementPanel-defaultValueEntryField{margin-bottom:6px}.ms-ColumnManagementPanel-defaultFormulaEntryField{margin-bottom:6px}.ms-ColumnManagementPanel-booleanDefaultValue{margin-bottom:18px}.ms-ColumnManagementPanel-calloutSubText{margin-top:0;margin-bottom:5px}.ms-ColumnManagementPanel-calloutInner{margin:15px}.ms-ColumnManagementPanel-calloutInner:focus{outline:0}.ms-ColumnManagementPanel-useCalculatedValue{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.ms-ColumnManagementPanel-infoTeachingIcon{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.ms-ColumnManagementPanel-infoIcon{padding-top:3px}.ms-ColumnManagementPanel-infoIcon .ms-Icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-ColumnManagementPanel-infoLabel{font-size:12px;font-weight:400}.ms-ColumnManagementPanel-currencyListLabel{font-size:12px;font-weight:400;margin-top:10px;padding-top:5px;padding-bottom:5px}.ms-ColumnManagementPanel-currencyDropdownContainer{position:relative;margin-bottom:10px}.ms-ColumnManagementPanel-currenciesDropdown.hidden{visibility:hidden}.ms-ColumnManagementPanel-currencySpinner{position:absolute;top:0;margin-left:auto;margin-right:auto;left:0;right:0}.ms-ColumnManagementPanel-currenciesLoadingError{font-size:12px;font-weight:400;color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:";margin-top:5px}.ms-ColumnManagementPanel-allowManuallyAddValues{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin-bottom:5px}.ms-ColumnManagementPanel-checkboxNoInfo{padding-top:6px;padding-bottom:6px}.ms-ColumnManagementPanel-showAsPercentageCheckbox{margin-bottom:5px}.ms-ColumnManagementPanel-moreOptions.hidden{display:none}.ms-ColumnManagementPanel-moreOptionsButton{margin-bottom:10px}.ms-ColumnManagementPanel-minimumValue{margin-bottom:8px}.ms-ColumnManagementPanel-maximumValue{margin-bottom:8px}.ms-ColumnManagementPanel-maxLength{margin-bottom:8px}.ms-ColumnManagementPanel-numberOfLines{margin-bottom:8px}.ms-ColumnManagementPanel-columnValidationButton{margin-top:16px;margin-bottom:16px}.ms-ColumnManagementPanel-columnValidation.hidden{display:none}.ms-ColumnManagementPanel-validationGuideText{font-size:12px;font-weight:400;margin-bottom:15px}.ms-ColumnManagementPanel-learnMoreLink{margin-bottom:10px;font-size:12px;font-weight:400}.ms-ColumnManagementPanel-formulaTextField{margin-bottom:10px}.ms-ColumnManagementPanel-messageGuideText{font-size:12px;font-weight:400}.ms-ColumnManagementPanel .ms-Panel-footer{border-top-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ms-ColumnManagementPanel.loading .ms-Panel-footer{display:none;border-top-color:transparent}.ms-ColumnManagementPanel-error{margin-top:12px;font-size:12px;font-weight:400;color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:"}.ms-ColumnManagementPanel-dateTimePicker{margin-bottom:10px}"}])});define("VD",["require","exports","ap","bO","rs","bX","or","ba","la","IO","ot","bA","V","Vt","bf"],function(e,t,i,r,o,n,w,E,D,A,a,s,M,l,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=[{type:D.default.Text,menuTitle:a.strings.columnMenuCreateText,dialogTitle:a.strings.createTextDialogTitle},{type:D.default.Note,menuTitle:a.strings.columnMenuCreateNote,dialogTitle:a.strings.createNoteDialogTitle},{type:D.default.Number,menuTitle:a.strings.columnMenuCreateNumber},{type:D.default.Boolean,menuTitle:a.strings.columnMenuCreateBoolean,dialogTitle:a.strings.createBooleanDialogTitle},{type:D.default.User,menuTitle:a.strings.columnMenuCreatePerson},{type:D.default.DateTime,menuTitle:a.strings.columnMenuCreateDate},{menuTitle:a.strings.addColumnMore,tooltip:a.strings.addColumnMoreTooltip}],d={type:D.default.Choice,menuTitle:a.strings.columnMenuCreateChoice},c={type:D.default.URL,menuTitle:a.strings.columnMenuCreateHyperlink,isHyperlink:!0},u={type:D.default.URL,menuTitle:a.strings.columnMenuCreatePicture,isHyperlink:!1},p={type:D.default.Currency,menuTitle:a.strings.columnMenuCreateCurrency},R=L.slice(),N=L.slice(),O=L.slice();R.splice(L.length-1,0,d,c,u);N.splice(L.length-1,0,p);O.splice(L.length-1,0,d,c,u,p);var m=function(I){i.__extends(T,I);function T(e,t){var i,r=I.call(this,e,t)||this,o=e.column,n=e.includeColumnEditor,a=e.engagementName,s=t.canModifySchema,l=t.actionMap,d=t.editCommandHelperType,c=r.scope.attached(t.commandViewModelType),u=[],p=E.isFeatureEnabled(E.CreateColumnPanels),m=E.isFeatureEnabled(E.CreateCurrencyColumnPanel),h=E.isFeatureEnabled(E.CreateDateTimeColumnPanel),f=F.Killswitch.isActivated("FE058A0D-BF54-4219-A126-AD48F0CB8C43","03/21/2018","Refactor SupportedPanelTypes");i=f?p&&m?O:p?R:m?N:L:T.getCreateFieldTypes();if(s.peek()){for(var g=0,y=i;g<y.length;g++){var v=y[g],_=void 0;if(f){S=p&&-1!==A.SUPPORTED_PANEL_TYPES.indexOf(D.default[v.type]);var b=m&&-1!==A.SUPPORTED_PANEL_TYPES_2.indexOf(D.default[v.type]),x=h&&-1!==A.SUPPORTED_PANEL_TYPES_3.indexOf(D.default[v.type]);_=S||b||x}else{var S;_=S=-1!==A.FieldTypeSwitcherHelper.getSupportedPanelTypes().indexOf(D.default[v.type])}var C=void 0;C=_?new(r.child(l.LaunchColumnManagementPanelAction))({createField:{fieldType:v.type,fieldToInsertAfter:w.getFieldName(o)},isHyperlink:v.isHyperlink}):new(r.child(l.CreateColumnAction))({fieldType:v.type,fieldTypeNameForDialog:v.dialogTitle||M.decapitalize(v.menuTitle),fieldToInsertAfter:w.getFieldName(o)});var P=D.default[v.type];v.type===D.default.URL&&(P=v.isHyperlink?"Hyperlink":"Picture");u.push(new c({text:v.menuTitle,tooltip:v.tooltip,engagementName:"Create"+(P||"Other")+"Field"+a,action:C}))}if(n){var k=new(r.scope.attached(d))({engagementName:a});u.push(k.command)}}r.commands=u;return r}T.getCreateFieldTypes=function(){if(!this.createFieldTypes){this.createFieldTypes=[{type:D.default.Text,menuTitle:a.strings.columnMenuCreateText,dialogTitle:a.strings.createTextDialogTitle},{type:D.default.Note,menuTitle:a.strings.columnMenuCreateNote,dialogTitle:a.strings.createNoteDialogTitle},{type:D.default.Number,menuTitle:a.strings.columnMenuCreateNumber},{type:D.default.Boolean,menuTitle:a.strings.columnMenuCreateBoolean,dialogTitle:a.strings.createBooleanDialogTitle},{type:D.default.User,menuTitle:a.strings.columnMenuCreatePerson},{type:D.default.DateTime,menuTitle:a.strings.columnMenuCreateDate}];E.isFeatureEnabled(E.CreateColumnPanels)&&(this.createFieldTypes=this.createFieldTypes.concat([{type:D.default.Choice,menuTitle:a.strings.columnMenuCreateChoice},{type:D.default.URL,menuTitle:a.strings.columnMenuCreateHyperlink,isHyperlink:!0},{type:D.default.URL,menuTitle:a.strings.columnMenuCreatePicture,isHyperlink:!1}]));E.isFeatureEnabled(E.CreateCurrencyColumnPanel)&&(this.createFieldTypes=this.createFieldTypes.concat([{type:D.default.Currency,menuTitle:a.strings.columnMenuCreateCurrency}]));this.createFieldTypes=this.createFieldTypes.concat([{menuTitle:a.strings.addColumnMore,tooltip:a.strings.addColumnMoreTooltip}])}return this.createFieldTypes};T.dependencies=i.__assign({},r.default.dependencies,{canModifySchema:n.canModifySchema,actionMap:n.actionMap,commandViewModelType:o.typeResourceKey,editCommandHelperType:l.typeResourceKey.local});return T}(r.default);t.AddColumnCommandHelper=m;t.typeResourceKey=new s.ResourceKey({name:""+e("module").id,factory:new s.ResolvedResourceTypeFactory(m)});t.default=m});define("Vt",["require","exports","ap","bO","rs","ot","bA","qY","Vu"],function(e,t,i,r,o,s,n,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(a){i.__extends(e,a);function e(e,t){var i=a.call(this,e,t)||this,r=e.engagementName,o=t.panelProvider,n=i.scope.attached(t.commandViewModelType);i.command=new n({text:s.strings.addColumnShowHide,tooltip:s.strings.addColumnShowHideTooltip,hasLineBreakBefore:!0,engagementName:"OpenColumnsPanel"+r,callback:function(){var e=o.requestPanel({hasCommandBar:!0,component:{name:d.default.tagName,params:{onComplete:function(){return e.state(1)}}}})}});return i}e.dependencies=i.__assign({},r.default.dependencies,{panelProvider:l.resourceKey,commandViewModelType:o.typeResourceKey});return e}(r.default);t.EditColumnCommandHelper=a;t.typeResourceKey=new n.ResourceKey({name:""+e("module").id,factory:new n.ResolvedResourceTypeFactory(a)});t.default=a});define("Vu",["require","exports","VB","b5","VA","Vz","lB","Vv"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-columns-editor",template:e("VA"),viewModel:i.default,synchronous:!0});t.default=o});define("VB",["require","exports","ap","cm","p3","ir","bX","oy","cE","cK","dI","cJ","aq","k9","VC","cU","dz","dB","bF","hL","lB","qe","b3"],function(e,c,t,u,p,i,m,h,r,o,f,g,y,v,_,b,x,S,n,C,P,k,I){"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.INTERNAL_COLUMNS={_CopySource:!0,_dlc_DocId:!0,_dlc_DocIdUrl:!0,_ip_UnifiedCompliancePolicyProperties:!0,_ip_UnifiedCompliancePolicyUIAction:!0,_ModerationComments:!0,_UIVersionString:!0,_x0074_wb0:!0,AppAuthor:!0,AppEditor:!0,CheckoutUser:!0,ContentType:!0,Edit:!0,FileLeafRef:!0,LastSharedByTime:!0,LastSharedByUser:!0,LikesCount:!0,LinkFilenameNoMenu:!0,LinkTitle2:!0,LinkTitleNoMenu:!0,ParentLeafName:!0,ParentVersionString:!0,RatingCount:!0,SharedWithDetails:!0,SharedWithUsers:!0,Title:!0,URLwMenu2:!0,URLNoMenu:!0,URL:!0};var a=function(l){t.__extends(d,l);function d(e){var t=l.call(this)||this;t.loadingSpinnerTagName=P.default.tagName;t._currentView=t.resources.consume(m.currentView);t.addBindingHandlers({hasChildFocus:u.default,keyboard:g.default,scrollContainer:b.default,selection:x.default,delayedHasFocus:h.default,control:I.default});t._onComplete=e.onComplete;t.columns=y.observableArray();t.commandSet={commands:y.observableArray([new p.default({text:_.strings.columnsEditorApplyCommand,icon:new f.default("CheckMark"),callback:function(){t._applyViewFieldsOverride()}})])};t.commandBarSpecification=I.toSpecification(k.resourceKey,{commandSet:t.commandSet});t.focusedColumn=y.observable();t.selectedColumns=y.observableArray();t.selectionModel=new S.default;t.hasData=y.observable(!1);t.strings=_.strings;var i=t.resources.consume(v.resourceKey),r=t.resources.consume(m.currentItemSet),o=t.addDisposable(r().schema.filter(function(e){return d._isColumnVisible(e)})),n=t.addDisposable(o.map(function(e){return t._initializeEditableColumn({checked:y.observable(!0),displayName:e.name||e.internalName,internalName:e.internalName,isEditable:d._isColumnEditable(e)})})),a=t.addDisposable(i.fields.filter(function(t){var e=n().some(function(e){return e.internalName===t.internalName});return t&&!t.isHidden&&!e&&!c.INTERNAL_COLUMNS[t.internalName]&&-1===C.EXCLUDED_FIELDS.indexOf(t.internalName)})),s=t.addDisposable(a.map(function(e){return t._initializeEditableColumn({checked:y.observable(!1),displayName:t._getDisplayName(e),internalName:e.internalName,isEditable:!0})}));i.getFields(!0).then(function(){t.columns(n().concat(s()));t.hasData(!0)});return t}d._isColumnEditable=function(e){return d._isColumnVisible(e)};d._isColumnVisible=function(e){return e&&(e.isVisible||e.isVisibleMobile)&&"_calloutInvoker"!==e.key&&"_shareHeroCommand"!==e.key&&!!e.internalName&&-1===C.EXCLUDED_FIELDS.indexOf(e.internalName)};d.prototype.onClickMoveUp=function(e){this._maintainButtonFocus(e);this._shiftColumnIndex(e,-1)};d.prototype.onClickMoveDown=function(e){this._maintainButtonFocus(e);this._shiftColumnIndex(e,1)};d.prototype.onKeyEnter=function(e,t){if(o.isButtonElement(t.target))return!0;var i=this.focusedColumn();i&&i.isEditable&&i.checked(!i.checked());return!1};d.prototype.onKeyLeft=function(e,t){var i=this.focusedColumn();if(i){var r=this.focusedColumn().moveUpFocused;(0,this.focusedColumn().moveDownFocused)()?r(!0):r()&&i.focused(!0)}return!1};d.prototype.onKeyRight=function(e,t){if(this.focusedColumn()){var i=this.focusedColumn().moveUpFocused,r=this.focusedColumn().moveDownFocused;r()||(i()?r(!0):i(!0))}return!1};d.prototype._getDisplayName=function(e){return 1===i.default.getMappedColumnType(e.internalName)?e.internalName:e.title||e.internalName};d.prototype._applyViewFieldsOverride=function(){this.resources.consume(r.resourceKey).logData({name:"ColumnsEditor.ApplyViewFields",isIntentional:!0});this._currentView.peek().replaceFields(this._getFieldNames());this._currentView.valueHasMutated();this._onComplete&&this._onComplete()};d.prototype._getFieldNames=function(){return this.columns().filter(function(e){return e.checked()}).map(function(e){return e.internalName})};d.prototype._initializeEditableColumn=function(e){e.childFocused=y.observable(!1);e.focused=y.observable(!1);e.key=e.internalName;e.moveDownFocused=y.observable(!1);e.moveUpFocused=y.observable(!1);e.selected=y.observable(!1);return e};d.prototype._maintainButtonFocus=function(t){var i=t.moveUpFocused.peek(),r=t.moveDownFocused.peek(),o=this.subscribe(this.focusedColumn,function(e){if(t===e){o.dispose();t.moveUpFocused(!1);t.moveDownFocused(!1);t.moveUpFocused(i);t.moveDownFocused(r)}})};d.prototype._shiftColumnIndex=function(e,t){var i=this.columns(),r=i.indexOf(e),o=r+t;if(r!==(o=Math.max(Math.min(o,i.length-1),0))){var n=i[o];if(e.isEditable&&n.isEditable){i[o]=i[r];i[r]=n;this.columns(i)}}};return d}(n.default);c.default=a});define("VA",[],function(){return'<div class=od-ColumnsEditor-contentContainer data-bind="scrollContainer: {}" role=application><div class="od-ColumnsEditor-title ms-font-xl ms-fontWeight-semilight" data-bind="text: strings.columnsEditorTitle"></div><p id=descriptionList class=od-ColumnsEditor-helpText data-bind="text: strings.columnsEditorHelpText"></p>\x3c!--ko if: hasData--\x3e<ol aria-describedby=descriptionList aria-multiselectable=false class=od-ColumnsEditor-list role=listbox data-bind="keyboard: { allowButtonEvents: true, useRtlMappings: true, mappings: { \'Enter\': onKeyEnter, \'Space\': onKeyEnter, \'Left\': onKeyLeft, \'Right\': onKeyRight } }, selection: { data: columns, mode: \'single\', direction: \'vertical\', focused: focusedColumn, selected: selectedColumns, selectionModel: selectionModel, allowInputEvents: true }, attr: { tabindex: !focusedColumn() ? 0 : -1 }, component: { name: \'od-sortable\', params: { dragProxyClass: \'od-ColumnsEditor-dragProxy\', items: columns } }">\x3c!--ko with: $host.item--\x3e<li class=od-ColumnsEditor-listItem role=option data-bind="attr: { tabindex: $parent.focusedColumn() === $data ? 0 : -1, \'aria-checked\': checked, \'aria-selected\': selected, \'aria-posinset\': $index, \'data-draggable\': String(isEditable) }, css: { \'is-childFocused\': childFocused, \'is-editable\': isEditable }, hasChildFocus: childFocused, delayedHasFocus: focused"><label class=od-ColumnsEditor-itemLabel><div class=ms-CheckBox><input tabindex=-1 class=ms-CheckBox-input type=checkbox data-bind="checked: checked, enable: isEditable"> <label class=ms-CheckBox-field role=checkbox data-bind="css: {\'is-checked\': checked}, attr: {\'aria-checked\': checked}"><span class="od-ColumnsEditor-itemText ms-Label" data-bind="attr: { title: displayName }, text: displayName"></span></label></div></label>\x3c!--ko if: isEditable--\x3e<div class=od-ColumnsEditor-itemButtons><button class=od-ColumnsEditor-button tabindex=-1 data-bind="click: $parent.onClickMoveUp.bind($parent, $data), delayedHasFocus: moveUpFocused, attr: { title: $parent.strings.columnsEditorMoveUpTooltip }, keyboard: { mappings: { Space: $parent.onClickMoveUp.bind($parent, $data) } }"><i aria-hidden=true class="ms-Icon ms-Icon--ChevronUp" data-bind="icon: true"></i></button> <button class=od-ColumnsEditor-button tabindex=-1 data-bind="click: $parent.onClickMoveDown.bind($parent, $data), delayedHasFocus: moveDownFocused, attr: { title: $parent.strings.columnsEditorMoveDownTooltip }, keyboard: { mappings: { Space: $parent.onClickMoveDown.bind($parent, $data) } }"><i aria-hidden=true class="ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e</li>\x3c!--/ko--\x3e</ol>\x3c!--/ko--\x3e\x3c!--ko ifnot: hasData--\x3e<span class=ms-font-m data-bind="component: { name: loadingSpinnerTagName, params: { loadingText: strings.columnsEditorLoadingText } }"></span>\x3c!--/ko--\x3e</div><div class=od-ColumnsEditor-commandBar data-bind="control: commandBarSpecification"></div>'});define("Vz",["c","az"],function(e,t){e.loadStyles([{rawString:".od-ColumnsEditor-contentContainer{position:absolute;overflow-y:scroll;top:40px;bottom:0;padding:30px 40px}[dir=ltr] .od-ColumnsEditor-contentContainer{left:0}[dir=rtl] .od-ColumnsEditor-contentContainer{right:0}[dir=ltr] .od-ColumnsEditor-contentContainer{right:0}[dir=rtl] .od-ColumnsEditor-contentContainer{left:0}.od-ColumnsEditor-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:1px;padding:0;background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-ColumnsEditor-commandBar .CommandBar,.od-ColumnsEditor-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-ColumnsEditor-commandBar .CommandBar,.od-ColumnsEditor-commandBar .ms-CommandBar{animation:none}}.od-ColumnsEditor-helpText{font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-ColumnsEditor-dragProxy,.od-ColumnsEditor-list{font-size:12px;list-style-type:none;padding-left:0;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";outline:0}.od-ColumnsEditor-listItem{display:block;height:20px;margin:4px 0;outline:0;padding:6px;white-space:nowrap}.od-ColumnsEditor-listItem:not(.is-editable){color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-ColumnsEditor-listItem.is-editable.is-dragging .od-ColumnsEditor-itemButtons,.od-ColumnsEditor-listItem.is-editable:hover .od-ColumnsEditor-itemButtons,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemButtons{display:block}.od-ColumnsEditor-listItem.is-editable.is-dragging .od-ColumnsEditor-itemLabel,.od-ColumnsEditor-listItem.is-editable:hover .od-ColumnsEditor-itemLabel,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemLabel{width:150px}.od-ColumnsEditor-listItem.is-editable.is-dragging .ms-CheckBox-field:before,.od-ColumnsEditor-listItem.is-editable:hover .ms-CheckBox-field:before,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .ms-CheckBox-field:before{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-ColumnsEditor-listItem.is-editable.is-dragging .ms-CheckBox-field.is-checked:before,.od-ColumnsEditor-listItem.is-editable:hover .ms-CheckBox-field.is-checked:before,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .ms-CheckBox-field.is-checked:before{border-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-ColumnsEditor-listItem.is-editable.is-dragging .od-ColumnsEditor-itemText,.od-ColumnsEditor-listItem.is-editable:hover .od-ColumnsEditor-itemText,.od-focus--enabled .od-ColumnsEditor-listItem.is-editable.is-childFocused .od-ColumnsEditor-itemText{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-ColumnsEditor-listItem.is-editable.is-dragging,.od-ColumnsEditor-listItem.is-editable:hover{background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-ColumnsEditor-listItem.is-editable .od-ColumnsEditor-itemLabel{cursor:pointer}.od-focus--enabled .od-ColumnsEditor-listItem:focus{outline:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:'}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel{overflow:hidden;text-overflow:ellipsis}html[dir=ltr] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel{float:left}html[dir=rtl] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel{float:right}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemLabel.is-checked{font-family:"Segoe UI Semibold WestEuropean","Segoe UI Semibold","Segoe UI",Tahoma,Arial,sans-serif}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemButtons{display:none;left:3px;position:relative;top:-6px;width:64px}html[dir=ltr] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemButtons{float:right}html[dir=rtl] .od-ColumnsEditor-listItem .od-ColumnsEditor-itemButtons{float:left}.od-ColumnsEditor-listItem .od-ColumnsEditor-button{background:0 0;border:0;color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-size:17px;height:32px;line-height:32px;margin:0;outline:0;padding:0;width:32px}.od-ColumnsEditor-listItem .od-ColumnsEditor-button:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}.od-ColumnsEditor-listItem .od-ColumnsEditor-button:active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.od-ColumnsEditor-listItem .od-ColumnsEditor-itemText{vertical-align:top}.od-ColumnsEditor-listItem .ms-CheckBox{min-height:24px;margin-left:1px;display:inline-block;pointer-events:none}.od-ColumnsEditor-listItem .ms-CheckBox-field{margin-top:1px}"}])});define("Vv",["require","exports","b5","Vy","Vx","Vw"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-sortable",template:e("Vx"),viewModel:r.default,synchronous:!0});t.default=o});define("Vy",["require","exports","ap","zc","b6","bW","cA","aq","bV","b7","cU","bF","cp"],function(e,t,i,l,u,d,c,p,m,h,f,r,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="dragdata",n=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this,i=e.items,r=e.dragProxyClass,o=void 0===r?void 0:r,n=e.placeholderClass,a=void 0===n?void 0:n;t.addBindingHandlers({autoScroll:l.default,element:d.default,host:c.default});t.overlayTagName=g.default.tagName;t.autoScrollEnabled=p.observable(!1);t.autoScrollY=p.observable(0);t.element=p.observable(null);t.items=i;t.proxyOverlayElement=p.observable(null);t.proxyOverlayVisible=p.observable(!1);t._dragProxyClass=o;t._placeholderClass=a;t._draggables=[];t._scrollParent=t.createPureComputed(function(){if(t.element())return f.getScrollContainer(t.element())});t.subscribe(t._scrollParent,function(e){t.events.off(e,"scroll",t._onScroll)},!0);t.subscribe(t._scrollParent,function(e){t.events.on(e,"scroll",t._onScroll)});t.events.on(document.body,"dragend",t.onMouseUp);t.events.on(document.body,"mousemove",t._onMouseMove);t.events.on(document.body,"touchmove",t._onTouchMove);t.events.on(document,"mouseup",t.onMouseUp);return t}e.prototype.onAfterMove=function(e,t,i){if(e.nodeType===Node.ELEMENT_NODE){var r=this._getDraggableByData(i);if(r){r.element=e;r.bounds=this._getDraggableBounds(r);r.dataIndex=this.items.peek().indexOf(i)}}};e.prototype.onAfterRender=function(e,t){for(var i=0,r=e;i<r.length;i++){var o=r[i];if(o.nodeType===Node.ELEMENT_NODE){var n=o.getAttribute("data-draggable");n&&"true"!==n||this._addDraggable(o,t);break}}};e.prototype.onMouseUp=function(e){0===e.button&&this._onDragEnd()};e.prototype.onTouchEnd=function(e){if(this._touchTimerId){this.async.clearTimeout(this._touchTimerId);this._touchTimerId=void 0}var t=!0;this._activeDraggable||(t=!1);this._onDragEnd();return!t};e.prototype._addDraggable=function(e,t){var i={bounds:null,data:t,dataIndex:this.items.peek().indexOf(t),element:e,isDragging:!1};p.utils.domData.set(e,o,i);this.events.on(e,"mousedown",this._onMouseDown);this.events.on(e,"touchstart",this._onTouchStart);i.bounds=this._getDraggableBounds(i);this._draggables.push(i)};e.prototype._createPlaceholder=function(e){this._placeholder&&this._destroyPlaceholder();var t=e.nodeName.toLowerCase(),i=document.createElement(t);if(this._placeholderClass)u.default.toggleClass(i,this._placeholderClass,!0);else{var r=window.getComputedStyle(e);i.style.margin=r.margin;i.style.padding=r.padding;i.style.width=r.width;i.style.height=r.height}e.parentElement.insertBefore(i,e.nextElementSibling);this._placeholder={baseElement:e,baseElementDisplay:e.style.display,draggable:p.utils.domData.get(e,o),element:i};e.style.display="none"};e.prototype._createProxy=function(e,t){this._proxy&&this._destroyProxy();this.proxyOverlayVisible(!0);var i=e.cloneNode(!0),r=window.getComputedStyle(e),o={left:parseInt(r.marginLeft,10)||0,top:parseInt(r.marginTop,10)||0,right:parseInt(r.marginRight,10)||0,bottom:parseInt(r.marginBottom,10)||0};i.removeAttribute("id");i.style.width=r.width;i.style.height=r.height;u.default.toggleClass(i,"is-dragging",!0);u.default.toggleClass(i,"od-Sortable--proxy",!0);this._dragProxyClass&&u.default.toggleClass(i,this._dragProxyClass,!0);var n=e.parentElement,a=e.nextElementSibling;this.proxyOverlayElement.peek().appendChild(i);var s=new m.default(t),l=e.getBoundingClientRect();s=(s=s.subtract(new m.default(l.left,l.top))).add(new m.default(o.left,o.top));var d=new m.default;if(e.offsetParent){var c=e.offsetParent.getBoundingClientRect();d.x=c.left;d.y=c.top}this._proxy={bounds:new h.default(0,0,i.offsetWidth,i.offsetHeight),clickOffset:s,element:i,margins:o,parentOffset:d,parentElement:n,nextElementSibling:a};this._updateProxyPosition(t);this._createPlaceholder(e)};e.prototype._destroyPlaceholder=function(){if(this._placeholder){this._placeholder.element&&this._placeholder.element.parentElement&&this._placeholder.element.parentElement.removeChild(this._placeholder.element);this._placeholder.baseElement&&(this._placeholder.baseElement.style.display=this._placeholder.baseElementDisplay);this._placeholder=null}};e.prototype._destroyProxy=function(){if(this._proxy){var e=this._proxy.element;e&&e.parentElement&&e.parentElement.removeChild(e);this.autoScrollEnabled(!1);this.proxyOverlayVisible(!1);this._proxy=null}};e.prototype._findNearestDraggable=function(){for(var e=null,t=this._proxy.bounds.getCenter(),i=4294967295,r=0,o=this._draggables;r<o.length;r++){var n=o[r],a=n.bounds.getCenter(),s=t.distance(a);if(s<i){i=s;e=n}}return e};e.prototype._getDraggableBounds=function(e){var t=u.default.calculateSubtreeRect(e.element),i=e.element.offsetParent,r=this._scrollParent.peek();if(i&&r){var o=i.getBoundingClientRect();t=(t=t.translate(-o.left,-o.top)).translate(new m.default(r.scrollLeft,r.scrollTop))}return t};e.prototype._getDraggableByData=function(e){for(var t=0,i=this._draggables;t<i.length;t++){var r=i[t];if(r.data===e)return r}return null};e.prototype._onDragEnd=function(){if(this._activeDraggable){if(this._placeholder){var e=this._activeDraggable.dataIndex,t=this._placeholder.draggable.dataIndex;this._destroyProxy();this._destroyPlaceholder();if(e!==t){var i=this.items.peek();i.splice(t,0,i.splice(e,1)[0]);this.items(i)}}this._activeDraggable.isDragging=!1;this._activeDraggable=null}};e.prototype._onDragMove=function(e){if(this._proxy){this._updateProxyPosition(e);this._updatePlaceholder()}this._lastDragOffset=e};e.prototype._onMouseDown=function(e){if(0===e.button){var t=e.currentTarget,i=p.utils.domData.get(t,o);if(i){this._activeDraggable=i;this._activeDraggable.isDragging=!0;this._startDragPosition=new m.default(e.pageX,e.pageY)}e.preventDefault()}};e.prototype._onMouseMove=function(e){if(this._activeDraggable){var t=new m.default(e.pageX,e.pageY),i=this._startDragPosition.distance(t);!this._proxy&&3<=i&&this._createProxy(this._activeDraggable.element,t);this._onDragMove(t)}};e.prototype._onScroll=function(e){this._lastDragOffset&&this._onDragMove(this._lastDragOffset)};e.prototype._onTouchMove=function(e){var t=e.targetTouches[0],i=new m.default(t.pageX,t.pageY),r=this._startDragPosition.distance(i);if(this._activeDraggable){!this._proxy&&3<=r&&this._createProxy(this._activeDraggable.element,i);this._onDragMove(i);e.preventDefault()}else if(5<r&&this._touchTimerId){this.async.clearTimeout(this._touchTimerId);this._touchTimerId=void 0}};e.prototype._onTouchLongHold=function(e){var t=e.targetTouches[0].target,i=p.utils.domData.get(t,o);if(i){this._activeDraggable=i;this._activeDraggable.isDragging=!0}this._touchTimerId=void 0};e.prototype._onTouchStart=function(e){var t=e.targetTouches[0];this._touchTimerId&&this.async.clearTimeout(this._touchTimerId);this._startDragPosition=new m.default(t.pageX,t.pageY);this._touchTimerId=this.async.setTimeout(this._onTouchLongHold.bind(this,e),500)};e.prototype._updatePlaceholder=function(){var e=this._findNearestDraggable();if(e&&(!this._placeholder||this._placeholder.draggable!==e)){var t=e.element,i=this._placeholder.element,r=i.parentElement;r.removeChild(i);e.dataIndex<this._activeDraggable.dataIndex?r.insertBefore(i,t):r.insertBefore(i,t.nextElementSibling);this._placeholder.draggable=e}};e.prototype._updateProxyPosition=function(e){var t=new m.default(e),i=this._scrollParent.peek(),r=i?new m.default(i.scrollLeft,i.scrollTop):new m.default,o=t=t.subtract(this._proxy.clickOffset);if(i&&this._proxy&&this._proxy.element&&!m.default.areEqual(this._proxy.bounds.getPoint(),t)){this._proxy.element.style.left=t.x+"px";this._proxy.element.style.top=t.y+"px";t=(t=t.subtract(this._proxy.parentOffset)).add(r);this._proxy.bounds=new h.default(t.x,t.y,this._proxy.bounds.width,this._proxy.bounds.height);this.autoScrollEnabled(!0);this.autoScrollY(o.y)}};return e}(r.default);t.default=n});define("Vx",[],function(){return'<div class=od-Sortable data-bind="autoScroll: { enabled: autoScrollEnabled, y: autoScrollY }, element: element, event: { mouseup: onMouseUp.bind($data), touchend: onTouchEnd.bind($data) }, foreach: { afterMove: onAfterMove.bind($data), afterRender: onAfterRender.bind($data), data: items }">\x3c!--ko host: { data: { item: $data } }--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: proxyOverlayVisible--\x3e\x3c!--ko component: { name: overlayTagName }--\x3e<div class=od-Sortable--proxyOverlay data-bind="element: proxyOverlayElement"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("Vw",["c","az"],function(e,t){e.loadStyles([{rawString:".od-Sortable--proxy{position:absolute;z-index:3000}"}])});define("Vr",["require","exports","ap","bN","rs","bX","dZ","iE","ot","V","bA","dJ","ba","im","Sw","or","E9","ep","b4","ex","dk","hE","cE"],function(e,t,i,r,o,n,a,s,v,m,l,h,_,d,c,b,f,x,u,g,S,C,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getClearFilterCommandResourceKey=new l.ResourceKey({name:e("module").id+".getClearFilterCommand",factory:new l.ConstantResourceFactory(c.default.getClearFilterCommand)});var y=function(y){i.__extends(e,y);function e(e,t){var i=y.call(this,e,t)||this,r=e.column,o=e.engagementName;i._column=r;var n=t.actionMap,a=t.viewParams,s=t.currentView,l=t.pageContext,d=t.itemDataSource,c=t.getClearFilterCommand,u=t.engagement;i._viewParams=a;i._currentView=s;i._itemDataSource=d;i._engagement=u;i._columnInternalName=b.getFieldName(i._column);var p=Number(l.webTemplate)===x.default.mySite,m=i.observables.pureCompute(i._computeHasLineBreakAfter),h=[],f=i.scope.attached(t.commandViewModelType);_.isFeatureEnabled(_.SPListNextColumnHeaderFilter)&&!p?h.push(new f({text:i.observables.pureCompute(i._computeFilterText),collapseSingleChildCommands:!1,hasLineBreakAfter:m,action:new(i.child(n.LaunchFilterPanelAction))({column:r})})):h.push(new f({text:v.strings.columnMenuFilter,collapseSingleChildCommands:!1,hasLineBreakAfter:m,children:i._getFilterCommands(),hasDeferredChildren:!0}));var g=c(i.resources,i._columnInternalName,"ClearFilters"+o);g.hasLineBreakAfter(!0);h.push(g);i.commands=h;return i}e.prototype._computeHasLineBreakAfter=function(){var e=h.serializeQuery(this._viewParams());return!d.default.getFilterFieldByName(e,this._columnInternalName)};e.prototype._computeFilterText=function(){var e,t,i=this._currentView();if(this._viewParams().useFiltersInViewXml){t=h.serializeQuery(this._viewParams.peek());if(!i.isDirty())for(var r=0,o=C.default.getFilterList(t,void 0,!0,!0);r<o.length;r++){var n=o[r];if(n.values&&0<n.values.length){n.type||this._engagement.logData({name:"FilterColumnCommandHelper.ComputeFilterText.MissingFilterType",extraData:{fieldName:n.fieldName,filterOperator:n.operator,queryString:t}});f.updateFilter(i,n)}}}var a=f.getFilter(i,this._column.internalName);if(a&&0<a.values.length){var s=a.values.length;if(this._column.fieldType===g.ColumnFieldType.FileIcon){for(var l={},d=0,c=a.values;d<c.length;d++){var u=c[d],p=S.OfficeIconFileTypeMap[u];(!p||u&&"pdf"===u.toLowerCase())&&(p=u);l[p]=p}s=Object.keys(l).length}e=m.format(v.strings.columnMenuFilterByWithNumber,s)}else e=v.strings.columnMenuFilter;return e};e.prototype._getFilterCommands=function(){var a=this,n=new u.default,s=this.observables.createArray();this.createBackgroundComputed(function(){var t=a._column,i=h.serializeQuery(a._viewParams()),r=t.internalName||t.key,e=a._currentView(),o=e&&e.id;n.debounce(a.trackPromise(a._itemDataSource.getFilterData(r,i,o,t.fieldType).then(function(e){return e?c.default.getFilterMenuItems(a.resources,t,e,i,r,!0):[]}))).done(function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];a.addDisposable(r)}for(var o=0,n=s.splice.apply(s,[0,s.peek().length].concat(e));o<n.length;o++){(r=n[o]).dispose()}})});return s};e.dependencies=i.__assign({},r.default.dependencies,{actionMap:n.actionMap,viewParams:n.viewParams,itemDataSource:a.items,currentView:n.currentView,pageContext:s.pageContext,commandViewModelType:o.typeResourceKey,getClearFilterCommand:t.getClearFilterCommandResourceKey,engagement:p.resourceKey});return e}(r.default);t.FilterColumnCommandHelper=y;t.typeResourceKey=new l.ResourceKey({name:""+e("module").id,factory:new l.ResolvedResourceTypeFactory(y)});t.default=y});define("E9",["require","exports","io","Fa","ld","bp","im"],function(e,t,n,a,s,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFilter=function(e,t){var i=u(e,t);if(i){var r=a.parseFilter(i);if(r&&1===r.length&&r[0]){var o=r[0];o.id=t;return o}}};t.updateFilter=function(e,t){if(!t.id)throw new Error("Must provide a filter with an id to use updateFilter");var i=s.filterToCaml(t);if(!i)throw new Error("Filter could not be serialized");var r=u(e,t.id);if(r){var o=void 0;try{o=l.xmlToDom(i).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}r.parentNode.replaceChild(o,r);e.setIsDirty(!0,n.ArrangeInfoType.filters)}else e.addFilters([i])};function d(e,t){var i=u(e,t);if(i){var r=i.parentNode;r.removeChild(i);"Or"!==r.tagName&&"And"!==r.tagName||r.parentNode.replaceChild(r.firstElementChild,r);e.setIsDirty(!0,n.ArrangeInfoType.filters)}}t.removeFilter=d;function c(e){var t=e.getDomParts();if(t&&t.where){var i=t.where.querySelectorAll("[id]"),r=[];if(i)for(var o=0;o<i.length;o++){var n=a.parseFilter(i[o]);n&&r.push.apply(r,n)}return r}}t.getAllSmartFilters=c;t.removeSmartFilters=function(e){var t=c(e);if(t)for(var i=0,r=t;i<r.length;i++)d(e,r[i].id)};t.getEffectiveFilterParams=function(e,t){var i=e,r=c(t);r&&0<r.length&&r.forEach(function(e){i=o.default.updateFilterInfo(i,e.fieldName,e.values,e.type,e.lookupId)});return i};function u(e,t){var i=e.getDomParts();if(i&&i.where){var r=i.where.querySelectorAll('[id="'+t+'"]');if(1<r.length)throw new Error("More than one filter found with id "+t);return r[0]}}});define("Fa",["require","exports","ap","bn","bo","bp","bo"],function(e,t,i,s,r,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(o,t);t.parseView=function(e){var t="string"==typeof e?r.getViewDomParts(e):e;return{filters:c(t.where),sorts:n(t.orderBy),groupBy:a(t.groupBy),fieldNames:r.parseViewFields(t.viewFields),rowLimit:d(t.rowLimit)}};function n(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return p(e)}).filter(function(e){return!!e});return t.length?t:void 0}}t.parseSorts=n;function a(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return p(e)}).filter(function(e){return!!e});if(t.length){var i={isCollapsed:m(e,s.CamlAttributes.collapse,!0),group1:t[0]};t[1]&&(i.group2=t[1]);return i}}}t.parseGroupBy=a;function d(e){if(e&&e.textContent)return{rowLimit:Number(e.textContent),isPerPage:m(e,s.CamlAttributes.paged,!1)}}t.parseRowLimit=d;function c(e){if(e&&e.childElementCount){var t=u(e.firstElementChild);return t&&t.length?t:void 0}}t.parseFilters=c;function u(e){if(e){var t;switch(e.tagName){case s.CamlTags.and:t=function(e){if(!e||!e.childElementCount)return;var t=e.firstElementChild,i=u(t);if(!t.nextElementSibling)return i;var r=u(t.nextElementSibling);if(!i&&!r)return;return(i||[]).concat(r||[])}(e);break;case s.CamlTags.or:t=function(e){var t=function e(t){if(!t.childElementCount)return;var i=t&&t.tagName;var r;switch(i){case s.CamlTags.or:var o=t.firstElementChild,n=e(o);if(n&&o.nextElementSibling){var a=e(o.nextElementSibling);r=a?n.concat(a):void 0}else r=n;break;case s.CamlTags.eq:r=h(t);break;case s.CamlTags.isNull:r=f(t)}if(r)return Array.isArray(r)?r:[r];return}(e);if(t&&t.length&&!t.some(function(e){return!e})){var i=t.every(function(e){return e.fieldName===t[0].fieldName&&e.lookupId===t[0].lookupId});if(i){var r=!1,o=t.reduce(function(e,t){if(!r)if(e.type&&t.type&&e.type!==t.type){r=!0;e.type=void 0}else e.type=e.type||t.type;e.values.push(t.values[0]);return e});o.operator=s.CamlTags.eq;o.id=e&&l.getAttr(e,s.CamlAttributes.id);return o}}return null}(e);break;case s.CamlTags.isNull:case s.CamlTags.isNotNull:case s.CamlTags.membership:t=f(e);break;case s.CamlTags.beginsWith:case s.CamlTags.contains:case s.CamlTags.eq:case s.CamlTags.greaterEq:case s.CamlTags.greater:case s.CamlTags.includes:case s.CamlTags.lessEq:case s.CamlTags.less:case s.CamlTags.notEq:case s.CamlTags.notIncludes:t=h(e);break;case s.CamlTags.inTag:t=function(e){var o=g(e),t=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===s.CamlTags.values})[0];if(!o||!t)return;var n=!1,i=Array.prototype.map.call(t.childNodes,function(e){var t=y(e);if(t&&t.type&&!n){var i=t.type,r=o.type;n=!(!r||!i||r===i);o.type=r||i}return t&&t.value});if((i=i.filter(function(e){return!!e})).length){o.values=i;n&&(o.type=void 0)}return i.length?o:void 0}(e)}return t?Array.isArray(t)?t.length?t:void 0:[t]:void 0}}t.parseFilter=u;function p(e){if(e&&e.tagName===s.CamlTags.fieldRef){var t=l.getAttr(e,s.CamlAttributes.name);if(t)return{fieldName:t,isAscending:m(e,s.CamlAttributes.ascending,!0)}}}function m(e,t,i){switch((l.getAttr(e,t)||"").toLowerCase()){case"true":return!0;case"false":return!1;default:return i}}function h(e){var t=g(e),i=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===s.CamlTags.value})[0];if(t&&i){var r=y(i);if(r){t.type=r.type;t.values=[r.value];return t}}}function f(e){var t=g(e);if(t)if(e.tagName===s.CamlTags.isNull)t.values=[""];else if(e.tagName===s.CamlTags.membership){var i=l.getAttr(e,s.CamlAttributes.type);i?t.values=[i]:t=void 0}return t}function g(e){var t=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===s.CamlTags.fieldRef})[0],i=t&&l.getAttr(t,s.CamlAttributes.name),r=e&&l.getAttr(e,s.CamlAttributes.id);if(i)return{fieldName:i,id:r,type:void 0,lookupId:m(t,s.CamlAttributes.lookupId),operator:e.tagName,values:void 0}}function y(e){var t=e&&e.childElementCount&&e.firstElementChild.tagName!==s.CamlTags.today;if(e&&e.tagName===s.CamlTags.value&&!t){var i,r={value:e.textContent,type:l.getAttr(e,s.CamlAttributes.type)};if(e.childElementCount){var o=e.firstElementChild,n=l.getAttr(o,s.CamlAttributes.offset)||l.getAttr(o,s.CamlAttributes.offsetDays),a=parseInt(n,10)||0;r.value=l.getTodayString(a);r.type=r.type||"DateTime"}r.value&&"DateTime"===r.type&&!0!==m(e,s.CamlAttributes.includeTimeValue)&&(i=r.value.match(s.CamlConstants.datetimeNoTimeRegex))&&(r.value=i[1]);return r}}});define("Vq",["require","exports","ap","bO","rs","bX","ot","V","bA"],function(e,t,i,r,o,n,l,d,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(s){i.__extends(e,s);function e(e,t){var i=s.call(this,e,t)||this,r=e.column,o=e.engagementName,n=t.actionMap,a=i.scope.attached(t.commandViewModelType);i.command=new a({text:d.format(l.strings.columnMenuGroupBy,r.name),isToggleable:!0,engagementName:"GroupBy"+o,action:new(i.child(n.GroupItemsAction))({column:r})});return i}e.dependencies=i.__assign({},r.default.dependencies,{actionMap:n.actionMap,commandViewModelType:o.typeResourceKey});return e}(r.default);t.GroupColumnCommandHelper=s;t.typeResourceKey=new a.ResourceKey({name:""+e("module").id,factory:new a.ResolvedResourceTypeFactory(s)});t.default=s});define("Vp",["require","exports","ap","bN","rs","or","bX","iG","bA"],function(e,t,i,r,o,h,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(m){i.__extends(e,m);function e(e,t){var i=m.call(this,e,t)||this,r=e.column,o=e.engagementName,n=t.actionMap,a=t.rumOneHelper,s=[],l=h.getSortMenuStrings(r),d=l.ascendingString,c=l.descendingString,u=function(){a&&a.logFilterSort("Sort")},p=i.scope.attached(t.commandViewModelType);s.push(new p({text:d,isToggleable:!0,engagementName:"SortAscending"+o,reportClickingTime:u,action:new(i.child(n.SortAction))({column:r,ascending:!0})}));s.push(new p({text:c,isToggleable:!0,hasLineBreakAfter:!0,engagementName:"SortDescending"+o,reportClickingTime:u,action:new(i.child(n.SortAction))({column:r,ascending:!1})}));i.commands=s;return i}e.dependencies=i.__assign({},r.default.dependencies,{actionMap:n.actionMap,rumOneHelper:a.rumOneHelper.optional,commandViewModelType:o.typeResourceKey});return e}(r.default);t.SortColumnCommandHelper=l;t.typeResourceKey=new s.ResourceKey({name:""+e("module").id,factory:new s.ResolvedResourceTypeFactory(l)});t.default=l});define("VE",["require","exports","ap","aq","bN","dZ","iJ","zI","lc","bX","Pu","Po","eX","ba"],function(e,t,i,g,r,y,v,_,b,x,S,C,P,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){i.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.key="PostUpload";return e}e.prototype.projectItemSet=function(e,t,i){var o=this;if(e){var n=t.content.peek().items,a=t.content.peek().groupings,s=[],l=i.group;if(a&&a.length&&a[0].itemGroups&&a[0].itemGroups.length&&!l){var r=a[0].itemGroups[0];if("new"===r.groupingId)l=r;else{l={groupingType:r.groupingType,groupingId:"new",name:b.strings.newItemsGroupName,fieldSchema:r.fieldSchema,startIndex:0,count:0,state:g.observable({isCollapsed:!1}),level:0};a[0].itemGroups=[l].concat(a[0].itemGroups)}}var d=[],c=this.resources.consume(v.resourceKey);i.uploadedItems.forEach(function(e){if(!(4===e.peek().state.upload.status||3===e.peek().state.upload.status)){var t=c.getItem(e.peek().key);t&&t.peek().state.removing&&(e.peek().state.removing=!0);(e=c.setItem(e.peek())).peek().isPlaceholder?s.push(e):e().state.upload.status=2;if(l&&"new"!==l.groupingId){var i=n[l.startIndex];if(i&&i.peek())for(var r=l;r&&r.fieldSchema;){var o=r.fieldSchema.Name;e.peek().properties[o]=i.peek().properties[o];r=C.convertGroup(S.default.getParent(r,a[0].itemGroups))}}d.push(e)}});var u=this._calculateNewChildren(n,a,d,l);e.sortField=t.sortField;e.isAscending=t.isAscending;e.schema=t.schema;e.contentTypes=t.contentTypes;e.content({items:u,groupings:a});e.isPlaceholder=t.isPlaceholder;e.isExpired=t.isExpired;e.version=t.version;var p=this.resources.consume(P.resourceKey),m=this.resources.consume(y.url);if(0<s.length){var h=s.map(function(e){var t=e.peek();return t.properties.ID||t.properties.uniqueId}),f=m.getCurrentItemKey();p.getSpecifiedItems({parentKey:f,itemKeys:h,recurseInFolders:!1,needToClearParentSmartFiltersInfo:!0}).then(function(e){var r;e.children.forEach(function(e){for(var t=0;t<s.length;t++){var i=s[t];if(e.properties.ID===i.peek().properties.ID){e.state.upload.status=2;i(e);if(e.hasMissingMetadata){r||(r=[]);r.push(i)}break}}});if(r){var t=o.resources.consume(x.actionMap);new(o.managed(t.SelectAction))({item:r[0],showProperties:!0,selectItems:1<r.length&&k.isFeatureEnabled(k.SPListBulkEditItemProperties)?r:void 0}).execute(null)}})}}};e.prototype._calculateNewChildren=function(e,t,i,r){var o=[],n=null,a=t&&t.length&&t[0].itemGroups&&t[0].itemGroups.length,s={},l=a&&t[0].itemGroups;(!r||"new"===r.groupingId&&0===r.count)&&(o=i);if(r){var d=i.length;s[r.groupingId]=d;for(var c=S.default.getParent(r,l);c;){s[c.groupingId]=d;c=S.default.getParent(c,l)}if(r.children&&0<r.children.length){var u={groupingType:r.groupingType,groupingId:r.groupingId+"-new",name:b.strings.newItemsGroupName,fieldSchema:r.children[0].fieldSchema,startIndex:r.startIndex,count:d,state:g.observable({isCollapsed:!1}),level:r.level+1,parentKey:r.groupingId};r.children.unshift(u);r=u}}for(var p=0;p<e.length;p++){var m=e[p],h=_.default.getGroup(t,p);if(r&&h&&h!==n){h===r&&(o=o.concat(i));n=h}if(m&&m.peek().state.removing&&h){s[h.groupingId]||(s[h.groupingId]=0);s[h.groupingId]-=1;for(var f=S.default.getParent(h,l);f;){s[f.groupingId]||(s[f.groupingId]=0);s[f.groupingId]-=1;f=S.default.getParent(f,l)}m.peek().state.removing=!1}else o.push(m)}a&&(t[0].itemGroups=this._calculateNewGroups(l,s));return o};e.prototype._calculateNewGroups=function(e,t,i){for(var r=[],o=0,n=0;n<e.length;n++){var a=e[n];if(t&&t[a.groupingId]){var s=t[a.groupingId];a.count+=s;0<s&&a.state.peek().isCollapsed&&a.state({isCollapsed:!1})}if(0<a.count){if(0===o)a.startIndex=i?i.startIndex:0;else{var l=r[o-1];a.startIndex=l.startIndex+l.count}a.children&&(a.children=this._calculateNewGroups(a.children,t,a));r[o++]=a}}return r};return e}(r.default);t.default=o});define("zI",["require","exports","aq","zB","zJ"],function(e,t,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function d(){}d.getGroup=function(e,t){var i;if(e&&e.length&&e[0].itemGroups)for(var r=0,o=e[0].itemGroups;r<o.length;r++){var n=o[r];if(n){var a=n.startIndex+n.count-1;if(n.startIndex<=t&&t<=a){if(n.children)return d.getGroup([{name:"",itemGroups:n.children}],t);i=n;break}}}return i};d.getHeaderDetails=function(e,t,i,r,o){var n="",a=null,s=20,l="";if(e&&"SPListGroup"===e.groupingType){s=60;l="header-"+e.groupingId+"_"+e.count+"_itemcount_"+e.startIndex;n=u.default.tagName;a={group:e,cellsInGroup:t,resources:i,isGrid:o,requiredGroup:r,isSelected:c.observable(!1),isFocused:c.observable(!1),key:d.normalizeHeaderKey(l)}}return{viewType:n,viewData:a,headerHeight:s,key:l}};d.shouldFetchNextGroup=function(e,t,i,r){var o=e.peek().content.peek().groupings,n=e.peek().content.peek().items;if(o&&o.length&&o[0].itemGroups){var a=d._getLastGroup(o[0].itemGroups);if(t&&t.groupingId===a.groupingId){var s=i===r||i===t.count,l=n&&void 0===n[n.length-1];return s&&l}}return!1};d.getNextGroup=function(e,t){if(e&&e.length&&e[0].itemGroups){var i=d._getLastGroup(e[0].itemGroups);return{groupingId:"__next__",startIndex:i.startIndex+i.count,count:t}}return null};d.updateHeader=function(e,t){e.viewData.cellsInGroup=t;e.key=e.key.replace("itemcount",String(t))};d.normalizeHeaderKey=function(e){var t=e.indexOf("_");return e.substring(0,t-1)};d.getSeeMoreComponent=function(e,t,i,r,o,n,a){var s=p.SEEMORE_TAGNAME,l="seeMore-"+e.groupingId;return{key:l,item:null,cellIndex:i||-1,index:-1,viewType:s,viewData:{group:e,key:l,resources:t,needPadding:a},left:r||0,top:o||0,width:n||0,height:36}};d._getLastGroup=function(e){var t=e[e.length-1];t.isPlaceholder&&(t=e[e.length-2]);return t};return d}();t.default=i});define("zB",["require","exports","b5","zE","zD","zC","yB"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-listGroup-header",template:e("zD"),viewModel:r.default,synchronous:!0});t.default=o});define("zE",["require","exports","ap","aq","zF","bX","jG","ou","V","p2","ox"],function(e,t,i,a,s,l,d,c,u,p,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t._requiredGroup=e.requiredGroup;var i=t.group.name?t.group.name:s.strings.NoGroupName;t.headerText=u.format(s.strings.GroupHeaderText,i,t.group.count);t.loadingText=s.strings.LoadingText;t._cellsInGroup=e.cellsInGroup;t._itemSet=t.resources.consume(l.currentItemSet);t.isCollapsed=t.createComputed(function(){return!!t.group.state&&t.group.state().isCollapsed});t._itemsLoaded=t.createComputed(function(){return!!t._itemSet().content().items[t.group.startIndex]});t.showLoading=t.createComputed(function(){return!t._itemsLoaded()&&!t.isCollapsed()});var r=u.pluralSelect(t.group.count,u.format(s.strings.ItemsCountSingular,t.group.count),u.format(s.strings.ItemCountMulti,t.group.count));t.headerAriaLabel=u.format(s.strings.AriaGroupHeaderText,i,r,t.isCollapsed.peek()?s.strings.CollapsedText:s.strings.ExpandedText);t.isDroppingTarget=a.observable(!1);t.isDroppable=a.observable(t._canDropItems());t._dropHelper=t.resources.consume(c.resourceKey);var o=t.resources.consume(d.dataManager);t._parentItem=o.item;t.isDroppable.peek()&&t.addBindingHandlers({dragAndDrop:p.default});t.showCheckbox=!e.isGrid;t._itemSet=t.resources.consume(l.currentItemSet);return t}e.prototype.onToggleCollapse=function(e,t){e._toggleGroup();t.stopPropagation();t.preventDefault();return!1};e.prototype.onToggleSelect=function(e,t){e._toggleSelect();t.stopPropagation();t.preventDefault();return!1};e.prototype.enterGroup=function(e,t){return n.prototype.filterByGroupAndExpand.call(this,e,event)};e.prototype.onFocusChange=function(e){e&&this._toggleSelect()};e.prototype.onKeyLeftRight=function(e,t){return e.onToggleCollapse(e,t)};e.prototype.onReceiveDrop=function(e){this.group.state.peek().isCollapsed&&this._toggleGroup(!0);e.metadata={group:this.group};e.itemSet=this._itemSet.peek();return this._dropHelper.processDrop(e,this._parentItem.peek(),!0)};e.prototype.onMayReceiveDrop=function(e){var t=null;1!==e.type&&0!==e.type||(t={targetName:this.group.name});return t};e.prototype.onRemoveDropLocation=function(){this.isDroppingTarget(!1)};e.prototype._toggleGroup=function(e){var t=this.group;if(t.state){var i=!e&&!t.state.peek().isCollapsed;t.state({isCollapsed:i});i||this._itemsLoaded.peek()||this._requiredGroup(t)}};e.prototype._toggleSelect=function(){for(var e=this._itemSet.peek().content.peek().items,t=this.group.startIndex;t<this.group.startIndex+this._cellsInGroup;t++)e[t]&&this.selectionModel.setItemSelected(e[t],!0)};e.prototype._canDropItems=function(){var e="TRUE"===this.group.fieldSchema.ReadOnly,t=null!==this.group.fieldValue;return!e&&t};return e}(r.default);t.default=o});define("zD",[],function(){return"<div class=od-ListGroupHeader data-bind=\"css: { 'dropping': isDroppingTarget, 'is-collapsed': isCollapsed, 'showCheckbox': showCheckbox, 'is-focused': isFocused }, attr: { 'tabindex': tabindex, 'aria-label': headerAriaLabel }, delayedHasFocus: isFocused, click: onToggleSelect, keyboard: { mappings: { Left: onKeyLeftRight, Right: onKeyLeftRight, Enter: enterGroup }, context: $data }, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }\">\x3c!--ko if: showCheckbox--\x3e<ms-item-check class=\"od-ListGroupHeader-check can-select\" data-bind=\"css: { 'is-selected': isFocused }\"></ms-item-check>\x3c!--/ko--\x3e<i class=\"od-ListGroupExpandButton ms-Icon ms-Icon--ChevronDown\" data-bind=\"icon: true, click: onToggleCollapse, attr: { 'tabindex': -1 }\"></i><div class=od-ListGroupHeader-title href=# data-bind=\"text: headerText, click: enterGroup, attr: { 'tabindex': -1 }\"></div><span class=od-ListGroupHeader-loading data-bind=\"visible: showLoading, text: loadingText\"></span></div>"});define("zC",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-ListGroupHeader{height:32px;line-height:32px;margin-top:20px;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";position:relative;padding:4px 0}.od-ListGroupHeader:hover{background-color:"},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:"}.od-ListGroupHeader:hover .od-ListGroupHeader-check{opacity:1}.od-ListGroupHeader.is-focused{background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.od-ListGroupHeader.is-focused .od-ListGroupHeader-check{opacity:1}[dir=ltr] .od-ListGroupHeader.showCheckbox{padding-left:0}[dir=rtl] .od-ListGroupHeader.showCheckbox{padding-right:0}.od-ListGroupHeader.dropping{box-shadow:inset 0 0 0 3px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.od-ListGroupHeader-title{display:inline-block;cursor:pointer;outline:0}[dir=ltr] .od-ListGroupHeader-title{padding-left:14px}[dir=rtl] .od-ListGroupHeader-title{padding-right:14px}[dir=ltr] .od-ListGroupHeader-title{margin-left:-6px}[dir=rtl] .od-ListGroupHeader-title{margin-right:-6px}.od-ListGroupHeader-loading{padding:0 20px}.od-ListGroupExpandButton.ms-Icon{height:32px;line-height:32px;text-align:center;-ms-transform:rotate(-180deg);transform:rotate(-180deg);-ms-transform-origin:50% 50%;transform-origin:50% 50%;width:32px;vertical-align:top;padding:4px 0;margin-top:-4px;outline:0}.od-ListGroupExpandButton.ms-Icon:hover{background-color:"},{theme:"themeLightAlt",defaultValue:"#beddf4"},{rawString:'}.od-ListGroupHeader.is-collapsed .od-ListGroupExpandButton{-ms-transform:rotate(0);transform:rotate(0)}.od-ListGroupHeader-check{display:inline-block;vertical-align:top;padding:7px 14px 7px 8px;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;opacity:0}html[dir=rtl] .od-ListGroupHeader-check{padding:7px 8px 7px 14px}.od-ListGroupHeader-check:hover{opacity:1}'}])});define("zJ",["require","exports","b5","zM","zL","zK"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SEEMORE_TAGNAME="ms-listGroup-seeMore";var o=i.registerComponent({tagName:t.SEEMORE_TAGNAME,template:e("zL"),viewModel:r.default,synchronous:!0});t.default=o});define("zM",["require","exports","ap","zN","ox"],function(e,t,r,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.seeMoreText=o.strings.SeeMoreText;t.needPadding=e.needPadding;t.seeMoreAriaLabel=o.strings.SeeMoreText;return t}e.prototype.onSeeMore=function(e,t){return i.prototype.filterByGroupAndExpand.call(this,e,event)};return e}(i.default);t.default=n});define("zL",[],function(){return"<div class=od-ListGroupSeeMore data-bind=\"css: { 'needPadding': needPadding, 'is-focused': isFocused }, attr: { 'tabindex': tabindex, 'aria-label': seeMoreAriaLabel }, delayedHasFocus: isFocused, click: onSeeMore, keyboard: { mappings: { Enter: onSeeMore }, context: $data }\"><span data-bind=\"text: seeMoreText\"></span></div>"});define("zK",["c","az"],function(e,t){e.loadStyles([{rawString:".od-ListGroupSeeMore{font-size:14px;line-height:34px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-ListGroupSeeMore.needPadding{padding:0 80px}.od-ListGroupSeeMore.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.od-ListGroupSeeMore span{padding:4px 8px;cursor:pointer}"}])});define("VF",["require","exports","ap","eX","iJ","a2","dW","eN","bN"],function(e,t,r,o,n,a,g,y,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="PendingCopyOperations",l=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._itemProvider=t.resources.consume(o.resourceKey);t._moveCopyHelper=e.moveCopyHelper;t._itemsStore=t.resources.consume(n.resourceKey);t._progressTimestamps={};return t}e.prototype.getCacheData=function(){return this._itemsStore.getValue(s,a.default.local)};e.prototype.setCacheData=function(e){this._itemsStore.setValue(s,e,a.default.local)};e.prototype.saveJobState=function(e,t,i,r){var o=this.getCacheData(),n=e.id;if(n){o||(o={});var a={};a.itemKeys=t;a.taskId=n;a.targetItemKey=i;a.isMove=r;a.cancelRequestSent=!1;a.retryCount=0;a.jobInfo=e.jobInfo;a.states={};a.errors={};a.jobStates={};a.jobCompletedBytes={};var s=e.jobInfo.spData;if(s)for(var l=0;l<s.length;l++){a.jobStates[s[l].JobId]=y.ITaskStatuses.NotStarted;a.jobCompletedBytes[s[l].JobId]={exportCompletedBytes:0,exportExpectedBytes:0,importCompletedBytes:0,isExportDone:!1}}o[n]=a;this.setCacheData(o)}};e.prototype.updateJobState=function(e,t,i){var r=this.getCacheData();if(e){var o=r[e];if(o){if(y.ITaskStatuses[i.status]===y.ITaskStatuses.Unknown)this._updateUnknownJobState(e);else{if(i.timestamp){o.timestamp=i.timestamp;this._progressTimestamps[e]=i.timestamp}i.completedBytes&&(o.currentProgress=i.completedBytes);var n=o.isMove?t.payloads.peek().moveItems.item:t.payloads.peek().copyItems.item;o.states[n.key]=t.state.peek();i.error&&(o.errors[n.key]=i.error)}r[e]=o;this.setCacheData(r)}}};e.prototype.cancelJobs=function(e){var t=this.getCacheData();if(t&&e){var i=t[e];if(i)for(var r in i.jobStates)i.jobStates[r]=y.ITaskStatuses.Cancelled;this.setCacheData(t)}};e.prototype.purgeJobState=function(e){var t=this.getCacheData();if(t&&e){delete t[e];this.setCacheData(t)}};e.prototype.resumePendingProgress=function(){var f=this,e=this.getCacheData();if(e){var t=function(p){var m=e[p],h=!1;i._itemProvider.getItem({parentKey:m.targetItemKey}).then(function(e){var d=e.item,t=m.jobInfo,c=[];m.itemKeys&&m.itemKeys.forEach(function(e){var t=f._itemsStore.getItem(e);t&&c.push(t.peek())});if(0<c.length&&t&&d){var i={id:p,jobInfo:t,progress:null},r=c[0].parent,u={items:c,parentKey:r.key,targetId:d.peek().id,targetKey:d.peek().key,cid:null,group:r.isGroup?1:0,isMove:m.isMove,taskId:p};f._moveCopyHelper.pollForProgress(i,u,[],function(e,t){if(!h){for(var i=new g.default,r=m.errors,o=m.states,n=0;n<c.length;n++){var a=c[n],s=t.progress[n]?t.progress[n]:t.progress[0];if(y.ITaskStatuses[s.status]!==y.ITaskStatuses.Unknown){var l=f._moveCopyHelper.registerOperation(a,u,d.peek(),p,i);m.currentProgress&&l.progress.current(m.currentProgress);o&&o[a.key]&&l.state(o[a.key]);r&&r[a.key]&&f._moveCopyHelper.handleMoveCopyError(r[a.key],l);e.push(l)}else f._updateUnknownJobState(p)}h=!0}},f._progressTimestamps[p])}else f.purgeJobState(p)})},i=this;for(var r in e)t(r)}};e.prototype._updateUnknownJobState=function(e){var t=this.getCacheData();if(t&&e){var i=t[e];if(i){var r=i.retryCount;if(r<3){i.retryCount=r++;t[e]=i;this.setCacheData(t)}else this.purgeJobState(e)}}};return e}(i.default);t.default=l});define("VG",["require","exports","bA","gf","VH"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedResourceKey(e("module").id,o.default,{dataRequestor:r.resourceKey})});define("VH",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A=/^(?:data|blob|javascript):/i,n=/^(?:data|http|https):/i;var a={svg:!0,png1x:!0,png1_5x:!0,png2x:!0};function M(e){var t,i;if(e)for(var r in e)if(a.hasOwnProperty(r)){var o=(i=e[r])&&n.test(i)?i:void 0;if(o){t||(t={});t[r]=o}}return t}var i=function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.getFileHandlerData=function(){return this._dataRequestor.send({path:"/drive/apps?$expand=actions",apiName:"GetDriveApps"}).then(function(e){for(var t,i,r={custom:[],create:[],open:[],preview:[]},o={},n=0,a=e.value;n<a.length;n++){var s=a[n];if(s.fileHandler){var l=s.application,d=s.id,c=s.actions,u=s.fileHandler;if(c){var p=u.fileTypeDisplayName,m=u.fileTypeIconUrl,h=u.version;if(h)for(var f={id:d,appId:l.id,actionMenuDisplayName:u.actionMenuDisplayName,displayName:l.displayName,appIcon:M(u.appIcon),version:h,fileTypeDisplayName:p,fileTypeIcon:M(u.fileTypeIcon||{png1x:m})},g=0,y=c;g<y.length;g++){var v=y[g],_=v.url;if(_&&(i=_,!A.test(i))){var b=v.displayName,x=v.shortDisplayName,S=v.icon,C=v.availableOn;if(C){var P="newFile"===v.type?"create":v.type,k={type:P,url:_,displayName:b,icon:M(S),availableOn:(t=C,{file:t.file,folder:t.folder,allowMultiSelect:t.allowMultiSelect}),handler:f},I=C.file,T=I&&I.extensions;switch(P){case"custom":if(!b)continue;k.shortDisplayName=x;if(!I&&!C.folder)continue;break;case"create":if(!T||!T[0])continue;break;case"open":case"preview":if(!I)continue;if(T)for(var w=0,E=T;w<E.length;w++){var D=E[w];(o[D]||(o[D]={open:[],preview:[]}))[P].push(k)}break;default:continue}r[P].push(k)}}}}}}return{actions:r,preferences:o,version:4}})};return e}();t.default=i});define("VI",["require","exports","bA","gf","VJ"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedResourceKey(e("module").id,o.default,{dataRequestor:r.resourceKey})});define("VJ",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.getPreAuthUrls=function(e){var t={items:e.items};return this._dataRequestor.send({path:"/drive/getPreAuthorizedUrls",apiName:"GetPreAuthorizedUrls",postData:JSON.stringify(t),requestType:"POST"}).then(function(e){return e.value})};return e}();t.default=i});define("VK",["require","exports","ap","bN","eO","eV","iJ","dH","ex","iq","vP","aL","vS","bA","dJ","gN","fO","dk","eT","dq","aZ","ie","il","iE"],function(e,t,o,i,d,m,n,h,a,s,l,f,c,r,g,u,p,y,v,_,b,x,S,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P={"SPHome-ClientType":"ODSPDocLibsWeb"},k=function(r){o.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e)||this;i._urlDataSource=t.urlDataSource;i._itemsStore=t.itemStore;i._spHomeService=t.spHomeService;i._itemUrlHelper=t.itemUrlHelper;i._itemTaskObserver=new t.itemTaskObserverType;i._pageContext=t.pageContext;return i}e.prototype.getItem=function(c){var u=this,e=this._urlDataSource.getKeyParams(c.parentKey),t=this._urlDataSource.getQueryType(e),i=this._urlDataSource.getQueryParamValue(e),p=this._createRootItem(i,t),r="/user/activities?"+g.serializeQuery({fileTypes:"PPT,PPTX,XLS,XLSX,DOC,DOCX",filter:"Trending",count:40},null,!0);return this._spHomeService.getData({url:r,qosName:"GetTrendingDocs",method:"GET",additionalHeaders:P,useMicroService:!0}).then(function(e){for(var t=[],i=[],r=0,o=e.Activities;r<o.length;r++){var n=o[r];if(n){var a=n.ActivityItem,s=u._processActivityItem(a);t[t.length]=s;i.push(new v.Task(s.key).succeed({item:s}));u._itemTaskObserver.update(i)}}var l=new m.default(p.key);f.extend(l,p);l.folder={childCount:t.length};l.queryType=h.default.Discover;l.isPlaceholder=!1;var d={context:c,rootItem:p,children:t,updatedRootItem:l};return u._processItemsFromServer(d)})};e.prototype._processActivityItem=function(e){var t=this._getKey({path:e.OriginalUrl,uniqueId:e.UniqueId,entryId:e.ItemReference.IndexId,siteUrl:e.Site.Url}),i=new m.default(t);i.name=i.displayName=e.Title;var r=e.UniqueId&&b.default.normalizeLower(e.UniqueId),o=e.LastModifiedBy,n=o&&o.WorkEmail?"/_layouts/15/userphoto.aspx?size=S&accountname="+e.LastModifiedBy.WorkEmail:"";i.dateModified=e.LastModifiedTime;i.dateModifiedTime=new Date(e.LastModifiedTime);i.size=e.Size;i.properties={uniqueId:r,listId:e.Library.ListId,editorName:[{title:o&&o.Title,email:o&&o.WorkEmail,picture:n}],path:e.OriginalUrl};i.editorProfilePicUrl=n;i.editorName=o&&o.Title;i.openUrl=e.ServerRedirectedUrl;var a=i.extension=e.FileExtension;i.appMap=a&&y.OfficeIconFileTypeMap[a];if(a&&this._pageContext.isSPO&&x.fileTypeSupportsPreview("."+i.extension.toLowerCase())){var s=e&&e&&e.Site,l=s&&s.ItemReference;i.thumbnail=S.previewImageUrlFromProps("{"+l.SiteId+"}","{"+l.WebId+"}","{"+e.UniqueId+"}",this._pageContext.webAbsoluteUrl,this._pageContext)}i.iconName=_.getIconNameFromItem({extension:a,sharingType:0,type:d.default.File});i.queryType=h.default.Discover;i.isPlaceholder=!1;return i};e.prototype._processItemsFromServer=function(e){var t=e.context,i=e.rootItem,r=e.children,o=e.updatedRootItem;this._itemsStore.setItem(o);var n=t.needSchema&&this._getSchema(),a={item:i,totalChildren:r.length,children:r,nextRequestToken:void 0,schema:n};this._itemTaskObserver.flush();return a};e.prototype._createRootItem=function(e,t){void 0===t&&(t=h.default.Discover);var i,r=this._urlDataSource.getKey(((i={}).view=""+t,i.q=e,i)),o=s.strings.DiscoverRelevantItems,n=l.createSearchRoot({key:r,queryType:t,name:o,isPlaceholder:!0});this._itemsStore.setItem(n);return n};e.prototype._getKey=function(e){var t,i=e.path,r=e.uniqueId,o=e.entryId,n=e.siteUrl,a=this._itemUrlHelper.getUrlParts({path:i,webUrl:n,mayInferListUrl:!1}),s=["search"];void 0!==r&&s.push(r);void 0!==o&&s.push(""+o);return this._urlDataSource.getKey(((t={}).id=a.serverRelativeItemUrl,t.u=s.join("|"),t.listurl=a.normalizedListUrl,t))};e.prototype._getSchema=function(){return[this._createColumn("type","",{minWidth:16,width:16,fieldType:a.ColumnFieldType.FileIcon}),this._createColumn("name",s.strings.NameColumnName,{minWidth:220,width:440,fieldType:a.ColumnFieldType.Name}),this._createColumn("editorName",s.strings.ModifiedByColumnName,{fieldType:a.ColumnFieldType.Text}),this._createColumn("dateModified",s.strings.DateModifiedColumnName,{fieldType:a.ColumnFieldType.DateTime}),this._createColumn("location",s.strings.SearchLocationColumnName),this._createColumn("size",s.strings.SizeColumnName,{isHtml:!0,fieldType:a.ColumnFieldType.FileSize})]};e.prototype._createColumn=function(e,t,i){return o.__assign({key:e,name:t,minWidth:90,width:130,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:a.ColumnFieldType.Text,filterable:!1,groupable:!1,isFocused:this.createObservable(!1)},i||{})};e.dependencies={spHomeService:c.resourceKey,urlDataSource:u.resourceKey,itemStore:n.resourceKey,itemUrlHelper:p.resourceKey,itemTaskObserverType:v.resourceKey,pageContext:C.pageContext};return e}(i.default);t.default=k;t.resourceKey=r.createResolvedResourceKey(e("module").id,k)});define("vS",["require","exports","ap","bO","gl","aC","fZ","bi","iE","aN","bb","bA"],function(e,t,p,i,m,h,o,f,g,n,a,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){p.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._pageContext=t.pageContext;i._apiUrlHelper=t.apiUrlHelper;i._dataRequestor=new t.dataRequestorType({qosName:"SpHomeService"});return i}e.prototype.getData=function(e){var t=this,i=e.useMicroService,r=void 0===i||i,o=p.__rest(e,["useMicroService"]);return r?this._getDataRequestor().then(function(e){return e.getData(o).catch(function(e){if(a.default.isActivated("6A34964F-5191-4165-9B46-F3098DC699A6","12/21/2017","Workaround for incomplete SPHome service rollout in farms."))return h.default.reject(e);n.default.log(e);return t._getDataFromSharePoint(o)})},function(e){n.default.log(e);return t._getDataFromSharePoint(o)}):this._getDataFromSharePoint(o)};e.prototype._getDataFromSharePoint=function(e){var t=e.url,i=p.__rest(e,["url"]),r=""+(new f.default(this._pageContext.webAbsoluteUrl).authority+"/_vti_bin/homeapi.ashx")+new f.default(t).path;return this._dataRequestor.getData(p.__assign({},i,{url:r}))};e.prototype._getDataRequestor=function(){var c,u=this,t=this._getContext().then(function(e){var t=e.d,i=t.Token,r=i.resource,o=i.access_token,n=i.expires_on,s=t.Payload;if("string"!=typeof o)return h.default.wrapError(new Error("SPHome context service did not produce a token."));var a=u.scope.attach(new y.ResourceScope(u.resources));a.expose(g.pageContext,{webAbsoluteUrl:r,authToken:o});var l=new(a.consume(m.typeResourceKey))({qosName:"SpHomeService"}),d=new f.default(r).authority+"/api/v1";c={resources:a,expiresOn:1e3*parseInt(n,10)};return{getData:function(e){var t=e.url,i=e.additionalHeaders,r=void 0===i?{}:i,o=p.__rest(e,["url","additionalHeaders"]),n=""+d+new f.default(t).path,a=p.__assign({},r,{"SPHome-ApiContext":s});return l.getData(p.__assign({},o,{url:n,additionalHeaders:a}))}}});this._getDataRequestor=function(){var e=Date.now();if(c&&c.expiresOn-e<6e5){c.resources.dispose();delete u._getDataRequestor;return u._getDataRequestor()}return t};return t};e.prototype._getContext=function(){var e=this._apiUrlHelper.build().segments("sphomeservice","context").oDataParameter("$expand","Token,Payload");return this._dataRequestor.getData({url:e.toString(),method:"GET",qosName:"GetContext",maxRetries:3})};e.dependencies=p.__assign({},i.default.dependencies,{pageContext:g.pageContext,dataRequestorType:m.typeResourceKey,apiUrlHelper:o.resourceKey});return e}(i.default);t.default=r;t.resourceKey=y.createResolvedResourceKey(e("module").id,r)});define("VL",["require","exports","a3","a2","bA","iE"],function(e,t,n,u,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={create:"newFileUrl",open:"openUrl",preview:"previewUrl"},o=function(){function e(e,t){var i=t.dataStoreType,r=void 0===i?n.default:i,o=t.pageContext;this._dataStore=new r("Office365.AddIns.FileHandler."+o.userId,u.default.local);this._redirectUrlBase=o.webAbsoluteUrl+"/"+o.layoutsUrl+"/online/cloudappsredirect.aspx?addintype=FileHandler&usemds=false"}e.prototype.getLegacyFileHandlerUrl=function(e,t){var i,r=t.handler,o=r.appId,n=r.displayName,a=r.id,s=p[t.type],l=this._redirectUrlBase+"&appId="+r.appId+"&appUrl="+encodeURIComponent(t.url)+"&itemUrl="+e.id,d=[{type:"FileHandler",appId:o,addInId:a,displayName:n,properties:(i={extension:t.availableOn.file.extensions.join(";").replace(/\./g,"")},i[s]=t.url,i)}],c=this._dataStore;c.setValue("",d);c.setValue(".LocalStorageSetTime",Date.now(),u.default.local,!1);return l};return e}();t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o,{pageContext:r.pageContext})});define("VM",["require","exports","ap","dZ","iE","fO","aG","aC","bA","sq"],function(e,t,o,i,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){var i=t.pageContext;this._sharedPostData={cultureName:t.languageDataSource.getCurrentLanguageCode(),client:i&&Number(i.webTemplate)!==a.default.mySite?"SharePoint":"OneDrive",domainHint:"organizations",userId:t.identityDataSource.getIdentity().loginName};this._appUrlDataSource=t.appUrlDataSource;this._itemUrlHelper=t.itemUrlHelper;this._preAuthDataSource=t.preAuthDataSource}e.prototype.getInvocationParams=function(e){var t=this,i=e.action,r=i.handler.appId;return 1===i.handler.version?s.default.wrap({url:this._appUrlDataSource.getLegacyFileHandlerUrl(e.items[0],i),postdata:o.__assign({},this._sharedPostData,{appId:r})}):this._preAuthDataSource.getPreAuthUrls({appId:r,items:e.items.map(function(e){return t._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl})}).then(function(e){return{url:i.url,postdata:o.__assign({},t._sharedPostData,{appId:r,items:JSON.stringify(e)})}})};e.prototype.invokeAction=function(t){return this.getInvocationParams(t).then(function(e){return d.navigateViaPost(o.__assign({},e,{document:t.document}))})};return e}();t.FileHandlerHelper=c;t.default=c;t.resourceKey=l.createResolvedResourceKey(e("module").id,c,{appUrlDataSource:i.appUrl,preAuthDataSource:i.preAuth,identityDataSource:i.identity,itemUrlHelper:n.resourceKey,languageDataSource:i.language,pageContext:r.pageContext.optional})});define("VN",["require","exports","bP","aC","bA","bi","gf","dZ","iE","fO","eA"],function(e,t,h,s,i,u,r,o,n,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._itemUrlHelper=t.itemUrlHelper;this._itemParentHelper=t.itemParentHelper;this._pageContext=t.pageContext;this._urlCache=new Map;this._vroomDataRequestor=t.vroomDataRequestor}e.prototype.getDownloadUrl=function(i,e){void 0===e&&(e={});var r=this._urlCache,t=r.get(i.key)||{},o=t.url,n=t.time;if(o&&n<Date.now()-27e5)return s.default.wrap(o);var a=this.getItemUrl(i,e);return this._vroomDataRequestor.send({apiName:"itemDownloadUrl",path:a+"?select=id,@content.downloadUrl",accessToken:this.getAccessToken(i)}).then(function(e){var t=e["@content.downloadUrl"].replace(/[?&]ApiVersion=[^&]+/,"");r.set(i.key,{url:t,time:Date.now()});return t})};e.prototype.getAuthenticationParams=function(e,t){var i=this.getAccessToken(e,t);if(i){var r=i.accessToken,o=i.proofToken,n={};r&&(n.access_token=r);o&&(n.prooftoken=o);return s.default.resolve(n)}return s.default.resolve({})};e.prototype.getDriveUrl=function(e,t){void 0===t&&(t={});var i=t.useDirectEndpoint,r=void 0===i?!this._pageContext.isSPO:i,o=t.apiVersion,n=void 0===o?"v2.0":o,a=this._getGraphBaseUrl(e,r,n),s=e.graph;if(s)return a+"/drives/"+encodeURIComponent(s.driveId);var l=this._getDriveUrl(e,a);if(!l)throw new Error("Unable to determine graph identity for item");return l};e.prototype.getItemUrl=function(e,t){void 0===t&&(t={});var i=t.useDirectEndpoint,r=void 0===i?!this._pageContext.isSPO:i,o=t.isPath,n=void 0!==o&&o,a=t.apiVersion,s=void 0===a?"v2.0":a,l=this._getGraphBaseUrl(e,r,s),d=e.graph;if(d&&d.driveId&&"root"!==d.itemId)return l+"/drives/"+encodeURIComponent(d.driveId)+"/items/"+encodeURIComponent(d.itemId)+(n?":":"");var c=this._getDriveUrl(e,l);if(c){var u=h.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")).list.listUrlDir,p=this._itemUrlHelper.getItemUrlParts(e.key),m=(u?this._itemUrlHelper.getUrlParts({path:p.serverRelativeItemUrl,listUrl:u}):p).listRelativeItemUrl;return c+"/root"+(m?":/"+encodeURI(m)+(n?"":":"):n?":":"")}};e.prototype.getAccessToken=function(e,t){void 0===t&&(t={});if(!this._pageContext.isSPO)return{};var i=t.apiVersion,r=h.peekUnwrap(this._itemParentHelper.getAncestorOrSelf(e,function(e){var t=e.graph;return!!t&&!!t.sessionToken}));return"v2.1"===i?r&&r.graph.sessionTokenV21:r&&r.graph.sessionToken};e.prototype._getGraphBaseUrl=function(e,t,i){var r=h.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));if(t){if(r){var o=this._itemUrlHelper.getItemUrlParts(r.key).fullItemUrl;return new u.default(o).authority+"/_api/"+i}return this._urlDataSource.getApiBaseUrl(i)}return"https://graph.microsoft.com/v1.0"};e.prototype._getDriveUrl=function(e,t){var i=h.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));if(i){var r=i.graph,o=r&&r.driveId;if(o)return t+"/drives/"+encodeURIComponent(o);var n=h.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(i,"subsite")),a=void 0,s=void 0,l=void 0;if(n&&n.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl){var d=n.subsite;a=d.siteCollectionId;s=d.id;l=d.serverRelativeUrl}else{var c=this._pageContext;a=c.siteId;s=c.webId;l=c.webAbsoluteUrl}return(t+"/sites/"+new u.default(l).domain+","+a+","+s+"/lists/"+i.list.id+"/drive").replace(/[{}]/g,"")}};e.dependencies={urlDataSource:o.url,itemUrlHelper:a.resourceKey,itemParentHelper:l.resourceKey,pageContext:n.pageContext,vroomDataRequestor:r.resourceKey};return e}();t.default=d;t.resourceKey=i.createResolvedResourceKey(e("module").id,d)});define("VO",["require","exports","xs"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=i.Tooltip});define("VP",["require","exports","VR","b3","VQ"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-share-ko",name:e("module").id,template:e("VQ"),viewModelType:i.default});t.default=t.resourceKey});define("VR",["require","exports","ap","bX","cR","DM","iY","DI","yk","oq","Bj","bF","Bf"],function(e,t,i,r,d,o,n,a,s,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(l){i.__extends(e,l);function e(e,t){var i=l.call(this,e,t)||this,r=e.copyLinkShortcut,o=e.item,n=e.onDismiss,a=e.hideShareDialogOverflowButton,s=t.actionMap;i._itemBeingShared=o;i._onDismiss=n;i._dependencies=t;i._copyLinkShortcut=r;i._hideShareDialogOverflowButton=a;i.addBindingHandlers({react:c.default,focusTrap:d.default});i._showPermissionsAction=new(i.child(s.ShowPermissionsAction))({item:i._itemBeingShared});i.shareComponent=u.default;i.shareComponentProps=i.createPureComputed(i._computeShareProps);return i}e.prototype._computeShareProps=function(){var e=this._itemBeingShared(),t=this._dependencies;return{actionMap:t.actionMap,copyLinkShortcut:this._copyLinkShortcut,hideShareDialogOverflowButton:this._hideShareDialogOverflowButton||!this._showPermissionsAction.isAvailable(),item:e,onDismiss:this._onDismiss,onManageAccessClicked:this._onManageAccessClicked.bind(this),peoplePickerProvider:t.peoplePickerProvider,graphPeoplePickerHelper:t.graphPeoplePickerHelper,resources:t.resources,sharingProvider:t.sharingProvider,suiteNavProvider:t.suiteNavProvider,policyTipProvider:t.policyTipProvider}};e.prototype._onManageAccessClicked=function(){this._showPermissionsAction.isAvailable.peek()&&this._showPermissionsAction.execute(null);this._onDismiss()};e.dependencies=i.__assign({},p.default.dependencies,{peoplePickerProvider:o.resourceKey,graphPeoplePickerHelper:n.resourceKey,sharingProvider:a.resourceKey,suiteNavProvider:s.resourceKey,actionMap:r.actionMap,policyTipProvider:m.resourceKey});return e}(p.default);t.default=l});define("Bj",["require","exports","ap","j8","jP","By","bf","Bs","Br","Bq","at","Bo","ba","dp","bz","Bn","Bm","sX","Bl","Bk"],function(e,c,t,i,r,o,n,u,a,s,l,p,m,h,f,g,d,y,v,_){"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.SHARE_STRINGS={accessViaSharingLink:s.strings.accessViaSharingLink,activityMessageCreatingLink:s.strings.activityMessageCreatingLink,activityMessageSendingMail:s.strings.activityMessageSendingMail,adminExpirationError:s.strings.adminExpirationError,allowEdit:s.strings.allowEdit,allowEditLabel:s.strings.allowEditLabel,and:s.strings.and,anonEditDescription:s.strings.anonEditDescription,anonEditDescriptionWithExpiry:s.strings.anonEditDescriptionWithExpiry,anonViewDescription:s.strings.anonViewDescription,anonViewDescriptionWithExpiry:s.strings.anonViewDescriptionWithExpiry,attachACopy:s.strings.attachACopy,attachACopyInstead:s.strings.attachACopyInstead,canEditLabel:s.strings.canEditLabel,canViewLabel:s.strings.canViewLabel,changeToViewOnly:s.strings.changeToViewOnly,closeButtonLabel:s.strings.closeButtonLabel,companyNameFallback:s.strings.companyNameFallback,componentLoading:s.strings.componentLoading,copyLinkLabel:s.strings.copyLinkLabel,cslEditDescription:s.strings.cslEditDescription,cslViewDescription:s.strings.cslViewDescription,days:[s.strings.sunday,s.strings.monday,s.strings.tuesday,s.strings.wednesday,s.strings.thursday,s.strings.friday,s.strings.saturday],disabledAudienceChoiceLabel:s.strings.disabledAudienceChoiceLabel2,document:s.strings.document,excelWorkbook:s.strings.excelWorkbook,existingPeopleDescription:s.strings.existingPeopleDescription,expiresIn:s.strings.expiresIn,folderHeader:s.strings.folderHeader,getSharingInformationError:s.strings.getSharingInformationError,goToToday:s.strings.goToToday,groupsMemberCountLabel:s.strings.groupsMemberCountLabel,groupsMemberCountLargeLabel:s.strings.groupsMemberCountLargeLabel,learnMoreLabel:s.strings.learnMoreLabel,loadingLabel:s.strings.loadingLabel,manageExistingAccessLabel:s.strings.manageExistingAccessLabel,maxExpirationError:s.strings.maxExpirationError,messagePlaceholder:s.strings.messagePlaceholder,modifyPermissionsHeader:s.strings.modifyPermissionsHeader,months:[s.strings.january,s.strings.february,s.strings.march,s.strings.april,s.strings.may,s.strings.june,s.strings.july,s.strings.august,s.strings.september,s.strings.october,s.strings.november,s.strings.december],moreOptionsLabel:s.strings.moreOptionsLabel,multipleGroupsInvited:s.strings.multipleGroupsInvited,noExternalSharing:s.strings.noExternalSharing,noResultsLabel:s.strings.noResultsLabel,notificationCopied:s.strings.notificationCopied,notificationCopyFailed:s.strings.notificationCopyFailed,notificationCopyFailedCta:s.strings.notificationCopyFailedCta,notificationSent:s.strings.notificationSent,notShared:s.strings.notShared,oneGroupInvited:s.strings.oneGroupInvited,otherSettings:s.strings.otherSettings,otherWaysToShareLabel:s.strings.otherWaysToShareLabel,outlookLabel:s.strings.outlookLabel,outsideOfYourOrgPlural:s.strings.outsideOfYourOrgPlural,outsideOfYourOrgSingular:s.strings.outsideOfYourOrgSingular,ownerLabel:s.strings.ownerLabel,pastDateExpirationError:s.strings.pastDateExpirationError,pdf:s.strings.pdf,peoplePickerPlaceholder:s.strings.peoplePickerPlaceholder,peoplePickerPlaceholderWithSelection:s.strings.peoplePickerPlaceholderWithSelection,permissionsAnyoneString:s.strings.permissionsAnyoneString,permissionsCompanyString:s.strings.permissionsCompanyString,permissionsExistingPeopleString:s.strings.permissionsExistingPeopleString,permissionsLabel:s.strings.permissionsLabel,permissionsSettingsHeader:s.strings.permissionsSettingsHeader,permissionsSpecificPeopleString:s.strings.permissionsSpecificPeopleString,powerPointPresentation:s.strings.powerPointPresentation,recipientsRequiredError:s.strings.recipientsRequiredError,removeExpirationLabel:s.strings.removeExpirationLabel,sendButtonLabel:s.strings.sendButtonLabel,setExpirationDate:s.strings.setExpirationDate,shareLinkHeader:s.strings.shareLinkHeader,sharingLinkLabel:s.strings.sharingLinkLabel,shortDays:[s.strings.shortSunday,s.strings.shortMonday,s.strings.shortTuesday,s.strings.shortWednesday,s.strings.shortThursday,s.strings.shortFriday,s.strings.shortSaturday],shortMonths:[s.strings.shortJanuary,s.strings.shortFebruary,s.strings.shortMarch,s.strings.shortApril,s.strings.shortMay,s.strings.shortJune,s.strings.shortJuly,s.strings.shortAugust,s.strings.shortSeptember,s.strings.shortOctober,s.strings.shortNovember,s.strings.shortDecember],specificPeopleHint:s.strings.specificPeopleHint,specificPeopleOneEditHint:s.strings.specificPeopleOneEditHint,specificPeopleOneViewHint:s.strings.specificPeopleOneViewHint,specificPeopleThreeEditHint:s.strings.specificPeopleThreeEditHint,specificPeopleThreePlusEditHint:s.strings.specificPeopleThreePlusEditHint,specificPeopleThreePlusViewHint:s.strings.specificPeopleThreePlusViewHint,specificPeopleThreeViewHint:s.strings.specificPeopleThreeViewHint,specificPeopleTwoEditHint:s.strings.specificPeopleTwoEditHint,specificPeopleTwoViewHint:s.strings.specificPeopleTwoViewHint,stopSharing:s.strings.stopSharing,unresolvedTextError:s.strings.unresolvedTextError,wordDocument:s.strings.wordDocument,peoplePickerErrorCsl:s.strings.peoplePickerErrorCsl,peoplePickerErrorExternal:s.strings.peoplePickerErrorExternal,ptHeader:a.strings.TipIssues,ptLastScanned:a.strings.TipLastScanned,ptLearnMoreActionLabel:a.strings.LearnMoreActionLabel,ptLearnMoreLabel:a.strings.LearnMoreLabel,ptNoPolicyTipInfo:a.strings.NoPolicyTipInfoError,ptOverrideActionLabel:a.strings.OverrideActionLabel,ptOverrideLabel:a.strings.OverrideLabel,ptReportActionLabel:a.strings.ReportActionLabel,ptReportLabel:a.strings.ReportLabel,ptReportInProgress:a.strings.ReportInProgress,ptSubmitLabel:a.strings.SubmitButtonText,policyDetailsHeader:s.strings.policyDetailsHeader,ptOverrideConfirmation:s.strings.ptOverrideConfirmation,ptReportConfirmation:a.strings.ReportConfirmation,ptErrorMessage:a.strings.PolicyTipNotifyAndBlock,applyingLinkSettings:s.strings.applyingLinkSettings,insufficientPermissionsError:s.strings.insufficientPermissionsError,insufficientPermissionsErrorPlural:s.strings.insufficientPermissionsErrorPlural,ptViewPolicyTipLabel:a.strings.ViewPolicyTip,applyButtonText:d.strings.ApplyFilterButtonLabel,cancelButtonText:y.strings.stopSharingCancelButton,noExactMatch:v.strings.NoMatchesFound,moreAppsLabel:s.strings.moreAppsLabel,nonOutlookLabel:s.strings.nonOutlookLabel,removeLinkText:s.strings.removeLinkText,backButtonLabel:s.strings.backButtonLabel,pageLabelLinkSettings:s.strings.pageLabelLinkSettings,pageLabelLinkCreated:s.strings.pageLabelLinkCreated,pageLabelManageAccess:s.strings.pageLabelManageAccess,pageLabelPolicyTipDetails:s.strings.pageLabelPolicyTipDetails,pageLabelSendLink:s.strings.pageLabelSendLink,visioDrawing:s.strings.visioDrawing,removePersonLabel:s.strings.removePersonLabel,suggestionsAvailableAlertText:s.strings.suggestionsAvailableAlertText,pslWarning:s.strings.pslWarning,specificPeopleHint2:s.strings.specificPeopleHint2,copyButtonLabel:s.strings.copyButtonLabel,specificPeopleEditHint:s.strings.specificPeopleEditHint,specificPeopleViewHint:s.strings.specificPeopleViewHint,permissionsListLinksLabel:s.strings.permissionsListLinksLabel,permissionsListPrincipalsLabel:s.strings.permissionsListPrincipalsLabel,linkMembersListLabel:s.strings.linkMembersListLabel,pslHint:_.strings.peopleSharingLinkLabel,sharingOperationNotSupportedError:s.strings.sharingOperationNotSupportedError,prevMonthAriaLabel:s.strings.prevMonthAriaLabel,nextMonthAriaLabel:s.strings.nextMonthAriaLabel,userPhotoAriaLabel:s.strings.userPhotoAriaLabel,selectedItemListLabel:s.strings.selectedItemListLabel,mixedRecipientErrorMessage:s.strings.mixedRecipientErrorMessage,grantAccessActivityIndicatorString:s.strings.grantAccessActivityIndicatorString,atMentionHappyMessage:s.strings.atMentionHappyMessage,shareAndNotifyButtonLabel:s.strings.shareAndNotifyButtonLabel,atMentionSadMessageOwner:s.strings.atMentionSadMessageOwner,atMentionSadMessageRecipient:s.strings.atMentionSadMessageRecipient,okayButtonLabel:s.strings.okayButtonLabel,grantAccessPageLabel:s.strings.grantAccessPageLabel,grantAccessRecipientsListLabel:s.strings.grantAccessRecipientsListLabel,peoplePickerLimitMessage:s.strings.peoplePickerLimitMessage,invalidEmailErrorMessage:s.strings.invalidEmailErrorMessage,accessRequestTooltip:s.strings.accessRequestTooltip,accessRequestNotificationHeader:s.strings.accessRequestNotificationHeader,accessRequestNotificationBody:s.strings.accessRequestNotificationBody,searchForMoreText:m.isFeatureEnabled(m.PeoplePickerGraph)?s.strings.searchForMoreText:void 0};var b=function(d){t.__extends(e,d);function e(e){var t=d.call(this,e)||this;t._copyLinkShortcut=e.copyLinkShortcut;t._onDismiss=e.onDismiss;t._peoplePickerProvider=e.peoplePickerProvider;t._hideShareDialogOverflowButton=e.hideShareDialogOverflowButton;t._mode=e.mode||(t._copyLinkShortcut?u.Mode.copy:u.Mode.share);t._messageText=e.messageText;t._sharingStore=new p.default({item:e.item,strings:c.SHARE_STRINGS,sharingInformation:e.sharingInformation,defaultRecipients:e.defaultRecipients,accessChecked:e.accessChecked,mode:t._mode},{sharingProvider:e.sharingProvider,suiteNavProvider:e.suiteNavProvider,peoplePickerProvider:e.peoplePickerProvider,policyTipProvider:e.policyTipProvider,graphPeoplePickerHelper:e.graphPeoplePickerHelper});t._platformDetection=new f.default;t._breakpoint=g.default.DEFAULT_BREAKPOINTS[g.default.determineWindowSize(window.innerWidth)];var i=t.props.maxHeight;t._maxHeight=i<550?i:550;var r=0,o=" ",n=window._sharingContextInfo;if(e.item&&e.item.properties){var a=e.item.properties,s=a.ItemChildCount?parseInt(a.ItemChildCount,10):0,l=a.FolderChildCount?parseInt(a.FolderChildCount,10):0;r=t.props.item.type===h.default.OneNote?0:s+l;o=e.item.name}else if(n){o=n.itemName||" ";r=n.itemCount||0}t._sharingItemInformation={name:o,childCount:r,hasDlpPolicy:void 0};return t}e.prototype.getChildContext=function(){return{peoplePickerProvider:this._peoplePickerProvider,resize:this._resize.bind(this),onDismiss:this._onDismiss||this._dismiss,sharingStore:this._sharingStore,strings:c.SHARE_STRINGS,usesSharingAbilities:m.isFeatureEnabled(m.SharingAbilities),platformDetection:this._platformDetection,breakpoint:this._breakpoint}};e.prototype.render=function(){return l.createElement("div",{className:"od-share-v3",ref:"share"},l.createElement(o.Share,{copyLinkShortcut:this._copyLinkShortcut,clientId:this.props.clientId||this.props.sharingProvider.getClientId(),showExistingAccessOption:this.props.sharingProvider.supportsExistingAccessOption(this.props.item),onManageAccessClicked:this.props.onManageAccessClicked,hideShareDialogOverflowButton:this._hideShareDialogOverflowButton,enableShimmer:!n.Killswitch.isActivated("c06652c0-2c26-4b10-b9b1-dce25a2e3a9f","2/09/2018","Enable share ux shimmer"),createPeopleSharingLinks:m.isFeatureEnabled(m.SharingSupportsEmailAuthGuest)&&m.isFeatureEnabled(m.PeopleSharingLinks),maxHeight:this._maxHeight,mode:this._mode,messageText:this._messageText,sharingItemInformation:this._sharingItemInformation}))};e.prototype.componentWillUnmount=function(){this._sharingStore.dispose()};e.prototype._resize=function(){var t=this.refs.share;if(t){var e=this._maxHeight,i=t.clientHeight>e?e:t.clientHeight;try{window.external.Resize(t.clientWidth,i)}catch(e){var r={name:"share_resize",width:t.clientWidth,height:i};window.top.postMessage(JSON.stringify(r),"*")}}};e.prototype._dismiss=function(){try{window.external.Dismiss()}catch(e){var t={name:"share_dismiss"};window.top.postMessage(JSON.stringify(t),"*")}};e.childContextTypes={peoplePickerProvider:i.object.isRequired,resize:i.func.isRequired,onDismiss:i.func,sharingStore:i.object.isRequired,strings:i.object.isRequired,usesSharingAbilities:i.bool.isRequired,platformDetection:i.object.isRequired,breakpoint:i.object.isRequired};t.__decorate([r.autobind],e.prototype,"_resize",null);t.__decorate([r.autobind],e.prototype,"_dismiss",null);return e}(l.Component);c.default=b});define("By",["require","exports","ap","Bz"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Bz",["require","exports","ap","jP","DH","DF","Bs","C3","CV","Ce","B3","BN","o1","BM","BL","at","j8","BK","BJ","pz","BH","wN","BF","ej","BE","BB","bT","BA"],function(e,t,_,i,b,x,S,o,n,a,s,l,C,P,k,I,d,c,T,w,u,p,E,m,h,D,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.default=0]="default";e[e.shareShimmer=1]="shareShimmer";e[e.modifyPermissions=2]="modifyPermissions";e[e.linkSuccess=3]="linkSuccess";e[e.permissionsList=4]="permissionsList";e[e.grantPermissions=5]="grantPermissions";e[e.policyDetails=6]="policyDetails";e[e.error=7]="error";e[e.linkSettings=8]="linkSettings"}(t.ShareViewState||(t.ShareViewState={}));var r=function(r){_.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._viewStates=[];i._dismiss=t.onDismiss;i._resize=t.resize;i._store=t.sharingStore;i._strings=t.strings;i.state={companyName:null,currentSettings:null,sharingInformation:null,sharingLinkCreated:null,viewState:0,readyToCopy:!1,shareType:S.ShareType.share,groupsMemberCount:0,policyTipInformation:null,linkRecipients:[],shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:{},messageText:e.messageText||"",isLoadingDefaultRecipients:i._store.isValidatingDefaultRecipients()};i._engagementExtraData={clientId:e.clientId,scenarioId:e.scenarioId,mode:e.mode||(e.copyLinkShortcut?S.Mode.copy:S.Mode.share)};return i}e.prototype.componentDidMount=function(){var y=this;k.opened(this._engagementExtraData);var v=this._store;new f.default(this).on(window,"keyup",function(e){e&&27===e.keyCode&&y._handleEscKeyPress(e)});v.addListener(function(){var e=v.getSharingInformation(),t=v.getSharingLinkCreated(),i=v.getCompanyName(),r=v.getGroupsMemberCount(),o=v.getPolicyTipInformation(),n=v.getPermissionsMap(),a=v.getDefaultRecipients();y._outlookAvailability=v.getOutlookAvailability();if(e){var s=y.state.currentSettings;if(!s&&e&&!e.error){var l=e.defaultSharingLink;if(e.sharingLinks&&e.sharingLinks.length&&y.props.shareId)for(var d=0,c=e.sharingLinks;d<c.length;d++){var u=c[d];if(u.shareId===y.props.shareId){l=u;break}}s=y._initializeCurrentSettings(l,e,y.props.copyLinkShortcut)}if(t&&(y.state.shareTargetClicked||y.props.copyLinkShortcut||y.state.applyLinkSettingsClicked)){y._modifiedSharingLinkUrl=y._trackClickThru(t,s,e);var p=y.state.shareType,m=y.state.currentSettings,h=m?m.isEdit:s.isEdit,f=_.__assign({},y._engagementExtraData,{shareType:p,audience:t.audience,isEdit:h,recipientsCount:y.state.recipientsCount,externalRecipientsCount:y.state.externalRecipientsCount,hasMessage:y.state.hasMessage,daysUntilExpiry:y._getNumberOfDaysUntilExpiry(t),isDefaultLink:e.defaultSharingLink.sharingLinkKind===t.sharingLinkKind});k.shareCompleted(f);D.shareCompleted(y.state.shareType);if(p===S.ShareType.outlook||p===S.ShareType.nonOutlook)if(T.showOWAShareTarget(y.props.clientId)){y._store.navigateToOwa(y._getRecipientEmails(y.state.linkRecipients),y._modifiedSharingLinkUrl);D.outlookClicked();y._dismiss()}else try{window.external.SendViaOutlookWithContext(y._getRecipientEmails(y.state.linkRecipients),y.state.linkRecipients.length,y.state.messageText,y._modifiedSharingLinkUrl)}catch(e){}else if(p===S.ShareType.teams){y._dismiss();D.teamsClicked(t)}else if(p===S.ShareType.moreApps)try{y.setState({viewState:3,sharingLinkCreated:t,showActivityIndicator:!1});window.external.SendLinkViaMoreApps(t.url)}catch(e){}else y.props.mode===S.Mode.linkSettings?D.linkSettingsCompleted(t,y._strings,i):y.setState({viewState:3,sharingLinkCreated:t,showActivityIndicator:!1})}else{if(y.props.copyLinkShortcut&&e&&!e.error&&!y._copyLinkShortcutInvoked){y._copyLinkShortcutInvoked=!0;y._onCopyLinkClicked(!0,s)}var g=_.__assign({},y.state,{sharingInformation:e,companyName:i,groupsMemberCount:r,currentSettings:s,policyTipInformation:o,isLoadingDefaultRecipients:v.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:n});if(a&&!a.isConsumed){g.linkRecipients=a.recipients;y._store.consumeDefaultRecipients()}y.setState(g)}}});v.fetchSuiteNavInformation();v.fetchSharingInformation(this.props.copyLinkShortcut||this.props.mode===S.Mode.linkSettings);v.fetchPolicyTipInformation()};e.prototype.componentDidUpdate=function(e,t){this._resize()};e.prototype.render=function(){var e,t=this._strings,i=this.props,r=i.copyLinkShortcut,o=i.clientId,n=i.showExistingAccessOption,a=i.createPeopleSharingLinks,s=i.mode,l=this.state,d=l.sharingInformation,c=l.currentSettings,u=l.showActivityIndicator,p=l.companyName,m=l.sharingLinkCreated,h=l.viewState,f=l.groupsMemberCount,g=l.linkRecipients,y={maxHeight:this.props.maxHeight};if(d&&d.error){D.pageError(d);e=I.createElement("div",{className:"od-Share"},I.createElement(x.Header,{viewState:7}),I.createElement("div",{className:"od-Share-error"},d.errorMessage))}else if(d&&c&&!r&&s===S.Mode.share){var v=u?" od-Share--hasActivity":"";e=I.createElement("div",{className:"od-Share"+v,style:y},this._renderViews(),this._renderBackButton(),this._renderActivityIndicator())}else if(d&&c&&r&&m)e=I.createElement("div",{className:"od-Share",style:y},I.createElement(b.CopyLink,{clientId:o,scenarioId:this.props.scenarioId,companyName:p,currentSettings:c,item:d.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClicked:this._getNotificationHintClickHandler(m.createdViaCopyLinkCommand),sharingInformation:d,showExistingAccessOption:n,viewState:h,groupsMemberCount:f,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:a,displayUrl:this._modifiedSharingLinkUrl}));else if(d&&c&&s===S.Mode.atMention)e=I.createElement("div",null,I.createElement(E.AtMention,{clientId:o,scenarioId:this.props.scenarioId,currentSettings:c,sharingInformation:d,recipients:g}));else if(c&&s===S.Mode.linkSettings){v=u?" od-Share--hasActivity":"";e=I.createElement("div",{className:"od-Share"+v,style:y},this._renderModifyPermissions(8),this._renderActivityIndicator())}else if(c&&s===S.Mode.manageAccess)e=I.createElement("div",{className:"od-Share",style:y},this._renderPermissionsList());else if(s===S.Mode.share&&this.props.enableShimmer){e=I.createElement("div",{className:"od-Share od-Share--hasShimmer",style:y},this._renderShareMainShimmer());this._viewStates.push(1)}else e=I.createElement("div",{className:"od-Share"},I.createElement("div",{className:"od-Share-spinnerHolder"},I.createElement(C.Spinner,{className:"od-Share-spinner",label:t.componentLoading,size:C.SpinnerSize.large})));return I.createElement(w.Fabric,null,I.createElement(P.FocusTrapZone,{isClickableOutsideFocusTrap:!0},I.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},this._getCurrentPageLabel()),e))};e.prototype._getRecipientEmails=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var o=r[i].email;o&&t.push(o)}return t};e.prototype._getNumberOfDaysUntilExpiry=function(e){var t=e.expiration&&new Date(e.expiration),i=new Date;if(t){var r=(t.getTime()-i.getTime())/864e5;return Math.floor(r)}};e.prototype._copyLinkOnCancelClicked=function(){var e=this;this.setState({viewState:3},function(){k.linkSettingsCancelClicked(e._engagementExtraData)})};e.prototype._copyLinkOnApplyClicked=function(e){var t=this;this.setState({currentSettings:e,linkRecipients:e.specificPeople},function(){k.linkSettingsApplyClicked(t._engagementExtraData);t._onCopyLinkClicked(!0)})};e.prototype._handleEscKeyPress=function(e){var t=this.state.viewState,i=2===t,r=4===t,o=this.props.mode===S.Mode.share;o&&i?this._onLinkPermissionsCancelClicked():o&&r?this._onBackButtonClicked():this._dismiss();e.stopPropagation()};e.prototype._initializeCurrentSettings=function(e,t,i){if(t.requiresAccessApproval&&i)return{allowEditing:!0,audience:S.SharingAudience.existing,expiration:null,isEdit:!0,sharingLinkKind:1,specificPeople:[]};if(this.context.usesSharingAbilities&&t.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(e,t,i);if(e.audience===S.SharingAudience.specificPeople){var r=this.props.mode===S.Mode.linkSettings&&this.props.clientId===S.ClientId.outlookWeb;if(!t.canManagePermissions||t.blockPeoplePickerAndSharing||r)e.audience=S.SharingAudience.existing;else if(this.props.createPeopleSharingLinks)return{allowEditing:!0,audience:S.SharingAudience.specificPeopleFlex,expiration:null,isEdit:!0,sharingLinkKind:6,specificPeople:[]}}if(e.audience===S.SharingAudience.specificPeopleFlex&&i){e.audience=S.SharingAudience.existing;e.sharingLinkKind=1}var o=e.sharingLinkKind;return{allowEditing:5===o||3===o||1===o||6===o,audience:e.audience,expiration:e.expiration||null,isEdit:e.isEdit&&2===t.defaultShareLinkPermission,sharingLinkKind:e.sharingLinkKind,specificPeople:[]}};e.prototype._initializeCurrentSettingsWithSharingAbilities=function(e,t,i){var r=t.sharingAbilities,o=t.defaultSharingLink.sharingLinkKind,n=S.SharingAudience.specificPeople;switch(o){case 5:case 4:n=S.SharingAudience.anyone;break;case 3:case 2:n=S.SharingAudience.organization;break;case 1:default:!t.canManagePermissions||t.blockPeoplePickerAndSharing?n=S.SharingAudience.existing:this.props.createPeopleSharingLinks&&(n=r.peopleSharingLinkAbilities.canManageEditLink.enabled||r.peopleSharingLinkAbilities.canManageReadLink.enabled?S.SharingAudience.specificPeopleFlex:S.SharingAudience.existing)}if(n===S.SharingAudience.specificPeopleFlex&&i){n=S.SharingAudience.existing;o=1}var a=null,s=h.getSharingAbilitiesByAudience(n,r).linkExpiration;0<(s?s.defaultExpirationInDays:null)&&(a=new Date((new Date).toDateString())).setDate(a.getDate()+s.defaultExpirationInDays);var l=h.isEditingAllowed(n,r);return{allowEditing:l,audience:n,expiration:a,isEdit:l&&2===t.defaultShareLinkPermission,sharingLinkKind:o,specificPeople:[]}};e.prototype._onShareTargetClicked=function(e){if(e===S.ShareType.copy){D.copyLinkShareTargetClicked();this._onCopyLinkClicked()}else e===S.ShareType.outlook?this._onOutlookClicked():e===S.ShareType.nonOutlook?this._onNonOutlookClicked():e===S.ShareType.teams?this._onTeamsClicked():e===S.ShareType.moreApps&&this._onMoreAppsClicked()};e.prototype._onCopyLinkClicked=function(e,t){var i=this,r=_.__assign({},t,this.state.currentSettings);this.setState({shareType:S.ShareType.copy,shareTargetClicked:!0},function(){i._store.shareLink(r,i.state.linkRecipients,void 0,e)})};e.prototype._onOutlookClicked=function(){var e=this;this.setState({shareType:S.ShareType.outlook,shareTargetClicked:!0},function(){e._store.shareLink(e.state.currentSettings,e.state.linkRecipients,void 0,!1)})};e.prototype._onNonOutlookClicked=function(){var e=this;this.setState({shareType:S.ShareType.nonOutlook,shareTargetClicked:!0},function(){e._store.shareLink(e.state.currentSettings,e.state.linkRecipients,void 0,!1)})};e.prototype._onTeamsClicked=function(){var e=this;this.setState({shareType:S.ShareType.teams,shareTargetClicked:!0},function(){e._store.shareLink(e.state.currentSettings,e.state.linkRecipients,void 0,!1)})};e.prototype._onMoreAppsClicked=function(){var e=this;this.setState({shareType:S.ShareType.moreApps,shareTargetClicked:!0},function(){e._store.shareLink(e.state.currentSettings,e.state.linkRecipients,void 0,!1)})};e.prototype._onLinkPermissionsApplyClicked=function(e){var t=this;k.linkSettingsApplyClicked(this._engagementExtraData);this._onSelectedPermissionsChange(e);this.props.mode===S.Mode.linkSettings&&this.setState({shareType:S.ShareType.share,applyLinkSettingsClicked:!0},function(){t._store.shareLink(e,t.state.linkRecipients,void 0,!1)})};e.prototype._onLinkPermissionsCancelClicked=function(){var e=this;this.props.mode===S.Mode.linkSettings&&D.dismiss();this.setState({viewState:0},function(){k.linkSettingsCancelClicked(e._engagementExtraData)})};e.prototype._onBackButtonClicked=function(){this.setState({viewState:this._viewStates.pop()})};e.prototype._onLinkPermissionsReady=function(){this.props.mode===S.Mode.linkSettings&&D.pageFinishedLoading(this.props.clientId,this.props.scenarioId)};e.prototype._onSelectedPermissionsChange=function(e){var t=this.state.permissionsMap;e.audience===S.SharingAudience.existing?this._store.checkPermissions(this.state.linkRecipients):t={};this.setState({viewState:0,currentSettings:{allowEditing:e.allowEditing,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,sharingRole:e.sharingRole,sharingLinkKind:e.sharingLinkKind,specificPeople:e.specificPeople},permissionsMap:t})};e.prototype._onSelectedPeopleChange=function(e){var t=this,i=this.state.permissionsMap;this.state.currentSettings.audience===S.SharingAudience.existing&&this._store.checkPermissions(e);this.setState({linkRecipients:e,permissionsMap:i},function(){t._store.fetchGroupsMemberCount(e)})};e.prototype._onSendLinkClicked=function(e){var t=this,i=this.state.linkRecipients;this.setState({shareType:S.ShareType.share,recipientsCount:i.length,externalRecipientsCount:c.getExternalPeopleCount(i),hasMessage:!!e,shareTargetClicked:!0},function(){D.sendLinkClicked();t._store.shareLink(t.state.currentSettings,i,e)})};e.prototype._onViewPolicyTipClicked=function(){this.setState({viewState:6})};e.prototype._onSendLinkMessageChange=function(e){this.setState({messageText:e})};e.prototype._onShareTargetsRendered=function(e){var t=_.__assign({},this._engagementExtraData,{shareTargets:e});k.shareTargets(t)};e.prototype._renderBackButton=function(){var e=this.state.viewState;if(4===e||6===e)return I.createElement(p.IconButton,{className:"od-Share-backButton",onClick:this._onBackButtonClicked,iconProps:{iconName:"Back"},ariaLabel:this._strings.backButtonLabel})};e.prototype._renderViews=function(){switch(this.state.viewState){case 2:return this._renderModifyPermissions(2);case 8:return this._renderModifyPermissions(8);case 3:return this._renderNotification();case 4:return this._renderPermissionsList();case 6:return this._renderPolicyDetails();default:return this._renderShareMain(this.state.sharingInformation,this.state.currentSettings)}};e.prototype._renderShareMain=function(e,t){this._viewStates.push(0);return I.createElement(a.ShareMain,{clientId:this.props.clientId,scenarioId:this.props.scenarioId,companyName:this.state.companyName,currentSettings:t,item:e.item,onPolicyClick:this._showPolicy,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClicked:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:e,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,onSendLinkMessageChange:this._onSendLinkMessageChange,onShareTargetClicked:this._onShareTargetClicked,onShareTargetsRendered:this._onShareTargetsRendered,enableShimmer:this.props.enableShimmer,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this.props.createPeopleSharingLinks,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients})};e.prototype._renderPolicyDetails=function(){return I.createElement(l.SharePolicyDetails,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation})};e.prototype._renderModifyPermissions=function(e){this._viewStates.push(e);return I.createElement(o.ModifyPermissions,{clientId:this.props.clientId,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onReady:this._onLinkPermissionsReady,onSelectedPermissionsChange:this._onLinkPermissionsApplyClicked,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this.props.createPeopleSharingLinks,copyLinkShortcut:!1})};e.prototype._renderNotification=function(){var e=this.state,t=e.sharingInformation,i=e.sharingLinkCreated,r={companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,onShareHintClick:this._getNotificationHintClickHandler(i.createdViaCopyLinkCommand),linkRecipients:e.shareType===S.ShareType.share?this.state.linkRecipients:null};return I.createElement(s.ShareNotification,{shareType:e.shareType,itemName:t.item.name,linkUrl:this._modifiedSharingLinkUrl,clientId:this.props.clientId,sharingHintProps:r,shouldCopyLinkToClipboard:!0})};e.prototype._getNotificationHintClickHandler=function(e){return e?this._showModifyPermissions.bind(this,e):null};e.prototype._renderShareMainShimmer=function(){var e={allowEditing:!1,audience:S.SharingAudience.existing,expiration:void 0,isEdit:!1,sharingLinkKind:0,specificPeople:[]},t={anonymousLinkExpirationRestrictionDays:0,blockPeoplePickerAndSharing:!0,canAddExternalPrincipal:!1,canManagePermissions:!1,defaultSharingLink:void 0,isShared:!1,item:this.props.sharingItemInformation?this.props.sharingItemInformation:{name:"",childCount:0,hasDlpPolicy:!1},sharingLinks:[],sharingPrincipals:[],peoplePickerSettings:{},userDisplayName:"",defaultShareLinkPermission:1,defaultLinkKind:0,userRole:0,hasPermissionsInformation:!1,sharingAbilities:null,directLink:null};return this._renderShareMain(t,e)};e.prototype._renderPermissionsList=function(){this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0);return I.createElement(n.PermissionsList,{clientId:this.props.clientId,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation})};e.prototype._showModifyPermissions=function(e){var t=this;this.setState({viewState:2},function(){k.linkSettingsOpened(t._engagementExtraData)})};e.prototype._showPermissionsList=function(){k.manageAccessOpened(this._engagementExtraData);var e=this.props.onManageAccessClicked;e?e():this.setState({viewState:4})};e.prototype._showPolicy=function(){this.setState({viewState:6})};e.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return I.createElement(u.ActivityIndicator,{message:this._strings.applyingLinkSettings})};e.prototype._getCurrentPageLabel=function(){var e,t=this._strings,i=((e={})[2]=t.pageLabelLinkSettings,e[3]=t.pageLabelLinkCreated,e[4]=t.pageLabelManageAccess,e[6]=t.pageLabelPolicyTipDetails,e[0]=t.pageLabelSendLink,e)[this.state.viewState]||"";this.props.mode===S.Mode.atMention&&(i=t.grantAccessPageLabel);this.state.showActivityIndicator&&(i=t.applyingLinkSettings+i);return i};e.prototype._trackClickThru=function(e,t,i){var r=this.state.shareType,o=e.url;if(r!==S.ShareType.copy&&r!==S.ShareType.outlook)return o;var n=this._getBase62Id();this._logClickThru(n,e,t,i);var a=new m.default(o);a.setQueryParameter("e",n);return a.toString()};e.prototype._logClickThru=function(e,t,i,r){var o=this.state,n=_.__assign({},this._engagementExtraData,{shareType:o.shareType,audience:t.audience,isEdit:i.isEdit,recipientsCount:this.state.recipientsCount,externalRecipientsCount:this.state.externalRecipientsCount,hasMessage:this.state.hasMessage,daysUntilExpiry:this._getNumberOfDaysUntilExpiry(t),isDefaultLink:r.defaultSharingLink.sharingLinkKind===t.sharingLinkKind,clickThruId:e,clickThruScenario:S.ShareType[o.shareType]});k.trackClickThru(n)};e.prototype._getBase62Id=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],i=0;i<e.length;i++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[i]%62]);return t.join("")};e.contextTypes={resize:d.func.isRequired,onDismiss:d.func.isRequired,sharingStore:d.object.isRequired,strings:d.object.isRequired,usesSharingAbilities:d.bool.isRequired,platformDetection:d.object.isRequired,breakpoint:d.object.isRequired};_.__decorate([i.autobind],e.prototype,"_copyLinkOnCancelClicked",null);_.__decorate([i.autobind],e.prototype,"_copyLinkOnApplyClicked",null);_.__decorate([i.autobind],e.prototype,"_onShareTargetClicked",null);_.__decorate([i.autobind],e.prototype,"_onCopyLinkClicked",null);_.__decorate([i.autobind],e.prototype,"_onOutlookClicked",null);_.__decorate([i.autobind],e.prototype,"_onNonOutlookClicked",null);_.__decorate([i.autobind],e.prototype,"_onTeamsClicked",null);_.__decorate([i.autobind],e.prototype,"_onMoreAppsClicked",null);_.__decorate([i.autobind],e.prototype,"_onLinkPermissionsApplyClicked",null);_.__decorate([i.autobind],e.prototype,"_onLinkPermissionsCancelClicked",null);_.__decorate([i.autobind],e.prototype,"_onBackButtonClicked",null);_.__decorate([i.autobind],e.prototype,"_onLinkPermissionsReady",null);_.__decorate([i.autobind],e.prototype,"_onSelectedPermissionsChange",null);_.__decorate([i.autobind],e.prototype,"_onSelectedPeopleChange",null);_.__decorate([i.autobind],e.prototype,"_onSendLinkClicked",null);_.__decorate([i.autobind],e.prototype,"_onViewPolicyTipClicked",null);_.__decorate([i.autobind],e.prototype,"_onSendLinkMessageChange",null);_.__decorate([i.autobind],e.prototype,"_onShareTargetsRendered",null);_.__decorate([i.autobind],e.prototype,"_renderViews",null);_.__decorate([i.autobind],e.prototype,"_renderShareMain",null);_.__decorate([i.autobind],e.prototype,"_renderModifyPermissions",null);_.__decorate([i.autobind],e.prototype,"_renderNotification",null);_.__decorate([i.autobind],e.prototype,"_renderShareMainShimmer",null);_.__decorate([i.autobind],e.prototype,"_renderPermissionsList",null);_.__decorate([i.autobind],e.prototype,"_showModifyPermissions",null);_.__decorate([i.autobind],e.prototype,"_showPermissionsList",null);_.__decorate([i.autobind],e.prototype,"_showPolicy",null);_.__decorate([i.autobind],e.prototype,"_trackClickThru",null);_.__decorate([i.autobind],e.prototype,"_logClickThru",null);return e}(I.Component);t.Share=r});define("DH",["require","exports","ap","Bs","jP","C3","B3","o1","at","j8","BB"],function(e,t,i,o,n,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._strings=t.strings;i.state={shouldCopyLinkToClipboard:!0};return i}e.prototype.componentDidMount=function(){u.pageFinishedLoading(this.props.clientId,this.props.scenarioId)};e.prototype.render=function(){var e=this.props,t=e.sharingInformation;switch(this.props.viewState){case 3:var i={companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,onShareHintClick:e.onShareHintClicked,linkRecipients:null};return d.createElement(s.ShareNotification,{shareType:o.ShareType.copy,itemName:t.item.name,linkUrl:e.displayUrl,clientId:e.clientId,sharingHintProps:i,shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard});case 2:return d.createElement(a.ModifyPermissions,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,sharingInformation:e.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,createPeopleSharingLinks:e.createPeopleSharingLinks,copyLinkShortcut:!0});default:return d.createElement("div",{className:"od-Share-spinnerHolder"},d.createElement(l.Spinner,{className:"od-Share-spinner",label:this._strings.componentLoading,type:l.SpinnerType.large}))}};e.prototype._onLinkSettingsCancelClick=function(){var e=this;this.setState({shouldCopyLinkToClipboard:!1},function(){e.props.onLinkPermissionsCancelClicked()})};e.prototype._onLinkSettingsApplyClicked=function(e){var t=this;this.setState({shouldCopyLinkToClipboard:!0},function(){t.props.onLinkPermissionsApplyClicked(e)})};e.contextTypes={strings:c.object.isRequired};i.__decorate([n.autobind],e.prototype,"_onLinkSettingsCancelClick",null);i.__decorate([n.autobind],e.prototype,"_onLinkSettingsApplyClicked",null);return e}(d.Component);t.CopyLink=r});define("Bs",["require","exports","Bx","hf","Bw","Bv","hb","Bu","Bt"],function(e,t,i,r,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AccessStatus=i.default;t.Error=r.Error;t.Category=r.Category;t.UpdatePermissionsRole=r.UpdatePermissionsRole;t.SharePermission=r.SharePermission;t.SharingAudience=r.SharingAudience;t.SharingLinkKind=r.SharingLinkKind;t.SharingRole=r.SharingRoleV3;t.Mode=r.Mode;t.ClientId=r.ClientId;t.FileShareType=o.default;t.OutlookAvailability=n.default;t.PrincipalType=a.default;t.ShareType=s.default;t.SharingCapabilityDisabledReason=l.default});define("Bx",["require","exports","hf"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=i.AccessStatus});define("Bw",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.anyone=0]="anyone";e[e.workGroup=1]="workGroup";e[e.specificPeople=2]="specificPeople";e[e.onlyYou=3]="onlyYou";e[e.existing=4]="existing"}(i||(i={}));t.default=i});define("Bv",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.none=1]="none";e[e.available=2]="available";e[e.other=3]="other"}(i||(i={}));t.default=i});define("Bu",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.share=0]="share";e[e.copy=1]="copy";e[e.outlook=2]="outlook";e[e.nonOutlook=3]="nonOutlook";e[e.moreApps=4]="moreApps";e[e.teams=5]="teams"}(i||(i={}));t.default=i});define("Bt",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.unavailable=-1]="unavailable";e[e.none=0]="none";e[e.disabled=1]="disabled";e[e.notShareableByLink=2]="notShareableByLink";e[e.parentListIsPrivate=3]="parentListIsPrivate";e[e.parentListIsCatalogDocLib=4]="parentListIsCatalogDocLib";e[e.notSupportedByWopi=5]="notSupportedByWopi";e[e.irmIsEnabled=6]="irmIsEnabled";e[e.documentIsProtectedByDlp=7]="documentIsProtectedByDlp";e[e.forceCheckoutEditLink=8]="forceCheckoutEditLink";e[e.anonymousEditLinkNotAllowedByTenant=9]="anonymousEditLinkNotAllowedByTenant";e[e.nonClaimsWebapp=10]="nonClaimsWebapp";e[e.accessDeniedToAnonGuest=11]="accessDeniedToAnonGuest";e[e.blockedByWhoCanShareSettings=12]="blockedByWhoCanShareSettings";e[e.blockedByExternalShareSettings=13]="blockedByExternalShareSettings";e[e.accessDeniedNotEnoughPermissions=14]="accessDeniedNotEnoughPermissions"}(i||(i={}));t.default=i});define("C3",["require","exports","ap","Bs","BH","DF","C5","wN","BK","at","j8","BE","C4"],function(e,t,s,l,i,o,n,a,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m;!function(e){e[e.NONE=0]="NONE";e[e.PAST_DATE=1]="PAST_DATE";e[e.ADMIN_POLICY=2]="ADMIN_POLICY";e[e.OVER_MAX=3]="OVER_MAX"}(m=t.ExpirationErrorCode||(t.ExpirationErrorCode={}));var r=function(r){s.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._strings=t.strings;i._useSharingAbilities=t.usesSharingAbilities;i.state=i._initializeState();i._initializeState=i._initializeState.bind(i);i._onApplyClicked=i._onApplyClicked.bind(i);i._onCancel=i._onCancel.bind(i);i._onPeoplePickerChange=i._onPeoplePickerChange.bind(i);i._updateExpirationErrorCode=i._updateExpirationErrorCode.bind(i);i.onAudienceChange=i.onAudienceChange.bind(i);i.onEditChange=i.onEditChange.bind(i);i.onRoleChange=i.onRoleChange.bind(i);i.onExpirationChange=i.onExpirationChange.bind(i);return i}e.prototype.componentDidMount=function(){this.props.onReady&&this.props.onReady()};e.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"";return c.createElement("div",{className:"od-ModifyPermissions"+e},c.createElement(o.Header,{clientId:this.props.clientId,item:this.props.sharingInformation.item,viewState:2}),c.createElement("div",{className:"od-ModifyPermissions-section"},c.createElement(n.PermissionsSettings,{companyName:this.props.companyName,clientId:this.props.clientId,currentSettings:this.props.currentSettings,onAudienceChange:this.onAudienceChange,onEditChange:this.onEditChange,onRoleChange:this.onRoleChange,onExpirationChange:this.onExpirationChange,onPeoplePickerChange:this._onPeoplePickerChange,peoplePickerError:this.state.peoplePickerError,selectedPermissions:this.state.selectedPermissions,sharingInformation:this.props.sharingInformation,showExistingAccessOption:this.props.showExistingAccessOption,updateExpirationErrorCode:this._updateExpirationErrorCode,groupsMemberCount:this.props.groupsMemberCount,createPeopleSharingLinks:this.props.createPeopleSharingLinks,copyLinkShortcut:this.props.copyLinkShortcut})),c.createElement("div",{className:"od-ModifyPermissions-actions"},c.createElement(a.PrimaryButton,{className:"od-ModifyPermissions-apply",disabled:this._computeIsApplyButtonDisabled(),onClick:this._onApplyClicked},this._strings.applyButtonText),c.createElement(a.DefaultButton,{onClick:this._onCancel},this._strings.cancelButtonText)),this._renderActivityIndicator())};e.prototype.onAudienceChange=function(e){var t=this.state.selectedPermissions.isEdit,i=this._isAllowEditingEnabled(e),r=i&&t,o=this._getLinkKind(e,r),n={allowEditing:i,audience:e,expiration:this._getDefaultExpirationDateValue(),isEdit:r,sharingLinkKind:o,specificPeople:[]};this.setState(s.__assign({},this.state,{peoplePickerError:null,selectedPermissions:n}))};e.prototype.onEditChange=function(e){var t=this.state.selectedPermissions,i=this._getLinkKind(t.audience,e),r=this._getDefaultExpirationDateValue();this.setState(s.__assign({},this.state,{selectedPermissions:s.__assign({},t,{isEdit:e,expiration:r,sharingLinkKind:i})}))};e.prototype.onRoleChange=function(e){var t=this.state.selectedPermissions,i=this._getLinkKind(t.audience,2===e),r=this._getDefaultExpirationDateValue();this.setState(s.__assign({},this.state,{selectedPermissions:s.__assign({},t,{sharingRole:e,isEdit:2===e,expiration:r,sharingLinkKind:i})}))};e.prototype.onExpirationChange=function(e){e||(e=this._getDefaultExpirationDateValue());this.setState(s.__assign({},this.state,{selectedPermissions:s.__assign({},this.state.selectedPermissions,{expiration:e})}))};e.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return c.createElement(i.ActivityIndicator,{message:this._strings.activityMessageCreatingLink})};e.prototype._getDefaultExpirationDateValue=function(){var e=this.props.sharingInformation.anonymousLinkExpirationRestrictionDays;if(-1===e)return null;var t=new Date;t.setDate(t.getDate()+e);return t};e.prototype._initializeState=function(){var e=this.props,t=e.currentSettings,i=e.sharingInformation,r=d.renderPickerError({selectedItems:t.specificPeople,sharingLinkKind:1,canAddExternalPrincipal:i.canAddExternalPrincipal,sharingInformation:i,viewPolicyTipCallback:e.onViewPolicyTipClicked,strings:this._strings});return{expirationErrorCode:m.NONE,peoplePickerError:r,selectedPermissions:{allowEditing:this._isAllowEditingEnabled(t.audience),audience:t.audience,isEdit:t.isEdit,sharingRole:t.sharingRole,expiration:t.expiration||this._getDefaultExpirationDateValue(),sharingLinkKind:t.sharingLinkKind,specificPeople:t.specificPeople},showActivityIndicator:!1}};e.prototype._computeIsApplyButtonDisabled=function(){return this.state.expirationErrorCode!==m.NONE||!!this.state.peoplePickerError};e.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(s.__assign({},this.state,{expirationErrorCode:e}))};e.prototype._onCancel=function(){this.props.onCancel()};e.prototype._onApplyClicked=function(){var e=this,t=this.state,i=t.selectedPermissions,r=document.querySelector(".od-Share-PeoplePicker .ms-BasePicker-input");if(r&&r.value)this.setState(s.__assign({},this.state,{peoplePickerError:c.createElement("span",null,this._strings.unresolvedTextError)}));else if(i.audience===l.SharingAudience.specificPeopleFlex&&0===i.specificPeople.length&&this.props.copyLinkShortcut)this.setState(s.__assign({},this.state,{peoplePickerError:c.createElement("span",null,this._strings.recipientsRequiredError)}));else{var o=this.props.doesCreate,n=i.audience!==l.SharingAudience.anyone?null:i.expiration;this.setState(s.__assign({},t,{selectedPermissions:s.__assign({},i,{expiration:n}),showActivityIndicator:o}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})}};e.prototype._onPeoplePickerChange=function(e){var t=d.renderPickerError({selectedItems:e,sharingLinkKind:1,canAddExternalPrincipal:this.props.sharingInformation.canAddExternalPrincipal,sharingInformation:this.props.sharingInformation,viewPolicyTipCallback:this.props.onViewPolicyTipClicked,strings:this._strings});if(!this.props.createPeopleSharingLinks&&this.state.selectedPermissions.audience===l.SharingAudience.specificPeople){for(var i=!1,r=!1,o=0,n=e;o<n.length;o++){var a=n[o];i||(i=a.isExternal&&!a.providerName);r||(r=!a.isExternal||a.isExternal&&!!a.providerName)}i&&r&&(t=c.createElement("span",null,this._strings.mixedRecipientErrorMessage))}this.setState(s.__assign({},this.state,{peoplePickerError:t,selectedPermissions:s.__assign({},this.state.selectedPermissions,{specificPeople:e})}))};e.prototype._getLinkKind=function(e,t){return e===l.SharingAudience.anyone?t?5:4:e===l.SharingAudience.organization?t?3:2:e===l.SharingAudience.specificPeople||e===l.SharingAudience.existing?1:6};e.prototype._computeIsEditLink=function(e){return 5===e||3===e||1===e};e.prototype._isAllowEditingEnabled=function(e){var t=this.props.sharingInformation.sharingAbilities;if(this._useSharingAbilities&&t)return p.isEditingAllowed(e,t);if(e===l.SharingAudience.specificPeopleFlex)return!0;for(var i=this.props.sharingInformation.sharingLinks,r=e===l.SharingAudience.existing?l.SharingAudience.specificPeople:e,o=!1,n=0,a=i.filter(function(e){return r===e.audience});n<a.length;n++){var s=a[n];this._computeIsEditLink(s.sharingLinkKind)&&(o=!0)}return o};e.contextTypes={strings:u.object.isRequired,usesSharingAbilities:u.bool.isRequired};return e}(c.Component);t.ModifyPermissions=r});define("BH",["require","exports","ap","at","o1","BI"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement("div",{className:"od-ActivityIndicator","aria-live":"assertive"},r.createElement("div",null,r.createElement(o.Spinner,{type:o.SpinnerType.large})),r.createElement("span",{role:"alert"},this.props.message))};return t}(r.Component);t.ActivityIndicator=n});define("BI",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:28px}.od-ActivityIndicator span{font-size:14px;font-weight:400}"}])});define("DF",["require","exports","ap","jP","mo","wt","at","j8","V","BJ","BC","Cm","Cl","Bn","DG"],function(e,t,i,o,n,a,s,l,d,c,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i.state={showContextualMenu:!1,target:null};i._strings=t.strings;i._onDismiss=t.onDismiss;i._platformDetection=t.platformDetection;i._breakpoint=t.breakpoint;i._onDismissMoreContextualMenu=i._onDismissMoreContextualMenu.bind(i);i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i);i._onSendLinkClick=i._onSendLinkClick.bind(i);i._onMoreClick=i._onMoreClick.bind(i);return i}e.prototype.render=function(){var e=this.props,t=3===e.viewState||7===e.viewState,i=c.isMobile(this.props.clientId)||this._platformDetection.isMobile,r=i&&this._breakpoint>=h.default.DEFAULT_BREAKPOINTS.Large,o=t?"":" od-ShareHeader-backgroundColor",n=t?"":s.createElement("div",{className:"od-ShareHeader"+o},s.createElement("div",{className:"od-ShareHeader-title"},s.createElement("div",{className:"od-ShareHeader-viewName"},this._getViewName()),this._renderItemName())),a=i?s.createElement("div",{className:"od-ShareHeader-buttons-left"},this._renderCloseButton()):"";return s.createElement("div",null,a,n,this._renderRightHeaderButtons(i,r,t,e.viewState),this._renderContextualMenu())};e.prototype._renderMoreButton=function(){if(0===this.props.viewState&&!this.props.hideShareDialogOverflowButton)return s.createElement("button",{className:"od-ShareHeader-button","aria-label":this._strings.moreOptionsLabel,onClick:this._onMoreClick,"aria-haspopup":!0,"aria-expanded":this.state.showContextualMenu},s.createElement(n.Icon,{iconName:"More"}))};e.prototype._renderCloseButton=function(){if(this._onDismiss&&c.showCloseButton(this.props.clientId))return s.createElement("button",{className:"od-ShareHeader-button","aria-label":this._strings.closeButtonLabel,onClick:this._dismissComponent},s.createElement(n.Icon,{iconName:"Cancel"}))};e.prototype._dismissComponent=function(e){e.stopPropagation();e.preventDefault();this._onDismiss()};e.prototype._renderRightHeaderButtons=function(e,t,i,r){return!e||t||i||0!==r?e&&t||e&&!t&&(i||0!==r)?"":s.createElement("div",{className:"od-ShareHeader-buttons-right"},this._renderMoreButton(),this._renderCloseButton()):s.createElement("div",{className:"od-ShareHeader-button-send-right"},s.createElement(p.default,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,messageText:this.props.messageText,onSendLinkClicked:this.props.onSendLinkClick,permissionsMap:this.props.permissionsMap,sendButtonType:m.default.link,sharingInformation:this.props.sharingInformation}))};e.prototype._renderItemName=function(){var e=this.props,t=e.item;if(t){var i=1<t.childCount?" ("+d.format(this._strings.folderHeader,t.childCount)+")":"";return c.hideItemName(e.clientId)?void 0:s.createElement("div",{className:"od-ShareHeader-itemName"},u.truncateItemNameForHeader(t.name+" "+i))}};e.prototype._renderContextualMenu=function(){var e=this._strings,t=[];t.push({key:"editable",name:e.manageExistingAccessLabel,onClick:this._onManageExistingAccessClick});if(this.state.showContextualMenu)return s.createElement(a.ContextualMenu,{ariaLabel:this._strings.moreOptionsLabel,className:"od-ShareHeader-moreContextualMenu",items:t,onDismiss:this._onDismissMoreContextualMenu,target:this.state.target,isBeakVisible:!0})};e.prototype._onMoreClick=function(e){this.setState({showContextualMenu:!this.state.showContextualMenu,target:e.nativeEvent.target})};e.prototype._onDismissMoreContextualMenu=function(){this.setState(i.__assign({},this.state,{showContextualMenu:!1}))};e.prototype._onManageExistingAccessClick=function(){this.props.onManageExistingAccessClick()};e.prototype._onSendLinkClick=function(e){this.props.onSendLinkClick(this.props.messageText)};e.prototype._getViewName=function(){var e=this._strings;switch(this.props.viewState){case 0:return e.shareLinkHeader;case 2:return e.modifyPermissionsHeader;case 4:return e.permissionsLabel;case 6:return e.policyDetailsHeader;case 5:return e.grantAccessPageLabel;default:return e.shareLinkHeader}};e.contextTypes={strings:l.object.isRequired,onDismiss:l.func,platformDetection:l.object.isRequired,breakpoint:l.object.isRequired};i.__decorate([o.autobind],e.prototype,"_dismissComponent",null);return e}(s.Component);t.Header=r});define("BJ",["require","exports","Bs"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return e===i.ClientId.word||e===i.ClientId.powerpoint||e===i.ClientId.excel||e===i.ClientId.visio}t.isOfficeProduct=r;function o(e){return e===i.ClientId.odb||e===i.ClientId.sharePoint}t.isODSP=o;function n(e){return e===i.ClientId.odAndroid||e===i.ClientId.odIos}t.isMobile=n;t.hideItemName=function(e){return r(e)||e===i.ClientId.onenoteWeb};t.showCloseButton=function(e){return o(e)||e===i.ClientId.onenoteWeb||e===i.ClientId.officecom||n(e)};t.showOWAShareTarget=function(e){return o(e)||e===i.ClientId.officecom||e===i.ClientId.wac}});define("BC",["require","exports","V","BD"],function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.truncateItemNameForHeader=function(e){return i(e,26)};t.truncateItemNameForShareNotification=function(e){return i(e,20)};function i(e,t){if(!e)return"";var i=t,r=i/2;return e.length<=i?e:e.slice(0,r)+"..."+e.slice(e.length-r)}t.isLoadingData=function(e){return 0===e.userRole&&0===e.defaultLinkKind};t.getLinkIconUrl=function(e){var t="https://static2.sharepointonline.com/files/fabric/assets/icons/sharing";switch(e.sharingLinkKind){case 2:case 3:return t+"/companyonly.svg";case 4:case 5:return t+"/anyone.svg";case 6:return t+"/specificpeople.svg";default:return t+"/existingaccess.svg"}};t.getLinkIconName=function(e){switch(e.sharingLinkKind){case 2:case 3:return"Work";case 4:case 5:return"Globe";case 6:return"PeopleAdd";default:return"Link"}};t.getLinkLabel=function(e,t,i){var r=e.sharingLinkKind,o=e.expiration;switch(r){case 2:return n.format(t.cslViewDescription,i);case 3:return n.format(t.cslEditDescription,i);case 4:return o?n.format(t.anonViewDescriptionWithExpiry,o.toLocaleDateString()):t.anonViewDescription;case 5:return o?n.format(t.anonEditDescriptionWithExpiry,o.toLocaleDateString()):t.anonEditDescription;case 6:return e.isEdit?a.default.pslEditLabel:!0===e.isReview?a.default.pslReviewLabel:a.default.pslViewLabel;default:return""}};t.getEncodedMessageLength=function(e){if(!e)return 0;var t=0,i=e.length,r=0,o=!1;if(0===e.length)return 0;for(var n="&#160;",a="<br />",s="&quot;&quot;&quot;",l="&amp;",d="&#39;",c="&lt;",u="&gt;",p=" ";r<i;){var m=null,h=e[r];if(" "===h)m=r+1<i&&" "===e[r+1]||o?n:" ";else if("\n"===h){m=a;o=!0}else{'"'===h?m=s:"&"===h?m=l:"'"===h?m=d:"<"===h?m=c:">"===h?m=u:"\r"===h&&(m=p);o=!1}t+=null!==m?m.length:1;r++}return t}});define("Cm",["require","exports","ap","at","jP","wN","mh","Bs","Cl","BC","j8","Cn"],function(e,t,i,n,o,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._platformDetection=t.platformDetection;return i}e.prototype.render=function(){var e=!1;if(this.props.currentSettings.audience===l.SharingAudience.existing)for(var t=0,i=this.props.linkRecipients;t<i.length;t++){var r=i[t];if(void 0===this.props.permissionsMap[r.email]){e=!0;break}}if(this.props.ctaLabel){var o=!!this.props.errorMessage||c.isLoadingData(this.props.sharingInformation)||e||c.getEncodedMessageLength(this.props.messageText)>this.props.maximumMessageLength;if(this.props.sendButtonType===d.default.button)return n.createElement(a.PrimaryButton,{disabled:o,onClick:this._onSendLinkClicked},this.props.ctaLabel);if(this.props.sendButtonType===d.default.link)return n.createElement("div",{className:"od-SendButton-linkButton"},n.createElement(s.Link,{disabled:o,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel))}};e.prototype._onSendLinkClicked=function(){this.props.onSendLinkClicked(this.props.messageText)};e.contextTypes={platformDetection:u.object.isRequired};i.__decorate([o.autobind],e.prototype,"_onSendLinkClicked",null);return e}(n.Component);t.default=r});define("Cl",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.button=0]="button";e[e.link=1]="link"}(i||(i={}));t.default=i});define("Cn",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendButton-linkButton{font-size:17px;font:-apple-system-headline}"}])});define("Bn",["require","exports","bT","bD"],function(e,l,r,o){"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.ResponsiveUIEvents={formFactorChange:"formFactorChange",hamburgerVisibilityChange:"hamburgerVisibilityChange",showLabelsChange:"showCommandLabelsChange"};var t={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},d={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},i=function(){function s(e,t){this._scope=new o.default;this._events=new(this._scope.attached(r.default))(this);this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var i=t.breakpoints;this._breakpoints="function"==typeof i?i:function(){return i};this._windowWidth=0;this._windowHeight=0;this._onContainerResize()}s.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};s.determineWindowSize=function(e,t){void 0===t&&(t=d);if(0===e)return"Medium";for(var i in d)if(e<t[i])return i};s.determineCssClass=function(e){return t[e]};s.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),i=e.style;i.visibility="hidden";i.width="100px";i.msOverflowStyle="scrollbar";i.overflow="scroll";t.style.width="100%";document.body.appendChild(e);e.appendChild(t);var r=e.offsetWidth,o=t.offsetWidth;e.parentNode.removeChild(e);var n=r-o;this.getScrollbarWidth=function(){return n};return n};Object.defineProperty(s.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!0,configurable:!0});Object.defineProperty(s.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!0,configurable:!0});s.prototype.dispose=function(){this._scope.dispose()};s.prototype.compareSize=function(e,t){var i=this._breakpoints();return i[e]-i[t]};s.prototype._afterContainerResize=function(){};s.prototype._onContainerResize=function(){var e=document.body,t=document.documentElement,i=this._windowHeight=t.clientWidth||e.clientWidth;this._windowWidth=t.clientHeight||e.clientHeight;var r=this._formFactorSize,o=this._formFactorSize=s.determineWindowSize(i,this._breakpoints());this._cssClass=s.determineCssClass(o);var n=this._isHamburgerVisible;this._isHamburgerVisible=i<d.Large;var a=this._showLabels;this._showLabels=0<this.compareSize(o,"Medium");r&&o!==r&&this._events.raise(l.ResponsiveUIEvents.formFactorChange);"boolean"==typeof n&&n!==this._isHamburgerVisible&&this._events.raise(l.ResponsiveUIEvents.hamburgerVisibilityChange);"boolean"==typeof a&&a!==this._showLabels&&this._events.raise(l.ResponsiveUIEvents.showLabelsChange);this._afterContainerResize()};s.DEFAULT_BREAKPOINTS=d;s.MAC_SCROLL_BAR_WIDTH=8;return s}();l.ResponsiveUI=i;l.default=i});define("DG",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHeader{-ms-flex-align:center;align-items:center;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";display:-ms-flexbox;display:flex;height:40px;-ms-flex-pack:center;justify-content:center;padding:4px}.od-ShareHeader-backgroundColor{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.od-ShareHeader-moreContextualMenu .is-open{border:none;width:auto}.od-ShareHeader-buttons-left{padding-top:16px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-left{padding-left:8px}[dir=rtl] .od-ShareHeader-buttons-left{padding-right:8px}[dir=ltr] .od-ShareHeader-buttons-left{left:0}[dir=rtl] .od-ShareHeader-buttons-left{right:0}.od-ShareHeader-button-send-right{padding-top:12px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-button-send-right{padding-right:8px}[dir=rtl] .od-ShareHeader-button-send-right{padding-left:8px}[dir=ltr] .od-ShareHeader-button-send-right{right:0}[dir=rtl] .od-ShareHeader-button-send-right{left:0}.od-ShareHeader-buttons-right{padding-top:16px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-right{padding-right:8px}[dir=rtl] .od-ShareHeader-buttons-right{padding-left:8px}[dir=ltr] .od-ShareHeader-buttons-right{right:0}[dir=rtl] .od-ShareHeader-buttons-right{left:0}.od-ShareHeader-button{background:0 0;border:none;padding:0;width:30px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:16px;cursor:pointer;font:-apple-system-body}.od-ShareHeader-title{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-ShareHeader-viewName{font-size:17px;font-weight:300;font-weight:400;font:-apple-system-headline}.od-ShareHeader-itemName{font-size:11px;font-weight:400;overflow:hidden;text-align:center;text-overflow:ellipsis;white-space:nowrap;width:175px;font:-apple-system-caption2}"}])});define("C5",["require","exports","ap","DD","jP","Dz","mo","Dn","C7","C3","Cb","Bs","BK","at","j8","BE","V","Co","BD","aW","C6"],function(e,t,n,i,r,a,s,l,d,c,g,y,u,p,m,v,h,f,_,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x={ODB:772},o=function(o){n.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._resize=t.resize;i._strings=t.strings;var r=e.selectedPermissions.specificPeople;i.state={expirationErrorCode:c.ExpirationErrorCode.NONE,externalRecipientWarning:u.getOversharingExternalsWarning(r,i._strings),groupRecipientWarning:u.getOversharingGroupsWarning(r,e.groupsMemberCount,i._strings)};i._getAudienceOptions=i._getAudienceOptions.bind(i);i._onAllowEditChange=i._onAllowEditChange.bind(i);i._onAllowRoleChange=i._onAllowRoleChange.bind(i);i._onChoiceGroupChange=i._onChoiceGroupChange.bind(i);i._onDeleteExpiration=i._onDeleteExpiration.bind(i);i._onSelectDate=i._onSelectDate.bind(i);i._renderExpirationDatePicker=i._renderExpirationDatePicker.bind(i);i._renderExpirationDatePickerErrorMessage=i._renderExpirationDatePickerErrorMessage.bind(i);i._renderPeoplePicker=i._renderPeoplePicker.bind(i);i._permissionsOptions=i._getAudienceChoiceGroupOptions();return i}e.prototype.componentDidUpdate=function(e,t){this._resize()};e.prototype.render=function(){var e=this.props,t=this._strings;return p.createElement("div",{className:"od-PermissionsSettings"},p.createElement("div",{className:"od-PermissionsSettings-section"},p.createElement("div",{id:"od-PermissionsSettings-description",className:"od-PermissionsSettings-description od-ModifyPermissions-margins"},t.permissionsSettingsHeader,p.createElement("a",{className:"od-PermissionsSettings-learnMore","aria-labelledby":"od-PermissionsSettings-description",href:"https://go.microsoft.com/fwlink/?linkid=846149",target:"_blank"},t.learnMoreLabel)),p.createElement("div",{className:"od-PermissionsSettings-bottomBorder"}),p.createElement(i.AudienceChoiceGroup,{items:this._getAudienceOptions(),onChange:this._onChoiceGroupChange,onAudienceChange:e.onAudienceChange,companyName:e.companyName}),this._renderPeoplePicker()),this._renderOtherSettings())};e.prototype.componentWillReceiveProps=function(e){var t=this,i=e.selectedPermissions,r=i.specificPeople;this.setState(n.__assign({},this.state,{expirationErrorCode:this._getExpirationErrorCode(i.expiration),externalRecipientWarning:u.getOversharingExternalsWarning(r,this._strings),groupRecipientWarning:u.getOversharingGroupsWarning(r,e.groupsMemberCount,this._strings)}),function(){t.props.updateExpirationErrorCode(t.state.expirationErrorCode)})};e.prototype._renderOtherSettings=function(){var e=this._strings;if(this.props.selectedPermissions.audience!==y.SharingAudience.existing)return p.createElement("div",{className:"od-PermissionsSettings-section od-ModifyPermissions-margins"},p.createElement("div",{className:"od-PermissionsSettings-description"},e.otherSettings),p.createElement("div",{role:"group","aria-label":e.otherSettings},p.createElement("div",{className:"od-PermissionsSettings-setting"},this._renderRolesDropDown()),this._renderExpirationDatePicker()))};e.prototype._getSpecificPeopleOption=function(){var e=this._strings;return this.props.createPeopleSharingLinks?{disabledText:e.disabledAudienceChoiceLabel,icon:g.FileShareIconMap[2],isChecked:!1,isDisabled:!1,key:y.SharingAudience.specificPeopleFlex,label:e.permissionsSpecificPeopleString,linkKinds:[6],permissionsType:2}:{disabledText:e.disabledAudienceChoiceLabel,icon:g.FileShareIconMap[2],isChecked:!1,isDisabled:!1,key:y.SharingAudience.specificPeople,label:e.permissionsSpecificPeopleString,linkKinds:[1],permissionsType:2}};e.prototype._getAudienceChoiceGroupOptions=function(){var e=this._strings,t=[{disabledText:e.disabledAudienceChoiceLabel,icon:g.FileShareIconMap[0],isChecked:!1,isDisabled:!1,key:y.SharingAudience.anyone,label:e.permissionsAnyoneString,linkKinds:[4,5],permissionsType:0},{disabledText:e.disabledAudienceChoiceLabel,icon:g.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:y.SharingAudience.organization,label:h.format(e.permissionsCompanyString,this.props.companyName),linkKinds:[2,3],permissionsType:1},this._getSpecificPeopleOption()];this.props.clientId===y.ClientId.outlookWeb&&t.splice(2,1);if(this.props.showExistingAccessOption||!this.props.sharingInformation.canManagePermissions||this.props.sharingInformation.blockPeoplePickerAndSharing){var i={icon:g.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:y.SharingAudience.existing,label:e.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4};t.splice(2,0,i)}return t};e.prototype._onPeoplePickerChange=function(e){var t=this;this.setState(n.__assign({},this.state,{externalRecipientWarning:u.getOversharingExternalsWarning(e,this._strings),groupRecipientWarning:u.getOversharingGroupsWarning(e,this.props.groupsMemberCount,this._strings)}),function(){t.props.onPeoplePickerChange(e)})};e.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state;return e.selectedPermissions.audience!==y.SharingAudience.specificPeople&&e.selectedPermissions.audience!==y.SharingAudience.specificPeopleFlex||!e.copyLinkShortcut?void 0:p.createElement("div",{className:"od-ModifyPermissions-margins od-PermissionsSettings-PeoplePicker"},p.createElement(f.default,{defaultSelectedItems:e.selectedPermissions.specificPeople,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t.externalRecipientWarning,oversharingGroupsWarning:t.groupRecipientWarning,pickerSettings:e.sharingInformation.peoplePickerSettings,error:e.peoplePickerError,sharingInformation:e.sharingInformation,clientId:this.props.clientId}))};e.prototype._renderRolesDropDown=function(){var e=this.props,t=b.default.isFeatureEnabled(x),i=e.clientId===y.ClientId.word||e.sharingInformation.item&&e.sharingInformation.item.appmap&&"ms-word"===e.sharingInformation.item.appmap,r=e.selectedPermissions.audience===y.SharingAudience.specificPeople||e.selectedPermissions.audience===y.SharingAudience.specificPeopleFlex;if(t&&i&&r){var o=void 0;o=e.selectedPermissions.sharingRole?e.selectedPermissions.sharingRole:e.selectedPermissions.isEdit?2:1;return p.createElement(l.Dropdown,{className:"od-PermissionsSettings-rolesDropdown",label:"",onRenderTitle:this._onRenderTitle,onRenderOption:this._onRenderOption,onChanged:this._onAllowRoleChange,defaultSelectedKey:o,options:[{key:1,text:_.default.canViewRole},{key:2,text:_.default.canEditRole},{key:6,text:_.default.canReviewRole}]})}return p.createElement(a.Checkbox,{className:"od-PermissionsSettings-allowEdit",label:this._strings.allowEditLabel,onChange:this._onAllowEditChange,checked:e.selectedPermissions.isEdit,disabled:!e.selectedPermissions.allowEditing})};e.prototype._onRenderTitle=function(e){return this._onRenderOption(e[0])};e.prototype._onRenderOption=function(e){var t;switch(e.key){case 2:t="Edit";break;case 1:t="View";break;case 6:t="Chat"}return p.createElement("div",{className:"od-PermissionsSettings-roleDropdownOption"},p.createElement(s.Icon,{className:"od-PermissionsSettings-roleDropdownOptionIcon",iconName:t,title:e.text}),p.createElement("span",{className:"od-PermissionsSettings-roleDropdownOptionText"}," ",e.text," "))};e.prototype._renderExpirationDatePicker=function(){var e=this.props,t=e.selectedPermissions;return t.audience===y.SharingAudience.anyone?p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement("div",{className:"od-PermissionsSettings-datePicker"},p.createElement(d.ExpirationDatePicker,{onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays}),p.createElement("button",{className:"od-PermissionsSettings-delete",onClick:this._onDeleteExpiration,"aria-label":this._strings.removeExpirationLabel},p.createElement(s.Icon,{iconName:"Cancel"}))),p.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage())):void 0};e.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode,t=this._strings;switch(e){case c.ExpirationErrorCode.PAST_DATE:return t.pastDateExpirationError;case c.ExpirationErrorCode.ADMIN_POLICY:return h.format(t.adminExpirationError,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);case c.ExpirationErrorCode.OVER_MAX:return h.format(t.maxExpirationError,730);default:return""}};e.prototype._getAudienceOptions=function(){var e=this.props.sharingInformation.sharingAbilities,t=this.props.sharingInformation;if(this.context.usesSharingAbilities&&e){p=[];var i=this.props.currentSettings;for(var r in e)if(e.hasOwnProperty(r)){var o=e[r],n=v.getSharingAbilitiesAudience(r);if(!n)continue;if(this.props.clientId!==y.ClientId.outlookWeb&&n===y.SharingAudience.specificPeopleFlex&&!this.props.createPeopleSharingLinks){var a=this._getSpecificPeopleOption();t.canManagePermissions&&!t.blockPeoplePickerAndSharing?a.isChecked=a.key===i.audience:a.isDisabled=!0;p.push(a);continue}var s=this._getAudienceOption(n);s.isDisabled=!(o.canManageEditLink.enabled||o.canManageReadLink.enabled);s.isChecked=s.key===i.audience;p.push(s)}var l={icon:g.FileShareIconMap[1],isChecked:i.audience===y.SharingAudience.existing,isDisabled:!1,key:y.SharingAudience.existing,label:this._strings.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4};p.splice(2,0,l);return p}for(var d=this._permissionsOptions,c=this.props.sharingInformation.sharingLinks.map(function(e){return e.sharingLinkKind}),u=function(e){return-1<c.indexOf(e)},p=[],m=0,h=d;m<h.length;m++){var f=h[m];if(2===f.permissionsType)t.canManagePermissions&&!t.blockPeoplePickerAndSharing?f.isChecked=f.key===this.props.currentSettings.audience:f.isDisabled=!0;else{f.linkKinds.some(u)?f.isChecked=f.key===this.props.currentSettings.audience:f.isDisabled=!0}p.push(f)}return p};e.prototype._getAudienceOption=function(e){var t=this._strings;return e===y.SharingAudience.anyone?{disabledText:t.disabledAudienceChoiceLabel,icon:g.FileShareIconMap[0],isChecked:!1,isDisabled:!1,key:y.SharingAudience.anyone,label:t.permissionsAnyoneString,linkKinds:[4,5],permissionsType:0}:e===y.SharingAudience.organization?{disabledText:t.disabledAudienceChoiceLabel,icon:g.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:y.SharingAudience.organization,label:h.format(t.permissionsCompanyString,this.props.companyName),linkKinds:[2,3],permissionsType:1}:e===y.SharingAudience.specificPeopleFlex?{disabledText:t.disabledAudienceChoiceLabel,icon:g.FileShareIconMap[2],isChecked:!1,isDisabled:!1,key:y.SharingAudience.specificPeopleFlex,label:t.permissionsSpecificPeopleString,linkKinds:[6],permissionsType:2}:void 0};e.prototype._onChoiceGroupChange=function(e){for(var t=0,i=this._permissionsOptions;t<i.length;t++){var r=i[t];r.isChecked=e===r.key}};e.prototype._onSelectDate=function(e){var t=this,i=this._getExpirationErrorCode(e);this.setState(n.__assign({},this.state,{expirationErrorCode:i}),function(){t.props.updateExpirationErrorCode(i);t.props.onExpirationChange(e)})};e.prototype._onAllowEditChange=function(e,t){this.props.onEditChange(t)};e.prototype._onAllowRoleChange=function(e){var t=this;e.selected=!0;this.setState(n.__assign({},this.state),function(){t.props.onRoleChange(e.key)})};e.prototype._onDeleteExpiration=function(){var e=this;this.setState(n.__assign({},this.state,{expirationErrorCode:c.ExpirationErrorCode.NONE}),function(){e.props.onExpirationChange(null)})};e.prototype._getExpirationErrorCode=function(e){var t=c.ExpirationErrorCode.NONE,i=this.props.sharingInformation.anonymousLinkExpirationRestrictionDays;if(!e||e.getTime()===new Date(0).getTime())return t;var r=new Date;r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var o=Math.floor((e.getTime()-r.getTime())/864e5);o<1?t=c.ExpirationErrorCode.PAST_DATE:730<o?t=c.ExpirationErrorCode.OVER_MAX:i<o&&-1!==i&&(t=c.ExpirationErrorCode.ADMIN_POLICY);return t};e.contextTypes={strings:m.object.isRequired,resize:m.func.isRequired,usesSharingAbilities:m.bool.isRequired};n.__decorate([r.autobind],e.prototype,"_getSpecificPeopleOption",null);n.__decorate([r.autobind],e.prototype,"_onPeoplePickerChange",null);n.__decorate([r.autobind],e.prototype,"_onRenderTitle",null);n.__decorate([r.autobind],e.prototype,"_getAudienceOption",null);n.__decorate([r.autobind],e.prototype,"_onAllowRoleChange",null);return e}(p.Component);t.PermissionsSettings=o});define("DD",["require","exports","ap","Bs","o7","B7","at","j8","jP","BD","eu","bf","V","DE"],function(e,t,i,a,o,s,l,n,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i.state={selectedKey:i._getSelectedIndex(e)};i._strings=t.strings;return i}e.prototype._getSelectedIndex=function(e){for(var t=0,i=e.items;t<i.length;t++){var r=i[t];if(r.isChecked)return r.key}};e.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return l.createElement("div",{"aria-label":this._strings.permissionsSettingsHeader,role:"radiogroup"},l.createElement(o.FocusZone,{direction:o.FocusZoneDirection.vertical,defaultActiveElement:".od-AudienceChoiceGroup-row.is-selected",onActiveElementChanged:this._onActiveElementChanged},e))};e.prototype._onActiveElementChanged=function(e){if(e&&e.hasAttribute("data-key")){var t=parseInt(e.getAttribute("data-key"),10);"true"===e.getAttribute("aria-disabled")||this._onRowClick(t,null)}};e.prototype._renderItem=function(e){var t=e.key,i=e.isDisabled&&e.disabledText?e.disabledText:"",r=this.state.selectedKey===t,o=!1;if(!p.Killswitch.isActivated("ce4f84ee-3fdb-44d6-ac1d-e45bc4adf3bc","4/25/2018","Sharing LinkSettings help text experiment")){o=new u.ABExperiment({name:"SharingLinkSettingsHelpTextRevised",startDate:"04/25/2018"}).IsExperimentOn()}if(!i&&o){var n=this.props.companyName||c.default.companyNameFallback;switch(e.key){case a.SharingAudience.anyone:i=m.format(c.default.anonymousHelpText,n);break;case a.SharingAudience.organization:i=m.format(c.default.cslHelpText,n);break;case a.SharingAudience.existing:i=c.default.existingAccessHelpText;break;case a.SharingAudience.specificPeople:case a.SharingAudience.specificPeopleFlex:i=m.format(c.default.specificPeopleHelpText,n)}}return l.createElement("div",null,l.createElement("button",{role:"radio","aria-checked":r,key:t,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,t),className:this._getRowClasses(e),autoFocus:r,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-label":e.label+" "+i,"data-key":t},l.createElement("div",{className:"od-AudienceChoiceGroup-description"},l.createElement(s.ShareLinkDescription,{label:e.label,permissionsType:e.permissionsType,showLabel:!0,infoButtonMessage:i}))),l.createElement("div",{className:"od-AudienceChoiceGroup-bottomBorder"}))};e.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-AudienceChoiceGroup-row";this.state.selectedKey===e.key&&(t+=" is-selected");e.isDisabled&&(t+=" is-disabled");return t};e.prototype._onRowClick=function(e,t){var i=this.props;this.setState({selectedKey:e});i.onChange(e);i.onAudienceChange(e)};e.contextTypes={strings:n.object.isRequired};i.__decorate([d.autobind],e.prototype,"_onActiveElementChanged",null);return e}(l.Component);t.AudienceChoiceGroup=r});define("B7",["require","exports","ap","Cb","B9","mo","at","B8"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=r.FileShareIconMap[this.props.permissionsType];return a.createElement("div",{className:"od-ShareLinkDescription"},a.createElement("div",{className:"od-ShareLinkDescription-icon icon-"+e},a.createElement(n.Icon,{iconName:e})),this._renderLabel())};t.prototype._renderLabel=function(){var e=this.props.infoButtonMessage,t=e?a.createElement(o.InfoButton,{message:e}):"";if(this.props.showLabel)return a.createElement("div",{className:"od-ShareLinkDescription-label"},this.props.label,t)};return t}(a.Component);t.ShareLinkDescription=s});define("Cb",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileShareIconMap=((i={})[0]="Globe",i[3]="Lock",i[2]="PeopleAdd",i[1]="Work",i[4]="SecurityGroup",i);var i});define("B9",["require","exports","ap","jP","wE","mo","at","j8","Ca"],function(e,t,i,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i.state={isCalloutVisible:!1};return i}e.prototype.render=function(){var e=this.props,t=this.state;return s.createElement("div",null,s.createElement("div",{className:"od-InfoButton-button",onClick:this._onShowCallout,ref:this._onInfoButton},s.createElement(a.Icon,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout})),t.isCalloutVisible&&s.createElement(n.Callout,{directionalHint:1,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},s.createElement("div",{className:"od-InfoButton-content"},s.createElement("span",{className:"od-InfoButton-message"},e.message))))};e.prototype._onShowCallout=function(){this.setState(i.__assign({},this.state,{isCalloutVisible:!0}))};e.prototype._onDismissCallout=function(){this.setState(i.__assign({},this.state,{isCalloutVisible:!1}))};e.prototype._onInfoButton=function(e){this._infoButton=e};e.contextTypes={strings:l.object.isRequired};i.__decorate([o.autobind],e.prototype,"_onShowCallout",null);i.__decorate([o.autobind],e.prototype,"_onDismissCallout",null);i.__decorate([o.autobind],e.prototype,"_onInfoButton",null);return e}(s.Component);t.InfoButton=r});define("Ca",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:5px 4px 4px 4px;font-size:12px}.od-InfoButton-button{background:0 0;border:none;padding:0}.od-InfoButton-content{font-size:12px;font-weight:400;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;padding:10px;width:250px}"}])});define("B8",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDescription{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;padding:4px 0;width:100%}.od-ShareLinkDescription-label{font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";display:-ms-flexbox;display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;width:80%;font:-apple-system-caption1}[dir=ltr] .od-ShareLinkDescription-label{margin-left:8px}[dir=rtl] .od-ShareLinkDescription-label{margin-right:8px}[dir=ltr] .od-ShareLinkDescription-label{text-align:left}[dir=rtl] .od-ShareLinkDescription-label{text-align:right}.od-ShareLinkDescription-icon{-ms-flex-align:center;align-items:center;border-radius:50%;border-style:solid;border-width:1px;box-sizing:border-box;display:-ms-flexbox;display:flex;height:24px;-ms-flex-pack:center;justify-content:center;width:24px}.od-ShareLinkDescription-icon .ms-Icon{font-size:14px}"}])});define("DE",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AudienceChoiceGroup-row{background:0 0;border:none;cursor:pointer;margin-top:4px;width:90%;font:-apple-system-caption1}.od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font-weight:600}.od-AudienceChoiceGroup-row.is-selected::after{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";content:'\\e73e';font-family:FabricMDL2Icons;font-size:16px;margin-top:8px}[dir=ltr] .od-AudienceChoiceGroup-row.is-selected::after{float:right}[dir=rtl] .od-AudienceChoiceGroup-row.is-selected::after{float:left}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-label{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-AudienceChoiceGroup-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-AudienceChoiceGroup-description{-ms-flex-align:center;align-items:center;display:-ms-inline-flexbox;display:inline-flex;overflow:hidden;width:90%}[dir=ltr] .od-AudienceChoiceGroup-description{float:left}[dir=rtl] .od-AudienceChoiceGroup-description{float:right}"}])});define("C7",["require","exports","ap","jP","C9","mo","at","j8","C8"],function(e,t,i,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(p){i.__extends(e,p);function e(e,t){var i=p.call(this,e)||this,r=t.strings,o=r.months,n=r.shortMonths,a=r.days,s=r.shortDays,l=r.goToToday,d=r.setExpirationDate,c=r.nextMonthAriaLabel,u=r.prevMonthAriaLabel;i._datePickerStrings={months:o,shortMonths:n,days:a,shortDays:s,goToToday:l,setExpirationDate:d,nextMonthAriaLabel:c,prevMonthAriaLabel:u};i._onSelectDate=i._onSelectDate.bind(i);return i}e.prototype.render=function(){return a.createElement("div",{className:"od-ExpirationDatePicker"},a.createElement("div",{className:"od-ExpirationDatePicker-label"},a.createElement(n.Icon,{iconName:"Calendar"})),a.createElement(o.DatePicker,{strings:this._datePickerStrings,placeholder:this._datePickerStrings.setExpirationDate,isMonthPickerVisible:!1,onSelectDate:this._onSelectDate,value:this.props.value,formatDate:this._formatDate}))};e.prototype._onSelectDate=function(e){this.props.onSelectDate(e)};e.prototype._formatDate=function(e){if(e){var t=e.getDay(),i=e.getMonth();return this._datePickerStrings.days[t]+" "+this._datePickerStrings.shortMonths[i]+" "+e.getDate()+" "+e.getFullYear()}return""};e.contextTypes={strings:s.object.isRequired};i.__decorate([r.autobind],e.prototype,"_formatDate",null);return e}(a.Component);t.ExpirationDatePicker=l});define("C9",["require","exports","ap","Da"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Da",["require","exports","ap","Dd","Db"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("Dd",["require","exports","ap","at","Dh","Dc","wE","BT","jP","Df","De"],function(e,t,x,S,C,i,P,k,I,d,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=r,o={months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["S","M","T","W","T","F","S"],goToToday:"Go to today",prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year"},n=function(r){x.__extends(e,r);function e(e){var u=r.call(this,e)||this;u._calendar=I.createRef();u._datePickerDiv=I.createRef();u._textField=I.createRef();u._onSelectDate=function(e){var t=u.props,i=t.formatDate,r=t.onSelectDate;u.props.calendarProps&&u.props.calendarProps.onSelectDate&&u.props.calendarProps.onSelectDate(e);u.setState({selectedDate:e,formattedDate:i&&e?i(e):""});r&&r(e);u._calendarDismissed()};u._onCalloutPositioned=function(){u._calendar.current&&u._calendar.current.focus()};u._onTextFieldFocus=function(e){u.props.disableAutoFocus||u.props.allowTextInput||(u._preventFocusOpeningPicker?u._preventFocusOpeningPicker=!1:u._showDatePickerPopup())};u._onTextFieldBlur=function(e){u._validateTextInput()};u._onTextFieldChanged=function(e){if(u.props.allowTextInput){u.state.isDatePickerShown&&u._dismissDatePickerPopup();var t=u.props,i=t.isRequired,r=t.value,o=t.strings;u.setState({errorMessage:i&&!r?o.isRequiredErrorMessage||" ":void 0,formattedDate:e})}};u._onTextFieldKeyDown=function(e){switch(e.which){case 13:e.preventDefault();e.stopPropagation();u.state.isDatePickerShown?u.props.allowTextInput&&u._dismissDatePickerPopup():u._showDatePickerPopup();break;case 27:u._handleEscKey(e)}};u._onTextFieldClick=function(e){u.state.isDatePickerShown||u.props.disabled?u.props.allowTextInput&&u.setState({isDatePickerShown:!1}):u._showDatePickerPopup()};u._onIconClick=function(e){e.stopPropagation();u._onTextFieldClick(e)};u._dismissDatePickerPopup=function(){if(u.state.isDatePickerShown){u.setState({isDatePickerShown:!1});u._validateTextInput()}};u._calendarDismissed=function(){u._preventFocusOpeningPicker=!0;u._dismissDatePickerPopup();u._textField.current&&u._textField.current.focus()};u._handleEscKey=function(e){e.stopPropagation();u._calendarDismissed()};u._validateTextInput=function(){var e=u.props,t=e.isRequired,i=e.allowTextInput,r=e.strings,o=e.parseDateFromString,n=e.onSelectDate,a=e.formatDate,s=e.minDate,l=e.maxDate,d=u.state.formattedDate;if(!u.state.isDatePickerShown)if(!t||d){if(i){var c=null;if(d)if(u.state.selectedDate&&a&&a(u.state.selectedDate)===d)c=u.state.selectedDate;else if(!(c=o(d))||isNaN(c.getTime())){if(a){c=u.state.selectedDate;u.setState({formattedDate:a(c).toString()})}u.setState({errorMessage:r.invalidInputErrorMessage||" "})}else if(u._isDateOutOfBounds(c,s,l))u.setState({errorMessage:r.isOutOfBoundsErrorMessage||" "});else{u.setState({selectedDate:c,errorMessage:""});a&&a(c)!==d&&u.setState({formattedDate:a(c).toString()})}else u.setState({errorMessage:""});n&&n(c)}}else u.setState({errorMessage:r.isRequiredErrorMessage||" "})};var t=e.formatDate,i=e.value;u.state={selectedDate:i||void 0,formattedDate:t&&i?t(i):"",isDatePickerShown:!1,errorMessage:void 0};u._preventFocusOpeningPicker=!1;return u}e.prototype.componentWillReceiveProps=function(e){var t=e.formatDate,i=e.isRequired,r=e.strings,o=e.value,n=e.minDate,a=e.maxDate;if(!(d.compareDates(this.props.minDate,e.minDate)&&d.compareDates(this.props.maxDate,e.maxDate)&&this.props.isRequired===e.isRequired&&d.compareDates(this.state.selectedDate,o)&&this.props.formatDate===t)){var s=i&&!o?r.isRequiredErrorMessage||" ":void 0;!s&&o&&(s=this._isDateOutOfBounds(o,n,a)?r.isOutOfBoundsErrorMessage||" ":void 0);this.setState({errorMessage:s});var l=this.state.selectedDate;d.compareDates(l,o)&&this.props.formatDate===t||this.setState({selectedDate:o||void 0,formattedDate:t&&o?t(o):""})}};e.prototype.componentDidUpdate=function(e,t){this.props.onAfterMenuDismiss&&t.isDatePickerShown&&!this.state.isDatePickerShown&&this.props.onAfterMenuDismiss()};e.prototype.render=function(){var e=this.props,t=e.firstDayOfWeek,i=e.strings,r=e.label,o=e.initialPickerDate,n=e.isRequired,a=e.disabled,s=e.ariaLabel,l=e.pickerAriaLabel,d=e.placeholder,c=e.allowTextInput,u=e.borderless,p=e.className,m=e.minDate,h=e.maxDate,f=e.calendarProps,g=this.state,y=g.isDatePickerShown,v=g.formattedDate,_=g.selectedDate,b=g.errorMessage;return S.createElement("div",{className:I.css("ms-DatePicker",T.root,y&&"is-open",p)},S.createElement("div",{ref:this._datePickerDiv},S.createElement(k.TextField,{label:r,className:T.textField,ariaLabel:s,"aria-haspopup":"true","aria-expanded":y,required:n,disabled:a,onKeyDown:this._onTextFieldKeyDown,onFocus:this._onTextFieldFocus,onBlur:this._onTextFieldBlur,onClick:this._onTextFieldClick,onChanged:this._onTextFieldChanged,errorMessage:b,placeholder:d,borderless:u,iconProps:{iconName:"Calendar",onClick:this._onIconClick,className:I.css(a&&T.msDatePickerDisabled,r?"ms-DatePicker-event--with-label":"ms-DatePicker-event--without-label",r?T.eventWithLabel:T.eventWithoutLabel)},readOnly:!c,value:v,componentRef:this._textField,role:c?"combobox":"menu"})),y&&S.createElement(P.Callout,{role:"dialog",ariaLabel:l,isBeakVisible:!1,className:I.css("ms-DatePicker-callout"),gapSpace:0,doNotLayer:!1,target:this._datePickerDiv.current,directionalHint:4,onDismiss:this._calendarDismissed,onPositioned:this._onCalloutPositioned},S.createElement(C.Calendar,x.__assign({},f,{onSelectDate:this._onSelectDate,onDismiss:this._calendarDismissed,isMonthPickerVisible:this.props.isMonthPickerVisible,showMonthPickerAsOverlay:this.props.showMonthPickerAsOverlay,today:this.props.today,value:_||o,firstDayOfWeek:t,strings:i,highlightCurrentMonth:this.props.highlightCurrentMonth,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,showGoToToday:this.props.showGoToToday,dateTimeFormatter:this.props.dateTimeFormatter,minDate:m,maxDate:h,componentRef:this._calendar}))))};e.prototype.focus=function(){this._textField.current&&this._textField.current.focus()};e.prototype._showDatePickerPopup=function(){if(!this.state.isDatePickerShown){this._preventFocusOpeningPicker=!0;this.setState({isDatePickerShown:!0,errorMessage:""})}};e.prototype._isDateOutOfBounds=function(e,t,i){return!!t&&0<d.compareDatePart(t,e)||!!i&&d.compareDatePart(i,e)<0};e.defaultProps={allowTextInput:!1,formatDate:function(e){return e?e.toDateString():""},parseDateFromString:function(e){var t=Date.parse(e);return t?new Date(t):null},firstDayOfWeek:C.DayOfWeek.Sunday,initialPickerDate:new Date,isRequired:!1,isMonthPickerVisible:!0,showMonthPickerAsOverlay:!1,strings:o,highlightCurrentMonth:!1,borderless:!1,pickerAriaLabel:"Calender",showWeekNumbers:!1,firstWeekOfYear:i.FirstWeekOfYear.FirstDay,showGoToToday:!0,dateTimeFormatter:void 0};return e}(I.BaseComponent);t.DatePicker=n});define("Dh",["require","exports","ap","Di"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Di",["require","exports","ap","Dj","Db"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("Dj",["require","exports","ap","at","Dc","Dm","Dl","Df","jP","Dk"],function(e,t,r,_,o,b,x,s,S,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=i,n={leftNavigation:"Up",rightNavigation:"Down"},a=[o.DayOfWeek.Monday,o.DayOfWeek.Tuesday,o.DayOfWeek.Wednesday,o.DayOfWeek.Thursday,o.DayOfWeek.Friday],l={formatMonthDayYear:function(e,t){return t.months[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()},formatMonthYear:function(e,t){return t.months[e.getMonth()]+" "+e.getFullYear()},formatDay:function(e){return e.getDate().toString()},formatYear:function(e){return e.getFullYear().toString()}},d=function(i){r.__extends(e,i);function e(e){var a=i.call(this,e)||this;a._dayPicker=S.createRef();a._monthPicker=S.createRef();a._navigateDay=function(e){a.setState({navigatedDate:e})};a._onNavigateDate=function(e,t){if(a.props.isDayPickerVisible||!a.props.isDayPickerVisible&&!t){a._navigateDay(e);a._focusOnUpdate=t}else a._onSelectDate(e)};a._onSelectDate=function(e,t){var i=a.props.onSelectDate;a.setState({selectedDate:e});i&&i(e,t)};a._onHeaderSelect=function(e){a.setState({isDayPickerVisible:!a.state.isDayPickerVisible,isMonthPickerVisible:!a.state.isMonthPickerVisible});e&&(a._focusOnUpdate=!0)};a._onGotoToday=function(){var e=a.props,t=e.dateRangeType,i=e.firstDayOfWeek,r=e.today,o=e.workWeekDays,n=s.getDateRangeArray(r,t,i,o);a._onSelectDate(r,n)};a._onGotoTodayKeyDown=function(e){if(13===e.which||32===e.which){e.preventDefault();a._onGotoToday()}else if(9===e.which&&!e.shiftKey&&a.props.onDismiss){e.stopPropagation();e.preventDefault();a.props.onDismiss()}};a._onDatePickerPopupKeyDown=function(e){switch(e.which){case 13:case 8:e.preventDefault();break;case 27:a._handleEscKey(e)}};a._handleEscKey=function(e){a.props.onDismiss&&a.props.onDismiss()};var t=e.value&&!isNaN(e.value.getTime())?e.value:e.today||new Date;a.state={selectedDate:t,navigatedDate:t,isMonthPickerVisible:!a.props.showMonthPickerAsOverlay&&a.props.isMonthPickerVisible,isDayPickerVisible:!!a.props.showMonthPickerAsOverlay||a.props.isDayPickerVisible};a._focusOnUpdate=!1;return a}e.prototype.componentWillReceiveProps=function(e){var t=e.autoNavigateOnSelection,i=e.value,r=e.today,o=void 0===r?new Date:r;t&&!s.compareDates(i,this.props.value)&&this.setState({navigatedDate:i});this.setState({selectedDate:i||o})};e.prototype.componentDidUpdate=function(){if(this._focusOnUpdate){this._dayPicker.current?this._dayPicker.current.focus():this._monthPicker.current&&this._monthPicker.current.focus();this._focusOnUpdate=!1}};e.prototype.render=function(){var e=this.props,t=e.firstDayOfWeek,i=e.dateRangeType,r=e.strings,o=e.showMonthPickerAsOverlay,n=e.autoNavigateOnSelection,a=e.showGoToToday,s=e.highlightCurrentMonth,l=e.navigationIcons,d=e.minDate,c=e.maxDate,u=this.state,p=u.selectedDate,m=u.navigatedDate,h=u.isMonthPickerVisible,f=u.isDayPickerVisible,g=o?this._onHeaderSelect:void 0,y=!o&&!f,v=o&&a;return _.createElement("div",{className:S.css("ms-DatePicker",C.root),role:"application"},_.createElement("div",{className:S.css("ms-DatePicker-picker ms-DatePicker-picker--opened ms-DatePicker-picker--focused",C.picker,C.pickerIsOpened,C.pickerIsFocused,h&&"ms-DatePicker-monthPickerVisible "+C.monthPickerVisible,h&&f&&"ms-DatePicker-calendarsInline "+C.calendarsInline,y&&"ms-DatePicker-monthPickerOnly "+C.monthPickerOnly,o&&"ms-DatePicker-monthPickerAsOverlay "+C.monthPickerAsOverlay)},_.createElement("div",{className:S.css("ms-DatePicker-holder ms-slideDownIn10",C.holder,v&&C.holderWithButton),onKeyDown:this._onDatePickerPopupKeyDown},_.createElement("div",{className:S.css("ms-DatePicker-frame",C.frame)},_.createElement("div",{className:S.css("ms-DatePicker-wrap",C.wrap,a&&C.goTodaySpacing)},f&&_.createElement(b.CalendarDay,{selectedDate:p,navigatedDate:m,today:this.props.today,onSelectDate:this._onSelectDate,onNavigateDate:this._onNavigateDate,onDismiss:this.props.onDismiss,firstDayOfWeek:t,dateRangeType:i,autoNavigateOnSelection:n,strings:r,onHeaderSelect:g,navigationIcons:l,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,dateTimeFormatter:this.props.dateTimeFormatter,showSixWeeksByDefault:this.props.showSixWeeksByDefault,minDate:d,maxDate:c,workWeekDays:this.props.workWeekDays,componentRef:this._dayPicker}),h&&_.createElement(x.CalendarMonth,{navigatedDate:m,strings:r,onNavigateDate:this._onNavigateDate,today:this.props.today,highlightCurrentMonth:s,onHeaderSelect:g,navigationIcons:l,dateTimeFormatter:this.props.dateTimeFormatter,minDate:d,maxDate:c,componentRef:this._monthPicker}),a&&_.createElement("button",{role:"button",className:S.css("ms-DatePicker-goToday js-goToday",C.goToday),onClick:this._onGotoToday,onKeyDown:this._onGotoTodayKeyDown,tabIndex:0},r.goToToday))))))};e.prototype.focus=function(){this._dayPicker.current&&this._dayPicker.current.focus()};e.defaultProps={onSelectDate:void 0,onDismiss:void 0,isMonthPickerVisible:!0,isDayPickerVisible:!0,showMonthPickerAsOverlay:!1,value:void 0,today:new Date,firstDayOfWeek:o.DayOfWeek.Sunday,dateRangeType:o.DateRangeType.Day,autoNavigateOnSelection:!1,showGoToToday:!0,strings:null,highlightCurrentMonth:!1,navigationIcons:n,showWeekNumbers:!1,firstWeekOfYear:o.FirstWeekOfYear.FirstDay,dateTimeFormatter:l,showSixWeeksByDefault:!1,workWeekDays:a};return e}(S.BaseComponent);t.Calendar=d});define("Dc",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Sunday=0]="Sunday";e[e.Monday=1]="Monday";e[e.Tuesday=2]="Tuesday";e[e.Wednesday=3]="Wednesday";e[e.Thursday=4]="Thursday";e[e.Friday=5]="Friday";e[e.Saturday=6]="Saturday"}(t.DayOfWeek||(t.DayOfWeek={}));!function(e){e[e.January=0]="January";e[e.February=1]="February";e[e.March=2]="March";e[e.April=3]="April";e[e.May=4]="May";e[e.June=5]="June";e[e.July=6]="July";e[e.August=7]="August";e[e.September=8]="September";e[e.October=9]="October";e[e.November=10]="November";e[e.December=11]="December"}(t.MonthOfYear||(t.MonthOfYear={}));!function(e){e[e.FirstDay=0]="FirstDay";e[e.FirstFullWeek=1]="FirstFullWeek";e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(t.FirstWeekOfYear||(t.FirstWeekOfYear={}));!function(e){e[e.Day=0]="Day";e[e.Week=1]="Week";e[e.Month=2]="Month";e[e.WorkWeek=3]="WorkWeek"}(t.DateRangeType||(t.DateRangeType={}))});define("Dm",["require","exports","ap","at","jP","Dc","o7","mo","Df","Dk"],function(e,t,i,T,w,E,D,A,M,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var F=r,o=function(t){i.__extends(e,t);function e(e){var p=t.call(this,e)||this;p._onKeyDown=function(e,t){13!==t.which&&32!==t.which||e()};p._onDayKeyDown=function(t,i,r){return function(e){p._navigateMonthEdge(e,t,i,r)}};p._onSelectDate=function(e){var t=p.props,i=t.onSelectDate,r=t.dateRangeType,o=t.firstDayOfWeek,n=t.navigatedDate,a=t.autoNavigateOnSelection,s=t.minDate,l=t.maxDate,d=t.workWeekDays,c=M.getDateRangeArray(e,r,o,d);r!==E.DateRangeType.Day&&(c=p._getBoundedDateRange(c,s,l));i&&i(e,c);if(a&&e.getMonth()!==n.getMonth()){var u=M.compareDatePart(e,n);u<0?p._onSelectPrevMonth():0<u&&p._onSelectNextMonth()}};p._onSelectNextMonth=function(){p.props.onNavigateDate(M.addMonths(p.props.navigatedDate,1),!1)};p._onSelectPrevMonth=function(){p.props.onNavigateDate(M.addMonths(p.props.navigatedDate,-1),!1)};p._onHeaderSelect=function(){var e=p.props.onHeaderSelect;e&&e(!0)};p._onHeaderKeyDown=function(e){var t=p.props.onHeaderSelect;!t||13!==e.which&&32!==e.which||t(!0)};p._onPrevMonthKeyDown=function(e){p._onKeyDown(p._onSelectPrevMonth,e)};p._onNextMonthKeyDown=function(e){p._onKeyDown(p._onSelectNextMonth,e)};p.state={activeDescendantId:w.getId("DatePickerDay-active"),weeks:p._getWeeks(e)};p._onSelectNextMonth=p._onSelectNextMonth.bind(p);p._onSelectPrevMonth=p._onSelectPrevMonth.bind(p);return p}e.prototype.componentWillReceiveProps=function(e){this.setState({weeks:this._getWeeks(e)})};e.prototype.render=function(){var a=this,e=this.state,s=e.activeDescendantId,t=e.weeks,i=this.props,r=i.firstDayOfWeek,l=i.strings,d=i.navigatedDate,o=i.selectedDate,c=i.dateRangeType,n=i.navigationIcons,u=i.showWeekNumbers,p=i.firstWeekOfYear,m=i.dateTimeFormatter,h=i.minDate,f=i.maxDate,g=w.getId("DatePickerDay-dayPicker"),y=w.getId("DatePickerDay-monthAndYear"),v=n.leftNavigation,_=n.rightNavigation,b=u?M.getWeekNumbersInMonth(t.length,r,p,d):null,x=u?M.getWeekNumber(o,r,p):void 0,S={};c===E.DateRangeType.Month&&o.getMonth()===d.getMonth()&&o.getFullYear()===d.getFullYear()&&(S=this._getWeekCornerStyles(t));var C,P,k=!h||M.compareDatePart(h,M.getMonthStart(d))<0,I=!f||M.compareDatePart(M.getMonthEnd(d),f)<0;return T.createElement("div",{className:w.css("ms-DatePicker-dayPicker",F.dayPicker,u&&(w.getRTL()?F.showWeekNumbersRTL:F.showWeekNumbers)),id:g},T.createElement("div",{className:w.css("ms-DatePicker-monthComponents",F.monthComponents)},T.createElement("div",{className:w.css("ms-DatePicker-navContainer",F.navContainer)},T.createElement("button",{className:w.css("ms-DatePicker-prevMonth js-prevMonth",F.prevMonth,(C={},C["ms-DatePicker-prevMonth--disabled "+F.prevMonthIsDisabled]=!k,C)),onClick:this._onSelectPrevMonth,onKeyDown:this._onPrevMonthKeyDown,"aria-controls":g,"aria-label":l.prevMonthAriaLabel?l.prevMonthAriaLabel+" "+l.months[M.addMonths(d,-1).getMonth()]:void 0,role:"button",tabIndex:0},T.createElement(A.Icon,{iconName:v})),T.createElement("button",{className:w.css("ms-DatePicker-nextMonth js-nextMonth",F.nextMonth,(P={},P["ms-DatePicker-nextMonth--disabled "+F.nextMonthIsDisabled]=!I,P)),onClick:this._onSelectNextMonth,onKeyDown:this._onNextMonthKeyDown,"aria-controls":g,"aria-label":l.nextMonthAriaLabel?l.nextMonthAriaLabel+" "+l.months[M.addMonths(d,1).getMonth()]:void 0,role:"button",tabIndex:0},T.createElement(A.Icon,{iconName:_})))),T.createElement("div",{className:w.css("ms-DatePicker-header",F.header)},T.createElement("div",{"aria-live":"polite","aria-relevant":"text","aria-atomic":"true",id:y},this.props.onHeaderSelect?T.createElement("div",{className:w.css("ms-DatePicker-monthAndYear js-showMonthPicker",F.monthAndYear,F.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":m.formatMonthYear(d,l),role:"button",tabIndex:0},m.formatMonthYear(d,l)):T.createElement("div",{className:w.css("ms-DatePicker-monthAndYear",F.monthAndYear)},m.formatMonthYear(d,l)))),T.createElement(D.FocusZone,null,u?T.createElement("table",{className:w.css("ms-DatePicker-weekNumbers",F.weekNumbers,"ms-DatePicker-table",F.table)},T.createElement("tbody",null,b.map(function(e,t){return T.createElement("tr",{key:t},T.createElement("td",null,T.createElement("div",{className:w.css("ms-DatePicker-day",F.day,(i={},i["ms-DatePicker-week--highlighted "+F.weekIsHighlighted]=x===e,i))},T.createElement("span",null,e))));var i}))):null,T.createElement("table",{className:w.css("ms-DatePicker-table",F.table),"aria-readonly":"true","aria-multiselectable":"false","aria-labelledby":y,"aria-activedescendant":s},T.createElement("thead",null,T.createElement("tr",null,l.shortDays.map(function(e,t){return T.createElement("th",{className:w.css("ms-DatePicker-weekday",F.weekday),role:"grid",scope:"col",key:t,title:l.days[(t+r)%7],"aria-label":l.days[(t+r)%7]},l.shortDays[(t+r)%7])}))),T.createElement("tbody",null,t.map(function(e,n){return T.createElement("tr",{key:n,role:"row"},e.map(function(e,t){var i,r,o=M.compareDates(d,e.originalDate);return T.createElement("td",{key:e.key,className:w.css((i={},i["ms-DatePicker-weekBackground "+F.weekBackground]=e.isSelected&&(c===E.DateRangeType.Week||c===E.DateRangeType.WorkWeek),i["ms-DatePicker-monthBackground "+F.monthBackground+" "+a._getHighlightedCornerStyle(S,t,n)]=e.isInMonth&&e.isSelected&&c===E.DateRangeType.Month,i["ms-DatePicker-dayBackground "+F.dayBackground]=e.isSelected&&c===E.DateRangeType.Day,i))},T.createElement("div",{className:w.css("ms-DatePicker-day",F.day,(r={},r["ms-DatePicker-day--disabled "+F.dayIsDisabled]=!e.isInBounds,r["ms-DatePicker-day--infocus "+F.dayIsFocused]=e.isInBounds&&e.isInMonth,r["ms-DatePicker-day--outfocus "+F.dayIsUnfocused]=e.isInBounds&&!e.isInMonth,r["ms-DatePicker-day--today "+F.dayIsToday]=e.isToday,r["ms-DatePicker-day--highlighted "+F.dayIsHighlighted]=e.isSelected&&c===E.DateRangeType.Day,r)),role:"gridcell",onClick:e.isInBounds?e.onSelected:void 0,onKeyDown:a._onDayKeyDown(e.originalDate,n,t),"aria-label":m.formatMonthDayYear(e.originalDate,l),id:o?s:void 0,"aria-selected":e.isInBounds?e.isSelected:void 0,"data-is-focusable":!!e.isInBounds||void 0,ref:o?"navigatedDay":void 0,key:o?"navigatedDay":void 0},T.createElement("span",{"aria-hidden":"true"},m.formatDay(e.originalDate))))}))})))))};e.prototype.focus=function(){if(this.refs.navigatedDay){this.refs.navigatedDay.tabIndex=0;this.refs.navigatedDay.focus()}};e.prototype._findCornerIndexes=function(e){for(var t=[],i=0,r=e.length;i<r;i++){e[i].isInMonth&&t.push(i)}2<t.length&&t.splice(1,t.length-2);return t};e.prototype._populateCornerStyles=function(e,t,i,r,o,n){var a=i.length;if(0<a){if(1===a)e[t+"_"+i[0]]=r;else if(2===a){e[t+"_"+i[0]]=o;e[t+"_"+i[1]]=n}if(0===t)0!==i[0]&&(e["1_0"]=o);else{6!==i[a-1]&&(e[t-1+"_6"]=n)}}};e.prototype._getWeekCornerStyles=function(e){var t={},i=e.length,r=this._findCornerIndexes(e[0]),o=this._findCornerIndexes(e[i-1]);this._populateCornerStyles(t,0,r,"ms-DatePicker-singleTopDate "+F.singleTopDate,"ms-DatePicker-topLeftCornerDate "+F.topLeftCornerDate,"ms-DatePicker-topRightCornerDate "+F.topRightCornerDate);this._populateCornerStyles(t,e.length-1,o,"ms-DatePicker-singleBottomDate "+F.singleBottomDate,"ms-DatePicker-bottomLeftCornerDate "+F.bottomLeftCornerDate,"ms-DatePicker-bottomRightCornerDate "+F.bottomRightCornerDate);return t};e.prototype._getHighlightedCornerStyle=function(e,t,i){return e[i+"_"+t]?e[i+"_"+t]:""};e.prototype._navigateMonthEdge=function(e,t,i,r){var o=this.props,n=o.minDate,a=o.maxDate,s=void 0;0===i&&38===e.which?s=M.addWeeks(t,-1):i===this.state.weeks.length-1&&40===e.which?s=M.addWeeks(t,1):0===r&&e.which===w.getRTLSafeKeyCode(37)?s=M.addDays(t,-1):6===r&&e.which===w.getRTLSafeKeyCode(39)&&(s=M.addDays(t,1));if(s&&(!n||M.compareDatePart(n,s)<1)&&(!a||M.compareDatePart(s,a)<1)){this.props.onNavigateDate(s,!0);e.preventDefault()}};e.prototype._getWeeks=function(e){for(var t=e.navigatedDate,i=e.selectedDate,r=e.dateRangeType,o=e.firstDayOfWeek,n=e.today,a=e.minDate,s=e.maxDate,l=e.showSixWeeksByDefault,d=e.workWeekDays,c=new Date(t.getFullYear(),t.getMonth(),1),u=n||new Date,p=[];c.getDay()!==o;)c.setDate(c.getDate()-1);var m=!1,h=M.getDateRangeArray(i,r,o,d);r!==E.DateRangeType.Day&&(h=this._getBoundedDateRange(h,a,s));for(var f=!0,g=0;f;g++){var y=[];m=!0;for(var v=0;v<7;v++){var _=new Date(c.toString()),b={key:c.toString(),date:c.getDate().toString(),originalDate:_,isInMonth:c.getMonth()===t.getMonth(),isToday:M.compareDates(u,c),isSelected:M.isInDateRangeArray(c,h),onSelected:this._onSelectDate.bind(this,_),isInBounds:(!a||M.compareDatePart(a,c)<1)&&(!s||M.compareDatePart(c,s)<1)};y.push(b);b.isInMonth&&(m=!1);c.setDate(c.getDate()+1)}(f=l?!m||g<=5:!m)&&p.push(y)}return p};e.prototype._getBoundedDateRange=function(e,t,i){var r=e.slice();t&&(r=r.filter(function(e){return 0<=M.compareDatePart(e,t)}));i&&(r=r.filter(function(e){return M.compareDatePart(e,i)<=0}));return r};return e}(w.BaseComponent);t.CalendarDay=o});define("Df",["require","exports","Dc","Dg","jP"],function(e,t,h,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function d(e,t){var i=new Date(e.getTime());i.setDate(i.getDate()+t);return i}t.addDays=d;t.addWeeks=function(e,t){return d(e,t*f.default.DaysInOneWeek)};function c(e,t){var i=new Date(e.getTime()),r=i.getMonth()+t;i.setMonth(r);i.getMonth()!==(r%f.default.MonthInOneYear+f.default.MonthInOneYear)%f.default.MonthInOneYear&&(i=d(i,-i.getDate()));return i}t.addMonths=c;t.addYears=function(e,t){var i=new Date(e.getTime());i.setFullYear(e.getFullYear()+t);i.getMonth()!==(e.getMonth()%f.default.MonthInOneYear+f.default.MonthInOneYear)%f.default.MonthInOneYear&&(i=d(i,-i.getDate()));return i};t.getMonthStart=function(e){return new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0)};t.getMonthEnd=function(e){return new Date(e.getFullYear(),e.getMonth()+1,0,0,0,0,0)};t.getYearStart=function(e){return new Date(e.getFullYear(),0,1,0,0,0,0)};t.getYearEnd=function(e){return new Date(e.getFullYear()+1,0,0,0,0,0,0)};t.setMonth=function(e,t){return c(e,t-e.getMonth())};function u(e,t){return!e&&!t||!(!e||!t)&&(e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate())}t.compareDates=u;t.compareDatePart=function(e,t){return i(e)-i(t)};t.getDateRangeArray=function(e,t,i,r){var o,n=new Array,a=null;r||(r=[h.DayOfWeek.Monday,h.DayOfWeek.Tuesday,h.DayOfWeek.Wednesday,h.DayOfWeek.Thursday,h.DayOfWeek.Friday]);switch(t){case h.DateRangeType.Day:a=d(o=p(e),1);break;case h.DateRangeType.Week:case h.DateRangeType.WorkWeek:a=d(o=function(e,t){var i=t-e.getDay();0<i&&(i-=f.default.DaysInOneWeek);return d(e,i)}(p(e),i),f.default.DaysInOneWeek);break;case h.DateRangeType.Month:a=c(o=new Date(e.getFullYear(),e.getMonth(),1),1);break;default:return l.assertNever(t)}var s=o;do{t!==h.DateRangeType.WorkWeek?n.push(s):r.includes(s.getDay())&&n.push(s);s=d(s,1)}while(!u(s,a));return n};t.isInDateRangeArray=function(e,t){for(var i=0,r=t;i<r.length;i++)if(u(e,r[i]))return!0;return!1};t.getWeekNumbersInMonth=function(e,t,i,r){var o,n,a=r.getFullYear(),s=r.getMonth(),l=1,d=new Date(a,s,l),c=l+(t+f.default.DaysInOneWeek-1)-(o=t,n=d.getDay(),o!==h.DayOfWeek.Sunday&&n<o?n+f.default.DaysInOneWeek:n),u=new Date(a,s,c);l=u.getDate();for(var p=[],m=0;m<e;m++){p.push(g(u,t,i));l+=f.default.DaysInOneWeek;u=new Date(a,s,l)}return p};function g(e,t,i){var r,o,n,a;switch(i){case h.FirstWeekOfYear.FirstFullWeek:return s(e,t,f.default.DaysInOneWeek);case h.FirstWeekOfYear.FirstFourDayWeek:return s(e,t,4);default:return o=t,n=m(r=e)-1,a=(r.getDay()-n%f.default.DaysInOneWeek-o+2*f.default.DaysInOneWeek)%f.default.DaysInOneWeek,Math.floor((n+a)/f.default.DaysInOneWeek+1)}}t.getWeekNumber=g;function p(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function i(e){return e.getDate()+(e.getMonth()<<5)+(e.getFullYear()<<9)}function s(e,t,i){var r=m(e)-1,o=e.getDay()-r%f.default.DaysInOneWeek,n=m(new Date(e.getFullYear()-1,h.MonthOfYear.December,31))-1,a=(t-o+2*f.default.DaysInOneWeek)%f.default.DaysInOneWeek;0!==a&&i<=a&&(a-=f.default.DaysInOneWeek);var s=r-a;if(s<0){0!==(a=(t-(o-=n%f.default.DaysInOneWeek)+2*f.default.DaysInOneWeek)%f.default.DaysInOneWeek)&&i<=a+1&&(a-=f.default.DaysInOneWeek);s=n-a}return Math.floor(s/f.default.DaysInOneWeek+1)}function m(e){for(var t=e.getMonth(),i=e.getFullYear(),r=0,o=0;o<t;o++)r+=new Date(i,o+1,0).getDate();return r+=e.getDate()}});define("Dg",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,DaysInOneWeek:7,MonthInOneYear:12}});define("Dk",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_ee70db24{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0}.picker_ee70db24{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px;position:relative}html[dir='ltr'] .picker_ee70db24{text-align:left}html[dir='rtl'] .picker_ee70db24{text-align:right}.holder_ee70db24{-webkit-overflow-scrolling:touch;-webkit-box-sizing:border-box;box-sizing:border-box;display:none}.picker_ee70db24.pickerIsOpened_ee70db24 .holder_ee70db24{-webkit-box-sizing:border-box;box-sizing:border-box;display:block}.pickerIsOpened_ee70db24{position:relative}.frame_ee70db24{padding:1px;position:relative}.wrap_ee70db24{margin:-1px;padding:9px;display:-webkit-box;display:-ms-flexbox;display:flex}.dayPicker_ee70db24{display:block}.header_ee70db24{position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:40px;line-height:44px}.monthAndYear_ee70db24,.year_ee70db24{display:inline-block;font-size:21px;font-weight:100;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin-top:-1px;font-weight:300;padding:0 5px}html[dir='ltr'] .monthAndYear_ee70db24{margin-left:5px}html[dir='rtl'] .monthAndYear_ee70db24{margin-right:5px}html[dir='ltr'] .year_ee70db24{margin-left:5px}html[dir='rtl'] .year_ee70db24{margin-right:5px}.table_ee70db24{text-align:center;border-collapse:collapse;border-spacing:0;table-layout:fixed;font-size:inherit;margin-top:10px}.table_ee70db24 td{margin:0;padding:0}.table_ee70db24 td:hover{outline:1px solid transparent}.day_ee70db24,.weekday_ee70db24{width:40px;height:40px;padding:0;line-height:40px;font-size:15px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box}.dayIsToday_ee70db24{position:relative;background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}@media screen and (-ms-high-contrast: active){.dayIsToday_ee70db24{border:1px solid WindowText}}.dayIsDisabled_ee70db24:before{border-top-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.dayIsUnfocused_ee70db24,.dayIsDisabled_ee70db24{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-weight:400}.dayIsFocused_ee70db24:hover,.dayIsUnfocused_ee70db24:hover{cursor:pointer;background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.day_ee70db24.dayIsHighlighted_ee70db24.dayIsFocused_ee70db24::-moz-focus-inner{border:0}.day_ee70db24.dayIsHighlighted_ee70db24.dayIsFocused_ee70db24{outline:transparent}.day_ee70db24.dayIsHighlighted_ee70db24.dayIsFocused_ee70db24{position:relative}.ms-Fabric--isFocusVisible .day_ee70db24.dayIsHighlighted_ee70db24.dayIsFocused_ee70db24:focus:after{content:'';position:absolute;top:1px;right:1px;bottom:1px;left:1px;pointer-events:none;border:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}@media screen and (-ms-high-contrast: active){.day_ee70db24.dayIsHighlighted_ee70db24.dayIsFocused_ee70db24::-moz-focus-inner{border:0}.day_ee70db24.dayIsHighlighted_ee70db24.dayIsFocused_ee70db24{outline:transparent}.day_ee70db24.dayIsHighlighted_ee70db24.dayIsFocused_ee70db24{position:relative}.ms-Fabric--isFocusVisible .day_ee70db24.dayIsHighlighted_ee70db24.dayIsFocused_ee70db24:focus:after{content:'';position:absolute;top:1px;right:1px;bottom:1px;left:1px;pointer-events:none;border:1px solid WindowText}}.dayIsHighlighted_ee70db24:hover,.pickerIsFocused_ee70db24 .dayIsHighlighted_ee70db24{cursor:pointer}@media screen and (-ms-high-contrast: active){.dayIsHighlighted_ee70db24:hover,.pickerIsFocused_ee70db24 .dayIsHighlighted_ee70db24{border:2px solid Highlight}}.dayIsUnfocused_ee70db24:active.day_ee70db24,.dayIsFocused_ee70db24:active.day_ee70db24,.dayIsHighlighted_ee70db24.day_ee70db24{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";background:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.dayIsHighlighted_ee70db24.dayDisabled_ee70db24,.dayIsHighlighted_ee70db24.dayDisabled_ee70db24:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.dayIsToday_ee70db24,.pickerIsFocused_ee70db24 .dayIsToday_ee70db24{position:relative;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-weight:600}.dayBackground_ee70db24,.weekBackground_ee70db24,.monthBackground_ee70db24{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.showWeekNumbers_ee70db24 .weekNumbers_ee70db24{position:absolute;margin-top:40px;border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;width:30px}.showWeekNumbers_ee70db24 .weekNumbers_ee70db24 .day_ee70db24{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.showWeekNumbers_ee70db24 .weekNumbers_ee70db24 .day_ee70db24.weekIsHighlighted_ee70db24{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.showWeekNumbers_ee70db24 .table_ee70db24:not(.weekNumbers_ee70db24){margin-left:30px}.showWeekNumbers_ee70db24 .table_ee70db24 .day_ee70db24,.showWeekNumbers_ee70db24 .table_ee70db24 .weekday_ee70db24{width:30px}.showWeekNumbersRTL_ee70db24 .weekNumbers_ee70db24{position:absolute;margin-top:40px;border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;width:30px}.showWeekNumbersRTL_ee70db24 .weekNumbers_ee70db24 .day_ee70db24{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.showWeekNumbersRTL_ee70db24 .weekNumbers_ee70db24 .day_ee70db24.weekIsHighlighted_ee70db24{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.showWeekNumbersRTL_ee70db24 .table_ee70db24:not(.weekNumbers_ee70db24){margin-right:30px}.showWeekNumbersRTL_ee70db24 .table_ee70db24 .day_ee70db24,.showWeekNumbersRTL_ee70db24 .table_ee70db24 .weekday_ee70db24{width:30px}.monthComponents_ee70db24,.yearComponents_ee70db24,.decadeComponents_ee70db24{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;margin-left:3px}.yearComponents_ee70db24{margin-left:3px}.prevMonth_ee70db24,.nextMonth_ee70db24,.prevYear_ee70db24,.nextYear_ee70db24,.prevDecade_ee70db24,.nextDecade_ee70db24{width:40px;height:40px;display:block;text-align:center;line-height:40px;text-align:center;font-size:16px;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";position:relative;top:2px;background-color:transparent;border:none;padding:0}.prevMonth_ee70db24:hover,.nextMonth_ee70db24:hover,.prevYear_ee70db24:hover,.nextYear_ee70db24:hover,.prevDecade_ee70db24:hover,.nextDecade_ee70db24:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";cursor:pointer;outline:1px solid transparent}.prevMonthIsDisabled_ee70db24,.nextMonthIsDisabled_ee70db24,.prevYearIsDisabled_ee70db24,.nextYearIsDisabled_ee70db24,.prevDecadeIsDisabled_ee70db24,.nextDecadeIsDisabled_ee70db24{visibility:hidden}.headerToggleView_ee70db24:hover{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";cursor:pointer}.currentYear_ee70db24,.currentDecade_ee70db24{display:block;padding:0 5px;font-size:21px;font-weight:100;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";height:40px;line-height:40px;font-weight:300}html[dir='ltr'] .currentYear_ee70db24,html[dir='ltr'] .currentDecade_ee70db24{margin-left:5px}html[dir='rtl'] .currentYear_ee70db24,html[dir='rtl'] .currentDecade_ee70db24{margin-right:5px}.optionGrid_ee70db24{position:relative;height:210px;width:280px;margin:12px 0 0 0}html[dir='rtl'] .optionGrid_ee70db24{margin:12px 0 0 0}.monthOption_ee70db24,.yearOption_ee70db24{width:60px;height:60px;line-height:60px;cursor:pointer;margin:0 10px 10px 0;font-size:13px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";text-align:center;border:none;padding:0;background-color:transparent}html[dir='ltr'] .monthOption_ee70db24,html[dir='ltr'] .yearOption_ee70db24{float:left}html[dir='rtl'] .monthOption_ee70db24,html[dir='rtl'] .yearOption_ee70db24{float:right}html[dir='rtl'] .monthOption_ee70db24,html[dir='rtl'] .yearOption_ee70db24{margin:0 0 10px 10px}.monthOption_ee70db24:hover,.yearOption_ee70db24:hover{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";outline:1px solid transparent}.monthOption_ee70db24.isHighlighted_ee70db24,.yearOption_ee70db24.isHighlighted_ee70db24{background-color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.monthOptionIsDisabled_ee70db24,.yearOptionIsDisabled_ee70db24{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";pointer-events:none}.goToday_ee70db24{bottom:9px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-size:12px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";height:30px;line-height:30px;padding:0 10px;background-color:transparent;border:none;position:absolute !important}[dir='ltr'] .goToday_ee70db24{right:13px}[dir='rtl'] .goToday_ee70db24{left:13px}.goToday_ee70db24:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";outline:1px solid transparent}.goToday_ee70db24:active{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.wrap_ee70db24.goTodaySpacing_ee70db24{margin-bottom:30px}.root_ee70db24.isPickingYears_ee70db24 .dayPicker_ee70db24,.root_ee70db24.isPickingYears_ee70db24 .monthComponents_ee70db24{display:none}.root_ee70db24.isPickingYears_ee70db24 .monthPicker_ee70db24{display:none}.root_ee70db24.isPickingYears_ee70db24 .yearPicker_ee70db24{display:block}@media (min-device-width: 460px){.wrap_ee70db24{padding:9px 8px}.dayPicker_ee70db24,.monthPicker_ee70db24{min-height:214px}.header_ee70db24{height:28px;line-height:28px}.day_ee70db24,.weekday_ee70db24{width:28px;height:28px;line-height:28px;font-size:12px}.prevMonth_ee70db24,.nextMonth_ee70db24,.prevYear_ee70db24,.nextYear_ee70db24,.prevDecade_ee70db24,.nextDecade_ee70db24{font-size:14px;width:24px;height:24px;line-height:24px}.holder_ee70db24{width:212px;height:auto}.monthAndYear_ee70db24,.year_ee70db24{font-size:17px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.yearComponents_ee70db24{margin-left:1px}.goToday_ee70db24{padding:0 3px}.showWeekNumbers_ee70db24 .weekNumbers_ee70db24{margin-top:28px;width:26px;margin-left:-7px}.showWeekNumbers_ee70db24 .table_ee70db24:not(.weekNumbers_ee70db24){margin-left:19px}.showWeekNumbers_ee70db24 .table_ee70db24 .day_ee70db24,.showWeekNumbers_ee70db24 .table_ee70db24 .weekday_ee70db24{width:26px}.showWeekNumbersRTL_ee70db24 .weekNumbers_ee70db24{margin-top:28px;width:26px;margin-right:-7px}.showWeekNumbersRTL_ee70db24 .table_ee70db24:not(.weekNumbers_ee70db24){margin-right:19px}.showWeekNumbersRTL_ee70db24 .table_ee70db24 .day_ee70db24,.showWeekNumbersRTL_ee70db24 .table_ee70db24 .weekday_ee70db24{width:26px}.monthPickerVisible_ee70db24 .wrap_ee70db24{padding:10px}.monthPickerVisible_ee70db24 .dayPicker_ee70db24{margin:-10px 0;padding:10px 0}.monthPickerVisible_ee70db24 .dayPicker_ee70db24{-webkit-box-sizing:border-box;box-sizing:border-box;width:212px;min-height:214px}html[dir='ltr'] .monthPickerVisible_ee70db24 .dayPicker_ee70db24{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir='rtl'] .monthPickerVisible_ee70db24 .dayPicker_ee70db24{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.monthPickerVisible_ee70db24 .monthPicker_ee70db24{display:block}.monthPickerVisible_ee70db24 .optionGrid_ee70db24{height:150px;width:212px}.monthPickerVisible_ee70db24 .toggleMonthView_ee70db24{display:none}.monthPickerVisible_ee70db24 .currentYear_ee70db24,.monthPickerVisible_ee70db24 .currentDecade_ee70db24{font-size:17px;margin:0;height:28px;line-height:26px;display:inline-block}.monthPickerVisible_ee70db24 .monthOption_ee70db24,.monthPickerVisible_ee70db24 .yearOption_ee70db24{width:40px;height:40px;line-height:40px;font-size:12px;margin:0 11px 11px 0}html[dir='rtl'] .monthPickerVisible_ee70db24 .monthOption_ee70db24,html[dir='rtl'] .monthPickerVisible_ee70db24 .yearOption_ee70db24{margin:0 0 11px 11px}.monthPickerVisible_ee70db24 .monthOption_ee70db24:hover,.monthPickerVisible_ee70db24 .yearOption_ee70db24:hover{outline:1px solid transparent}.monthPickerVisible_ee70db24 .monthOption_ee70db24:nth-child(4n+4),.monthPickerVisible_ee70db24 .yearOption_ee70db24:nth-child(4n+4){margin:0 0px 11px 0}html[dir='rtl'] .monthPickerVisible_ee70db24 .monthOption_ee70db24:nth-child(4n+4),html[dir='rtl'] .monthPickerVisible_ee70db24 .yearOption_ee70db24:nth-child(4n+4){margin:0 0 11px 0px}.monthPickerVisible_ee70db24 .goToday_ee70db24{-webkit-box-sizing:border-box;box-sizing:border-box;font-size:12px;height:28px;line-height:28px;padding:0 10px;top:199px}[dir='ltr'] .monthPickerVisible_ee70db24 .goToday_ee70db24{right:8px}[dir='rtl'] .monthPickerVisible_ee70db24 .goToday_ee70db24{left:8px}html[dir='ltr'] .monthPickerVisible_ee70db24 .goToday_ee70db24{text-align:right}html[dir='rtl'] .monthPickerVisible_ee70db24 .goToday_ee70db24{text-align:left}.monthPickerVisible_ee70db24 .wrap_ee70db24.goTodaySpacing_ee70db24{margin-bottom:0px}.monthPickerVisible_ee70db24 .root_ee70db24.isPickingYears_ee70db24 .dayPicker_ee70db24,.monthPickerVisible_ee70db24 .root_ee70db24.isPickingYears_ee70db24 .monthComponents_ee70db24{display:block}.monthPickerVisible_ee70db24 .root_ee70db24.isPickingYears_ee70db24 .monthPicker_ee70db24{display:none}.monthPickerVisible_ee70db24 .root_ee70db24.isPickingYears_ee70db24 .yearPicker_ee70db24{display:block}.calendarsInline_ee70db24 .wrap_ee70db24{padding:9px 12px}.calendarsInline_ee70db24 .holder_ee70db24{width:440px;height:auto}.calendarsInline_ee70db24 .table_ee70db24{margin-right:12px}.calendarsInline_ee70db24 .dayPicker_ee70db24{width:auto}.calendarsInline_ee70db24 .monthPicker_ee70db24{margin-left:13px}.calendarsInline_ee70db24 .goToday_ee70db24{padding:0 10px}[dir='ltr'] .calendarsInline_ee70db24 .goToday_ee70db24{right:13px}[dir='rtl'] .calendarsInline_ee70db24 .goToday_ee70db24{left:13px}.monthPickerOnly_ee70db24 .wrap_ee70db24{padding:10px}.monthPickerAsOverlay_ee70db24 .wrap_ee70db24{padding-top:4px;padding-bottom:4px}.monthPickerAsOverlay_ee70db24 .holder_ee70db24{height:240px;min-height:240px}.monthPickerAsOverlay_ee70db24 .holderWithButton_ee70db24{padding-top:6px;height:auto}}@media (max-device-width: 459px){.holder_ee70db24{width:300px}.calendarsInline_ee70db24 .monthPicker_ee70db24,.calendarsInline_ee70db24 .yearPicker_ee70db24{display:none}.yearComponents_ee70db24{margin-top:2px}}.wrap_ee70db24 span:focus::-moz-focus-inner,.wrap_ee70db24 div:focus::-moz-focus-inner{border:0}.wrap_ee70db24 span:focus,.wrap_ee70db24 div:focus{outline:transparent}.wrap_ee70db24 span:focus,.wrap_ee70db24 div:focus{position:relative}.ms-Fabric--isFocusVisible .wrap_ee70db24 span:focus:focus:after,.ms-Fabric--isFocusVisible .wrap_ee70db24 div:focus:focus:after{content:'';position:absolute;top:1px;right:1px;bottom:1px;left:1px;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.goToday_ee70db24{width:auto}.nextMonth_ee70db24,.prevMonth_ee70db24,.nextYear_ee70db24,.prevYear_ee70db24{display:inline-block}.nextMonth_ee70db24:hover,.prevMonth_ee70db24:hover,.nextYear_ee70db24:hover,.prevYear_ee70db24:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.nextMonth_ee70db24,.nextYear_ee70db24{margin-left:3px}.monthIsHighlighted_ee70db24{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.monthIsHighlighted_ee70db24.monthOption_ee70db24:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.monthIsCurrentMonth_ee70db24{font-weight:600;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.monthIsCurrentMonth_ee70db24.monthOption_ee70db24:hover{font-weight:600;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.monthOption_ee70db24:active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.topLeftCornerDate_ee70db24{border-radius:0}.topRightCornerDate_ee70db24{border-radius:0}.bottomLeftCornerDate_ee70db24{border-radius:0}.bottomRightCornerDate_ee70db24{border-radius:0}.singleTopDate_ee70db24{border-radius:0}.singleBottomDate_ee70db24{border-radius:0}\n"}]);t.root="root_ee70db24";t.picker="picker_ee70db24";t.holder="holder_ee70db24";t.pickerIsOpened="pickerIsOpened_ee70db24";t.frame="frame_ee70db24";t.wrap="wrap_ee70db24";t.dayPicker="dayPicker_ee70db24";t.header="header_ee70db24";t.monthAndYear="monthAndYear_ee70db24";t.year="year_ee70db24";t.table="table_ee70db24";t.day="day_ee70db24";t.weekday="weekday_ee70db24";t.dayIsToday="dayIsToday_ee70db24";t.dayIsDisabled="dayIsDisabled_ee70db24";t.dayIsUnfocused="dayIsUnfocused_ee70db24";t.dayIsFocused="dayIsFocused_ee70db24";t.dayIsHighlighted="dayIsHighlighted_ee70db24";t.pickerIsFocused="pickerIsFocused_ee70db24";t.dayDisabled="dayDisabled_ee70db24";t.dayBackground="dayBackground_ee70db24";t.weekBackground="weekBackground_ee70db24";t.monthBackground="monthBackground_ee70db24";t.showWeekNumbers="showWeekNumbers_ee70db24";t.weekNumbers="weekNumbers_ee70db24";t.weekIsHighlighted="weekIsHighlighted_ee70db24";t.showWeekNumbersRTL="showWeekNumbersRTL_ee70db24";t.monthComponents="monthComponents_ee70db24";t.yearComponents="yearComponents_ee70db24";t.decadeComponents="decadeComponents_ee70db24";t.prevMonth="prevMonth_ee70db24";t.nextMonth="nextMonth_ee70db24";t.prevYear="prevYear_ee70db24";t.nextYear="nextYear_ee70db24";t.prevDecade="prevDecade_ee70db24";t.nextDecade="nextDecade_ee70db24";t.prevMonthIsDisabled="prevMonthIsDisabled_ee70db24";t.nextMonthIsDisabled="nextMonthIsDisabled_ee70db24";t.prevYearIsDisabled="prevYearIsDisabled_ee70db24";t.nextYearIsDisabled="nextYearIsDisabled_ee70db24";t.prevDecadeIsDisabled="prevDecadeIsDisabled_ee70db24";t.nextDecadeIsDisabled="nextDecadeIsDisabled_ee70db24";t.headerToggleView="headerToggleView_ee70db24";t.currentYear="currentYear_ee70db24";t.currentDecade="currentDecade_ee70db24";t.optionGrid="optionGrid_ee70db24";t.monthOption="monthOption_ee70db24";t.yearOption="yearOption_ee70db24";t.isHighlighted="isHighlighted_ee70db24";t.monthOptionIsDisabled="monthOptionIsDisabled_ee70db24";t.yearOptionIsDisabled="yearOptionIsDisabled_ee70db24";t.goToday="goToday_ee70db24";t.goTodaySpacing="goTodaySpacing_ee70db24";t.isPickingYears="isPickingYears_ee70db24";t.monthPicker="monthPicker_ee70db24";t.yearPicker="yearPicker_ee70db24";t.monthPickerVisible="monthPickerVisible_ee70db24";t.toggleMonthView="toggleMonthView_ee70db24";t.calendarsInline="calendarsInline_ee70db24";t.monthPickerOnly="monthPickerOnly_ee70db24";t.monthPickerAsOverlay="monthPickerAsOverlay_ee70db24";t.holderWithButton="holderWithButton_ee70db24";t.monthIsHighlighted="monthIsHighlighted_ee70db24";t.monthIsCurrentMonth="monthIsCurrentMonth_ee70db24";t.topLeftCornerDate="topLeftCornerDate_ee70db24";t.topRightCornerDate="topRightCornerDate_ee70db24";t.bottomLeftCornerDate="bottomLeftCornerDate_ee70db24";t.bottomRightCornerDate="bottomRightCornerDate_ee70db24";t.singleTopDate="singleTopDate_ee70db24";t.singleBottomDate="singleBottomDate_ee70db24"});define("Dl",["require","exports","ap","at","jP","o7","Df","mo","Dk"],function(e,t,i,g,y,v,_,b,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=r,o=function(t){i.__extends(e,t);function e(e){var n=t.call(this,e)||this;n._onKeyDown=function(e,t){13!==t.which&&32!==t.which||e()};n._onSelectNextYear=function(){var e=n.props,t=e.navigatedDate;(0,e.onNavigateDate)(_.addYears(t,1),!1)};n._onSelectNextYearKeyDown=function(e){n._onKeyDown(n._onSelectNextYear,e)};n._onSelectPrevYear=function(){var e=n.props,t=e.navigatedDate;(0,e.onNavigateDate)(_.addYears(t,-1),!1)};n._onSelectPrevYearKeyDown=function(e){n._onKeyDown(n._onSelectPrevYear,e)};n._onSelectMonth=function(e){var t=n.props,i=t.navigatedDate,r=t.onNavigateDate,o=t.onHeaderSelect;o&&o(!0);r(_.setMonth(i,e),!0)};n._onHeaderSelect=function(){var e=n.props.onHeaderSelect;e&&e(!0)};n._onHeaderKeyDown=function(e){var t=n.props.onHeaderSelect;!t||13!==e.which&&32!==e.which||t(!0)};n._selectMonthCallbacks=[];e.strings.shortMonths.map(function(e,t){n._selectMonthCallbacks[t]=n._onSelectMonth.bind(n,t)});n._isCurrentMonth=n._isCurrentMonth.bind(n);n._onSelectNextYear=n._onSelectNextYear.bind(n);n._onSelectPrevYear=n._onSelectPrevYear.bind(n);n._onSelectMonth=n._onSelectMonth.bind(n);return n}e.prototype.render=function(){var e,t,s=this,i=this.props,l=i.navigatedDate,d=i.strings,c=i.today,u=i.highlightCurrentMonth,r=i.navigationIcons,p=i.dateTimeFormatter,m=i.minDate,h=i.maxDate,o=r.leftNavigation,n=r.rightNavigation,a=!m||_.compareDatePart(m,_.getYearStart(l))<0,f=!h||_.compareDatePart(_.getYearEnd(l),h)<0;return g.createElement("div",{className:y.css("ms-DatePicker-monthPicker",x.monthPicker)},g.createElement("div",{className:y.css("ms-DatePicker-yearComponents",x.yearComponents)},g.createElement("div",{className:y.css("ms-DatePicker-navContainer",x.navContainer)},g.createElement("button",{className:y.css("ms-DatePicker-prevYear js-prevYear",x.prevYear,(e={},e["ms-DatePicker-prevYear--disabled "+x.prevYearIsDisabled]=!a,e)),onClick:this._onSelectPrevYear,onKeyDown:this._onSelectPrevYearKeyDown,"aria-label":d.prevYearAriaLabel?d.prevYearAriaLabel+" "+p.formatYear(_.addYears(l,-1)):void 0,role:"button",tabIndex:0},g.createElement(b.Icon,{iconName:y.getRTL()?n:o})),g.createElement("button",{className:y.css("ms-DatePicker-nextYear js-nextYear",x.nextYear,(t={},t["ms-DatePicker-nextYear--disabled "+x.nextYearIsDisabled]=!f,t)),onClick:this._onSelectNextYear,onKeyDown:this._onSelectNextYearKeyDown,"aria-label":d.nextYearAriaLabel?d.nextYearAriaLabel+" "+p.formatYear(_.addYears(l,1)):void 0,role:"button",tabIndex:0},g.createElement(b.Icon,{iconName:y.getRTL()?o:n})))),g.createElement("div",{className:y.css("ms-DatePicker-header",x.header)},this.props.onHeaderSelect?g.createElement("div",{className:y.css("ms-DatePicker-currentYear js-showYearPicker",x.currentYear,x.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":p.formatYear(l),role:"button",tabIndex:0},p.formatYear(l)):g.createElement("div",{className:y.css("ms-DatePicker-currentYear js-showYearPicker",x.currentYear)},p.formatYear(l))),g.createElement(v.FocusZone,null,g.createElement("div",{className:y.css("ms-DatePicker-optionGrid",x.optionGrid),role:"grid"},d.shortMonths.map(function(e,t){var i,r=_.setMonth(l,t),o=s._isCurrentMonth(t,l.getFullYear(),c),n=l.getMonth()===t,a=(!m||_.compareDatePart(m,_.getMonthEnd(r))<1)&&(!h||_.compareDatePart(_.getMonthStart(r),h)<1);return g.createElement("button",{role:"gridcell",className:y.css("ms-DatePicker-monthOption",x.monthOption,(i={},i["ms-DatePicker-day--today "+x.monthIsCurrentMonth]=u&&o,i["ms-DatePicker-day--highlighted "+x.monthIsHighlighted]=u&&n,i["ms-DatePicker-monthOption--disabled "+x.monthOptionIsDisabled]=!a,i)),key:t,onClick:a?s._selectMonthCallbacks[t]:void 0,"aria-label":p.formatMonthYear(r,d),"aria-selected":o||n,"data-is-focusable":!!a||void 0,ref:n?"navigatedMonth":void 0},e)}))))};e.prototype.focus=function(){if(this.refs.navigatedMonth){this.refs.navigatedMonth.tabIndex=0;this.refs.navigatedMonth.focus()}};e.prototype._isCurrentMonth=function(e,t,i){return i.getFullYear()===t&&i.getMonth()===e};return e}(y.BaseComponent);t.CalendarMonth=o});define("Db",["require","exports","Dc"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DayOfWeek=i.DayOfWeek;t.FirstWeekOfYear=i.FirstWeekOfYear;t.DateRangeType=i.DateRangeType});define("De",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_e342de44{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0}.textField_e342de44{position:relative}.textField_e342de44 input::-ms-clear{display:none}.textField_e342de44 input[readonly]{cursor:pointer}.eventWithLabel_e342de44{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:16px;line-height:18px;pointer-events:none;position:absolute;bottom:5px}[dir='ltr'] .eventWithLabel_e342de44{right:9px}[dir='rtl'] .eventWithLabel_e342de44{left:9px}.eventWithLabel_e342de44:not(.msDatePickerDisabled_e342de44){pointer-events:initial;cursor:pointer}.eventWithoutLabel_e342de44{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:16px;line-height:18px;pointer-events:none;position:absolute;top:7px}[dir='ltr'] .eventWithoutLabel_e342de44{right:9px}[dir='rtl'] .eventWithoutLabel_e342de44{left:9px}.eventWithoutLabel_e342de44:not(.msDatePickerDisabled_e342de44){pointer-events:initial;cursor:pointer}\n"}]);t.root="root_e342de44";t.textField="textField_e342de44";t.eventWithLabel="eventWithLabel_e342de44";t.msDatePickerDisabled="msDatePickerDisabled_e342de44";t.eventWithoutLabel="eventWithoutLabel_e342de44"});define("C8",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ExpirationDatePicker{margin-top:4px}.od-ExpirationDatePicker .ms-DatePicker{display:inline-block;vertical-align:top;margin-bottom:0;width:200px}[dir=ltr] .od-ExpirationDatePicker .ms-DatePicker{margin-left:8px}[dir=rtl] .od-ExpirationDatePicker .ms-DatePicker{margin-right:8px}.od-ExpirationDatePicker .ms-DatePicker i{display:none}.od-ExpirationDatePicker .ms-DatePicker .ms-TextField{margin-bottom:0}.od-ExpirationDatePicker .ms-DatePicker .ms-TextField input::-webkit-input-placeholder{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px}.od-ExpirationDatePicker .ms-DatePicker .ms-TextField div{border-color:transparent}.od-ExpirationDatePicker .ms-TextField-field{border-bottom:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";padding:0;height:28px;min-width:0}.od-ExpirationDatePicker .ms-Icon{font-size:20px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-top:4px}.od-ExpirationDatePicker .od-ExpirationDatePicker-label{display:inline-block;margin-top:7px}"}])});define("BK",["require","exports","V","at","mh","hb","BD"],function(e,t,n,g,y,v,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getExternalPeopleCount=function(e){return e&&0!==e.length?e.filter(function(e){return 1===e.entityType}).length:0};t.getOversharingExternalsWarning=function(e,t){var i=e.filter(function(e){return 1===e.entityType}),r=i.length,o=i.map(function(e){return e.name});if(2===r){var n=(a=o.join(", ")).lastIndexOf(",");return a.substring(0,n)+" "+t.and+" "+a.substring(n+1)+" "+t.outsideOfYourOrgPlural}if(2<r){var a;n=(a=o.join(", ")).lastIndexOf(",");return a.substring(0,n+1)+" "+t.and+" "+a.substring(n+1)+" "+t.outsideOfYourOrgPlural}return 1===r?o[0]+" "+t.outsideOfYourOrgSingular:""};t.getOversharingGroupsWarning=function(e,t,i){var r=e.filter(function(e){return 2===e.entityType}).length,o="";1===r?o=i.oneGroupInvited:1<r&&(o=n.format(i.multipleGroupsInvited,r));1e3<=t?o+=" "+i.groupsMemberCountLargeLabel:25<=t&&(o+=" "+n.format(i.groupsMemberCountLabel,t));return o};t.renderPickerError=function(e){for(var t=e.selectedItems,i=e.sharingLinkKind,r=e.canAddExternalPrincipal,o=e.sharingInformation,n=e.viewPolicyTipCallback,a=e.strings,s=e.permissionsMap,l=g.createElement("div",null,g.createElement("span",null,a.ptErrorMessage," "),g.createElement(y.Link,{onClick:n},a.ptViewPolicyTipLabel)),d=o.item.hasDlpPolicy||o.sharingAbilities&&7===o.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason,c=0,u=t;c<u.length;c++){var p=u[c];if(!p.isResolved)return d&&!r?l:p.rawData?p.rawData.Description:g.createElement("span",null,a.noExactMatch);if(p.isExternal&&d&&!r)return l;if(p.isExternal&&p.principalType===v.default.distributionList&&2===p.entityType)return g.createElement("span",null,_.default.peoplePickerErrorDLNotSupported);var m=3===i||2===i;if(p.isExternal&&m)return g.createElement("span",null,a.peoplePickerErrorCsl)}if(s&&1===i){var h=0;for(var f in s)1===s[f]&&h++;if(1===h)return g.createElement("span",null,a.insufficientPermissionsError);if(1<h)return g.createElement("span",null,a.insufficientPermissionsErrorPlural)}return null}});define("BE",["require","exports","Bs"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharingAbilitiesAudience=function(e){return"anonymousLinkAbilities"===e?i.SharingAudience.anyone:"organizationLinkAbilities"===e?i.SharingAudience.organization:"peopleSharingLinkAbilities"===e?i.SharingAudience.specificPeopleFlex:void 0};function r(e,t){return e===i.SharingAudience.anyone?t.anonymousLinkAbilities:e===i.SharingAudience.organization?t.organizationLinkAbilities:e===i.SharingAudience.specificPeopleFlex?t.peopleSharingLinkAbilities:t.directSharingAbilities}t.getSharingAbilitiesByAudience=r;t.isEditingAllowed=function(e,t){var i=r(e,t);return!i.canManageEditLink||i.canManageEditLink.enabled}});define("Co",["require","exports","ap","jP","x6","Cq","Bs","at","j8","aC","V","BJ","BB","Cp"],function(e,t,o,i,n,a,s,l,d,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PeoplePickerGraph={ODB:387};var r=function(r){o.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._strings=t.strings;i._peoplePickerProvider=t.peoplePickerProvider;i._resize=t.resize;i._externalUsersAllowed=i._computeAllowExternalUsers();i.state={message:"",selectedItems:e.defaultSelectedItems,searchForMoreText:i._getSearchForMoreText(e.sharingInformation.isGraphAvailable)};return i}e.prototype.componentWillReceiveProps=function(e){var t=e.defaultSelectedItems;this.setState({selectedItems:t})};e.prototype.componentDidUpdate=function(e){this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;null!==this.props.error&&null===e.error&&this._resize()};e.prototype.componentDidMount=function(){this._peoplePickerControl&&!p.isMobile(this.props.clientId)&&this._peoplePickerControl.focusInput()};e.prototype.render=function(){var t=this,e=this._strings,i={placeholder:this._computePlaceholderText(),onFocus:function(e){t._onFocus()},"aria-label":this._strings.selectedItemListLabel},r=this.props.pickerSettings,o={principalSource:r.PrincipalSource,principalType:this._convertPrincipalType(r.PrincipalAccountType),querySettings:r.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0,useGraph:!0,onToggleGetMoreResults:this._onToggleGetMoreResults},n=this.props.error?"od-Share-PeoplePicker ms-Share-PeoplePicker--error":"od-Share-PeoplePicker";return l.createElement("div",{className:"od-Share-PeoplePicker-wrapper",ref:function(e){t._peoplePicker=e}},l.createElement(a.PeoplePicker,{ref:this._resolveRef("_peoplePickerControl"),className:n,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:i,loadingText:e.loadingLabel,noResultsFoundText:e.noResultsLabel,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:o,suggestionsClassName:"od-Share-PeoplePicker-Suggestions",onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,onResolvedSuggestions:this._onResolvedSuggestions,itemLimit:100,onInputChange:this._onInputChange,onGetMoreResults:this._onGetMoreResults,searchForMoreText:this.state.searchForMoreText}),this._renderError(),this._renderWarnings(),l.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},this.props.error),l.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},this.state.message))};e.prototype._onInputChange=function(e){var t=/<.*>/g.exec(e);if(t&&t[0])return t[0].substring(1,t[0].length-1);var i=/['"].*['"]/g.exec(e);return i&&i[0]?i[0].substring(1,i[0].length-1):e};e.prototype._onGetMoreResults=function(e){var t=this.props.pickerSettings,i={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};return this._peoplePickerProvider.sharePointSearch(e,i)};e.prototype._onSuggestionSelected=function(e){var t=this.props.pickerSettings,i={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};this.setState({message:""});if(!1===e.isExternal||e.isExternal&&e.providerName)return e;if(e.principalType===s.PrincipalType.distributionList){i.isGraphDistributionList=!0;i.useGraph=!0}return this._peoplePickerProvider.resolve(e.userId,i).then(function(e){!e.email&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);return e})};e.prototype._onRenderItem=function(e){var t=this.props.permissionsMap,i=e.item.isExternal&&!this._externalUsersAllowed||1===this.props.sharingLinkKind&&t&&void 0!==t[e.item.email]&&1===t[e.item.email]||!e.item.isResolved,r=e.item.name;e.removeButtonAriaLabel=u.format(this._strings.removePersonLabel,r);e.item.imageAlt=u.format(this._strings.userPhotoAriaLabel,r);return i?l.createElement("div",{className:"od-Share-PeoplePicker-selectedItem--error"},l.createElement(a.SelectedItemDefault,o.__assign({},e))):l.createElement(a.SelectedItemDefault,o.__assign({},e))};e.prototype._computePlaceholderText=function(){var e=this._strings;return 0===this.props.defaultSelectedItems.length?e.peoplePickerPlaceholder:e.peoplePickerPlaceholderWithSelection};e.prototype._convertPrincipalType=function(e){if(!e)return s.PrincipalType.none;for(var t=s.PrincipalType.none,i=0,r=e.split(",");i<r.length;i++){var o=r[i];"User"===o&&(t|=s.PrincipalType.user);"DL"===o&&(t|=s.PrincipalType.distributionList);"SecGroup"===o&&(t|=s.PrincipalType.securityGroup);"SPGroup"===o&&(t|=s.PrincipalType.sharePointGroup)}return t};e.prototype._computeAllowExternalUsers=function(){var e=this.props.sharingLinkKind;return 2!==e&&3!==e&&this.props.sharingInformation.canAddExternalPrincipal};e.prototype._renderError=function(){var e=this.props.error;if(e){this._peoplePickerControl&&!p.isMobile(this.props.clientId)&&this._peoplePickerControl.focusInput();return l.createElement("span",{className:"od-Share-PeoplePicker-error",role:"alert","aria-live":"assertive"},e)}};e.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,i=[];if(!this.props.error){100===this.state.selectedItems.length&&i.push(l.createElement(n.MessageBar,null,this._strings.peoplePickerLimitMessage));e&&i.push(l.createElement(n.MessageBar,null,e));t&&i.push(l.createElement(n.MessageBar,null,t));return 0<i.length?l.createElement("div",{className:"od-Share-PeoplePicker-warning"},i):void 0}};e.prototype._getSearchForMoreText=function(e){return e?this._strings.searchForMoreText:void 0};e.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})};e.prototype._onResolvedSuggestions=function(e,t){this.setState({message:this._strings.suggestionsAvailableAlertText});return c.default.resolve(e)};e.prototype._onFocus=function(){m.peoplePickerFocused()};e.contextTypes={peoplePickerProvider:d.object.isRequired,strings:d.object.isRequired,resize:d.func.isRequired};o.__decorate([i.autobind],e.prototype,"_onInputChange",null);o.__decorate([i.autobind],e.prototype,"_onGetMoreResults",null);o.__decorate([i.autobind],e.prototype,"_onSuggestionSelected",null);o.__decorate([i.autobind],e.prototype,"_onRenderItem",null);o.__decorate([i.autobind],e.prototype,"_getSearchForMoreText",null);o.__decorate([i.autobind],e.prototype,"_onToggleGetMoreResults",null);o.__decorate([i.autobind],e.prototype,"_onResolvedSuggestions",null);o.__decorate([i.autobind],e.prototype,"_onFocus",null);return e}(i.BaseComponent);t.default=r});define("Cq",["require","exports","ap","Cr"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Cr",["require","exports","ap","Cv","Cu","Cs"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t)});define("Cv",["require","exports","ap","at","jP","CC","Cx","hb","Cs","Cu","Cw"],function(e,t,_,b,r,i,o,n,x,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=i.BasePicker,P=i.BasePickerListBelow,a=function(i){_.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._dataProvider=e.dataProvider||new o.PeoplePickerProvider({pageContext:e.context,peoplePickerDataSource:e.dataSource});t.state={hasUnresolvedText:!1};return t}Object.defineProperty(e.prototype,"selectedPeople",{get:function(){return this._peoplePicker?this._peoplePicker.items:[]},enumerable:!0,configurable:!0});e.prototype.render=function(){var e=this.props,t=e.className,i=e.onRenderItem,r=e.onRenderSuggestionsItem,o=e.defaultSelectedItems,n=e.onSelectedPersonasChange,a=e.suggestionsHeaderText,s=e.suggestionsClassName,l=e.noResultsFoundText,d=e.loadingText,c=e.inputProps,u=e.onSuggestionSelected,p=e.suggestionsAvailableAlertText,m=e.selectedItems,h=e.itemLimit,f=e.onInputChange,g=e.onGetMoreResults,y=e.searchForMoreText,v={className:t,onRenderSuggestionsItem:r||x.SuggestionItemDefault,onResolveSuggestions:this._onResolveSuggestions,getTextFromItem:this._getSuggestionStringFromPerson,defaultSelectedItems:o,selectedItems:m,onChange:n,inputProps:c,pickerSuggestionsProps:{suggestionsHeaderText:a,loadingText:d,noResultsFoundText:l,className:s,suggestionsAvailableAlertText:p,searchForMoreText:y},onItemSelected:u,itemLimit:h,onInputChange:f,onGetMoreResults:g};switch(this.props.peoplePickerType){case S.PeoplePickerType.listBelow:v.onRenderItem=i||x.SelectedItemBelowDefault;return b.createElement(P,_.__assign({},v,{ref:this._resolveRef("_peoplePicker")}));default:v.onRenderItem=i||x.SelectedItemDefault;return b.createElement(C,_.__assign({},v,{ref:this._resolveRef("_peoplePicker")}))}};e.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()};e.prototype._getSuggestionStringFromPerson=function(e,t){return t?e.name&&0===e.name.toLowerCase().indexOf(t.toLowerCase())?e.name:e.email&&0===e.email.toLowerCase().indexOf(t.toLowerCase())?e.email:"":e.name};e.prototype._onResolveSuggestions=function(t){var i=this;if(this._peoplePickerSearchPromise){this._peoplePickerSearchPromise.cancel();this._peoplePickerSearchPromise=void 0}if(t.length<2)return this.props.onResolvedSuggestions?this.props.onResolvedSuggestions([],t):[];var e=this._dataProvider.search(t.trim(),this._getPeoplePickerQueryParams());if(!e)return this.props.onResolvedSuggestions?this.props.onResolvedSuggestions([],t):[];var r=e.cached?e.cached:[];this._peoplePickerSearchPromise=e.promise;return this._peoplePickerSearchPromise.then(function(e){i._peoplePickerSearchPromise=void 0;return e?r.concat(e):[]}).then(function(e){return i.props.onResolvedSuggestions?i.props.onResolvedSuggestions(e,t):e})};e.prototype._getPeoplePickerQueryParams=function(){return this.props.peoplePickerQueryParams?this.props.peoplePickerQueryParams:{allowEmailAddresses:!1,allowMultipleEntities:null,allUrlZones:null,enabledClaimProviders:null,forceClaims:null,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:n.default.user|n.default.securityGroup|n.default.sharePointGroup,required:null,urlZone:null,urlZoneSpecified:null}};_.__decorate([r.autobind],e.prototype,"_onResolveSuggestions",null);return e}(r.BaseComponent);t.PeoplePicker=a;t.default=a});define("CC",["require","exports","ap","CD"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("CD",["require","exports","ap","CT","CS","CR","CN","CM","CH","CG","CE"],function(e,t,i,r,o,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t);i.__exportStar(d,t);i.__exportStar(c,t)});define("CT",["require","exports","ap","at","jP","wN","o1","CU"],function(e,t,i,I,T,w,E,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var D,A=r;!function(e){e[e.none=0]="none";e[e.forceResolve=1]="forceResolve";e[e.searchMore=2]="searchMore"}(D=t.SuggestionActionType||(t.SuggestionActionType={}));var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,i=t.suggestionModel,r=t.RenderSuggestion,o=t.onClick,n=t.className,a=t.onRemoveItem,s=t.isSelectedOverride,l=t.removeButtonAriaLabel;return I.createElement("div",{className:T.css("ms-Suggestions-item",A.suggestionsItem,(e={},e["is-suggested "+A.suggestionsItemIsSuggested]=i.selected||s,e),n)},I.createElement(w.CommandButton,{onClick:o,className:T.css("ms-Suggestions-itemButton",A.itemButton)},r(i.item,this.props)),this.props.showRemoveButton?I.createElement(w.IconButton,{iconProps:{iconName:"Cancel",style:{fontSize:"12px"}},title:l,ariaLabel:l,onClick:a,className:T.css("ms-Suggestions-closeButton",A.closeButton)}):null)};return t}(T.BaseComponent);t.SuggestionsItem=o;var n=function(t){i.__extends(e,t);function e(e){var a=t.call(this,e)||this;a._forceResolveButton=T.createRef();a._searchForMoreButton=T.createRef();a._selectedElement=T.createRef();a.SuggestionsItemOfProperType=o;a.tryHandleKeyDown=function(e,t){var i=!1,r=null,o=a.state.selectedActionType,n=a.props.suggestions.length;if(40===e)switch(o){case D.forceResolve:if(0<n){a._refocusOnSuggestions(e);r=D.none}else r=a._searchForMoreButton.current?D.searchMore:D.forceResolve;break;case D.searchMore:if(a._forceResolveButton.current)r=D.forceResolve;else if(0<n){a._refocusOnSuggestions(e);r=D.none}else r=D.searchMore;break;case D.none:-1===t&&a._forceResolveButton.current&&(r=D.forceResolve)}else if(38===e)switch(o){case D.forceResolve:if(a._searchForMoreButton.current)r=D.searchMore;else if(0<n){a._refocusOnSuggestions(e);r=D.none}break;case D.searchMore:if(0<n){a._refocusOnSuggestions(e);r=D.none}else a._forceResolveButton.current&&(r=D.forceResolve);break;case D.none:-1===t&&a._searchForMoreButton.current&&(r=D.searchMore)}if(null!==r){a.setState({selectedActionType:r});i=!0}return i};a._getMoreResults=function(){a.props.onGetMoreResults&&a.props.onGetMoreResults()};a._forceResolve=function(){a.props.createGenericItem&&a.props.createGenericItem()};a._shouldShowForceResolve=function(){return!!a.props.showForceResolve&&a.props.showForceResolve()};a._onClickTypedSuggestionsItem=function(t,i){return function(e){a.props.onSuggestionClick(e,t,i)}};a._refocusOnSuggestions=function(e){"function"==typeof a.props.refocusSuggestions&&a.props.refocusSuggestions(e)};a._onRemoveTypedSuggestionsItem=function(t,i){return function(e){(0,a.props.onSuggestionRemove)(e,t,i);e.stopPropagation()}};a.state={selectedActionType:D.none};return a}e.prototype.componentDidMount=function(){this.scrollSelected();this.activeSelectedElement=this._selectedElement?this._selectedElement.current:null};e.prototype.componentDidUpdate=function(){if(this.activeSelectedElement&&this._selectedElement.current&&this.activeSelectedElement!==this._selectedElement.current){this.scrollSelected();this.activeSelectedElement=this._selectedElement.current}};e.prototype.render=function(){var e=this.props,t=e.forceResolveText,i=e.mostRecentlyUsedHeaderText,r=e.searchForMoreText,o=e.className,n=e.moreSuggestionsAvailable,a=e.noResultsFoundText,s=e.suggestions,l=e.isLoading,d=e.isSearching,c=e.loadingText,u=e.onRenderNoResultFound,p=e.searchingText,m=e.isMostRecentlyUsedVisible,h=e.resultsMaximumNumber,f=e.resultsFooterFull,g=e.resultsFooter,y=e.isResultsFooterVisible,v=void 0===y||y,_=e.suggestionsAvailableAlertText,b=function(){return a?I.createElement("div",{role:"alert",className:T.css("ms-Suggestions-none",A.suggestionsNone)},a):null},x=e.suggestionsHeaderText;m&&i&&(x=i);var S=void 0;v&&(S=s.length>=h?f:g);var C,P,k=!(s&&s.length||l);return I.createElement("div",{className:T.css("ms-Suggestions",o||"",A.root)},x?I.createElement("div",{className:T.css("ms-Suggestions-title",A.suggestionsTitle)},x):null,t&&this._shouldShowForceResolve()&&I.createElement(w.CommandButton,{componentRef:this._forceResolveButton,className:T.css("ms-forceResolve-button",A.actionButton,(C={},C["is-selected "+A.buttonSelected]=this.state.selectedActionType===D.forceResolve,C)),onClick:this._forceResolve},t),l&&I.createElement(E.Spinner,{className:T.css("ms-Suggestions-spinner",A.suggestionsSpinner),label:c}),k?u?u(void 0,b):b():this._renderSuggestions(),r&&n&&I.createElement(w.CommandButton,{componentRef:this._searchForMoreButton,className:T.css("ms-SearchMore-button",A.actionButton,(P={},P["is-selected "+A.buttonSelected]=this.state.selectedActionType===D.searchMore,P)),iconProps:{iconName:"Search"},onClick:this._getMoreResults},r),d?I.createElement(E.Spinner,{className:T.css("ms-Suggestions-spinner",A.suggestionsSpinner),label:p}):null,!S||n||m||d?null:I.createElement("div",{className:T.css("ms-Suggestions-title",A.suggestionsTitle)},S(this.props)),!l&&!d&&s&&0<s.length&&_?I.createElement("span",{role:"alert",className:T.css("ms-Suggestions-suggestionsAvailable",A.suggestionsAvailable)},_):null)};e.prototype.hasSuggestedAction=function(){return void 0!==this._searchForMoreButton.current||void 0!==this._forceResolveButton.current};e.prototype.hasSuggestedActionSelected=function(){return this.state.selectedActionType!==D.none};e.prototype.executeSelectedAction=function(){switch(this.state.selectedActionType){case D.forceResolve:this._forceResolve();break;case D.searchMore:this._getMoreResults()}};e.prototype.focusAboveSuggestions=function(){this._forceResolveButton.current?this.setState({selectedActionType:D.forceResolve}):this._searchForMoreButton.current&&this.setState({selectedActionType:D.searchMore})};e.prototype.focusBelowSuggestions=function(){this._searchForMoreButton.current?this.setState({selectedActionType:D.searchMore}):this._forceResolveButton.current&&this.setState({selectedActionType:D.forceResolve})};e.prototype.focusSearchForMoreButton=function(){this._searchForMoreButton.current&&this._searchForMoreButton.current.focus()};e.prototype.scrollSelected=function(){this._selectedElement.current&&void 0!==this._selectedElement.current.scrollIntoView&&this._selectedElement.current.scrollIntoView(!1)};e.prototype._renderSuggestions=function(){var i=this,e=this.props,r=e.onRenderSuggestion,o=e.removeSuggestionAriaLabel,n=e.suggestionsItemClassName,t=e.resultsMaximumNumber,a=e.showRemoveButtons,s=e.suggestionsContainerAriaLabel,l=this.props.suggestions,d=this.SuggestionsItemOfProperType;t&&(l=l.slice(0,t));return I.createElement("div",{className:T.css("ms-Suggestions-container",A.suggestionsContainer),id:"suggestion-list",role:"list","aria-label":s},l.map(function(e,t){return I.createElement("div",{ref:e.selected?i._selectedElement:"",key:e.item.key?e.item.key:t,id:"sug-"+t,role:"listitem","aria-label":e.ariaLabel},I.createElement(d,{id:"sug-item"+t,suggestionModel:e,RenderSuggestion:r,onClick:i._onClickTypedSuggestionsItem(e.item,t),className:n,showRemoveButton:a,removeButtonAriaLabel:o,onRemoveItem:i._onRemoveTypedSuggestionsItem(e.item,t)}))}))};return e}(T.BaseComponent);t.Suggestions=n});define("CU",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_912a1522{min-width:260px}.suggestionsItem_912a1522{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;position:relative}.suggestionsItem_912a1522:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.suggestionsItem_912a1522:hover .closeButton_912a1522{display:block}.suggestionsItem_912a1522.suggestionsItemIsSuggested_912a1522{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.suggestionsItem_912a1522.suggestionsItemIsSuggested_912a1522:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}@media screen and (-ms-high-contrast: active){.suggestionsItem_912a1522.suggestionsItemIsSuggested_912a1522:hover{background:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast: active){.suggestionsItem_912a1522.suggestionsItemIsSuggested_912a1522{background:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}}.suggestionsItem_912a1522.suggestionsItemIsSuggested_912a1522 .closeButton_912a1522:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}@media screen and (-ms-high-contrast: active){.suggestionsItem_912a1522.suggestionsItemIsSuggested_912a1522 .itemButton_912a1522{color:HighlightText}}.suggestionsItem_912a1522 .closeButton_912a1522{display:none;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.suggestionsItem_912a1522 .closeButton_912a1522:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.actionButton_912a1522{background:none;border:0;cursor:pointer;margin:0;position:relative;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:40px;width:100%;font-size:12px}[dir='ltr'] .actionButton_912a1522{padding-left:8px}[dir='rtl'] .actionButton_912a1522{padding-right:8px}[dir='ltr'] .actionButton_912a1522{text-align:left}[dir='rtl'] .actionButton_912a1522{text-align:right}.actionButton_912a1522:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";cursor:pointer}.actionButton_912a1522:focus,.actionButton_912a1522:active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.actionButton_912a1522 .ms-Button-icon{font-size:16px;width:25px}.actionButton_912a1522 .ms-Button-label{margin:0 4px 0 9px}html[dir='rtl'] .actionButton_912a1522 .ms-Button-label{margin:0 9px 0 4px}.buttonSelected_912a1522{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.suggestionsTitle_912a1522{padding:0 12px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px;line-height:40px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.suggestionsContainer_912a1522{overflow-y:auto;overflow-x:hidden;max-height:300px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.suggestionsNone_912a1522{text-align:center;color:"},{theme:"info",defaultValue:"#666666"},{rawString:";font-size:12px;line-height:30px}.suggestionsSpinner_912a1522{margin:5px 0;white-space:nowrap;line-height:20px;font-size:12px}html[dir='ltr'] .suggestionsSpinner_912a1522{padding-left:14px}html[dir='rtl'] .suggestionsSpinner_912a1522{padding-right:14px}html[dir='ltr'] .suggestionsSpinner_912a1522{text-align:left}html[dir='rtl'] .suggestionsSpinner_912a1522{text-align:right}.suggestionsSpinner_912a1522 .ms-Spinner-circle{display:inline-block;vertical-align:middle}.suggestionsSpinner_912a1522 .ms-Spinner-label{display:inline-block;margin:0px 10px 0 16px;vertical-align:middle}html[dir='rtl'] .suggestionsSpinner_912a1522 .ms-Spinner-label{margin:0px 16px 0 10px}.itemButton_912a1522.itemButton_912a1522{width:100%;height:100%;padding:7px 12px}@media screen and (-ms-high-contrast: active){.itemButton_912a1522.itemButton_912a1522{color:WindowText}}.closeButton_912a1522.closeButton_912a1522{padding:0 4px;height:auto;width:32px}@media screen and (-ms-high-contrast: active){.closeButton_912a1522.closeButton_912a1522{color:WindowText}}.closeButton_912a1522.closeButton_912a1522:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.suggestionsAvailable_912a1522{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);t.root="root_912a1522";t.suggestionsItem="suggestionsItem_912a1522";t.closeButton="closeButton_912a1522";t.suggestionsItemIsSuggested="suggestionsItemIsSuggested_912a1522";t.itemButton="itemButton_912a1522";t.actionButton="actionButton_912a1522";t.buttonSelected="buttonSelected_912a1522";t.suggestionsTitle="suggestionsTitle_912a1522";t.suggestionsContainer="suggestionsContainer_912a1522";t.suggestionsNone="suggestionsNone_912a1522";t.suggestionsSpinner="suggestionsSpinner_912a1522";t.suggestionsAvailable="suggestionsAvailable_912a1522"});define("CS",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){var t=this;this._isSuggestionModel=function(e){return void 0!==e.item};this._ensureSuggestionModel=function(e){return t._isSuggestionModel(e)?e:{item:e,selected:!1,ariaLabel:e.name||e.primaryText}};this.suggestions=[];this.currentIndex=-1}e.prototype.updateSuggestions=function(e,t){if(e&&0<e.length){this.suggestions=this.convertSuggestionsToSuggestionItems(e);if(void(this.currentIndex=0)!==t){this.suggestions[t].selected=!0;this.currentSuggestion=this.suggestions[t]}}else{this.suggestions=[];this.currentIndex=-1;this.currentSuggestion=void 0}};e.prototype.nextSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex<this.suggestions.length-1){this.setSelectedSuggestion(this.currentIndex+1);return!0}if(this.currentIndex===this.suggestions.length-1){this.setSelectedSuggestion(0);return!0}}return!1};e.prototype.previousSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(0<this.currentIndex){this.setSelectedSuggestion(this.currentIndex-1);return!0}if(0===this.currentIndex){this.setSelectedSuggestion(this.suggestions.length-1);return!0}}return!1};e.prototype.getSuggestions=function(){return this.suggestions};e.prototype.getCurrentItem=function(){return this.currentSuggestion};e.prototype.getSuggestionAtIndex=function(e){return this.suggestions[e]};e.prototype.hasSelectedSuggestion=function(){return!!this.currentSuggestion};e.prototype.removeSuggestion=function(e){this.suggestions.splice(e,1)};e.prototype.createGenericSuggestion=function(e){var t=this.convertSuggestionsToSuggestionItems([e])[0];this.currentSuggestion=t};e.prototype.convertSuggestionsToSuggestionItems=function(e){return Array.isArray(e)?e.map(this._ensureSuggestionModel):[]};e.prototype.deselectAllSuggestions=function(){if(-1<this.currentIndex){this.suggestions[this.currentIndex].selected=!1;this.currentIndex=-1}};e.prototype.setSelectedSuggestion=function(e){if(e>this.suggestions.length-1||e<0){this.currentIndex=0;this.currentSuggestion.selected=!1;this.currentSuggestion=this.suggestions[0];this.currentSuggestion.selected=!0}else{-1<this.currentIndex&&(this.suggestions[this.currentIndex].selected=!1);this.suggestions[e].selected=!0;this.currentIndex=e;this.currentSuggestion=this.suggestions[e]}};return e}();t.SuggestionsController=i});define("CR",["require","exports","ap","CQ"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("CN",["require","exports","ap","at","jP","o7","wE","px","CT","CS","CM","CP","CO"],function(e,t,d,c,u,p,r,m,o,a,n,h,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i,s=function(i){d.__extends(e,i);function e(e){var n=i.call(this,e)||this;n.root=u.createRef();n.input=u.createRef();n.focusZone=u.createRef();n.suggestionElement=u.createRef();n.SuggestionOfProperType=o.Suggestions;n.dismissSuggestions=function(e){var t=function(){n.props.onDismiss&&n.props.onDismiss(e,n.suggestionStore.currentSuggestion?n.suggestionStore.currentSuggestion.item:void 0);(!e||e&&!e.defaultPrevented)&&n.canAddItems()&&n.suggestionStore.hasSelectedSuggestion()&&n.state.suggestedDisplayValue&&n.addItemByIndex(0)};n.currentPromise?n.currentPromise.then(function(){return t()}):t();n.setState({suggestionsVisible:!1})};n.refocusSuggestions=function(e){n.resetFocus();n.suggestionStore.suggestions&&0<n.suggestionStore.suggestions.length&&(38===e?n.suggestionStore.setSelectedSuggestion(n.suggestionStore.suggestions.length-1):40===e&&n.suggestionStore.setSelectedSuggestion(0))};n.onInputChange=function(e){n.updateValue(e);n.setState({moreSuggestionsAvailable:!0,isMostRecentlyUsedVisible:!1})};n.onSuggestionClick=function(e,t,i){n.addItemByIndex(i);n.setState({suggestionsVisible:!1})};n.onSuggestionRemove=function(e,t,i){n.props.onRemoveSuggestion&&n.props.onRemoveSuggestion(t);n.suggestionStore.removeSuggestion(i)};n.onInputFocus=function(e){if(!n.state.isFocused){n.setState({isFocused:!0});n.selection.setAllSelected(!1);if(n.input.current&&""===n.input.current.value&&n.props.onEmptyInputFocus){n.onEmptyInputFocus();n.setState({isMostRecentlyUsedVisible:!0,moreSuggestionsAvailable:!1,suggestionsVisible:!0})}else n.input.current&&n.input.current.value&&n.setState({isMostRecentlyUsedVisible:!1,suggestionsVisible:!0});n.props.inputProps&&n.props.inputProps.onFocus&&n.props.inputProps.onFocus(e)}};n.onInputBlur=function(e){if(!u.elementContains(n.root.current,e.relatedTarget)){n.setState({isFocused:!1});n.props.inputProps&&n.props.inputProps.onBlur&&n.props.inputProps.onBlur(e)}};n.onKeyDown=function(e){var t=e.which;switch(t){case 27:if(n.state.suggestionsVisible){n.setState({suggestionsVisible:!1});e.preventDefault();e.stopPropagation()}break;case 9:case 13:if(n.suggestionElement.current&&n.suggestionElement.current.hasSuggestedActionSelected())n.suggestionElement.current.executeSelectedAction();else if(!e.shiftKey&&n.suggestionStore.hasSelectedSuggestion()&&n.state.suggestionsVisible){n.completeSuggestion();e.preventDefault();e.stopPropagation()}else n._onValidateInput();break;case 8:n.props.disabled||n.onBackspace(e);e.stopPropagation();break;case 46:if(!n.props.disabled)if(n.input.current&&e.target===n.input.current.inputElement&&n.state.suggestionsVisible&&-1!==n.suggestionStore.currentIndex){n.props.onRemoveSuggestion&&n.props.onRemoveSuggestion(n.suggestionStore.currentSuggestion.item);n.suggestionStore.removeSuggestion(n.suggestionStore.currentIndex);n.forceUpdate()}else n.onBackspace(e);e.stopPropagation();break;case 38:if(n.input.current&&e.target===n.input.current.inputElement&&n.state.suggestionsVisible)if(n.suggestionElement.current&&n.suggestionElement.current.tryHandleKeyDown(t,n.suggestionStore.currentIndex)){e.preventDefault();e.stopPropagation()}else if(n.suggestionElement.current&&n.suggestionElement.current.hasSuggestedAction()&&0===n.suggestionStore.currentIndex){e.preventDefault();e.stopPropagation();n.suggestionElement.current.focusAboveSuggestions();n.suggestionStore.deselectAllSuggestions();n.forceUpdate()}else if(n.suggestionStore.previousSuggestion()){e.preventDefault();e.stopPropagation();n.onSuggestionSelect()}break;case 40:if(n.input.current&&e.target===n.input.current.inputElement&&n.state.suggestionsVisible)if(n.suggestionElement.current&&n.suggestionElement.current.tryHandleKeyDown(t,n.suggestionStore.currentIndex)){e.preventDefault();e.stopPropagation()}else if(n.suggestionElement.current&&n.suggestionElement.current.hasSuggestedAction()&&n.suggestionStore.currentIndex+1===n.suggestionStore.suggestions.length){e.preventDefault();e.stopPropagation();n.suggestionElement.current.focusBelowSuggestions();n.suggestionStore.deselectAllSuggestions();n.forceUpdate()}else if(n.suggestionStore.nextSuggestion()){e.preventDefault();e.stopPropagation();n.onSuggestionSelect()}}};n.onItemChange=function(e,t){var i=n.state.items;if(0<=t){var r=i;r[t]=e;n._updateSelectedItems(r)}};n.onGetMoreResults=function(){n.setState({isSearching:!0},function(){if(n.props.onGetMoreResults&&n.input.current){var e=n.props.onGetMoreResults(n.input.current.value,n.state.items),t=e,i=e;if(Array.isArray(t)){n.updateSuggestions(t);n.setState({isSearching:!1})}else i.then&&i.then(function(e){n.updateSuggestions(e);n.setState({isSearching:!1})})}else n.setState({isSearching:!1});n.input.current&&n.input.current.focus();n.setState({moreSuggestionsAvailable:!1,isResultsFooterVisible:!0})})};n.addItemByIndex=function(e){n.addItem(n.suggestionStore.getSuggestionAtIndex(e).item);n.input.current&&n.input.current.clear();n.updateValue("")};n.addItem=function(e){var t=n.props.onItemSelected?n.props.onItemSelected(e):e;if(null!==t){var i=t,r=t;if(r&&r.then)r.then(function(e){var t=n.state.items.concat([e]);n._updateSelectedItems(t)});else{var o=n.state.items.concat([i]);n._updateSelectedItems(o)}n.setState({suggestedDisplayValue:""})}};n.removeItem=function(e){var t=n.state.items,i=t.indexOf(e);if(0<=i){var r=t.slice(0,i).concat(t.slice(i+1));n._updateSelectedItems(r)}};n.removeItems=function(t){var e=n.state.items,i=e.filter(function(e){return-1===t.indexOf(e)}),r=t[0],o=e.indexOf(r);n._updateSelectedItems(i,o)};n._isFocusZoneInnerKeystroke=function(e){if(n.state.suggestionsVisible)switch(e.which){case 38:case 40:return!0}return 13===e.which};var t=e.selectedItems||e.defaultSelectedItems||[];n.suggestionStore=new a.SuggestionsController;n.selection=new m.Selection({onSelectionChanged:function(){return n.onSelectionChange()}});n.selection.setItems(t);n.state={items:t,suggestedDisplayValue:"",isMostRecentlyUsedVisible:!1,moreSuggestionsAvailable:!1,isFocused:!1,isSearching:!1};return n}Object.defineProperty(e.prototype,"items",{get:function(){return this.state.items},enumerable:!0,configurable:!0});e.prototype.componentWillUpdate=function(e,t){t.items&&t.items!==this.state.items&&this.selection.setItems(t.items)};e.prototype.componentDidMount=function(){this.selection.setItems(this.state.items);this._onResolveSuggestions=this._async.debounce(this._onResolveSuggestions,this.props.resolveDelay)};e.prototype.componentWillReceiveProps=function(e){var t=this,i=e.selectedItems;if(i){var r;i.length<this.state.items.length&&(r=this.state.items.indexOf(this.selection.getSelection()[0]));this.setState({items:e.selectedItems},function(){0<=r&&t.resetFocus(r)})}};e.prototype.componentWillUnmount=function(){i.prototype.componentWillUnmount.call(this);this.loadingTimer&&this._async.clearTimeout(this.loadingTimer);this.currentPromise&&(this.currentPromise=void 0)};e.prototype.focus=function(){this.focusZone.current&&this.focusZone.current.focus()};e.prototype.focusInput=function(){this.input.current&&this.input.current.focus()};e.prototype.completeSuggestion=function(){if(this.suggestionStore.hasSelectedSuggestion()&&this.input.current){this.addItem(this.suggestionStore.currentSuggestion.item);this.updateValue("");this.input.current.clear()}};e.prototype.render=function(){var e=this.state.suggestedDisplayValue,t=this.props,i=t.className,r=t.inputProps,o=t.disabled,n=this.suggestionStore.currentIndex,a=-1<n?this.suggestionStore.getSuggestionAtIndex(this.suggestionStore.currentIndex):void 0,s=a?a.ariaLabel:void 0,l=-1<n?"sug-"+n:void 0;return c.createElement("div",{ref:this.root,className:u.css("ms-BasePicker",i||""),onKeyDown:this.onKeyDown},c.createElement(p.FocusZone,{componentRef:this.focusZone,direction:p.FocusZoneDirection.bidirectional,isInnerZoneKeystroke:this._isFocusZoneInnerKeystroke},c.createElement("div",{className:f.screenReaderOnly,role:"alert",id:"selected-suggestion-alert","aria-live":"assertive"},s," "),c.createElement(m.SelectionZone,{selection:this.selection,selectionMode:m.SelectionMode.multiple},c.createElement("div",{className:u.css("ms-BasePicker-text",f.pickerText,this.state.isFocused&&f.inputFocused),role:"list"},this.renderItems(),this.canAddItems()&&c.createElement(h.Autofill,d.__assign({},r,{className:u.css("ms-BasePicker-input",f.pickerInput),ref:this.input,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onInputValueChange:this.onInputChange,suggestedDisplayValue:e,"aria-activedescendant":l,"aria-owns":this.state.suggestionsVisible?"suggestion-list":void 0,"aria-expanded":!!this.state.suggestionsVisible,"aria-haspopup":"true",autoCapitalize:"off",autoComplete:"off",role:"combobox",disabled:o,"aria-controls":"selected-suggestion-alert",onInputChange:this.props.onInputChange}))))),this.renderSuggestions())};e.prototype.canAddItems=function(){var e=this.state.items,t=this.props.itemLimit;return void 0===t||e.length<t};e.prototype.renderSuggestions=function(){var e=this.SuggestionOfProperType;return this.state.suggestionsVisible&&this.input?c.createElement(r.Callout,{isBeakVisible:!1,gapSpace:5,target:this.input.current?this.input.current.inputElement:void 0,onDismiss:this.dismissSuggestions,directionalHint:4,directionalHintForRTL:6},c.createElement(e,d.__assign({onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),ref:this.suggestionElement,onGetMoreResults:this.onGetMoreResults,moreSuggestionsAvailable:this.state.moreSuggestionsAvailable,isLoading:this.state.suggestionsLoading,isSearching:this.state.isSearching,isMostRecentlyUsedVisible:this.state.isMostRecentlyUsedVisible,isResultsFooterVisible:this.state.isResultsFooterVisible,refocusSuggestions:this.refocusSuggestions,removeSuggestionAriaLabel:this.props.removeButtonAriaLabel},this.props.pickerSuggestionsProps))):null};e.prototype.renderItems=function(){var i=this,e=this.props,r=e.disabled,o=e.removeButtonAriaLabel,n=this.props.onRenderItem;return this.state.items.map(function(e,t){return n({item:e,index:t,key:e.key?e.key:t,selected:i.selection.isIndexSelected(t),onRemoveItem:function(){return i.removeItem(e)},disabled:r,onItemChange:i.onItemChange,removeButtonAriaLabel:o})})};e.prototype.resetFocus=function(e){var t=this.state.items;if(t.length&&0<=e){var i=this.root.current&&this.root.current.querySelectorAll("[data-selection-index]")[Math.min(e,t.length-1)];i&&this.focusZone.current&&this.focusZone.current.focusElement(i)}else if(this.canAddItems())this.input.current&&this.input.current.focus();else{t[t.length-1].selected=!0;this.resetFocus(t.length-1)}};e.prototype.onSuggestionSelect=function(){if(this.suggestionStore.currentSuggestion){var e=this.input.current?this.input.current.value:"",t=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e);this.setState({suggestedDisplayValue:t})}};e.prototype.onSelectionChange=function(){this.forceUpdate()};e.prototype.updateSuggestions=function(e){this.suggestionStore.updateSuggestions(e,0);this.forceUpdate()};e.prototype.onEmptyInputFocus=function(){var e=(0,this.props.onEmptyInputFocus)(this.state.items);this.updateSuggestionsList(e)};e.prototype.updateValue=function(e){this._onResolveSuggestions(e)};e.prototype.updateSuggestionsList=function(e,t){var i=this,r=e,o=e;if(Array.isArray(r))void 0!==t?this.resolveNewValue(t,r):this.suggestionStore.updateSuggestions(r,0);else if(o&&o.then){this.loadingTimer||(this.loadingTimer=this._async.setTimeout(function(){i.setState({suggestionsLoading:!0})},500));this.suggestionStore.updateSuggestions([]);void 0!==t?this.setState({suggestionsVisible:!!this.input.current&&(""!==this.input.current.value&&this.input.current.inputElement===document.activeElement)}):this.setState({suggestionsVisible:!!this.input.current&&this.input.current.inputElement===document.activeElement});var n=this.currentPromise=o;n.then(function(e){if(n===i.currentPromise){if(void 0!==t)i.resolveNewValue(t,e);else{i.suggestionStore.updateSuggestions(e);i.setState({suggestionsLoading:!1})}if(i.loadingTimer){i._async.clearTimeout(i.loadingTimer);i.loadingTimer=void 0}}})}};e.prototype.resolveNewValue=function(e,t){this.suggestionStore.updateSuggestions(t,0);var i=void 0;this.suggestionStore.currentSuggestion&&(i=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e));this.setState({suggestionsLoading:!1,suggestedDisplayValue:i,suggestionsVisible:!!this.input.current&&(""!==this.input.current.value&&this.input.current.inputElement===document.activeElement)})};e.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(e)};e.prototype.onBackspace=function(e){(this.state.items.length&&!this.input.current||this.input.current&&!this.input.current.isValueSelected&&0===this.input.current.cursorLocation)&&(0<this.selection.getSelectedCount()?this.removeItems(this.selection.getSelection()):this.removeItem(this.state.items[this.state.items.length-1]))};e.prototype._updateSelectedItems=function(e,t){var i=this;this.props.selectedItems?this.onChange(e):this.setState({items:e},function(){i._onSelectedItemsUpdated(e,t)})};e.prototype._onSelectedItemsUpdated=function(e,t){this.resetFocus(t);this.onChange(e)};e.prototype._onResolveSuggestions=function(e){var t=this.props.onResolveSuggestions(e,this.state.items);null!==t&&this.updateSuggestionsList(t,e)};e.prototype._onValidateInput=function(){if(this.props.onValidateInput&&this.input.current&&this.props.onValidateInput(this.input.current.value)!==n.ValidationState.invalid&&this.props.createGenericItem){var e=this.props.createGenericItem(this.input.current.value,this.props.onValidateInput(this.input.current.value));this.suggestionStore.createGenericSuggestion(e);this.completeSuggestion()}};e.prototype._getTextFromItem=function(e,t){return this.props.getTextFromItem?this.props.getTextFromItem(e,t):""};return e}(u.BaseComponent),l=function(e){d.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.state.suggestedDisplayValue,t=this.props,i=t.className,r=t.inputProps,o=t.disabled;return c.createElement("div",null,c.createElement("div",{ref:this.root,className:u.css("ms-BasePicker",i||""),onKeyDown:this.onKeyDown},c.createElement(m.SelectionZone,{selection:this.selection,selectionMode:m.SelectionMode.multiple},c.createElement("div",{className:u.css("ms-BasePicker-text",f.pickerText,this.state.isFocused&&f.inputFocused)},c.createElement(h.Autofill,d.__assign({},r,{className:u.css("ms-BasePicker-input",f.pickerInput),ref:this.input,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onInputValueChange:this.onInputChange,suggestedDisplayValue:e,"aria-activedescendant":this.state.suggestionsVisible?"sug-"+this.suggestionStore.currentIndex:void 0,"aria-owns":this.state.suggestionsVisible?"suggestion-list":void 0,"aria-expanded":!!this.state.suggestionsVisible,"aria-haspopup":"true",autoCapitalize:"off",autoComplete:"off",role:"combobox",disabled:o}))))),this.renderSuggestions(),c.createElement(p.FocusZone,{componentRef:this.focusZone,className:"ms-BasePicker-selectedItems",isCircularNavigation:!0,direction:p.FocusZoneDirection.bidirectional,isInnerZoneKeystroke:this._isFocusZoneInnerKeystroke},this.renderItems()))};t.prototype.onBackspace=function(e){};return t}(t.BasePicker=s);t.BasePickerListBelow=l});define("CM",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.valid=0]="valid";e[e.warning=1]="warning";e[e.invalid=2]="invalid"}(t.ValidationState||(t.ValidationState={}))});define("CO",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".pickerText_e0320c29{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";min-width:180px;min-height:30px}.pickerText_e0320c29:hover{border-color:"},{theme:"inputBorderHovered",defaultValue:"#212121"},{rawString:"}.pickerText_e0320c29.inputFocused_e0320c29{border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:"}.pickerInput_e0320c29{height:34px;border:none;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;outline:none;padding:0 6px 0px}.screenReaderOnly_e0320c29{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);t.pickerText="pickerText_e0320c29";t.inputFocused="inputFocused_e0320c29";t.pickerInput="pickerInput_e0320c29";t.screenReaderOnly="screenReaderOnly_e0320c29"});define("CH",["require","exports","ap","at","jP","CN","CM","CK","CJ","CI"],function(e,t,i,r,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t}(n.BasePicker);t.BasePeoplePicker=d;var c=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t}(n.BasePickerListBelow);t.MemberListPeoplePicker=c;var u=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return r.createElement(s.SelectedItemDefault,i.__assign({},e))},onRenderSuggestionsItem:function(e,t){return l.SuggestionItemNormal(i.__assign({},e),i.__assign({},t))},createGenericItem:h};return t}(d);t.NormalPeoplePicker=u;var p=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return r.createElement(s.SelectedItemDefault,i.__assign({},e))},onRenderSuggestionsItem:function(e,t){return l.SuggestionItemSmall(i.__assign({},e),i.__assign({},t))},createGenericItem:h};return t}(d);t.CompactPeoplePicker=p;var m=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return r.createElement(s.SelectedItemDefault,i.__assign({},e))},onRenderSuggestionsItem:function(e,t){return l.SuggestionItemNormal(i.__assign({},e),i.__assign({},t))},createGenericItem:h};return t}(c);t.ListPeoplePicker=m;function h(e,t,i){var r={key:e,primaryText:e,imageInitials:"!",ValidationState:t};t!==a.ValidationState.warning&&(r.imageInitials=o.getInitials(e,o.getRTL(),i));return r}t.createGenericItem=h});define("CK",["require","exports","ap","at","jP","xA","CM","wN","CL"],function(e,t,c,u,p,m,h,f,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=i;t.SelectedItemDefault=function(e){var t,i,r,o=e.item,n=e.onRemoveItem,a=e.index,s=e.selected,l=e.removeButtonAriaLabel,d=p.getId();return u.createElement("div",{className:p.css("ms-PickerPersona-container",g.personaContainer,(i={},i["is-selected "+g.personaContainerIsSelected]=s,i),(r={},r["is-invalid "+g.validationError]=o.ValidationState===h.ValidationState.warning,r)),"data-is-focusable":!0,"data-is-sub-focuszone":!0,"data-selection-index":a,role:"listitem","aria-labelledby":"selectedItemPersona-"+d},u.createElement("div",{className:p.css("ms-PickerItem-content",g.itemContent),id:"selectedItemPersona-"+d},u.createElement(m.Persona,c.__assign({},o,{presence:void 0!==o.presence?o.presence:m.PersonaPresence.none,size:m.PersonaSize.size28}))),u.createElement(f.IconButton,{onClick:(t=n,function(){t&&t()}),iconProps:{iconName:"Cancel",style:{fontSize:"12px"}},className:p.css("ms-PickerItem-removeButton",g.removeButton),ariaLabel:l}))}});define("CL",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".personaContainer_ea7ad3f3{border-radius:15px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";margin:1px 2px;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;max-width:300px;vertical-align:middle}.personaContainer_ea7ad3f3::-moz-focus-inner{border:0}.personaContainer_ea7ad3f3{outline:transparent}.personaContainer_ea7ad3f3{position:relative}.ms-Fabric--isFocusVisible .personaContainer_ea7ad3f3:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#000000"},{rawString:"}.personaContainer_ea7ad3f3:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.personaContainer_ea7ad3f3:hover .removeButton_ea7ad3f3{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.personaContainer_ea7ad3f3.personaContainerIsSelected_ea7ad3f3{background:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.personaContainer_ea7ad3f3.personaContainerIsSelected_ea7ad3f3 .ms-Persona-primaryText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}@media screen and (-ms-high-contrast: active){.personaContainer_ea7ad3f3.personaContainerIsSelected_ea7ad3f3 .ms-Persona-primaryText{color:HighlightText}}.personaContainer_ea7ad3f3.personaContainerIsSelected_ea7ad3f3 .removeButton_ea7ad3f3 .ms-Button-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}@media screen and (-ms-high-contrast: active){.personaContainer_ea7ad3f3.personaContainerIsSelected_ea7ad3f3 .removeButton_ea7ad3f3 .ms-Button-icon{color:HighlightText}}.personaContainer_ea7ad3f3.personaContainerIsSelected_ea7ad3f3 .removeButton_ea7ad3f3:hover{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}@media screen and (-ms-high-contrast: active){.personaContainer_ea7ad3f3.personaContainerIsSelected_ea7ad3f3{border-color:Highlight;background:Highlight;-ms-high-contrast-adjust:none}}.personaContainer_ea7ad3f3.validationError_ea7ad3f3 .ms-Persona-primaryText{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";border-bottom:2px dotted "},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.personaContainer_ea7ad3f3.validationError_ea7ad3f3 .ms-Persona-initials{font-size:20px}.personaContainer_ea7ad3f3.validationError_ea7ad3f3.personaContainerIsSelected_ea7ad3f3{background:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.personaContainer_ea7ad3f3.validationError_ea7ad3f3.personaContainerIsSelected_ea7ad3f3 .ms-Persona-primaryText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:2px dotted "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.personaContainer_ea7ad3f3.validationError_ea7ad3f3.personaContainerIsSelected_ea7ad3f3 .removeButton_ea7ad3f3:hover{background:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}@media screen and (-ms-high-contrast: active){.personaContainer_ea7ad3f3{border:1px solid WindowText}}.personaContainer_ea7ad3f3 .itemContent_ea7ad3f3{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;min-width:0px;max-width:100%;overflow:hidden}.personaContainer_ea7ad3f3 .removeButton_ea7ad3f3{border-radius:15px;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;width:28px;height:28px;-ms-flex-preferred-size:28px;flex-basis:28px}.personaContainer_ea7ad3f3 .removeButton_ea7ad3f3:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.personaContainer_ea7ad3f3 .personaDetails_ea7ad3f3{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto}.itemContainer_ea7ad3f3{display:inline-block;vertical-align:top}\n"}]);t.personaContainer="personaContainer_ea7ad3f3";t.removeButton="removeButton_ea7ad3f3";t.personaContainerIsSelected="personaContainerIsSelected_ea7ad3f3";t.validationError="validationError_ea7ad3f3";t.itemContent="itemContent_ea7ad3f3";t.personaDetails="personaDetails_ea7ad3f3";t.itemContainer="itemContainer_ea7ad3f3"});define("CJ",["require","exports","ap","at","jP","xA","CI"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a;t.SuggestionItemNormal=function(e,t){return r.createElement("div",{className:o.css("ms-PeoplePicker-personaContent",s.peoplePickerPersonaContent)},r.createElement(n.Persona,i.__assign({presence:void 0!==e.presence?e.presence:n.PersonaPresence.none,size:n.PersonaSize.size24,className:o.css("ms-PeoplePicker-Persona",s.peoplePickerPersona),showSecondaryText:!0},e)))};t.SuggestionItemSmall=function(e,t){return r.createElement("div",{className:o.css("ms-PeoplePicker-personaContent",s.peoplePickerPersonaContent)},r.createElement(n.Persona,i.__assign({presence:void 0!==e.presence?e.presence:n.PersonaPresence.none,size:n.PersonaSize.size24,className:o.css("ms-PeoplePicker-Persona",s.peoplePickerPersona)},e)))}});define("CI",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".resultContent_c23cf7d1{display:table-row}.resultContent_c23cf7d1 .resultItem_c23cf7d1{display:table-cell;vertical-align:bottom}.peoplePickerPersona_c23cf7d1{width:180px}.peoplePickerPersona_c23cf7d1 .ms-Persona-details{width:100%}.peoplePicker_c23cf7d1 .ms-BasePicker-text{min-height:40px}.peoplePickerPersonaContent_c23cf7d1{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}\n"}]);t.resultContent="resultContent_c23cf7d1";t.resultItem="resultItem_c23cf7d1";t.peoplePickerPersona="peoplePickerPersona_c23cf7d1";t.peoplePicker="peoplePicker_c23cf7d1";t.peoplePickerPersonaContent="peoplePickerPersonaContent_c23cf7d1"});define("CG",["require","exports","ap","at","jP","CN","CE","CF"],function(e,t,i,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=s,d=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return r.createElement(a.TagItem,i.__assign({},e),e.item.name)},onRenderSuggestionsItem:function(e){return r.createElement("div",{className:o.css("ms-TagItem-TextOverflow",l.tagItemTextOverflow)}," ",e.name," ")}};return t}(n.BasePicker);t.TagPicker=d});define("CE",["require","exports","at","jP","mo","CF"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n;t.TagItem=function(e){return i.createElement("div",{className:r.css("ms-TagItem",a.root,{"is-selected":e.selected},e.selected&&a.isSelected),role:"listitem",key:e.index,"data-selection-index":e.index,"data-is-focusable":!e.disabled&&!0},i.createElement("span",{className:r.css("ms-TagItem-text",a.tagItemText),"aria-label":e.children},e.children),!e.disabled&&i.createElement("span",{className:r.css("ms-TagItem-close",a.tagItemClose),onClick:e.onRemoveItem},i.createElement(o.Icon,{iconName:"Cancel"})))}});define("CF",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_b74b2425{-webkit-box-sizing:content-box;box-sizing:content-box;-ms-flex-negative:1;flex-shrink:1;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";margin:2px;height:26px;line-height:26px;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;max-width:300px}.root_b74b2425::-moz-focus-inner{border:0}.root_b74b2425{outline:transparent}.root_b74b2425{position:relative}.ms-Fabric--isFocusVisible .root_b74b2425:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#000000"},{rawString:"}.root_b74b2425:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.root_b74b2425.isSelected_b74b2425{background:"},{theme:"neutralQuaternary",defaultValue:"#d0d0d0"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_b74b2425.isSelected_b74b2425{border:1px solid WindowFrame}}.root_b74b2425.isSelected_b74b2425:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_b74b2425{border:1px solid WindowText}}.tagItemText_b74b2425{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;min-width:30px;margin:0 8px}.tagItemClose_b74b2425{cursor:pointer;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px;display:inline-block;text-align:center;vertical-align:top;width:30px;height:100%;-ms-flex-negative:0;flex-shrink:0}.tagItemButton_b74b2425{width:100%;height:100%}.tagItemTextOverflow_b74b2425{overflow:hidden;text-overflow:ellipsis;max-width:60vw}\n"}]);t.root="root_b74b2425";t.isSelected="isSelected_b74b2425";t.tagItemText="tagItemText_b74b2425";t.tagItemClose="tagItemClose_b74b2425";t.tagItemButton="tagItemButton_b74b2425";t.tagItemTextOverflow="tagItemTextOverflow_b74b2425"});define("Cx",["require","exports","ap","i5","CB","CA","Cy"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t)});define("CB",["require","exports","hb"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PrincipalType=i.default;!function(e){e[e.regularUser=0]="regularUser";e[e.externalUser=1]="externalUser";e[e.group=2]="group";e[e.application=3]="application"}(t.EntityType||(t.EntityType={}))});define("CA",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Unknown=0]="Unknown";e[e.Online=1]="Online";e[e.Busy=2]="Busy";e[e.DoNotDisturb=3]="DoNotDisturb";e[e.BeRightBack=4]="BeRightBack";e[e.Away=5]="Away";e[e.Offline=6]="Offline";e[e.Hidden=7]="Hidden"}(t.PresenceType||(t.PresenceType={}))});define("Cy",["require","exports","aC","i5","Cz"],function(e,t,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new r.PeoplePickerDataSource({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper,oAuthTokenProvider:e.oAuthTokenProvider});this._ppCapabilities=this._dataSource.getCapabilities();if(this._ppCapabilities.supportsMruCaching){this._mruCache=new a.PeopleStore;this.MaxCacheSuggestions=5}else this.MaxCacheSuggestions=0}e.prototype.search=function(e,r){var o,n,a=this,t={cached:null,promise:null};this._mruCache&&!r.groupID&&0<(n=this.searchMruCache(e,r&&r.filterExternalUsers)).length&&(t.cached=n);t.promise=new i.default(function(i,t){o=a._dataSource.search(e,r).then(function(e){if(e)if(n){0<n.length&&(n=a._removeStaleCacheResults(n,e));var t=n.map(function(e){return e.userId});i(e.filter(function(e){return t.indexOf(e.userId)<0}))}else i(e)},function(e){t(e)})},function(){o&&o.cancel()});return t};e.prototype.resolve=function(e,t){var i=this;return this._dataSource.resolve(e,t).then(function(e){i._mruCache&&e.isResolved&&i.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})};e.prototype.searchMruCache=function(e,t){var i=[],r=this._mruCache;if(r){i=r.getItems(e,t);var o=this.MaxCacheSuggestions;i.length>o&&(i=i.splice(0,o))}return i};e.prototype._removeStaleCacheResults=function(r,e){var o=r.map(function(e){return e.userId}),n=[];e.forEach(function(e){var t=o.indexOf(e.userId);if(-1<t){var i=r[t];a.PeopleStore.isCacheEntryFresh(i,e)&&n.push(i)}});return n};return e}();t.PeoplePickerProvider=o});define("Cz",["require","exports","ap","a3","a2"],function(e,t,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(o,i);function o(){var e=i.call(this,o._Key,o._DataStoreCachingType)||this;e._MaxItems=200;e._Version=5;e._buffer=e.getValue(o._StorageKey);e._buffer&&e._buffer.version===e._Version||e.initializeBuffer();e._data={};for(var t=0;t<e._buffer.dataArray.length;t++)e._data[e._buffer.dataArray[t].email]=e._buffer.dataArray[t];return e}o.clear=function(){new n.default(o._Key,o._DataStoreCachingType).remove(o._StorageKey)};o.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};o.prototype.setItem=function(e){var t=this._data[e.email];if(t){if(o.isCacheEntryFresh(t,e))return;var i=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[i]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var r=this._buffer.dataArray[this._buffer.index];delete this._data[r.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(o._StorageKey,this._buffer)};o.prototype.getItems=function(e,t){for(var i=[],r=0;r<this._buffer.dataArray.length;r++){var o=(this._buffer.index-r+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[o].email&&0<=this._buffer.dataArray[o].email.toLowerCase().indexOf(e.toLowerCase())||this._buffer.dataArray[o].name&&0<=this._buffer.dataArray[o].name.toLowerCase().indexOf(e.toLowerCase()))||t&&1===this._buffer.dataArray[o].entityType||i.push(this._buffer.dataArray[o])}return i};o.prototype.containsItem=function(e){return Boolean(this._data[e.email])};o.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version};o._Key="ClientPeoplePicker";o._StorageKey="MRU";o._DataStoreCachingType=a.default.local;return o}(n.default);t.PeopleStore=i});define("Cs",["require","exports","ap","at","xA","wN","jP","Ct"],function(e,t,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function p(e){return{primaryText:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt}}t.SuggestionItemDefault=function(e){var t=p(e);return l.createElement("div",{className:"ms-PeoplePicker-personaContent"},l.createElement(d.Persona,s.__assign({},t,{presence:d.PersonaPresence.none,size:d.PersonaSize.small,className:"ms-PeoplePicker-pickerPersona"})))};t.SelectedItemDefault=function(e){var t=e.item,i=e.onRemoveItem,r=e.index,o=e.selected,n=e.removeButtonAriaLabel,a=p(t);return l.createElement("div",{className:u.css("ms-PickerPersona-container",{"is-selected":o}),"data-is-focusable":!0,"data-selection-index":r,key:r,role:"listitem"},l.createElement("div",{className:"ms-PickerItem-content"},l.createElement(d.Persona,s.__assign({},a,{presence:d.PersonaPresence.none,size:d.PersonaSize.extraSmall}))),l.createElement(c.IconButton,{onClick:function(){i&&i()},iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1,ariaLabel:n}))};t.SelectedItemBelowDefault=function(e){var t=e.item,i=e.onRemoveItem,r=e.index,o=e.selected,n=p(t);return l.createElement("div",{className:u.css("ms-PickerPersona-container is-listbelow",{"is-selected":o}),"data-is-focusable":!0,"data-selection-index":r,key:r},l.createElement("div",{className:"ms-PickerPersona-content"},l.createElement(d.Persona,s.__assign({},n,{presence:d.PersonaPresence.none,size:d.PersonaSize.small}))),l.createElement("div",{className:"ms-PickerItem-sideContent"},l.createElement(c.IconButton,{onClick:function(){i&&i()},iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1})))};t.SelectedItemBelowCustomMenu=function(e,t){var i=e.item,r=e.onRemoveItem,o=e.index,n=e.selected,a=p(i);return l.createElement("div",{className:u.css("ms-PickerPersona-container is-listbelow",{"is-selected":n}),"data-is-focusable":!0,"data-selection-index":o,key:o},l.createElement("div",{className:"ms-PickerPersona-content"},l.createElement(d.Persona,s.__assign({},a,{presence:d.PersonaPresence.none,size:d.PersonaSize.small}),t||null)),l.createElement("div",{className:"ms-PickerItem-sideContent"},l.createElement(c.IconButton,{onClick:function(){r&&r()},iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1})))}});define("Ct",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-PickerPersona-container{position:relative;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ms-Fabric .ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-Fabric .ms-PickerPersona-container{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .ms-PickerPersona-container:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .ms-PickerPersona-container:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .ms-PickerPersona-container:focus:after{border-color:#37006e}}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#dadada"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#d0d0d0"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{-ms-flex:1;flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px}"}])});define("Cu",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.normal=0]="normal";e[e.listBelow=1]="listBelow"}(t.PeoplePickerType||(t.PeoplePickerType={}))});define("Cw",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-Suggestions{width:260px}"}])});define("BB",["require","exports","aI","BC"],function(e,t,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=!1;t.copyLinkShareTargetClicked=function(){window.top.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")};t.dismiss=function(){window.top.postMessage(JSON.stringify({name:"share_dismiss"}),"*")};t.shareCompleted=function(t){try{window.external.ShareCompleted(t)}catch(e){var i={name:"share_completed",shareType:t};window.top.postMessage(JSON.stringify(i),"*")}};t.teamsClicked=function(e){try{window.external.SendLinkViaTeams(e.url)}catch(e){var t={name:"share_teamsClicked"};window.top.postMessage(JSON.stringify(t),"*")}};t.grantAccessCompleted=function(t){try{window.external.GrantAccessCompleted(t)}catch(e){var i={name:"share_grantAccessCompleted",successful:t};window.top.postMessage(JSON.stringify(i),"*")}};t.pageError=function(t){try{window.external.PageError(t.error,t.errorCategory,t.errorMessage,t.debugErrorMessage)}catch(e){var i={name:"share_error",error:t.error,errorCategory:t.errorCategory,errorMessage:t.errorMessage,debugErrorMessage:t.debugErrorMessage};window.top.postMessage(JSON.stringify(i),"*")}};t.outlookClicked=function(){window.top.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")};t.pageFinishedLoading=function(e,t){if(!o){o=!0;new r.default({name:"ShareV3.PageFinishedLoading",startTimeOverride:window._sharingStartTime}).end({resultType:r.ResultTypeEnum.Success,extraData:{clientId:e,scenarioId:t}});try{window.external.PageFinishedLoading()}catch(e){var i={name:"share_ready"};window.top.postMessage(JSON.stringify(i),"*")}}};t.readyForRecipients=function(){window.top.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")};t.sendLinkClicked=function(){window.top.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")};t.peoplePickerFocused=function(){try{window.external.PeoplePickerFocused()}catch(e){var t={name:"share_peoplePickerFocused"};window.top.postMessage(JSON.stringify(t),"*")}};t.linkSettingsCompleted=function(t,e,i){var r=a.getLinkIconUrl(t),o=a.getLinkLabel(t,e,i);try{window.external.LinkSettingsCompleted(t.shareId,t.url,r,o)}catch(e){var n={name:"share_linkSettingsCompleted",shareId:t.shareId,linkUrl:t.url,iconUrl:r,linkDescription:o};window.top.postMessage(JSON.stringify(n),"*")}}});define("Cp",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePicker-wrapper{max-height:150px;overflow-y:auto}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:13px;font-weight:400}[dir=ltr] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption2}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-footnote}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"error",defaultValue:"#a80000"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px}.od-Share-PeoplePicker-error{font-size:12px;font-weight:400;color:#a80000;display:block;margin-bottom:4px;font:-apple-system-caption2}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir=rtl] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:#a80000;border-color:#a80000;background-color:rgba(168,0,0,.06);font:-apple-system-caption2}"}])});define("C6",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsSettings .ms-Checkbox{min-height:0}.od-PermissionsSettings .ms-Checkbox-label{margin-top:0}.od-PermissionsSettings .ms-Checkbox-label::before{width:20px;height:20px}.od-PermissionsSettings .ms-Checkbox-label::after{font-size:16px;line-height:20px;width:20px}.od-PermissionsSettings .ms-PeoplePicker{margin-top:5px}.od-PermissionsSettings-section{padding-bottom:20px}.od-PermissionsSettings-description{padding-bottom:10px;font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font:-apple-system-caption2}.od-PermissionsSettings-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-PermissionsSettings-setting{margin-bottom:8px}.od-PermissionsSettings-setting span.ms-Checkbox-text{font:-apple-system-caption1}.od-PermissionsSettings-datePicker{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row}.od-PermissionsSettings-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:16px;line-height:0;padding:0}[dir=ltr] .od-PermissionsSettings-delete{margin-left:auto}[dir=rtl] .od-PermissionsSettings-delete{margin-right:auto}.od-PermissionsSettings-expirationError{font-size:12px;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-PermissionsSettings-PeoplePicker{margin-top:6px}.od-PermissionsSettings-learnMore{margin:0 3px;font:-apple-system-caption2}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{vertical-align:top}[dir=ltr] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-left:3px}[dir=rtl] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-right:3px}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionIcon{display:inline-block}"}])});define("C4",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ModifyPermissions.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}.od-ModifyPermissions .ms-Dialog-main{width:450px;max-width:none}.od-ModifyPermissions .ms-Dialog-header{display:none}.od-ModifyPermissions .ms-Dialog-actions{margin:20px}.od-ModifyPermissions-header{padding:12px 0;text-align:center;height:44px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-ModifyPermissions-actions{padding:0 20px 20px 20px}[dir=ltr] .od-ModifyPermissions-actions{text-align:right}[dir=rtl] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-actions div.ms-Button-label{font:-apple-system-caption1}.od-ModifyPermissions-section{padding:20px 0 0 0}[dir=ltr] .od-ModifyPermissions-actions{text-align:right}[dir=rtl] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-margins{margin:0 20px 0 20px}"}])});define("B3",["require","exports","ap","jP","DF","Bs","B5","BT","at","j8","V","BC","wN","mo","BJ","BD","B4"],function(e,t,i,o,l,d,n,c,u,a,s,p,m,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i.state={successfullyCopied:!1};i._resize=t.resize;i._sharingStore=t.sharingStore;i._strings=t.strings;return i}e.prototype.componentDidMount=function(){this.props.shareType===d.ShareType.copy&&this.props.shouldCopyLinkToClipboard&&this._copySharingLinkToClipboard()};e.prototype.componentDidUpdate=function(){this._resize()};e.prototype.render=function(){var t=this,e=this._getNotificationLabel(),i=this._getNotificationAriaLabel(),r=this.props.shareType===d.ShareType.copy,o=!!this._sharingStore&&this._sharingStore.hasAccessRequestBeenCreated(),n=this.props.shareType,a=n===d.ShareType.share||n===d.ShareType.moreApps||n===d.ShareType.copy&&this.state.successfullyCopied,s=a?"od-ShareNotification-successPadding":"od-ShareNotification-failPadding";return o?u.createElement("div",{className:"od-ShareNotification"},u.createElement(l.Header,{viewState:3,clientId:this.props.clientId}),u.createElement("div",{className:"od-ShareNotification-content ms-font-su"},u.createElement(h.Icon,{iconName:"PeopleAlert",className:"od-ShareNotification-accessRequestIcon"}),u.createElement("div",{className:"od-ShareNotification-accessRequestHeader ms-fontWeight-regular"},this._strings.accessRequestNotificationHeader),u.createElement("div",{className:"od-ShareNotification-accessRequestBody"},this._strings.accessRequestNotificationBody))):u.createElement("div",{className:"od-ShareNotification "+s},u.createElement(l.Header,{viewState:3,clientId:this.props.clientId}),this._renderCheckMark(a),u.createElement("div",{className:"od-ShareNotification-content"},u.createElement("div",{className:"ms-font-l"},e),u.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},i),r&&this._renderCopyCta(),r&&u.createElement("div",{className:"od-ShareNotification-urlText"},u.createElement(c.TextField,{autoFocus:!0,ariaLabel:i,onClick:this._copySharingLinkToClipboard,readOnly:!0,componentRef:function(e){t._textField=e},type:"text",value:this.props.linkUrl,className:"od-ShareNotification-urlTextField"}),u.createElement(m.PrimaryButton,{className:"od-ShareNotification-copyButton",text:this._strings.copyButtonLabel,onClick:this._copySharingLinkToClipboard}))),r&&this._renderShareHint())};e.prototype._copySharingLinkToClipboard=function(){var e=!1;if(!f.isMobile(this.props.clientId))try{this._textField.focus();this._textField.setSelectionRange(0,this._textField.value.length);e=document.execCommand("copy")}catch(e){}try{var t=window.external.CopyToClipboard(this.props.linkUrl);e=t||void 0===t}catch(e){}this.setState(i.__assign({},this.state,{successfullyCopied:e}))};e.prototype._renderCheckMark=function(e){if(e)return u.createElement("div",{className:"od-ShareNotification-icon"},u.createElement(h.Icon,{iconName:"CheckMark"}))};e.prototype._renderCopyCta=function(){var e=this.props,t=this.state;if(e.shareType===d.ShareType.copy&&!t.successfullyCopied)return u.createElement("span",{className:"od-ShareNotification-copyCta"},this._strings.notificationCopyFailedCta)};e.prototype._renderShareHint=function(){var e=this.props.sharingHintProps;return e?u.createElement("div",{className:"od-ShareNotification-footer"},u.createElement(n.ShareHint,{companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:e.sharingInformation,onShareHintClick:e.sharingInformation.requiresAccessApproval?void 0:e.onShareHintClick,shouldTakeFocus:!1,linkRecipients:e.linkRecipients})):null};e.prototype._getNotificationLabel=function(){var e=this._strings,t=p.truncateItemNameForShareNotification(this.props.itemName),i=this.props.shareType,r=s.format(e.notificationCopied,t),o=s.format(e.notificationCopyFailed,t),n=s.format(e.notificationSent,t);return i===d.ShareType.copy?this.state.successfullyCopied?r:o:i===d.ShareType.share?n:i===d.ShareType.moreApps?o:""};e.prototype._getNotificationAriaLabel=function(){var e=this.props.shareType;return e===d.ShareType.copy?this.state.successfullyCopied?g.default.notificationCopiedLabel:g.default.notificationCopyFailedLabel:e===d.ShareType.share?g.default.notificationSentLabel:e===d.ShareType.moreApps?g.default.notificationCopyFailedLabel:""};e.contextTypes={resize:a.func.isRequired,strings:a.object.isRequired,sharingStore:a.object.isRequired};i.__decorate([o.autobind],e.prototype,"_copySharingLinkToClipboard",null);return e}(u.Component);t.ShareNotification=r});define("B5",["require","exports","ap","Cc","B7","Bs","at","j8","V","BC","mo","B6"],function(e,t,l,d,c,i,u,o,n,p,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){l.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._strings=t.strings;return i}e.prototype.render=function(){var e,t,i=this.props,r=this._getFileShareTypeFromAudience(),o=this._getLabelFromPermissionsType(r),n=!!this.props.onShareHintClick,a="od-ShareHint "+(p.isLoadingData(i.sharingInformation)?"":"od-ShareHint--shimmerFadeout od-ShareHint--loaded"),s="od-ShareHint-data "+(n?"od-ShareHint--clickable":"");e=u.createElement("div",{className:"od-ShareHint-shimmer"},u.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},u.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},u.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),u.createElement("div",{className:"od-ShareHint-text-shimmer"}));t=i.onShareHintClick?u.createElement("button",{className:s,onClick:this._openLinkPermissions.bind(this),autoFocus:i.shouldTakeFocus},u.createElement("div",{className:"od-ShareHint-iconHolder"},u.createElement(c.ShareLinkDescription,{label:o,permissionsType:r,showLabel:!1})),u.createElement(d.ShareHintDetail,{companyName:i.companyName,currentSettings:i.currentSettings,sharingInformation:i.sharingInformation,linkRecipients:i.linkRecipients}),this._renderChevron(n)):u.createElement("div",l.__assign({className:s},{autoFocus:!0}),u.createElement("div",{className:"od-ShareHint-iconHolder"},u.createElement(c.ShareLinkDescription,{label:o,permissionsType:r,showLabel:!1})),u.createElement(d.ShareHintDetail,{companyName:i.companyName,currentSettings:i.currentSettings,sharingInformation:i.sharingInformation,linkRecipients:i.linkRecipients}),this._renderChevron(n));return u.createElement("div",{className:a},t,e)};e.prototype._renderChevron=function(e){if(e)return u.createElement(a.Icon,{iconName:"ChevronDown",className:"od-ShareHint-chevron"})};e.prototype._openLinkPermissions=function(){var e=this.props.onShareHintClick;e&&e()};e.prototype._getFileShareTypeFromAudience=function(){var e=this.props.currentSettings.audience;return e===i.SharingAudience.anyone?0:e===i.SharingAudience.organization?1:e===i.SharingAudience.existing?4:2};e.prototype._getLabelFromPermissionsType=function(e){var t=this._strings;return 0===e?t.permissionsAnyoneString:1===e?n.format(t.permissionsCompanyString,this.props.companyName):4===e?t.permissionsExistingPeopleString:2===e?t.permissionsSpecificPeopleString:void 0};e.contextTypes={strings:o.object.isRequired};return e}(u.Component);t.ShareHint=r});define("Cc",["require","exports","ap","mo","Bs","xs","at","j8","V","BD","Cd"],function(e,t,i,o,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._strings=t.strings;i._renderStatusIcons=i._renderStatusIcons.bind(i);return i}e.prototype.render=function(){var e=this._getLabel(this.props.currentSettings);return s.createElement("div",{className:"od-ShareHintDetail"},s.createElement("div",{className:"od-ShareHintDetail-description"},s.createElement("div",{className:"od-ShareHintDetail-status"},s.createElement("span",{className:"od-ShareHintDetail-statusText"},e),this._renderStatusIcons())))};e.prototype._renderStatusIcons=function(){var e=this.props.currentSettings.expiration,t=[];e&&e.getTime()!==new Date(0).getTime()&&t.push({icon:"Calendar",tooltip:""+d.format(this._strings.expiresIn,this._getMonthAndDay(),e.getFullYear())});var i=t.map(function(e,t){return s.createElement("i",{className:"od-ShareHintDetail-item"},s.createElement(a.TooltipHost,{content:e.tooltip,id:e.icon},s.createElement(o.Icon,{iconName:e.icon,"aria-describedby":e.icon})))});return s.createElement("div",{className:"od-ShareHintDetail-iconsList"},i)};e.prototype._getLabel=function(e){if(!e)return"";var t=this._strings,i=this.props.companyName;switch(e.sharingLinkKind){case 1:return e.audience===n.SharingAudience.specificPeople?e.sharingRole?2===e.sharingRole?t.specificPeopleEditHint:6===e.sharingRole?c.default.specificPeopleReviewHint:t.specificPeopleViewHint:e.isEdit?t.specificPeopleEditHint:t.specificPeopleViewHint:t.existingPeopleDescription;case 2:return d.format(t.cslViewDescription,i);case 3:return d.format(t.cslEditDescription,i);case 4:return t.anonViewDescription;case 5:return t.anonEditDescription;case 6:return e.audience===n.SharingAudience.specificPeopleFlex?e.sharingRole?2===e.sharingRole?t.specificPeopleEditHint:6===e.sharingRole?c.default.specificPeopleReviewHint:t.specificPeopleViewHint:e.isEdit?t.specificPeopleEditHint:t.specificPeopleViewHint:"";default:return""}};e.prototype._getMonthAndDay=function(){var e=this.props.currentSettings.expiration,t="";if(e&&e.getTime()!==new Date(0).getTime()){t+=this._strings.shortMonths[e.getMonth()];t+=" "+e.getDate()}return t};e.contextTypes={strings:l.object.isRequired};return e}(s.Component);t.ShareHintDetail=r});define("Cd",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHintDetail{overflow:hidden}.od-ShareHintDetail-status{font-size:12px;padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font:-apple-system-subheadline}[dir=ltr] .od-ShareHintDetail-statusText{margin-right:4px}[dir=rtl] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir=ltr] .od-ShareHintDetail-statusDetails{right:-36px}[dir=rtl] .od-ShareHintDetail-statusDetails{left:-36px}[dir=ltr] .od-ShareHintDetail-statusDetails{text-align:right}[dir=rtl] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:12px;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:10px}[dir=ltr] .od-ShareHintDetail-item{margin-right:4px}[dir=rtl] .od-ShareHintDetail-item{margin-left:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:#107c10}[dir=ltr] .od-ShareHintDetail-description{text-align:left}[dir=rtl] .od-ShareHintDetail-description{text-align:right}"}])});define("B6",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHint{background:0 0;margin:16px 16px 0 16px;position:relative}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;visibility:hidden}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:16px}.od-ShareHint .ms-Label{font-size:12px;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:10px;padding-top:9px;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3c3c3c"},{rawString:"}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:14px;font-weight:400;background:0 0;border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";width:100%;padding:10px;margin:0;opacity:0;transition:opacity .2s}@media screen and (-ms-high-contrast:active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.od-ShareHint .od-ShareHint-data:focus{border-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-ShareHint .od-ShareHint-data:focus{border:2px solid Highlight;outline:0}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:10px;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint .od-ShareHint--clickable{cursor:pointer}.od-ShareHint .od-ShareHint--clickable:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;box-sizing:border-box;border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";padding:14px 10px;background:linear-gradient(to right, "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 0, "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 50%, "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 100%);background-size:90% 100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";background-clip:content-box;background-repeat:no-repeat;animation:2s ease-in-out infinite placeholderShimmer;transition:opacity .2s,visibility .2s}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:36px;height:24px}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:24px;border-bottom:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}"}])});define("B4",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareNotification{text-align:center;position:relative;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-direction:column;flex-direction:column}.od-ShareNotification-successPadding{padding-top:24px}.od-ShareNotification-failPadding{padding-top:50px}.od-ShareNotification-icon{position:relative;margin-bottom:16px;opacity:0;transform:translateX(-50%) scale(.5,.5);transform-origin:50% 50%;background-color:#599b00;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:21px;border-radius:50%;width:44px;height:44px;animation:bounce .45s;animation-fill-mode:both;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;margin-left:44px}.od-ShareNotification-content{width:90%}[dir=ltr] .od-ShareNotification-content{padding-left:16px}[dir=rtl] .od-ShareNotification-content{padding-right:16px}[dir=ltr] .od-ShareNotification-content{padding-right:16px}[dir=rtl] .od-ShareNotification-content{padding-left:16px}.od-ShareNotification-permissionText{margin-bottom:24px;padding:0 20px}.od-ShareNotification-urlText{padding:10px 4px 12px 4px;display:-ms-flexbox;display:flex}.od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding:0}[dir=ltr] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-left:8px}[dir=rtl] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-right:8px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-fieldGroup{height:32px}.od-ShareNotification-close{position:absolute;top:16px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:12px;width:12px;height:12px;cursor:pointer}[dir=ltr] .od-ShareNotification-close{right:12px}[dir=rtl] .od-ShareNotification-close{left:12px}.od-ShareNotification-footer{margin-top:-10px;width:100%}@keyframes bounce{0%{transform:translateX(-50%) scaleX(.8) scaleY(.8);opacity:0}60%{transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;animation-timing-function:ease-out}100%{transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;animation-timing-function:ease-in}}.od-ShareNotification .od-ShareHint{margin:16px 0 0 0;padding:16px;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-ShareNotification .od-ShareHint--clickable{width:100%}.od-ShareNotification-copyCta{font-size:12px;font-weight:400}.od-ShareNotification-copyButton{height:32px;min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;width:auto}.od-ShareNotification-urlTextField{width:100%}.od-ShareNotification-accessRequestIcon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin-top:24px}.od-ShareNotification-accessRequestHeader{font-size:17px;font-weight:300;margin-bottom:8px}.od-ShareNotification-accessRequestBody{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";margin:0 8px 24px 8px;text-align:left}"}])});define("CV",["require","exports","ap","DF","Bs","CZ","CX","at","j8","o1","o7","CW"],function(e,t,i,o,n,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._strings=t.strings;return i}e.prototype.render=function(){var e,t=this._strings,i=this.props.sharingInformation,r=0<this.props.sharingInformation.sharingLinks.reduce(function(e,t){return e+(t.isActive?1:0)},-1);e=i.hasPermissionsInformation?i.isShared?l.createElement("div",null,l.createElement("ul",{className:"od-PermissionsList-links","aria-label":this._strings.permissionsListLinksLabel},this._renderLinks()),l.createElement(u.FocusZone,{direction:u.FocusZoneDirection.vertical},l.createElement("ul",{className:"od-PermissionsList-entities",role:"list","aria-label":this._strings.permissionsListPrincipalsLabel},this._renderPrincipals(r)))):l.createElement("div",null,t.notShared):l.createElement("div",{className:"od-Share-spinnerHolder"},l.createElement(c.Spinner,{className:"od-Share-spinner",label:this._strings.componentLoading,type:c.SpinnerType.large}));return l.createElement("div",{className:"od-PermissionsList"},l.createElement(o.Header,{clientId:this.props.clientId,item:i.item,viewState:4}),l.createElement("div",{className:"od-PermissionsList-section"},e))};e.prototype._renderLinks=function(){var i=this;return this.props.sharingInformation.sharingLinks.map(function(e,t){if(e.audience!==n.SharingAudience.specificPeople&&e.isActive)return l.createElement("li",{key:e.shareId},l.createElement(a.ShareLink,{companyName:i.props.companyName,link:e,takeFocus:0===t,clientId:i.props.clientId}))})};e.prototype._renderPrincipals=function(i){var r=this,o=this.props.sharingInformation;return o.sharingPrincipals.slice().map(function(e,t){return l.createElement("li",{key:e.id},l.createElement(s.SharePrincipal,{principal:e,takeFocus:!i&&0===t,userRole:o.userRole,clientId:r.props.clientId,appmap:r.props.sharingInformation.item.appmap}))})};e.contextTypes={strings:d.object.isRequired};return e}(l.Component);t.PermissionsList=r});define("CZ",["require","exports","ap","BT","at","j8","wN","mo","C1","o7","BC","BJ","BD","C0"],function(e,t,i,a,s,o,l,d,n,c,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._store=t.sharingStore;i._strings=t.strings;i._onShareLinkDelete=i._onShareLinkDelete.bind(i);i.state={linkRemovedText:""};return i}e.prototype.componentDidMount=function(){this._textField&&this.props.takeFocus&&!p.isMobile(this.props.clientId)&&this._textField.focus()};e.prototype.render=function(){var t=this,e=this.props.link,i=e.url,r=u.getLinkIconName(this.props.link),o=u.getLinkLabel(this.props.link,this._strings,this.props.companyName),n=e.principals&&0<e.principals.length||e.invitees&&0<e.invitees.length;return s.createElement("div",null,s.createElement("div",{className:"od-ShareLink"},s.createElement("div",{className:"od-ShareLink-icon"},s.createElement(d.Icon,{iconName:r})),s.createElement("div",{className:"od-ShareLink-details","aria-live":"polite","aria-atomic":"true","aria-relevant":"all","aria-labelledby":"descriptorLive"},s.createElement("div",{id:"descriptorLive",className:"ms-u-screenReaderOnly"},this.state.linkRemovedText),s.createElement(a.TextField,{"data-is-focusable":!0,autoFocus:!0,className:"od-ShareLink-url",defaultValue:i,readOnly:!0,ariaLabel:o,componentRef:function(e){return t._textField=e}}),s.createElement("div",{className:"od-ShareLink-description"},o)),s.createElement(l.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-delete",onClick:this._onShareLinkDelete,iconProps:{iconName:"Cancel"},ariaLabel:this._strings.removeLinkText})),n&&s.createElement(c.FocusZone,null,s.createElement("ul",{"aria-label":this._strings.linkMembersListLabel,className:"od-ShareLink-inviteesHolder","data-is-focusable":!0},this._renderLinkMembers())))};e.prototype._renderLinkMembers=function(){return this.props.link.principals.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl}}).concat(this.props.link.invitees.map(function(e){return{primaryText:e.name,imageUrl:e.image}})).map(function(e){return s.createElement("li",{key:e.primaryText,"data-is-focusable":!0},s.createElement(n.LinkMember,{primaryText:e.primaryText,imageUrl:e.imageUrl}))})};e.prototype._onShareLinkDelete=function(){var e=this.props.link;this.setState({linkRemovedText:m.default.linkRemovedText});this._store.unshareLink(e.sharingLinkKind,e.shareId)};e.contextTypes={sharingStore:o.object.isRequired,strings:o.object.isRequired};return e}(s.Component);t.ShareLink=r});define("C1",["require","exports","ap","jP","wE","xA","at","C2"],function(e,t,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i.state={isCalloutVisible:!1};i._uniqueId="j"+Math.random().toString().replace(".","");return i}e.prototype.render=function(){var e=this.props,t=this.state;return s.createElement("div",{className:"od-LinkMember"},s.createElement(a.Persona,{className:"od-LinkMember-Persona",primaryText:e.primaryText,initialsColor:a.PersonaInitialsColor.blue,size:a.PersonaSize.extraExtraSmall,onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,id:this._uniqueId,imageUrl:e.imageUrl}),t.isCalloutVisible&&s.createElement(n.Callout,{directionalHint:1,onDismiss:this._onDismissCallout,target:"#"+this._uniqueId+" ",setInitialFocus:!0},s.createElement("div",{className:"od-LinkMember-tooltip"},s.createElement("span",null,e.primaryText))))};e.prototype._onShowCallout=function(){this.setState(i.__assign({},this.state,{isCalloutVisible:!0}))};e.prototype._onDismissCallout=function(){this.setState(i.__assign({},this.state,{isCalloutVisible:!1}))};i.__decorate([o.autobind],e.prototype,"_onShowCallout",null);i.__decorate([o.autobind],e.prototype,"_onDismissCallout",null);return e}(s.Component);t.LinkMember=r});define("C2",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-LinkMember-Persona{width:32px}.od-LinkMember-tooltip{padding:8px}"}])});define("C0",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLink{display:-ms-flexbox;display:flex;margin-top:8px}.od-ShareLink-icon{position:relative;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:25px;border-radius:50%;width:50px;min-width:50px;height:50px}[dir=ltr] .od-ShareLink-icon{margin-right:10px}[dir=rtl] .od-ShareLink-icon{margin-left:10px}.od-ShareLink-icon i{position:absolute;top:50%}[dir=ltr] .od-ShareLink-icon i{left:50%}[dir=rtl] .od-ShareLink-icon i{right:50%}html[dir=ltr] .od-ShareLink-icon i{transform:translate(-50%,-50%)}html[dir=rtl] .od-ShareLink-icon i{transform:translate(50%,-50%)}.od-ShareLink-details{display:inline-block;vertical-align:top;width:100%}.od-ShareLink-url{margin-bottom:4px}.od-ShareLink-delete{top:-2px;font-size:12px;cursor:pointer;background:0 0;border:none;padding:0;height:40px}.od-ShareLink-description{margin-bottom:10px;font-size:12px}ul.od-ShareLink-inviteesHolder{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:-10px;width:200px}[dir=ltr] ul.od-ShareLink-inviteesHolder{margin-left:60px}[dir=rtl] ul.od-ShareLink-inviteesHolder{margin-right:60px}"}])});define("CX",["require","exports","ap","wt","xA","Bs","at","j8","mo","BJ","BD","aW","CY"],function(e,t,i,c,o,u,p,n,a,s,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f={ODB:772},r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i.state={showContextualMenu:!1};i._store=t.sharingStore;i._strings=t.strings;i._onChangeRoleClick=i._onChangeRoleClick.bind(i);i._onPermissionsClick=i._onPermissionsClick.bind(i);return i}e.prototype.componentDidMount=function(){this._focusElement&&this.props.takeFocus&&!s.isMobile(this.props.clientId)&&this._focusElement.focus()};e.prototype.render=function(){var t=this,e=this.props.principal;return p.createElement("div",{className:"od-SharePrincipal","data-is-focusable":!0,onClick:this._onPermissionsClick,role:"listitem","aria-label":e.primaryText+" "+this._computeRoleText(e),tabIndex:-1,ref:function(e){t._focusElement=e}},p.createElement(o.Persona,{className:"od-SharePrincipal-persona",hidePersonaDetails:!0,initialsColor:o.PersonaInitialsColor.blue,primaryText:e.primaryText,size:o.PersonaSize.regular,imageUrl:e.imageUrl}),p.createElement("div",{className:"od-SharePrincipal-details"},p.createElement("div",{className:"od-SharePrincipal-details-primaryText"},e.primaryText),this._renderChangePermissionsButton(e)))};e.prototype._computeRoleText=function(e){var t=this._strings,i=this.props.principal.role;if("number"!=typeof i)return e.sharingLinkKind?t.accessViaSharingLink:"";switch(i){case 2:return t.canEditLabel;case 6:return m.default.canReviewRole;case 1:return t.canViewLabel;case 3:return t.ownerLabel;default:return""}};e.prototype._renderChangePermissionsButton=function(e){var t=e.role,i=this._computeRoleText(e);return 3!==this.props.userRole||2!==t&&1!==t&&6!==t?p.createElement("div",{className:"od-SharePrincipal-permissions-role"},i):p.createElement("button",{className:"od-SharePrincipal-permissions",onClick:this._onPermissionsClick,"data-is-focusable":!1},p.createElement("div",{className:"od-SharePrincipal-permissions-role"},i),this._renderChevron(e.role),this._renderContextualMenu(e.role))};e.prototype._renderChevron=function(e){if(2===e||1===e||6===e)return p.createElement("div",{className:"od-SharePrincipal-permissions-icon"},p.createElement(a.Icon,{iconName:"ChevronDown"}))};e.prototype._renderContextualMenu=function(e){var t,i,r,o,n=this,a=this.props,s=this._strings,l=h.default.isFeatureEnabled(f),d=a.clientId===u.ClientId.word||a.appmap&&"ms-word"===a.appmap;switch(e){case 1:t=2;i=m.default.allowEdit;r=6;o=m.default.ReviewOnly;break;case 6:t=2;i=m.default.allowEdit;r=1;o=m.default.changeToViewOnly;break;case 2:t=1;i=m.default.changeToViewOnly;r=6;o=m.default.ReviewOnly}return this.state.showContextualMenu&&l&&d?p.createElement(c.ContextualMenu,{items:[{key:"editable1",name:i,onClick:this._onChangeRoleClick.bind(this,t)},{key:"editable2",name:o,onClick:this._onChangeRoleClick.bind(this,r)},{key:"stopSharing",name:""+s.stopSharing,onClick:this._onStopSharingClick.bind(this)}],onDismiss:function(){n.setState({showContextualMenu:!1})},directionalHint:4,isBeakVisible:!0,target:this.state.target}):this.state.showContextualMenu?p.createElement(c.ContextualMenu,{items:[{key:"editable1",name:i,onClick:this._onChangeRoleClick.bind(this,t)},{key:"stopSharing",name:""+s.stopSharing,onClick:this._onStopSharingClick.bind(this)}],onDismiss:function(){n.setState({showContextualMenu:!1})},directionalHint:4,isBeakVisible:!0,target:this.state.target}):void 0};e.prototype._onChangeRoleClick=function(e){this._store.updatePermissions(this.props.principal,e)};e.prototype._onStopSharingClick=function(e){this._store.updatePermissions(this.props.principal,0)};e.prototype._onPermissionsClick=function(e){var t=this.props.principal.role;(2===t||1===t||6===t)&&this.setState({showContextualMenu:!0,target:e.nativeEvent.target})};e.contextTypes={sharingStore:n.object.isRequired,strings:n.object.isRequired};return e}(p.Component);t.SharePrincipal=r});define("CY",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharePrincipal{padding:8px 0;display:-ms-flexbox;display:flex}.od-SharePrincipal-persona{display:inline-block;width:52px;height:52px}[dir=ltr] .od-SharePrincipal-persona{margin-right:8px}[dir=rtl] .od-SharePrincipal-persona{margin-left:8px}.od-SharePrincipal-persona .ms-Persona{height:50px}.od-SharePrincipal-persona .ms-Persona-imageArea{width:50px;height:50px;max-width:50px}.od-SharePrincipal-persona .ms-Persona-initials{line-height:50px;height:50px}.od-SharePrincipal-details{display:inline-block;vertical-align:top;width:200px}.od-SharePrincipal-details-primaryText{font-size:17px;font-weight:300;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-SharePrincipal-permissions{cursor:pointer;background:0 0;border:none;padding:0}.od-SharePrincipal-details-secondaryText,.od-SharePrincipal-permissions-role{font-size:12px;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharePrincipal-permissions-role{display:inline-block}.od-SharePrincipal-permissions-icon{display:inline-block;font-size:12px;margin-top:2px}[dir=ltr] .od-SharePrincipal-permissions-icon{margin-left:4px}[dir=rtl] .od-SharePrincipal-permissions-icon{margin-right:4px}.od-SharePrincipal-deleteIcon{position:absolute;top:12px;cursor:pointer;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SharePrincipal-deleteIcon{right:8px}[dir=rtl] .od-SharePrincipal-deleteIcon{left:8px}"}])});define("CW",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsList-section{padding:20px 16px}"}])});define("Ce",["require","exports","ap","jP","DF","Bs","Cj","Ch","B5","at","j8","Cg","BJ","BH","BK","mo","wN","BL","BB","BC","Bn","Cf"],function(e,t,l,i,a,d,o,n,s,c,u,p,m,h,f,g,y,v,_,b,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){l.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._strings=t.strings;i._platformDetection=t.platformDetection;i._breakpoint=t.breakpoint;i.state={isAttachAsCopyContextualMenuVisible:!1,shareType:d.ShareType.share,showActivityIndicator:!1,peoplePickerErrorMessage:null};return i}e.prototype.componentDidMount=function(){_.pageFinishedLoading(this.props.clientId,this.props.scenarioId);this._updatePeoplePickerError(this.props)};e.prototype.componentWillReceiveProps=function(e){this._updatePeoplePickerError(e)};e.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=this.props,i=this.state.showActivityIndicator?this._getActivityMessage():"",r=this.props.hideShareDialogOverflowButton||!1,o=this._renderFooter(),n=o?{class:"od-ShareMain-section-body"}:null;return c.createElement("div",{className:"od-ShareMain"+e},c.createElement(a.Header,{ctaLabel:this._strings.sendButtonLabel,clientId:t.clientId,currentSettings:t.currentSettings,errorMessage:this.state.peoplePickerErrorMessage,item:t.item,linkRecipients:t.linkRecipients,permissionsMap:t.permissionsMap,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,onSendLinkClick:this._onSendLinkClicked,messageText:this.props.messageText,viewState:0,sharingInformation:t.sharingInformation,hideShareDialogOverflowButton:r,maximumMessageLength:500}),c.createElement("div",l.__assign({},n),c.createElement("div",{className:"od-ShareMain-section full-bleed"},c.createElement(s.ShareHint,{companyName:t.companyName,currentSettings:t.currentSettings,onShareHintClick:t.onShareHintClicked,sharingInformation:t.sharingInformation,shouldTakeFocus:!t.enableShimmer,linkRecipients:null})),this._renderSendLink(),this._renderTargets()),o,this._renderActivityIndicator(),c.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},i))};e.prototype._renderTargets=function(){return c.createElement("div",{className:"od-ShareMain-targets"},c.createElement(n.ShareTargets,{clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this._onShareTargetClicked,onShareTargetsRendered:this.props.onShareTargetsRendered,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}))};e.prototype._renderFooter=function(){var e=this.props.clientId;if(m.isOfficeProduct(e)){var t=p.default.getAttachAsCopyOptions(e,this._strings);if(0<t.length)return c.createElement("div",null,c.createElement(y.DefaultButton,{className:"od-ShareMain-footer",text:this._strings.attachACopyInstead,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:t}}))}else if((e===d.ClientId.ngsc||m.isMobile(e))&&this._isSendCopyEnabled())return c.createElement("div",null,c.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},c.createElement("div",{className:"od-ShareMain-attachIcon"},c.createElement(g.Icon,{iconName:"Copy"})),c.createElement("span",null,this._strings.attachACopyInstead)))};e.prototype._renderSendLink=function(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||b.isLoadingData(this.props.sharingInformation)){var e=m.isMobile(this.props.clientId)||this._platformDetection.isMobile,t=e&&this._breakpoint>=x.default.DEFAULT_BREAKPOINTS.Large,i=this.props;return c.createElement("div",{className:"od-ShareMain-section"},c.createElement(o.SendLink,{ctaLabel:this._strings.sendButtonLabel,showTextArea:!0,sharingInformation:i.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:i.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:i.groupsMemberCount,onViewPolicyTipClicked:i.onViewPolicyTipClicked,linkRecipients:i.linkRecipients,permissionsMap:i.permissionsMap,messageText:i.messageText,onSendLinkMessageChange:i.onSendLinkMessageChange,createPeopleSharingLinks:i.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:i.clientId,showSendButton:!e||t,maximumMessageLength:500,isLoadingDefaultRecipients:i.isLoadingDefaultRecipients}))}};e.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return c.createElement(h.ActivityIndicator,{message:this._getActivityMessage()})};e.prototype._onSelectedPeopleChange=function(e){var t=this.props,i=f.renderPickerError({selectedItems:e,sharingLinkKind:t.currentSettings.sharingLinkKind,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked,strings:this._strings,permissionsMap:t.permissionsMap});if(i){for(var r=t.currentSettings.sharingLinkKind,o=3===r||2===r,n=!1,a=0,s=e;a<s.length;a++){if(s[a].isExternal&&o){n=!0;break}}n&&v.externalSharingCslError(t.engagementExtraData)}this.setState(l.__assign({},this.state,{peoplePickerErrorMessage:i}),function(){t.onSelectedPeopleChange(e)})};e.prototype._onShareTargetClicked=function(e){var t=this;!this._isPeoplePickerValid(e)&&(this.props.currentSettings.audience===d.SharingAudience.specificPeopleFlex||0<this.props.linkRecipients.length)||this.setState(l.__assign({},this.state,{showActivityIndicator:!0,shareType:e}),function(){t.props.onShareTargetClicked(e)})};e.prototype._onSendLinkClicked=function(e){var t=this;this._isPeoplePickerValid(d.ShareType.share)&&this.setState(l.__assign({},this.state,{showActivityIndicator:!0,shareType:d.ShareType.share}),function(){t.props.onSendLinkClicked(e)})};e.prototype._onAttachAsCopyClicked=function(){var e=this.props.clientId;if(m.isOfficeProduct(e)){var t=!this.state.isAttachAsCopyContextualMenuVisible;this.setState(l.__assign({},this.state,{isAttachAsCopyContextualMenuVisible:t}),function(){})}else if(e===d.ClientId.ngsc||m.isMobile(e))try{window.external.SendCopy()}catch(e){}};e.prototype._getActivityMessage=function(){var e=this._strings;switch(this.state.shareType){case d.ShareType.share:return e.activityMessageSendingMail;case d.ShareType.copy:case d.ShareType.outlook:case d.ShareType.nonOutlook:case d.ShareType.teams:case d.ShareType.moreApps:default:return e.activityMessageCreatingLink}};e.prototype._isSendCopyEnabled=function(){try{return window.external.IsSendCopyEnabled()}catch(e){return!1}};e.prototype._isPeoplePickerValid=function(e){if(!this.state.peoplePickerErrorMessage){if(e!==d.ShareType.share&&!this.props.createPeopleSharingLinks&&this.props.currentSettings.audience===d.SharingAudience.specificPeople){for(var t=!1,i=!1,r=0,o=this.props.linkRecipients;r<o.length;r++){var n=o[r];t||(t=n.isExternal&&!n.providerName);i||(i=!n.isExternal||n.isExternal&&!!n.providerName)}if(t&&i){this.setState(l.__assign({},this.state,{peoplePickerErrorMessage:c.createElement("span",null,this._strings.mixedRecipientErrorMessage)}));return!1}}var a=document.querySelector(".od-Share-PeoplePicker .ms-BasePicker-input"),s=this.props.currentSettings.audience===d.SharingAudience.specificPeopleFlex||e===d.ShareType.share;if(a.value){this.setState(l.__assign({},this.state,{peoplePickerErrorMessage:c.createElement("span",null,this._strings.unresolvedTextError)}));return!1}if(0===this.props.linkRecipients.length&&s){this.setState(l.__assign({},this.state,{peoplePickerErrorMessage:c.createElement("span",null,this._strings.recipientsRequiredError)}));return!1}return!0}};e.prototype._updatePeoplePickerError=function(e){if(e.linkRecipients){var t=f.renderPickerError({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,strings:this._strings,permissionsMap:e.permissionsMap});this.setState(l.__assign({},this.state,{peoplePickerErrorMessage:t}))}};e.contextTypes={strings:u.object.isRequired,platformDetection:u.object.isRequired,breakpoint:u.object.isRequired};l.__decorate([i.autobind],e.prototype,"_onSelectedPeopleChange",null);l.__decorate([i.autobind],e.prototype,"_onShareTargetClicked",null);l.__decorate([i.autobind],e.prototype,"_onSendLinkClicked",null);l.__decorate([i.autobind],e.prototype,"_onAttachAsCopyClicked",null);return e}(c.Component);t.ShareMain=r});define("Cj",["require","exports","ap","jP","BT","BK","at","j8","Co","Cm","Cl","BC","o1","BD","Ck"],function(e,t,i,o,n,s,l,a,d,c,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._strings=t.strings;i.state={messageLength:0};return i}e.prototype.componentWillReceiveProps=function(e){s.renderPickerError({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,strings:this._strings,permissionsMap:e.permissionsMap});this.setState(i.__assign({},this.state))};e.prototype.render=function(){var e=this.props,t=e.currentSettings,i=e.linkRecipients,r=s.getOversharingExternalsWarning(i,this._strings),o=s.getOversharingGroupsWarning(i,e.groupsMemberCount,this._strings),n=this.props.showSendButton?l.createElement("div",{className:"od-SendLink-emailButtons"},l.createElement(c.default,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,messageText:this.props.messageText,onSendLinkClicked:this.props.onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:u.default.button,sharingInformation:this.props.sharingInformation})):"",a=e.isLoadingDefaultRecipients?l.createElement("div",null,l.createElement(m.Spinner,{className:"od-SendLink-spinner",label:h.default.loadingRecipients,size:m.SpinnerSize.small})):l.createElement(d.default,{defaultSelectedItems:i,error:e.errorMessage,onChange:e.onSelectedPeopleChange,oversharingExternalsWarning:r,oversharingGroupsWarning:o,pickerSettings:e.sharingInformation.peoplePickerSettings,sharingLinkKind:t.sharingLinkKind,sharingInformation:e.sharingInformation,permissionsMap:e.permissionsMap,clientId:e.clientId});return l.createElement("div",{className:"od-SendLink"},l.createElement("div",{className:"od-SendLink-email"},a,l.createElement("div",{className:"od-SendLink-message"},this._renderTextArea(),this._renderCharacterCounter(),n)))};e.prototype._renderTextArea=function(){if(this.props.showTextArea)return l.createElement(n.TextField,{placeholder:this._strings.messagePlaceholder,ariaLabel:h.default.messageAriaLabel,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText})};e.prototype._renderCharacterCounter=function(){var e=this.state.messageLength,t="od-SendLink-characterCounter "+(e>this.props.maximumMessageLength?"od-SendLink-characterCounter--error":"");if(e>this.props.maximumMessageLength/2)return l.createElement("span",{className:t},e,"/",this.props.maximumMessageLength)};e.prototype._validateMessage=function(e){this.props.onSendLinkMessageChange(e);var t=p.getEncodedMessageLength(e);this.setState(i.__assign({},this.state,{messageLength:t}));return""};e.contextTypes={strings:a.object.isRequired};i.__decorate([o.autobind],e.prototype,"_validateMessage",null);return e}(l.Component);t.SendLink=r});define("Ck",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:1px solid "},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-SendLink-message{margin-top:16px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:12px;font-weight:400;font:-apple-system-caption2}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline div{border-color:transparent}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir=ltr] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir=rtl] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir=ltr] .od-SendLink-ITPolicy{right:0}[dir=rtl] .od-SendLink-ITPolicy{left:0}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:65px;padding:6px 0 7px 0}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:12px;font-weight:400;font:-apple-system-caption2}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input:-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-characterCounter{font-size:12px;font-weight:400}[dir=ltr] .od-SendLink-characterCounter{float:right}[dir=rtl] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:#a80000}"}])});define("Ch",["require","exports","ap","Bs","at","j8","BJ","jP","mo","BC","xs","BD","Ci"],function(e,t,i,u,p,o,n,a,m,h,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._strings=t.strings;return i}e.prototype.render=function(){var e=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==u.SharingAudience.existing;this._shareTargetsData=this._getShareTargetsData();if(!h.isLoadingData(this.props.sharingInformation)){for(var t=[],i=0,r=this._shareTargetsData;i<r.length;i++){var o=r[i];t.push(o.shareType)}this.props.onShareTargetsRendered(t)}return e?p.createElement("div",{className:"od-ShareTargets"},p.createElement(s.TooltipHost,{content:this._strings.accessRequestTooltip,calloutProps:{calloutWidth:300,directionalHint:1}},p.createElement("ul",{className:"od-ShareTargets-items",role:"group","aria-label":this._strings.otherWaysToShareLabel},this._renderTargets()))):p.createElement("div",{className:"od-ShareTargets"},p.createElement("ul",{className:"od-ShareTargets-items",role:"group","aria-label":this._strings.otherWaysToShareLabel},this._renderTargets()))};e.prototype._renderTargets=function(){for(var e=[],t=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==u.SharingAudience.existing,i=0,r=this._shareTargetsData;i<r.length;i++){var o=r[i],n=void 0,a=o.icon,s=a.split(":",2)[1],l=t||h.isLoadingData(this.props.sharingInformation),d="od-ShareTargets-icon "+(l?"od-ShareTargets-disabled":""),c="od-ShareTargets-itemText ms-font-xs "+(l?"od-ShareTargets-disabled":"");n=-1<a.indexOf("font:")?p.createElement(m.Icon,{iconName:s,className:d}):p.createElement("img",{src:s,className:d});e.push(p.createElement("li",{key:o.shareType,className:"od-ShareTargets-item"},p.createElement("button",{className:"od-ShareTargets-target",disabled:l,onClick:o.action},p.createElement("div",{className:"od-ShareTargets-itemImage"},n),p.createElement("div",{className:c},o.label))))}return e};e.prototype._getShareTargetsData=function(){var e=[{label:this._strings.copyLinkLabel,icon:"font:Link",bgColor:"ms-bgColor-themePrimary",shareType:u.ShareType.copy,action:this._onClick.bind(this,u.ShareType.copy)}],t=this._determineMailShareTarget(this.props.clientId);t===u.OutlookAvailability.available?e.push({label:this._strings.outlookLabel,icon:"font:OutlookLogo",bgColor:"ms-bgColor-themePrimary",shareType:u.ShareType.outlook,action:this._onClick.bind(this,u.ShareType.outlook)}):t===u.OutlookAvailability.other&&e.push({label:this._strings.nonOutlookLabel,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:u.ShareType.nonOutlook,action:this._onClick.bind(this,u.ShareType.nonOutlook)});this._isTeamsShareTargetEnabled()&&e.push({label:l.default.teamsLabel,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:u.ShareType.teams,action:this._onClick.bind(this,u.ShareType.teams)});this._isMoreAppsShareTargetEnabled()&&e.push({label:this._strings.moreAppsLabel,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:u.ShareType.moreApps,action:this._onClick.bind(this,u.ShareType.moreApps)});return e};e.prototype._onClick=function(e,t){this.props.onShareTargetClicked(e)};e.prototype._determineMailShareTarget=function(e){if(n.showOWAShareTarget(this.props.clientId)&&this.props.outlookAvailability===u.OutlookAvailability.available)return u.OutlookAvailability.available;try{return window.external.CheckSendViaOutlookAvailability()}catch(e){return u.OutlookAvailability.none}};e.prototype._isTeamsShareTargetEnabled=function(){try{return window.external.IsTeamsEnabled()}catch(e){return!1}};e.prototype._isMoreAppsShareTargetEnabled=function(){try{return window.external.IsMoreAppsEnabled()}catch(e){return!1}};e.contextTypes={strings:o.object.isRequired};i.__decorate([a.autobind],e.prototype,"_determineMailShareTarget",null);return e}(p.Component);t.ShareTargets=r});define("Ci",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir=ltr] .od-ShareTargets-items{margin-right:-10px}[dir=rtl] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir=ltr] .od-ShareTargets-item{margin-right:10px}[dir=rtl] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{-ms-flex-align:center;-ms-grid-row-align:center;align-items:center;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";border-radius:50%;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3c3c3c"},{rawString:";cursor:pointer;display:inline-block;height:48px;margin-bottom:8px;width:48px}.od-ShareTargets-icon{font-size:25px;padding-top:11px}.od-ShareTargets-itemImage--border{border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-ShareTargets-itemText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font:-apple-system-short-caption1}.od-ShareTargets-target{background:0 0;border:none}.od-ShareTargets-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}"}])});define("Cg",["require","exports","Bs"],function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){(i||(i={})).getAttachAsCopyOptions=function(e,t){var i=[],r=function(e,t){var i=!1;try{var r=window.external;i=r.IsSendCopyEnabled()}catch(e){}if(i)return e===s.ClientId.word?{key:"word",name:t.wordDocument,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:n}:e===s.ClientId.powerpoint?{key:"powerpoint",name:t.powerPointPresentation,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:n}:e===s.ClientId.excel?{key:"excel",name:t.excelWorkbook,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:n}:e===s.ClientId.visio?{key:"visio",name:t.visioDrawing,iconProps:{iconName:"VisioLogo"},onClick:n}:{key:"document",name:t.document,iconProps:{iconName:"Document"},onClick:n}}(e,t);r&&i.push(r);var o=function(e){var t=!1;try{var i=window.external;t=i.IsSendPdfEnabled()}catch(e){}if(t)return{key:"pdf",name:e.pdf,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:a}}(t);o&&i.push(o);return i};function n(){try{window.external.SendCopy()}catch(e){}}function a(){try{window.external.SendPdf()}catch(e){}}}();t.default=i});define("BL",["require","exports","ap","a0","Bs"],function(e,t,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="ShareV3";t.opened=function(e){this._log("Opened",e)};t.linkSettingsOpened=function(e){this._log("LinkSettings.Opened",e)};t.linkSettingsApplyClicked=function(e){this._log("LinkSettings.ApplyClicked",e)};t.linkSettingsCancelClicked=function(e){this._log("LinkSettings.CancelClicked",e)};t.manageAccessOpened=function(e){this._log("ManageAccess.Opened",e)};t.shareCompleted=function(e){this._log("Completed",e)};t.shareTargets=function(e){this._log("ShareTargets",e)};t.trackClickThru=function(e){this._log("ClickThruTracker",e)};t.externalSharingCslError=function(e){this._log("externalSharingCslError",e)};t._log=function(e,t){var i=o.__assign({},t,{clientId:a.ClientId[t.clientId],scenarioId:t.scenarioId,mode:a.Mode[t.mode],shareType:a.ShareType[t.shareType],audience:a.SharingAudience[t.audience],shareTargets:this._getFriendlyShareTargets(t.shareTargets)}),r={name:s+"."+e,extraData:i};n.Engagement.logData(r)};t._getFriendlyShareTargets=function(e){var t=[];if(e)for(var i=0,r=e;i<r.length;i++){var o=r[i];t.push(a.ShareType[o])}return t}});define("Cf",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}.od-ShareMain-section{padding:20px 16px 0 16px}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-targets{padding:0 20px 20px 20px}.od-ShareMain-section-body{margin-bottom:44px}.od-ShareMain-footer{font-size:12px;font-weight:400;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:start;justify-content:flex-start;padding:0 16px;width:100%;height:44px;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";cursor:pointer;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";font:-apple-system-caption1;bottom:0;position:fixed}.od-ShareMain-footer:focus{border:1px solid transparent}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir=ltr] .od-ShareMain-attachIcon{margin-right:4px}[dir=rtl] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}"}])});define("BN",["require","exports","ap","hs","DF","BP","at","j8","jP","BO"],function(e,t,i,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i._strings=t.strings;i._store=t.sharingStore;i._resize=t.resize;i.state={showJustificationInput:!1};return i}e.prototype.componentDidUpdate=function(){this._resize()};e.prototype.render=function(){var e=this.props,t=this.state,i=e.policyTipInformation.info;return s.createElement("div",{className:"od-SharePolicyDetails"},s.createElement(n.Header,{clientId:e.clientId,item:e.sharingInformation.item,viewState:6}),s.createElement("div",{className:"od-Share-PolicyTip"},s.createElement(a.PolicyTip,{confirmationText:this._getConfirmationText(),onDismissed:function(){},onOverrideClicked:this._onOverrideClicked,onOverrideSubmitClicked:this._onOverrideSubmitClicked,overrideRequiresJustification:i?2===i.overrideOption:void 0,showJustificationInput:t.showJustificationInput,onReportClicked:this._onReportClicked,strings:this._getStrings()})))};e.prototype._getStrings=function(){var e=this.props.policyTipInformation.info,t=this._strings,i=e&&(1===e.overrideOption||2===e.overrideOption);return{headerText:t.ptHeader,issues:e?e.issueDescriptions:void 0,lastScannedText:e&&e.lastScanned?t.ptLastScanned+": "+o.getRelativeDateTimeStringPast(e.lastScanned):void 0,learnMoreActionLabel:e?t.ptLearnMoreActionLabel:void 0,learnMoreLabel:e?t.ptLearnMoreLabel:void 0,learnMoreUrl:e?e.policyInfoUrl:void 0,noPolicyTipInfoError:e?void 0:t.ptNoPolicyTipInfo,overrideActionLabel:i?t.ptOverrideActionLabel:void 0,overrideLabel:t.ptOverrideLabel,policyTipDescription:e?e.explanationText:void 0,reportActionLabel:t.ptReportActionLabel,reportLabel:t.ptReportLabel,reportInProgressLabel:t.ptReportInProgress,submitButtonLabel:t.ptSubmitLabel,titleText:void 0}};e.prototype._getConfirmationText=function(){var e=this.props.policyTipInformation.actionResult;return null===e?"":1===e?this._strings.ptReportConfirmation:2===e||3===e?this._strings.ptOverrideConfirmation:""};e.prototype._onOverrideClicked=function(){var e=this.props.policyTipInformation.info.overrideOption;1===e?this._store.updatePolicy(0):2===e&&this.setState(i.__assign({},this.state,{showJustificationInput:!0}))};e.prototype._onOverrideSubmitClicked=function(e){this._store.updatePolicy(0,e)};e.prototype._onReportClicked=function(){this._store.updatePolicy(1)};e.contextTypes={strings:l.object.isRequired,sharingStore:l.object.isRequired,resize:l.func.isRequired};i.__decorate([d.autobind],e.prototype,"_onOverrideClicked",null);i.__decorate([d.autobind],e.prototype,"_onOverrideSubmitClicked",null);i.__decorate([d.autobind],e.prototype,"_onReportClicked",null);return e}(s.Component);t.SharePolicyDetails=r});define("BO",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PolicyTip{padding:0 16px 10px 16px}.od-Share-PolicyTip .od-PolicyTip-title{display:none}"}])});define("BF",["require","exports","ap","Bs","BH","jP","DF","x6","xA","wN","o1","BL","at","j8","BB","BG"],function(e,t,i,n,r,a,s,l,d,c,u,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e)||this;i._dismiss=t.onDismiss;i._resize=t.resize;i._store=t.sharingStore;i._strings=t.strings;var r=0===e.recipients.length;r||i._notifyReady();i.state={canShare:i._canShare(e.recipients),isLoading:r,isSharing:!1};return i}e.prototype.componentWillReceiveProps=function(e){var t=0===e.recipients.length;this.state.isLoading&&!t&&this._notifyReady();this.setState({canShare:this._canShare(e.recipients),isLoading:t})};e.prototype.componentDidUpdate=function(){setTimeout(this._resize,10)};e.prototype.componentDidMount=function(){var t=this;this._notifyReadyForRecipients();this._store.addListener(function(){var e=t._store.getGrantAccessResult();if(null!==e){t._notifyGrantAccessCompleted(e);t._dismiss()}})};e.prototype.render=function(){var e,t=this.state,i=t.canShare,r=t.isLoading,o=t.isSharing;e=r?this._renderLoadingSpinner():i?this._renderHappyPath():this._renderSadPath();return m.createElement("div",{className:"od-AtMention "+(o?"od-AtMention--isSharing":"")},!r&&m.createElement(s.Header,{mode:n.Mode.atMention,viewState:5}),e,this._renderSharingActivityIndicator(),m.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},this._getScreenReaderAlertMessage()))};e.prototype._renderLoadingSpinner=function(){return m.createElement("div",{className:"od-AtMention-spinnerHolder"},m.createElement(u.Spinner,{className:"od-AtMention-spinner",label:this._strings.componentLoading,type:u.SpinnerType.large}))};e.prototype._renderSharingActivityIndicator=function(){if(this.state.isSharing)return m.createElement(r.ActivityIndicator,{message:this._strings.grantAccessActivityIndicatorString})};e.prototype._renderHappyPath=function(){return m.createElement("div",{className:"od-AtMention-container"},this._renderRecipients(!1),m.createElement("div",{className:"od-AtMention-message"},this._strings.atMentionHappyMessage),m.createElement(c.PrimaryButton,{className:"od-AtMention-button",onClick:this._onShareClicked},this._strings.shareAndNotifyButtonLabel))};e.prototype._renderSadPath=function(){var e=this.props.sharingInformation;return m.createElement("div",{className:"od-AtMention-container"},m.createElement(l.MessageBar,{messageBarType:l.MessageBarType.warning},e.canManagePermissions?this._strings.atMentionSadMessageRecipient:this._strings.atMentionSadMessageOwner),this._renderRecipients(!0),m.createElement(c.PrimaryButton,{className:"od-AtMention-button",onClick:this._onOkayClicked},this._strings.okayButtonLabel))};e.prototype._renderRecipients=function(e){var i=this,t=this.props.recipients.map(function(e){var t=i._isRecipientInvalid(e);return m.createElement("li",null,m.createElement(d.Persona,{className:"od-AtMention-recipient "+(t?"od-AtMention-recipient--error":""),imageUrl:e.image,primaryText:e.name,size:d.PersonaSize.extraSmall}))});return m.createElement("ul",{className:"od-AtMention-recipients "+(e?"od-AtMention-recipients--error":""),"aria-label":this._strings.grantAccessRecipientsListLabel},t)};e.prototype._onShareClicked=function(){var e=this;this.setState({isSharing:!0},function(){p.shareCompleted({clientId:e.props.clientId,scenarioId:e.props.scenarioId,mode:n.Mode.atMention});e._store.grantAccess(e.props.recipients)})};e.prototype._onOkayClicked=function(){this._notifyGrantAccessCompleted(!1);this._dismiss()};e.prototype._getScreenReaderAlertMessage=function(){var e=this._strings;return this.state.isSharing?e.grantAccessActivityIndicatorString:e.grantAccessPageLabel};e.prototype._canShare=function(e){var t=this;return!!this.props.sharingInformation.canManagePermissions&&e.every(function(e){return!t._isRecipientInvalid(e)})};e.prototype._isRecipientInvalid=function(e){return!e.isResolved||e.isExternal&&!e.providerName};e.prototype._notifyReady=function(){f.pageFinishedLoading(this.props.clientId,this.props.scenarioId)};e.prototype._notifyReadyForRecipients=function(){f.readyForRecipients()};e.prototype._notifyGrantAccessCompleted=function(e){f.grantAccessCompleted(e)};e.contextTypes={onDismiss:h.func.isRequired,resize:h.func.isRequired,sharingStore:h.object.isRequired,strings:h.object.isRequired};i.__decorate([a.autobind],e.prototype,"_onShareClicked",null);i.__decorate([a.autobind],e.prototype,"_onOkayClicked",null);return e}(m.Component);t.AtMention=o});define("BG",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AtMention{max-height:550px;min-height:150px;overflow-y:auto;position:relative;min-width:320px}.od-AtMention ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-AtMention li{display:-ms-inline-flexbox;display:inline-flex;margin-bottom:8px}[dir=ltr] .od-AtMention li{margin-right:4px}[dir=rtl] .od-AtMention li{margin-left:4px}.od-AtMention.od-AtMention--isSharing{position:relative}.od-AtMention.od-AtMention--isSharing:after{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:0;content:'';left:0;opacity:.8;position:absolute;right:0;top:0}.od-AtMention .od-AtMention-container{display:inline-block;margin:16px 16px 0 16px}.od-AtMention .od-AtMention-recipients{margin-bottom:16px;max-height:200px;overflow-y:auto}.od-AtMention .od-AtMention-recipients--error{margin-top:16px}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";border-style:solid;border-width:thin}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error .ms-Persona-primaryText{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-AtMention .od-AtMention-recipient{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";border-radius:16px}.od-AtMention .od-AtMention-message{margin-bottom:16px}.od-AtMention .od-AtMention-button{margin-bottom:16px}.od-AtMention .od-AtMention-spinnerHolder{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:150px;-ms-flex-pack:center;justify-content:center}"}])});define("BA",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share{position:relative;min-width:320px;min-height:150px;overflow-y:auto;overflow-x:hidden}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share .icon-Globe{color:#107c10;border-color:#107c10;background-color:rgba(16,124,16,.06)}.od-Share .icon-Work{color:#0078d7;border-color:#0078d7;background-color:rgba(0,120,215,.06)}.od-Share .icon-PeopleAdd{color:#ff8c00;border-color:#ff8c00;background-color:rgba(255,140,0,.06)}.od-Share .icon-SecurityGroup{color:#d83b01;border-color:#d83b01;background-color:rgba(216,59,1,.06)}.od-Share .icon-Group{border-color:#d9b108;color:#d9b108;background-color:#fffdf4}.od-Share .ms-Tooltip{pointer-events:none}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-Share{width:320px}}button.od-Share-backButton{background:0 0;border:none;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-size:16px;padding:0;position:absolute;top:8px}[dir=ltr] button.od-Share-backButton{left:10px}[dir=rtl] button.od-Share-backButton{right:10px}html[dir=rtl] button.od-Share-backButton{transform:scale(-1,1)}.od-Share-spinnerHolder{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;height:150px;-ms-flex-pack:center;justify-content:center}.od-Share-error{padding:16px;font-size:14px;font-weight:400;word-break:break-word}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}])});define("Bo",["require","exports","ap","DM","DI","yk","Bf","Bp"],function(e,t,r,o,n,a,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){r.__extends(e,i);function e(e,t){return i.call(this,e,t)||this}e.dependencies={sharingProvider:n.resourceKey,suiteNavProvider:a.resourceKey,peoplePickerProvider:o.resourceKey,policyTipProvider:s.resourceKey};return e}(i.default);t.default=l});define("Bf",["require","exports","ap","bA","dZ","bN"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._dataSource=t.policyTipDataSource;return i}e.prototype.getPolicyTip=function(e){return this._dataSource.getPolicyTip(e)};e.prototype.updatePolicy=function(e){return this._dataSource.updatePolicy(e)};e.dependencies=i.__assign({},n.default.dependencies,{policyTipDataSource:o.policyTip});return e}(n.default);t.default=a;t.resourceKey=r.createResolvedResourceKey(e("module").id,a)});define("Bp",["require","exports","ap","Bs","DO","hb","aZ","aC","aW","V","bT"],function(e,t,g,y,c,s,i,u,v,_,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b={ODB:781},x={ODB:469},r=function(){function e(e,t){var r=this;this._listeners=null;var i=e.item,o=e.strings,n=e.sharingInformation,a=e.defaultRecipients,s=e.accessChecked,l=void 0===s||s,d=e.mode;this._item=i;this._strings=o;this._sharingProvider=t.sharingProvider;this._suiteNavProvider=t.suiteNavProvider||void 0;this._graphPeoplePickerHelper=t.graphPeoplePickerHelper;this._peoplePickerProvider=t.peoplePickerProvider;this._policyTipProvider=t.policyTipProvider||void 0;this._firstShareLinkRequest=!0;this._listeners=[];this._groupsMemberCountCache=[];this._sharingInformationInvalidated=!1;this._store={sharingInformation:n,sharingLinkCreated:null,companyName:o.companyNameFallback,groupsMemberCount:0,policyTipInfo:{info:null,actionResult:null},permissionsMap:{},invitedUsers:[],defaultLink:null,defaultRecipients:null,outlookAvailability:c.OutlookAvailability.none,grantAccessResult:null,accessRequestCreated:!1,isValidatingDefaultRecipients:!1};if(a&&0!==a.length)this._resolveDefaultRecipients(a,l,d);else{this._eventGroup=new p.default(this);this._eventGroup.on(window,"message",function(e){if(e&&e.data)try{var t=JSON.parse(e.data);if("atMention_defaultRecipients"===t.name){var i=t.recipientIds;r._resolveDefaultRecipients(i,l,d)}}catch(e){}})}}e.prototype.addListener=function(e){this._listeners.push(e)};e.prototype.getSharingInformation=function(){return this._store.sharingInformation};e.prototype.fetchSharingInformation=function(e){var a=this;if(!this._store.sharingInformation||this._sharingInformationInvalidated||e&&!this._store.sharingInformation.hasPermissionsInformation){var t=!!this._sharingContextInformation||e;this._sharingProvider.getSharingInformation(this._item,t).then(function(e){a._store.sharingInformation=e;a._fetchAdditionalAuthenticationTokens();a.fetchPolicyTipInformation();a._emitChange()},function(e){var t=5,i=e&&e.code,r=e&&e.status,o=e&&e.message&&e.message.value||a._strings.getSharingInformationError,n=e&&e.responseData&&e.responseData.error_description||o;i?-1<i.indexOf("-2147024809")&&o&&o.value&&-1<o.value.indexOf("Item does not exist")&&(t=3):r&&500<=parseInt(r,10)&&(t=2);a._store.sharingInformation={error:t,errorCategory:1,errorMessage:o,debugErrorMessage:r+" - "+n,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,isShared:void 0,item:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1};a._emitChange()})}else this._emitChange()};e.prototype.shareLink=function(e,t,i,a){var s=this,r=this._firstShareLinkRequest;this._firstShareLinkRequest=!1;var l=0,d=0,o=(t=t||[]).map(function(e){1===e.entityType?d++:l++;return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});if(v.default.isFeatureEnabled(b)&&v.default.isFeatureEnabled(x)&&e.audience!==y.SharingAudience.existing&&!this._store.sharingInformation.requiresAccessApproval)this._shareLink(e,o,i,a,r);else if(1!==e.sharingLinkKind&&6!==e.sharingLinkKind)this._shareLink(e,o,i,a,r);else{var n=void 0;n=e.sharingRole?this._getRoleString(e.sharingRole):this._getRoleValue(e.isEdit);var c={items:[this._item],roleValue:n,sendEmail:void 0!==i,message:i,requireSignIn:!0,propagateSharing:!0},u=this._store.sharingInformation.directLink;if(0===t.length)this._handleSharedLink(u,a);else{for(var p=!0,m=0,h=t;m<h.length;m++){var f=h[m];3!==this._store.permissionsMap[f.email]&&(p=!1)}p?this._sharingProvider.emailWithoutPermissioning(o,this._item,i).done(function(e){var t=e.statusCode;if(0===t)s._handleSharedLink(u,a);else{var i=s._strings,r=5,o=i.getSharingInformationError;if(-8===t){r=6;o=i.sharingOperationNotSupportedError}else if(-13===t){r=7;o=_.format(i.invalidEmailErrorMessage,e.invalidEmails.join(", "))}else if(-7===t){r=5;o=e.errorMessage}s._store.sharingInformation=g.__assign({},s._store.sharingInformation,{error:r,errorCategory:3,errorMessage:o});s._emitChange()}}):this._sharingProvider.share(o,c,!0).done(function(e){var t=e.statusCode;if(0===t){var i=u;0===l&&1===d&&e.invitationLink?i=g.__assign({},u,{url:e.invitationLink}):0===l&&1<d&&e.invitationLink&&(i=g.__assign({},u,{url:s._removeEmailQueryParamFromInvitationLink(e.invitationLink)}));s._handleSharedLink(i,a)}else if(1===t){s._store.accessRequestCreated=!0;s._handleSharedLink(u,a)}else{var r=s._strings,o=5,n=r.getSharingInformationError;if(-8===t){o=6;n=r.sharingOperationNotSupportedError}else if(-13===t){o=7;n=_.format(r.invalidEmailErrorMessage,e.invalidEmails.join(", "))}else if(-7===t){o=5;n=e.errorMessage}s._store.sharingInformation=g.__assign({},s._store.sharingInformation,{error:o,errorCategory:3,errorMessage:n});s._emitChange()}})}}this._cleanupDefaultLink()};e.prototype.unshareLink=function(e,t){var i=this,r={item:this._item,kind:e,shareId:t};this._sharingProvider.unshareLink(r).done(function(e){if(!0===e){i._removeLinkByShareId(t);i._updateIsShared();i._emitChange()}})};e.prototype.getSharingLinkCreated=function(){return this._store.sharingLinkCreated};e.prototype.updatePermissions=function(n,e){var a=this;this._sharingProvider.updatePermissions2(n,this._item,e).done(function(e){var t=a._store.sharingInformation.sharingPrincipals;if(e.role===y.UpdatePermissionsRole.NONE){a._store.sharingInformation.sharingPrincipals=t.filter(function(e){return e.id!==n.id});a._updateIsShared();a._emitChange()}else for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o.id===n.id){switch(e.role){case y.UpdatePermissionsRole.VIEW:o.role=1;break;case y.UpdatePermissionsRole.EDIT:o.role=2;break;case 6:o.role=6}a._emitChange()}}})};e.prototype.fetchSuiteNavInformation=function(){var r=this;if(this._suiteNavProvider)this._suiteNavProvider.loadData().then(function(e){var t=e.CompanyDisplayName||r._strings.companyNameFallback,i=e?JSON.parse(e.ClientData):{HasEXOLicense:!1};r._store.companyName=t;r._store.outlookAvailability=i.HasEXOLicense?c.OutlookAvailability.available:c.OutlookAvailability.none;r._emitChange()});else{this._store.companyName=this._strings.companyNameFallback;this._store.outlookAvailability=c.OutlookAvailability.none;this._emitChange()}};e.prototype.getCompanyName=function(){return this._store.companyName};e.prototype.getOutlookAvailability=function(){return this._store.outlookAvailability};e.prototype.navigateToOwa=function(e,t){window.open(this._getOwaUrl(e,t),"_blank")};e.prototype.fetchGroupsMemberCount=function(e){for(var r=this,o=0,t=function(i){var e={userId:i.userId,name:i.name,email:i.email,rawPersonData:i.rawPersonData,principalType:i.principalType};if(i.principalType===s.default.securityGroup){var t=n._groupsMemberCountCache[i.userId];void 0!==t?o+=t:n._peoplePickerProvider.getPickerEntityInformation(e).then(function(e){var t=e.totalMemberCount;r._groupsMemberCountCache[i.userId]=t;o+=t;r._store.groupsMemberCount=o;r._emitChange()})}},n=this,i=0,a=e;i<a.length;i++){t(a[i])}this._store.groupsMemberCount=o;this._emitChange()};e.prototype.getGroupsMemberCount=function(){return this._store.groupsMemberCount};e.prototype.fetchPolicyTipInformation=function(){var t=this;if(this._policyTipProvider){if(this._store.policyTipInfo.info){this._emitChange();return}var e=this._store.sharingInformation;if(!e)return;var i=e.sharingAbilities;if(i){if(7!==(i&&i.directSharingAbilities.canAddExternalPrincipal.disabledReason))return}else{if(this._item&&!this._isPolicyTipFlagSet(this._item.policyTip,4))return;if(!this._item)return}this._policyTipProvider.getPolicyTip(this._item).then(function(e){if(e){t._store.policyTipInfo.info=e;t._emitChange()}})}};e.prototype.getPolicyTipInformation=function(){return this._store.policyTipInfo};e.prototype.updatePolicy=function(e,t){var i=this;if(this._policyTipProvider){var r={item:this._item,action:e};t&&(r.justification=t);this._policyTipProvider.updatePolicy(r).then(function(e){i._store.policyTipInfo.actionResult=e;i._sharingInformationInvalidated=!0;i.fetchSharingInformation(!0);i._emitChange()})}};e.prototype.checkPermissions=function(e,t){var o=this;if(0!==e.length){var i=[];this._recipients=[];for(var r=0,n=e;r<n.length;r++){var a=n[r];i.push({alias:a.email});this._recipients.push(a.email)}t=t||this._store.invitedUsers;this._invitedUsers=[];for(var s=0,l=t;s<l.length;s++){var d=l[s];i.push({alias:d.email});this._invitedUsers.push(d.email)}this._sharingProvider.checkPermissions(i,this._item).then(function(e){o._store.permissionsMap={};for(var t=0,i=e;t<i.length;t++){var r=i[t];-1<o._invitedUsers.indexOf(r.inputEntity)?o._store.permissionsMap[r.inputEntity]=r.hasAccess?3:2:-1<o._recipients.indexOf(r.inputEntity)&&(o._store.permissionsMap[r.inputEntity]=r.hasAccess?3:1)}o._emitChange()})}else{this._store.permissionsMap={};this._emitChange()}};e.prototype.getPermissionsMap=function(){return this._store.permissionsMap};e.prototype.getDefaultRecipients=function(){return this._store.defaultRecipients};e.prototype.consumeDefaultRecipients=function(){this._store.defaultRecipients={isConsumed:!0,recipients:this._store.defaultRecipients.recipients}};e.prototype.grantAccess=function(e){var t=this,i=(e=e||[]).map(function(e){return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}}),r={items:[this._item],roleValue:this._getRoleValue(!0),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(i,r,!0).done(function(e){t._store=g.__assign({},t._store,{grantAccessResult:0===e.statusCode});t._emitChange()})};e.prototype.getGrantAccessResult=function(){return this._store.grantAccessResult};e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};e.prototype.hasAccessRequestBeenCreated=function(){return this._store.accessRequestCreated};e.prototype.isValidatingDefaultRecipients=function(){return this._store.isValidatingDefaultRecipients};e.prototype._cleanupDefaultLink=function(){var e=this._store.defaultLink;if(e){this.unshareLink(e.sharingLinkKind,e.shareId);this._store.defaultLink=void 0}};e.prototype._emitChange=function(){for(var e=0,t=this._listeners;e<t.length;e++){(0,t[e])()}};e.prototype._fetchAdditionalAuthenticationTokens=function(){var t=this;if(this._store.sharingInformation){var i=this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();i?this._graphPeoplePickerHelper.getGraphToken().then(function(e){i=!!e;t._store.sharingInformation.isGraphAvailable=i}):this._store.sharingInformation.isGraphAvailable=!1}};e.prototype._handleSharedLink=function(e,t){e.createdViaCopyLinkCommand=t||!1;this._store.sharingLinkCreated=e;this._updateIsShared();this._emitChange()};e.prototype._getRoleValue=function(e){return e?"role:1073741827":"role:1073741826"};e.prototype._getRoleString=function(e){return 6===e?"roletype:Reviewer":2===e?"role:1073741827":"role:1073741826"};e.prototype._removeLinkByShareId=function(t){this._store.sharingInformation.sharingLinks=this._store.sharingInformation.sharingLinks.map(function(e){if(t===e.shareId){e.expiration=null;e.isActive=!1;e.shareId=i.default.Empty;e.url=null;e.principals=[]}return e})};e.prototype._updateIsShared=function(){for(var e=this._store.sharingInformation,t=e.sharingLinks,i=e.sharingPrincipals,r=!1,o=0,n=t;o<n.length;o++){var a=n[o];a.isActive&&1!==a.sharingLinkKind&&(r=!0)}r||(r=0<i.length);this._store.sharingInformation.isShared=r};e.prototype._getOwaUrl=function(e,t){var i=location.origin.indexOf(".cn")===location.origin.length-3,r=location.origin.indexOf(".de")===location.origin.length-3,o="https://outlook.office.com/owa/";i?o="https://partner.outlook.cn/owa/":r&&(o="https://outlook.de/owa/");return o+"?body="+encodeURIComponent(t)+"&to="+e.join(";")+"&path=/mail/action/compose"};e.prototype._resolveDefaultRecipients=function(e,t,a){var s=this,l=e||[],i=[];this._store.isValidatingDefaultRecipients=0<e.length;if(!t){l=[];for(var r=[],o=0,n=e;o<n.length;o++){var d=n[o];r.push({alias:d})}i.push(this._sharingProvider.checkPermissions(r,this._item).then(function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];r.hasAccess||l.push(r.inputEntity)}}))}u.default.all(i).then(function(){if(0!==l.length){for(var e=[],t=[],i={principalSource:15,principalType:13,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:1,allowSharePointGroups:!1,forceResolve:!0},r=0,o=l;r<o.length;r++){var n=o[r];e.push(s._peoplePickerProvider.resolve(n,i).then(function(e){t.push(e)}))}u.default.all(e).then(function(){s._store.defaultRecipients={isConsumed:!1,recipients:t};s._store.isValidatingDefaultRecipients=!1;s._emitChange()})}else if(a===y.Mode.atMention){s._store=g.__assign({},s._store,{grantAccessResult:!0});s._emitChange()}})};e.prototype._removeEmailQueryParamFromInvitationLink=function(e){var t=e.split("?");if(1<t.length){for(var i=[],r=0,o=t[1].split("&");r<o.length;r++){var n=o[r];-1===n.indexOf("email=")&&i.push(n)}var a=i.join("&");return t[0]+"?"+a}return e};e.prototype._shareLink=function(e,t,i,r,o){var n=this,a={emailData:i,items:[this._item],recipients:t,settings:{sharingLinkKind:e.sharingLinkKind,expiration:e.expiration}};if(e.audience===y.SharingAudience.specificPeopleFlex){a.settings.restrictShareMembership=!0;e.sharingRole?a.settings.role=e.sharingRole:a.settings.role=e.isEdit?2:1}this._sharingProvider.shareLink(a).done(function(e){if(e.error){n._store.sharingInformation=g.__assign({},n._store.sharingInformation,{error:e.error,errorCategory:2,errorMessage:n._strings.getSharingInformationError});n._emitChange()}else{var t=e.link;t.sharingLinkKind===n._store.sharingInformation.defaultSharingLink.sharingLinkKind&&o&&r&&n._store.sharingInformation.sharingLinks.forEach(function(e){e.sharingLinkKind!==t.sharingLinkKind||e.isActive||(n._store.defaultLink=t)});n._handleSharedLink(t,r)}})};e.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};return e}();t.default=r});define("DO",["require","exports","ap","By","By","B3","Bx","Bs","Bv","Bt"],function(e,t,i,r,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=o.Share;t.ShareNotification=n.ShareNotification;t.AccessStatus=a.default;t.Error=s.Error;t.Category=s.Category;t.Mode=s.Mode;t.SharePermission=s.SharePermission;t.SharingAudience=s.SharingAudience;t.SharingLinkKind=s.SharingLinkKind;t.SharingRole=s.SharingRole;t.ClientId=s.ClientId;t.OutlookAvailability=l.default;t.SharingCapabilityDisabledReason=d.default});define("VQ",[],function(){return'<div data-bind="react: { componentType: shareComponent, props: shareComponentProps }"></div>'});define("VS",["require","exports","bA","VZ","VY","VX","VW","VT"],function(e,t,i,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={pageContext:r.resourceKey.optional,page:o.resourceKey.optional,search:n.resourceKey.optional,item:a.resourceKey.optional,sharePointItem:s.resourceKey.optional};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:l,create:function(e){var t=[],i=e.pageContext,r=e.page,o=e.search,n=e.item,a=e.sharePointItem;i&&t.push(i);r&&t.push(r);o&&t.push(o);n&&t.push(n);a&&t.push(a);return{instance:t}}}})});define("VZ",["require","exports","V0","bA","iE"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedResourceKey(e("module").id,i.default,{pageContext:o.pageContext})});define("V0",["require","exports","aZ"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){void 0===e&&(e={});this._pageContext=t.pageContext}e.prototype.getEngagementData=function(){var e=this._pageContext,t={},i={siteId:r.default.normalizeLower(e.siteId),webId:r.default.normalizeLower(e.webId),webTemplateId:e.webTemplate,extraData:t};e.groupId&&(i.groupId=r.default.normalizeLower(e.groupId));e.listId&&(i.listId=r.default.normalizeLower(e.listId));-1<e.listBaseTemplate&&(i.listTemplateId=""+e.listBaseTemplate);e.CorrelationId&&(t.CorrelationId=e.CorrelationId);return i};return e}();t.default=i});define("VY",["require","exports","d7","bA"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._instrumentationProvider=t.instrumentationProvider}e.prototype.getEngagementData=function(){var e=this._instrumentationProvider;return{currentPage:e.currentPageName()||"NA",previousPage:e.previousPageName()||"NA"}};e.dependencies={instrumentationProvider:i.instrumentation};return e}();t.PageEngagementHandler=o;t.resourceKey=r.createResolvedResourceKey(e("module").id,o)});define("VX",["require","exports","d7","bA"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._instrumentationProvider=t.instrumentationProvider}e.prototype.getEngagementData=function(){var e={},t=this._instrumentationProvider.searchSessionId;t&&(e.olsSearchSessionId=t);return{extraData:e}};e.dependencies={instrumentationProvider:i.instrumentation};return e}();t.SearchEngagementHandler=o;t.resourceKey=r.createResolvedResourceKey(e("module").id,o)});define("VW",["require","exports","VU","bA","bX","k2"],function(e,t,l,i,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._currentItem=t.currentItem}e.prototype.getEngagementData=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this._currentItem,r=l.getMostSpecificMatchingContext(d.itemEngagementPart,e),o=r&&r.item||i&&i.peek();if(o){var n={extension:o.extension},a=o.graph&&o.graph.itemId||o.itemId;a&&(n.itemGraphId=a);var s=o.graph&&o.graph.driveId;s&&(n.itemGraphDriveId=s);return{extraData:n}}};e.dependencies={currentItem:r.currentItem};return e}();t.ItemEngagementHandler=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});define("VU",["require","exports","VV","cG","k1"],function(e,i,t,r,o){"use strict";function n(e){for(var t in e)i.hasOwnProperty(t)||(i[t]=e[t])}Object.defineProperty(i,"__esModule",{value:!0});n(t);n(r);n(o);i.getMostSpecificMatchingContext=function(e,t){for(var i=t.length-1;0<=i;i--){var r=t[i];if(e.matches(r))return r}}});__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();var __assign=this&&this.__assign||Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},__rest=this&&this.__rest||function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(i[r[o]]=e[r[o]])}return i};define("VV",["require","exports","cG","a0","aL"],function(e,t,i,l,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(s){__extends(t,s);function t(e,t){void 0===e&&(e={});void 0===t&&(t={});var i=s.call(this,e,t)||this,r=t.handlers,o=void 0===r?[]:r,n=t.logData,a=void 0===n?function(e){return l.Engagement.logData(e)}:n;i._handlers=o;i._logData=a;return i}t.prototype.logData=function(e){void 0===e&&(e={});if(this.contexts.length||e.name){for(var t=this.contexts.map(function(e,t){return{context:e,order:t}}).sort(function(e,t){return e.context.part.type-t.context.part.type||e.order-t.order}).map(function(e){return e.context}),i=e.name,r=void 0===i?t.map(function(e){return e.part.name}).join("."):i,o=e.isIntentional,n=void 0!==o&&o,a=e.extraData,s=__rest(void 0===a?{}:a,[]),l=__rest(e,["name","isIntentional","extraData"]),d=__assign({name:r,isIntentional:n,extraData:s},l),c=0,u=t;c<u.length;c++){var p=u[c],m=p.part,h=p.extraData,f=void 0===h?{}:h,g={};for(var y in f)g[m.name+"_"+y]=f[y];S(d,{extraData:g});S(d,p.part.getEngagementData(p)||{})}for(var v=0,_=this._handlers;v<_.length;v++){var b=_[v],x=b.getEngagementData.apply(b,t);x&&S(d,x)}this._logData(d)}};t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},handlers:this._handlers,logData:this._logData})};return t}(i.EngagementBuilder);t.EngagementHelper=r;function S(e,t){var i=t.extraData,r=void 0===i?{}:i,o=t.experiment;!function e(t,i){for(var r in i){var o=i[r];if("object"==typeof o&&o){var n="object"==typeof t[r]&&t[r]||{};t[r]=n;e(n,o)}else void 0!==o&&(t[r]=o)}}(e,__rest(t,["extraData","experiment"]));n.extend(e.extraData,r);void 0!==o&&(e.experiment=o)}t.mergeEngagementData=S});define("VT",["require","exports","VU","bA","bX","k2","eA","iE"],function(e,t,y,i,r,v,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._currentItem=t.currentItem;this._itemParentHelper=t.itemParentHelper;this._pageContext=t.pageContext}e.prototype.getEngagementData=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this._currentItem,r=y.getMostSpecificMatchingContext(v.itemEngagementPart,e),o=r&&r.item||i&&i.peek();if(o){var n=this._itemParentHelper,a=n.getFacetedAncestorOrSelf(o,"list"),s=a&&a.peek(),l=n.getFacetedAncestorOrSelf(o,"subsite"),d=l&&l.peek(),c={docId:o.properties.UniqueId||o.properties.uniqueId};if(s){var u=s.list,p=u.id,m=u.templateType;c.listId=p;c.listTemplateId=""+m}if(d&&d.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl){var h=d.subsite,f=(p=h.id,h.siteCollectionId),g=h.webTemplateId;c.webId=p;c.webTemplateId=""+g;c.siteId=f}return c}};e.dependencies={currentItem:r.currentItem.optional,itemParentHelper:o.resourceKey,pageContext:n.pageContext};return e}();t.ItemEngagementHandler=a;t.resourceKey=i.createResolvedResourceKey(e("module").id,a)});define("V1",["require","exports","ap","bX","bN","bA"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(n){i.__extends(e,n);function e(e,t){void 0===e&&(e={});var i=n.call(this,e,t)||this,r=t.isFirstRunExperienceVisible,o=void 0===r?i.observables.create(!1):r;i._isFirstRunExperienceVisible=o;i.canShowTeachingBubbles=i.observables.pureCompute(i._computeCanShowTeachingBubble).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}});return i}e.prototype._computeCanShowTeachingBubble=function(){return!this._isFirstRunExperienceVisible()};e.dependencies=i.__assign({},o.default.dependencies,{isFirstRunExperienceVisible:r.isFirstRunExperienceVisible.optional});return e}(o.default);t.TeachingBubbleHelper=a;t.resourceKey=n.createResolvedResourceKey(e("module").id,a);t.default=a});define("V2",["require","exports","V5","b5","V4","V3"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-client-form",template:e("V4"),viewModel:i.default,synchronous:!0});t.default=o});define("V5",["require","exports","ap","aq","Pi","bF","lB","V9","aC","iJ","bX","m8","d7","iG","eO","Pn","ON","dZ","V8","V7","iE","V6","cE","MZ","cY","ep","eX","Pt","QY"],function(e,t,i,w,E,r,l,D,d,c,A,M,o,u,p,m,h,n,a,f,g,y,v,_,b,F,x,S,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(s){i.__extends(e,s);function e(i){var r=s.call(this,i.viewModelParams)||this;r.isLoading=w.observable(!1);r.showNoCommonPropertiesMessage=w.observable(!1);r.BulkEditNoCommonPropertiesMessage=E.strings.BulkEditNoCommonPropertiesMessage;r.isSaved=w.observable(!1);r.children=w.observableArray();r.savingStateText=E.strings.SavingState;r.savedStateText=E.strings.SavedState;r.saveLabel=E.strings.SaveLabel;r.cancelLabel=E.strings.CancelLabel;r.itemSavingReadoutText=E.strings.ItemSavingReadoutText;r.ServerErrorTitle=E.strings.ServerErrorTitle;r.hasServerError=w.observable(!1);r.scrollToClientFormTop=w.observable(!1);r._itemsStore=r.resources.consume(c.resourceKey);r._listContext=r.resources.consume(g.listContext);r._pageContext=r.resources.consume(g.pageContext);r.loadingSpinnerTagName=l.default.tagName;r.addBindingHandlers({scrollIntoView:h.default});r._exposeDataSourceResources();r._clientFormProvider=r.resources.consume(m.resourceKey);r._itemProvider=r.resources.consume(x.resourceKey);r._currentItem=r.resources.consume(A.currentItem);r.clientForm=i.clientForm;r.item=r.clientForm.item;r.isReadOnly=r._isReadOnly(r.item.peek(),i);r.interactiveSave=w.observable(i.interactiveSave);r.rumoneHelper=r.resources.consume(u.rumOneHelper);r.isSaving=i.isSaving||w.observable(!1);r.clientFormType=i.clientForm.formType;r.contentType=r._getContentTypeFromItem(r.item.peek());r.isInfoPane=i.isInfoPane;r._rootFolder=i.rootFolder;r._selectionModel=r.resources.consume(A.itemsSelection);r._complianceTagProvider=r.resources.consume(C.resourceKey.optional);2===r.clientFormType?document.title=E.strings.NewItemPageTitle:r.isInfoPane||1!==r.clientFormType||(r.interactiveSave()?document.title=E.strings.ViewItemPageTitle:document.title=E.strings.EditItemPageTitle);var e=r.resources.consume(A.currentItemSet).peek().schema.peek();r.nameToColumnDefinitionHash={};for(var t=0,o=e;t<o.length;t++){var n=o[t];n&&(r.nameToColumnDefinitionHash[n.key]=n)}r.subscribe(r.item,function(e){if(e){var t=r._getContentTypeFromItem(r.item.peek());t.displayName&&t.displayName!==r.clientForm.contentType&&r.switchContentType(t);r._clientFormProvider.updateFormValues(r.clientForm).done(function(){var e=r.children();r.showOrHideAssetIdField();for(var t=0,i=e.length;t<i;t++)e[t].updateRenderHtml()});r.rumoneHelper.logPropertiesPaneEnd();r.isReadOnly=r._isReadOnly(e,i)}});r._renderFieldEditors();r._suppressDefaultSaveBehavior=!!i.suppressDefaultSaveBehavior;r._suppressDefaultCancelBehavior=!!i.suppressDefaultCancelBehavior;r._onSaveCallback=i.onSaveCallback;r._onCancelCallback=i.onCancelCallback;i.fieldsManagerAccessor&&i.fieldsManagerAccessor(r);r.rumoneHelper.logPropertiesPaneEnd();var a=r.children.peek();!r.isInfoPane&&0<a.length&&r._setFocusToField(a[0]);return r}e.prototype.switchContentType=function(t){var i=this;if(t.displayName!==this.clientForm.contentType){this.isLoading(!0);this._clientFormProvider.getClientForm({clientFormType:1,item:this.item,contentType:t.displayName,isBulkEdit:this.clientForm.isBulkEdit,selection:this._selectionModel.selection.peek(),isSwitchingContentType:!0}).done(function(e){if(e){i.clientForm=e;i.contentType=t;i._renderFieldEditors(!0)}})}};e.prototype.shouldSetReadFocusAfterSave=function(){var e=!0;if(this.interactiveSave())for(var t=0,i=this.children.peek();t<i.length;t++){if(i[t].isEdit()){e=!1;break}}else e=!1;return e};e.prototype.onSaveClick=function(e,t){var i=this.clientForm.isBulkEdit?"BulkEditForm.Save":"EditForm.Save";this.resources.consume(v.resourceKey).logData({name:i,isIntentional:!0});this.processAndSaveChanges()};e.prototype.onCancelClick=function(e,t){this.hasServerError(!1);this.scrollToClientFormTop(!1);this.cancelChanges()};e.prototype.cancelChanges=function(){if(!this._suppressDefaultCancelBehavior){for(var e=0,t=this.children.peek();e<t.length;e++){t[e].cancelEdit()}this.interactiveSave(!0)}this._onCancelCallback&&this._onCancelCallback()};e.prototype.processAndSaveChanges=function(){var o=this;this.hasServerError(!1);this.scrollToClientFormTop(!1);this.isSaving(!0);for(var n,a=this.children.peek(),e=!0,t=0,i=a;t<i.length;t++){var r=i[t];(r.beforeSave&&!r.beforeSave()||!this.clientForm.isBulkEdit&&!r.validate())&&(e=!1);if(e){r.field.hasException(!1);r.field.errorMessage("")}else n||(n=r)}if(e)return this.saveChangesWithoutProcessing().then(function(e){o.isSaving(!1);o.hasServerError(!1);if(e.status===S.UpdateResultStatus.partialSuccess){o.serverErrorDetails=E.strings.BulkEditPartialFailErrorMessage;o.hasServerError(!0)}o.scrollToClientFormTop(!1);e.status!==S.UpdateResultStatus.success||o._suppressDefaultSaveBehavior||o.interactiveSave(!0);if(e.status===S.UpdateResultStatus.fail){for(var t=0,i=a;t<i.length;t++){var r=i[t];if(r.field.hasException.peek()){n=r;break}}o._setFocusToField(n)}else if(e.status===S.UpdateResultStatus.success){o.isSaved(!0);o.async.setTimeout(function(){o.isSaved(!1)},1e3)}o._onSaveCallback&&o._onSaveCallback(e.status===S.UpdateResultStatus.success);return e.status===S.UpdateResultStatus.success},function(e){o.isSaving(!1);var t=(e=e instanceof Array?e:[e]).reduce(function(e,t){return e+e?"\r\n":""+t&&t.message?t.message.value?t.message.value:t.message:""},"");o.serverErrorDetails=t||E.strings.ServerErrorDefaultValue;o.hasServerError(!0);o.scrollToClientFormTop(!0);return!1});this.isSaving(!1);this._setFocusToField(n);return d.default.wrap(e)};e.prototype.saveChangesWithoutProcessing=function(){var s=this,e=this._selectionModel.selection.peek(),l={clientForm:this.clientForm,newDocumentUpdate:!1,checkInComment:null,isInteractiveSave:this.interactiveSave.peek(),rootFolder:this._rootFolder,selection:this.clientForm.isBulkEdit&&e};if(2!==this.clientForm.formType||this.clientForm.isBulkEdit){this.rumoneHelper.logPropertiesPaneModifyProperty();return this._clientFormProvider.updateItem(l).then(function(t){return s._validateClientForm().then(function(e){e||(t.status=S.UpdateResultStatus.fail);return t})}).then(function(e){var n=s.clientForm.item.peek(),t=[];if(s.clientForm.isBulkEdit&&l.selection)for(var i=0,r=l.selection;i<r.length;i++){var o=r[i];if(o){var a=o.peek().properties.ID;e.failedItemIds&&-1!==e.failedItemIds.indexOf(parseInt(a,10))||t.push(a)}}else t.push(n.properties.ID);e.status!==S.UpdateResultStatus.fail&&s.clientForm.item&&n.parentKey&&s._itemProvider.getSpecifiedItems({parentKey:n.parentKey,itemKeys:t,recurseInFolders:!1,getRootFolderFromParentKey:n.type===p.default.Folder,needToClearParentSmartFiltersInfo:!0}).then(function(e){var t=e.children;if(s.clientForm.isBulkEdit&&t)for(var i=0,r=t;i<r.length;i++){var o=r[i];s._itemsStore.getItem(o.key)(o)}else if(t&&1===t.length){if((o=t[0]).key===n.key){s._itemsStore.getItem(n.key)(o)}else 1===s.clientFormType&&s.interactiveSave&&!s.isInfoPane?s._itemsStore.invalidateItem(n.key):s._itemsStore.invalidateItem(s.clientForm.item.peek().parentKey)}});return e})}return this._clientFormProvider.createItem(l).then(function(){return s._validateClientForm()}).then(function(e){if(e){var t=s._currentItem.peek();t&&t.key&&s._itemProvider.invalidateItem(t.key)}return{status:e?S.UpdateResultStatus.success:S.UpdateResultStatus.fail}})};e.prototype._validateClientForm=function(){for(var t=this,e=this.children.peek(),i=0,r=e.length;i<r;i++){var o=e[i];if(1===o.field.state.peek())return new d.default(function(e){t.async.setTimeout(function(){t._validateClientForm().done(e)},500)});if(o.aggregateValidation.hasError.peek())return d.default.wrap(!1)}return d.default.wrap(!0)};e.prototype._renderFieldEditors=function(e){var t=this;this.children([]);this.showNoCommonPropertiesMessage(!1);var i=!1,r=!1;this._listContext.tenantTagPolicyEnabled&&2!==this.clientFormType&&(r=!0);for(var o=Number(this._pageContext.webTemplate)===F.default.mySite,n=!(this._pageContext.isSiteAdmin&&o),a=0,s=this.clientForm.fields.length;a<s;a++){var l=this.clientForm.fields[a];if(M.isClientFormComplianceTagField(l)){if(!r)continue;i=!0}else if(!n)continue;var d=D.default.getFieldEditor(l,this);d&&this.children.push(d)}if(r&&!i){var c=this.clientForm.isBulkEdit?"":this.item.peek().properties[M.COMPLIANCETAG_FIELD_NAME]||"",u={data:w.observable(c),serverData:c,state:w.observable(0),hasException:w.observable(!1),errorMessage:w.observable(""),schema:{Name:M.COMPLIANCETAG_FIELD_NAME,Title:E.strings.ComplianceTagFieldTitle,DefaultValue:null,DefaultValueTyped:null,Description:"",Id:M.COMPLIANCETAG_FIELD_ID,FieldType:"Lookup",Direction:null,Hidden:!1,IMEMode:null,ReadOnlyField:!1,Required:!1,Type:null}},p=this.clientForm.isBulkEdit||!this.children.peek().length?0:1;this.clientForm.fields.splice(p,0,u);var m=D.default.getFieldEditor(u,this);m&&this.children.splice(p,0,m);if(null!==c){var h=u.schema.ComplianceTags;if(h&&0<h.length)for(var f=0,g=h;f<g.length;f++){var y=g[f];if(c===y.tagName){if(y.isEventTag){var v=this.getBootstrappingComplianceAssetIdField();this.clientForm.fields.push(v);var _=D.default.getFieldEditor(v,this);_&&this.children.push(_)}break}}}}if(n&&this._listContext.contentTypesEnabled){var b=this.resources.consume(A.currentItemSet).peek().contentTypes.peek(),x=this._clientFormProvider.getContentTypes(1);if(x&&b&&"Folder"!==this.clientForm.contentType){var S=b.filter(function(t){return 1===x.filter(function(e){return t.displayName===e.displayName}).length});if(S&&0<S.length){for(var C=this.getBootstrappingContentTypeField(e),P=!1,k=0;k<this.clientForm.fields.length;k++)if("ContentType"===this.clientForm.fields[k].schema.Name){this.clientForm.fields[k]=C;P=!0;break}P||this.clientForm.fields.push(C);var I=D.default.getContentTypeEditor(C,this,S);I&&this.children.splice(0,0,I)}}}if(this.clientForm.isBulkEdit){var T=this.children.peek().length;0===T?this.showNoCommonPropertiesMessage(!0):1===T&&r&&this._complianceTagProvider&&this._complianceTagProvider.hasComplianceTags().then(function(e){e||t.showNoCommonPropertiesMessage(!0);t.isLoading(!1)})}this.isLoading.peek()&&this.isLoading(!1)};e.prototype.getBootstrappingComplianceAssetIdField=function(){var e=this.clientForm.isBulkEdit?"":this.item.peek().properties[M.ASSETID_FIELD_NAME]||"";return{data:w.observable(e),serverData:e,state:w.observable(0),hasException:w.observable(!1),errorMessage:w.observable(""),schema:{Name:M.ASSETID_FIELD_NAME,Title:"Asset ID",DefaultValue:null,DefaultValueTyped:null,Description:"",Id:M.ASSETID_FIELD_ID,FieldType:"text",Direction:null,Hidden:!1,IMEMode:null,ReadOnlyField:!1,Required:!1,Type:null}}};e.prototype.showOrHideAssetIdField=function(){for(var e=-1,t=-1,i=0,r=0,o=this.clientForm.fields;r<o.length;r++){var n=o[r];M.isClientFormComplianceTagField(n)?e=i:M.isClientFormComplianceAssetIdField(n)&&(t=i);if(-1!==e&&-1!==t)break;i++}if(-1!==e){var a=this.clientForm.fields[e],s=a.schema.ComplianceTags;if(a.serverData){if(s&&0<s.length)for(var l=0,d=s;l<d.length;l++){var c=d[l];if(a.serverData===c.tagName){if(c.isEventTag){if(-1!==t)return;var u=this.getBootstrappingComplianceAssetIdField();this.clientForm.fields.push(u);var p=D.default.getFieldEditor(u,this);p&&this.children.push(p)}else this.hideAssetIdField(t);break}}}else this.hideAssetIdField(t)}};e.prototype.hideAssetIdField=function(e){if(-1!==e){this.clientForm.fields.splice(e,1);this.children.splice(e,1)}};e.prototype.getBootstrappingContentTypeField=function(e){var t=this._getContentTypeFromItem(this.item.peek()),i=t.displayName===this.clientForm.contentType?t:{displayName:this.clientForm.contentType,description:this.clientForm.contentType,templateUrl:null};if(this.clientForm.isBulkEdit){t={displayName:void 0,description:void 0,templateUrl:void 0};e||(i=t)}return{data:w.observable(i),serverData:t,state:w.observable(0),hasException:w.observable(!1),errorMessage:w.observable(""),schema:{Name:"ContentType",Title:E.strings.ContentType,Description:null,DefaultValue:null,DefaultValueTyped:null,Id:"c042a256-787d-4a6f-8a8a-cf6ab767f12d",FieldType:"Computed",Direction:null,Hidden:!1,IMEMode:null,ReadOnlyField:!1,Required:!1,Type:null}}};e.prototype._exposeDataSourceResources=function(){this.resources.expose(n.taxonomy,new(this.resources.injected(a.default))(this._pageContext));this.resources.expose(o.taxonomy,new(this.resources.injected(f.default)));this.resources.expose(n.attachments,new(this.resources.injected(y.default))(this._pageContext))};e.prototype._isReadOnly=function(e,t){return 2!==t.clientForm.formType&&(t.isReadOnly||_.default.isCheckedOutByOther(e,this._pageContext.userId)||!b.PermissionMask.hasItemPermission(e,b.PermissionMask.editListItems))};e.prototype._setFocusToField=function(e){var t=this;e&&this.async.setImmediate(function(){t.interactiveSave.peek()?e.isReadFocused(!0):e.isSelected(!0)})};e.prototype._getContentTypeFromItem=function(e){return{displayName:e.properties.ContentType,description:e.properties.ContentType,templateUrl:null,cTypeId:e.properties.ContentTypeId}};return e}(r.default);t.default=s});define("V9",["require","exports","Ym","Yh","Ye","Yc","X8","XT","XR","XO","XM","XL","XJ","Xn","m8","Xm","Xd","We","Wa"],function(e,t,i,r,o,n,a,s,l,d,c,u,p,m,h,f,g,y,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(){function e(){}e.getFieldEditor=function(e,t){switch(e.schema.FieldType.toLowerCase()){case"choice":return new u.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}});case"datetime":return new y.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}});case"multichoice":return new u.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}});case"file":return new d.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}});case"text":return new i.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}});case"boolean":return new o.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}});case"number":case"currency":return new n.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}});case"note":return new r.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}});case"lookup":case"lookupmulti":return h.isClientFormComplianceTagField(e)?new f.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}}):new l.default({viewModelParams:{resources:t.resources},field:e,fieldsManager:t,fieldNameForDisplayRead:"LookupValue",fieldNameForValueRead:"LookupId",fieldNameForValueWrite:"lookupId"});case"usermulti":case"user":return new s.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}});case"taxonomyfieldtype":case"taxonomyfieldtypemulti":return new m.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}});case"attachments":return new g.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}});case"url":return e.schema.DisplayFormat,new a.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}})}return null};e.getChoiceFieldEditor=function(e,t){var i=e.schema;return 1===i.FormatType?new p.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}}):0===i.FormatType?new c.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources}}):null};e.getContentTypeEditor=function(e,t,i){return"ContentType"===e.schema.Name?new v.default({field:e,fieldsManager:t,viewModelParams:{resources:t.resources},contentTypes:i}):null};return e}();t.default=_});define("Ym",["require","exports","ap","aq","Wk","Pp","cJ","cm","dz","dB","Yr","uA","Yo","Yn","Yo","cp"],function(r,e,t,o,i,n,a,s,l,d,c,u,p){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var m=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.controlHtml=r("Yn");t._clientFormDataSource=t.resources.consume(n.resourceKey);t.autoFillComponentId=t.inputElementId+"-autoFillComponent";t.isAutoFillOpen=o.observable(!1);t.inlineEdit=!0;t.inlineSave=!0;t.textInput=o.observable(t.field.data.peek());t._delayedTextInput=t.createComputed(function(){return t.textInput()}).extend({rateLimit:400});t.loadingAutoFill=o.observable(!1);t.autoSuggestMenuTagName=p.default.tagName;t.autoSuggestItems=o.observableArray([]);t.selectionModel=new d.default;t.clickedSuggestItem=o.observable(null);t.focusedItem=o.observable(null);t.focusedItemId=t.createComputed(function(){return t.focusedItem()?t.focusedItem().id:null});t.subscribe(t._delayedTextInput,function(e){0===(e?e.length:0)?t.isAutoFillOpen(!1):t._getAutoFillSuggestion()});t.subscribe(t.clickedSuggestItem,function(e){if(e){t.textInput(e.display);t.saveChanges()}});t.addBindingHandlers({keyboard:a.default,childFocus:s.default,selection:l.default,selectOnFocus:u.default});t.beforeSave=function(){t.field.data(t.textInput.peek());return!0};return t}e.prototype.onEnter=function(e,t){var i=this.selectionModel.selection.peek();if(i&&1===i.length){this.clickedSuggestItem(i[0]);this.closeAutoFill()}else{this.clickedSuggestItem(null);this.saveChanges()}return!1};e.prototype.onDown=function(){if(this.isAutoFillOpen.peek()){var e=this.autoSuggestItems.peek();if(this.isSelected.peek()&&e&&0<e.length){this.selectionModel.selectItem(e[0]);this.selectionModel.anchor(e[0])}}else this._getAutoFillSuggestion();return!1};e.prototype.onUp=function(){this.selectionModel.focused.peek()===this.autoSuggestItems.peek()[0]&&this.isSelected(!0);return!1};e.prototype.onEsc=function(){this.closeAutoFill();return!0};e.prototype.onDoubleClick=function(){this.textInput.peek()||this._getAutoFillSuggestion()};e.prototype.closeAutoFill=function(){this._abortQuery();this.isAutoFillOpen(!1);this.selectionModel.clear();this.isSelected(!0)};e.prototype._getAutoFillSuggestion=function(){var n=this;this._abortQuery();this.loadingAutoFill(!0);this._autoFillQueryPromise=this._clientFormDataSource.getFieldValueSuggestions(this.field.schema.Name,this.field.schema.FieldType,5,this.textInput.peek());this.trackPromise(this._autoFillQueryPromise.then(function(e){for(var t=[],i=0,r=e;i<r.length;i++){var o=r[i];t.push(new c.AutoSuggestItem(o,o,n.textInput.peek()))}n.autoSuggestItems(t);e&&0<e.length?n.isAutoFillOpen(!0):n.isAutoFillOpen(!1);n.loadingAutoFill(!1)},function(){n.isAutoFillOpen(!1);n.loadingAutoFill(!1)}))};e.prototype._abortQuery=function(){this._autoFillQueryPromise&&this._autoFillQueryPromise.cancel();this.loadingAutoFill(!1)};return e}(i.default);e.default=m});define("Wk",["require","exports","ap","aq","bF","Xc","qH","aZ","lB","ex","Wr","cJ","cm","V","bW","d5","qY","cE","Wn","Wm","Wl"],function(a,e,s,l,t,d,c,u,p,i,r,m,h,f,g,y,v,o,_){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var b=255,n=function(n){s.__extends(e,n);function e(e){var t=n.call(this,e.viewModelParams)||this;t.inputElementId=u.default.generate();t.fullHtml=a("Wm");t.isVisible=l.observable(!0);t.isReadFocused=l.observable(!1);t.isWriteFocused=l.observable(!1);t.isSelected=l.observable(!1);t.isReady=l.observable(!0);t.isSaved=l.observable(!1);t.waitingForRenderUpdate=!1;t.invertLabel=!1;t.inlineEdit=!1;t.inlineSave=!1;t.showInvisibleRegion=!1;t.savingStateText=d.strings.SavingState;t.savedStateText=d.strings.SavedState;t.saveButtonLabel=d.strings.SaveButtonAriaLabel;t.editButtonLabel=d.strings.EditButtonAriaLabel;t.loadingSpinnerTagName=p.default.tagName;t.arraySeparatorToken=";#";t.leaveFocusToSave=!0;t._renderWidth=190;t._isEdit=l.observable(!1);t._responsiveUI=t.resources.consume(y.resourceKey);t._panelProvider=t.resources.consume(v.resourceKey);t.supportsMobilePanelEdit=!1;t.addBindingHandlers({bindableHtml:c.default,keyboard:m.default,childFocus:h.default,element:g.default});t.isEdit=l.pureComputed({read:function(){return t._isEdit()||!t.fieldsManager.interactiveSave()},write:function(e){t._isEdit(e)}});t.fieldsManager=e.fieldsManager;t.field=e.field;e.field.data||(t.field.data=l.observable());t.field.hasException(!1);t.field.errorMessage("");t.displayElement=l.observable(null);t.shouldReadFieldSaved=l.observable(!1);t.inputElementMaxLength=t.field.schema.MaxLength;void 0===t.inputElementMaxLength&&(t.inputElementMaxLength=b);var i=t.field.schema;2===t.fieldsManager.clientFormType&&(i.DefaultValueFormatted?t.field.data(i.DefaultValueFormatted):i.DefaultValueTyped?t.setDefaultValueTyped(i.DefaultValueTyped):i.DefaultValue&&t.setDefaultValue(i.DefaultValue));t.title=i.Title;t.description=i.Description;t.fieldPlaceHolder=t.getFieldPlaceHolderString();t.showState=t.createPureComputed(function(){return!t.isReady()||t.isSaved()||t.aggregateValidation.hasError()});t.clientValidation={hasError:l.observable(!1),errorText:l.observable("")};t.aggregateValidation={hasError:l.pureComputed(function(){return t.field.hasException()||t.clientValidation.hasError()}),errorText:l.pureComputed(function(){var e=t.clientValidation.errorText();return""!==e?e:t.field.errorMessage()})};t.fieldSaveErrorReadoutValue=t.createPureComputed(function(){return t.aggregateValidation.hasError()?f.format(d.strings.FieldSaveErrorReadoutText,t.field.schema.Title,t.aggregateValidation.errorText()):""});t.subscribe(t.isEdit,function(e){e&&t.fieldsManager.interactiveSave.peek()?t.async.setImmediate(function(){return t.isSelected(!0)}):t.isWriteFocused(!1)});t.subscribe(t.isWriteFocused,function(e){t.leaveFocusToSave&&!e&&t.isEdit.peek()&&t.fieldsManager.interactiveSave.peek()&&t.saveChanges()});var r=i.BaseDisplayFormUrl,o=i.LookupListId;t.defaultColumnDefinition=s.__assign({key:i.Name,name:i.Title,fieldType:t.mapClientFormFieldToColumnFieldType(t.field),width:t._renderWidth,isVisible:!0,isVisibleMobile:!0,isCollapsable:!1,isIcon:!1,sortable:!1,filterable:!1,isSorted:!1,isFocused:l.observable(!1),isAscending:!0},r&&o?{dispFormUrl:r+"&ListId={"+o+"}"}:{},{isAutoHyperLink:!1});t._fieldRender=t.getFieldRenderForClientFormField(t.field);t.renderHtml=l.observable(t._fieldRender.renderField(t.fieldsManager.item.peek()));t.fieldSavingReadoutValue=f.format(d.strings.FieldSavingReadoutText,t.field.schema.Title);return t}e.prototype.updateRenderHtml=function(){var e=this;if(this.waitingForRenderUpdate){this.isEdit(!1);this.isReady(!0);this.isSaved(!0);this.fieldsManager.shouldSetReadFocusAfterSave()&&this.isReadFocused(!0);this.async.setTimeout(function(){e.isSaved(!1)},1e3);this.waitingForRenderUpdate=!1;this.async.setTimeout(function(){e.readOutFieldSaved()},50)}this.renderHtml(this._fieldRender.renderField(this.fieldsManager.item.peek()))};e.prototype.editField=function(e,t){this.supportsMobilePanelEdit&&"Small"===this._responsiveUI.formFactorSize()?this.launchEditPanel():this.isEdit(!0);return!1};e.prototype.cancelEdit=function(){this.field.hasException(!1);this.field.errorMessage("");if(this.clientValidation){this.clientValidation.hasError(!1);this.clientValidation.errorText("")}this.field.data(this.field.serverData)};e.prototype.onEscBase=function(e,t){this.cancelEdit();if(this.fieldsManager.interactiveSave.peek()){this.isEdit(!1);this.isReadFocused(!0);return!1}return!0};e.prototype.onDown=function(){return!0};e.prototype.onClick=function(e,t){if(this.fieldsManager.isReadOnly||!this.inlineEdit)return!0;var i,r=document.selection;window.getSelection?i=window.getSelection().toString():document.getSelection?i=document.getSelection().toString():r&&"Text"===r.type&&r.createRange&&(i=r.createRange().text);return!!i||this.editField(e,t)};e.prototype.saveChanges=function(){var i=this;if(!this.beforeSave||!this.isEdit.peek()||this.beforeSave()){this.field.hasException(!1);this.field.errorMessage("");if(this.fieldsManager.interactiveSave.peek())if(this.field.serverData!==this.field.data.peek()){if(!this.validate())return;var r=this.resources.consume(o.resourceKey);this.waitingForRenderUpdate=!0;this.isReady(!1);this.fieldsManager.saveChangesWithoutProcessing().then(function(){if(i.aggregateValidation.hasError.peek())i.isReady(!0);else{i.field.serverData=i.field.data.peek();i.isEdit(!1);r.logData({name:"InfoPane.Properties.Save",extraData:{fieldType:i.field.schema.Type,success:!0}})}},function(e){var t=(e=e instanceof Array?e:[e]).reduce(function(e,t){return e+e?"\r\n":""+t&&t.message?t.message.value?t.message.value:t.message:""},"");i.field.hasException(!0);i.field.errorMessage(t);i.isReady(!0);r.logData({name:"InfoPane.Properties.Save",extraData:{fieldType:i.field.schema.Type,success:!1}})})}else this.isEdit(!1)}};e.prototype.getFieldRenderer=function(e){return this._fieldRender};e.prototype.registerFieldRenderer=function(e,t){};e.prototype.getFieldPlaceHolderString=function(){var e,t=this.field.schema;switch(this.field.schema.FieldType.toLowerCase()){case"lookup":e=t.MaxQueryResult?f.format(d.strings.LookupEditorThrottleMessage,t.MaxQueryResult):d.strings.SingleChoiceEditorPlaceHolder;break;case"lookupmulti":e=t.MaxQueryResult?f.format(d.strings.LookupEditorThrottleMessage,t.MaxQueryResult):d.strings.MultiChoiceEditorPlaceHolder;break;case"choice":e=t.FillInChoice?d.strings.SingleChoiceFillInEditorPlaceHolder:d.strings.SingleChoiceEditorPlaceHolder;break;case"multichoice":e=t.FillInChoice?d.strings.MultiChoiceFillInEditorPlaceHolder:d.strings.MultiChoiceEditorPlaceHolder;break;case"text":case"note":e=d.strings.TextEditorPlaceHolder;break;case"attachments":e=d.strings.AttachmentsEditorPlaceHolder;break;default:e=d.strings.DefaultEditorPlaceHolder}"ContentType"===t.Name&&(e=d.strings.SingleChoiceEditorPlaceHolder);return e};e.prototype.getAriaLabel=function(){var e=this.field.data.peek()||d.strings.EmptyFieldAriaLabel,t=this.field.schema.Required?f.format(d.strings.RequiredFieldAriaLabel,this.title):this.title;t=t+", "+(e.displayName?e.displayName:e);return t=f.format(d.strings.PressEnterToEditAriaLabel,t)};e.prototype.validate=function(){this.clientValidation.errorText("");this.clientValidation.hasError(!1);if(this.field.schema.Required&&!this.field.data.peek()){this.clientValidation.errorText(d.strings.RequiredField);this.clientValidation.hasError(!0);return!1}return!0};e.prototype.setDefaultValueTyped=function(e){(e&&"string"==typeof e||"number"==typeof e)&&this.field.data(String(e))};e.prototype.setDefaultValue=function(e){e&&this.field.data(e)};e.prototype.convertFormStringToArray=function(e){return e?e.split(this.arraySeparatorToken).filter(function(e){return 0<e.length}):[]};e.prototype.getFieldRenderForClientFormField=function(e){var t;t=this.fieldsManager.nameToColumnDefinitionHash&&this.fieldsManager.nameToColumnDefinitionHash[e.schema.Name]?this.fieldsManager.nameToColumnDefinitionHash[e.schema.Name]:this.defaultColumnDefinition;return r.default.GetFieldRenderer(this,t,this.fieldsManager.item.peek())};e.prototype.launchEditPanel=function(){var e=this,t=this._panelProvider.requestPanel({hasCommandBar:!1,title:this.title,noTitle:!0,preserveLightDismiss:!0,showCloseButton:!1,includePadding:!1,component:{name:_.default.tagName,params:{field:this.field,onComplete:function(){e.saveChanges();t.state(1)}}}})};e.prototype.mapClientFormFieldToColumnFieldType=function(e){var t;switch(e.schema.FieldType.toLowerCase()){case"url":t=1===e.schema.DisplayFormat?i.ColumnFieldType.Image:i.ColumnFieldType.Hyperlink;break;case"usermulti":case"user":t=i.ColumnFieldType.User;break;case"lookup":case"lookupmulti":t=i.ColumnFieldType.Lookup;break;case"taxonomyfieldtype":case"taxonomyfieldtypemulti":t=i.ColumnFieldType.Taxonomy;break;case"Attachments":t=i.ColumnFieldType.Attachments;break;default:t=i.ColumnFieldType.Text}return t};e.prototype.readOutFieldSaved=function(){var e=this,t=this.displayElement.peek()&&this.displayElement.peek().textContent||d.strings.EmptyFieldReadoutText;this.fieldSavedReadoutValue=f.format(d.strings.FieldSavedReadoutText,this.field.schema.Title,t);this.shouldReadFieldSaved(!0);this.async.setTimeout(function(){e.shouldReadFieldSaved(!1)},500)};return e}(t.default);e.default=n});define("Wr",["require","exports","ex","Xb","Xa","W9","W8","W7","W6","W4","W2","W0","WX","WU","WQ","WN","WL","WJ","WH","WF","WE","WA","Wy","Ww","Wt","Ws"],function(e,t,s,l,d,c,u,p,m,h,f,g,y,v,_,b,x,S,C,P,k,I,T,w,E,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function r(){}r.RenderFieldByType=function(e,t,i){return r.GetFieldRenderer(e,i,t).renderField(t)};r.GetFieldRenderer=function(e,t,i){var r=null;if(null!=t.fieldRenderer&&t.fieldRenderer.isCacheable())return t.fieldRenderer;var o=window.SPClientTemplates;if(o){var n=o.TemplateManager;if(n){var a=n.c_templateOverrides;if(a&&a[t.internalName]&&a[t.internalName].View)return new c.default(t,e,a[t.internalName].View)}}switch(t.fieldType){case s.ColumnFieldType.Computed:r=new d.default(t).fieldRenderer();break;case s.ColumnFieldType.ComplianceRecordFlag:r=new D.default(t);break;case s.ColumnFieldType.FileSize:r=new u.default(t);break;case s.ColumnFieldType.Name:r=new p.default(t,e);break;case s.ColumnFieldType.Title:r=new m.default(t,e,i);break;case s.ColumnFieldType.Shared:r=new f.default(t,e);break;case s.ColumnFieldType.SharedWith:r=new g.default(t,e);break;case s.ColumnFieldType.DotDotDot:r=new y.default(t,e);break;case s.ColumnFieldType.User:r=new v.default(t,e);break;case s.ColumnFieldType.FileIcon:r=new _.default(t,e);break;case s.ColumnFieldType.DateTime:r=new h.default(t);break;case s.ColumnFieldType.Tag:r=new b.default(t,e);break;case s.ColumnFieldType.Hyperlink:r=new x.default(t,e);break;case s.ColumnFieldType.Image:r=new x.default(t,e,!0);break;case s.ColumnFieldType.Lookup:r=new S.default(t,e);break;case s.ColumnFieldType.Taxonomy:r=new C.default(t,e);break;case s.ColumnFieldType.Activity:r=new k.default(t,e);break;case s.ColumnFieldType.Attachments:r=new P.default(t,e);break;case s.ColumnFieldType.AverageRating:r=new T.default(t,e);break;case s.ColumnFieldType.WorkflowStatus:r=new w.default(t,e);break;case s.ColumnFieldType.ProgressBar:r=new I.default(t,e);break;case s.ColumnFieldType.RatedBy:case s.ColumnFieldType.Ratings:r=new T.default(t,e);break;case s.ColumnFieldType.Likes:case s.ColumnFieldType.LikedBy:r=new E.default(t,e);break;default:r=new l.default(t)}return r};return r}();t.default=i});define("Xb",["require","exports","U"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._column=e;this._parentViewModel=t;this._key=this._column.key;this._isAutoHyperLink=e.isAutoHyperLink;this._parentViewModel&&this._parentViewModel.registerFieldRenderer&&this._parentViewModel.registerFieldRenderer(this._key,this)}e.prototype.isCacheable=function(){return!this._parentViewModel};e.prototype.renderField=function(e){var t;this._column.getValue&&(t=this._column.getValue(e));void 0===t&&(t=e[this._column.key]);void 0===t&&(t=e.properties[this._column.key]);void 0===t&&(t=e.recycleBinProperties[this._column.key]);t=void 0===t?"":Array.isArray(t)?t.join(", "):t;if(!this._isAutoHyperLink&&!this._column.isAppendOnly&&t){t=i.default.encodeText(t);this._column.isNote&&t&&(t=t.replace(/\n/g,"<br>"))}return t};e.prototype._getThis=function(){return"$data.getFieldRenderer('"+this._key+"')"};e.prototype._getOnClick=function(){return"function(data, evt) { "+this._getThis()+".onClick(evt); }"};return e}();t.default=r});define("Xa",["require","exports","ap","Xb"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.fieldRenderer=function(){return new r.default(this._column)};return e}(r.default);t.default=o});define("W9",["require","exports","ap","Xb","iE"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t,i){var r=o.call(this,e,t)||this;r._jsCode=i;return r}e.prototype.renderField=function(e){var t={};t.CurrentItem=e.properties;var i=this._parentViewModel.resources.consume(n.listContext);if(i.rawListSchema&&i.rawListSchema.Field)for(var r=0;r<i.rawListSchema.Field.length;r++){var o=i.rawListSchema.Field[r];if(o.Name===this._column.internalName){t.CurrentFieldSchema=o;break}}try{return("string"==typeof this._jsCode?new Function("ctx",this._jsCode):this._jsCode)(t)}catch(e){0}};return e}(r.default);t.default=o});define("W8",["require","exports","ap","Xb","hO"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.renderField=function(e){return o.default.getDisplayString(e.size,{ignoreZero:!0})};return e}(r.default);t.default=n});define("W7",["require","exports","ap","Xb","U","dZ","bX","by","ob"],function(e,t,i,r,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t){var i=o.call(this,e,void 0)||this;i._urlDataSource=t.resources.consume(a.url);var r=t.resources.consume(l.platformDetection);i._useCustomColumn=r.isMobile&&t.resources.isExposed(s.useMobileList)&&t.resources.consume(s.useMobileList);return i}e.prototype.renderField=function(e){var t=o.prototype.renderField.call(this,e),i=n.default.encodeText(d.getNameFieldAriaLabelForItem(e)),r=this._urlDataSource.getDefaultClickUrl(e,{preferCurrentView:!0});return'<a tabindex="-1" aria-label="'+i+'" title="'+t+'" href="'+(r?n.default.encodeText(r):"#")+'" data-bind="event: {'+(this._useCustomColumn?"":"click: function(obj, ev) { return $data.onClick(null, ev); },mousedown: function(obj, ev) { return $data.onMouseDown(null, ev); }")+'}">'+t+"</a>"};return e}(r.default);t.default=o});define("W6",["require","exports","ap","Xb"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(e,r);function e(e,t,i){return r.call(this,e,t)||this}e.prototype.renderField=function(e){var t=r.prototype.renderField.call(this,e);return'<a tabindex="-1" href="javascript: " title="'+t+'" data-bind="click: function(obj, ev) { return $data.onClick(null, ev); }">'+t+"</a>"};return e}(r.default);t.default=o});define("W4",["require","exports","ap","Xb","W5"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(){return null!==o&&o.apply(this,arguments)||this}e.prototype.renderField=function(e){var t="<span>"+o.prototype.renderField.call(this,e)+"</span>",i=null;e.dateModifiedValue?i=e.dateModifiedValue:e.dateDeleted&&(i=e.dateDeleted);if(i&&"dateModified"===this._key){var r=new Date(i).getTime();r&&Math.abs(Date.now()-r)<=36e5&&(t='<span class="od-DateField--newItem">&#10033;<span>'+t)}return t};return e}(r.default);t.default=o});define("W5",["c","az"],function(e,t){e.loadStyles([{rawString:".od-DateField--newItem{color:#107c10;margin-right:3px}"}])});define("W2",["require","exports","ap","Xb","d","WV","W3"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=this._column,i=e[t.key];i||(i=e.properties[t.key]);return i?'<i class="od-SharedField--shared '+o.getIconClassName("People")+'"></i><span>'+i+"</span>":""};return t}(r.default);t.default=n});define("WV",["c","az"],function(e,t){e.loadStyles([{rawString:".od-FieldRender{text-decoration:none;text-overflow:ellipsis;overflow:hidden}.od-FieldRender-display{cursor:pointer;white-space:nowrap}.od-FieldRender-icon{display:inline-block}[dir=ltr] .od-FieldRender-icon{margin-right:6px}[dir=rtl] .od-FieldRender-icon{margin-left:6px}.od-FieldRender-person:hover,.od-FieldRender-sharedWith:hover{cursor:pointer;text-decoration:underline}.od--isNonMobile .DetailsRow .od-FieldRender-dot{visibility:hidden;padding:0 10px}[dir=ltr] .od--isNonMobile .DetailsRow .od-FieldRender-dot{margin-left:-10px}[dir=rtl] .od--isNonMobile .DetailsRow .od-FieldRender-dot{margin-right:-10px}.od--isNonMobile .DetailsRow .od-FieldRender-dot:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od--isNonMobile .DetailsRow .od-FieldRender-dot .ms-Icon--More{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od--isNonMobile .DetailsRow .DetailsRow-cell:focus .od-FieldRender-dot,.od--isNonMobile .DetailsRow:hover .od-FieldRender-dot{visibility:visible}"}])});define("W3",["c","az"],function(e,t){e.loadStyles([{rawString:"[dir=ltr] .od-SharedField--shared::before{padding-right:4px}[dir=rtl] .od-SharedField--shared::before{padding-left:4px}"}])});define("W0",["require","exports","ap","Xb","W1","U","WV"],function(e,t,i,r,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=this.sharedWithViewModel=new(this._parentViewModel.resources.injected(n.default))({item:e}),i=t.sharingString,r=t.imageClass,o=a.default.encodeText(t.imageAlt);return'<div class="od-FieldRender" href="javascript: " title="'+o+'" data-bind="click: '+this._getOnClick()+'"><span class="od-FieldRender-icon"><i class="'+r+'" alt="'+o+'"></i></span><span class="od-FieldRender-display ms-noWrap ms-imnSpan ms-displayInlineBlock">'+i+"</span></div>"};t.prototype.onClick=function(e){this.sharedWithViewModel.onClick(e)};return t}(r.default);t.default=o});define("W1",["require","exports","ap","aC","Wv","U","bF","c7","d"],function(o,e,t,n,a,s,i,l,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(r){t.__extends(e,r);function e(e){var t,i=r.call(this,e)||this;i._item=e.item;if(Number(i._item.properties.PrincipalCount)<1){i.imageClass=d.getIconClassName("Lock");i.imageAlt=a.strings.SharedWithNoneIcon;t=a.strings.SharedWithNone_Short}else{i.imageClass=d.getIconClassName("People");i.imageAlt=a.strings.SharedWithSomeIcon;t=a.strings.SharingHintShared_Short}i.sharingString=s.default.encodeText(t);return i}e.prototype.onClick=function(t){var i=this;this.trackPromise(l.loadModule({path:"LV",getModule:function(){return new n.default(function(e,t){o(["LV"],e,t)})}})).done(function(e){new(i.resources.injected(e))({useToggleBehavior:!1,isSharingSectionExpanded:!0}).execute(t)})};return e}(i.default);e.default=r});define("WX",["require","exports","ap","aq","Xb","WZ","d","WY"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this.dotDotDotViewModel=new(this._parentViewModel.resources.injected(n.default))({item:r.observable(e)});return'<div class="od-FieldRender-dot" data-bind="click: '+this._getOnClick()+'"><i class="'+a.getIconClassName("More")+'"></i></div>'};t.prototype.onClick=function(e){this.dotDotDotViewModel.onDotDotDotClicked(null,e)};return t}(o.default);t.default=s});define("WZ",["require","exports","ap","WT","cE"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.onDotDotDotClicked=function(e,t){var i=document.createEvent("CustomEvent");i.initCustomEvent("contextmenu",!0,!0,t);t.currentTarget.dispatchEvent(i);this.resources.consume(o.resourceKey).logData({name:"Ellipsis.Callout.Click",isIntentional:!0})};return e}(r.default);t.default=n});define("WT",["require","exports","ap","bF"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._parent=null;t._parent=e.parent;return t}e.prototype.getTextValue=function(e){return this._parent.getTextValue(e)};return e}(i.default);t.default=o});define("WY",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-callout{display:inline-block;cursor:pointer}.ms-callout-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}])});define("WU",["require","exports","ap","aq","Xb","WW","U","ba","WV"],function(e,t,i,l,r,d,c,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this.userFieldViewModel=new(this._parentViewModel.resources.injected(d.default))({item:l.observable(e),column:this._column});var t=this.userFieldViewModel.users.peek();if(!t)return"";for(var i="",r=0,o=0,n=t;o<n.length;o++){var a=n[o],s=c.default.encodeText(a.title);i+='<div class="od-FieldRender" aria-label="'+c.default.encodeText(this.userFieldViewModel.getAriaLabel(s))+'"><span class="'+this._getUserFieldClassNames()+'" data-bind="event: {click: '+this._getOnClickHandler(r)+",clickBubble: false,mousemove: "+this._getOnMouseMovedHandler(r)+",mouseout: "+this._getOnHoverEndedHandler()+"},element: "+this._getElementBinding()+'">'+s+"</span></div>";r++}return i};t.prototype.onClick=function(e,t){t="number"==typeof t?t:0;this.userFieldViewModel.launchPersonaCard(e,t)};t.prototype.mouseMoved=function(e,t){this.userFieldViewModel.launchPersonaCardAfterDelay(e,t)};t.prototype.hoverEnded=function(){this.userFieldViewModel.cancelDelayedPersonaCardLaunch()};t.prototype._getOnClickHandler=function(e){return"function(data, evt) { "+this._getThis()+".onClick(evt, "+e+"); }"};t.prototype._getOnMouseMovedHandler=function(e){return"function(data, evt) { "+this._getThis()+".mouseMoved(evt, "+e+"); }"};t.prototype._getOnHoverEndedHandler=function(){return"function(data, evt) { "+this._getThis()+".hoverEnded(); }"};t.prototype._getElementBinding=function(){return this._getThis()+".userFieldViewModel.fieldElement"};t.prototype._getUserFieldClassNames=function(){var e="od-FieldRender-display ms-noWrap ms-imnSpan ms-displayInlineBlock";(o.isFeatureEnabled(o.PeopleCardsOnLoki)||o.isFeatureEnabled(o.PeopleCardsReactComponent))&&(e+=" od-FieldRender-person");return e};return t}(r.default);t.default=n});define("WW",["require","exports","ap","aC","aq","bF","c7","d7","iE","nU","ba"],function(d,e,t,c,u,i,p,m,h,o,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(l){t.__extends(e,l);function e(e){var i=l.call(this,e)||this,t=i.observables,r=e.item();i.item=t.create(r);i._column=e.column;i._peopleCardTimeoutId=-1;i._peopleCardDataTimeoutId=-1;i._profileProvider=i.resources.consume(m.profile.optional);i.fieldElement=t.create(null);i.users=t.createArray();var o=r.properties[i._column.key];if(o&&o.length){i.users(o);if(i._profileProvider){var n=o.map(function(e){return e.sip});i._profileProvider.personRendered(n)}}if(f.isFeatureEnabled(f.PeopleCardsReactComponent)){var a=i.users.peek()[0];if(a){var s=i.resources.consume(h.pageContext);i.createBackgroundComputed(function(){var t=i.fieldElement();t&&i.trackPromise(p.loadModule({path:"Rb",getModule:function(){return new c.default(function(e,t){d(["Rb"],e,t)})}}).then(function(e){e.personaRendered(t,a.sip||a.email,s);u.utils.domNodeDisposal.addDisposeCallback(t,function(){e.personaRemoved(t,a.sip||a.email,s)})}))})}}return i}e.prototype.getAriaLabel=function(e){return this._column.name+", "+e};e.prototype.launchPersonaCardAfterDelay=function(e,t){var i=this;void 0===t&&(t=0);var r=this.users.peek()[t];if(r){this._lastMouseMove=e;this._profileProvider&&-1===this._peopleCardDataTimeoutId&&(this._peopleCardDataTimeoutId=this.async.setTimeout(function(){return i._profileProvider.getPeopleCardData(r.email||r.userId||r.sip)},o.PEOPLE_CARD_DATA_PRELOAD_DELAY));-1===this._peopleCardTimeoutId&&(this._peopleCardTimeoutId=this.async.setTimeout(function(){return i.launchPersonaCard(null,t,!0)},o.PEOPLE_CARD_HOVER_DELAY))}};e.prototype.cancelDelayedPersonaCardLaunch=function(){this._lastMouseMove=null;this.async.clearTimeout(this._peopleCardTimeoutId);this.async.clearTimeout(this._peopleCardDataTimeoutId);this._peopleCardTimeoutId=-1;this._peopleCardDataTimeoutId=-1};e.prototype.launchPersonaCard=function(i,e,r){var o=this;void 0===i&&(i=null);void 0===e&&(e=0);void 0===r&&(r=!1);i=i||this._lastMouseMove;this.cancelDelayedPersonaCardLaunch();var n=this.users.peek()[e];n&&n.sip&&p.loadModule({path:"Rb",getModule:function(){return new c.default(function(e,t){d(["Rb"],e,t)})}}).then(function(e){var t={name:n.title,email:n.email,image:n.picture,sip:n.sip,userId:n.sip};new(o.managed(e))(t).show(i,r)})};return e}(i.default);e.default=r});define("WQ",["require","exports","ap","aq","Xb","di","WR","U","dq","bX","ob","by","dg"],function(r,e,i,c,t,u,p,m,o,h,f,g){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=this._parentViewModel.resources,i=c.observable(e),r=t.consume(g.platformDetection).isMobile&&t.consume(h.useMobileList.optional),o={iconName:this._getIconName(e),iconUrl:this._getIconUrl(e,r),extension:e.extension,desiredSize:r?48:16,overlayType:p.default.getOverlayType(i),iconFieldAriaLabel:f.getIconFieldAriaLabelForItem(e),hoverText:p.default.getHoverText(i),onClick:p.default.getOnClick(i,t)};this.fileTypeIconViewModel=new(t.injected(u.default))(o);var n=this.fileTypeIconViewModel.onClick?"FileTypeIcon FileTypeIcon--clickable":"FileTypeIcon",a=this.fileTypeIconViewModel.overlayUrl,s=this.fileTypeIconViewModel.iconFieldAriaLabel.peek(),l=m.default.encodeText(s),d=this.fileTypeIconViewModel.size;return'<span class="'+n+'" title="'+m.default.encodeText(this.fileTypeIconViewModel.hoverText)+'"'+(s?' aria-label="'+l+'"':"")+' data-bind="click: '+this._getOnClick()+'" tabindex="-1"><img class="FileTypeIcon-icon" src="'+m.default.encodeText(this.fileTypeIconViewModel.iconUrl.peek()||"")+'"'+(s?' alt="'+l+'"':"")+' style="width: '+d+"; height: "+d+"; font-size: "+d+'" data-bind="attr: {src: '+this._getThis()+'.fileTypeIconViewModel.iconUrl}" />'+(a?'<img class="FileTypeIcon-overlay" src="'+m.default.encodeText(a)+'" />':"")+"</span>"};t.prototype.onClick=function(e){"function"==typeof this.fileTypeIconViewModel.onClick&&this.fileTypeIconViewModel.onClick(e)};t.prototype._getIconName=function(e){return e.state&&4===e.state.upload.status?o.genericFile:e.iconName};t.prototype._getIconUrl=function(e,t){var i="undefined"==typeof __webpack_public_path__?r.toUrl("odsp-media/images/loading/loadingSpinner.gif"):r("@ms/odsp-media/dist/media/images/loading/loadingSpinner.gif");if(e.state)switch(e.state.upload.status){case 1:return i;default:return e.iconUrl}return e.iconUrl};return t}(t.default);e.default=n});define("WR",["require","exports","ap","aC","WT","WS","c7","a0","ob","m8"],function(o,e,t,n,i,a,s,l,d,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(i){t.__extends(r,i);function r(e){var t=i.call(this,e)||this;t.item=e.item;t.iconFieldViewModelType=r;return t}r.getOverlayType=function(e){var t=e(),i=a.default.none,r=t.policyTip;if(r){var o=1==(1&r);2==(2&r)?i=a.default.block:o&&(i=a.default.notify)}else t.isViolation?i=a.default.block:t.properties.CheckedOutUserId?i=a.default.checkOut:t.state&&4===t.state.upload.status?i=a.default.notify:c.complianceRecordFlagValue(t)&&(i=a.default.record);return i};r.getHoverText=function(e){var t=e();return d.getTooltipText(t)};r.getOnClick=function(i,r){return 1&i().policyTip?function(t){l.Engagement.logData({name:"PolicyTip.LaunchFromListView"});s.loadModule({path:"R2",getModule:function(){return new n.default(function(e,t){o(["R2"],e,t)})}}).then(function(e){new(r.injected(e))({item:i}).execute(t)});return!1}:null};return r}(i.default);e.default=r});define("WS",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.none=0]="none";e.checkOut="checkOutOverlay.svg";e.notify="notifyOverlay.svg";e.block="blockOverlay.svg";e.record="recordOverlay.svg"}(i||(i={}));t.default=i});define("WN",["require","exports","ap","Xb","V","U","WP","WO"],function(e,t,i,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=e.childCount,i=n.format(n.pluralSelect(t,s.strings.photosCountSingular,s.strings.photosCount),t),r=e.folder,o=r&&r.covers[0];return'<div class="od-TagField"><div class="od-TagField-image">'+(o?'<img src="'+n.format(o.url,50,50)+'" alt="" />':"")+'</div><div class="od-TagField-name ms-font-m">'+a.default.encodeText(e.name)+'</div><div class="od-TagField-count"'+a.default.encodeText(i)+"</div></div>"};return t}(r.default);t.default=o});define("WO",["c","az"],function(e,t){e.loadStyles([{rawString:".od-TagField{height:54px;box-sizing:border-box;cursor:pointer}.od-TagField .od-TagField-image{width:50px;height:50px;background-color:rgba(0,0,0,.25)}html[dir=ltr] .od-TagField .od-TagField-image{float:left}html[dir=rtl] .od-TagField .od-TagField-image{float:right}.od-TagField .od-TagField-name{max-width:150px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;vertical-align:middle;height:100%;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] .od-TagField .od-TagField-name{margin-left:10px}[dir=rtl] .od-TagField .od-TagField-name{margin-right:10px}html[dir=ltr] .od-TagField .od-TagField-name{float:left}html[dir=rtl] .od-TagField .od-TagField-name{float:right}[dir=ltr] .od-TagField .od-TagField-name{margin-right:5px}[dir=rtl] .od-TagField .od-TagField-name{margin-left:5px}.od-TagField .od-TagField-count{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:';font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:11px;font-weight:400;line-height:54px}'}])});define("WL",["require","exports","ap","Xb","U","WM"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e,t,i){var r=o.call(this,e,t)||this;r._isPicture=!!i;r._url="";return r}e.prototype.renderField=function(e){var t=e.properties[this._column.key];if(!t)return"";var i=e.properties[this._column.key+".desc"];i||(i=t);this._url=t;var r=n.default.encodeText(t),o=n.default.encodeText(i);return this._isPicture?'<div class="od-FieldRender-image"><img src="'+r+'" title="'+o+'" class="od-FieldRender-imageDisplay" data-bind="click: '+this._getOnClick()+',clickBubble: false"></a></div>':'<div class="od-FieldRender"><a class="od-FieldRender-display od-FieldRender-display--link" href="'+r+'" tabindex="-1" title="'+r+'" target="_blank" data-bind="click: '+this._getOnClick()+',clickBubble: false">'+o+"</a></div>"};e.prototype.onClick=function(e){e&&e.target&&this._url&&window.open(this._url,"_blank")};return e}(r.default);t.default=o});define("WM",["c","az"],function(e,t){e.loadStyles([{rawString:".od-FieldRender-image{max-width:64px;max-height:64px;overflow:hidden;display:block;margin:0 auto}.od-FieldRender-imageDisplay{cursor:pointer;max-width:100%;max-height:100%}.DetailsRow-cell a.od-FieldRender-display,.DetailsRow-cell a.od-FieldRender-display:visited{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px}.DetailsRow-cell a.od-FieldRender-display:hover,.DetailsRow-cell a.od-FieldRender-display:visited:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}"}])});define("WJ",["require","exports","ap","Xb","WK","U"],function(e,t,i,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this._lookupFieldViewModel=new(this._parentViewModel.resources.injected(a.default))({item:e,column:this._column});var t=this._lookupFieldViewModel.lookups,i="";if("string"==typeof t)i=s.default.encodeText(t);else if(t)for(var r=0;r<t.length;r++){var o=t[r],n=s.default.encodeText(o.lookupValue);i+='<div class="od-FieldRender" aria-label="'+n+'"><span class="od-FieldRender-display od-FieldRender-display--link" data-bind="click: function (data, evt) { '+this._getThis()+".onClick(evt, "+r+'); },clickBubble: false">'+n+"</span></div>"}return i};t.prototype.onClick=function(e,t){this._lookupFieldViewModel.launchLookupDisplayForm(e,this._lookupFieldViewModel.lookups[t].lookupId)};return t}(r.default);t.default=o});define("WK",["require","exports","ap","bF","ci","aI","nH","b3"],function(e,t,i,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._column=e.column;var i=e.item.properties[t._column.key];(i&&"string"==typeof i||Array.isArray(i)&&i.length)&&(t.lookups=i);return t}e.prototype.launchLookupDisplayForm=function(e,t){var i=this._column.dispFormUrl;i+="&ID=";i+=t;i+="&RootFolder=*&IsDlg=1";return this.resources.consume(o.resourceKey).requestDialog({title:"",size:"Large",control:s.toSpecification(a.default,{componentUrl:i,showInDialog:!0,heightOffset:.5})}).wait().then(function(){return{resultType:n.ResultTypeEnum.Success}})};return e}(r.default);t.default=l});define("WH",["require","exports","ap","aq","Xb","WI","U"],function(e,t,i,a,r,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){this._taxonomyFieldViewModel=new(this._parentViewModel.resources.injected(s.default))({item:a.observable(e),column:this._column});for(var t="",i=0,r=this._taxonomyFieldViewModel.terms();i<r.length;i++){var o=r[i],n=l.default.encodeText(o.Label);t+='<div class="od-UserField" aria-label="'+n+'"><span class="ms-noWrap ms-imnSpan ms-displayInlineBlock">'+n+"</span></div>"}return t};return t}(r.default);t.default=o});define("WI",["require","exports","ap","aq","bF"],function(e,t,i,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this,i=e.item();t.item=n.observable(i);t._column=e.column;t.terms=n.observableArray(null);var r=i.properties[t._column.key];!r||r instanceof Array||""===r||(r=[{Label:r.Label,TermID:r.TermID}]);r&&0<r.length&&t.terms(r);return t}return e}(r.default);t.default=o});define("WF",["require","exports","ap","Xb","d","WG"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(){return null!==t&&t.apply(this,arguments)||this}e.prototype.renderField=function(e){return'<div class="ms-Attachment-icon">'+("1"===t.prototype.renderField.call(this,e)?'<span class="'+o.getIconClassName("Attach")+'"></span>':"")+"</div>"};return e}(r.default);t.default=n});define("WG",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-Attachment-icon{font-size:16px;vertical-align:bottom;padding:0;border:0;width:30px;height:30px}"}])});define("WE",["require","exports","ap","Xb"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){var t=e[this._column.key];void 0===t&&(t=e.properties[this._column.key]);void 0===t&&(t=e.recycleBinProperties[this._column.key]);return t=void 0===t?"":Array.isArray(t)?t.join(", "):t};return t}(r.default);t.default=o});define("WA",["require","exports","ap","Xb","V","WD","WC","WB"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e,t){return i.call(this,e,t)||this}e.prototype.renderField=function(e){if(!e.properties||!e.properties.progress)return"";this.viewModel=new(this._parentViewModel.resources.injected(n.default))({progress:e.properties.progress});var t=this._getThis(),i=t+".getTitle()";return'<div class="ProgressBar-listview-track" data-bind="attr: {\'aria-label\': '+i+",'title': "+i+'}"><div class="ProgressBar-listview-value" data-bind="style: {width: '+t+".viewModel.percentage() + '%'}\"></div></div>"};e.prototype.getTitle=function(){return o.format(o.getLocalizedCountValue(a.strings.ViewsText,a.strings.ViewsTextIntervals,this.viewModel.current()),this.viewModel.current())};return e}(i.default);t.default=s});define("WD",["require","exports","ap","bF"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(u){i.__extends(e,u);function e(e){var t=u.call(this,e)||this,i=e.progress,r=i.minimum,o=void 0===r?t.createObservable(0):r,n=i.maximum,a=void 0===n?t.createObservable(0):n,s=i.current,l=void 0===s?t.createObservable(0):s,d=e.description,c=void 0===d?t.createObservable(""):d;t.minimum=o;t.maximum=a;t.current=l;t.description=c;t.size=t.createPureComputed(t._computeSize);t.value=t.createPureComputed(t._computeValue);t.percentage=t.createPureComputed(t._computePercentage);t.normalizedPercentage=t.createPureComputed(t._computeNormalizedPercentage);return t}e.prototype._computeSize=function(){return this.maximum()-this.minimum()};e.prototype._computeValue=function(){return this.current()-this.minimum()};e.prototype._computePercentage=function(){return 0===this.size()?0:this.value()/this.size()*100};e.prototype._computeNormalizedPercentage=function(){var e=this.percentage();return 100<e?1e4/e:e};return e}(r.default);t.default=o});define("WB",["c","az"],function(e,t){e.loadStyles([{rawString:".ProgressBar-track{height:2px;position:relative;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ProgressBar-track .ProgressBar-value--under{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .ProgressBar-track .ProgressBar-value--under{left:0}[dir=rtl] .ProgressBar-track .ProgressBar-value--under{right:0}.ProgressBar-track .ProgressBar-value--exceeded{background-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}html[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{border-left:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{border-right:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{float:right}html[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{float:left}[dir=ltr] .ProgressBar-track .ProgressBar-value--exceeded{right:0}[dir=rtl] .ProgressBar-track .ProgressBar-value--exceeded{left:0}.ProgressBar-listview-track{height:100%}.ProgressBar-listview-value{height:7px;display:inline-block;vertical-align:middle;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";transition:width 267ms cubic-bezier(.1,.9,.2,1)}.ProgressBar-value{position:absolute;top:0;bottom:0;transition:width 267ms cubic-bezier(.1,.9,.2,1)}"}])});define("Wy",["require","exports","ap","Xb","V","dZ","eX","Wv","iE","d","gU","Wz"],function(e,t,i,r,o,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._ratingDataSource=i._parentViewModel.resources.consume(n.rating);i._itemProvider=i._parentViewModel.resources.consume(a.resourceKey);i._pageContext=i._parentViewModel.resources.consume(l.pageContext);i.onMouseover=function(e){return i._highlightStars(e,!1)};i.onMouseout=function(e){return i._highlightStars(e,!0)};return i}e.prototype.renderField=function(e){this._listItem=e;var t=!c.isCheckedOutByOther(e,this._pageContext.userId);this._rateBylength=e.reputationProperties.RatedBy?e.reputationProperties.RatedBy.length:0;this._averageRating=parseFloat(e.reputationProperties.AverageRating);for(var i='<a tabindex="0">',r=0;r<5;r++){var o="od-Rating-star"+(this._averageRating>=r+1?"Full":this._averageRating>r?"Half":"Empty")+" "+d.getIconClassName("FavoriteStarFill");i+='<div tabindex="0" id="'+r+'" title="" class="'+(o+=t?" od-Rating-enabled":"")+'" ';i+=t?'data-bind="\nclick: '+this._getOnClick()+",\nevent: {\n    mouseover: function(data, evt){"+this._getThis()+".onMouseover(evt)},\n    mouseout: function(data, evt){"+this._getThis()+'.onMouseout(evt)}\n}"':"";i+="></div>"}return i+='</a><span tabindex="0" title="'+s.strings.RatedByCountTitle+'" class="od-Rating-count">'+this._rateBylength+"</span>"};e.prototype.onClick=function(e){if(e&&e.target){var t=e.target;this._averageRating=this.computeAverageRating(Number(this._selectedStarid)+1);this._highlightStars(e,!0);this.setRating(e,Number(t.id)+1)}e.cancelBubble=!0;e.preventDefault()};e.prototype._highlightStars=function(e,t){if(e&&e.target){var i=e.target,r=i.parentElement.children,o=t?"od-Rating-starFull":"od-Rating-starHover";this._selectedStarid=Number(i.id);var n=this._averageRating,a=t?n-1:this._selectedStarid;r[this._selectedStarid].setAttribute("title",this.getElementTitle());r[this._selectedStarid].setAttribute("aria-label",this.getAriaLabel());for(var s=0;s<5;s++)r[s].className=(s<=a?o:"od-Rating-starEmpty")+" "+d.getIconClassName("FavoriteStarFill");var l=r[Math.floor(n)];t&&n&&n%1&&l&&(l.className="od-Rating-starHalf "+d.getIconClassName("FavoriteStarFill"))}};e.prototype.setRating=function(e,t){var i=this,r={item:this._listItem,rating:t};return this._ratingDataSource.setRating(r).then(function(e){isNaN(e)||(i._averageRating=e);return i._itemProvider.invalidateItem(i._listItem.parentKey,{triggerFetch:!0})})};e.prototype.rated=function(){for(var e=this._listItem.reputationProperties,t=e.Ratings.split(","),i=e.RatedBy||[],r=0;r<i.length;r++)if(Number(i[r].id)===this._pageContext.userId)return Number(t[r]);return-1};e.prototype.getElementTitle=function(){var e=this.rated();return-1!==e?o.format(s.strings.ModifyRatingTitle,e):o.format(s.strings.ApplyRatingTitle,Number(this._selectedStarid)+1)};e.prototype.getAriaLabel=function(){var e=this.rated(),t=0<this._averageRating?o.format(o.pluralSelect(this._averageRating,s.strings.AverageRatingAriaLabel,s.strings.AverageRatingPluralAriaLabel),this._averageRating):"";t+=-1!==e?o.format(s.strings.ModifyRatingTitle,e):"";return t+=o.format(s.strings.ApplyRatingTitle,Number(this._selectedStarid)+1)};e.prototype.computeAverageRating=function(e){var t=this._averageRating||0,i=this._rateBylength;return-1!==this.rated()&&0!==i?(t*i-this.rated()+e)/i:(t*i+e)/(i+1)};return e}(r.default);t.default=u});define("Wz",["c","az"],function(e,t){e.loadStyles([{rawString:".DetailsRow-cell.AverageRating{overflow:visible}.od-Rating-starEmpty,.od-Rating-starFull,.od-Rating-starHalf,.od-Rating-starHover{width:16px;text-align:center;vertical-align:top;height:36px;position:relative;top:1px;cursor:pointer}.od-Rating-starEmpty:after,.od-Rating-starEmpty:before,.od-Rating-starFull:after,.od-Rating-starFull:before,.od-Rating-starHalf:after,.od-Rating-starHalf:before,.od-Rating-starHover:after,.od-Rating-starHover:before{vertical-align:top;position:relative;top:10px}.od-Rating-enabled.od-Rating-starHalf:focus,.od-Rating-starEmpty.od-Rating-enabled:focus,.od-Rating-starFull.od-Rating-enabled:focus,.od-Rating-starHalf.od-Rating-enabled:focus,.od-Rating-starHover.od-Rating-enabled:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-Rating-enabled.od-Rating-starHalf:active,.od-Rating-starEmpty.od-Rating-enabled:active,.od-Rating-starFull.od-Rating-enabled:active,.od-Rating-starHalf.od-Rating-enabled:active,.od-Rating-starHover.od-Rating-enabled:active{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-Rating-starFull{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-Rating-starEmpty,.od-Rating-starHalf{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";position:relative}@media screen and (-ms-high-contrast:active){.ms-Icon.ms-Icon--FavoriteStarFill.od-Rating-starHalf:before,.od-Rating-starEmpty.ms-Icon.ms-Icon--FavoriteStarFill:before{content:'\\E734'}}.od-Rating-starHalf:after{font-family:FabricMDL2Icons;content:'\\E735';width:40%;overflow:hidden;position:absolute;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir=ltr] .od-Rating-starHalf:after{left:2px}[dir=rtl] .od-Rating-starHalf:after{right:2px}.od-Rating-starHover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:'}.od-Rating-count{display:inline-block;vertical-align:top;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:12px;line-height:36px}[dir=ltr] .od-Rating-count{margin-left:8px}[dir=rtl] .od-Rating-count{margin-right:8px}"}])});define("Ww",["require","exports","ap","Xb","dc","U","Wx"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._navigation=t.resources.consume(o.navigation);return i}e.prototype.renderField=function(e){var t=e.properties[this._column.key];if(!t)return"";var i=this._getWorkflowStatusUrlAndDisplay(t),r=n.default.encodeText(i.url),o=n.default.encodeText(i.display);return'<a class="ms-workflowStatus--linkText" href="'+r+'" title="'+r+'" target="_blank" data-bind="click: '+this._getOnClick()+', clickBubble: false">'+o+"</a>"};e.prototype.onClick=function(e){if(e&&e.target){var t=e.currentTarget,i=null;"A"===t.tagName?i=t.href:"IMG"===t.tagName&&(i=t.src);this._navigation.navigateTo(i)}};e.prototype._getWorkflowStatusUrlAndDisplay=function(e){var t=document.createElement("div");t.innerHTML=e;var i=t.querySelector("a");return{url:i.href,display:i.innerHTML}};return e}(r.default);t.default=a});define("Wx",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-workflowStatus--linkText>span{font-size:12px}"}])});define("Wt",["require","exports","ap","Xb","dZ","eX","iE","Wv","d","gU","Wu"],function(e,t,i,r,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._ratingDataSource=i._parentViewModel.resources.consume(o.rating);i._itemProvider=i._parentViewModel.resources.consume(n.resourceKey);i._pageContext=i._parentViewModel.resources.consume(a.pageContext);return i}e.prototype.renderField=function(e){this._listItem=e;this._likeCount=Number(this._listItem.properties.LikesCount)||0;this._isEnabled=!d.isCheckedOutByOther(e,this._pageContext.userId);return'\n<div class="od-Like" '+(this._isEnabled?'data-bind="click: '+this._getOnClick()+'"':"")+'>\n  <div class="'+this.getHeartClass()+'"></div>\n  <span class="od-Like-count">'+this._likeCount+'</span>\n  <span class="od-Like-text">'+s.strings.LikesCountText+"</span>\n</div>"};e.prototype.onClick=function(e){if(e&&e.target){var t=e.currentTarget,i=!this.isLiked();t.firstElementChild.className=this.getHeartClass();this.setLike(i);t.getElementsByClassName("od-Like-count")[0].innerHTML=String(this._likeCount+(i?1:-1))}e.cancelBubble=!0;e.preventDefault()};e.prototype.setLike=function(e){var t=this,i={item:this._listItem,like:e};return this._ratingDataSource.setLike(i).then(function(e){isNaN(e)||(t._likeCount=e);return t._itemProvider.invalidateItem(t._listItem.parentKey,{triggerFetch:!0})})};e.prototype.isLiked=function(){var t=this,e=this._listItem.reputationProperties.LikedBy;return e&&e.some(function(e){return Number(e.id)===t._pageContext.userId})};e.prototype.getHeartClass=function(){var e=this.isLiked()?"od-Like-heartFull "+l.getIconClassName("HeartFill"):"od-Like-heartEmpty "+l.getIconClassName("Heart");return e+=this._isEnabled?" od-Like-enabled":""};return e}(r.default);t.default=c});define("Wu",["c","az"],function(e,t){e.loadStyles([{rawString:".od-Like{height:34px;line-height:34px;padding:0 8px;display:inline-block;position:relative;top:1px}.od-Like.od-Like-enabled:hover{cursor:pointer}.od-Like.od-Like-enabled:hover .od-Like-heartEmpty,.od-Like.od-Like-enabled:hover .od-Like-heartFull{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-Like.od-Like-enabled:hover .od-Like-heartEmpty:before{content:'\\e16a'}.od-Like.od-Like-enabled:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-Like.is-disabled .od-Like-heartEmpty,.od-Like.is-disabled .od-Like-heartFull{color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-Like.is-disabled .od-Like-count,.od-Like.is-disabled .od-Like-text{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-Like-heartEmpty,.od-Like-heartFull{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:16px}[dir=ltr] .od-Like-count{margin-left:8px}[dir=rtl] .od-Like-count{margin-right:8px}[dir=ltr] .od-Like-count{margin-right:4px}[dir=rtl] .od-Like-count{margin-left:4px}"}])});define("Ws",["require","exports","ap","Xb","m8"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){return o.complianceRecordFlagValueAsYesNoString(e)};return t}(r.default);t.default=n});define("Wn",["require","exports","Wq","b5","Wp","Wo"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-mobileChoiceEditor",template:e("Wp"),viewModel:i.default,synchronous:!0});t.default=o});define("Wq",["require","exports","ap","aq","bF","Wd","cJ"],function(e,t,i,l,r,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this;t.addBindingHandlers({keyboard:c.default});t.choices=l.observableArray([]);t.field=e.field;t.onComplete=e.onComplete;for(var i=[],r=0,o=t.field.schema.Choices;r<o.length;r++){var n=o[r],a=new d.Choice(n,n);i.push(a)}t.choices(i);return t}e.prototype.onClick=function(e){this.field.data(e.value);this.onComplete()};return e}(r.default);t.default=o});define("Wd",["require","exports","aq"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.getChoicesArray=function(e,t,i,r,o){for(var n,a,s=[],l=[],d=[],c=0,u=i;c<u.length;c++){var p=u[c],m=new w(p,p);s.push(m);if(-1!==r.indexOf(p)){d.push(m);a||(a=m)}}var h=function(e){if(e&&-1===i.indexOf(e)){var t=new w(e,e);-1===l.indexOf(t)&&l.push(t);if(-1!==r.indexOf(e)){d.push(t);a||(a=t)}}};if(t){t=t.split("<br>")[0];var f=document.createElement("DIV");f.innerHTML=t;var g=f.querySelector("#diidFilter"+e);if(null!=g)for(var y=g.childNodes.length,v=g.childNodes,_=1;_<y;_++){h(v[_].value.toString())}}else for(var b=0,x=r;b<x.length;b++){h(x[b])}n=s.concat(l);o.setItems(n,!0);for(var S=0,C=n;S<C.length;S++){var P=C[S];o.registerSelectable(this.getItemKey(P),P)}0<l.length&&s[s.length-1].hasSeparator(!0);for(var k=0,I=d;k<I.length;k++){var T=I[k];o.setItemSelected(T,!0)}return n};e.getItemKey=function(e){return e&&e.value+";#"+e.display||null};return e}();t.ChoiceEditorHelper=r;var w=function(e,t){this.isSelected=i.observable(!1);this.isFocused=i.observable(!1);this.hasSeparator=i.observable(!1);this.value=t;this.display=e;this.onInvoke=function(e){}};t.Choice=w;t.default=r});define("Wp",[],function(){return"<div class=od-MobileChoiceEditor><ul class=\"ms-ContextualMenu is-open\" role=listbox><li class=od-ContextualMenu-item aria-multiselectable=false role=option data-bind=\"foreach: { data: choices, as: 'choice' }\"><a class=od-ContextualMenu-link tabindex=0 data-bind=\"keyboard: { mappings: { Enter: $parent.onClick.bind($parent, choice) }}, click: $parent.onClick.bind($parent, choice), css: { 'is-selected': choice.isSelected, 'is-focused': choice.isFocused, 'has-separator': choice.hasSeparator }, attr: { title: choice.display }\"><span class=od-ContextualMenu-linkText data-bind=\"text: choice.display\"></span></a></li></ul></div>"});define("Wo",["c","az"],function(e,t){e.loadStyles([{rawString:".od-MobileChoiceEditor .ms-ContextualMenu{width:100%;border:0;box-shadow:none;overflow-x:hidden}.od-MobileChoiceEditor .od-ContextualMenu-link{box-sizing:border-box;padding:0 18px;overflow:hidden;text-overflow:ellipsis}"}])});define("Wm",[],function(){return'<label class="od-FieldEditor-fieldTitle ms-Label" data-bind="text: title, attr: { \'for\': invertLabel ? null : inputElementId, \'id\': invertLabel ? inputElementId : null }, css: { \'is-required\' : field.schema.Required, \'od-FieldEditor-fieldTitle--inlineEdit\': !inlineEdit }"></label>\x3c!--ko if: isEdit--\x3e<div data-bind="childFocus: isWriteFocused"><div class=od-FieldEditor-controlContainer data-bind="bindableHtml: controlHtml, css: { \'od-FieldEditor-controlContainer--globalEdit\': !fieldsManager.interactiveSave(), \'od-FieldEditor-controlContainer--inlineSave\': inlineSave, \'is-editing\': isEdit }, keyboard: { mappings: { Enter: inlineSave? saveChanges: null, Esc: onEscBase }, context: $data, allowInputEvents: true, allowButtonEvents: true }"></div>\x3c!--ko ifnot: !fieldsManager.interactiveSave() || inlineSave--\x3e<button class="od-FieldEditor-Check od-Button od-Button--primary" data-bind="event: { click: saveChanges }, attr: {\'aria-label\': saveButtonLabel }"><span class="ms-Icon ms-Icon--CheckMark od-Button-label" data-bind="icon: true"></span></button>\x3c!--/ko--\x3e</div><div class=od-FieldEditor-fieldDescription data-bind="text: description"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: isEdit--\x3e<div><div class=od-FieldEditor-controlContainer--display role=button tabindex=0 data-bind="css: { \'od-FieldEditor-controlContainer--globalEdit\': !fieldsManager.interactiveSave(), \'od-FieldEditor-controlContainer--inlineEdit\': inlineEdit, \'has-Error\': aggregateValidation.hasError, \'od-FieldEditor-controlContainer--notInfoPane\': !fieldsManager.isInfoPane, \'show-InvisibleRegion\': showInvisibleRegion }, attr: { \'aria-label\': getAriaLabel() }, event: { click: onClick }, element: displayElement, hasFocus: isReadFocused, keyboard: { Enter: (!fieldsManager.isReadOnly && inlineEdit) ? editField : null, Space: (!fieldsManager.isReadOnly && inlineEdit) ? editField : null, Down: onDown }, automation: \'fieldContainer\'">\x3c!--ko if: !field.data() && inlineEdit--\x3e<span class=od-FieldEditor-placeHolder data-bind="text: fieldPlaceHolder, css: { \'is-required\' : field.schema.Required && !field.data() }"></span>\x3c!--/ko--\x3e\x3c!--ko if: field.data() || !inlineEdit--\x3e<div class=od-FieldEditor-display data-bind="bindableHtml: renderHtml"></div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if: !fieldsManager.isReadOnly && isReady() && !inlineEdit && !isSaved()--\x3e<button class="od-FieldEditor-Edit od-Button" data-bind="event: { click: editField }, attr: {\'aria-label\': editButtonLabel }"><span class="ms-Icon ms-Icon--Edit" data-bind="icon: true"></span></button>\x3c!--/ko--\x3e<div class=od-FieldEditor-state data-bind="css: {\'is-saving ms-slideDownIn10\': showState(), \'ms-slideUpOut10\': !showState()}">\x3c!--ko if: fieldsManager.interactiveSave--\x3e\x3c!--ko ifnot: isReady--\x3e<div class=od-FieldEditor-loadingSpinner data-bind="component: {name: loadingSpinnerTagName, params: {loadingText: savingStateText}}"></div><span role=alert class=ms-accessible data-bind="text: fieldSavingReadoutValue"></span>\x3c!--/ko--\x3e\x3c!--ko if: isSaved()--\x3e<i class="od-FieldEditor-stateCheck ms-Icon ms-Icon--CheckMark" data-bind="icon: true"></i><span class=od-FieldEditor-stateText data-bind="text: savedStateText"></span>\x3c!--ko if: isReady() && shouldReadFieldSaved()--\x3e<span role=alert class=ms-accessible data-bind="text: fieldSavedReadoutValue"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: aggregateValidation.hasError--\x3e<div class=od-FieldEditor-required data-bind="text: aggregateValidation.errorText()"></div>\x3c!--ko if: isReady--\x3e<span role=alert class=ms-accessible data-bind="text: fieldSaveErrorReadoutValue()"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});define("Wl",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-FieldEditor-fieldTitle.ms-Label{width:100%;font-family:"Segoe UI Semibold WestEuropean","Segoe UI Semibold","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px}.od-FieldEditor-fieldTitle.ms-Label.od-FieldEditor-fieldTitle--inlineEdit{width:calc(100% - 32px)}.od-FieldEditor-fieldDescription{font-size:12px;color:'},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";margin-top:4px}.od-FieldEditor-Edit{background-color:transparent;border-color:transparent;display:inline-block;width:32px;height:32px;min-width:32px;min-height:32px;position:absolute;padding:0;top:6px;right:3px}.od-FieldEditor-Check.od-Button.od-Button--primary{display:inline-block;width:32px;height:32px;min-width:32px;min-height:32px;padding:0}.od-FieldEditor-controlContainer{display:inline-block;width:calc(100% - 32px);vertical-align:top}.od-FieldEditor-controlContainer .od-TextField{position:relative;margin:0}.od-FieldEditor-controlContainer .od-TextField-field{border:0;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";outline:0;font-size:14px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding:6px 12px;min-width:170px;min-height:32px;transition:background-color .2s ease,padding-left .2s ease}[dir=ltr] .od-FieldEditor-controlContainer .od-TextField-field{padding-left:0}[dir=rtl] .od-FieldEditor-controlContainer .od-TextField-field{padding-right:0}.od-FieldEditor-controlContainer .od-TextField-field:focus{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .od-FieldEditor-controlContainer .od-TextField-field:focus{padding-left:12px}[dir=rtl] .od-FieldEditor-controlContainer .od-TextField-field:focus{padding-right:12px}.od-FieldEditor-controlContainer .ms-Dropdown-title{border:0;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";outline:0;font-size:14px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:';padding:6px 0 5px;min-width:170px;min-height:32px;transition:background-color .2s ease,padding-left .2s ease;font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;box-sizing:border-box;position:relative;display:block;margin:0;cursor:pointer;height:32px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[dir=ltr] .od-FieldEditor-controlContainer .ms-Dropdown-title{padding-left:0}[dir=rtl] .od-FieldEditor-controlContainer .ms-Dropdown-title{padding-right:0}[dir=ltr] .od-FieldEditor-controlContainer .ms-Dropdown-title{padding-right:33px}[dir=rtl] .od-FieldEditor-controlContainer .ms-Dropdown-title{padding-left:33px}.od-FieldEditor-controlContainer .ms-Dropdown-title:focus{border-color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-FieldEditor-controlContainer .ms-ContextualMenu{display:none}.od-FieldEditor-controlContainer .ms-ContextualMenu.is-open{width:100%;box-shadow:none;border-top:0;max-height:240px;overflow-y:auto;overflow-x:hidden;display:block}.od-FieldEditor-controlContainer .ms-ContextualMenu.is-open:focus{outline:1px solid transparent}.od-focus--enabled .od-FieldEditor-controlContainer .ms-ContextualMenu.is-open:focus{outline:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-FieldEditor-controlContainer .od-ContextualMenu-item .has-separator{border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-FieldEditor-controlContainer .od-ContextualMenu-item:focus{outline:1px solid transparent}.od-FieldEditor-controlContainer .od-ContextualMenu-link{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;box-sizing:border-box;height:36px;line-height:34px;padding:0 10px}.od-FieldEditor-controlContainer .od-ContextualMenu-link.is-focused,.od-FieldEditor-controlContainer .od-ContextualMenu-link:focus{box-shadow:none;outline:0;border-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FieldEditor-controlContainer .is-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FieldEditor-controlContainer ::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FieldEditor-controlContainer :-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FieldEditor-controlContainer ::-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FieldEditor-controlContainer :-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FieldEditor-controlContainer.is-editing .ms-Dropdown-title,.od-FieldEditor-controlContainer.is-editing .od-TextField-field{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .od-FieldEditor-controlContainer.is-editing .ms-Dropdown-title{padding-left:12px}[dir=rtl] .od-FieldEditor-controlContainer.is-editing .ms-Dropdown-title{padding-right:12px}[dir=ltr] .od-FieldEditor-controlContainer.is-editing .ms-Dropdown-title{padding-right:36px}[dir=rtl] .od-FieldEditor-controlContainer.is-editing .ms-Dropdown-title{padding-left:36px}.od-FieldEditor-controlContainer.od-FieldEditor-controlContainer--globalEdit .od-TextField-field{border-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .od-FieldEditor-controlContainer.od-FieldEditor-controlContainer--globalEdit .od-TextField-field{padding-left:12px}[dir=rtl] .od-FieldEditor-controlContainer.od-FieldEditor-controlContainer--globalEdit .od-TextField-field{padding-right:12px}.od-FieldEditor-controlContainer.od-FieldEditor-controlContainer--globalEdit .od-TextField-field:focus{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer.od-FieldEditor-controlContainer--globalEdit .od-TextField-field{padding-left:0}[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer.od-FieldEditor-controlContainer--globalEdit .od-TextField-field{padding-right:0}[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .ms-Dropdown-title,[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .taxonomyWebTagging{padding-left:0}[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .ms-Dropdown-title,[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .taxonomyWebTagging{padding-right:0}[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer .od-TextField-field:focus{padding-left:0}[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer .od-TextField-field:focus{padding-right:0}.od-FieldEditor-controlContainer.od-FieldEditor-controlContainer--inlineSave{width:100%;position:relative}.od-FieldEditor-controlContainer--display{display:inline-block;width:calc(100% - 42px);min-height:20px;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:';vertical-align:top;margin-right:1px;outline:0;padding:0 0 5px;font-size:14px;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-weight:400}.od-FieldEditor-controlContainer--display:focus{border-bottom:1px solid '},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-FieldEditor-controlContainer--display .od-FieldRender{height:32px}.od-FieldEditor-controlContainer--display .od-FieldRender-display{display:inline-block;height:32px;line-height:32px;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.od-FieldEditor-controlContainer--display .od-FieldRender-display:focus,.od-FieldEditor-controlContainer--display .od-FieldRender-display:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-FieldEditor-controlContainer--display .od-FieldRender-display.is-selected{background-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FieldEditor-controlContainer--display .od-FieldRender-display.od-FieldRender-display--link{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer}.od-FieldEditor-controlContainer--display .od-FieldRender-display.od-FieldRender-display--link:focus,.od-FieldEditor-controlContainer--display .od-FieldRender-display.od-FieldRender-display--link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-FieldEditor-controlContainer--display .od-FieldRender-display.od-FieldRender-display--link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-FieldEditor-controlContainer--display.od-FieldEditor-controlContainer--inlineEdit{background:0 0;cursor:text;width:100%}.od-FieldEditor-controlContainer--display.od-FieldEditor-controlContainer--inlineEdit:hover{border-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-FieldEditor-controlContainer--display.od-FieldEditor-controlContainer--inlineEdit.has-Error{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-FieldEditor-controlContainer--display.od-FieldEditor-controlContainer--inlineEdit.has-Error .od-FieldEditor-placeHolder.is-required{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FieldEditor-controlContainer--display.od-FieldEditor-controlContainer--notInfoPane{background:0 0}.od-FieldEditor-controlContainer--display.show-InvisibleRegion .od-FieldEditor-display{width:calc(100% - 64px);overflow:hidden}.od-FieldEditor-controlContainer--display.od-FieldEditor-controlContainer--inlineEdit,.od-FieldEditor-controlContainer--globalEdit{width:100%!important;margin-right:0!important}.od-FieldEditor-required{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-FieldEditor-placeHolder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:14px;font-weight:400}.od-FieldEditor-placeHolder.is-required{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-FieldEditor-state{margin-top:4px;font-size:12px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";height:0;transition:height .15s ease}[dir=ltr] .od-FieldEditor-state .od-LoadingSpinner-loadingGif{margin-right:4px}[dir=rtl] .od-FieldEditor-state .od-LoadingSpinner-loadingGif{margin-left:4px}.od-FieldEditor-state.is-saving{min-height:18px;height:100%;word-wrap:break-word}.od-FieldEditor-stateCheck{font-size:14px;position:relative;top:2px}[dir=ltr] .od-FieldEditor-stateCheck{margin-right:4px}[dir=rtl] .od-FieldEditor-stateCheck{margin-left:4px}"}])});define("Yr",["require","exports","ap","bF","aq","cI","ON","aZ"],function(e,t,r,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({dismiss:n.default,scrollIntoView:a.default});t.selectionModel=e.selectionModel;t.isOpen=e.isOpen||o.observable(!1);t.clickedItem=e.clickedItem||o.observable(null);t.dismissOnScroll=!1!==e.dismissOnScroll;return t}e.prototype.onClick=function(e,t){this.clickedItem(e);this.close()};e.prototype.close=function(){this.isOpen(!1)};return e}(i.default);t.default=l;var d=function(e,t,i){this.id=s.default.generate();this.key=this.id;this.selected=o.observable(!1);this.focused=o.observable(!1);this.display=e;this.value=t;this.matchString="";this.afterString=this.display;if(i){this.matchString=i;this.afterString=this.display.substring(i.length)}};t.AutoSuggestItem=d});define("Yo",["require","exports","Yr","b5","Yq","Yp"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-auto-suggest-menu",template:e("Yq"),viewModel:i.default,synchronous:!0});t.default=o});define("Yq",[],function(){return"<div class=\"od-AutoSuggestMenu ms-ContextualMenu\" role=menu data-bind=\"dismiss: { isOpen: isOpen, close: close, dismissOnResize: true, dismissOnScroll: $data.dismissOnScroll }, css: { 'is-open': isOpen }\">\x3c!--ko foreach: selectionModel.items--\x3e<div class=od-ContextualMenu-item role=menuitem data-bind=\"scrollIntoView: { isSelected: $data.focused }, attr: { 'aria-label': $data.display, id: $data.id, tabindex: $data.focused() ? '0': '-1' }, hasFocus: $data.focused\"><a class=od-ContextualMenu-link tabindex=-1 data-bind=\"css: { 'is-selected': $data.selected, 'is-focused': $data.focused }, click: $parent.onClick.bind($parent)\"><span class=od-ContextualMenu-linkText><strong data-bind=\"text: $data.matchString\"></strong><span data-bind=\"text: $data.afterString\"></span></span></a></div>\x3c!--/ko--\x3e</div>"});define("Yp",["c","az"],function(e,t){e.loadStyles([{rawString:".od-AutoSuggestMenu.ms-ContextualMenu{width:100%;min-width:170px;box-shadow:none;border-top:0;max-height:240px;overflow-y:auto}.od-AutoSuggestMenu.ms-ContextualMenu:focus{outline:1px solid transparent}.od-focus--enabled .od-AutoSuggestMenu.ms-ContextualMenu:focus{outline:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-AutoSuggestMenu .od-ContextualMenu-item:focus{outline:1px solid transparent}.od-AutoSuggestMenu .od-ContextualMenu-link{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-AutoSuggestMenu .od-ContextualMenu-link.is-focused,.od-AutoSuggestMenu .od-ContextualMenu-link:focus{box-shadow:none;outline:0;border-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});define("Yn",[],function(){return"<div class=od-TextField data-bind=\"keyboard: { mappings: { Enter: onEnter, Esc: onEsc, Up: onUp }, context: $data, allowInputEvents: true }\"><input class=\"od-TextEditor-input od-TextField-field\" type=text autocomplete=off autocapitalize=off autocorrect=off data-bind=\"hasfocus: isSelected, textInput: textInput, selectOnFocus, aria-owns: autoFillComponentId, attr: { id: inputElementId, 'aria-busy': loadingAutoFill(), 'aria-activedescendant': focusedItemId(), 'aria-expanded': isAutoFillOpen().toString(), 'aria-invalid': aggregateValidation.hasError, placeholder: fieldPlaceHolder, maxlength: inputElementMaxLength }, event: { dblclick: onDoubleClick }, keyboard: { mappings: { Down: onDown }, context: $data, allowInputEvents: true }\">\x3c!--ko if:isAutoFillOpen--\x3e<div data-bind=\"id: autoFillComponentId\"><div data-bind=\"selection: { data: autoSuggestItems, mode: 'single', direction: 'vertical', selectionModel: selectionModel, focused: focusedItem, allowInputEvents: true }, component: { name: autoSuggestMenuTagName, params: { selectionModel: selectionModel, isOpen: isAutoFillOpen, clickedItem: clickedSuggestItem } }\"></div></div>\x3c!--/ko--\x3e</div>"});define("Yh",["require","exports","ap","aq","Wk","dZ","Yl","Xc","qY","zk","V","Yk","by","eA","Yj","Yi","L6","zk"],function(r,e,t,o,i,a,s,d,c,u,p,m,h,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var g="ms-rtegenerate-skip",y="ms-rtegenerate-allskip",n=function(n){t.__extends(l,n);function l(e){var t=n.call(this,e)||this;t.controlHtml=r("Yj");t.richText=o.observable(!1);t.richTextFullHtml=o.observable(!1);var i=t.field.schema;t.inlineEdit=!i.AppendOnly;t.richText(i.RichText);t.isSeeingMore=o.observable(!1);t.overflowText=t.createComputed(function(){return t.isSeeingMore()?d.strings.SeeLessText:d.strings.SeeMoreText});t.field.data.peek()||t.field.data("");t.inputText=o.observable(i.AppendOnly?"":t.field.data.peek());if(1===i.RichTextMode&&!t._isDocumentLibrary(e)){t.richTextFullHtml(!0);t.inlineEdit=!1;t.isLoading=o.observable(!0);t.size=o.observable({width:0,height:0});t.iframeElement=o.observable(null);t._urlDataSource=t.fieldsManager.resources.consume(a.url);t._platform=t.resources.consume(h.platformDetection);t.subscribe(t.size,function(e){t._updateRichTextEditorSize(t.iframeElement.peek())})}t.beforeSave=function(){var e=document.getElementById(t.inputElementId);t.richText.peek()&&e?t.field.data(e.innerHTML):t.field.data(t.inputText.peek());return!0};return t}l.prototype.editField=function(e,t){if(this.richTextFullHtml.peek()){var i=this.fieldsManager.item.peek(),r=this.field.schema,o={url:this._urlDataSource.getNewFormRichTextEditorIFrameUrl(r.Name,this.fieldsManager.contentType.cTypeId,i.parentKey),showLoadingLabel:!1,onload:this.iframeOnLoad.bind(this),isLoading:this.isLoading,iframeElement:this.iframeElement,isInFullPage:!0};this._launchRichTextEditorPanel(o);return!1}return n.prototype.editField.call(this,e,t)};l.prototype.iframeOnLoad=function(e){var t=this,i=e.target;if(i&&i.contentWindow){var r=i.contentWindow.document;if(this._updateRichTextEditorSize(i)){var o=this.size.peek().height-l.HEIGHTOFFSET+"px";this._overrideStyleInIframe(r,".ms-rtestate-field","min-height: "+o);this._overrideStyleInIframe(r,"#onetIDListForm","width: 100%");this._overrideStyleInIframe(r,"#onetIDListForm table","width: 100%");this._overrideStyleInIframe(r,".ms-formbody","width: 100%");this._overrideStyleInIframe(r,".ms-formtoolbar","display: none");this._overrideStyleInIframe(r,".ms-formlabel","display: none");i.cancelPopUp=function(){t._panel.state(1)};var n=this.field.schema.Name+"_"+this.field.schema.Id+"_$TextField_inplacerte",a=r.getElementById(n);a&&a.focus();if(this._platform.isIE||this._platform.isEdge){var s=document.createEvent("UIEvents");s.initUIEvent("resize",!0,!1,window,0);window.dispatchEvent(s)}if(a){a.innerHTML=this.field.data.peek();i.ClientFormOverwriteSave=function(){var e=t._removeSkipElementsFromHTML(a);t.field.data(e.innerHTML);t._panel.state(1);t.fieldsManager.interactiveSave.peek()&&t.saveChanges();return!1}}}this.isLoading(!1)}};l.prototype.onOverflowTextClick=function(){this.isSeeingMore(!this.isSeeingMore());return!1};l.prototype.textCssClasses=function(){var e=this.field.data.peek(),t=e.split(/\r|\r\n|\n/),i=this.fieldsManager.isInfoPane?"":"is-outsideInfoPane ";return(e.length>l.MAXLENGTH||4<t.length)&&!this.isSeeingMore()?i+"is-truncated":this.isSeeingMore()?i+"is-extended":void 0};l.prototype.getFieldRenderForClientFormField=function(e){return new s.default(t.__assign({},this.defaultColumnDefinition,{isAutoHyperLink:e.schema.RichText,isAppendOnly:e.schema.AppendOnly,isNote:!e.schema.RichText}),this)};l.prototype._removeSkipElements=function(e){for(;0<e.length;){var t=e[0],i=t.parentNode;i&&i.removeChild(t)}};l.prototype._removeSkipElementsFromHTML=function(e){var t=e.cloneNode(!0),i=t.getElementsByClassName(g),r=t.getElementsByClassName(y);this._removeSkipElements(r);for(var o=0;o<i.length;o++){var n=i[o];n&&this._moveSkipChildren(n)}this._removeSkipElements(i);return t};l.prototype._moveSkipChildren=function(e){for(var t=0<e.childElementCount?[].slice.call(e.children):[],i=0;i<t.length;i++){var r=t[i];if(r&&!this._isSkipElement(r)){var o=this._getNonSkipRoot(r);o&&o.appendChild(r)}}};l.prototype._getNonSkipRoot=function(e){for(var t=e;t.parentElement;){t=t.parentElement;if(!this._isSkipElement(t))return t}};l.prototype._isSkipElement=function(e){var t=e.className;return t&&(-1<t.indexOf(g)||-1<t.indexOf(y))};l.prototype._isDocumentLibrary=function(e){var t=this.resources.consume(f.resourceKey),i=this.unwrapObservable(e.fieldsManager.item);if(i){var r=this.unwrapObservable(t.getFacetedAncestorOrSelf(i,"list"));return r&&r.list.isDocumentLibrary}return!1};l.prototype._launchRichTextEditorPanel=function(e){this.isLoading(!0);var t=this.resources.consume(c.resourceKey);this._panel=t.requestPanel({component:{name:u.default.tagName,params:e},title:p.format(m.strings.editPanelTitle,this.field.schema.Title),hasCommandBar:!0,size:"Large",includePadding:!0,maximizePanelContent:!0,panelContentSize:this.size})};l.prototype._updateRichTextEditorSize=function(e){var t=!1;if(e){var i=e.contentWindow.document;if(0<i.getElementsByClassName("ms-rtestate-write").length){t=!0;var r=i.getElementById("s4-ribbonrow"),o=i.getElementById("s4-workspace");o&&o.style&&(o.style.height=this.size.peek().height-r.clientHeight+"px")}}return t};l.prototype._overrideStyleInIframe=function(e,t,i){for(var r=e.querySelectorAll(t),o=0;o<r.length;o++)r[o].style.cssText=i};l.HEIGHTOFFSET=255;l.WIDTHOFFSET=35;l.MAXLENGTH=255;return l}(i.default);e.default=n});define("Yl",["require","exports","ap","Xb"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){i.__extends(e,t);function e(){return null!==t&&t.apply(this,arguments)||this}e.prototype.renderField=function(e){return'<div class="od-NoteRenderer" data-bind="css: textCssClasses()"><span class="od-NoteRenderer-text">'+t.prototype.renderField.call(this,e)+'</span><span class="od-NoteRenderer-overflow ms-Link" data-bind="click: onOverflowTextClick, clickBubble: false, text: overflowText"></span></div>'};return e}(r.default);t.default=o});define("Yj",[],function(){return'\x3c!--ko ifnot: richText--\x3e<textarea class="od-NoteEditor-input od-TextField-field" data-bind="hasFocus: isSelected, title: field.schema.Name, textInput: inputText, attr: { id: inputElementId, rows: field.schema.NumberOfLines, \'aria-invalid\': aggregateValidation.hasError, placeholder: fieldPlaceHolder }"></textarea>\x3c!--/ko--\x3e\x3c!--ko if: richText()--\x3e<div class="od-NoteEditor-input od-TextField-field" role=textbox tabindex=0 data-bind="hasFocus: isSelected, bindableHtml: field.data, attr: { id: inputElementId, contenteditable: !richTextFullHtml(), \'aria-invalid\': aggregateValidation.hasError }"></div>\x3c!--/ko--\x3e'});define("Yi",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-FieldEditor-controlContainer .od-NoteEditor-input.od-TextField-field{min-height:100px;height:auto}[dir=ltr] .od-FieldEditor-controlContainer .od-NoteEditor-input.od-TextField-field{padding-left:12px}[dir=rtl] .od-FieldEditor-controlContainer .od-NoteEditor-input.od-TextField-field{padding-right:12px}.od-NoteEditor-iframe-loader{position:absolute;top:10%;left:10%;height:80%;width:80%}.od-NoteEditor-iframe-loader .ms-IframeLoader-progress{position:absolute;top:50%;left:50%}.od-NoteRenderer{position:relative}.od-NoteRenderer.is-truncated{height:126px;overflow:hidden}.od-NoteRenderer.is-truncated .od-NoteRenderer-text{position:relative;height:98px;display:inline-block;overflow:hidden}.od-NoteRenderer.is-truncated .od-NoteRenderer-text:after{content:"";position:absolute;bottom:0;right:0;width:100%;height:5em;background:linear-gradient(to bottom,rgba(244,244,244,0),'},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 100%)}.od-NoteRenderer.is-truncated.is-outsideInfoPane .od-NoteRenderer-text:after{background:linear-gradient(to bottom,rgba(255,255,255,0),"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 100%)}.od-NoteRenderer.is-extended .od-NoteRenderer-overflow,.od-NoteRenderer.is-truncated .od-NoteRenderer-overflow{display:block}.od-NoteRenderer.is-extended .od-NoteRenderer-overflow{padding-top:4px}.od-NoteRenderer-overflow{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;display:none;height:24px;line-height:24px}.od-NoteRenderer-overflow:focus,.od-NoteRenderer-overflow:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-NoteRenderer-overflow:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}])});define("Ye",["require","exports","ap","aq","Wk","na","cJ","Xc","V","Yg","Yf"],function(r,e,t,o,i,n,a,s,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.controlHtml=r("Yg");t.offString=n.strings.no;t.onString=n.strings.yes;t.inlineEdit=!0;t.inlineSave=!0;t.invertLabel=!0;t.isOffButtonFocused=o.observable(!1);t.isOnButtonFocused=o.observable(!1);t.checkedValue=o.pureComputed({read:function(){return"1"===this.field.data()},write:function(e){this.field.data(e?"1":"0")},owner:t});t.addBindingHandlers({keyboard:a.default});if(t.fieldsManager.interactiveSave.peek()){t.subscribe(t.isEdit,function(e){t._setFocus()});t.subscribe(t.checkedValue,function(e){t.saveChanges()})}t.beforeSave=function(){""===t.field.data.peek()&&t.field.data("0");return!0};return t}e.prototype.setDefaultValueTyped=function(e){this.field.data(e?"1":"0")};e.prototype.toggleValue=function(){this.checkedValue(!this.checkedValue());this.fieldsManager.interactiveSave.peek()||this._setFocus();return!1};e.prototype.getAriaLabel=function(){var e=this.field.data.peek()||s.strings.EmptyFieldAriaLabel;"1"===e?e=this.onString:"0"===e&&(e=this.offString);var t=this.field.schema.Required?l.format(s.strings.RequiredFieldAriaLabel,this.title):this.title;t=t+", "+e;return t=l.format(s.strings.PressEnterToEditAriaLabel,t)};e.prototype._setFocus=function(){this.checkedValue.peek()?this.isOnButtonFocused(!0):this.isOffButtonFocused(!0)};return e}(i.default);e.default=d});define("Yg",[],function(){return'<div class="od-BooleanEditor od-Toggle"><input type=checkbox role=presentation class=od-Toggle-input data-bind="checked: checkedValue" tabindex=-1> <span class=od-Toggle-field data-bind="keyboard: { mappings: { Left: toggleValue, Right: toggleValue, Space: toggleValue } }, css: {\'is-selected\': checkedValue }"><span class="ms-Label ms-Label--off" role=checkbox data-bind="click: toggleValue, text: offString, hasFocus: isOffButtonFocused, attr: { \'aria-checked\': checkedValue().toString(), \'aria-labelledby\': inputElementId }" tabindex=0></span> <span class="ms-Label ms-Label--on" role=checkbox data-bind="click: toggleValue, text: onString, hasFocus: isOnButtonFocused, attr: { \'aria-checked\': checkedValue().toString(), \'aria-labelledby\': inputElementId }" tabindex=0></span></span></div>'});define("Yf",["c","az"],function(e,t){e.loadStyles([{rawString:".od-BooleanEditor.od-Toggle{margin:0}.od-BooleanEditor.od-Toggle .ms-Label:focus{outline:1px solid transparent}.od-focus--enabled .od-BooleanEditor .ms-Label:focus:before{content:'';position:absolute;top:4px;height:20px;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}[dir=ltr] .od-focus--enabled .od-BooleanEditor .ms-Label:focus:before{left:-2.5px}[dir=rtl] .od-focus--enabled .od-BooleanEditor .ms-Label:focus:before{right:-2.5px}[dir=ltr] .od-focus--enabled .od-BooleanEditor .ms-Label:focus:before{right:5px}[dir=rtl] .od-focus--enabled .od-BooleanEditor .ms-Label:focus:before{left:5px}"}])});define("Yc",["require","exports","ap","aq","Wk","uA","Xc","Yd"],function(r,e,t,o,i,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.controlHtml=r("Yd");t.inlineEdit=!0;t.inlineSave=!0;t.inputNumber=o.observable(t.field.data.peek());t.addBindingHandlers({selectOnFocus:n.default});t.subscribe(t.inputNumber.extend({rateLimit:400}),function(e){t._validateInput()});t.beforeSave=function(){if(t._validateInput()){t.field.data(t.inputNumber.peek());return!0}return!1};return t}e.prototype._validateInput=function(){var e,t=this.inputNumber.peek();if(!/^[\d.,eE-\s'\*\.·٫٬˙]+$/.test(t)&&t){this.clientValidation.hasError(!0);this.clientValidation.errorText(a.strings.InvalidNumberError);e=!1}else{this.clientValidation.hasError(!1);this.clientValidation.errorText("");e=!0}return e};return e}(i.default);e.default=s});define("Yd",[],function(){return'<div class=od-TextField><input class="od-NumberEditor-input od-TextField-field" type=text pattern=[0-9]* data-bind="hasFocus: isSelected, selectOnFocus, textInput: inputNumber, attr: { id: inputElementId, \'aria-invalid\': aggregateValidation.hasError, placeholder: fieldPlaceHolder }"></div>'});define("X8",["require","exports","ap","aq","Wk","Yb","aZ","V","Ya","X9"],function(o,e,t,n,i,a,s,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.controlHtml=o("Ya");t.strings=a.strings;t.altTextInputElementId=s.default.generate();var i=t._parseServerData(t.field.data.peek()||"");t.url=n.observable(i.url);t.altText=n.observable(i.altText);t.inlineEdit=!0;t.inlineSave=!0;t.showInvisibleRegion=!0;t.beforeSave=function(){if(t._validateInput()){t._formatDataForSaving(t.url.peek(),t.altText.peek());return!0}return!1};return t}e.prototype.onDown=function(){var e=this.displayElement.peek().getElementsByTagName("a");if(e&&0<e.length){e[0].focus();return!1}return!0};e.prototype._formatDataForSaving=function(e,t){if(e){var i=e.replace(/\,/g,",,");i+=", ";t&&(i+=t);this.field.data(i)}else this.field.data("")};e.prototype._validateInput=function(){var e;if(this.url.peek().trim().length>this.inputElementMaxLength){this.clientValidation.hasError(!0);this.clientValidation.errorText(l.format(a.strings.MaxLengthUrlError,255));e=!1}else{this.clientValidation.hasError(!1);this.clientValidation.errorText("");e=!0}return e};e.prototype._parseServerData=function(e){var t=e&&e.search?e.search(/[^,],[^,]/):-1,i=e,r="";if(0<=t){i=e.substr(0,t+1).trim();r=e.substr(t+2).trim()}return{url:i=i?i.replace(/\,\,/g,","):"",altText:r}};return e}(i.default);e.default=r});define("Ya",[],function(){return'<div class=od-PictureEditor-container><div class=od-TextField><input class="od-PictureEditor-input od-TextField-field" type=text data-bind="textInput: url, attr: { id: inputElementId, placeholder: strings.url }, hasFocus: isSelected"></div><div class=od-TextField><input class="od-PictureEditor-input od-TextField-field" type=text data-bind="textInput: altText, attr: { id: altTextInputElementId, placeholder: strings.display, maxlength: inputElementMaxLength }"></div></div>'});define("X9",["c","az"],function(e,t){e.loadStyles([{rawString:".od-FieldEditor-controlContainer.is-editing .od-PictureEditor-input.od-TextField-field{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .od-FieldEditor-controlContainer.is-editing .od-PictureEditor-input.od-TextField-field{padding-left:12px}[dir=rtl] .od-FieldEditor-controlContainer.is-editing .od-PictureEditor-input.od-TextField-field{padding-right:12px}.od-FieldEditor-controlContainer--display .od-FieldRender-image{max-width:128px;max-height:128px;margin:0}.od-PictureEditor-container .od-TextField:first-child{margin-bottom:8px}[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .od-PictureEditor-input.od-TextField-field{padding-left:0}[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .od-PictureEditor-input.od-TextField-field{padding-right:0}"}])});define("XT",["require","exports","ap","aq","Wk","V","hb","Xc","X7","X6","XU"],function(n,e,t,a,i,r,s,l){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(o){t.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.controlHtml=n("X7");t.inlineEdit=!0;t.invertLabel=!0;t.showInvisibleRegion=!0;t.leaveFocusToSave=!1;t.hasUnresolvedText=a.observable(!1);t.hasError=a.observable(!1);t.selectedPeople=a.observable([]);t.peoplePickerQueryParams={allowEmailAddresses:!1,allowOnlyEmailAddresses:!1,allowMultipleEntities:t.field.schema.AllowMultipleValues,allUrlZones:!1,groupID:t.field.schema.SharePointGroupID,maximumEntitySuggestions:50,principalSource:t.field.schema.ResolvePrincipalSource,principalType:t._createSPPrincipalType(t.field.schema.PrincipalAccountType),required:t.field.schema.Required};var i=t.field.data.peek();if(i&&i.length){var r="string"==typeof i?JSON.parse(i):i;t.selectedPeople(r.map(function(e){var t=e.EntityData||{};t.DisplayText=e.DisplayText;return{name:t.DisplayText,email:t.Email,userId:t.AccountName,job:t.Title,department:t.Department,sipAddress:t.SIPAddress,rawData:e,isResolved:!0}}))}t._overTheWireOriginal=t._getOverTheWireValue(t.selectedPeople.peek());t.beforeSave=function(){if(t.hasError.peek()||t.hasUnresolvedText.peek())return!1;var e=t._getOverTheWireValue(t.selectedPeople.peek());e!==t._overTheWireOriginal&&t.field.data(e);return!0};return t}e.prototype.getAriaLabel=function(){var e=this.selectedPeople.peek().map(function(e){return e.name}).join(" "),t=this.field.schema.Required?r.format(l.strings.RequiredFieldAriaLabel,this.title):this.title;t+=", "+e;return t=r.format(l.strings.PressEnterToEditAriaLabel,t)};e.prototype._getOverTheWireValue=function(e){var t=[],i="";if(e){for(var r=0,o=e;r<o.length;r++){var n=o[r];if(n.isResolved||n.principalType===s.default.sharePointGroup){var a=n.rawData||n.rawPersonData;if(a){delete a.Claim;delete a.EntityDataElements;a.EntityData&&delete a.EntityData.DisplayText;t.push(a)}}}i=JSON.stringify(t)}return i};e.prototype._createSPPrincipalType=function(e){if(!e)return 0;for(var t=0,i=0,r=e.split(",");i<r.length;i++){var o=r[i];"User"===o?t|=1:"DL"===o?t|=2:"SecGroup"===o?t|=4:"SPGroup"===o&&(t|=8)}return t};return e}(i.default);e.default=o});define("X7",[],function(){return"<div class=od-PeopleEditor data-bind=\"component: {name: 'ms-people-picker', params: { peoplePickerQueryParams: peoplePickerQueryParams, selectedPeople: selectedPeople, autoSelectFirstSuggestionOnEnter: true, isSelected: isSelected, hasUnresolvedText: hasUnresolvedText, hasError: hasError, describedById: inputElementId, useGenericErrors: true }}\"></div>"});define("X6",["c","az"],function(e,t){e.loadStyles([{rawString:".od-FieldEditor-controlContainer{position:relative}.od-FieldEditor-controlContainer .PeoplePicker{border:0;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";outline:0;font-size:14px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding:4px;min-width:170px;min-height:32px;transition:background-color .2s ease,padding-left .2s ease;max-height:88px}[dir=ltr] .od-FieldEditor-controlContainer .PeoplePicker{padding-left:0}[dir=rtl] .od-FieldEditor-controlContainer .PeoplePicker{padding-right:0}.od-FieldEditor-controlContainer .PeoplePicker.is-active{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-FieldEditor-controlContainer .AutoFill{width:100%;min-width:215px}.od-FieldEditor-controlContainer .AutoFill .od-Persona.od-Persona--sm .od-Persona-details{max-width:calc(100% - 60px);padding:0 8px;box-sizing:border-box}.od-FieldEditor-controlContainer .AutoFill .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-right:0}.od-FieldEditor-controlContainer .AutoFill .od-Persona-secondaryText{width:100%}.od-FieldEditor-controlContainer .AutoFill-link,.od-FieldEditor-controlContainer .AutoFill-trimmed{padding:5px}.od-FieldEditor-controlContainer .od-Persona.od-Persona--sm .od-Persona-primaryText{line-height:16px}.od-FieldEditor-controlContainer .PeoplePicker-ghostText{padding:1px 0 1px 12px;font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;width:calc(100% - 12px);overflow:hidden;white-space:nowrap;text-overflow:ellipsis}[dir=ltr] .od-FieldEditor-controlContainer .PeoplePicker-ghostText{left:0}[dir=rtl] .od-FieldEditor-controlContainer .PeoplePicker-ghostText{right:0}.od-FieldEditor-controlContainer .PeoplePicker-textBox{position:relative;top:2px;margin:0;padding:0;font-size:14px}[dir=ltr] .od-FieldEditor-controlContainer .PeoplePicker-textBox{padding-left:10px}[dir=rtl] .od-FieldEditor-controlContainer .PeoplePicker-textBox{padding-right:10px}.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem+.PeoplePicker-textBox{line-height:32px}[dir=ltr] .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem+.PeoplePicker-textBox{padding-left:3px}[dir=rtl] .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem+.PeoplePicker-textBox{padding-right:3px}.od-FieldEditor-controlContainer .PeoplePicker .od-Persona,.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem,.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem-name{height:32px;line-height:32px}.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem{border:0;width:auto}[dir=ltr] .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem{margin-right:8px}[dir=rtl] .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem{margin-left:8px}.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-image,.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-imageArea,.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-imageCircle{width:24px;height:24px}.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-image{line-height:24px;position:absolute;padding-top:0}[dir=ltr] .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-image{left:0}[dir=rtl] .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-image{right:0}.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-imageArea{margin:4px 4px 0}[dir=ltr] .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-right:8px}[dir=rtl] .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-left:8px}.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-details{max-width:120px}.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-primaryText{padding-top:8px;padding-bottom:0;width:auto}.od-FieldEditor-controlContainer .PeoplePicker-removeItem:active,.od-FieldEditor-controlContainer .PeoplePicker-removeItem:hover,.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem-name:active,.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem-name:hover{background-color:'},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-FieldEditor-controlContainer .PeoplePicker-resolvedItem-persona{max-width:160px}.od-FieldEditor-controlContainer .PeoplePicker-removeItem{line-height:32px;height:32px;width:32px;font-size:14px;text-align:center;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}.od-FieldEditor-controlContainer.is-editing .PeoplePicker{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-FieldEditor-controlContainer.is-editing .PeoplePicker{padding-left:4px}[dir=rtl] .od-FieldEditor-controlContainer.is-editing .PeoplePicker{padding-right:4px}.od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .PeoplePicker{padding:4px 0 0 0}[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .PeoplePicker{padding-left:0}[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .PeoplePicker{padding-right:0}[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer .PeoplePicker-ghostText,[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer .PeoplePicker-textBox{padding-left:0}[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer .PeoplePicker-ghostText,[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer .PeoplePicker-textBox{padding-right:0}[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem{margin-left:0}[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem{margin-right:0}.od-ListItemFormRoot .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem .od-Persona.od-Persona--xs .od-Persona-primaryText{padding-top:0}[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem+.PeoplePicker-textBox{padding-left:3px}[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer .PeoplePicker-resolvedItem+.PeoplePicker-textBox{padding-right:3px}.od-FieldEditor-controlContainer.od-FieldEditor-controlContainer--globalEdit .PeoplePicker{border-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-FieldEditor-controlContainer.od-FieldEditor-controlContainer--globalEdit .PeoplePicker.is-active{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}])});define("XU",["require","exports","aq","XY","XX","XW","XV","OC"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={tagName:"ms-people-picker",template:e("XW"),viewModel:o.createViewModelHelper(r.default)};i.components.isRegistered(n.tagName)||i.components.register(n.tagName,n);t.default=n});define("XY",["require","exports","ap","cE","iE","V","X0","XZ","bX","DM","cJ","p7","XU","Bl","d0","cU","ON","dz","dB","bF","ba","bb"],function(e,t,i,n,a,r,s,l,d,c,u,p,m,h,f,g,y,v,_,o,b,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=function(o){i.__extends(e,o);function e(r){var i=o.call(this)||this;i.resolvedItems=i.observables.createArray([]);i.inputTitle=i.createObservable(h.strings.InputHint);i.inputText=i.createObservable("");i.error=i.createObservable("");i.peoplePickerTagName=m.default.tagName;i.autoFillPopupTagName=s.default.tagName;i.progressSpinnerFlatTagName=f.default.tagName;i.autoFillParams={clickedItem:i.createObservable(null),items:i.observables.createArray([]),inDataFetch:i.createObservable(!1),resultsTrimmed:i.createObservable(!1),isOpen:i.createObservable(!1)};i._engagement=i.resources.consume(n.resourceKey);i.selectionModel=new _.default;i.addBindingHandlers({selection:v.default,keyboard:u.default,tooltip:p.default,scrollContainer:g.default,scrollIntoView:y.default});i.focusedItem=i.createObservable(null);i.scrollDown=i.createObservable(!1);i.inputChange=function(e,t){i._inputChangeOuter(t)};i.selectedDescendantId=i.createComputed(function(){if(i.focusedItem())return i.focusedItem().id});i._pageContext=i.resources.consume(a.pageContext.optional);i._autoSelectFirstSuggestionOnEnter=r.autoSelectFirstSuggestionOnEnter;var e=r.peoplePickerQueryParams,t=void 0===e?{allowEmailAddresses:!0,allowMultipleEntities:null,allUrlZones:null,enabledClaimProviders:null,forceClaims:null,groupID:null,maximumEntitySuggestions:5,principalSource:null,principalType:13,required:null,urlZone:null,urlZoneSpecified:null}:e;i._peoplePickerQueryParams=i.wrapObservable(t);i._currentSharingLink=r.currentSharingLink||i.observables.create(null);i._lastSharingLink=i._currentSharingLink();i.blockViaPolicy=i.createPureComputed(i._computeBlockViaPolicy);i._dataProvider=i.resources.consume(c.resourceKey);i._useGenericErrors=r.useGenericErrors;i.describedById=r.describedById;r.hasUnresolvedText||(r.hasUnresolvedText=i.createObservable(!1));r.hasError||(r.hasError=i.createObservable(!1));i.subscribe(i.error,function(e){r.hasError(!!e)});i._contactInviteLimit=r.contactInviteLimit;i.resolvedSize=i.createObservable(2);if(r.selectedPeople){if(0<r.selectedPeople().length){i.resolvedItems(r.selectedPeople());i._reresolveUsers()}i.createComputed(function(){r.selectedPeople(i.resolvedItems())})}r.selectedPeopleContainsExternal&&i.createComputed(function(){if(0===r.selectedPeople().length)r.selectedPeopleContainsExternal(!1);else{for(var e=r.selectedPeople.peek(),t=!1,i=0;i<e.length;i++){if(e[i].isExternal){t=!0;break}}r.selectedPeopleContainsExternal(t)}});i.deleteTitle=i.createComputed(function(){return h.strings.RemoveHelp});i._inputBoxWasEmpty=!0;i.itemClicked=i.createComputed(function(){i.autoFillParams.clickedItem()&&i._onAutoFillPicked()});i.showPlaceholder=i.createObservable(!0);i.inputPlaceholder=i.createComputed(function(){return i.inputText()&&""!==i.inputText()||0!==i.resolvedItems().length?"":h.strings.InputPlaceholderText});i.menuOpenText=i.createComputed(function(){return i.autoFillParams.isOpen()?h.strings.SuggestionTip:""});i.personAddedText=i.createObservable("");i.inputSize=i.createComputed(function(){r.hasUnresolvedText(!!i.inputText()&&0!==i.inputText().length);return i.inputText()?i.inputText().length+1:0});i.peopleSuggestions=i.observables.createArray([]);i.peopleSuggestionsTrimmed=i.createComputed(function(){return i.peopleSuggestions().slice(0,i._peoplePickerQueryParams().maximumEntitySuggestions+i._dataProvider.MaxCacheSuggestions)});i.autoFillOpen=i.createComputed(function(){return i.autoFillParams.isOpen()});i.isSelected=r.isSelected||i.createObservable(!0);i._noMatchesError=h.strings.NoMatchesFound;i._multipleMatchesError=h.strings.MultipleMatchesFound;i._noExternalSharingError=i.createComputed(i._computeExternalSharingError);i._userBlockedOnODBError=h.strings.UserBlockedOnODB;i._resolveOccurring=!1;i.resources.expose(d.autoFillParams,i.autoFillParams);i.isProgressBarShown=i.autoFillParams.inDataFetch;i.createComputed(function(){if(i._currentSharingLink()!==i._lastSharingLink){i._lastSharingLink=i._currentSharingLink.peek();i._reresolveUsers()}});return i}e.prototype.resolveUsers=function(e,t){this._resolveInput();t.preventDefault()};e.prototype.formatRemoveString=function(e){return r.format(this.deleteTitle(),e.name)};e.prototype.removeItem=function(e){this._engagement.logData({name:"RemoveUser.PeoplePicker.Click",isIntentional:!0});this.resolvedItems.remove(e);this.isSelected(!0);this._cleanErrors()};e.prototype.personaClick=function(e){var t=this._engagement;if(e.isResolved)t.logData({name:"ResolvedUser.PeoplePicker.Click",isIntentional:!0});else if(e.multipleMatches&&0<e.multipleMatches.length){t.logData({name:"UnresolvedUser.Multiple.PeoplePicker.Click",isIntentional:!0});this._resolveOccurring=!0;this._personBeingResolved=e;this._processPeopleSuggestions(e.multipleMatches,[],!0)}else{t.logData({name:"UnresolvedUser.Invalid.PeoplePicker.Click",isIntentional:!0});this.inputText(e.name);this.removeItem(e)}};e.prototype.focus=function(){this.isSelected(!0);var e=this.inputText();e&&1<e.length&&!this.autoFillParams.isOpen()&&this.autoFillParams.isOpen(!0);this.showPlaceholder()&&this.inputText&&0<e.length&&this.showPlaceholder(!1)};e.prototype.inputFocus=function(){this.showPlaceholder()&&0<this.inputText().length&&this.showPlaceholder(!1)};e.prototype.inputBlur=function(){var e=this.inputText.peek();if(this.showPlaceholder()||0!==this.resolvedItems().length||e&&0!==e.length){if(e&&1<e.length&&(!this.autoFillOpen.peek()||this.autoFillParams.items.peek().length<1)){this._abortSearch(!0);this._destroyAutoFill();this._resolveUser(e,!0)}else if(e&&1<e.length&&(!this.autoFillOpen.peek()||1===this.autoFillParams.items.peek().length)&&this._isValidEmail(e)){this._abortSearch(!0);this._destroyAutoFill();this._resolveUser(e,!0)}}else this.showPlaceholder(!0)};e.prototype.inputPaste=function(e,t){this._engagement.logData({name:"InputPaste.PeoplePicker",isIntentional:!0});this.async.setTimeout(function(){var e=document.getElementById("PeoplePicker-textBox");this._resolveOccurring=!0;this._resolveUser(e.value,!0);e.value=""},0);return!0};e.prototype.onEnter=function(e,t){var i=this.selectionModel.selection.peek();if(i&&1===i.length)this.autoFillParams.clickedItem(i[0]);else if(this._autoSelectFirstSuggestionOnEnter){var r=this.peopleSuggestions.peek();r&&0<r.length&&this.autoFillParams.clickedItem(r[0])}return!1};e.prototype.getTitle=function(e){return e.isResolved?e.providerName?e.email+"\n"+e.providerName:e.email:e.multipleMatches&&0<e.multipleMatches.length?this._multipleMatchesError:this._isValidEmail(e.userId)&&!this._useGenericErrors?this._noExternalSharingError.peek():this._noMatchesError};e.prototype._computeBlockViaPolicy=function(){return this._peoplePickerQueryParams().blockViaPolicy&&b.isFeatureEnabled(b.PolicyTipPanel)};e.prototype._parseUserKeyPaste=function(e){var t=e.indexOf("<"),i=e.indexOf("@",t),r=e.indexOf(">",i);return-1!==t&&-1!==i&&-1!==r?e.substring(t+1,r):e};e.prototype._replacePerson=function(e){this.resolvedItems.replace(this._personBeingResolved,e);this.isSelected(!0);this._cleanErrors()};e.prototype._cleanErrors=function(){for(var e=this.resolvedItems&&this.resolvedItems().length-1;0<=e;e--){var t=this.resolvedItems()[e];if(!t.isResolved){t.multipleMatches&&0<t.multipleMatches.length?this._setError(this._multipleMatchesError):this._isValidEmail(t.userId)&&!this._useGenericErrors?this._setError(this._noExternalSharingError.peek()):this._setError(this._noMatchesError);if(!x.default.isActivated("9b587ad5-6161-4bc7-ab29-066666d06bd3","03/20/2018","Check if user is not resolved due to tenant admin ODB policy")){var i=t.rawPersonData;i&&i.EntityData&&i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()&&this._setError(this._userBlockedOnODBError)}return}}this.error("")};e.prototype._inputChangeOuter=function(e){var t=this;this._timer&&this.async.clearTimeout(this._timer);this._timer=this.async.setTimeout(function(){t._inputChange(e);t._timer=null},130)};e.prototype._add=function(e){var t=this;if(this.resolvedItems().length>=this._contactInviteLimit)this._setError(r.format(h.strings.contactLimitReached,this._contactInviteLimit));else{e.name||(e.name=e.email);e.isExternal=e.entityType&&1===e.entityType;if(null!=this._peoplePickerQueryParams.peek().allowMultipleEntities&&!1===this._peoplePickerQueryParams.peek().allowMultipleEntities&&1<=this.resolvedItems().length){this.resolvedItems([e]);e.isResolved&&this._cleanErrors()}else{this.resolvedItems.push(e);if(e.isResolved){this.personAddedText(r.format(h.strings.AddedPersonHint,e.name));this.async.setTimeout(function(){t.personAddedText("")},100)}}this.async.setTimeout(function(){this.scrollDown(!0);this.scrollDown(!1)},0)}};e.prototype._inputChange=function(e){var t=e.keyCode;if(38!==t&&40!==t)if(27===t&&this.autoFillParams.isOpen()){this.autoFillParams.isOpen(!1);e.cancelBubble=!0;e.stopPropagation()}else{var i=this.inputText().length;if(0===i){if(!this._resolveOccurring){this._abortSearch(!0);this._destroyAutoFill()}if((8===t||46===t)&&this._inputBoxWasEmpty){this.resolvedItems.pop();this._cleanErrors();this._destroyAutoFill()}this._inputBoxWasEmpty=!0}else if(1===i){this._abortSearch(!0);this._destroyAutoFill();this._inputBoxWasEmpty=!1}else if(59===t||186===t){this._abortSearch(!0);this._destroyAutoFill();this._resolveInput()}else{this._inputBoxWasEmpty=!1;this._getPeopleSuggestions()}}};e.prototype._resolveInput=function(){this._resolveUser(this.inputText())};e.prototype._abortSearch=function(e){if(this.autoFillParams.inDataFetch.peek()){this._peoplePickerSearchPromise&&this._peoplePickerSearchPromise.cancel();e&&this.autoFillParams.inDataFetch(!1)}};e.prototype._getPeopleSuggestions=function(){var t=this;this._abortSearch(!1);this.autoFillParams.inDataFetch(!0);this._cleanErrors();var i=[],e=this._dataProvider.search(this.inputText.peek().trim(),this._peoplePickerQueryParams.peek());e.cached&&this._processPeopleSuggestions(e.cached,i,!1);this._peoplePickerSearchPromise=e.promise;this.isSearchDone=this._peoplePickerSearchPromise.then(function(e){if(t.autoFillParams.inDataFetch.peek()){t.autoFillParams.inDataFetch(!1);t._processPeopleSuggestions(e,i,!0)}},function(e){t.autoFillParams.inDataFetch(!1);if(!e||"Canceled"!==e.name){t._setError(h.strings.ServerError);t._destroyAutoFill()}})};e.prototype._processPeopleSuggestions=function(e,t,i){if(e&&0<e.length)for(var r=e,o=0;o<r.length;o++)t.push(new l.default(r[o],{hasSeparator:o===r.length-1}));(0<t.length||i)&&this._populateAutoFill(t)};e.prototype._reresolveUsers=function(){var e=[],t=this.resolvedItems.peek();if(0!==t.length){for(var i=0;i<t.length;i++){var r=t[i];e.push(r.email||r.name)}var o=e.join(";");this.resolvedItems([]);this._cleanErrors();this._resolveUser(o,!0)}};e.prototype._resolveUser=function(e,t){var i=this,r=e.split(";"),o=r[r.length-1];this.autoFillParams.inDataFetch(!0);for(var n=0;n<r.length;n++){var a=this._parseUserKeyPaste(r[n]);""===a||a===o&&!t||(this.isResolveDone=this._dataProvider.resolve(a,this._peoplePickerQueryParams.peek()).then(function(e){i.autoFillParams.inDataFetch(!1);i._inputBoxWasEmpty=!0;i._destroyAutoFill();i._add(e);e.isResolved||i._cleanErrors()},function(e){i.autoFillParams.inDataFetch(!1);i._setError(h.strings.ServerError)}))}t?this.inputText(""):this.inputText(o)};e.prototype._onAutoFillPicked=function(){this._abortSearch(!0);var e=this.autoFillParams.clickedItem().data();if(this._resolveOccurring){if(this._personBeingResolved){this._replacePerson(e);this._resolveOccurring=!1}}else{this.inputText("");this._inputBoxWasEmpty=!0;if(e.multipleMatches&&0<e.multipleMatches.length&&e.isResolved)for(var t=0,i=e.multipleMatches;t<i.length;t++){var r=i[t];this._add(r)}else{e.isResolved=!0;this._add(e)}}this._destroyAutoFill();this._dataProvider.addToMruCache(e);this.autoFillParams.clickedItem(null);this.peopleSuggestions([]);this.autoFillParams.items([]);this.focus()};e.prototype._destroyAutoFill=function(){this._resolveOccurring=!1;this.autoFillParams.items([]);this.autoFillParams.isOpen(!1);this.peopleSuggestions([])};e.prototype._populateAutoFill=function(e){this.autoFillParams.isOpen()||this.autoFillParams.isOpen(!0);this.peopleSuggestions(e);this.autoFillParams.items(this.peopleSuggestionsTrimmed());this.autoFillParams.resultsTrimmed(this.peopleSuggestionsTrimmed().length>=this._peoplePickerQueryParams.peek().maximumEntitySuggestions)};e.prototype._setError=function(e){var t=this;this.async.setTimeout(function(){t.error(e)},50)};e.prototype._computeExternalSharingError=function(){var e=this._currentSharingLink();return this._pageContext&&!this._pageContext.isSPO?h.strings.NoExternalSharingOnPrem:e&&9===e.type?h.strings.NoExternalSharingCsl:h.strings.NoExternalSharingCloud};e.prototype._isValidEmail=function(e){return/\S+@\S+\.\S+/.test(e)};return e}(o.default);t.default=S});define("X0",["require","exports","X3","b5","X2","X1","Os"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-auto-fill",template:e("X2"),viewModel:i.default});t.default=o});define("X3",["require","exports","ap","bF","bX","aq","X5","cE","V","cI","ON","cU","X4"],function(e,t,i,r,o,n,a,s,l,d,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){i.__extends(e,t);function e(){var e=t.call(this)||this;e.addBindingHandlers({dismiss:d.default,scrollContainer:u.default,scrollIntoView:c.default,uniqueId:p.default});e.params=e.resources.consume(o.autoFillParams);e.menuLabel=a.strings.SuggestedPeopleMenu;e._isOpenObservable=e.params.isOpen||n.observable(!1);if(!e.params){e.params.clickedItem=n.observable(null);e.params.items=n.observableArray([]);e.params.inDataFetch=n.observable(!1);e.params.resultsTrimmed=n.observable(!1)}e.summaryText=e.createComputed(function(){return e.params.resultsTrimmed()?l.format(a.strings.ResultsCapped,e.params.items().length):0===e.params.items().length?a.strings.NoResults:""});e.isOpen=e.createComputed(function(){return e._isOpenObservable()});e.summaryVisible=e.createComputed(function(){return 0<e.summaryText().length});return e}e.prototype.onItemClicked=function(e){this.resources.consume(s.resourceKey).logData({name:"SuggestedUser.AutoFill.PeoplePicker.Click",isIntentional:!0});this.params.clickedItem(e)};e.prototype.closeMenu=function(){this._isOpenObservable(!1)};return e}(r.default);t.default=m});define("X4",["require","exports","aq"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function o(){}o.init=function(e,t){var i=n.utils.unwrapObservable(t());if(i.data){var r=i.idPrefix+ ++o.counter;i.data.id=r;e.id=r}};o.counter=0;return o}();t.default=i});define("X2",[],function(){return"<div class=AutoFill role=menu data-bind=\"scrollContainer: {}, attr: {'aria-label': menuLabel }, dismiss: isOpen() && closeMenu\">\x3c!--ko foreach: params.items--\x3e<div class=AutoFill-item role=menuitem data-bind=\"uniqueId: {data: $data, idPrefix: 'AFPU'}, click: $parent.onItemClicked.bind($parent), css: {'AutoFill-focused': $data.focused, 'AutoFill-separator': $data.hasSeparator }, scrollIntoView: { isSelected: $data.focused}\"><a class=AutoFill-link href=javascript:><div data-bind=\"component: { name: 'od-persona', params: { person: data(), size: 'small'} }\"></div></a></div>\x3c!--/ko--\x3e\x3c!--ko if:summaryVisible--\x3e<div class=AutoFill-trimmed data-bind=\"text: summaryText\"></div>\x3c!--/ko--\x3e</div>"});define("X1",["c","az"],function(e,t){e.loadStyles([{rawString:".AutoFill{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";overflow-y:auto;position:absolute;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";max-height:300px;min-width:300px;max-width:400px;z-index:401}.AutoFill-item{box-sizing:border-box;overflow:hidden;width:100%;line-height:0}.AutoFill-item.AutoFill-focused{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:";outline:1px solid transparent}.AutoFill-item:not(.AutoFill-focused):hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.AutoFill-item.AutoFill-separator{border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:'}.AutoFill-link{text-decoration:none;display:inline-block;width:100%}.AutoFill-link,.AutoFill-trimmed{padding:5px 5px 5px 20px;font-size:14px;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif}html[dir=rtl] .AutoFill-link,html[dir=rtl] .AutoFill-trimmed{padding:5px 20px 5px 5px}'}])});define("XZ",["require","exports","aq"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){this.selected=i.observable(!1);this.focused=i.observable(!1);this.hasSeparator=i.observable(!1);this.data=i.observable();t&&i.utils.extend(this,t);this.data(e);this.id=""};t.default=r});define("XX",["require","exports","aq","bI"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(n){return function(i,e){var r=new(i.resources.injected(n))(i),t=a.computed(function(){if(i.model){var e=a.utils.unwrapObservable(i.model);for(var t in e)e.hasOwnProperty(t)&&r[t]&&(a.isObservable(r[t])?r[t](a.utils.unwrapObservable(e[t])):r[t]=a.utils.unwrapObservable(e[t]))}},r),o=r.dispose;r.dispose=function(){o&&o.call(r);t.dispose()};return r}}t.createViewModelFactory=i;t.createViewModelHelper=function(e){return{createViewModel:i(e)}}});define("XW",[],function(){return'<div class=PeoplePicker id=PeoplePicker data-bind="scrollContainer: {}, click: function() {focus()}, tooltip: { content: inputTitle }, css: {\'is-active\': isSelected}"><div class=PeoplePicker-container>\x3c!--ko foreach: resolvedItems--\x3e<div class=PeoplePicker-resolvedItem data-bind="css: { \'PeoplePicker-resolvedItem-unresolved\': !$data.isResolved || ($parent.blockViaPolicy && $parent.blockViaPolicy() && $data.isExternal) }"><a class=PeoplePicker-resolvedItem-name href=javascript; data-bind="attr: { \'aria-describedby\': $parent.describedById }, tooltip: { content: $parent.getTitle($data) }, click: $parent.personaClick.bind($parent), keyboard: { Enter: $parent.personaClick.bind($parent) }"><div class=PeoplePicker-resolvedItem-persona data-bind="component: { name: \'od-persona\', params: { person: $data, personaSize: $parent.resolvedSize } }"></div></a> <button class=PeoplePicker-removeItem data-bind="tooltip: { content: $parent.formatRemoveString($data) }, attr: { \'aria-label\': $parent.formatRemoveString($data) }, click: $parent.removeItem.bind($parent), keyboard: { Enter: $parent.removeItem.bind($parent)}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e<input class="PeoplePicker-textBox od-TextField-field" id=PeoplePicker-textBox type=email autocomplete=off autocapitalize=off autocorrect=off aria-haspopup=true aria-owns=PeoplePicker-autoFill data-bind="value: inputText, valueUpdate: \'keyup\', attr:{ \'aria-busy\': autoFillParams.inDataFetch(), size: inputSize, \'aria-activedescendant\': selectedDescendantId(), \'aria-expanded\': autoFillOpen().toString(), \'aria-describedby\': describedById, placeholder: inputPlaceholder }, event:{keyup: inputChange, focus: inputFocus, blur: inputBlur, paste: inputPaste}, hasFocus: isSelected, selection: { data: peopleSuggestionsTrimmed, focused: focusedItem, mode: \'single\', direction: \'vertical\', selectionModel: selectionModel, allowInputEvents: true }, keyboard: { mappings: { Enter: onEnter, \'CtrlK\': resolveUsers }, context: $data, allowInputEvents: true }"> <span class=ms-accessible role=status aria-live=polite data-bind="text: menuOpenText"></span> <span class=ms-accessible role=status aria-live=polite data-bind="text: personAddedText"></span></div><div class=PeoplePicker-progressBoxContainer data-bind="scrollIntoView: { isSelected: scrollDown }"><div class=PeoplePicker-progressBox data-bind="component: {name: progressSpinnerFlatTagName}, visible: autoFillParams.inDataFetch()"></div></div></div>\x3c!--ko if:autoFillOpen()--\x3e<div id=PeoplePicker-autoFill data-bind="component: {name: autoFillPopupTagName }"></div>\x3c!--/ko--\x3e<div aria-live=assertive role=status class=PeoplePicker-error data-bind="text: error"></div>'});define("XV",["c","az"],function(e,t){e.loadStyles([{rawString:".PeoplePicker{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:100%;box-sizing:border-box;overflow-y:auto;overflow-x:hidden;max-height:78px;position:relative}.PeoplePicker .od-Persona.od-Persona--xs{height:24px}.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-details{width:auto;margin-top:2px;height:24px;margin-top:0}.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-image,.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-imageArea,.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-imageCircle{width:20px;height:20px}.PeoplePicker .od-Persona.od-Persona--xs .od-Persona-primaryText{padding-top:0;line-height:24px;max-width:250px}.PeoplePicker-container{display:inline-block;width:100%}.PeoplePicker-ghostText{position:absolute;top:5px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";white-space:nowrap}[dir=ltr] .PeoplePicker-ghostText{left:5px}[dir=rtl] .PeoplePicker-ghostText{right:5px}.PeoplePicker-progressBoxContainer{width:100%}.PeoplePicker-progressBoxContainer .PeoplePicker-progressBox{margin-top:-6px}.PeoplePicker-resolvedItem{margin:2px;white-space:nowrap;display:inline-block;font-size:12px;background-color:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:";border:1px solid "},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:";height:24px}html[dir=ltr] .PeoplePicker-resolvedItem{float:left}html[dir=rtl] .PeoplePicker-resolvedItem{float:right}.PeoplePicker-resolvedItem.PeoplePicker-resolvedItem-unresolved{background-color:transparent;border-color:#e81123}.PeoplePicker-resolvedItem.PeoplePicker-resolvedItem-unresolved .PeoplePicker-removeItem:hover,.PeoplePicker-resolvedItem.PeoplePicker-resolvedItem-unresolved .PeoplePicker-resolvedItem-name:hover{background-color:#fde7e9}.PeoplePicker-resolvedItem .od-Persona .od-Persona-image{line-height:20px;font-size:14px}.PeoplePicker-resolvedItem-name{display:inline-block;overflow:hidden;height:24px}.PeoplePicker-resolvedItem-name:hover{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}.PeoplePicker-resolvedItem-persona{display:inline-block}.sm .PeoplePicker-resolvedItem-persona .od-Persona-details{max-width:85px}.PeoplePicker-resolvedItem-image{max-height:20px;max-width:20px;display:inline-block;vertical-align:top}[dir=ltr] .PeoplePicker-resolvedItem-image{padding-right:5px}[dir=rtl] .PeoplePicker-resolvedItem-image{padding-left:5px}.PeoplePicker-resolvedItem-txt{display:inline-block}.PeoplePicker-textBox.od-TextField-field{border:0 solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";width:100%}.PeoplePicker-textBox{vertical-align:inherit;background-color:transparent;vertical-align:top;outline:0}html[dir=ltr] .PeoplePicker-textBox{float:left}html[dir=rtl] .PeoplePicker-textBox{float:right}.PeoplePicker-textBox::-ms-clear{display:none}.PeoplePicker-textBox:focus{outline-color:transparent}.PeoplePicker-removeItem{width:24px;font-size:10px;vertical-align:top;line-height:24px;height:24px;background:0 0;border:none}.PeoplePicker-removeItem:hover{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}.PeoplePicker-error{color:#a80000}"}])});define("XR",["require","exports","ap","XS","XL","Wd","Xc","V","Wc","Wb"],function(e,t,i,g,r,y,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){i.__extends(e,t);function e(e){var l=t.call(this,e)||this;l.supportsMobilePanelEdit=!1;l.showInvisibleRegion=!0;l.beforeSave=function(){l.isOpen(!1);var e=l.selectionModel.selection.peek();if(l.isMultiChoice){for(var t="",i=!1,r=l._getSelectedValuesArray(l.field.serverData),o=0,n=e;o<n.length;o++){var a=n[o];t+=";#";t+=a.value+";#_";i||-1!==r.indexOf(a.value.toString())||(i=!0)}t+=t?";#":"";e.length!==r.length||i?l.field.data(t):l.field.data(l.field.serverData)}else if(e&&0<e.length){var s=l.convertFormStringToArray(l.field.serverData);s&&0<s.length&&s[0]===e[0].value.toString()?l.field.data(l.field.serverData):l.field.data(e[0].value.toString())}return!0};return l}e.prototype.getAriaLabel=function(){var e=this.field.data.peek()||n.strings.EmptyFieldAriaLabel,t=this.convertFormStringToArray(e),i=[];if(t&&t.length)for(var r=0;r<t.length;r++)r%2&&i.push(t[r]);var o=this.field.schema.Required?a.format(n.strings.RequiredFieldAriaLabel,this.title):this.title;o=o+", "+i.toString();return o=a.format(n.strings.PressEnterToEditAriaLabel,o)};e.prototype.populateChoiceArray=function(e){this.dataPopulated=!0;var t=e.field.schema;this.displayFieldName=e.fieldNameForDisplayRead||"";this.valueFieldName=e.fieldNameForValueRead||"";this.isMultiChoice="lookupmulti"===t.FieldType.toLowerCase();if(!t.MaxQueryResult&&t.Choices){var i=this._getSelectedValuesArray(this.field.data.peek()),r=t.Choices,o=[],n=[];if(!this.isMultiChoice){var a=new y.Choice(g.strings.none,"");o.push(a);0===i.length&&n.push(a)}for(var s=0,l=r;s<l.length;s++){var d=l[s],c=new y.Choice(d[this.displayFieldName],d[this.valueFieldName]);o.push(c);this.choiceHash[c.value]=c;this.addToCharChoicesHash(c);-1!==i.indexOf(d[this.valueFieldName].toString())&&n.push(c)}this.choices(o);this.selectionModel.setItems(o,!0);for(var u=0,p=o;u<p.length;u++){c=p[u];this.selectionModel.registerSelectable(y.ChoiceEditorHelper.getItemKey(c),c)}for(var m=0,h=n;m<h.length;m++){var f=h[m];this.selectionModel.setItemSelected(f,!0)}}};e.prototype._getSelectedValuesArray=function(e){var t=this.convertFormStringToArray(e),i=[];if(t&&t.length)for(var r=0;r<t.length;r++)r/2===Math.floor(r/2)&&i.push(t[r]);return i};return e}(r.default);t.default=o});define("XL",["require","exports","ap","aq","Wk","Wi","jJ","Wd","Pp","bX","cJ","Wj","aC","cU","ON","Xc","V","cl","Wc","Wb"],function(n,e,t,a,i,s,l,d,c,u,p,m,o,h,f,g,y,v){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(r){t.__extends(e,r);function e(t){var o=r.call(this,t)||this;o.controlHtml=n("Wc");o._clientFormDataSource=o.resources.consume(c.resourceKey);var e=o.field.schema;o._currentView=o.resources.isExposed(u.currentView)?o.resources.consume(u.currentView):a.observable(null);o.dataPopulated=!1;o.isMultiChoice="multichoice"===e.FieldType.toLowerCase()||"lookupmulti"===e.FieldType.toLowerCase();o._schemaChoiceValues=o.isMultiChoice?e.MultiChoices:e.Choices;o.selectionModel=new l.default({getItemKey:d.ChoiceEditorHelper.getItemKey,mode:o.isMultiChoice?0:1});o.allowFillIn=e.FillInChoice;o.choices=a.observableArray([]);o.selectionModel.setItems([],!0);o.layout=a.observable(new m.default({choices:o.choices}));o.choiceHash={};o._charChoicesHash={};o.fillInChoiceValue=a.observable(null);o.isOpen=a.observable(!1);o.inlineEdit=!0;o.inlineSave=!0;o.hasNewChoiceAdded=a.observable(!1);o.newChoiceReadoutValue="";o.selectedChoiceDisplayValue=a.observable("");o.subscribe(o.selectionModel.selection,function(e){var t=o._getDisplayValue(e);o.selectedChoiceDisplayValue(t)});o.supportsMobilePanelEdit=!o.isMultiChoice&&!o.allowFillIn;o.ariaLabel=a.observable("");o.addBindingHandlers({selection:s.default,keyboard:p.default,scrollContainer:h.default,scrollIntoView:f.default,interactionScope:v.default});if(!o.fieldsManager.interactiveSave.peek()||!o.allowFillIn||o.isMultiChoice){o.populateChoiceArray(t);!o.isSelected.peek()&&o.allowFillIn&&o.fillInChoiceValue(o._getDisplayValue(o.selectionModel.selection.peek()))}o.subscribe(o.isEdit,function(e){if(e){if(o.fieldsManager.interactiveSave.peek()){o.isSelected(!0);o.isOpen(!0)}o.dataPopulated||o.populateChoiceArray(t)}});o.subscribe(o.choices,function(e){o.selectionModel.setItems(e,!1)});o.subscribe(o.isSelected,function(e){if(o.allowFillIn)if(e)o.fillInChoiceValue("");else{if(o.fieldsManager.interactiveSave.peek()){var t=o.fillInChoiceValue.peek();if(t){o._addFillInChoice(t);o.saveChanges()}}o.fillInChoiceValue(o._getDisplayValue(o.selectionModel.selection.peek()))}});var i=o.field.schema.Required?y.format(g.strings.RequiredFieldAriaLabel,o.title):o.title;o.subscribe(o.selectedChoiceDisplayValue,function(e){o.allowFillIn&&!o.isSelected.peek()&&o.fillInChoiceValue(e);e||(e=g.strings.EmptyFieldAriaLabel);o.ariaLabel(i+", "+e)});o.fieldsManager.interactiveSave.peek()||o.subscribe(o.isWriteFocused,function(e){if(!e){o.selectedChoiceDisplayValue(o._getDisplayValue(o.selectionModel.selection.peek()));o.isOpen(!1)}});o.beforeSave=function(){o.isOpen(!1);var e=o.selectionModel.selection.peek();if(o.isMultiChoice){for(var t="",i=0,r=e;i<r.length;i++){t+=";#";t+=r[i].value}t+=t?";#":"";o.field.data(t)}else e&&0<e.length&&o.field.data(e[0].display);return!0};return o}e.prototype.onEnter=function(e,t){var i=this,r=this.fillInChoiceValue.peek();if(r&&this.isSelected.peek()){this._addFillInChoice(r);if(this.isMultiChoice){this.newChoiceReadoutValue=y.format(g.strings.NewChoiceReadoutText,r);this.hasNewChoiceAdded(!0);this.async.setTimeout(function(){i.hasNewChoiceAdded(!1)},500)}else this.fieldsManager.interactiveSave.peek()?this.saveChanges():this.isSelected(!0);this.isOpen(!0)}else if(this.isOpen.peek()){if(this.isOpen.peek()){this.isOpen(!1);this.fieldsManager.interactiveSave.peek()?this.saveChanges():this.isSelected(!0)}}else this._openAndSelect();return!1};e.prototype.onEsc=function(){if(this.fieldsManager.interactiveSave.peek()){this.fillInChoiceValue("");this._resetSelection();return!0}this.isOpen(!1);this.isSelected(!0);return!1};e.prototype.onUp=function(){this._openAndSelect();if(0===this.selectionModel.getFocusIndex()&&this.allowFillIn){this.isMultiChoice?this.selectionModel.focusedItem(null):this.selectionModel.clear(!0);this.isSelected(!0)}return!1};e.prototype.onDown=function(){this._openAndSelect();return!1};e.prototype.onKeyPress=function(e,t){var i,r=String.fromCharCode(t.keyCode),o=this.selectionModel.selection.peek(),n=0<o.length?o[o.length-1]:null,a=this._charChoicesHash[r];if(a){var s=0;if(n){for(var l=0;l<a.length;l++)if(a[l]===n){s=l+1;break}s===a.length&&(s=0)}i=a[s]}if(i){this.selectionModel.setItemSelected(i,!0);this.selectionModel.setItemFocus(i);return!1}return!0};e.prototype.selectChoice=function(e){if(this.isMultiChoice){this.selectionModel.toggleItemSelected(e);this.selectionModel.setItemFocus(e)}else{this.selectionModel.setItemSelected(e,!0);if(this.fieldsManager.interactiveSave.peek())this.saveChanges();else{this.selectedChoiceDisplayValue(this._getDisplayValue(this.selectionModel.selection.peek()));this.isOpen(!1)}}};e.prototype.toggleDropdownMenu=function(){this.isOpen.peek()?this.isOpen(!1):this.allowFillIn?this.isOpen(!0):this._openAndSelect();this.isSelected(!0);return!1};e.prototype.populateChoiceArray=function(e){var n=this;this.dataPopulated=!0;var t,a=this.field.schema,s=this.convertFormStringToArray(this.field.data.peek());if(this.allowFillIn&&!this.isMultiChoice){var i=this._currentView.peek(),r=i&&i.id;t=this._clientFormDataSource.getFieldFilterData(a.Name,r)}else t=o.default.wrap("");t.then(function(e){var t=d.ChoiceEditorHelper.getChoicesArray(a.Name,e,n._schemaChoiceValues,s,n.selectionModel);n.choices(t);for(var i=0,r=t;i<r.length;i++){var o=r[i];n.choiceHash[o.value]=o;n.addToCharChoicesHash(o)}})};e.prototype.addToCharChoicesHash=function(e){var t=e.display.charAt(0).toLowerCase();this._charChoicesHash[t]||(this._charChoicesHash[t]=[]);this._charChoicesHash[t].push(e)};e.prototype._addFillInChoice=function(e){var t=this.choiceHash[e];if(!t){var i=this._schemaChoiceValues.length;i===this.choices().length&&this.choices()[i-1].hasSeparator(!0);t=new d.Choice(e,e);var r=d.ChoiceEditorHelper.getItemKey(t);this.choices.push(t);this.choiceHash[e]=t;this.addToCharChoicesHash(t);this.selectionModel.registerSelectable(r,t)}this.fillInChoiceValue("");this.selectionModel.setItemSelected(t,!0);this.selectionModel.setItemFocus(t)};e.prototype._openAndSelect=function(){this.isOpen(!0);var e=-1;if(!this.isMultiChoice){var t=this.selectionModel.getItems(),i=this.selectionModel.selection.peek();if(i&&1===i.length)for(var r=0;r<t.length;r++)if(t[r]===i[0]){e=r;break}(e<0||e===t.length)&&(e=this.selectionModel.getFocusIndex())}e<0&&(e=0);this.selectionModel.focusedItem(null);this.selectionModel.setIndexFocus(e);this.isMultiChoice||this.selectionModel.setIndexSelected(e,!0)};e.prototype._resetSelection=function(){var e=this.convertFormStringToArray(this.field.data.peek());this.selectionModel.clear(!0);for(var t=0,i=e;t<i.length;t++){var r=i[t];this.selectionModel.setItemSelected(this.choiceHash[r],!0)}};e.prototype._getDisplayValue=function(e){for(var t="",i=0,r=e;i<r.length;i++){t&&(t+=", ");t+=r[i].display}return t};return e}(i.default);e.default=r});define("Wi",["require","exports","ap","aq","bH","cK"],function(e,t,i,l,r,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this,i=e.valueAccessor(),r=i.shouldRespectInputKeyboardEvent,o=void 0!==r&&r,n=i.cancelBubbleOnArrowKey,a=void 0!==n&&n;t._isActive=l.observable(!0);t._layout=i.layout;t._selectionModel=i.selectionModel;t._shouldRespectInputKeyboardEvent=o;t._cancelBubbleOnArrowKey=a;t.events.on(t.element,"keydown",t._onKeyDown);return t}e.prototype._onKeyDown=function(e){var t=e.target,i=d.isInputElement(t);if(!this._shouldRespectInputKeyboardEvent&&i||!this._isActive.peek())return!0;var r=this._selectionModel,o=this._layout(),n=r.getFocusIndex(),a=-1,s=!0;switch(e.which){case 38:s=(a=o.getItemIndexAbove(n))!==n;break;case 40:a=o.getItemIndexBelow(n);break;case 36:a=0;break;case 35:a=r.getItems().length-1;break;case 32:r.toggleIndexSelected(n);break;default:return}if(0<=a){1===this._selectionModel.mode&&r.setIndexSelected(a,!0);r.setIndexFocus(a)}return!this._cancelBubbleOnArrowKey&&!s};return e}(r.default);t.default=o});define("Wj",["require","exports","ap","bN"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._choices=e.choices;return t}e.prototype.getItemIndexAbove=function(e){var t=this._choices.peek();return Math.min(t.length-1,Math.max(0,e-1))};e.prototype.getItemIndexBelow=function(e){var t=this._choices.peek();return Math.min(t.length-1,Math.max(0,e+1))};e.prototype.getItemIndexLeft=function(e){return e};e.prototype.getItemIndexRight=function(e){return e};e.prototype.getItemIndicesInRegion=function(e){return[]};e.prototype.getToggleClass=function(){return""};return e}(i.default);t.default=o});define("Wc",[],function(){return"<div class=od-ChoiceEditor data-bind=\"css: {'od-MultiChoiceEditor': isMultiChoice}, interactionScope: { isScope: true }, keyboard: { allowInputEvents: true, allowButtonEvents: true, mappings: { Enter: onEnter, Up: onUp, Esc: onEsc } }\"><div class=od-TextField>\x3c!--ko if: allowFillIn && (isOpen() || fieldsManager.interactiveSave())--\x3e<input class=od-TextField-field data-bind=\"attr: { id: inputElementId, 'aria-label': ariaLabel, placeholder: fieldPlaceHolder, maxlength: inputElementMaxLength }, textInput: fillInChoiceValue, hasFocus: isSelected, keyboard: { allowInputEvents: true, mappings: { Down: onDown } }, click: toggleDropdownMenu\">\x3c!--ko if: hasNewChoiceAdded--\x3e<span role=alert class=ms-accessible data-bind=\"text: newChoiceReadoutValue\"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: allowFillIn && (isOpen() || fieldsManager.interactiveSave())--\x3e<span class=ms-Dropdown-title tabindex=0 role=combobox data-bind=\"text: selectedChoiceDisplayValue() ? selectedChoiceDisplayValue() : fieldPlaceHolder, attr: { id: inputElementId, 'aria-label': ariaLabel, 'aria-expanded': isOpen() ? 'true' : 'false' }, css: { 'is-placeholder': !selectedChoiceDisplayValue() }, keyboard: { Down: onDown }, hasFocus: isSelected, event: { keypress: onKeyPress }, click: toggleDropdownMenu\"></span>\x3c!--/ko--\x3e<i class=\"od-ChoiceEditor-icon ms-Icon ms-Icon--ChevronDown\" tabindex=-1 data-bind=\"icon: true, click: toggleDropdownMenu\"></i></div>\x3c!--ko if: isOpen--\x3e<ul class=ms-ContextualMenu tabindex=-1 role=listbox data-bind=\"scrollContainer: {}, foreach: { data: choices, as: 'choice' }, css: {'is-open': isOpen}, selection: { items: choices, layout: layout, selectionModel: selectionModel }, attr: { 'aria-multiselectable': isMultiChoice ? true: false }, event: { keypress: onKeyPress }\"><li class=od-ContextualMenu-item role=option data-bind=\"css: { 'has-separator': choice.hasSeparator, 'has-description': !!choice.description }, scrollIntoView: { isSelected: choice.isFocused }, hasFocus: choice.isFocused, attr: { tabindex: choice.isFocused()? '0': '-1', 'aria-label': choice.display, 'aria-selected': choice.isSelected }\"><a tabindex=-1 class=od-ContextualMenu-link href=javascript:; data-bind=\"event: { mousedown: $parent.selectChoice.bind($parent) }, css: { 'is-selected': choice.isSelected,'is-focused': choice.isFocused, 'has-separator': choice.hasSeparator }, attr: { title: choice.tooltip || choice.display }\">\x3c!--ko if: $parent.isMultiChoice--\x3e<div class=ms-CheckBox><input class=ms-CheckBox-input type=checkbox data-bind=\"checked: choice.isSelected\" tabindex=-1> <label class=ms-CheckBox-field role=checkbox data-bind=\"css: {'is-checked': choice.isSelected}, attr: {'aria-checked': choice.isSelected}\"><span class=\"od-ContextualMenu-linkText ms-Label\" data-bind=\"text: choice.display\"></span></label></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: $parent.isMultiChoice--\x3e<span class=od-ContextualMenu-linkText data-bind=\"text: choice.display\"></span>\x3c!--/ko--\x3e\x3c!--ko if: choice.description--\x3e<span class=od-ContextualMenu-linkDescription data-bind=\"text: choice.description\"></span>\x3c!--/ko--\x3e</a></li></ul>\x3c!--/ko--\x3e</div>"});define("Wb",["c","az"],function(e,t){e.loadStyles([{rawString:'[dir=ltr] .od-FieldEditor-controlContainer.is-editing .od-ChoiceEditor .od-TextField-field{padding-left:12px}[dir=rtl] .od-FieldEditor-controlContainer.is-editing .od-ChoiceEditor .od-TextField-field{padding-right:12px}[dir=ltr] .od-FieldEditor-controlContainer.is-editing .od-ChoiceEditor .od-TextField-field{padding-right:36px}[dir=rtl] .od-FieldEditor-controlContainer.is-editing .od-ChoiceEditor .od-TextField-field{padding-left:36px}[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .od-ChoiceEditor .od-TextField-field{padding-left:0}[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .od-ChoiceEditor .od-TextField-field{padding-right:0}.od-CheckboxChoice-input,.od-CheckboxChoice-span,.od-RadioChoice-input,.od-RadioChoice-span{vertical-align:middle}.od-DropdownChoice-select,.od-RadioChoice-select{min-height:32px;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;padding:6px 10px 8px;border:1px solid '},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-DropdownChoice-select:hover,.od-RadioChoice-select:hover{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-DropdownChoice-select:focus,.od-RadioChoice-select:focus{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:'}.od-DropdownChoice-select{width:100%}.od-RadioChoice-select{vertical-align:middle;min-width:40%;max-width:80%}[dir=ltr] .od-RadioChoice-select{margin-left:4px}[dir=rtl] .od-RadioChoice-select{margin-right:4px}.od-ChoiceEditor-label{display:block;margin-bottom:3px;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif}.od-ChoiceEditor-container{width:100%;box-sizing:border-box;background:'},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding:5px}.od-ChoiceEditor-icon{cursor:pointer;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px;position:absolute;top:0;line-height:32px}[dir=ltr] .od-ChoiceEditor-icon{right:12px}[dir=rtl] .od-ChoiceEditor-icon{left:12px}.od-ChoiceEditor-icon:focus{outline:1px solid transparent}.od-focus--enabled .od-ChoiceEditor-icon:focus{outline:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-MultiChoiceEditor .od-ContextualMenu-link.is-focused,.od-MultiChoiceEditor .od-ContextualMenu-link:focus,.od-MultiChoiceEditor .od-ContextualMenu-link:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-MultiChoiceEditor .od-ContextualMenu-link.is-focused .ms-CheckBox-field:before,.od-MultiChoiceEditor .od-ContextualMenu-link:focus .ms-CheckBox-field:before,.od-MultiChoiceEditor .od-ContextualMenu-link:hover .ms-CheckBox-field:before{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-MultiChoiceEditor .od-ContextualMenu-link.is-focused .ms-CheckBox-field.is-checked:before,.od-MultiChoiceEditor .od-ContextualMenu-link:focus .ms-CheckBox-field.is-checked:before,.od-MultiChoiceEditor .od-ContextualMenu-link:hover .ms-CheckBox-field.is-checked:before{border-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-MultiChoiceEditor .od-ContextualMenu-link.is-focused .od-ContextualMenu-linkText,.od-MultiChoiceEditor .od-ContextualMenu-link:focus .od-ContextualMenu-linkText,.od-MultiChoiceEditor .od-ContextualMenu-link:hover .od-ContextualMenu-linkText{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-MultiChoiceEditor .od-ContextualMenu-link.is-selected{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.od-MultiChoiceEditor .od-ContextualMenu-linkText{position:absolute;line-height:20px}.od-FieldEditor-controlContainer .od-ContextualMenu-item.has-description .od-ContextualMenu-link{height:auto;white-space:normal;line-height:normal}.od-FieldEditor-controlContainer .od-ContextualMenu-item.has-description .od-ContextualMenu-linkText{display:block;padding:5px 0}.od-FieldEditor-controlContainer .od-ContextualMenu-item.has-description .od-ContextualMenu-linkDescription{display:block;font-size:11px;font-style:italic;padding-bottom:5px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});define("XO",["require","exports","ap","aq","Wk","MT","Xc","iE","XQ","XP"],function(n,e,t,a,i,s,l,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var c=400,r=function(o){t.__extends(e,o);function e(e){var t=o.call(this,e)||this;t.controlHtml=n("XQ");t.itemNameEditorTagName=s.default.tagName;var i=t.fieldsManager.item.peek(),r=i.properties.FileName||i.name;t.extension=i.extension;t.inputName=a.observable(r);t.inlineEdit=!0;t.inlineSave=!0;t._pageContext=t.resources.consume(d.pageContext);t.itemNameEditorParams={name:t.inputName,extension:t.extension,hasError:t.aggregateValidation.hasError};t.subscribe(t.inputName.extend({rateLimit:c}),function(e){t._validateInput()});t.beforeSave=function(){if(t._validateInput()){t.field.data(""!==t.extension?t.inputName.peek()+t.extension:t.inputName.peek());return!0}return!1};return t}e.prototype._validateInput=function(){var e,t=this.inputName.peek(),i="",r=this._pageContext.supportPoundStorePath?new RegExp('[/"*:<>?/|/]+'):new RegExp('[/"#%*:<>?/|/]+');"string"==typeof t?0===(t=t.trim()).length?i=l.strings.RequiredField:("~"===t[0]||"."===t[0]||0<=t.indexOf(String.fromCharCode(92))||r.test(t))&&(i=this._pageContext.supportPoundStorePath?l.strings.InvalidNameError2:l.strings.InvalidNameError):i=l.strings.RequiredField;if(i){this.clientValidation.hasError(!0);this.clientValidation.errorText(i);e=!1}else{this.clientValidation.hasError(!1);this.clientValidation.errorText("");e=!0}return e};return e}(i.default);e.default=r});define("XQ",[],function(){return'<div data-bind="component: { name: itemNameEditorTagName, params: itemNameEditorParams }"></div>'});define("XP",["c","az"],function(e,t){e.loadStyles([{rawString:".od-FieldEditor-controlContainer .od-TextField{margin-bottom:0}.od-FieldEditor-controlContainer .od-ItemNameEditor-input .od-TextField-field.od-ItemNameEditor-input--error{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-FieldEditor-controlContainer .od-ItemNameEditor-input .od-TextField-field.od-ItemNameEditor-input--error:focus{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-FieldEditor-controlContainer .od-ItemNameEditor-extension{border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";transition:background-color .2s ease}[dir=ltr] .od-FieldEditor-controlContainer .od-ItemNameEditor-extension{padding-left:0}[dir=rtl] .od-FieldEditor-controlContainer .od-ItemNameEditor-extension{padding-right:0}[dir=ltr] .od-FieldEditor-controlContainer .od-ItemNameEditor-extension{padding-right:12px}[dir=rtl] .od-FieldEditor-controlContainer .od-ItemNameEditor-extension{padding-left:12px}.od-FieldEditor-controlContainer.is-editing .od-ItemNameEditor-extension,.od-FieldEditor-controlContainer.od-FieldEditor-controlContainer--globalEdit .od-ItemNameEditor-extension{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FieldEditor-controlContainer .od-ItemNameEditor.is-focused .od-ItemNameEditor-extension{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-FieldEditor-controlContainer .od-ItemNameEditor.is-error .od-ItemNameEditor-extension{border-color:#a80000}"}])});define("XM",["require","exports","ap","aq","Wk","Xc","bW","XN","Wb"],function(o,e,t,n,i,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.controlHtml=o("XN");t.fillInChoiceCheckedValue=-1;t.dropdownChoiceCheckedValue=0;var i=t.field.schema;t.choices=i.Choices;t.selectedValue=n.observable(t.field.data.peek());t.allowFillIn=i.FillInChoice;t.groupName="od-DropdownChoiceEditor-"+t.inputElementId;if(t.allowFillIn){t.addBindingHandlers({element:s.default});t.selectedChoiceIndex=n.observable(-1<t.choices.indexOf(t.field.data.peek())?0:-1);t.fillInChoiceDisplayText=a.strings.ChoiceFillInDisplayText;t.fillInInput=n.observable(null);t.fillInChoiceValue=n.observable("");t.dropdownElement=n.observable(null);t.selectedChoiceIndex()===t.fillInChoiceCheckedValue&&t.fillInChoiceValue(t.field.data.peek());t.subscribe(t.selectedChoiceIndex,function(e){t.selectedChoiceIndex()!==t.fillInChoiceCheckedValue?t.field.data(t.selectedValue()):t.field.data(t.fillInChoiceValue())});t.subscribe(t.fillInChoiceValue,function(e){t.field.data(e)})}t.subscribe(t.selectedValue,function(e){t.field.data(e)});return t}e.prototype.selectDropdown=function(){this.selectedChoiceIndex(this.dropdownChoiceCheckedValue);return!0};e.prototype.setFocusOnFillInInput=function(){this.selectedChoiceIndex(this.fillInChoiceCheckedValue);var e=this.fillInInput();if(e){e.focus();e.select()}return!0};return e}(i.default);e.default=r});define("XN",[],function(){return'\x3c!--ko ifnot: allowFillIn--\x3e<select class=od-DropdownChoice-select data-bind="options: choices, value: selectedValue"></select>\x3c!--/ko--\x3e\x3c!--ko if: allowFillIn--\x3e<div class=od-ChoiceEditor-container><label class=od-ChoiceEditor-label data-bind="click: selectDropdown"><input class=od-RadioChoice-input type=radio data-bind="attr: { name: $parent.groupName }, checked: selectedChoiceIndex, checkedValue: dropdownChoiceCheckedValue"><select class=od-RadioChoice-select data-bind="options: choices, value: selectedValue"></select></label><div data-bind=click:setFocusOnFillInInput><label class=od-ChoiceEditor-label><input class=od-RadioChoice-input type=radio data-bind="attr: { name: $parent.groupName }, checked: selectedChoiceIndex, checkedValue: fillInChoiceCheckedValue"> <span class=od-RadioChoice-span data-bind="text: fillInChoiceDisplayText"></span></label> <input type=text class=od-ChoiceEditor-fillin data-bind="value: fillInChoiceValue, element: fillInInput"></div></div>\x3c!--/ko--\x3e'});define("XJ",["require","exports","ap","aq","Wk","Xc","bW","XK","Wb"],function(o,e,t,n,i,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.controlHtml=o("XK");t.fillInChoiceCheckedValue=-1;var i=t.field.schema;t.choices=i.Choices;t.selectedChoiceIndex=n.observable(t.choices.indexOf(t.field.data.peek()));t.allowFillIn=i.FillInChoice;t.groupName="od-RadioChoiceEditor-"+t.inputElementId;if(t.allowFillIn){t.addBindingHandlers({element:s.default});t.fillInChoiceDisplayText=a.strings.ChoiceFillInDisplayText;t.fillInInput=n.observable(null);t.fillInChoiceValue=n.observable("");t.selectedChoiceIndex()===t.fillInChoiceCheckedValue&&t.fillInChoiceValue(t.field.data.peek());t.subscribe(t.fillInChoiceValue,function(e){t.isEdit()&&t.selectedChoiceIndex()===t.fillInChoiceCheckedValue&&t.field.data(e)})}t.subscribe(t.selectedChoiceIndex,function(e){t.isEdit()&&e!==t.fillInChoiceCheckedValue&&t.field.data(t.choices[e])});return t}e.prototype.setFocusOnFillInInput=function(){this.selectedChoiceIndex(this.fillInChoiceCheckedValue);var e=this.fillInInput();if(e){e.focus();e.select()}return!0};return e}(i.default);e.default=r});define("XK",[],function(){return'<div class=od-ChoiceEditor-container><div data-bind="foreach: choices"><label class=od-ChoiceEditor-label><input class=od-RadioChoice-input type=radio data-bind="attr: { name: $parent.groupName }, checked: $parent.selectedChoiceIndex, checkedValue: $index"> <span class=od-RadioChoice-span data-bind=text:$data></span></label></div>\x3c!--ko if: allowFillIn--\x3e<div data-bind=click:setFocusOnFillInInput><label class=od-ChoiceEditor-label><input class=od-RadioChoice-input type=radio data-bind="attr: { name: $parent.groupName }, checked: selectedChoiceIndex, checkedValue: fillInChoiceCheckedValue"> <span class=od-RadioChoice-span data-bind="text: fillInChoiceDisplayText"></span></label> <input type=text class=od-ChoiceEditor-fillin data-bind="value: fillInChoiceValue, element: fillInInput"></div>\x3c!--/ko--\x3e</div>'});define("Xn",["require","exports","ap","aq","Wk","Xs","Xq","Xp","Xo"],function(a,e,t,s,i,l,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(n){t.__extends(e,n);function e(e){var i=n.call(this,e)||this;i.controlHtml=a("Xp");i.taxonomyTaggingTagName=l.default.tagName;i.inlineEdit=!0;i.leaveFocusToSave=!1;var t=e.field.schema,r=i.convertRawDataToTerms(e.field.data.peek()),o=s.observableArray([]);r&&0<r.length&&o(r);i.taggingParams={taggedTerms:o,allowMultipleValues:t.AllowMultipleValues,fieldName:t.Name,fieldTitle:t.Title,fieldId:t.Id,fieldType:t.FieldType,listItem:null,setBeforeSave:function(t){i.beforeSave=function(){var e=t();if(0<e.length){i.clientValidation.errorText(e);i.clientValidation.hasError(!0);return!1}return!0}},interactiveSave:e.fieldsManager.interactiveSave,setErrorHandler:function(e){i.errorHandler=e},taxonomyQueryParams:{lcid:t.Lcid||1033,sspList:t.SspId,termSetList:t.TermSetId,anchorId:t.AnchorId||d.default.INVALID_TERM_ID,isSpanTermStores:t.IsSpanTermStores||!1,isSpanTermSets:t.IsSpanTermSets||!1,isIncludeUnavailable:!1,isIncludeDeprecated:!1,isAddTerms:t.IsAddTerms||!1,isIncludePathData:!1,excludeKeyword:!t.Name&&"TaxKeyword"!==t.Name,excludedTermset:d.default.INVALID_TERM_ID,isUseCommaAsDelimiter:t.IsUseCommaAsDelimiter||!0,isIncludeTermSetName:!1,webServiceUrl:t.WebServiceUrl,allowFillIn:t.AllowFillIn||!0}};i.subscribe(o,function(e){if(null!=e){if(i.clientValidation.hasError.peek()){i.clientValidation.hasError(!1);i.clientValidation.errorText("")}var t=e.reduce(function(e,t){return e+t.label+d.default.LABEL_ID_DELIMITER+t.termId+d.default.TERM_DELIMITER},"");i.field.data(t);i.taggingParams.allowMultipleValues||1!==e.length||i.saveChanges()}});i.subscribe(i.field.hasException,function(e){e&&i.errorHandler&&i.errorHandler()});return i}e.prototype.setDefaultValueTyped=function(e){if(e&&Array.isArray(e)){var t=e.reduce(function(e,t){return e+t.Label+d.default.LABEL_ID_DELIMITER+t.TermGuid+d.default.TERM_DELIMITER},"");this.field.data(t)}};e.prototype.setDefaultValue=function(e){if(e){for(var t=e.split(";#"),i=0;i<t.length;i++)t.splice(i,1);this.field.data(t.join(d.default.TERM_DELIMITER))}};e.prototype.convertRawDataToTerms=function(e){return e?e.split(d.default.TERM_DELIMITER).filter(function(e){return e&&0<e.length}).map(function(e){var t=e.split(d.default.LABEL_ID_DELIMITER),i=t[0],r=t[1],o={};o.termId=r;o.label=i;o.isValid=r!==d.default.INVALID_TERM_ID;return o}):[]};return e}(i.default);e.default=r});define("Xs",["require","exports","Xv","b5","Xu","Xt"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-taxonomyTagging",template:e("Xu"),viewModel:i.default,synchronous:!0});t.default=o});define("Xv",["require","exports","ap","aq","XB","aI","dZ","d7","ci","Xr","Xq","Xw"],function(r,e,t,o,i,n,a,s,l,d,c,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var p=function(i){t.__extends(e,i);function e(e){var n=i.call(this,e)||this;n.taxonomyTreeTagName=u.default.tagName;n._saveClicked=!1;n.dataProvider=n.resources.consume(s.taxonomy);n.automationId="TaxonomyTaggingViewModel";n.showTaxonomyTreeLauncher=n.shouldShowTaxonomyTreeLauncher();var t=n.resources.consume(a.settings).mediaBaseUrl;n.treeToggleImg="undefined"==typeof __webpack_public_path__?r.toUrl(t+"/images/taxonomy/taxonomycopyterm.png"):r("@ms/odsp-media/dist/media/images/taxonomy/taxonomycopyterm.png");n.treeToggleLabel=d.strings.WebTaggingDialogTitle+e.fieldTitle;n.treeOpen=o.observable(!1);e.setBeforeSave(function(){if(0<n.taggedTerms.peek().filter(function(e){return 2===e.state.peek()}).length)return d.strings.ClientValidationError;if(0<n.userInput.peek().length){var e={label:n.userInput.peek(),termId:c.default.INVALID_TERM_ID};n.userInput("");var t=n.initiateTermInfo(e,1,-1);t&&n.taggedTerms.push(t);n._saveClicked=!0}for(var i=!1,r=0;r<n.taggedTerms.peek().length;r++){var o=n.taggedTerms.peek()[r];if(1===o.state.peek()&&o.term.label!==o.modifiedText){o.term.termId=c.default.INVALID_TERM_ID;o.term.label=o.modifiedText;o.state(0);i=!0}}i&&n.taggedTerms.valueHasMutated();return""});e.setErrorHandler(function(){n._saveClicked&&(n._saveClicked=!1);n.doMatchAndValidate()});return n}e.prototype.launchTree=function(e,t){var i=this,r=this.resources.consume(l.resourceKey);this._abortSuggestionQuery();var o=r.requestDialog({title:d.strings.WebTaggingDialogTitle+this.taggingParams.fieldTitle,size:"Large",component:{name:this.taxonomyTreeTagName,params:{treeOpen:this.treeOpen,taggingParams:this.taggingParams,taggedTerms:this.taggedTerms.peek(),resultHander:this.handleTreeDialogResults.bind(this),resources:this.resources}}});this.subscribe(this.treeOpen,function(){o&&!i.treeOpen()&&o.state(2)});o.wait().then(function(){return{resultType:n.ResultTypeEnum.Success}});return!1};e.prototype.doMatchAndValidate=function(){var t=this;if(!this.suggestionContext.handlingSuggestionSelection&&!this._saveClicked){var e=this.collectTermInfoToBeMatched();if(e&&0<e.length&&this.queryParams){this.matchQueryRunning&&this.abortMatchQuery();var i=this.dataProvider.getMatches(e,this.queryParams);i.promise&&i.promise.done(function(e){e&&0<e.length&&t.ProcessMatchResults(e);t.matchQueryRunning=!1},function(e){t.matchQueryRunning=!1})}}};e.prototype.handleTreeDialogResults=function(e){if(e){var t=e.value;try{var i=t.split(c.default.TERM_DELIMITER).map(function(e){var t=e.split(c.default.LABEL_ID_DELIMITER),i={};i.label=t[0];i.termId=t[1];i.isValid=i.termId!==c.default.INVALID_TERM_ID;return i}),r=this.initiateTermInfos(i,1,-1);0===r.filter(function(e){return 0!==e.state.peek()}).length&&this.taggedTerms(r)}catch(e){}}this.disableInputBox.peek()||this.textBoxIsFocused(!0)};e.prototype.ProcessMatchResults=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(t<this.taggedTerms.peek().length){var r=this.taggedTerms.peek()[t];if(0===r.state.peek()){r.term.termId!==i.termId&&(r.term.termId=i.termId);r.term.label===i.label&&i.termId!==c.default.INVALID_TERM_ID||r.state(2)}else if(i.termId!==c.default.INVALID_TERM_ID){if(i.isAmbiguous){if(i.disambiguationData&&0<i.disambiguationData.length){r.term.label=i.disambiguationData[0].label;r.term.termId=i.disambiguationData[0].termId}}else{r.term.label=i.label;r.term.termId=i.termId}r.term.isValid=!0;r.state(0);this.taggedTerms.valueHasMutated()}else if(2!==r.state.peek()){r.state(2);this.taggedTerms.valueHasMutated()}}else{var o=this.initiateTermInfo({label:"",termId:""},1,-1);if(i.termId!==c.default.INVALID_TERM_ID){if(i.isAmbiguous){if(i.disambiguationData&&0<i.disambiguationData.length){o.term.label=i.disambiguationData[0].label;o.term.termId=i.disambiguationData[0].termId}}else{o.term.label=i.label;o.term.termId=i.termId}o.term.isValid=!0;o.state(0)}else{o.term.label=i.label;o.term.termId=i.termId;o.state(2)}o.modifiedText=i.label;this.handleSelectedSuggestion(o)}}};e.prototype.collectTermInfoToBeMatched=function(){for(var e="",t=this.taggedTerms.peek(),i=0;i<t.length;i++){var r=t[i];0!==r.state.peek()?e+=r.modifiedText+c.default.LABEL_ID_DELIMITER+c.default.INVALID_TERM_ID+c.default.TERM_DELIMITER:e+=r.term.label+c.default.LABEL_ID_DELIMITER+r.term.termId+c.default.TERM_DELIMITER}0<this.userInput.peek().length&&(e+=this.userInput.peek()+c.default.LABEL_ID_DELIMITER+c.default.INVALID_TERM_ID);return e};e.prototype.abortMatchQuery=function(){this.matchQueryRunning&&(this.matchQueryRunning=!1)};e.prototype.shouldShowTaxonomyTreeLauncher=function(){var e=this.responsiveHelper.formFactorSize.peek();return!("Small"===e||"Medium"===e||"TaxKeyword"===this.taggingParams.fieldName)};return e}(i.default);e.default=p});define("XB",["require","exports","ap","bF","aC","aq","dz","cJ","OR","ON","dB","XF","V","XC","Xr","d0","Pp","d5"],function(e,t,i,r,s,n,o,a,l,d,c,u,p,m,h,f,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){i.__extends(t,e);function t(i){var t=e.call(this)||this;t.inputTitle=h.strings.InputHint;t.taxonomyTermTagName=m.default.tagName;t.taxonomySuggestionsTagName=u.default.tagName;t.progressSpinnerFlatTagName=f.default.tagName;t.placeholderText=h.strings.InputPlaceholderText;t.suggestionsOpenText=h.strings.SuggestionTip;t.termDisplaymode=1;t.error=n.observable("");t._clientFormDataSource=t.resources.consume(g.resourceKey);t._mruSuggestionPromises=[];t.selectionModel=new c.default;t.addBindingHandlers({selection:o.default,keyboard:a.default,scrollIntoView:d.default,toggle:l.default});t.taggingParams=i;t.describedById=i.describedById;t.queryParams=i.taxonomyQueryParams;t.taggedTerms=n.observableArray(t.initiateTermInfos(i.taggedTerms.peek(),1,-1));t.subscribe(t.taggedTerms,function(e){var t=e.filter(function(e){return 0===e.state()}).map(function(e){return e.term});i.taggedTerms(t)});t.allowMultipleValues=i.allowMultipleValues;t.responsiveHelper=t.resources.consume(y.resourceKey);t.userInput=n.observable("");t.suggestionQueryRunning=n.observable(!1);t.textBoxIsFocused=n.observable(t.taggingParams.interactiveSave.peek());t.error=n.observable(null);t.focusedSuggestion=n.observable(null);t.showPlaceholder=t.createPureComputed(function(){return 0===t.taggedTerms().length&&!t.textBoxIsFocused()&&0===t.userInput().length});t.disableInputBox=t.createPureComputed(function(){return!t.allowMultipleValues&&1===t.taggedTerms().length||t.allowMultipleValues&&0<t.taggedTerms().length&&0!==t.taggedTerms()[t.taggedTerms().length-1].state()});t.matchQueryRunning=!1;t.taggedTermCursorToEnd=!1;t.focusedTermIndex=n.observable(-1);t.subscribe(t.userInput,t.handleUserInput);t._initSuggestionContext();t.subscribe(t.suggestionContext.selectedTerm,function(e){t.handleSelectedSuggestion(e)});t.inputSize=t.createPureComputed(function(){return t.userInput()?t.userInput().length+1:1});t.tagAddedText=n.observable("");return t}t.prototype.getSuggestionsForInputText=function(e,t){var i=this;if(this._suggestionTimer){this.async.clearTimeout(this._suggestionTimer);this._suggestionTimer=null}this._suggestionTimer=this.async.setTimeout(function(){i.getSuggestionsForInputTextInternal(e,t);i._suggestionTimer=null},50)};t.prototype.handleControlFocus=function(){if(this.disableInputBox.peek()){if(0<this.taggedTerms.peek().length){var e=this.taggedTerms.peek()[this.taggedTerms.peek().length-1];e.cursorToEnd=!0;e.focused(!0)}}else{this.textBoxIsFocused.peek()||this.textBoxIsFocused(!0);this.focusedTermIndex(-1)}};t.prototype.handleInputFocus=function(){this.disableInputBox.peek()||this.suggestionContext.showingSuggestions.peek()||(0<this.userInput.peek().length?this.getSuggestionsForInputText(this.userInput.peek()):this._getMRUSuggestions())};t.prototype.handleInputBlur=function(){0<this.userInput.peek().length&&!this.suggestionContext.handlingSuggestionSelection&&this.matchAndValidate()};t.prototype.onEscape=function(e,t){if(this.suggestionContext.showingSuggestions.peek()){this.dismissSuggestions();return!1}if(this.suggestionQueryRunning.peek()){this._abortSuggestionQuery();this._initSuggestionContext()}return!0};t.prototype.onEnter=function(e,t){var i=this.selectionModel.selection();if(i&&1===i.length){this.suggestionContext.selectedTerm(i[0].termInfo);return!1}if(0===this.userInput.peek().length&&this.textBoxIsFocused.peek()){this._abortSuggestionQuery();return!0}this.matchAndValidate();this.suggestionContext.showingSuggestions.peek()&&this.suggestionContext.showingSuggestions(!1);this.textBoxIsFocused.peek()||this.textBoxIsFocused(!0);return!1};t.prototype.onShiftTab=function(e,t){this.dismissSuggestions();return!0};t.prototype.onTab=function(e,t){this.dismissSuggestions();return!0};t.prototype.onBackspace=function(e,t){if(0===this.userInput().length&&this.taggedTerms&&0<this.taggedTerms().length){var i=this.taggedTerms()[this.taggedTerms().length-1];i.cursorToEnd=!0;i.focused(!0)}return!0};t.prototype.matchAndValidate=function(){this._matchTimer&&this.async.clearTimeout(this._matchTimer);this._matchTimer=this.async.setTimeout(this.doMatchAndValidate,200)};t.prototype._abortSuggestionQuery=function(){if(this.suggestionQueryRunning.peek()){this._userInputSuggestionPromise&&this._userInputSuggestionPromise.cancel();this._mruListDataPromise&&this._mruListDataPromise.cancel();this._mruSuggestionPromises&&this._mruSuggestionPromises.forEach(function(e){e.cancel()});this.suggestionQueryRunning(!1)}};t.prototype.getTaxonomyFocus=function(){var e;return 0<this.taggedTerms.peek().filter(function(e){return e.focused()}).length||!!(this.textBoxIsFocused()||this.focusedSuggestion()||e)};t.prototype.handleUserInput=function(e){this.getSuggestionsForInputText(e)};t.prototype.doMatchAndValidate=function(){};t.prototype.initiateTermInfos=function(e,t,i){for(var r=[],o=0;o<e.length;o++){var n=e[o];r.push(this.initiateTermInfo(n,t,i))}return r};t.prototype.initiateTermInfo=function(e,t,i,r,o){return{term:e,displaymode:t,suggestion:r,taggingModel:this,focused:n.observable(!1),index:n.observable(i),state:o?n.observable(o):n.observable(0),modifiedText:e.label,cursorToEnd:!1}};t.prototype.handleSelectedSuggestion=function(e){if(e){this._abortSuggestionQuery();this.userInput("");e.displaymode=1;var t=this.taggedTerms.peek();if(-1===e.index.peek()){t.push(e);this.announceTagAdded(e.term.label)}else{t[e.index.peek()]=e;this.announceTagAdded(e.term.label)}this.taggedTerms.valueHasMutated();this.dismissSuggestions();this.suggestionContext.handlingSuggestionSelection=!1}this.textBoxIsFocused()?this.disableInputBox.peek()||this._getMRUSuggestions():this.textBoxIsFocused(!0)};t.prototype.dismissSuggestions=function(){this._abortSuggestionQuery();this.suggestionContext.showingSuggestions(!1);this._initSuggestionContext()};t.prototype.announceTagAdded=function(e){var t=this;this.tagAddedText(p.format(h.strings.TagAdded,e));this.async.setTimeout(function(){t.tagAddedText("")},100)};t.prototype.getSuggestionsForInputTextInternal=function(i,r){var o=this;if(this.queryParams){if(0===i.length){this.suggestionContext.showingSuggestions()&&this.suggestionContext.showingSuggestions(!1);return}this.suggestionQueryRunning()&&this._abortSuggestionQuery();this.suggestionQueryRunning(!0);this._userInputSuggestionPromise=this.dataProvider.getSuggestions(i,this.queryParams).promise;this._userInputSuggestionPromise&&this._userInputSuggestionPromise.done(function(e){var t=void 0===r?-1:r;e&&0<e.length?0<(e=o._filterTaggedTerms(e,o.taggedTerms.peek())).length&&o._displaySuggestions(e,i,t):o.suggestionContext.showingSuggestions()&&o.dismissSuggestions();o.suggestionQueryRunning(!1);o._cleanErrors()},function(e){o.suggestionQueryRunning(!1);if(e&&"Canceled"!==e.name){o.error(h.strings.ServerError);o.dismissSuggestions()}})}};t.prototype._getMRUSuggestions=function(){var a=this;if(this.queryParams){this.suggestionQueryRunning()&&this._abortSuggestionQuery();this.suggestionQueryRunning(!0);this._mruListDataPromise=this._clientFormDataSource.getFieldValueSuggestions(this.taggingParams.fieldName,this.taggingParams.fieldType,5);this._mruListDataPromise.then(function(e){for(var o={},t=0;t<e.length;t++){var i=JSON.parse(e[t]);if(i instanceof Array)i.forEach(function(e){var t={label:e.Label,termId:e.TermID};t.termId&&(o[t.termId]=t)});else{var r={label:i.Label,termId:i.TermID};r.termId&&(o[r.termId]=r)}}a._mruSuggestionPromises=Object.keys(o).slice(0,5).map(function(e){var t=o[e];return a.dataProvider.getSuggestions(t.label,a.queryParams).promise});var n=a.dataProvider.getSuggestions("",a.queryParams);a._mruSuggestionPromises.push(n.promise);s.default.all(a._mruSuggestionPromises).then(function(e){a._mruSuggestionPromises=[];var t={},i={};e.forEach(function(e){e.forEach(function(e){if(e&&e.term&&e.term.label&&0<e.term.label.length){e.start="";0<=Object.keys(o).indexOf(e.term.termId)?t[e.term.termId]=e:i[e.term.termId]=e}})});var r=Object.keys(t).map(function(e){return t[e]}).concat(Object.keys(i).map(function(e){return i[e]}));r&&0<r.length?0<(r=a._filterTaggedTerms(r,a.taggedTerms.peek())).length&&a._displaySuggestions(r.slice(0,5),"",-1):a.suggestionContext.showingSuggestions.peek()&&a.dismissSuggestions();a.suggestionQueryRunning(!1);a._cleanErrors()},function(e){a._mruSuggestionPromises=[];a.suggestionQueryRunning(!1);a.suggestionContext.showingSuggestions.peek()&&a.dismissSuggestions()})},function(e){a.suggestionQueryRunning(!1);a.suggestionContext.showingSuggestions.peek()&&a.dismissSuggestions()})}};t.prototype._cleanErrors=function(){this.error("")};t.prototype._filterTaggedTerms=function(e,t){for(var i=[],r=0;r<e.length;r++){var o=e[r];0===t.filter(function(e){return 0===e.state.peek()&&e.term.label===o.term.label&&e.term.termId===o.term.termId}).length&&i.push(o)}return i};t.prototype._displaySuggestions=function(e,t,i){var r=this._initiateTermInfosFromSugestions(e,0,i);this.suggestionContext.suggestedTerms(r);this.suggestionContext.showingSuggestions(!0)};t.prototype._initSuggestionContext=function(){if(this.suggestionContext){this.suggestionContext.selectedTerm(null);this.suggestionContext.suggestedTerms([]);this.suggestionContext.trimmingLimit(10);this.suggestionContext.showingSuggestions(!1);this.suggestionContext.suggestions([]);this.suggestionContext.handlingSuggestionSelection=!1}else this.suggestionContext={selectedTerm:n.observable(null),suggestedTerms:n.observableArray([]),trimmingLimit:n.observable(10),showingSuggestions:n.observable(!1),suggestions:n.observableArray([]),handlingSuggestionSelection:!1}};t.prototype._initiateTermInfosFromSugestions=function(e,t,i){for(var r=[],o=0;o<e.length;o++){var n=e[o];r.push(this.initiateTermInfo(n.term,t,i,n))}return r};return t}(r.default);t.default=v});define("XF",["require","exports","XI","b5","XH","XG"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-taxonomySuggestions",template:e("XH"),viewModel:i.default,synchronous:!0});t.default=o});define("XI",["require","exports","ap","bF","aq","cI","cU","ON"],function(e,t,r,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){this.selected=o.observable(!1);this.focused=o.observable(!1);this.termInfo=e;this.id=""};t.TaxonomySuggestion=l;var d=function(i){r.__extends(e,i);function e(e){var t=i.call(this)||this;t.addBindingHandlers({dismiss:n.default,scrollContainer:a.default,scrollIntoView:s.default});t.context=e;t.context.suggestedTerms&&0<t.context.suggestedTerms.peek().length&&t.updateSuggestions(t.context.suggestedTerms.peek());t.subscribe(t.context.suggestedTerms,function(e){t.updateSuggestions(e)});t.subscribe(t.context.trimmingLimit,function(e){t.updateTrimmingLimit(e)});return t}e.prototype.onItemClicked=function(e,t){this.context.handlingSuggestionSelection=!0;var i=e;this.context.selectedTerm(i.termInfo);this.context.showingSuggestions(!1)};e.prototype.close=function(){this.context.showingSuggestions(!1)};e.prototype.updateSuggestions=function(e){var t=[],i=this.context.trimmingLimit.peek();if(e&&0<e.length){e=e.sort(function(e,t){return e.term.label.toLowerCase()===t.term.label.toLowerCase()?0:e.term.label.toLowerCase()<t.term.label.toLowerCase()?-1:1});0<i&&e.length>i&&(e=e.slice(0,i-1));for(var r=0;r<e.length;r++){var o=e[r];t.push(new l(o))}}0<t.length&&this.context.suggestions(t)};e.prototype.updateTrimmingLimit=function(e){var t=this.context.suggestions();if(t&&0<e&&t.length>e)for(var i=t.length-e,r=0;r<i;r++)t.pop();this.context.suggestions.valueHasMutated()};return e}(i.default);t.default=d});define("XH",[],function(){return"<div class=TaxonomySuggestions-Container role=menu data-bind=\"scrollContainer: {}, dismiss: {isOpen:context.showingSuggestions, close: close}\">\x3c!--ko foreach: context.suggestions--\x3e<div class=TaxonomySuggestions-Suggestion data-bind=\"click: $parent.onItemClicked.bind($parent), scrollIntoView: { isSelected: $data.focused }, css: {'AutoFill-focused': $data.focused, 'AutoFill-separator': $data.hasSeparator }\"><div data-bind=\"component: { name: 'ms-taxonomyTerm', params: { termInfo: termInfo } }\"></div></div>\x3c!--/ko--\x3e</div>"});define("XG",["c","az"],function(e,t){e.loadStyles([{rawString:".TaxonomySuggestions-Container{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";overflow-y:auto;position:absolute;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";max-height:300px;min-width:300px;max-width:400px;z-index:402}.TaxonomySuggestions-Suggestion{box-sizing:border-box;overflow:hidden;width:100%;padding:3px;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.TaxonomySuggestions-Suggestion.AutoFill-focused{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:";outline:1px solid transparent}.TaxonomySuggestions-Suggestion:not(.AutoFill-focused):hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.TaxonomySuggestions-Suggestion.AutoFill-separator{border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}"}])});define("XC",["require","exports","Xq","b5","XE","XD"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-taxonomyTerm",template:e("XE"),viewModel:i.default,synchronous:!0});t.default=o});define("Xq",["require","exports","ap","bF","aq","dz","Xr","aZ"],function(e,t,i,r,s,l,o,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){this.synonymLabel=e;this.start=t;this.synonymLabelPrefix=this.getPrefix(this.synonymLabel);this.synonymLabelRemaining=this.getRemaining(this.synonymLabel)}e.prototype.getPrefix=function(e){return 0===e.toLowerCase().indexOf(this.start.toLowerCase())?e.substr(0,this.start.length):""};e.prototype.getRemaining=function(e){return 0===e.toLowerCase().indexOf(this.start.toLowerCase())?e.substr(this.start.length):e};return e}();t.TaxonomySuggestionSynonym=c;var n=function(n){i.__extends(a,n);function a(e){var t=n.call(this)||this;t.termInfo=e.termInfo;t.index=e.index?e.index:t.termInfo.index;t.termInfo.index=t.index;t.inSuggestionMode=!!t.termInfo&&0===t.termInfo.displaymode;t.inFormFieldMode=!!t.termInfo&&1===t.termInfo.displaymode;var i=t.termInfo.term.label+(0===t.termInfo.state.peek()?a.TERM_DELIMITER:"");t.displayedLabel=s.observable(i);t.createComputed(function(){var e=t.displayedLabel.peek();1===t.termInfo.displaymode&&0===t.termInfo.state()&&e.charAt(e.length-1)!==a.TERM_DELIMITER&&(e+=a.TERM_DELIMITER);t.displayedLabel(e)});t.suggestionSynonyms=t.getSuggestionSynonyms();var r=t.termInfo.term.label;if(t.termInfo.suggestion){var o=t.termInfo.suggestion.start;t.defaultLablePrefix=0===r.toLowerCase().indexOf(o.toLowerCase())?r.substr(0,o.length):"";t.defaultLabelRemaining=0===r.toLowerCase().indexOf(o.toLowerCase())?r.substr(o.length):r}t.parentPath=t.getParentPath();t.tooltip=t.getToolTip();t.taggedTermContainerClass=t.createPureComputed(function(){return t.inFormFieldMode," TaxonomyTerm-inFormFieldMode"});t.taggedTermLabelClass=t.createPureComputed(function(){return 0===t.termInfo.state()?"Termlabel-valid":1===t.termInfo.state()?"Termlabel-modified":2===t.termInfo.state()?"Termlabel-invalid":void 0});t.addBindingHandlers({selection:l.default});return t}a.prototype.onClick=function(e,t){t.cancelBubble=!0;t.stopPropagation();0!==this.termInfo.state.peek()&&0<this.termInfo.taggingModel.suggestionContext.suggestions.peek().length&&this.termInfo.taggingModel.suggestionContext.showingSuggestions(!0);return!1};a.prototype.onTaggedTermKeydown=function(e,t){var i=t.keyCode,r=t.currentTarget,o=this.termInfo.taggingModel.taggedTerms.peek(),n=this.index.peek();if(38===i||40===i)return!0;if(16===i&&0<o[n].modifiedText.length){this.termInfo.taggingModel.onEnter.call(this.termInfo.taggingModel,this.termInfo.taggingModel,t);t.cancelBubble=!0;t.stopPropagation();return!1}if(13===i){this.termInfo.taggingModel.onEnter.call(this.termInfo.taggingModel,this.termInfo.taggingModel,t);t.cancelBubble=!0;t.stopPropagation();return!1}if(37===i){var a=this.GetCursorLocation(r);this.logDebuggingInfo("left",a,n,r.innerHTML);if(0===a&&0<n){this.termInfo.taggingModel.focusedTermIndex(n-1);o[n-1].cursorToEnd=!0;o[n-1].focused(!0);return!1}}if(39===i){a=this.GetCursorLocation(r);this.logDebuggingInfo("right",a,n,r.innerHTML);if(a===r.innerHTML.length){if(n<o.length-1){this.termInfo.taggingModel.focusedTermIndex(n+1);o[n+1].focused(!0);return!1}if(n===o.length-1){this.termInfo.taggingModel.textBoxIsFocused(!0);return!1}}}t.cancelBubble=!0;t.stopPropagation();return!0};a.prototype.onTaggedTermKeyup=function(e,t){var i=t.keyCode,r=t.currentTarget;if(38===i||40===i)return!0;27===i?this.termInfo.taggingModel.textBoxIsFocused(!0):9===i?this.termInfo.taggingModel.onTab.call(this.termInfo.taggingModel,this.termInfo.taggingModel,t):this.processTaggedTermEvent({termSpan:r,type:t.type});t.cancelBubble=!0;t.stopPropagation();return!0};a.prototype.onTaggedTermPaste=function(e,t){this.processTaggedTermEventDeferred({termSpan:t.currentTarget,type:t.type});return!0};a.prototype.onTaggedTermCut=function(e,t){this.processTaggedTermEventDeferred({termSpan:t.currentTarget,type:t.type});return!0};a.prototype.onTaggedTermDrop=function(e,t){this.processTaggedTermEventDeferred({termSpan:t.currentTarget,type:t.type});return!0};a.prototype.onTaggedTermFocus=function(e,t){if(this.termInfo.taggingModel){if(this.termInfo.cursorToEnd){this.logDebuggingInfo("focus and cursor to End",-1,this.index.peek(),t.currentTarget.innerHTML);this.placeCaretAtEnd(t.currentTarget);this.termInfo.cursorToEnd=!1}else this.logDebuggingInfo("focus on first",-1,this.index(),t.currentTarget.innerHTML);this.termInfo.taggingModel.focusedTermIndex(this.index.peek());if(0!==this.termInfo.state.peek()){var i=this.getCurrentTermLabel(t.currentTarget);this.termInfo.taggingModel.getSuggestionsForInputText(i,this.termInfo.index.peek())}}};a.prototype.onTaggedTermBlur=function(e,t){this.termInfo.taggingModel.focusedTermIndex(-1);var i=t.currentTarget;this.logDebuggingInfo("blur",-1,this.index(),i.innerHTML);var r=this.getCurrentTermLabel(i);if(0===r.length)this.handleTermDeletion();else if(this.termInfo.term.label!==r&&2!==this.termInfo.state.peek()){this.displayedLabel(r);if(r!==this.termInfo.modifiedText){this.termInfo.state(1);this.termInfo.modifiedText=r}this.termInfo.taggingModel.matchAndValidate()}else if(this.termInfo.term.label===r&&i.innerHTML.charAt(i.innerHTML.length-1)!==a.TERM_DELIMITER&&0!==this.termInfo.state.peek()&&this.termInfo.term.isValid){this.displayedLabel(r);this.termInfo.state(0)}};a.prototype.hasSynonyms=function(){return this.suggestionSynonyms&&0<this.suggestionSynonyms.length};a.prototype.logDebuggingInfo=function(e,t,i,r){0};a.prototype.handleTermDeletion=function(){var e=this.termInfo.taggingModel.taggedTerms.peek(),t=this.index.peek();if(e[t]&&e[t].index.peek()===t){var i=e.splice(t,1);console.log("Deleting tagger term, current index: "+t+" term index: "+i[0].index.peek()+" label: "+i[0].term.label);this.termInfo.taggingModel.suggestionContext.showingSuggestions.peek()&&this.termInfo.taggingModel.suggestionContext.showingSuggestions(!1);if(0===e.length||0===t&&!this.termInfo.taggingModel.disableInputBox.peek()){this.termInfo.taggingModel.textBoxIsFocused(!0);this.termInfo.taggingModel.focusedTermIndex(-1)}else if(0===t&&this.termInfo.taggingModel.disableInputBox.peek()){e[e.length-1].cursorToEnd=!0;e[e.length-1].focused(!0);this.termInfo.taggingModel.focusedTermIndex(e.length-2)}else{e[t-1].cursorToEnd=!0;e[t-1].focused(!0);this.termInfo.taggingModel.focusedTermIndex(t-1)}this.termInfo.taggingModel.taggedTerms(e);this.termInfo.taggingModel._abortSuggestionQuery()}this.termInfo.taggingModel.taggingParams.allowMultipleValues||this.termInfo.taggingModel.textBoxIsFocused(!0)};a.prototype.getCurrentTermLabel=function(e){var t=e.textContent;t.charAt(t.length-1)===a.TERM_DELIMITER&&(t=t.substring(0,t.length-1));return t};a.prototype.processTaggedTermEvent=function(e){if(this.onTaggedTermHandlerTimer){this.async.clearTimeout(this.onTaggedTermHandlerTimer);this.onTaggedTermHandlerTimer=void 0}"paste"!==e.type&&"drop"!==e.type||(e.termSpan.innerHTML=e.termSpan.textContent);var t=this.getCurrentTermLabel(e.termSpan);if(0!==t.length&&t!==this.termInfo.modifiedText){1!==this.termInfo.state.peek()&&this.termInfo.state(1);this.termInfo.modifiedText=t;this.termInfo.taggingModel.getSuggestionsForInputText(t,this.termInfo.index.peek())}else 0===t.length&&this.handleTermDeletion()};a.prototype.processTaggedTermEventDeferred=function(e){var t=this;this.onTaggedTermHandlerTimer||(this.onTaggedTermHandlerTimer=this.async.setTimeout(function(){return t.processTaggedTermEvent(e)},10))};a.prototype.GetCursorLocation=function(e){var t,i,r=0;if(window.getSelection)(t=window.getSelection()).rangeCount&&((i=t.getRangeAt(0)).commonAncestorContainer.parentNode!==e&&i.commonAncestorContainer!==e||(r=i.endOffset));else if(document.selection&&document.selection.createRange&&(i=document.selection.createRange()).parentElement()===e){var o=document.createElement("span");e.insertBefore(o,e.firstChild);var n=i.duplicate();n.moveToElementText(o);n.setEndPoint("EndToEnd",i);r=n.text.length}return r};a.prototype.placeCaretAtEnd=function(e){console.log("placeCaretAtEnd");if(void 0!==window.getSelection&&void 0!==document.createRange){var t=document.createRange();t.selectNodeContents(e);t.collapse(!1);var i=window.getSelection();i.removeAllRanges();i.addRange(t)}else if(void 0!==document.body.createTextRange){var r=document.body.createTextRange();r.moveToElementText(e);r.collapse(!1);r.select()}};a.prototype.getSuggestionSynonyms=function(){var t=this,e=[];if(this.termInfo.suggestion)for(var i=0;i<this.termInfo.suggestion.completions.length;i++){var r=this.termInfo.suggestion.completions[i];if(this.termInfo.term.label.toLowerCase()!==this.termInfo.suggestion.start.toLowerCase()+r.toLowerCase()&&(0<this.termInfo.suggestion.start.length&&this.termInfo.term&&this.termInfo.term.synonyms)){var o=this.termInfo.term.synonyms.filter(function(e){return e.toLowerCase()===t.termInfo.suggestion.start.toLowerCase()+r.toLowerCase()});1===o.length&&e.push(new c(o[0],this.termInfo.suggestion.start))}}return e};a.prototype.getToolTip=function(){var e=this.termInfo.term.paths&&0<this.termInfo.term.paths.length?this.termInfo.term.label+" "+this.termInfo.term.paths[0]:this.termInfo.term.label;if(this.termInfo.term.synonyms&&0<this.termInfo.term.synonyms.length){return e+"\r\n"+(o.strings.SynonymsTitle+this.termInfo.term.synonyms.reduce(function(e,t){return e+"; "+t}))}return e};a.prototype.getParentPath=function(){if(this.termInfo&&this.termInfo.term&&this.termInfo.term.paths){var e=this.termInfo.term.paths[0];e[0]+e[e.length-1]==="[]"&&(e=e.substr(1,e.length-2));var t=e.split(":");return 0<t.length?o.strings.SuggestionPathPrefix+" "+t[t.length-1]:""}};a.INVALID_TERM_ID=d.default.Empty;a.LABEL_ID_DELIMITER="|";a.TERM_DELIMITER=";";return a}(r.default);t.default=n});define("XE",[],function(){return'<div class=TaxonomyTerm role=menuitem data-bind="attr:{ \'aria-label\': tooltip, \'title\': tooltip }, css: taggedTermContainerClass">\x3c!--ko if: inSuggestionMode--\x3e<div><span class=Termlabel-userinput data-bind="text: defaultLablePrefix"></span>\x3c!----\x3e<span class=Termlabel-remaining data-bind="text: defaultLabelRemaining"></span></div>\x3c!--ko if: parentPath--\x3e<div><span class=Termlabel-path data-bind="text: parentPath"></span></div>\x3c!--/ko--\x3e\x3c!--ko if: hasSynonyms()--\x3e<ul class=ms-TermSynonym-List data-bind="foreach: { data: suggestionSynonyms, as: \'synonym\' }"><li><span class=Termlabel-userinput data-bind="text: synonym.synonymLabelPrefix"></span>\x3c!----\x3e<span class=Termlabel-remaining data-bind="text: synonym.synonymLabelRemaining"></span></li></ul>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: inFormFieldMode--\x3e<span contenteditable=true spellcheck=false data-bind="text: displayedLabel(), click: onClick, selection: { data: termInfo.taggingModel.suggestionContext.suggestions, focused: termInfo.taggingModel.focusedSuggestion, mode: \'single\', direction: \'vertical\', selectionModel: termInfo.taggingModel.selectionModel, allowInputEvents: true }, event: {keyup: onTaggedTermKeyup, keydown: onTaggedTermKeydown, paste: onTaggedTermPaste, cut: onTaggedTermCut, drop: onTaggedTermDrop, focus: onTaggedTermFocus, blur: onTaggedTermBlur }, hasFocus: termInfo.focused, css: taggedTermLabelClass"></span>&nbsp;\x3c!--/ko--\x3e</div>'});define("XD",["c","az"],function(e,t){e.loadStyles([{rawString:'.TaxonomyTerm{box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;position:relative;width:100%}.TaxonomyTerm .Termlabel-userinput{position:relative;display:inline;background-color:#ff0}.TaxonomyTerm .Termlabel-remaining{position:relative;display:inline}.TaxonomyTerm .Termlabel-path{margin:0;overflow:hidden}[dir=ltr] .TaxonomyTerm .Termlabel-path{left:0}[dir=rtl] .TaxonomyTerm .Termlabel-path{right:0}[dir=ltr] .TaxonomyTerm .Termlabel-path{right:0}[dir=rtl] .TaxonomyTerm .Termlabel-path{left:0}.TaxonomyTerm .Termlabel-valid{position:relative;display:inline-block;text-decoration:underline;padding-left:2px;left:1px}.TaxonomyTerm .Termlabel-valid:focus{outline:0;border:0}.TaxonomyTerm .Termlabel-invalid{position:relative;display:inline-block;border-bottom:dashed 1px red;color:red;padding-left:2px;left:1px}.TaxonomyTerm .Termlabel-invalid:focus{outline:0;border:0}.TaxonomyTerm .Termlabel-modified{position:relative;display:inline-block;padding-left:2px;left:1px}.TaxonomyTerm .Termlabel-modified:focus{outline:0;border:0}.TaxonomyTerm .ms-TermSynonym-List{padding-left:20px;margin-top:0;margin-bottom:2px}.TaxonomyTerm.TaxonomyTerm-inFormFieldMode{display:inline}'}])});define("Xw",["require","exports","Xz","b5","Xy","Xx"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-Taxonomy-Tree-Tagging",template:e("Xy"),viewModel:i.default,synchronous:!0});t.default=o});define("Xz",["require","exports","ap","bF","XA","dZ","d0","Xq","aq","b6"],function(e,t,r,i,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.loadingLabel=o.strings.TaxonomyTreeLoadingLabel;t.progressSpinnerFlatTagName=a.default.tagName;t._resources=e.resources;t.taggingParams=e.taggingParams;t.taggedTerms=e.taggedTerms;t.treeOpen=l.isObservable(e.treeOpen)?e.treeOpen:l.observable(!0);t.isLoading=l.observable(!0);t.taxonomyTreeUrl=t.getTaxonomyTreeUrl();t.resultHander=e.resultHander;return t}e.prototype.iframeOnLoad=function(e,t){var i=this,r=t.target;if(r&&r.contentWindow){var o=r.contentWindow.document,n=d.default.getElementByTagAndPartialId(o,"input","OkButton"),a=d.default.getElementByTagAndPartialId(o,"input","CancelButton");if(n&&a){if(!n.onclickListenerAdded){n.onclickListenerAdded=!0;this.events.on(n,"click",function(e){var t=d.default.getElementByTagAndPartialId(o,"input","FieldEditorHiddenInput");i.resultHander(t);i.treeOpen(!1)})}if(!a.onclickListenerAdded){a.onclickListenerAdded=!0;this.events.on(a,"click",function(e){i.resultHander(null);i.treeOpen(!1)})}}this.isLoading(!1);this.treeOpen(!0);this.setInnerDialogStyle(o);this.async.setTimeout(function(){r.style.height&&"0px"!==r.style.height||(r.style.height=.618*document.body.clientHeight+"px")},200)}};e.prototype.getTaxonomyTreeUrl=function(){return this._resources.consume(n.taxonomy).getTaxonomyTreeUrl(this.convertToTermsRawString(this.taggedTerms),{name:this.taggingParams.fieldName,id:this.taggingParams.fieldId,isMulti:this.taggingParams.allowMultipleValues},this.taggingParams.taxonomyQueryParams)};e.prototype.convertToTermsRawString=function(e){for(var t="",i=0;i<e.length;i++){var r=e[i];if(0===r.state.peek()){t+=r.term.label+s.default.LABEL_ID_DELIMITER+r.term.termId;i<e.length-1&&(t+=s.default.TERM_DELIMITER)}}return t};e.prototype.setInnerDialogStyle=function(e){var t=e.getElementById("FieldEditoreditableRegion");if(t){t.parentElement.style.width="100%"}};return e}(i.default);t.default=c});define("Xy",[],function(){return'<div class=taxonomy-tree><iframe class=taxonomy-tree-iframe data-bind="attr: {src: taxonomyTreeUrl}, event: {load: iframeOnLoad}, visible: !isLoading()"></iframe><div class=taxonomy-tree-ProgressContainer data-bind="visible: isLoading"><div data-bind="component: {name: progressSpinnerFlatTagName}"></div></div></div>'});define("Xx",["c","az"],function(e,t){e.loadStyles([{rawString:".taxonomy-tree iframe{border:none;width:100%}.taxonomy-tree .taxonomy-tree-ProgressContainer{width:250px;padding:15px 0}"}])});define("Xu",[],function(){return'<div class=taxonomyWebTagging id=taxonomyWebTagging data-bind="click: handleControlFocus, attr: {title: inputTitle}, css: {\'is-active\': getTaxonomyFocus()}"><div class=taxonomyWebTagging-container>\x3c!--ko foreach: taggedTerms--\x3e<div class=taxonomyWebTagging-taggedTerms-term data-bind="component: { name: $parent.taxonomyTermTagName, params: {termInfo: $data, index: $index}}"></div>\x3c!--/ko--\x3e<input class=taxonomyWebTagging-textBox id=taxonomyWebTagging-textBox type=text autocomplete=off autocapitalize=off autocorrect=off aria-haspopup=true aria-expanded=suggestionContext.showingSuggestions().toString() data-bind="textInput: userInput, attr: { size: inputSize, \'aria-label\': inputTitle, \'aria-describedby\': describedById }, disable: disableInputBox, event: { focus: handleInputFocus, blur: handleInputBlur }, hasFocus: textBoxIsFocused, selection: { data: suggestionContext.suggestions, focused: focusedSuggestion, mode: \'single\', direction: \'vertical\', selectionModel: selectionModel, allowInputEvents: true }, keyboard: { mappings: { Enter: onEnter, Backspace: onBackspace, Left: onBackspace, Tab: onTab, Esc: onEscape, ShiftTab: onShiftTab }, context: $data, allowInputEvents: true }"> <span class=ms-accessible role=status aria-live=polite data-bind="text: tagAddedText"></span>\x3c!--ko if: showPlaceholder()--\x3e<span class=taxonomyWebTagging-ghostText aria-hidden=true data-bind="text: placeholderText"></span>\x3c!--/ko--\x3e</div>\x3c!--ko if: showTaxonomyTreeLauncher--\x3e<div class=taxonomyWebTagging-treeToggle><img aria-hidden=true data-bind="attr: {src: treeToggleImg, alt: treeToggleLabel}, event: {click: launchTree}, clickBubble: false"></div>\x3c!--/ko--\x3e<div class=taxonomyWebTagging-progressBoxContainer><div class=taxonomyWebTagging-progressBox data-bind="component: {name: progressSpinnerFlatTagName}, visible: suggestionQueryRunning()"></div></div></div>\x3c!--ko if:suggestionContext.showingSuggestions()--\x3e<div id=taxonomyWebTagging-Suggestions data-bind="component: {name: taxonomySuggestionsTagName, params: suggestionContext }"></div><span role=status aria-live=polite class=ms-accessible data-bind="text: suggestionsOpenText"></span>\x3c!--/ko--\x3e<div aria-live=assertive class=taxonomyWebTagging-error data-bind="text: error(), visible: !!error() && error().length > 0"></div>'});define("Xt",["c","az"],function(e,t){e.loadStyles([{rawString:".taxonomyWebTagging-treeToggle{box-sizing:border-box;max-height:78px;position:relative;display:inline-block;float:right;top:2px;right:2px}.taxonomyWebTagging-container{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:calc(100% - 32px);box-sizing:border-box;max-height:78px;position:relative;display:inline-block}.taxonomyWebTagging-container .taxonomyWebTagging-taggedTerms{display:inline}.taxonomyWebTagging-container .taxonomyWebTagging-taggedTerms-term{display:inline;margin-right:3px}.taxonomyWebTagging{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:100%;box-sizing:border-box;overflow-y:auto;overflow-x:hidden;max-height:78px;position:relative;padding:3px}.taxonomyWebTagging-textBox{border:0 solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";vertical-align:inherit;background-color:transparent;margin:2px;vertical-align:top;outline:0}.taxonomyWebTagging-textBox::-ms-clear{display:none}.taxonomyWebTagging-textBox:focus{outline-color:transparent}.taxonomyWebTagging-progressBoxContainer{width:100%}.taxonomyWebTagging-progressBoxContainer .taxonomyWebTagging-progressBox{margin-top:-6px}.taxonomyWebTagging-ghostText{position:absolute;top:2px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";white-space:nowrap}[dir=ltr] .taxonomyWebTagging-ghostText{left:5px}[dir=rtl] .taxonomyWebTagging-ghostText{right:5px}.taxonomyWebTagging-error{color:#a80000}"}])});define("Xp",[],function(){return'<div data-bind="component: {name: taxonomyTaggingTagName, params: taggingParams }, keyboard: { mappings: { Enter: saveChanges }, context: $data, allowInputEvents: true, allowButtonEvents: true }"></div>'});define("Xo",["c","az"],function(e,t){e.loadStyles([{rawString:'@charset "UTF-8";.od-FieldEditor-controlContainer .taxonomyWebTagging{border:0;border-bottom:1px solid '},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";outline:0;font-size:14px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding:5px 8px;min-width:170px;min-height:32px;transition:background-color .2s ease,padding-left .2s ease}[dir=ltr] .od-FieldEditor-controlContainer .taxonomyWebTagging{padding-left:0}[dir=rtl] .od-FieldEditor-controlContainer .taxonomyWebTagging{padding-right:0}.od-FieldEditor-controlContainer .taxonomyWebTagging-container{width:calc(100% - 26px)}.od-FieldEditor-controlContainer .Termlabel-invalid,.od-FieldEditor-controlContainer .Termlabel-modified,.od-FieldEditor-controlContainer .Termlabel-valid{font-size:14px;padding:0 2px 0 0}.od-FieldEditor-controlContainer .TaxonomySuggestions-Container{min-width:150px;width:100%;max-height:220px}.od-FieldEditor-controlContainer .taxonomyWebTagging-ghostText{top:0;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif}[dir=ltr] .od-FieldEditor-controlContainer .taxonomyWebTagging-ghostText{left:0}[dir=rtl] .od-FieldEditor-controlContainer .taxonomyWebTagging-ghostText{right:0}[dir=ltr] .od-FieldEditor-controlContainer .taxonomyWebTagging-taggedTerms-term{margin-right:0}[dir=rtl] .od-FieldEditor-controlContainer .taxonomyWebTagging-taggedTerms-term{margin-left:0}.od-FieldEditor-controlContainer .taxonomyWebTagging-textBox,.od-FieldEditor-controlContainer .taxonomyWebTagging-textBox.selection-active{font-size:14px;margin:0 2px;font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-FieldEditor-controlContainer .taxonomyWebTagging-treeToggle img{cursor:pointer}.od-FieldEditor-controlContainer .TaxonomySuggestions-Suggestion{min-height:40px;padding:10px 16px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";cursor:pointer}.od-FieldEditor-controlContainer .TaxonomySuggestions-Suggestion .Termlabel-path{font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:'}.od-FieldEditor-controlContainer .TaxonomyTerm{font-size:14px}.od-FieldEditor-controlContainer .Termlabel-userinput{font-family:"Segoe UI Semibold WestEuropean","Segoe UI Semibold","Segoe UI",Tahoma,Arial,sans-serif;color:'},{theme:"black",defaultValue:"#000000"},{rawString:";background:0 0}.od-FieldEditor-controlContainer .ms-TermSynonym-List{margin-top:2px;list-style:none;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-FieldEditor-controlContainer .ms-TermSynonym-List{padding-left:0}[dir=rtl] .od-FieldEditor-controlContainer .ms-TermSynonym-List{padding-right:0}.od-FieldEditor-controlContainer .ms-TermSynonym-List>li:before{content:'•';font-size:11px;padding-right:4px}.od-FieldEditor-controlContainer.is-editing .taxonomyWebTagging{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-FieldEditor-controlContainer.is-editing .taxonomyWebTagging{padding-left:10px}[dir=rtl] .od-FieldEditor-controlContainer.is-editing .taxonomyWebTagging{padding-right:10px}.od-FieldEditor-controlContainer.is-editing.od-FieldEditor-controlContainer--globalEdit .taxonomyWebTagging{border-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-FieldEditor-controlContainer.is-editing.od-FieldEditor-controlContainer--globalEdit .taxonomyWebTagging.is-active{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}])});define("Xm",["require","exports","ap","XL","Wd","QY","m8","Wc","Wb"],function(e,t,r,i,m,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.beforeSave=function(){t.isOpen(!1);var e=t.selectionModel.selection.peek();e&&0<e.length&&t.field.data(e[0].value);return!0};return t}e.prototype.getFieldPlaceHolderString=function(){return n.getPlaceholder()};e.prototype.populateChoiceArray=function(e){var u=this;this.dataPopulated=!0;var p=this.field.serverData||"",t=this.resources.consume(o.resourceKey),i=t.getAvailableTagsForSite();this.isVisible(!1);i.then(function(e){for(var t=[],i=0,r=u.field.schema.ComplianceTags=e;i<r.length;i++){var o=r[i],n=o.displayName?o.displayName:o.tagName;(l=new m.Choice(n,o.tagValue)).description=o.tagDescription;l.tooltip=o.tagTooltip;t.push(l)}u.selectionModel.setItems(t,!0);for(var a=0,s=t;a<s.length;a++){var l=s[a];u.selectionModel.registerSelectable(m.ChoiceEditorHelper.getItemKey(l),l)}u.choices(t);for(var d=0,c=t;d<c.length;d++){l=c[d];u.choiceHash[l.value]=l;u.addToCharChoicesHash(l);l.value===p&&u.selectionModel.setItemSelected(l,!0)}});t.hasComplianceTags().then(function(e){u.isVisible(e)})};return e}(i.default);t.default=a});define("Xd",["require","exports","ap","aq","aC","Wk","Xh","Xg","q0","dZ","kU","V","Xb","dN","ci","dI","dm","Xc","Xf","Xe"],function(o,e,i,n,t,r,a,s,l,d,c,u,p,m,h,f,g,y){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var v=function(){function e(e,t){this.operationsPool=[];this.item=e;this.dataSource=t}e.prototype.createAddAttachmentOperation=function(e){var t={type:1,listItemId:Number(this.item.properties.ID),fileName:e.name,file:e};this.operationsPool.some(function(e){return e.type===t.type&&e.fileName===t.fileName})||this.operationsPool.push(t)};e.prototype.createDeleteAttachmentOperation=function(e){var t={type:0,listItemId:Number(this.item.properties.ID),fileName:e};this.operationsPool.push(t)};e.prototype.executeAllOperations=function(n,e){var a=this;e&&this.preprocessOperations();return new t.default(function(i,e){if(0<n.length){var t=n[0],r=n.slice(1),o=function(t){a.executeAllOperations(r,!1).done(function(e){return i([t].concat(e))},e)};(1===t.type?a.processUpload(t.file):a.processDelete(t.fileName)).done(o,o)}else i([])})};e.prototype.setListItem=function(e){var t=e&&Number(e.properties.ID);if("number"==typeof t&&!isNaN(t)){this.item=e;for(var i=0,r=this.operationsPool;i<r.length;i++){r[i].listItemId=t}}};e.prototype.processUpload=function(t){return this.dataSource.addAttachment(this.item,t).then(function(e){return{result:e,errorMsg:e?null:u.format(s.strings.uploadError,t.name)+"."}},function(e){throw{result:!1,errorMsg:u.format(s.strings.uploadError,t.name)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})};e.prototype.processDelete=function(t){return this.dataSource.deleteAttachment(this.item,t).then(function(e){return{result:e,errorMsg:e?null:u.format(s.strings.deleteError,t)+"."}},function(e){throw{result:!1,errorMsg:u.format(s.strings.deleteError,t)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})};e.prototype.preprocessOperations=function(){for(var t=this,e=[],i=0;i<this.operationsPool.length;i++){var r=this.operationsPool[i];if(1===r.type)for(var o=i+1;o<this.operationsPool.length;o++){var n=this.operationsPool[o];if(0===n.type&&n.fileName===r.fileName){e.push(i);e.push(o)}}}e.sort(function(e,t){return t-e}).forEach(function(e){t.operationsPool.splice(e,1)})};return e}();e.AttachmentOperationsManager=v;var _=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.renderField=function(e){return"\x3c!-- ko foreach: attachments --\x3e\x3c!-- ko component: {name: $parent.attachmentsRenderInFormTagName,params: {attachment: $data, fieldIsEdit: false, attachmentEditor: $parent}} --\x3e\x3c!-- /ko --\x3e\x3c!-- /ko --\x3e"};return t}(p.default);e.AttachmentsRenderer=_;var b=function(r){i.__extends(e,r);function e(e){var i=r.call(this,e)||this;i.controlHtml=o("Xf");i.attachmentsRenderInFormTagName=a.default.tagName;i.strings=s.strings;i.inlineEdit=!0;i.leaveFocusToSave=!1;i.showInvisibleRegion=!0;var t=i.convertRawDataToAttachments(e.field.data.peek());i.attachments=n.observableArray([]);i.manager=new v(i.fieldsManager.item.peek(),i.resources.consume(d.attachments));e.field.AttachmentOperationsManager=i.manager;t&&0<t.length&&i.attachments(t);i.newAttachmentsSelected=n.observable(!1);i.errors=n.observableArray([]);i.dialogHostTagName=l.default.tagName;i.resources.bind(h.resourceKey);i.dialogProvider=i.resources.consume(h.resourceKey);i.attachmentInputElement=n.observable();i.beforeSave=function(){i.cleanErrors();i.attachments.peek().filter(function(e){return!e.uploaded}).forEach(function(e){i.manager.createAddAttachmentOperation(e.nativeFile)});i.fieldsManager.interactiveSave.peek()&&0<i.manager.operationsPool.length&&(e.field.serverData=null);return!0};i.subscribe(e.field.data,function(e){var t=i.convertRawDataToAttachments(e);i.attachments(t)});return i}e.prototype.removeAttachment=function(i,e){var r=this;this.cleanErrors();var t=function(e){var t=r.attachments.peek().filter(function(e){return e.fileName!==i.attachment.fileName});r.attachments(t)};if(i.attachment.uploaded){this._getConfirmationDialog().then(function(){t(i.attachment.fileName);r.manager.createDeleteAttachmentOperation(i.attachment.fileName);r.autoSave()})}else t(i.attachment.fileName)};e.prototype.handleFilesSelection=function(e,t){for(var i=t.target,r=Array.prototype.slice.call(i&&(i["test-files"]||i.files)||[]),o=[],n=0;n<r.length;n++){var a=r[n];o.push(a)}if(0<o.length){var s=this.FilesToAttachments(o),l=this.attachments.peek().concat(s);l=this.removeDuplicateAttachments(l);this.attachments(l);this.autoSave()}this.cleanErrors()};e.prototype.onAttachmentLinkClick=function(e,t,i){this.cleanErrors();new(this.managed(c.default))({url:e,ignoreHistory:!1,target:"_blank"}).execute(i).done(function(){})};e.prototype.getAriaLabel=function(){var e=this.field.schema.Required?u.format(y.strings.RequiredFieldAriaLabel,this.title):this.title;e=e+", "+u.format(y.strings.AttachmentsCount,this.attachments.peek().length);return e=u.format(y.strings.PressEnterToEditAriaLabel,e)};e.prototype.clickFileInput=function(){this.attachmentInputElement.peek().click()};e.prototype.getFieldRenderForClientFormField=function(e){return new _(this.defaultColumnDefinition,this)};e.prototype.autoSave=function(){this.fieldsManager.interactiveSave.peek()&&this.saveChanges()};e.prototype.convertRawDataToAttachments=function(i){return i&&i.Attachments&&0<i.Attachments.length?i.Attachments.map(function(e){var t={};t.fileName=e.FileName;t.serverUrl=i.UrlPrefix+t.fileName;t.id=e.AttachmentId;t.uploaded=!0;return t}):[]};e.prototype.FilesToAttachments=function(e){return e&&0<e.length?e.map(function(e){var t={};t.fileName=e.name;t.nativeFile=e;t.uploaded=!1;return t}):[]};e.prototype.removeDuplicateAttachments=function(e){for(var t={},i=0;i<e.length;i++){var r=e[i];t[r.fileName]&&!r.uploaded||(t[r.fileName]=r)}var o=[];for(var n in t)t.hasOwnProperty(n)&&o.push(t[n]);return this.sortAttachments(o)};e.prototype.cleanErrors=function(){if(this.field.hasException.peek()){this.field.hasException(!1);this.field.errorMessage("")}};e.prototype.sortAttachments=function(e){return e.sort(function(e,t){return e.uploaded===t.uploaded?e.fileName===t.fileName?0:e.fileName<t.fileName?-1:1:e.uploaded?-1:1})};e.prototype._getConfirmationDialog=function(){return this.dialogProvider.requestDialog({title:g.strings.deleteConfirmTitle,component:{name:m.default.tagName,params:{text:s.strings.recycleConfirmationText}},actions:[{name:g.strings.DeleteItem,execute:function(){return t.default.wrap(2)},isAvailable:n.observable(!0),icon:new f.default("Delete"),isDefault:!1},{name:g.strings.cancelActionText,execute:function(){return t.default.wrap(3)},isAvailable:n.observable(!0),icon:new f.default("Cancel"),isDefault:!0}]}).wait()};return e}(r.default);e.default=b});define("Xh",["require","exports","Xk","b5","Xj","Xi"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-attachment",template:e("Xj"),viewModel:i.default,synchronous:!0});t.default=o});define("Xk",["require","exports","ap","bF","Xl","gK","V"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this)||this;t.context=e;t.attachment=t.context.attachment;t.fieldIsEdit=t.context.fieldIsEdit;t.editor=t.context.attachmentEditor;t.tooltip=t.attachment.uploaded?t.attachment.serverUrl:"";t.removeLabel=a.format(o.strings.RemoveAttachmentLabel,t.attachment.fileName);t.addReadyReadout=a.format(o.strings.AttachmentReadyReadoutValue,t.attachment.fileName);t.fieldIsGlobalEdit=!t.editor.fieldsManager.interactiveSave.peek();t.attachment.serverUrl&&(t.attachmentServerUrl=n.canonicalizeDecodedUrl(t.attachment.serverUrl)+"?web=1");return t}return e}(i.default);t.default=s});define("Xj",[],function(){return'<div class=ms-Attachment data-bind="attr:{ title: tooltip }, css: {\'ms-Attachment--inEdit\': fieldIsEdit }">\x3c!--ko if: attachment.uploaded--\x3e<span class=ms-attachment-text--uploaded data-bind="css: {\'ms-attachment-text-inEdit\': fieldIsEdit, \'ms-attachment-text-inDisplay\': !fieldIsEdit}"><a data-bind="attr:{ href: attachmentServerUrl }, text: attachment.fileName, click: editor.onAttachmentLinkClick.bind(editor, attachmentServerUrl), clickBubble: false"></a></span>\x3c!--/ko--\x3e\x3c!--ko ifnot: attachment.uploaded--\x3e<span class=ms-attachment-text--nativeFile data-bind="attr:{ title: attachment.nativeFile.name }, text: attachment.nativeFile.name"></span>\x3c!--/ko--\x3e\x3c!--ko if: !attachment.uploaded && fieldIsGlobalEdit--\x3e<span role=alert class=ms-accessible data-bind="text: addReadyReadout"></span>\x3c!--/ko--\x3e\x3c!--ko if: fieldIsEdit--\x3e<a class=ms-Attachment--remove href=javascript:; data-bind="click: editor.removeAttachment.bind(editor), keyboard: { Enter: editor.removeAttachment }, attr: {\'aria-label\': removeLabel}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></a>\x3c!--/ko--\x3e</div>'});define("Xi",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-Attachment{font-size:14px}.ms-Attachment--inEdit{margin:4px;white-space:nowrap;line-height:32px}.ms-attachment-text--uploaded+.ms-Attachment--remove{background-color:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}.ms-Attachment--remove{height:32px;width:32px;display:inline-block;text-align:center}.ms-Attachment--remove:hover{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}.ms-attachment-text--uploaded{overflow:hidden;text-overflow:ellipsis;display:inline-block;vertical-align:top}.ms-attachment-text--uploaded.ms-attachment-text-inEdit{background-color:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:";padding-left:5px;padding-right:5px;max-width:160px}.ms-attachment-text--uploaded.ms-attachment-text-inDisplay{width:100%}.ms-attachment-text--nativeFile{overflow:hidden;text-overflow:ellipsis;vertical-align:top;max-width:180px;display:inline-block}"}])});define("Xf",[],function(){return'<div class=ms-attachments-edit-container tabindex=-1>\x3c!--ko foreach: attachments--\x3e\x3c!--ko component: {\r\n\t\t\tname: $parent.attachmentsRenderInFormTagName,\r\n\t\t\tparams: {attachment: $data, fieldIsEdit: true, attachmentEditor: $parent}\r\n\t\t}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=sp-AttachmentUploadContainer><input class=sp-AttachmentUploadInput data-bind="event:{change: handleFilesSelection}, attr:{title: strings.attachFiles }, element: attachmentInputElement" type=file name=attachmentFiles multiple> <button class=sp-AttachmentUploadButton data-bind="text: strings.addAttachments, click: clickFileInput"></button></div></div>\x3c!--ko foreach: errors--\x3e<div aria-live=assertive class=PeoplePicker-error data-bind="text: $data"></div>\x3c!--/ko--\x3e\x3c!--ko component: { name: dialogHostTagName }--\x3e\x3c!--/ko--\x3e'});define("Xe",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-attachments-edit-container{overflow:auto;min-height:inherit;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.ms-attachments-edit-container:focus{outline:1px solid transparent;border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.sp-AttachmentUploadContainer{padding:4px 32px 4px 4px}html[dir=rtl] .sp-AttachmentUploadContainer{padding:4px 4px 4px 32px}.sp-AttachmentUploadInput{display:none}.sp-AttachmentUploadButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:';text-decoration:none;cursor:pointer;background:0 0;border:none;padding:0;cursor:pointer;font-size:14px;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif}.sp-AttachmentUploadButton:focus,.sp-AttachmentUploadButton:hover{color:'},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.sp-AttachmentUploadButton:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}])});define("We",["require","exports","ap","aq","Wk","dZ","U","cL","bW","cI","cJ","aM","Wd","Wj","jJ","Wi","cU","ON","cp","Wh","hs","by","Wg","Wf"],function(a,e,t,s,i,l,r,o,d,c,u,p,m,h,f,g,y,v,_,b,x,S){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(n){t.__extends(e,n);function e(e){var r=n.call(this,e)||this;r.controlHtml=a("Wg");r.overlayTagName=_.default.tagName;r._schema=r.field.schema;r._urlDataSource=r.fieldsManager.resources.consume(l.url);r._platform=r.resources.consume(S.platformDetection);r._iframeBaseUrl=r._getDateTimeIframeControlBaseUrl();r.dateTimePickerOpen=s.observable(!1);r.timeDropdownMenuOpen=s.observable(!1);r.dismissOnResize=!r._platform.isMobile;r.iframeElement=s.observable(null);r.inputElement=s.observable(null);r.dateOnly=0===r._schema.DisplayFormat;r.timeInputElement=s.observable(null);r.isTimeInputFocused=s.observable(!1);r.selectionModel=new f.default({getItemKey:function(e){return e&&e.display||null},mode:1});r.timeChoices=s.observableArray([]);r.selectionModel.setItems([],!0);r.layout=s.observable(new h.default({choices:r.timeChoices}));var t=r._parseDate(r.field.data());r.dateValue=s.observable(t.Date);r.dateTimeControlIframeUrl=s.observable("");if(!r.dateOnly){r._isAMPMFirst=null;r._populateTimeChoiceArray();var i=r._schema.HoursOptions[Number(t.Hour)];if(r._schema.HoursMode24||!1!==r._isAMPMFirst){-1===i.indexOf(r._schema.TimeSeparator)&&(i+=r._schema.TimeSeparator);i+=t.Minute}else{var o=i.split(" ");i=o[0]+r._schema.TimeSeparator+t.Minute+" "+o[1]}r._initialTimeValue=i;r.timeValue=s.observable(i)}r.inlineEdit=!0;r.inlineSave=!0;r.invertLabel=!0;r.addBindingHandlers({element:d.default,dismiss:c.default,keyboard:u.default,selection:g.default,scrollContainer:y.default,scrollIntoView:v.default});r.openCalendarButtonLabel=b.strings.openCalendarButtonLabel;r.openTimeButtonLabel=b.strings.openTimeButtonLabel;r.timeInputLabel=b.strings.timeInputLabel;r.dateInputLabel=b.strings.dateInputLabel;r.datePlaceHolder=b.strings.datePlaceHolder;r.timePlaceHolder=b.strings.timePlaceHolder;r.fieldsManager.interactiveSave.peek()||r.subscribe(r.isWriteFocused,function(e){e||r.timeDropdownMenuOpen(!1)});r.beforeSave=function(){var e=r._getLatestDateTimeValue();e&&r.field.serverData&&new Date(e).getTime()===new Date(r.field.serverData).getTime()?r.field.data(r.field.serverData):r.field.data(e);return!0};r.subscribe(r.iframeElement,function(e){if(e){e.resultfield||(e.resultfield=r.inputElement());void 0===e.firstUp&&(e.firstUp=!0);e.OnSelectDateCallback||(e.OnSelectDateCallback=function(e,t,i){r.dateValue(t);r.closeDatePicker()})}});r.subscribe(r.dateTimePickerOpen,function(e){if(e){r.timeDropdownMenuOpen(!1);r.dateTimeControlIframeUrl(r._getDateTimeIframeControlUrl())}else r.isSelected(!0)});r.subscribe(r.isSelected,function(e){e&&r.timeDropdownMenuOpen(!1)});r.subscribe(r.isEdit,function(e){!1===e&&r.timeDropdownMenuOpen(!1)});r.createComputed(function(){var e=r.selectionModel.selection();0<e.length&&r.timeValue(e[0].display)});return r}e.prototype.closeDatePicker=function(){this.dateTimePickerOpen(!1);return!0};e.prototype.toggleDateTimePicker=function(){this.dateTimePickerOpen(!this.dateTimePickerOpen());return!1};e.prototype.selectChoice=function(e){this.selectionModel.setItemSelected(e,!0);this.timeValue(e.display);this.timeDropdownMenuOpen(!1)};e.prototype.onEnter=function(e,t){if(this.timeDropdownMenuOpen.peek()){this.timeDropdownMenuOpen(!1);this.fieldsManager.interactiveSave.peek()&&this.saveChanges()}else this._openAndSelect();return!1};e.prototype.onEsc=function(){this.selectionModel.clear(!0);this.timeValue(this._initialTimeValue);if(this.fieldsManager.interactiveSave.peek())return!0;this.timeDropdownMenuOpen(!1);return!1};e.prototype.onUp=function(){this._openAndSelect();0===this.selectionModel.getFocusIndex()&&this.isTimeInputFocused(!0);return!1};e.prototype.onDown=function(){this._openAndSelect();return!1};e.prototype.toggleDropdownMenu=function(){this.timeDropdownMenuOpen.peek()?this.timeDropdownMenuOpen(!1):this._openAndSelect();this.isTimeInputFocused(!0);return!1};e.prototype.setDefaultValueTyped=function(e){if(e){var t=e.match(/[0-9]+/);if(1===t.length){var i=Number(t[0]),r=this._adjustTimeZoneDifferenceForDefaultValue(i),o=new Date(r);if("Invalid Date"!==o.toString()){var n=this._getFullDisplayDate(o);this.field.data(n)}}}};e.prototype.setDefaultValue=function(e){if(e){var t=x.iso8601DateTimeToJsDate(e);if(t){var i=this._getFullDisplayDate(t);this.field.data(i)}else this.field.data(e)}};e.prototype._adjustTimeZoneDifferenceForDefaultValue=function(e){var t=e;if(this.field.schema&&this.field.schema.TimeZoneDifference){var i=this._convertTimeZoneDifference(this.field.schema.TimeZoneDifference),r=-60*(new Date).getTimezoneOffset()*1e3;isNaN(i)||(t+=r-i)}return t};e.prototype._convertTimeZoneDifference=function(e){var t=e.split(":"),i=NaN;3===t.length&&(i=1e3*(3600*Number(t[0])+60*Number(t[1])+Math.round(Number(t[2]))));return i};e.prototype._getLatestDateTimeValue=function(){var e=this.dateValue.peek().trim();if(!this.dateOnly){var t=this._schema.HoursMode24?this.timeValue.peek():this._convertTimeTo24Hour(this.timeValue);e=""===e?"":e+" "+t}return e};e.prototype._convertTimeTo24Hour=function(e){var t=e.peek().toUpperCase(),i=this._AMDesignator.toUpperCase(),r=this._PMDesignator.toUpperCase(),o=t.indexOf(i),n=t.indexOf(r);if(-1!==o){var a=(t=t.replace(i,"")).split(":");if(12===(s=Number(a[0]))){a[0]=String(0);t=a.join(":")}}else if(-1!==n){var s;a=(t=t.replace(r,"")).split(":");if(12!==(s=Number(a[0]))){a[0]=String(s+12);t=a.join(":")}}return t.replace(/\s+/g,"")};e.prototype._parseDate=function(e){var t={Hour:"0",Minute:"00",Date:e?e.trim():""};if(!e)return t;var i=e.lastIndexOf(this._schema.TimeSeparator);if(-1===i||i===e.length-1)return t;var r=e.substring(i+1),o=Number(r);if(isNaN(o))return t;t.Minute=o<10?"0"+String(o):r;var n=e.substring(0,i),a=n.lastIndexOf(" ");if(-1===a||a===n.length-1)return t;var s=n.substring(a+1);if(isNaN(Number(s)))return t;t.Hour=s;t.Date=n.substring(0,a);return t};e.prototype._getDateTimeIframeControlUrl=function(){this._iframeBaseUrl||(this._iframeBaseUrl=this._getDateTimeIframeControlBaseUrl());return this._iframeBaseUrl+"&date="+p.default.encodeURIComponent(this.dateValue())};e.prototype._getDateTimeIframeControlBaseUrl=function(){var e=this._schema;return this._urlDataSource.getDateTimeControlIframeUrl()+"?cal="+r.default.encodeText(String(e.CalendarType))+"&lcid="+r.default.encodeText(String(e.LocaleId))+"&langid="+r.default.encodeText(String(e.LanguageId))+"&&tz="+r.default.encodeText(String(e.TimeZoneDifference))+"&ww="+r.default.encodeText(String(e.WorkWeek))+"&fdow="+r.default.encodeText(String(e.FirstDayOfWeek))+"&fwoy="+r.default.encodeText(String(e.FirstWeekOfYear))+"&hj="+r.default.encodeText(String(e.HijriAdjustment))+"&swn="+r.default.encodeText(String(e.ShowWeekNumber))+"&minjday="+r.default.encodeText(String(e.MinJDay))+"&maxjday="+r.default.encodeText(String(e.MaxJDay))};e.prototype._getLocale=function(){if(!this._validLocale)try{(new Date).toLocaleDateString(o.default.language);this._validLocale=o.default.language}catch(e){try{(new Date).toLocaleDateString(navigator.language);this._validLocale=navigator.language}catch(e){this._validLocale="en"}}return this._validLocale};e.prototype._getFullDisplayDate=function(e){var t=this._getLocale(),i=e.toLocaleDateString(t,{})+" "+e.toLocaleTimeString(t,{hour:"2-digit",minute:"2-digit",hour12:!1});return i=(i=i.replace(/\u200E/g,"")).replace(/\u200F/g,"")};e.prototype._openAndSelect=function(){this.timeDropdownMenuOpen(!0);var e=-1,t=!1,i=this.selectionModel.getItems(),r=this.selectionModel.selection.peek();if(r&&1===r.length)for(var o=0;o<i.length;o++)if(i[o]===r[0]){e=o;t=!0;break}(e<0||e===i.length)&&(e=this.selectionModel.getFocusIndex());e<0&&(e=0);this.selectionModel.focusedItem(null);this.selectionModel.setIndexFocus(e);this.selectionModel.setIndexSelected(e,t)};e.prototype._populateTimeChoiceArray=function(){var e=[];if(this._schema.HoursMode24)for(var t=0,i=this._schema.HoursOptions;t<i.length;t++){var r=i[t];e.push(new m.Choice(r+"00",r+"00"));e.push(new m.Choice(r+"30",r+"30"))}else for(var o=this._schema.TimeSeparator,n=0;n<this._schema.HoursOptions.length;n++){var a=(r=this._schema.HoursOptions[n]).split(" ");null===this._isAMPMFirst&&(isNaN(parseInt(a[0],10))?this._isAMPMFirst=!0:this._isAMPMFirst=!1);0===n&&(this._AMDesignator=this._isAMPMFirst?a[0]:a[1]);12===n&&(this._PMDesignator=this._isAMPMFirst?a[0]:a[1]);e.push(new m.Choice(this._isAMPMFirst?r+o+"00":a[0]+o+"00 "+a[1],n+o+"00"));e.push(new m.Choice(this._isAMPMFirst?r+o+"30":a[0]+o+"30 "+a[1],n+o+"30"))}this.timeChoices(e);this.selectionModel.setItems(e,!0);for(var s=0,l=e;s<l.length;s++){var d=l[s];this.selectionModel.registerSelectable(d.display,d)}};return e}(i.default);e.default=n});define("Wg",[],function(){return"<div class=od-DateTimeEditor><div class=od-DateTimeEditor-Date><input class=od-TextField-field data-bind=\"attr: { 'aria-describedby': inputElementId, placeholder: datePlaceHolder, 'aria-label': dateInputLabel }, element: inputElement, textInput: dateValue, hasFocus: isSelected, css: { 'is-active': dateTimePickerOpen }\"> <span data-bind=\"dismiss: { close: closeDatePicker, dismissOnResize: dismissOnResize, dismissOnScroll: true }\"><button aria-haspopup=true class=od-DateTimeEditor-action data-bind=\"click: toggleDateTimePicker, keyboard: { mappings: { Enter: toggleDateTimePicker, Space: toggleDateTimePicker }, context: $data }, attr: { 'aria-label': openCalendarButtonLabel, 'aria-expanded': dateTimePickerOpen().toString() }\"><i class=\"od-DateTimeEditor-icon ms-Icon ms-Icon--Calendar\" data-bind=\"icon: true\"></i></button>\x3c!--ko if: dateTimePickerOpen--\x3e<div data-bind=\"component: { name: overlayTagName, params: { alignToParent: true }}\"><iframe class=od-DateTimeEditor-iFrame frameborder=0 scrolling=no data-bind=\"attr: {src: dateTimeControlIframeUrl()}, element: iframeElement\"></iframe></div>\x3c!--/ko--\x3e</span></div>\x3c!--ko ifnot: dateOnly--\x3e<div class=od-DateTimeEditor-Time data-bind=\"keyboard: { allowInputEvents: true, allowButtonEvents: true, mappings: { Enter: onEnter, Up: onUp, Esc: onEsc } }\"><input class=od-TextField-field data-bind=\"element: timeInputElement, textInput: timeValue, hasFocus: isTimeInputFocused, attr: { 'aria-label': timeInputLabel, placeholder: timePlaceHolder, 'aria-describedby': inputElementId }, keyboard: { mappings: { Down: onDown }, context: $data, allowInputEvents: true }, click: toggleDropdownMenu\"> <i class=\"od-DateTimeEditor-icon ms-Icon ms-Icon--ChevronDown\" tabindex=-1 data-bind=\"icon: true, click: toggleDropdownMenu\"></i>\x3c!--ko if: timeDropdownMenuOpen--\x3e<ul class=ms-ContextualMenu tabindex=-1 role=listbox data-bind=\"scrollContainer: {}, foreach: { data: timeChoices, as: 'choice' }, css: {'is-open': timeDropdownMenuOpen}, selection: { items: timeChoices, layout: layout, selectionModel: selectionModel }\"><li class=od-ContextualMenu-item role=option data-bind=\"css: { 'is-focused': choice.isFocused }, scrollIntoView: { isSelected: choice.isFocused }, hasFocus: choice.isFocused, attr: { tabindex: choice.isFocused()? '0': '-1', 'aria-label': choice.display, 'aria-selected': choice.isSelected }\"><a class=od-ContextualMenu-link href=javascript:; tabindex=-1 data-bind=\"event: { click: $parent.selectChoice.bind($parent) }, css: { 'is-selected': choice.isSelected, 'is-focused': choice.isFocused }, attr: { title: choice.display }\"><span class=od-ContextualMenu-linkText data-bind=\"text: choice.display\"></span></a></li></ul>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>"});define("Wf",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}[dir=ltr] .od-FieldEditor-controlContainer.is-editing .od-DateTimeEditor .od-TextField-field{padding-left:12px}[dir=rtl] .od-FieldEditor-controlContainer.is-editing .od-DateTimeEditor .od-TextField-field{padding-right:12px}[dir=ltr] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .od-DateTimeEditor .od-TextField-field{padding-left:0}[dir=rtl] .od-ListItemFormRoot .od-FieldEditor-controlContainer.is-editing .od-DateTimeEditor .od-TextField-field{padding-right:0}.od-DateTimeEditor-iFrame{width:200px;position:absolute}.od-DateTimeEditor-action{position:absolute;width:32px;height:32px;line-height:30px;top:0;text-align:center;cursor:pointer;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";background:0 0;border:0}[dir=ltr] .od-DateTimeEditor-action{right:2px}[dir=rtl] .od-DateTimeEditor-action{left:2px}.od-DateTimeEditor-action:focus,.od-DateTimeEditor-action:hover{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-DateTimeEditor-icon.ms-Icon--ChevronDown{cursor:pointer;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px;position:absolute;top:0;line-height:32px}[dir=ltr] .od-DateTimeEditor-icon.ms-Icon--ChevronDown{right:12px}[dir=rtl] .od-DateTimeEditor-icon.ms-Icon--ChevronDown{left:12px}.od-DateTimeEditor-icon.ms-Icon--ChevronDown:focus{outline:1px solid transparent}.od-DateTimeEditor-icon.ms-Icon--Calendar{position:relative;top:-2px;font-size:12px}.od-DateTimeEditor .ms-ContextualMenu.is-open{width:100%;height:240px;overflow-y:auto;box-shadow:none;border-top:0}.od-DateTimeEditor .od-ContextualMenu-item:focus{outline:1px solid transparent}.od-DateTimeEditor .od-ContextualMenu-link{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-DateTimeEditor .od-TextField-field::-ms-clear{display:none}.od-DateTimeEditor-Date,.od-DateTimeEditor-Time{position:relative}.od-DateTimeEditor-Date .od-TextField-field.is-active{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-DateTimeEditor-Time{margin-top:8px}"}])});define("Wa",["require","exports","ap","XL","Wd","Wc","Wb"],function(e,t,i,r,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){i.__extends(e,t);function e(e){var r=t.call(this,e)||this;r.beforeSave=function(){r.isOpen(!1);var e=r.selectionModel.selection.peek();if(e&&1===e.length){var t=r.field.serverData,i=JSON.parse(e[0].value);t&&t.displayName===i.displayName?r.field.data(t):r.field.data(i)}return!0};return r}e.prototype.selectChoice=function(e){this.selectionModel.setItemSelected(e,!0);this.switchContentType();this.fieldsManager.interactiveSave.peek()?this.saveChanges():this.isOpen(!1)};e.prototype.onEnter=function(e,t){this.switchContentType();this.fieldsManager.interactiveSave.peek()?this.saveChanges():this.isOpen(!1);return!1};e.prototype.populateChoiceArray=function(e){this.dataPopulated=!0;this.contentTypes=e.contentTypes;for(var t=e.field.data.peek(),i=[],r=null,o=0;o<this.contentTypes.length;o++){var n=this.contentTypes[o],a=new c.Choice(n.displayName,JSON.stringify(n));i.push(a);this.choiceHash[a.value]=a;this.addToCharChoicesHash(a);n.displayName===t.displayName&&(r=a)}this.choices(i);this.selectionModel.setItems(i,!0);for(var s=0,l=i;s<l.length;s++){var d=l[s];this.selectionModel.registerSelectable(c.ChoiceEditorHelper.getItemKey(d),d)}this.selectionModel.setItemSelected(r,!0)};e.prototype.switchContentType=function(){var e=this.selectionModel.selection.peek();if(e&&1===e.length&&!this.fieldsManager.interactiveSave.peek()){var t=JSON.parse(e[0].value);this.fieldsManager.switchContentType(t)}};return e}(r.default);t.default=o});define("V8",["require","exports","ap","hc","aM","dJ"],function(e,t,i,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getSuggestions=function(e,t){var r=this;return this.getData(function(){return r._pageContext.webAbsoluteUrl+"/_vti_bin/TaxonomyInternalService.json/GetSuggestions"},function(e){var t=JSON.parse(e);if(0===t.d.Groups.length)return[];var i=t.d.Groups[0].Suggestions;return r.transformSuggestionData(i)},"TaxonomySuggestion",function(){return r.constructSuggestionPostBody(e,t)})};t.prototype.getMatches=function(e,t){var i=this;return this.getData(function(){return i._pageContext.webAbsoluteUrl+"/_vti_bin/TaxonomyInternalService.json/GetMatches"},function(e){var t=JSON.parse(e).d.Matches;return i.transformMatchData(t)},"TaxonomyMatch",function(){return i.constructMatchPostBody(e,t)})};t.prototype.getTaxonomyTreeUrl=function(e,t,i){var r=a.default.escapeUrlForCallback(this._pageContext.webAbsoluteUrl),o=a.default.escapeUrlForCallback(this._pageContext.layoutsUrl),n={Field:t.name,IsDlg:1,lcid:i.lcid,sspIds:i.sspList,termSetIds:i.termSetList,anchorGuid:i.anchorId,fieldName:t.name,fieldId:t.id,IsMulti:t.isMulti,tags:e,allowFillIn:i.allowFillIn,webServiceUrl:i.webServiceUrl,isAddTerms:i.isAddTerms,isIgnoreFormatting:!1,isIncludeDeprecated:i.isIncludeDeprecated,isIncludePathData:i.isIncludePathData,isIncludeTermSetName:i.isIncludeTermSetName,isIncludeUnavailable:i.isIncludeUnavailable,isSpanTermSets:i.isSpanTermSets,isSpanTermStores:i.isSpanTermStores,isUseCommaAsDelimiter:i.isUseCommaAsDelimiter};return r+"/"+o+"/WebTaggingDialog.aspx?"+s.serializeQuery(n)};t.prototype.getDataSourceName=function(){return"TaxonomyDataSource"};t.prototype.transformSuggestionData=function(e){var r=this;return e.map(function(e){var t={label:e.DefaultLabel,description:e.Description,termId:e.Id,isKeyword:e.IsKeyword,paths:e.Paths,rawSynonyms:e.Synonyms,synonyms:r.processSynonymsData(e.Synonyms),isValid:!0},i={completions:e.Completions,starts:e.Starts,isSynonym:e.IsSynonym};return{term:t,isSynonym:i.isSynonym,start:i.starts?i.starts[0]:null,completions:i.completions}})};t.prototype.transformMatchData=function(e){return e.map(function(e){var t={label:e.DefaultLabel,termId:e.Id,isAmbiguous:e.IsAmbiguous,disambiguationData:[]};if(t.isAmbiguous){var i=e.DisambiguationData;t.disambiguationData=i.map(function(e){return{label:e.DefaultLabel,description:e.Description,termId:e.Id,isSynonym:e.IsSynonym,paths:e.TermsetAndPaths,synonyms:e.Synonyms}})}return t})};t.prototype.processSynonymsData=function(e){var t=[];e&&0<e.length&&(t=e.split(";").map(function(e){return e.trim()}).filter(function(e){return e&&0<e.length}));return t};t.prototype.constructSuggestionPostBody=function(e,t){var i={start:e,lcid:t.lcid,sspList:t.sspList,termSetList:t.termSetList,anchorId:t.anchorId,isSpanTermStores:t.isSpanTermStores,isSpanTermSets:t.isSpanTermSets,isIncludeUnavailable:t.isIncludeUnavailable,isIncludeDeprecated:t.isIncludeDeprecated,isAddTerms:t.isAddTerms,isIncludePathData:t.isIncludePathData,excludeKeyword:t.excludeKeyword,excludedTermset:t.excludedTermset};return JSON.stringify(i)};t.prototype.constructMatchPostBody=function(e,t){var i={terms:e,lcid:t.lcid,SSPList:t.sspList,termSetList:t.termSetList,anchorId:t.anchorId,isSpanTermStores:t.isSpanTermStores,isSpanTermSets:t.isSpanTermSets,isIncludeUnavailable:t.isIncludeUnavailable,isIncludeDeprecated:t.isIncludeDeprecated,isAddTerms:t.isAddTerms,isIncludeTermSetName:t.isIncludeTermSetName,isIncludePathData:t.isIncludePathData,isUseCommaAsDelimiter:t.isUseCommaAsDelimiter};return JSON.stringify(i)};return t}(r.default);t.default=o});define("V7",["require","exports","ap","bN","aC","dZ"],function(e,t,r,i,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t.dataSource=t.resources.consume(o.taxonomy);t.matchResult={promise:null};t.suggestionResult={promise:null};return t}e.prototype.getSuggestions=function(e,r){var o=this,n=null;this.suggestionResult.promise=new a.default(function(t,i){n=o.dataSource.getSuggestions(e,r).then(function(e){t(e)},function(e){i(e)})},function(){n&&n.cancel()});return this.suggestionResult};e.prototype.getMatches=function(e,t){this.matchResult.promise=this.dataSource.getMatches(e,t).then(function(e){return e},function(e){throw e});return this.matchResult};return e}(i.default);t.default=n});define("V6",["require","exports","ap","aC","hc","eq","fZ","fO"],function(e,t,r,l,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._apiUrlHelper=t.resources.consume(n.resourceKey);t._itemUrlHelper=t.resources.consume(a.resourceKey);return t}e.prototype.getAttachments=function(e){var r=this;return this.getData(function(){return r.buildAttachmentBaseUrl(e).toString()},function(e){var t=JSON.parse(e);if(0===t.d.results.length)return[];var i=t.d.results;return r.transformAttachmentData(i)},"Attachments")};e.prototype.addAttachment=function(n,a){var s=this;return new l.default(function(i,r){var o=new FileReader;o.onload=function(e){var t=o.result;s.doUploadAttachment(n,a.name,t).then(i,r)};o.readAsArrayBuffer(a)},function(){})};e.prototype.deleteAttachment=function(i,r,o){var n=this;return new l.default(function(e,t){n.doDeleteAttachment(i,r,o||!1).then(e,t)},function(){})};e.prototype.getDataSourceName=function(){return"AttachmentDataSource"};e.prototype.buildAttachmentBaseUrl=function(e,t){var i=this._itemUrlHelper.getItemUrlParts(e.key),r=this._apiUrlHelper.build().webByItemUrl(i).method("GetList",i.serverRelativeListUrl).method("Items",e.properties.ID);return r=t?r.method("AttachmentFiles",t):r.segment("AttachmentFiles")};e.prototype.transformAttachmentData=function(e){var t=this;return e.map(function(e){return{fileName:e.FileName,serverUrl:o.getServerUrl(t._pageContext)+e.ServerRelativeUrl,uploaded:!0}})};e.prototype.doUploadAttachment=function(e,o,t){var n=this;return this.getData(function(){return n.buildAttachmentBaseUrl(e).methodWithAliases("addUsingPath",{decodedUrl:o}).toString()},function(e){var t=JSON.parse(e);if(!t.d)return!1;var i=[t.d],r=n.transformAttachmentData(i);return 1===r.length&&r[0].fileName===o},"UploadAttachment",function(){return t})};e.prototype.doDeleteAttachment=function(e,t,i){var r=this;return this.getData(function(){return r.buildAttachmentBaseUrl(e,t).segment(i?"DeleteObject":"RecycleObject").toString()},function(e){try{var t=JSON.parse(e);return i&&void 0!==t.d.DeleteObject||!i&&void 0!==t.d.RecycleObject}catch(e){return!1}},i?"DeleteAttachment":"RecycleAttachment")};return e}(i.default);t.default=s});define("V4",[],function(){return'<div class=od-ClientForm data-bind="scrollIntoView: { isSelected: scrollToClientFormTop, containerToTop: true, smooth: true }, css: { \'is-bulkEdit\': clientForm.isBulkEdit }">\x3c!--ko if:hasServerError--\x3e<div class="od-ClientForm-error ms-bgColor-neutralLight" role=alert><span class="ms-font-m ms-fontColor-error" data-bind="text: ServerErrorTitle"></span> <span class="ms-font-m ms-fontColor-neutralSecondary" data-bind="text: serverErrorDetails"></span></div>\x3c!--/ko--\x3e<div class=od-ClientFormFields>\x3c!--ko if:isLoading--\x3e<div class=od-ClientFormFields-loadingSpinner data-bind="component: { name: loadingSpinnerTagName }"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:isLoading--\x3e\x3c!--ko ifnot:showNoCommonPropertiesMessage--\x3e<div class=od-ClientFormFields-fieldsContainer>\x3c!--ko foreach:children--\x3e<div class=od-ClientFormFields-field data-bind="visible: isVisible, bindableHtml: fullHtml, automationType:\'clientFormField\'"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:showNoCommonPropertiesMessage--\x3e<div class="ms-font-m od-ClientFormFields-noCommonPropertiesMessage" data-bind="text: BulkEditNoCommonPropertiesMessage"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:!interactiveSave() && !showNoCommonPropertiesMessage()--\x3e<div class="od-ClientForm-editButtonsContainer od-Dialog-actionsLeft">\x3c!--ko ifnot: clientForm.isBulkEdit--\x3e<button class="od-Dialog-action od-Button od-Button--primary" data-automationid=clientFormSaveButton data-bind="event: { click: onSaveClick }, attr: { disabled: isSaving }">\x3c!--ko ifnot:isSaving--\x3e<span data-bind="text: saveLabel" class=od-Button-label></span>\x3c!--/ko--\x3e\x3c!--ko if:isSaving--\x3e<span class=od-Dialog-actionsLoading data-bind="component: { name: loadingSpinnerTagName, params: { loadingText: \'\' } }"></span>\x3c!--/ko--\x3e</button> <button class="od-Dialog-action od-Button od-Button--secondary" data-bind="event: { click: onCancelClick }"><span data-bind="text: cancelLabel" class=od-Button-label></span></button>\x3c!--/ko--\x3e\x3c!--ko if: clientForm.isBulkEdit--\x3e<button class="od-Dialog-action od-Button od-Button--primary" data-automationid=clientFormSaveButton data-bind="event: { click: onSaveClick }, attr: { disabled: isSaving }"><span data-bind="text: saveLabel" class=od-Button-label></span></button>\x3c!--ko if:isSaving--\x3e<div class=od-ClientForm-savingSpinner data-bind="component: {name: loadingSpinnerTagName, params: {loadingText: savingStateText}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:isSaved--\x3e<i class="od-ClientForm-stateCheck ms-Icon ms-Icon--CheckMark" data-bind="icon: true"></i><span data-bind="text: savedStateText"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isSaving--\x3e<span role=alert class=ms-accessible data-bind="text: itemSavingReadoutText"></span>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});define("V3",["c","az"],function(e,t){e.loadStyles([{rawString:".od-ClientForm,.od-ClientFormFields-fieldsContainer,.od-Dialog .od-ClientFormFields-fieldsContainer{width:100%}.od-Dialog .od-ClientFormFields-fieldsContainer{max-height:800px;overflow-y:scroll}.od-ClientFormFields-field{padding:8px 3px;position:relative}.od-ClientFormFields-loadingSpinner{text-align:center;padding:75px 0}.od-ClientForm-editButtonsContainer{margin-top:20px}.od-ClientForm-editButtonsContainer .od-Dialog-action{vertical-align:middle}.od-Dialog-action.od-Button.od-Button--secondary{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-Dialog-action.od-Button.od-Button--secondary:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.od-Dialog-action.od-Button.od-Button--secondary:active .od-Button-label{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-ListItemFormRoot .od-ClientForm{margin-bottom:16px}.lg .od-ListItemFormRoot .od-ClientForm,.xlg .od-ListItemFormRoot .od-ClientForm,.xxlg .od-ListItemFormRoot .od-ClientForm,.xxxlg .od-ListItemFormRoot .od-ClientForm,.xxxxlg .od-ListItemFormRoot .od-ClientForm{margin-bottom:32px}.od-ListItemFormRoot .od-ClientFormFields-fieldsContainer{max-width:378px}[dir=ltr] .od-ListItemFormRoot .od-ClientFormFields-fieldsContainer .od-FieldEditor-controlContainer .od-TextField-field{padding-left:12px}[dir=rtl] .od-ListItemFormRoot .od-ClientFormFields-fieldsContainer .od-FieldEditor-controlContainer .od-TextField-field{padding-right:12px}.od-ClientForm-error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";margin-top:4px;font-size:12px;transition:height .15s ease;padding:8px 12px;border-left:4px solid #A6A6A6;max-width:372px;width:100%;-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.od-ClientForm-error .od-ClientForm-error--title{font-size:14px}.od-ClientForm.is-bulkEdit{position:absolute;display:-ms-flexbox;display:flex;left:0;right:0;-ms-flex-direction:column;flex-direction:column;overflow:hidden;width:auto}.od-ClientForm.is-bulkEdit .od-FieldEditor-controlContainer .ms-ContextualMenu.is-open{box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";max-height:none}.od-ClientForm.is-bulkEdit .od-ClientFormFields{overflow-y:auto;padding:0 16px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-ClientForm.is-bulkEdit .od-ClientForm-editButtonsContainer{border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";-ms-flex-positive:0;flex-grow:0;margin-top:0;padding:20px}html[dir=ltr] .od-ClientForm.is-bulkEdit .od-ClientForm-editButtonsContainer .od-Button--secondary{margin-left:4px}html[dir=rtl] .od-ClientForm.is-bulkEdit .od-ClientForm-editButtonsContainer .od-Button--secondary{margin-right:4px}.od-ClientForm.is-bulkEdit .od-ClientForm-stateCheck{margin:0 4px 0 8px;font-size:14px;position:relative;top:2px}html[dir=rtl] .od-ClientForm.is-bulkEdit .od-ClientForm-stateCheck{margin:0 8px 0 4px}.od-ClientForm.is-bulkEdit .od-ClientForm-savingSpinner{display:inline-block}html[dir=ltr] .od-ClientForm.is-bulkEdit .od-ClientForm-savingSpinner{margin-left:8px}html[dir=rtl] .od-ClientForm.is-bulkEdit .od-ClientForm-savingSpinner{margin-right:8px}.od-ClientForm.is-bulkEdit .od-Button--primary:disabled{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-ClientFormFields-noCommonPropertiesMessage{padding-bottom:22px}"}])});define("Ys",["require","exports","b5","Yv","Yu","Yt"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.registerTemplate("ms-item-tile-album",e("Yv"));i.registerTemplate("ms-item-tile-tag",e("Yt"));i.registerTemplate("ms-item-tile-discover",e("Yu"))});define("Yv",[],function(){return'<div class=ItemTile-image data-bind="component: { name: \'od-folder-cover-tile\', params: { item: item, imageRect: imageRect, pulseTarget: pulseTarget } }"></div><div class=ItemTile-dragDropIcon></div><div class=ItemTile-namePlate><div class=ItemTile-name data-bind="text: item().name"></div><div class=ItemTile-childCount data-bind="text: childCount"></div><div class=ItemTile-date data-bind="text: dateText"></div></div>\x3c!--ko if: button--\x3e<button class=od-ItemTile-button data-bind="attr: { title: button.title }, click: onButtonClick"><span class=od-ItemTile-buttonIcon data-bind="component: { name: \'od-icon-glyph\', params: { icon: button.icon } }"></span></button>\x3c!--/ko--\x3e'});define("Yu",[],function(){return'<div class=ItemTile-discoverFileContainer>\x3c!--ko if: hasThumbnail--\x3e\x3c!--ko component: {\r\n name: imageFrameTagName,\r\n params: {\r\n image: thumbnail,\r\n desiredSize: imageRect,\r\n alignment: \'cover\',\r\n isLoaded: isThumbnailLoaded,\r\n error: thumbnailError\r\n }\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=ItemTile-fileIconContainer><div class=ItemTile-fileIcon data-bind="css: { \'ItemTile-fileIcon--thumbnail\': hasThumbnail(), \'ItemTile-fileIcon--noThumbnail\': !hasThumbnail() }, component: { name: \'ms-file-type-icon\', params: { iconName: item().iconName, iconSize: iconSize(), desiredSize: desiredSize() } }"></div></div><div class=ItemTile-namePlate><div class=ItemTile-name data-bind="text: item().displayName"></div><div class=ItemTile-subText><div class=ItemTile-entity-container><img class=ItemTile-entity data-bind="attr:{src: item().editorProfilePicUrl}, visible: showPerson()"><div class=ItemTile-entity data-bind="visible: !showPerson()"><i class="Icon-main ms-Icon" data-bind="icon: true, css: { \'ms-Icon--Chart\' : item().viewersCount > 1, \'ms-Icon--FavoriteStarFill\': !item().viewersCount }"></i></div></div><div class=ItemTile-longText data-bind="text: subText"></div><div class="ItemTile-viewerCount ItemTile-entity-container" data-bind="visible: !showPerson() && !!item().viewersCount"><i class="ms-Icon ms-Icon--View" data-bind="icon: true"></i> <span data-bind="text: item().viewersCount"></span></div></div></div></div>'});define("Yt",[],function(){return'<div class=ItemTile-image data-bind="component: { name: \'od-folder-cover-tile\', params: { item: item, thumbnail: thumbnail, imageRect: imageRect, pulseTarget: pulseTarget } }, dragAndDrop: { mayReceiveDrop: onMayReceiveDrop, isDragging: isDroppingTarget, receiveDrop: onReceiveDrop }"></div><div class=ItemTile-nameCover><div class="ItemTile-tagText ms-fontWeight-regular"><div class=ItemTile-name data-bind="text: item().name"></div>\x3c!--ko if: showTagCount && tagCount() > 0--\x3e<div class=ItemTile-tagCount data-bind="text: tagCount"></div>\x3c!--/ko--\x3e</div></div>'});define("Yw",["require","exports","Yz","b3","Yy","Yx","zk"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"ms-iframe-dialog",name:e("module").id,template:e("Yy"),viewModelType:i.default});t.default=t.resourceKey});define("Yz",["require","exports","ap","bF","YA","ci","aq","d0","dc","cL","zo"],function(e,t,i,o,n,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i.loadingLabel=n.strings.IFrameDialogLoadingLabel;i.progressSpinnerFlatTagName=l.default.tagName;i._isIframeAvailable=!0;i._navigation=t.navigation;i._dialogProvider=t.dialogProvider;i.isLoading=s.observable(!0);i.componentUrl=e.componentUrl;i.showInDialog=e.showInDialog;i.heightOffset=e.heightOffset;i.forceSharePointScrollbar=e.forceSharePointScrollbar;i.maxHeight=e.maxHeight;i.addDisposable({dispose:function(){u.disposeIframe(i._iframeElement,function(){i._isIframeAvailable=!1})}});return i}e.prototype.iframeOnLoad=function(e,t){var i=this;if(this._isIframeAvailable){this._iframeElement=t.target;var r=this._iframeElement;r&&r.contentWindow&&this.async.setTimeout(function(){i.showInDialog&&i._setupIframeElementFunctions(r);i.isLoading(!1);if(!i.maxHeight){r.style.height=document.body.clientHeight*i.heightOffset+"px";i._modifyFramedPageHeight(r)}if(i.forceSharePointScrollbar){var e=r.contentWindow.document.getElementById("s4-workspace");if(e){c.default.isRightToLeft?e.style.paddingLeft="10px":e.style.paddingRight="10px";e.style.boxSizing="border-box"}}},10)}};e.prototype._modifyFramedPageHeight=function(e){var t=e.contentWindow.document.getElementById("s4-workspace");t&&(t.style.height=e.style.height)};e.prototype._setupIframeElementFunctions=function(e){var t=this,i=function(e){t._navigation.navigateTo(e)};e.cancelPopUp=function(){t._dialogProvider.currentDialog().dismiss()};e.commitPopup=function(e){"string"==typeof e&&"{"!==e[0]?i(e):t._dialogProvider.currentDialog().complete()};e.navigateParent=i};e.dependencies=i.__assign({},o.default.dependencies,{dialogProvider:a.resourceKey,navigation:d.navigation});return e}(o.default);t.default=r});define("Yy",[],function(){return'<div class=od-IFrameDialog data-bind="css: { \'od-IFrameDialog--maxHeight\': maxHeight}"><iframe frameborder=0 data-bind="attr: {src: componentUrl}, event: {load: iframeOnLoad}, visible: !isLoading()" style=width:100%></iframe><label class=od-Dialog-subText data-bind="text: loadingLabel, visible: isLoading"></label><div class=od-IFrameDialog-ProgressContainer data-bind="visible: isLoading"><div data-bind="component: {name: progressSpinnerFlatTagName}"></div></div></div>'});define("Yx",["c","az"],function(e,t){e.loadStyles([{rawString:".od-IFrameDialog{border:none;width:100%}.od-IFrameDialog.od-IFrameDialog--maxHeight{position:absolute;height:100%}.od-IFrameDialog.od-IFrameDialog--maxHeight iframe{height:100%}.od-IFrameDialog-ProgressContainer{width:250px;padding:15px 0}"}])});define("YB",["require","exports","ap","bN","bA","f3","i0","iJ","UY","iE","fO"],function(e,t,i,o,r,n,a,s,l,d,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=108e5,p=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._authTokenFetcher=t.authTokenFetcher;i._itemsStore=t.itemsStore;i._pageContext=t.pageContext;i._itemUrlHelper=t.itemUrlHelper;i._tokenList=new Set;i._callTimesCount=0;i._serverLocalTimeDelta=0;setInterval(i._cleanCallTimesCount.bind(i),2*u);return i}e.prototype.trackListToken=function(e){if(!this._tokenList.has(e)){this._tokenList.add(e);if(!this._serverLocalTimeDelta){var t=this._getAccessToken(e);this._serverLocalTimeDelta=this._computeClockSkew(t)}}this._scheduleListTokenCheck()};e.prototype._scheduleListTokenCheck=function(){var e=this;if(this._pageContext.isSPO){var t=this._getRecentExpire();this.async.clearTimeout(this._timeoutId);this._timeoutId=this.async.setTimeout(function(){e._checkListToken()},t)}};e.prototype._getRecentExpire=function(){var r=this,o=u;this._tokenList.forEach(function(e){var t=r._getAccessToken(e),i=t?1e3*Number(n.parseToken(t).exp)-r._getCurrentServerTime()-18e5:u;o=Math.min(i,o)});return o};e.prototype._checkListToken=function(){var o=this;this._tokenList.forEach(function(e){var t=o._itemsStore.getItem(e),i=t&&t.peek(),r=n.parseToken(i&&i.graph&&i.graph.sessionToken&&i.graph.sessionToken.accessToken);if(r&&1e3*Number(r.exp)-o._getCurrentServerTime()<18e5){if(o._callTimesCount<10){o._updateListToken(e);o._callTimesCount=Number(o._callTimesCount)+1}}else o._scheduleListTokenCheck()})};e.prototype._updateListToken=function(e){var t=this;this._authTokenFetcher.getAuthToken(e,this._pageContext,this._itemUrlHelper).then(function(){t._scheduleListTokenCheck()})};e.prototype._getAccessToken=function(e){var t=this._itemsStore.getItem(e),i=t&&t.peek();return i&&i.graph&&i.graph.sessionToken&&i.graph.sessionToken.accessToken};e.prototype._computeClockSkew=function(e){return e?1e3*Number(n.parseToken(e).nbf)-Date.now():0};e.prototype._getCurrentServerTime=function(){return Date.now()+this._serverLocalTimeDelta};e.prototype._cleanCallTimesCount=function(){this._callTimesCount=0};e.dependencies=i.__assign({},o.default.dependencies,{authTokenFetcher:l.resourceKey,oAuthTokenProvider:a.resourceKey,itemsStore:s.resourceKey,pageContext:d.pageContext,itemUrlHelper:c.resourceKey});return e}(o.default);t.default=p;t.resourceKey=r.createResolvedResourceKey(e("module").id,p)});define("YC",["require","exports","ap","bN","gl","iE","bA"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e)||this;i._dataRequestor=new t.dataRequestorType({qosName:"MicroserviceEndPointDataSource"});i._pageContext=t.pageContext;return i}e.prototype.getMicroserviceEndPoints=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/microservicemanager/getserviceurls?service='"+e+"'";return this._dataRequestor.getData({url:t,method:"GET",qosName:"GetServiceUrls"}).then(function(e){return e&&e.d&&e.d.GetServiceUrls&&e.d.GetServiceUrls.results&&e.d.GetServiceUrls.results[0]})};e.dependencies={pageContext:n.pageContext,dataRequestorType:o.typeResourceKey};return e}(r.default);t.default=s;t.resourceKey=a.createResolvedResourceKey(e("module").id,s)});define("YD",["require","exports","ap","YE","ef","aC","eq","aI"],function(e,t,i,o,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){this._qos=new s.default({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:s.ResultTypeEnum.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:s.ResultTypeEnum.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:s.ResultTypeEnum.ExpectedFailure,error:JSON.stringify(t)})};return e}(),d=function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e}(),c=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e)||this;i.logger=new d;if(t){t.logger&&(i.logger=t.logger);t.useAbsoluteUrlForOAuth&&(i._useAbsoluteUrlForOAuth=t.useAbsoluteUrlForOAuth)}i._oAuthUtility=new o.default(i);return i}e.prototype.qosMonitor=function(){return new l};Object.defineProperty(e.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:a.getSafeWebServerRelativeUrl(this._pageContext)},enumerable:!0,configurable:!0});e.prototype.fetchWithDigest=function(i){var r=this;return i.text().then(function(e){var t=i.headers.get("Content-Type");i.headers.delete("Content-Type");return r._odspPromiseToEs6Promise(r.getData(function(){return i.url},function(e){return e},"DelegationTokenDataSource",function(){return e},"POST",r._getHeadersDictionary(i),t).then(function(e){return new Response(e,{status:200})},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};e.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};e.prototype._getHeadersDictionary=function(e){var t=e.headers,i={};t.forEach(function(e,t){i[t]=e});return i};e.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,i){e.then(function(e){t(e)},function(e){i(e)})})};e.prototype._es6PromiseToOdspPromise=function(e){return new n.default(function(t,i){e.then(function(e){t(e)},function(e){i(e)})})};return e}(r.default);t.default=c});define("YE",["require","exports","YG","YF"],function(e,t,n,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function d(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()}}d._getCorrelationId=function(e){return e.headers.get("sprequestguid")};d._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};d.prototype.getOAuthToken=function(t,e){var i=this;this._receiveMediaServiceFlushedToken();var r=this._getCachedTokenData(t);return r&&!this._isExpiring(r)?Promise.resolve({token:r.accessToken,isGuest:!1}):this._retriableFetchWithDigest(t,n.default.retries,e).then(function(e){i._storeTokenData(t,e);return{token:e.accessToken,isGuest:!1}})};d.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var i=this._resourceKeys.indexOf(t);!isNaN(i)&&-1<i&&this._resourceKeys.splice(i)};Object.defineProperty(d.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!0,configurable:!0});d.prototype._retriableFetchWithDigest=function(o,n,a){var s=this,l=this._context.qosMonitor();return this._context.fetchWithDigest(this._buildTokenRequest(o,a)).then(function(e){if(200!==e.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+e.statusText);var t=new c.default(c.OAuthUtilityErrorType.unknownError,{httpResponseStatus:e.status,message:e.statusText,correlationId:d._getCorrelationId(e)});if(400!==e.status){l.writeUnexpectedFailure("UnknownError",t);return Promise.reject(t)}return e.json().then(function(e){var t=d._extractRealError(e),i=s._getErrorCodeFromResponseCode(t);if(!s._isRetriableError(i)||0===n){var r=s._buildErrorFromResponse(t);l.writeUnexpectedFailure("SharepointServerError",r);return Promise.reject(r)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(o,n-1,a)})}return s._instrumentedParseResponseData(e,l)})};d.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};d.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};d.prototype._getCacheKey=function(e){var t=["sp-client-shared",n.default.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};d.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<n.default.aboutToExpireIntervalSeconds};d.prototype._isRetriableError=function(e){return-1!==n.default.retriableErrorCodes.indexOf(e)};d.prototype._buildTokenRequest=function(e,t){var i=new Headers;i.append("Content-Type","application/json; charset=utf-8");i.append("Odata-Version","4.0");i.append("Accept","application/json;odata.metadata=minimal");var r={method:"POST",headers:i,body:JSON.stringify(this._buildRequestBody(e))},o=t;o&&o.lastIndexOf("/")===o.length-1&&(o=o.substr(0,o.length-1));return new Request(o+n.default.apiUrl,r)};d.prototype._buildRequestBody=function(e){return{resource:e}};d.prototype._buildErrorFromResponse=function(e){var t,i,r=this._getErrorCodeFromResponseCode(e);if(void 0===r)return new c.default(c.OAuthUtilityErrorType.malformedResponseBody,{httpResponseStatus:400,message:n.default.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;i=e.message.lang}var o="error.redirectUrl";return new c.default(c.OAuthUtilityErrorType.serverError,{httpResponseStatus:400,message:t,cultureName:i,serverErrorCode:r,correlationId:e.correlationId,redirectUrl:e[o]||e["@"+o]})};d.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,i=Number(t);if(isNaN(i)&&"string"==typeof e.message){var r=t.indexOf(",");-1!==r&&(i=Number(t.substr(0,r)))}return i};d.prototype._instrumentedParseResponseData=function(t,i){try{return t.json().then(function(e){i.writeSuccess();return{accessToken:e.access_token,expiresOn:Number(e.expires_on),notBefore:Number(e.not_before),resource:e.resource,tokenType:e.token_type}})}catch(e){i.writeUnexpectedFailure("ResponseParseError",e);return Promise.reject(new c.default(c.OAuthUtilityErrorType.malformedResponseBody,{httpResponseStatus:200,message:n.default.unexpectedTokenMessageFormat,correlationId:d._getCorrelationId(t)}))}};d.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,i=this._resourceKeys;t<i.length;t++){var r=i[t];window.sessionStorage.removeItem(r)}};d.prototype._receiveMediaServiceFlushedToken=function(){var e="_spMSBT";if(window[e]){var t={tokenType:window[e].TokenType,expiresOn:window[e].ExpiresOn,notBefore:void 0,resource:window[e].Resource,accessToken:window[e].AccessToken};this._storeTokenData(t.resource,t);window[e]=void 0}};return d}();t.default=i});define("YG",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e}();t.default=i});__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){r(e,t);function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();define("YF",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"}(i=t.OAuthUtilityErrorType||(t.OAuthUtilityErrorType={}));var r=function(r){__extends(o,r);function o(e,t){var i=r.call(this,t.message)||this;i.__proto__=o.prototype;i._type=e;i._httpResponseStatus=t.httpResponseStatus;i._cultureName=t.cultureName;i._message=t.message;i._serverErrorCode=t.serverErrorCode;i._correlationId=t.correlationId;i._redirectUrl=t.redirectUrl;return i}Object.defineProperty(o.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(o.prototype,"serverErrorCode",{get:function(){if(this.type!==i.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0});Object.defineProperty(o.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0});Object.defineProperty(o.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0});Object.defineProperty(o.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0});Object.defineProperty(o.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0});Object.defineProperty(o.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0});return o}(Error);t.default=r});define("YH",["require","exports","ap","aC","bi","gK","dJ","bN","bA","fZ","fO","gl"],function(e,t,i,o,l,n,d,a,r,s,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._apiUrlHelper=t.apiUrlHelper;i._itemUrlHelper=t.itemUrlHelper;i._dataRequestor=new(i.child(u.typeResourceKey))({qosName:"AppUrlHelper"});return i}e.prototype.getItemUrl=function(a){var s=this._itemUrlHelper.getItemUrlParts(a.key);return o.default.all({web:this._getWebInfo(s),defaultView:this._getDefaultView(s)}).then(function(e){var t,i=s.fullItemUrl,r=new l.default(i),o=d.serializeQuery(((t={}).id=s.serverRelativeItemUrl,t.parent=a.folder?"":/.*\//.exec(s.serverRelativeItemUrl)[0],t));if(e.web.isOneDrive){var n=e.web.webUrl+"/_layouts/15/onedrive.aspx";return""+r.authority+n+"?"+o}return e.defaultView?""+r.authority+e.defaultView+"?"+o:a.openUrl||s.fullItemUrl}).then(void 0,function(){return a.openUrl||s.fullItemUrl})};e.prototype._getDefaultView=function(e){var t=n.canonicalizeDecodedUrl(e.fullItemUrl),i=this._apiUrlHelper.build().webByItemUrl(e).method("GetList",t).segment("DefaultView");return this._dataRequestor.getData({url:i.toString(),method:"GET",qosName:"GetDefaultView",noRedirect:!0}).then(function(e){return e.d.ServerRelativeUrl}).then(void 0,function(){return""})};e.prototype._getWebInfo=function(e){var t=this._apiUrlHelper.build().webByItemUrl(e);return this._dataRequestor.getData({url:t.toString(),method:"GET",qosName:"GetWebByItemUrl",noRedirect:!0}).then(function(e){return{isOneDrive:"SPSPERS"===e.d.WebTemplate,webUrl:e.d.ServerRelativeUrl}}).then(void 0,function(){return{isOneDrive:!1,webUrl:""}})};e.dependencies=i.__assign({},a.default.dependencies,{apiUrlHelper:s.resourceKey,itemUrlHelper:c.resourceKey});return e}(a.default);t.default=p;t.resourceKey=r.createResolvedResourceKey(e("module").id,p)});define("DZ",["require","exports","b5","D2","D1","D0"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-suite-nav",template:e("D1"),viewModel:r.default});t.default=o});define("D2",["require","exports","ap","aq","bF","aN","D3","yk","iD","dc","sk","aI","bX","d7","iE"],function(e,t,i,n,r,a,s,l,d,c,u,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(t,o);function t(e){void 0===e&&(e={});var t=o.call(this,e)||this;t._navigation=t.resources.consume(c.navigation);t._hamburgerCallback=e.hamburgerCallback;t._hamburgerIsUnavailable=e.hamburgerIsUnavailable||n.observable(!1);t._suiteNavRenderedCallback=e.suiteNavRenderedCallback;t._provider=t.resources.consume(l.resourceKey);if(t._provider){t._capabilities=t._provider.getCapabilities();t._dataPromise=t._provider.loadData()}t._capabilities||(t._capabilities={supportsCaching:!1,supportsRealSuiteNav:!1,showO365Text:!0});t.supportsRealSuiteNav=t._capabilities.supportsRealSuiteNav;t.mockTagName=s.default.tagName;t.addBindingHandlers({activate:u.default});t._bundleLoader=t.resources.consume(h.bundleLoader);var i=t.resources.consume(f.pageContext.optional);if(i&&i.isSiteAdmin){var r=t.resources.consume(m.actionMap);i.isHubSite&&(window._spLaunchHubSettings=function(){var e=new(t.managed(r.LaunchHubSettingsPanelAction))({});e.execute(null).then(function(){return e.dispose()},function(){return e.dispose()})});window._spLaunchSiteSettings=function(){var e=new(t.managed(r.LaunchSiteSettingsPanelAction))({});e.execute(null).then(function(){return e.dispose()},function(){return e.dispose()})}}return t}t.prototype.render=function(i){var r=this;i.id||(i.id="SuiteNav-"+String(t._suiteNavNum++));var e=this._navigation;if(this.supportsRealSuiteNav&&this._dataPromise&&"1"!==e.viewParams.nosuite&&"1"!==e.viewParams.unsuitened){var o=new p.Qos({name:"SuiteNav.Render"});this._startTimer(o);this._dataPromise.done(function(t){t?r._provider.getO365Shell().done(function(e){if(e){try{e.SetData(t)}catch(e){r._recordFailure({event:o,errorType:"SetDataException",error:e});p.Qos.instrumentPromise({name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return r._provider.loadData(!0)});return}try{e.RenderAsync({top:i.id,disableDelayLoad:!0,disableShellPlus:!0,layout:"Mouse",disableSecondaryUserPhotoProvider:!!r._capabilities.disableSecondaryUserPhotoProvider},function(){r._suiteNavRenderedCallback&&r._suiteNavRenderedCallback(Date.now());r._bundleLoader.pageRenderingIsComplete();r._recordSuccess(o);r._onRender(e,t)},function(){r._recordSuccess(o)})}catch(e){r._recordFailure({event:o,errorType:"RenderException",error:e})}e.OnHasMember("LoadShellPlus",function(){r._handleShellPlus(e,t)});e.OnHasMember("OnDataChanged",function(){e.OnDataChanged(function(){return p.Qos.instrumentPromise({name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return r._provider.loadData(!0)}).done()})})}else r._recordFailure({event:o,errorType:"NoO365Shell"})},function(e){r._recordFailure({event:o,errorType:"LoadShellError",extraData:{shellUrl:window.require.toUrl("shellcore")},error:e})}):r._recordFailure({event:o,errorType:"NoData"})},function(e){r._recordFailure({event:o,errorType:"LoadDataError",error:e})})}else this._hamburgerIsUnavailable(!0)};t.prototype._onRender=function(e,i){var r=this;i.ActionsMap&&e.Navigation.OnLinkClick(function(e){var t=i.ActionsMap[e.Id];t&&(e.Cancel=!t.call(r,r.resources))});this._hamburgerCallback&&(e.Navigation.OnHamburgerButtonClick?e.Navigation.OnHamburgerButtonClick(this._hamburgerCallback):this._hamburgerIsUnavailable(!0));e.OnSuiteAPILoaded(function(){var e=r.resources.consume(d.newFeatureExperienceEnabler.optional);e&&e.initializeNewFeatureExperience()})};t.prototype._handleShellPlus=function(e,t){var i,r=this;this.async.setTimeout(function(){try{i=new p.Qos({name:"SuiteNav.LoadShellPlus"});e.LoadShellPlus();i.end({resultType:p.ResultTypeEnum.Success})}catch(e){r._recordFailure({event:i,errorType:"Exception",error:e})}},500)};t.prototype._recordSuccess=function(e){if(this._eventFinishedTimer){this._stopTimer();e.end({resultType:p.ResultTypeEnum.Success})}};t.prototype._recordFailure=function(e){this._hamburgerIsUnavailable(!0);if(this._eventFinishedTimer){this._stopTimer();var t={resultType:p.ResultTypeEnum.Failure,resultCode:e.errorType};if(e.extraData||e.error){var i=e.extraData||{};e.error&&(i.message=a.default.getErrorMessage(e.error));t.extraData=i}e.event.end(t)}};t.prototype._startTimer=function(e){var t=this;this._eventFinishedTimer=this.async.setTimeout(function(){e.end({resultType:p.ResultTypeEnum.Failure,resultCode:"Timeout"});t._stopTimer()},45001)};t.prototype._stopTimer=function(){this.async.clearTimeout(this._eventFinishedTimer);this._eventFinishedTimer=null};t._suiteNavNum=0;return t}(r.default);t.default=o});define("D3",["require","exports","b5","Ea","D9","D8","D4"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"ms-suitenav-fallback",template:e("D9"),viewModel:r.default});t.default=o});define("Ea",["require","exports","ap","aq","bF","c2","dZ","p3","Ec","cL","Eb","kU","cI","V","is","bX","d7"],function(e,t,r,o,i,n,a,h,s,l,f,g,d,y,v,_,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){r.__extends(e,i);function e(e){var m=i.call(this,e)||this;m.userTileDefaultUrl=!!window.FilesConfig&&FilesConfig.imgBaseUrl+"/ic/bluemanm.png"||"";m.signInUrl=!!window.FilesConfig&&FilesConfig.si;m._dataSource=m.resources.consume(a.suiteNav);m._urlDataSource=m.resources.consume(a.url);m.isAppLauncherVisible=o.observable(!1);m.addBindingHandlers({dismiss:d.default,image:s.default});m.userName=o.observable("");m.userTileUrl=o.observable("");m.optionsChildren=o.observableArray();m.meChildren=o.observableArray();m.menuAlignment=o.observable(l.default.isRightToLeft?n.default.Left:n.default.Right);m.menuLeft=o.observable(l.default.isRightToLeft?"0":"auto");var t=m.resources.consume(c.userInfo);m.isAuthenticated=t&&t.isAuthenticated();if(m._dataSource){m._dataSource.loadData().done(function(e){var t=e.data;m.userName(m._dataSource.getUserName());m.userTileUrl(m._dataSource.getUserTileUrl());var i,r=m.resources.consume(_.actionMap),o=[],n=t.CurrentWorkloadSettingsSubLinks;for(i=0;i<n.length;i++){var a,s=n[i];a=s.Id===v.default.FEEDBACK?new(m.managed(r.FeedbackAction)):s.Id===v.default.DIAGNOSTICS?new(m.managed(r.ToggleDebugWindowAction)):new(m.managed(g.default))({url:s.Url,target:s.TargetWindow});o.push(new h.default({text:s.Text,action:a}))}var l,d=[],c=t.CurrentWorkloadUserSubLinks,u=m._dataSource.getUserEmail();l=u?y.format(f.strings.SignOutEmail,u):f.strings.SignOut;d.push(new h.default({text:l,action:new(m.managed(r.SignOutAction))({url:t.SignOutLink.Url})}));for(i=0;i<c.length;i++){var p=c[i];d.push(new h.default({text:p.Text,action:new(m.managed(g.default))({url:p.Url,target:p.TargetWindow})}))}m.optionsChildren(o);m.meChildren(d)});m._dataSource.getCapabilities().showO365Text&&(m.o365text=f.strings.Office365)}else{m.userName("Jon Smith");m.userTileUrl("https://www.placeimg.com/50/50/people");m.optionsChildren([new h.default({text:f.strings.Options,action:new(m.managed(g.default))({url:"https://bing.com"})})]);m.meChildren([new h.default({text:f.strings.SignOut})])}m.isOptionsOpen=o.observable(!1);m.isMeMenuOpen=o.observable(!1);m.currentApp=f.strings.AppTitle;m.currentAppUrl=m._urlDataSource.getRootUrl();return m}e.prototype.onOptionsDismiss=function(){this.isOptionsOpen(!1)};e.prototype.onMeMenuDismiss=function(){this.isMeMenuOpen(!1)};e.prototype.onAppLauncherClick=function(){this.isAppLauncherVisible(!this.isAppLauncherVisible())};e.prototype.onAppLauncherDismiss=function(){this.isAppLauncherVisible(!1)};e.prototype.onMeMenuClick=function(){this.isMeMenuOpen(!this.isMeMenuOpen())};e.prototype.onOptionsMenuClick=function(){this.isOptionsOpen(!this.isOptionsOpen())};return e}(i.default);t.default=u});define("Ec",["require","exports","bT","aq"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new i.default(window),n=function(){function e(){}e.init=function(e,t){var i=t().defaultSrc;o.on(e,"load",function(){o.off(e,"load");1===e.naturalWidth&&1===e.naturalHeight&&(e.src=i)});o.on(e,"error",function(){o.off(e);e.src=i});r.utils.domNodeDisposal.addDisposeCallback(e,function(){o.off(e)})};e.update=function(e,t){var i=t();e.src=i.src()};return e}();t.default=n});define("D9",[],function(){return'<div class=od-SuiteNavFallback><a href=# class="od-SuiteNavFallback-appButton ms-Icon ms-Icon--Waffle" data-bind="icon: true, click: onAppLauncherClick, clickBubble: false, dismiss: onAppLauncherDismiss"></a><header>\x3c!--ko if: $data.o365text--\x3e<span class="od-SuiteNavFallback-o365Title ms-fontWeight-semilight" data-bind=text:o365text></span><span class=od-SuiteNavFallback-divider></span>\x3c!--/ko--\x3e<a class="od-SuiteNavFallback-selectedApp ms-fontWeight-semilight" data-bind="attr: { href: currentAppUrl }, text: currentApp"></a></header><ul class=od-SuiteNavFallback-rightActions><li class=od-SuiteNavFallback-options><a href=# class="od-SuiteNavFallback-link od-SuiteNavFallback-optionsLink" data-bind="click: onOptionsMenuClick, dismiss: onOptionsDismiss"><i class="ms-Icon ms-Icon--Settings"></i></a>\x3c!--ko if: $data.isOptionsOpen--\x3e<div class=od-SuiteNavFallback-menuContainer><ms-contextual-menu params="{ items: optionsChildren, isOpen: isOptionsOpen, alignment: menuAlignment, left: menuLeft }"></ms-contextual-menu></div>\x3c!--/ko--\x3e</li>\x3c!--ko if: $data.isAuthenticated--\x3e<li class=od-SuiteNavFallback-persona><a href=# class="od-SuiteNavFallback-link od-SuiteNavFallback-meLink" data-bind="click: onMeMenuClick, dismiss: onMeMenuDismiss"><img height=50 width=50 data-bind="image: { src: userTileUrl, defaultSrc: userTileDefaultUrl }, attr: { alt: userName }"></a>\x3c!--ko if: $data.isMeMenuOpen--\x3e<div class=od-SuiteNavFallback-menuContainer><ms-contextual-menu params="{ items: meChildren, isOpen: isMeMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu></div>\x3c!--/ko--\x3e</li>\x3c!--/ko--\x3e\x3c!--ko if: !$data.isAuthenticated--\x3e<li class=od-SuiteNavFallback-persona><a href=# data-bind="attr: { href: signInUrl }"><img class=od-SuiteNavFallback-personaImage height=50 width=50 data-bind="attr: { src: userTileDefaultUrl }"></a></li>\x3c!--/ko--\x3e</ul><ms-app-launcher data-bind="visible: isAppLauncherVisible"></ms-app-launcher></div>'});define("D8",["c","az"],function(e,t){e.loadStyles([{rawString:".od-SuiteNavFallback{background:"},{theme:"black",defaultValue:"#000000"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;height:50px;position:absolute;top:0;left:0;right:0;z-index:2001}.od-SuiteNavFallback header{font-size:22px;display:inline-block;line-height:50px;padding:0 0 0 18px;height:50px}html[dir=rtl] .od-SuiteNavFallback header{padding:0 18px 0 0}.od-SuiteNavFallback-divider{margin:5px 15px 0 0}html[dir=ltr] .od-SuiteNavFallback-divider{border-left-style:solid}html[dir=rtl] .od-SuiteNavFallback-divider{border-right-style:solid}html[dir=ltr] .od-SuiteNavFallback-divider{border-left-width:1px}html[dir=rtl] .od-SuiteNavFallback-divider{border-right-width:1px}html[dir=ltr] .od-SuiteNavFallback-divider{border-left-color:rgba(255,255,255,.35)}html[dir=rtl] .od-SuiteNavFallback-divider{border-right-color:rgba(255,255,255,.35)}html[dir=rtl] .od-SuiteNavFallback-divider{margin:5px 0 0 15px}[dir=ltr] .od-SuiteNavFallback-o365Title{padding-right:15px}[dir=rtl] .od-SuiteNavFallback-o365Title{padding-left:15px}.od-SuiteNavFallback-selectedApp{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-decoration:none;height:50px}.od-SuiteNavFallback-selectedApp:active,.od-SuiteNavFallback-selectedApp:hover{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SuiteNavFallback-appButton{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background:#0078d4;display:inline-block;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:50px;width:50px;cursor:pointer;font-size:18px;text-align:center;padding-top:16px;transition:background-color 467ms cubic-bezier(.1,.9,.2,1) 34ms;box-sizing:border-box}html[dir=ltr] .od-SuiteNavFallback-appButton{float:left}html[dir=rtl] .od-SuiteNavFallback-appButton{float:right}html[dir=ltr] .od-SuiteNavFallback-appButton{border-right-style:solid}html[dir=rtl] .od-SuiteNavFallback-appButton{border-left-style:solid}html[dir=ltr] .od-SuiteNavFallback-appButton{border-right-color:rgba(255,255,255,.2)}html[dir=rtl] .od-SuiteNavFallback-appButton{border-left-color:rgba(255,255,255,.2)}html[dir=ltr] .od-SuiteNavFallback-appButton{border-right-width:1px}html[dir=rtl] .od-SuiteNavFallback-appButton{border-left-width:1px}.od-SuiteNavFallback-appButton:active,.od-SuiteNavFallback-appButton:hover{color:#fff;background-color:#104a7d}.od-SuiteNavFallback-rightActions{display:block;height:50px;position:absolute;top:0;white-space:nowrap;margin:0;padding:0;list-style-type:none}[dir=ltr] .od-SuiteNavFallback-rightActions{right:0}[dir=rtl] .od-SuiteNavFallback-rightActions{left:0}.od-SuiteNavFallback-rightActions li{height:50px;line-height:0;width:51px;cursor:pointer;position:relative;box-sizing:border-box;margin:0;padding:0}html[dir=ltr] .od-SuiteNavFallback-rightActions li{float:left}html[dir=rtl] .od-SuiteNavFallback-rightActions li{float:right}html[dir=ltr] .od-SuiteNavFallback-rightActions li{border-left-style:solid}html[dir=rtl] .od-SuiteNavFallback-rightActions li{border-right-style:solid}html[dir=ltr] .od-SuiteNavFallback-rightActions li{border-left-width:1px}html[dir=rtl] .od-SuiteNavFallback-rightActions li{border-right-width:1px}html[dir=ltr] .od-SuiteNavFallback-rightActions li{border-left-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}html[dir=rtl] .od-SuiteNavFallback-rightActions li{border-right-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-SuiteNavFallback-rightActions .ms-Icon{line-height:50px}[dir=ltr] .od-SuiteNavFallback-rightActions .ms-ContextualMenu{right:0}[dir=rtl] .od-SuiteNavFallback-rightActions .ms-ContextualMenu{left:0}.od-SuiteNavFallback-persona{display:inline-block;width:55px;vertical-align:top;height:50px}html[dir=ltr] .od-SuiteNavFallback-persona{border-left-style:solid}html[dir=rtl] .od-SuiteNavFallback-persona{border-right-style:solid}html[dir=ltr] .od-SuiteNavFallback-persona{border-left-width:1px}html[dir=rtl] .od-SuiteNavFallback-persona{border-right-width:1px}html[dir=ltr] .od-SuiteNavFallback-persona{border-left-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}html[dir=rtl] .od-SuiteNavFallback-persona{border-right-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}html[dir=ltr] .od-SuiteNavFallback-persona{text-align:right}html[dir=rtl] .od-SuiteNavFallback-persona{text-align:left}.od-SuiteNavFallback-persona.online{background:#5dd255}html[dir=ltr] .od-SuiteNavFallback-persona .ms-ContextualMenu{text-align:left}html[dir=rtl] .od-SuiteNavFallback-persona .ms-ContextualMenu{text-align:right}html[dir=ltr] .od-SuiteNavFallback-personaImage{float:right}html[dir=rtl] .od-SuiteNavFallback-personaImage{float:left}.od-SuiteNavFallback-link{display:inline-block;height:50px;width:50px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:20px;text-align:center}.od-SuiteNavFallback-link.selected,.od-SuiteNavFallback-link:hover{color:#fff;background:#104a7d}.od-SuiteNavFallback-meLink{display:inline-block}.od-SuiteNavFallback-options .ms-ContextualMenu{margin-top:19px!important}.od-SuiteNavFallback-menuContainer{display:inline-block;z-index:-1}"}])});define("D4",["require","exports","D7","b5","D6","D5"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-app-launcher",template:e("D6"),viewModel:i.default,synchronous:!0});t.default=o});define("D7",["require","exports","ap","bF","d"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(){var e=null!==t&&t.apply(this,arguments)||this;e.apps=[{id:1,key:"c_h_mail",name:"Outlook",icon:"OutlookLogo",color:"#0072c6",img:"",text:"",size:"small",appType:"o365",link:"https://mail.live.com",pinned:!0},{id:2,key:"c_h_ppl",name:"People",icon:"Contact",color:"#d24726",img:"",text:"",size:"small",appType:"o365",link:"https://people.live.com",pinned:!0},{id:3,key:"c_h_cal",name:"Calendar",icon:"Calendar",color:"#5133ab",img:"",text:"",size:"wide",appType:"o365",link:"https://calendar.live.com",pinned:!0},{id:4,key:"c_h_sd",name:"OneDrive",icon:"OneDrive",color:"#094ab2",img:"",text:"",size:"small",appType:"o365",link:"https://onedrive.live.com",pinned:!0},{id:5,key:"c_h_wd",name:"Word",icon:"WordLogo",color:"#2B579A",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/word.aspx",pinned:!0},{id:6,key:"c_h_xl",name:"Excel",icon:"ExcelLogo",color:"#217346",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/excel.aspx",pinned:!0},{id:7,key:"c_h_ppt",name:"PowerPoint",icon:"PowerPointLogo",color:"#D24726",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/powerpoint.aspx",pinned:!0},{id:8,key:"c_h_on",name:"OneNote",icon:"OneNoteLogo",color:"#80397B",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/onenote.aspx",pinned:!0},{id:9,key:"c_h_sw",name:"Sway",icon:"SwayLogo",color:"#008272",img:"",text:"",size:"small",appType:"office",link:"https://g.live.com/8seskydrive/switchersway",pinned:!0},{id:10,key:"c_h_oo",name:"Office",icon:"OfficeLogo",color:"#eb3c00",img:"",text:"",size:"small",appType:"office",link:"https://office.live.com/start/default.aspx",pinned:!0}];return e}e.prototype.getAppText=function(e,t){return window.$Config&&$Config.headerTiles&&$Config.headerTiles[e]&&$Config.headerTiles[e].text||t};e.prototype.getAppClassString=function(e){return"AppLauncher-listItem "+e};e.prototype.getAppUrl=function(e,t){return window.$Config&&$Config.headerTiles&&$Config.headerTiles[e]&&$Config.headerTiles[e].href||t};e.prototype.getAppInnerClassString=function(e){return"AppLauncher-inner "+e};e.prototype.getAppIconClassString=function(e){return o.getIconClassName(e)};e.prototype.getAppTileColor=function(e){return"background-color: "+e+";outline-color: "+e};return e}(r.default);t.default=n});define("D6",[],function(){return"<div class=AppLauncher><div class=AppLauncher-beak></div><span data-bind=\"foreach: apps\"><div data-bind=\"attr: { 'class': $component.getAppClassString(name) }\"><a data-bind=\"attr: { 'class': $component.getAppInnerClassString(size), 'href': $component.getAppUrl(key, link), 'style': $component.getAppTileColor(color) }\"><i data-bind=\"attr: { 'class': $component.getAppIconClassString(icon) }\"></i> <span class=AppLauncher-menuTitle data-bind=\"text: $component.getAppText(key, name)\"></span></a></div></span></div>"});define("D5",["c","az"],function(e,t){e.loadStyles([{rawString:".AppLauncher{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid #b6b6b6;box-shadow:0 1px 15px rgba(0,0,0,.4);box-sizing:content-box!important;padding:20px 0 10px 20px;position:absolute;top:50px;margin:10px;width:auto;height:auto;min-width:240px;max-width:840px;max-height:990px;z-index:100;transition-property:max-height,max-width;transition-duration:267ms;transition-timing-function:cubic-bezier(.1,.9,.2,1);-webkit-transition-property:max-height,max-width;-webkit-transition-duration:267ms;-webkit-transition-timing-function:cubic-bezier(.1,.9,.2,1)}html[dir=rtl] .AppLauncher{padding:20px 20px 10px 0}[dir=ltr] .AppLauncher{left:0}[dir=rtl] .AppLauncher{right:0}.AppLauncher-beak{position:absolute;top:0;z-index:10}[dir=ltr] .AppLauncher-beak{left:0}[dir=rtl] .AppLauncher-beak{right:0}.AppLauncher-beak:after,.AppLauncher-beak:before{content:' ';border:solid transparent;height:0;position:absolute;width:0}.AppLauncher-beak:before{border-width:9px;border-bottom-color:#B6B6B6;top:-18px}[dir=ltr] .AppLauncher-beak:before{left:5px}[dir=rtl] .AppLauncher-beak:before{right:5px}.AppLauncher-beak:after{border-width:8px;border-bottom-color:#fff;top:-16px}[dir=ltr] .AppLauncher-beak:after{left:6px}[dir=rtl] .AppLauncher-beak:after{right:6px}.AppLauncher-greybackground{background-color:#999;width:100%;height:100%}.AppLauncher-listItem{width:109px;height:109px;display:block;margin:0 10px 10px 0;position:relative;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:moz-none;-ms-user-select:none;user-select:none;transition:167ms transform cubic-bezier(.1,.9,.2,1);box-sizing:border-box}html[dir=ltr] .AppLauncher-listItem{float:left}html[dir=rtl] .AppLauncher-listItem{float:right}html[dir=rtl] .AppLauncher-listItem{margin:0 0 10px 10px}.AppLauncher-listItem:hover .app-more-menu-button{display:block}.AppLauncher-listItem.wide{width:230px}.AppLauncher-listItem:active{-ms-transform:scale(.95);transform:scale(.95);-webkit-transform:scale(.95)}.AppLauncher-listItem i::before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.AppLauncher-listItem .AppLauncher-inner{top:0;right:0;bottom:0;left:0;position:absolute;text-align:center;background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border:2px solid transparent}.AppLauncher-listItem .AppLauncher-inner:hover{outline-width:2px;outline-style:solid}.AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{font-size:12px;color:#fff;position:absolute;bottom:5px;width:85px;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[dir=ltr] .AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{left:8px}[dir=rtl] .AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{right:8px}html[dir=ltr] .AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{text-align:left}html[dir=rtl] .AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{text-align:right}.AppLauncher-listItem .AppLauncher-inner .ms-Icon{position:relative;font-size:49px;top:26px;color:#fff!important}.AppLauncher-listItem .AppLauncher-inner img{position:absolute;top:20px}[dir=ltr] .AppLauncher-listItem .AppLauncher-inner img{left:24px}[dir=rtl] .AppLauncher-listItem .AppLauncher-inner img{right:24px}.AppLauncher-listItem .word{background:#2B579A}.AppLauncher-listItem .excel{background:#207346}.AppLauncher-listItem .powerpoint{background:#D24725;padding:0!important}.AppLauncher-listItem .onenote{background:#80397B}.AppLauncher-listItem .project{background-color:#5133ab}.AppLauncher-listItem .tasks{background:#31752E}.AppLauncher-listItem .oslo .ms-Icon{font-size:64px;padding-top:3px}.AppLauncher-listItem .more-apps{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.AppLauncher-listItem .more-apps .ms-Icon{top:40px;font-size:25px}.app-more-menu-container{position:absolute}[dir=ltr] .app-more-menu-container{right:0}[dir=rtl] .app-more-menu-container{left:0}.app-more-menu-container .app-more-menu-button{font-size:16px;cursor:pointer;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;width:30px;height:20px;display:none}.app-more-menu-container .more-menu-list{display:none;background:#fff;border:1px solid #E5F0F9;list-style-type:none;width:165px;margin:0;padding:0;position:absolute;top:0;z-index:999;box-shadow:0 0 8px rgba(0,0,0,.6);font-size:12px}[dir=ltr] .app-more-menu-container .more-menu-list{left:100%}[dir=rtl] .app-more-menu-container .more-menu-list{right:100%}html[dir=ltr] .app-more-menu-container .more-menu-list{text-align:left}html[dir=rtl] .app-more-menu-container .more-menu-list{text-align:right}.app-more-menu-container .more-menu-list li a{padding:5px 15px;width:auto;display:block;color:#000}.app-more-menu-container .more-menu-list li a:hover{background-color:#E5F0F9}.app-more-menu-container.open .more-menu-list{display:block}.appmenu-app-more{background-color:#FFF;vertical-align:bottom;margin:0 20px 10px 0}html[dir=ltr] .appmenu-app-more{float:right}html[dir=rtl] .appmenu-app-more{float:left}html[dir=ltr] .appmenu-app-more{text-align:right}html[dir=rtl] .appmenu-app-more{text-align:left}html[dir=rtl] .appmenu-app-more{margin:0 0 10px 20px}.appmenu-app-more a.appmenu-app-moretext{color:#000;font-size:12px;font-family:SegoeUI-SemiBold-final,Segoe,Tahoma,Helvetica,Arial,sans-serif}.app-provisioning:hover,.appmenu-app-more:hover{outline:0}.app-provisioning{opacity:.2}@media (max-width:940px){.AppLauncher{max-width:486px}}@media (max-width:580px){.AppLauncher{max-width:335px}.AppLauncher-listItem{width:55px;height:55px}.AppLauncher-listItem .AppLauncher-inner .ms-Icon{font-size:25px;top:13px}.AppLauncher-listItem .AppLauncher-inner .AppLauncher-menuTitle{display:none}}@media (max-width:460px){.AppLauncher{max-width:205px;min-width:205px}}@media (max-height:950px){.AppLauncher{max-height:730px}}@media (max-height:820px){.AppLauncher{max-height:610px}}@media (max-height:700px){.AppLauncher{max-height:490px}}@media (max-height:600px){.AppLauncher{max-height:360px}}@media (max-height:460px){.AppLauncher{max-height:240px}}"}])});define("D1",[],function(){return'<div class=od-SuiteNav data-bind="activate: render">\x3c!--ko if:!supportsRealSuiteNav--\x3e<div class=od-SuiteNavFallback data-bind="component: { name: mockTagName }"></div>\x3c!--/ko--\x3e</div>'});define("D0",["c","az"],function(e,t){e.loadStyles([{rawString:".od-SuiteNav{background:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";height:50px;position:absolute;width:100%}.od-userSelect--enabled div#o365cs-flexpane-overlay{-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.pluginNoSize{width:0;height:0;padding:0;position:absolute}"}])});define("YI",["require","exports","aq","YJ","lb","yq","pE"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={tagName:o.DocumentCardsGrid,template:e("yq"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(r.default))(e,t)}},synchronous:!0};i.components.isRegistered(n.tagName)||i.components.register(n.tagName,n);t.default=n});define("YJ",["require","exports","ap","y8","YK","d5"],function(e,t,i,r,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(a){i.__extends(e,a);function e(e,t){var i=a.call(this,e,t)||this;if(e.responsiveToContainer){var r=t.element,o=i.resources,n=new(o.resolved(l.default))({containerElement:r});o.expose(l.resourceKey,n)}i.initialize(new(i.managed(s.default))(e));return i}return e}(r.default);t.default=o});define("YK",["require","exports","ap","yF"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getMinRowHeight=function(){var e=this.responsiveHelper;return e.compareSize(e.formFactorSize(),"Medium")<=0?150:180};return t}(r.default);t.default=o});define("YL",["require","exports","YO","b5","YN","YM","zk"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"ms-recycle-bin-viewer",template:e("YN"),viewModel:i.default});t.default=o});define("YO",["require","exports","ap","bF","aq"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(h,i);function h(e){var t=i.call(this,e)||this;t.isLoading=o.observable(!0);t.url=e.url;t.showInDialog=e.showInDialog;t.showInDialog&&-1===t.url.indexOf(h._showInDlgQueryString)&&(t.url+=h._showInDlgQueryString);t.iframeLoaderParams={url:t.url,showLoadingLabel:!0,onload:t.iframeOnLoad.bind(t),isLoading:t.isLoading};return t}h.prototype.iframeOnLoad=function(e){var t=this,i=e.target;if(i&&i.contentWindow){var r=i.contentWindow.document,o=r.getElementById("s4-workspace"),n=r.getElementById("contentBox");this.async.setTimeout(function(){t.showInDialog&&t._updateIframeDocument(r);if(!i.style.height||"0px"===i.style.height){t.isLoading(!1);i.style.height=Math.min(n.clientHeight,.85*document.body.clientHeight)+"px"}!o||o.style.height&&"0px"!==o.style.height||(o.style.height=i.style.height)},10)}};h.prototype._updateIframeDocument=function(e){var t=e.getElementById("usrpage"),i=e.getElementById("s4-ribbonrow"),r=e.getElementById("DeltaPlaceHolderMain"),o=e.getElementById("onetidUserRptrTable");i&&(i.style.height="0px");t&&t.action&&-1===t.action.indexOf(h._showInDlgQueryString)&&(t.action+=h._showInDlgQueryString);if(r)for(var n=0;n<r.children.length;n++){var a=r.children[n];if("DIV"===a.tagName&&a.children&&0<a.children.length&&"A"===a.children[0].tagName){var s=a.children[0];s.href&&-1===s.href.indexOf(h._showInDlgQueryString)&&(s.href+=h._showInDlgQueryString)}}if(o)for(var l=o.getElementsByTagName("td"),d=0;d<l.length;d++)for(var c=l[d].getElementsByTagName("a"),u=0;u<c.length;u++){var p=c[u];if(p.href&&-1===p.href.indexOf("javascript:")&&p.text){var m=document.createTextNode(p.text);p.parentElement.replaceChild(m,p)}}};h._showInDlgQueryString="&IsDlg=1";return h}(i.default);t.default=n});define("YN",[],function(){return"<div class=od-RecycleBinViewer>\x3c!--ko component: { name: 'ms-iframe-loader', params: iframeLoaderParams }--\x3e\x3c!--/ko--\x3e</div>"});define("YM",["c","az"],function(e,t){e.loadStyles([{rawString:".od-RecycleBinViewer iframe{border:none;width:100%}"}])});define("YP",["require","exports","bS","a3","a2"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=1e4,a="scriptPreloadingHelper",s=new i.default,l=new r.default("ResourceReloader");t.resourceNeedsPreload=function(e,t){var i=l.getValue(e,o.default.local);return void 0===i||Date.now()-i>t};t.setPreloadDone=function(e){l.setValue(e,Date.now(),o.default.local)};t.preload=function(t,e,i){void 0===e&&(e=n);void 0===i&&(i=a);s.setTimeout(function(){var e=document.createElement("iframe");e.id=i;e.name=i;e.style.visibility="hidden";e.style.position="absolute";e.style.top=e.style.left=e.style.height=e.style.width="0";document.body.appendChild(e);(e=document.getElementById(i)).src=t},e)}});define("YQ",["require","exports","aC","e8"],function(i,e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=r.createResolvedAliasResourceKey(i("module").id,"uc",function(){return new t.default(function(e,t){i(["uc"],e,t)})})});define("YR",["require","exports","YQ","dZ","YP","by","ba"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="WopiPreloadLastTime",l=864e5;t.preloadWACResources=function(e){var t=e.consume(r.url).getWACResourcesPreloadUrl(),i=e.consume(n.platformDetection);if(o.resourceNeedsPreload(s,l)&&!i.isMobile){o.setPreloadDone(s);o.preload(t,5e3,"wachiddenframe")}};t.wrsPrefetch=function(e){o.resourceNeedsPreload(s,l)&&(a.isFeatureEnabled(a.EnablePowerPointWrsPreview)||a.isFeatureEnabled(a.EnableWordWrsPreview))&&e.consumeAsync(i.resourceKey).then(function(e){e.prefetch()})}});define("YS",["require","exports","ap","bN","cE","bA","dH","hC","bX"],function(e,t,i,o,n,r,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(r){i.__extends(e,r);function e(e,t){void 0===e&&(e={});var i=r.call(this,e,t)||this;i._engagement=t.engagement;i._loadTime=t.loadTime;return i}e.prototype.isInRecentView=function(e){var t=this.resources.consume(l.isInNewRecentView.optional);return e.queryType===a.default.Recent&&t&&t()};e.prototype.fireOpenItemEvent=function(e){this._engagement.logData({name:"MruRecent.OpenItem",extraData:{extension:e.extension,isPinned:e.mruState.isPinnedToMru,timeAfterLoad:Date.now()-this._loadTime.peek().getTime()}})};e.dependencies=i.__assign({},o.default.dependencies,{engagement:n.resourceKey,loadTime:s.loadTimeResourceKey});return e}(o.default);t.SharedRecentEventHelper=d;t.resourceKey=r.createResolvedResourceKey(e("module").id,d)});define("YT",["require","exports","u5","b3","YV","YU","uB"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({name:e("module").id,template:e("YU"),automationName:"ms-command-bar",viewModelType:i.CommandBarViewModel});t.default=t.resourceKey});define("YV",["c","az"],function(e,t){e.loadStyles([{rawString:".CommandBar{height:40px;white-space:nowrap;border:0}.CommandBar:focus{outline:0}.CommandBar .is-shadowed{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset}.CommandBar .is-animatingIn{animation-name:ms-fadeIn,ms-slideUpIn10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.CommandBar .is-animatingIn{animation:none}}.CommandBar .is-animatingOut{overflow:hidden;animation-name:ms-fadeOut,ms-slideDownOut10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.CommandBar .is-animatingOut{animation:none}}.md .CommandBar,.sm .CommandBar{height:44px}.CommandBar-mainArea{overflow:hidden}.md .CommandBar-mainArea,.sm .CommandBar-mainArea{height:44px}html[dir=ltr] .CommandBar-sideArea{float:right}html[dir=rtl] .CommandBar-sideArea{float:left}html[dir=ltr] .CommandBar-sideArea{text-align:right}html[dir=rtl] .CommandBar-sideArea{text-align:left}.md .CommandBar-sideArea,.sm .CommandBar-sideArea{min-width:128px}.lg .CommandBar-sideArea{min-width:260px}.xlg .CommandBar-sideArea,.xxlg .CommandBar-sideArea,.xxxlg .CommandBar-sideArea,.xxxxlg .CommandBar-sideArea{min-width:345px}.sm .CommandBar-sideArea{width:auto}"}])});define("YU",[],function(){return"<div class=CommandBar tabindex=0 role=menubar data-bind=\"keyboard: keyboardOptions, selection: { alwaysSelectFirst: true, data: selectableCommands, mode: 'single', direction: 'horizontal', focused: focusedCommand }, element: topTab\"><div class=CommandBar-sideArea data-bind=\"template: { foreach: sideCommands, afterAdd: $component.animateIn.bind($component), beforeRemove: $component.animateOut.bind($component) }\">\x3c!--ko component: {\r\n name: 'ms-command-bar-item',\r\n params: $component.getCommandBarItemParams($data, $index)\r\n }--\x3e\x3c!--/ko--\x3e</div><div class=CommandBar-mainArea data-bind=\"template: { foreach: mainCommands }, overflow: { overflowItems: overflowCommands, alwaysVisibleItems: fixedCommands, responsiveUI: responsiveUI }\">\x3c!--ko component: {\r\n name: 'ms-command-bar-item',\r\n params: $component.getCommandBarItemParams($data, $index) }--\x3e\x3c!--/ko--\x3e</div></div>"});define("YW",["require","exports","ap","aq","at","jP","aC","YY","aL","cY","bX","iE","eX","iJ","eO","Pn","cE","Pp","dZ","Xd","V6","bD","QY","m8","Pi","MZ","Pt","YX"],function(e,t,o,d,a,i,m,s,l,r,c,u,p,h,f,g,y,v,_,b,x,S,C,P,k,I,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){o.__extends(e,n);function e(e){var t=n.call(this,e)||this;t._scope=new S.default;t.resources=t.props.hostViewModel.resources;t._clientFormProvider=t.resources.consume(g.resourceKey);t._clientForm=t.props.clientForm;t.item=t.props.clientForm.item;t._rootFolder=t.props.rootFolder;t._selectionModel=t.resources.consume(c.itemsSelection);t._itemProvider=t.resources.consume(p.resourceKey);t._complianceTagProvider=t.resources.consume(C.resourceKey.optional);t._currentItem=t.resources.consume(c.currentItem);t._currentItemSet=t.resources.consume(c.currentItemSet);t._itemsStore=t.resources.consume(h.resourceKey);t._engagement=t.resources.consume(y.resourceKey);t.clientFormType=t._clientForm.formType;t.interactiveSave=d.observable(t.props.interactiveSave);t.contentType=t._getContentTypeFromItem(t.item.peek());t._onSaveCallback=t.props.onSaveCallback;t._onCancelCallback=t.props.onCancelCallback;t._pageContext=t.resources.consume(u.pageContext);t._listContext=t.resources&&t.resources.consume(u.listContext);t._clientFormDataSource=t.resources.consume(v.resourceKey);t._currentView=t.resources.consume(c.currentView.optional);t._urlDataSource=t.resources.consume(_.url.optional);t._attachmentDataSource=t.resources.expose(_.attachments,new(t.resources.injected(x.default))(t._pageContext));t._attachmentManager=new b.AttachmentOperationsManager(t.item.peek(),t._attachmentDataSource);t.isInfoPane=t.props.isInfoPane;t.isReadOnly=t._isReadOnly(t.props.isReadOnly);for(var i=0,r=t._clientForm.fields;i<r.length;i++){var o=r[i];if(o.schema.Type&&"attachments"===o.schema.Type.toLowerCase()){t._attachmentField=o;break}}t.props.fieldsManagerAccessor&&t.props.fieldsManagerAccessor(t);t._bootStrapComplianceTagField();t._bootStrapContentTypeField(!1);t._toggleAttachmentManager(!1);t.state={clientForm:t._deKO(l.deepCopy(t._clientForm))};return t}e.prototype.componentWillReceiveProps=function(e){this._clientForm=e.clientForm;this._updateClientForm()};e.prototype.componentDidMount=function(){var i=this;this._scope.attach(this.item.subscribe(function(e){if(e){var t=i._getContentTypeFromItem(i.item.peek());t.displayName&&t.displayName!==i._clientForm.contentType&&i.switchContentType(t);i.trackPromise(i._clientFormProvider.updateFormValues(i._clientForm).then(function(){i._updateClientForm()}))}}));for(var e=0,t=this._clientForm.fields;e<t.length;e++){var r=t[e];r&&r.state&&this._scope.attach(r.state.subscribe(function(e){i._updateClientForm()}))}};e.prototype.componentWillUnmount=function(){this._scope.dispose()};e.prototype.render=function(){var t=this,e=this.state.clientForm,i=e&&e.isBulkEdit&&(!e.fields||e.fields.length<1);this._engagement.logData({name:"ReactClientFormConnector.OnRender",extraData:{contentType:this.contentType,contentTypeId:this._clientForm.contentTypeId,formType:this._clientForm.formType}});var r={clientForm:e,interactiveSave:this.interactiveSave.peek(),isInfoPane:this.isInfoPane,pageContext:this._pageContext,getFieldFilterData:this._getFieldFilterData.bind(this),onSave:this._processAndSaveChangesInternal.bind(this),onCancel:this.cancelChanges.bind(this),getRichTextEditorIframeUrl:this._getRichTextEditorIframeUrl,onAddAttachments:this._onAddAttachments,onRemoveAttachment:this._onRemoveAttachment,complianceTags:this._complianceTags,componentRef:function(e){return t._reactClientForm=e},switchContentType:this.switchContentType};return i?a.createElement("div",{className:"ReactClientForm-noCommonPropertiesMessage"},k.strings.BulkEditNoCommonPropertiesMessage):a.createElement(s.ReactClientForm,o.__assign({},r))};e.prototype.shouldSetReadFocusAfterSave=function(){return!1};e.prototype.switchContentType=function(t){var i=this;return t.displayName!==this._clientForm.contentType?this.trackPromise(this._clientFormProvider.getClientForm({clientFormType:1,item:this.item,contentType:t.displayName,isBulkEdit:this._clientForm.isBulkEdit,selection:this._selectionModel.selection.peek(),isSwitchingContentType:!0}).then(function(e){if(e){i._clientForm=e;i.contentType=t;return i._updateClientForm()}})):m.default.wrap(this.state.clientForm)};e.prototype.saveChangesWithoutProcessing=function(){var s=this,e=this._selectionModel.selection.peek(),l={clientForm:this._clientForm,newDocumentUpdate:!1,checkInComment:null,isInteractiveSave:this.props.interactiveSave,rootFolder:this._rootFolder,selection:this._clientForm.isBulkEdit&&e};this._toggleAttachmentManager(!0);return 2===this._clientForm.formType?this.trackPromise(this._clientFormProvider.createItem(l).then(function(){return s._validateClientForm()}).then(function(e){if(e){var t=s._currentItem.peek();t&&t.key&&s._itemProvider.invalidateItem(t.key)}return{status:e?T.UpdateResultStatus.success:T.UpdateResultStatus.fail}})):this.trackPromise(this._clientFormProvider.updateItem(l).then(function(t){return s._validateClientForm().then(function(e){e||(t.status=T.UpdateResultStatus.fail);return t})}).then(function(e){var n=s._clientForm.item.peek(),t=[];if(s._clientForm.isBulkEdit&&l.selection)for(var i=0,r=l.selection;i<r.length;i++){var o=r[i];if(o){var a=o.peek().properties.ID;e.failedItemIds&&-1!==e.failedItemIds.indexOf(parseInt(a,10))||t.push(a)}}else t.push(n.properties.ID);s._clientForm.item&&n.parentKey&&s._itemProvider.getSpecifiedItems({parentKey:n.parentKey,itemKeys:t,recurseInFolders:!1,getRootFolderFromParentKey:n.type===f.default.Folder,needToClearParentSmartFiltersInfo:!0}).then(function(e){var t=e.children;if(s._clientForm.isBulkEdit&&t)for(var i=0,r=t;i<r.length;i++){var o=r[i];s._itemsStore.getItem(o.key)(o)}else if(t&&1===t.length){if((o=t[0]).key===n.key){s._itemsStore.getItem(n.key)(o)}else 1===s.clientFormType&&s.interactiveSave.peek()&&!s.isInfoPane?s._itemsStore.invalidateItem(n.key):s._itemsStore.invalidateItem(s._clientForm.item.peek().parentKey)}});return e}))};e.prototype.cancelChanges=function(){this._engagement.logData({name:"ReactClientFormConnector.OnCancel"});this._onCancelCallback&&this._onCancelCallback();return""};e.prototype.processAndSaveChanges=function(){var e=this;return this.trackPromise(new m.default(function(t){e._processAndSaveChangesInternal(e._reactClientForm.getClientForm(),!0).then(function(e){t(e)})}))};e.prototype.trackPromise=function(e){var t=!1,i=this._scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),r=function(){t=!0;i.dispose()};e.done(r,r);return e};e.prototype._updateClientForm=function(e,t){this._bootStrapComplianceTagField();this._bootStrapContentTypeField(t);this._toggleAttachmentManager(!1);var i={clientForm:this._deKO(l.deepCopy(this._clientForm))};this._toggleAttachmentManager(!0);e?this.state=i:this.setState(i);return i.clientForm};e.prototype._bootStrapComplianceTagField=function(){var o=this;if(this._listContext&&this._listContext.tenantTagPolicyEnabled&&2!==this.clientFormType){for(var e=0,t=this._clientForm.fields;e<t.length;e++){var i=t[e];if(P.isClientFormComplianceTagField(i)){this._complianceTags=i.schema.ComplianceTags;return}}this._complianceTagProvider&&this.trackPromise(this._complianceTagProvider.hasComplianceTags().then(function(e){if(e)return o._complianceTagProvider.getAvailableTagsForSite()}).then(function(e){if(e&&e.length){o._complianceTags=e;var t=o._clientForm.isBulkEdit?"":o.item.peek().properties[P.COMPLIANCETAG_FIELD_NAME]||"",i={data:d.observable(t),serverData:t,state:d.observable(0),hasException:d.observable(!1),errorMessage:d.observable(""),schema:{Name:P.COMPLIANCETAG_FIELD_NAME,Title:k.strings.ComplianceTagFieldTitle,DefaultValue:null,DefaultValueTyped:null,Description:"",Id:P.COMPLIANCETAG_FIELD_ID,FieldType:"Lookup",Direction:null,Hidden:!1,IMEMode:null,ReadOnlyField:!1,Required:!1,Type:null,ComplianceTags:e}},r=o._clientForm.isBulkEdit||!o._clientForm.fields.length?0:1;o._clientForm.fields.splice(r,0,i)}}))}};e.prototype._bootStrapContentTypeField=function(e){if(this._listContext.contentTypesEnabled){var t=this._currentItemSet.peek().contentTypes.peek(),i=this._clientFormProvider.getContentTypes(1);if(i&&t&&"Folder"!==this._clientForm.contentType){var r=t.filter(function(t){return 1===i.filter(function(e){return t.displayName===e.displayName}).length});if(r&&0<r.length){var o=this._getBootstrappingContentTypeField(e);o.schema.ContentTypes=r;for(var n=0;n<this._clientForm.fields.length;n++)if("ContentType"===this._clientForm.fields[n].schema.Name){this._clientForm.fields.splice(n,1);break}this._clientForm.fields.unshift(o)}}}};e.prototype._processAndSaveChangesInternal=function(e,t){var i=this,r=e.isBulkEdit?"BulkEditReactClientFormConnector.OnSave":"ReactClientFormConnector.OnSave";this._engagement.logData({name:r,isIntentional:!0});if(!t&&!this.props.interactiveSave){this.setState({clientForm:e});return m.default.wrap(!0)}for(var o=e.fields,n=0,a=o;n<a.length;n++){var s=a[n],l=s&&s.schema&&s.schema.Id||"";if(l){s.hasException=!1;s.errorMessage="";for(var d=!1,c=0,u=this._clientForm.fields;c<u.length;c++){var p=u[c];if(p.schema.Id===l){this._updateKOObj(s,p,[],["data","errorMessage","hasException","state"]);p.state(this._toKOClientFormFieldState(s.state));d=!0;break}}d||this._createFieldBasedOnReactFields(s)}}this._removeFieldBasedOnReactFields(o);return this.trackPromise(this.saveChangesWithoutProcessing().then(function(e){e.status!==T.UpdateResultStatus.success&&i._updateClientForm();i._onSaveCallback&&!i.props.interactiveSave&&i._onSaveCallback(e.status===T.UpdateResultStatus.success);return e.status===T.UpdateResultStatus.success}))};e.prototype._getContentTypeFromItem=function(e){return{displayName:e.properties.ContentType,description:e.properties.ContentType,templateUrl:null,cTypeId:e.properties.ContentTypeId}};e.prototype._getRichTextEditorIframeUrl=function(e){return this._urlDataSource&&e?this._urlDataSource.getNewFormRichTextEditorIFrameUrl(e,this.state.clientForm.contentTypeId,this.state.clientForm.item.parentKey):""};e.prototype._validateClientForm=function(){var e=this._clientForm&&this._clientForm.fields||null;if(null===e)return m.default.wrap(!1);for(var t=0;t<e.length;t++)if(e[t].hasException.peek())return m.default.wrap(!1);return m.default.wrap(!0)};e.prototype._updateKOObj=function(e,t,i,r){if(null!==e&&null!==t){for(var o=0,n=i;o<n.length;o++){t[l=n[o]]=e[l]}for(var a=0,s=r;a<s.length;a++){var l;void 0===t[l=s[a]]?t[l]=d.observable(e[l]):t[l](e[l])}}};e.prototype._deKO=function(e){if(null===e)return null;if(d.isObservable(e)){var t=e.peek();return this._deKO(t)}if(this._isPrimitive(e))return e;if(Array.isArray(e)){for(var i=e.slice(),r=0;r<i.length;r++)i[r]=this._deKO(i[r]);return i}var o=l.deepCopy(e);for(var n in o)o.hasOwnProperty(n)&&(o[n]=this._deKO(o[n]));return o};e.prototype._toKOClientFormFieldState=function(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 2}};e.prototype._isPrimitive=function(e){return e!==Object(e)};e.prototype._getFieldFilterData=function(e){var t=this._currentView?this._currentView.peek().id:"";return this._clientFormDataSource.getFieldFilterData(e,t)};e.prototype._onAddAttachments=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];this._attachmentManager.createAddAttachmentOperation(r.nativeFile)}return!0};e.prototype._onRemoveAttachment=function(e){this._attachmentManager.createDeleteAttachmentOperation(e.fileName);return!0};e.prototype._toggleAttachmentManager=function(e){this._attachmentField&&(this._attachmentField.AttachmentOperationsManager=e&&this._attachmentManager||void 0)};e.prototype._isReadOnly=function(e){var t=this.item&&this.item.peek();return 2!==this.clientFormType&&(this.isReadOnly||I.default.isCheckedOutByOther(t,this._pageContext.userId)||!r.PermissionMask.hasItemPermission(t,r.PermissionMask.editListItems))};e.prototype._getBootstrappingContentTypeField=function(e){var t=this._getContentTypeFromItem(this.item.peek()),i=t.displayName===this._clientForm.contentType?t:{displayName:this._clientForm.contentType,description:this._clientForm.contentType,templateUrl:null};if(this._clientForm.isBulkEdit){t={displayName:void 0,description:void 0,templateUrl:void 0};e||(i=t)}return{data:d.observable(i),serverData:t,state:d.observable(0),hasException:d.observable(!1),errorMessage:d.observable(""),schema:{Name:"ContentType",Title:k.strings.ContentType,Description:null,DefaultValue:null,DefaultValueTyped:null,Id:"c042a256-787d-4a6f-8a8a-cf6ab767f12d",FieldType:"Computed",Direction:null,Hidden:!1,IMEMode:null,ReadOnlyField:!1,Required:!1,Type:null}}};e.prototype._createFieldBasedOnReactFields=function(e){var t={data:d.observable(e.data),serverData:e.serverData,state:d.observable(this._toKOClientFormFieldState(e.state)),hasException:d.observable(!1),errorMessage:d.observable(""),schema:this._toKOClientFormFieldSchema(e.schema)};this._clientForm.fields.push(t)};e.prototype._removeFieldBasedOnReactFields=function(e){for(var t=0;t<this._clientForm.fields.length;t++){for(var i=this._clientForm.fields[t],r=!1,o=0,n=e;o<n.length;o++){var a=n[o],s=a&&a.schema&&a.schema.Id||"";if(i.schema.Id===s){r=!0;break}}r||this._clientForm.fields.splice(t,1)}};e.prototype._toKOClientFormFieldSchema=function(e){return{DefaultValue:e.DefaultValue,DefaultValueTyped:e.DefaultValueTyped,DefaultValueFormatted:e.DefaultValueFormatted,Description:e.Description,Direction:e.Direction,FieldType:e.FieldType,Hidden:e.Hidden,Id:e.Id,IMEMode:e.IMEMode,MaxLength:e.MaxLength,Name:P.ASSETID_FIELD_NAME,ReadOnlyField:e.ReadOnlyField,Required:e.Required,Title:e.Title,Type:e.Type,IsAutoHyperLink:e.IsAutoHyperLink,AppendOnly:e.AppendOnly,HiddenListInternalName:e.HiddenListInternalName,RichText:e.RichText,ComplianceTags:e.ComplianceTags,ReadOnly:e.ReadOnlyField.toString()}};o.__decorate([i.autobind],e.prototype,"switchContentType",null);o.__decorate([i.autobind],e.prototype,"_getRichTextEditorIframeUrl",null);o.__decorate([i.autobind],e.prototype,"_onAddAttachments",null);o.__decorate([i.autobind],e.prototype,"_onRemoveAttachment",null);return e}(a.Component);t.default=n});define("YY",["require","exports","ap","aae","Y4","Pw","Y3","Y2","YZ"],function(e,t,i,r,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t)});define("aae",["require","exports","ap","at","wN","mo","o1","jP","aL","a0","Y4","Y2","aag","ZU","aaf"],function(e,t,i,a,s,o,n,l,d,c,y,u,v,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m;!function(e){e[e.ready=0]="ready";e[e.saving=1]="saving";e[e.newlySaved=2]="newlySaved"}(m=t.ClientFormStatus||(t.ClientFormStatus={}));var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._hasError=!1;var i=d.deepCopy(e.clientForm);t._populateDefaultValuesIfNeeded(i);t.state={clientForm:i,serverErrorDetails:"",status:m.ready};t._pageContext=e.pageContext;t._getFieldFilterData=e.getFieldFilterData;t._editors={};return t}e.prototype.componentWillReceiveProps=function(e){this.setState({clientForm:d.deepCopy(e.clientForm)})};e.prototype.render=function(){return a.createElement("div",{className:l.css("ReactClientForm",{"is-bulkEdit":this.state.clientForm.isBulkEdit})},this._renderErrorMessages(),this._renderFieldEditors(),this._renderEditButtons())};e.prototype.getClientForm=function(){for(var e=d.deepCopy(this.state.clientForm),t=0,i=e.fields;t<i.length;t++){var r=i[t],o=this._editors[r.schema.Id];this._editors[r.schema.Id]&&(r.data=o.getData())}return e};e.prototype._renderErrorMessages=function(){return this.state.serverErrorDetails?a.createElement("div",{className:"ReactClientForm-error",role:"alert"},a.createElement("span",{className:"ms-font-m ms-fontColor-error"},p.default.ServerErrorTitle),a.createElement("span",{className:"ms-font-m ms-fontColor-neutralSecondary"},this.state.serverErrorDetails)):null};e.prototype._renderFieldEditors=function(){return a.createElement("div",{className:"ReactClientFormFields"},this._renderFieldEditorsInternal())};e.prototype._renderEditButtons=function(){var e=this.state.status,t=this.state.clientForm.isBulkEdit;if(this.props.interactiveSave)return null;var i=a.createElement(s.PrimaryButton,{text:p.default.SaveLabel,onClick:this._onSaveButtonClicked,disabled:e===m.saving}),r=a.createElement(s.DefaultButton,{text:p.default.CancelLabel,className:"ReactClientForm-button-far",onClick:this._onCancelButtonClicked}),o=this._renderFormStatusIndicator(),n=o?e===m.saving?p.default.SavingState:p.default.SavedState:void 0;return a.createElement("div",{className:"ReactClientForm-editButtons"},i,!t&&r,t&&o,t&&n)};e.prototype._renderFormStatusIndicator=function(){switch(this.state.status){case m.saving:return a.createElement(n.Spinner,{className:"ReactClientForm-statusIndicator"});case m.newlySaved:return a.createElement(o.Icon,{iconName:"CheckMark",className:"ReactClientForm-statusIndicator"});default:return}};e.prototype._renderFieldEditorsInternal=function(){var e=this.state.clientForm,t=this.props,i=t.interactiveSave,r=t.isInfoPane,o=t.getRichTextEditorIframeUrl,n=t.onAddAttachments,a=t.onRemoveAttachment,s=t.complianceTags,l=!1,d=[],c=e.fields.length,u=-1,p=-1;this._editors={};for(var m=0;m<c;m++){var h=e.fields[m];if(!e.isBulkEdit||"file"!==h.schema.FieldType.toLowerCase()){var f=!l&&h.hasException;f&&(l=!0);if(v.isClientFormComplianceTagField(h)){u=m;(g=y.ReactFieldEditorFactory.getFieldEditor(e.item,h,i,r,f,this._onSave,this._onChangeMode,this._registerEditor,this._pageContext,this._getFieldFilterData,o,n,a,s,e.isBulkEdit))&&d.push(g)}else if(v.isClientFormComplianceAssetIdField(h))p=m;else{var g;(g=y.ReactFieldEditorFactory.getFieldEditor(e.item,h,i,r,f,this._onSave,this._onChangeMode,this._registerEditor,this._pageContext,this._getFieldFilterData,o,n,a,void 0,e.isBulkEdit,this._switchContentType))&&d.push(g)}}}s&&1<s.length&&this._generateComplianceTagRelatedFields(e,d,l,u,p);return d};e.prototype._registerEditor=function(e,t){this._editors&&(this._editors[e]=t)};e.prototype._onSaveButtonClicked=function(){var e=this.getClientForm(),t=this._clientSideValidation(e);this.setState({clientForm:e});if(t){this.setState({status:m.saving});this._saveClientForm(e,!0)}};e.prototype._onCancelButtonClicked=function(){this.props.onCancel&&this.props.onCancel()};e.prototype._onSave=function(e){for(var t=d.deepCopy(this.state.clientForm),i=0,r=t.fields;i<r.length;i++){var o=r[i];if(o&&o.schema&&o.schema.Id&&o.schema.Id===e.schema.Id){e.schema.Required&&!o.data&&e.data&&c.Engagement.logData({name:"FilesThatNeedAttention.MissingRequiredMetadataEntered"});o.data=e.data;o.clientSideErrorMessage=e.clientSideErrorMessage;o.state=e.state;break}}var n=!this._editors[e.schema.Id].validate();this.setState({clientForm:t});n&&this.props.interactiveSave&&this._saveClientForm(t,!1)};e.prototype._onChangeMode=function(e,t){if(this.props.interactiveSave&&t===u.ReactFieldEditorMode.Edit)for(var i in this._editors)i!==e.schema.Id&&this._editors[i]&&this._editors[i].saveData()};e.prototype._switchContentType=function(e){var t=this,i=this.props.switchContentType;return i?i(e).then(function(e){t.setState({clientForm:e});return Promise.resolve()}):Promise.resolve()};e.prototype._clientSideValidation=function(e){for(var t=!0,i=0,r=e.fields;i<r.length;i++){var o=r[i],n=this._editors[o.schema.Id];if(n){o.clientSideErrorMessage=n.validate();o.clientSideErrorMessage&&t&&(t=!1)}}return t};e.prototype._saveClientForm=function(e,t){var i=this;this.props.onSave&&this.props.onSave(e,t).then(function(e){i._handleSaveSuccess(e)},function(e){i._handleSaveFailure(e)})};e.prototype._handleSaveSuccess=function(e){var t=this,i=!e&&this.state.clientForm.isBulkEdit?p.default.BulkEditPartialFailErrorMessage:"",r=e&&this.state.status===m.saving;this.setState({status:r?m.newlySaved:m.ready,serverErrorDetails:i});r&&setTimeout(function(){t.setState({status:m.ready})},1e3)};e.prototype._handleSaveFailure=function(e){var t=(e=e instanceof Array?e:[e]).reduce(function(e,t){return e+e?"\r\n":""+t&&t.message?t.message.value?t.message.value:t.message:""},"");this.setState({status:m.ready,serverErrorDetails:t||p.default.ServerErrorDefaultValue})};e.prototype._populateDefaultValuesIfNeeded=function(e){if(e&&2===e.formType)for(var t=0,i=e.fields;t<i.length;t++){var r=i[t],o=r&&!r.data&&r.schema;o&&(o.DefaultValueFormatted?r.data=o.DefaultValueFormatted:o.DefaultValueTyped?this._setDefaultValueTyped(r,o.DefaultValueTyped):o.DefaultValue&&(r.data=r.schema.DefaultValue))}};e.prototype._setDefaultValueTyped=function(e,t){(t&&"string"==typeof t||"number"==typeof t)&&(e.data=String(t))};e.prototype._generateComplianceTagRelatedFields=function(e,t,i,r,o){var n=e.item,a="";n&&(a=n.properties[v.COMPLIANCETAG_FIELD_NAME]||"");if(-1===r){var s=this._getComplianceTagdField(e,a);e.fields.push(s);(p=!i&&s.hasException)&&(i=!0);var l=y.ReactFieldEditorFactory.getFieldEditor(e.item,s,this.props.interactiveSave,this.props.isInfoPane,p,this._onSave,this._onChangeMode,this._registerEditor,this._pageContext,this._getFieldFilterData,this.props.getRichTextEditorIframeUrl,this.props.onAddAttachments,this.props.onRemoveAttachment,this.props.complianceTags,e.isBulkEdit);l&&t.push(l)}if(null===a||""===a)return this._hideAssetIdField(e,t,o);for(var d=0,c=this.props.complianceTags;d<c.length;d++){var u=c[d];if(a===u.tagName){if(u.isEventTag){var p,m=void 0;if(-1!==o)m=e.fields[o];else{m=this._getAssetIdField(e);e.fields.push(m)}(p=!i&&m.hasException)&&(i=!0);var h=y.ReactFieldEditorFactory.getFieldEditor(e.item,m,this.props.interactiveSave,this.props.isInfoPane,p,this._onSave,this._onChangeMode,this._registerEditor,this._pageContext,this._getFieldFilterData,this.props.getRichTextEditorIframeUrl,this.props.onAddAttachments,this.props.onRemoveAttachment,void 0,e.isBulkEdit);h&&t.push(h);return}return this._hideAssetIdField(e,t,o)}}};e.prototype._getComplianceTagdField=function(e,t){return{data:t,serverData:t,state:0,hasException:!1,errorMessage:"",schema:{Name:v.COMPLIANCETAG_FIELD_NAME,Title:"Apply label",DefaultValue:null,DefaultValueTyped:null,Description:"",Id:v.COMPLIANCETAG_FIELD_ID,FieldType:"Lookup",Direction:null,Hidden:!1,IMEMode:null,ReadOnlyField:!1,Required:!1,Type:null,ComplianceTags:this.props.complianceTags}}};e.prototype._getAssetIdField=function(e){var t=e.item,i="";t&&(i=t.properties[v.ASSETID_FIELD_NAME]||"");return{data:i,serverData:i,state:0,hasException:!1,errorMessage:"",schema:{Name:v.ASSETID_FIELD_NAME,Title:"Asset ID",DefaultValue:null,DefaultValueTyped:null,Description:"",Id:v.ASSETID_FIELD_ID,FieldType:"text",Direction:null,Hidden:!1,IMEMode:null,ReadOnlyField:!1,Required:!1,Type:null}}};e.prototype._hideAssetIdField=function(e,t,i){-1!==i&&e.fields.splice(i,1)};i.__decorate([l.autobind],e.prototype,"_registerEditor",null);i.__decorate([l.autobind],e.prototype,"_onSaveButtonClicked",null);i.__decorate([l.autobind],e.prototype,"_onCancelButtonClicked",null);i.__decorate([l.autobind],e.prototype,"_onSave",null);i.__decorate([l.autobind],e.prototype,"_onChangeMode",null);i.__decorate([l.autobind],e.prototype,"_switchContentType",null);return e}(l.BaseComponent);t.ReactClientForm=r});define("Y4",["require","exports","at","bf","Z7","Z5","Z4","Z3","Z0","ZX","ZS","ZM","ZK","ZG","ZD","Y3","Zy","Zw","Pw","Zt","Y5"],function(e,t,_,b,x,S,C,P,k,I,T,w,E,D,A,M,F,L,R,N,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.getFieldEditor=function(e,t,i,r,o,n,a,s,l,d,c,u,p,m,h,f){var g=t.schema.FieldType.toLowerCase(),y=t.schema.Name.toLowerCase();if("attachments"===g)return _.createElement(x.AttachmentsEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)},onAddAttachments:u,onRemoveAttachment:p});if("boolean"===g)return _.createElement(S.BooleanFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)}});if("choice"===g||"multichoice"===g)return _.createElement(F.ChoiceFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)},getFieldFilterData:d});if(R.isContentTypeField(g,y))return _.createElement(C.ContentTypeFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)},switchContentType:f});if("datetime"===g)return b.Killswitch.isActivated("35F647E1-0EA1-4596-8CD4-818F4FD26388","4/19/2018","Refactor DateTimeFieldEditor")?_.createElement(k.DateTimeFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,pageContext:l,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)}}):_.createElement(P.DateTimeFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,pageContext:l,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)}});if("file"===g)return _.createElement(I.FileFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,pageContext:l,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)}});if("lookup"===g||"lookupmulti"===g)return R.isComplianceTagField(g,t.schema.Id)?_.createElement(N.ComplianceTagEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)}}):_.createElement(w.LookupFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)}});if("note"===g){var v="";t.schema.RichText&&c&&(v=c(t.schema.Name));return _.createElement(T.NoteFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)},alternativeEditorUrl:v})}return"number"===g?_.createElement(E.NumberFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)}}):"text"===g?_.createElement(L.TextFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)}}):"url"===g?_.createElement(A.PictureFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)}}):"user"===g||"usermulti"===g?_.createElement(D.PeopleEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)},pageContext:l}):"taxonomyfieldtype"===g||"taxonomyfieldtypemulti"===g?_.createElement(O.TaxonomyEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)},pageContext:l}):_.createElement(M.PlaceHolderFieldEditor,{key:t.schema.Id,item:e,field:t,isBulkEdit:h,interactiveSave:i,isInfoPane:r,shouldGetFocus:o,onSave:n,onChangeMode:a,componentRef:function(e){return s(t.schema.Id,e)}})};return e}();t.ReactFieldEditorFactory=i;t.default=i});define("Z7",["require","exports","ap","at","l8","wN","mh","jP","aac","Y2","YZ","aaa","Z9","Z8"],function(e,t,r,l,n,d,c,o,u,a,i,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._showInvisibleRegionOnDispayMode=!0;return t}e.prototype.getData=function(){return this._getAttachmentsData(this.state.attachments)};e.prototype.saveData=function(){if(this.state.mode===a.ReactFieldEditorMode.Edit){this.state.field.serverData=null;this._onSave(this.getData())}};e.prototype._getStateFromProps=function(e){var t=i.prototype._getStateFromProps.call(this,e);t.attachments=this._convertRawDataToAttachments(e.field.data);t.attachmentToDelete=void 0;return t};e.prototype._getPlaceHolderString=function(){return m.default.attachmentsEditorPlaceHolder};e.prototype._getRenderer=function(){var e=this.state,t=e.attachments,i=e.field,r=i.data&&i.data.UrlPrefix||null;if(!t||!r)return null;var o=t.map(function(e){return e.fileName?l.createElement("div",{key:r+e.fileName,className:"ReactFieldEditor-Attachments-Renderer"},n.UrlRenderer({url:r+e.fileName,urlDisplay:e.fileName,isImageUrl:!1})):null});return l.createElement("div",null,o)};e.prototype._getEditor=function(){var t=this,e=this.state,i=e.attachments,r=e.attachmentToDelete,o=i.map(function(e){return l.createElement(p.Attachment,{key:e.id||e.fileName,attachment:e,onRemove:t._onDeleteAttachment})}),n=l.createElement("div",{className:"ReactFieldEditor-Attachments-UploadContainer"},l.createElement("input",{className:"ReactFieldEditor-Attachments-UploadInput",type:"file",name:"attachmentFiles",title:m.default.attachFiles,ref:function(e){return t._inputElmt=e},onChange:this._onFileChange,multiple:!0}),l.createElement(c.Link,{className:"ReactFieldEditor-Attachments-UploadLink",onClick:this._onClickUploadButton,title:m.default.addAttachments},m.default.addAttachments)),a=this.props.interactiveSave?l.createElement(d.PrimaryButton,{className:"ReactFieldEditor-Button",iconProps:{iconName:"CheckMark"},onClick:this._endEdit}):void 0,s=r?l.createElement(u.WarningDialog,{strings:this._getDialogStrings(),showDoneButton:!0,onDone:this._onDeleteConfirmed}):void 0;return l.createElement("div",{className:"ReactFieldEditor-Attachments"},l.createElement("div",{className:"ReactFieldEditor-Attachments-EditContainer"},o,n,s),a)};e.prototype._focusOnEditorIfNeeded=function(){this._inputElmt&&this._inputElmt.focus()};e.prototype._endEdit=function(e){this.saveData()};e.prototype._onClickUploadButton=function(){this._inputElmt&&this._inputElmt.click()};e.prototype._onDeleteAttachment=function(e){e.uploaded?this.setState({attachmentToDelete:e}):this._deleteAttachment(e)};e.prototype._onDeleteConfirmed=function(){var e=this.state.attachmentToDelete;this._deleteAttachment(e)};e.prototype._deleteAttachment=function(t){var e=this.state.attachments.length,i=this.state.attachments.filter(function(e){return e.fileName!==t.fileName});this.setState({attachments:i,attachmentToDelete:void 0});if(this.props.onRemoveAttachment&&i.length<e){this.props.onRemoveAttachment(t);this.props.interactiveSave&&this._endEdit(null)}};e.prototype._onFileChange=function(e){for(var t=e.target.files,i=[],r=0;r<t.length;r++){var o=t[r];i.push(o)}if(0<i.length){var n=this._rawFilesToAttachments(i),a=this.state.attachments.concat(n);a=this._removeDuplicateAttachments(a);this.setState({attachments:a});if(this.props.onAddAttachments){var s=a.filter(function(e){return!e.uploaded});if(0<s.length){this.props.onAddAttachments(s);this.props.interactiveSave&&this._endEdit(null)}}}};e.prototype._rawFilesToAttachments=function(e){return e&&0<e.length?e.map(function(e){return{fileName:e.name,nativeFile:e,uploaded:!1}}):[]};e.prototype._removeDuplicateAttachments=function(e){for(var t={},i=0;i<e.length;i++){var r=e[i];t[r.fileName]&&!r.uploaded||(t[r.fileName]=r)}var o=[];for(var n in t)t.hasOwnProperty(n)&&o.push(t[n]);return this._sortAttachments(o)};e.prototype._sortAttachments=function(e){return e.sort(function(e,t){return e.uploaded===t.uploaded?e.fileName===t.fileName?0:e.fileName<t.fileName?-1:1:e.uploaded?-1:1})};e.prototype._convertRawDataToAttachments=function(t){return t&&t.Attachments&&0<t.Attachments.length?t.Attachments.map(function(e){return{fileName:e.FileName,serverUrl:t.UrlPrefix+e.FileName,id:e.AttachmentId,uploaded:!0}}):[]};e.prototype._getAttachmentsData=function(e){var t=this.props.field&&this.props.field.data,i={UrlPrefix:t&&t.UrlPrefix,Attachments:[]};if(e)for(var r=0,o=e;r<o.length;r++){var n=o[r];i.Attachments.push({FileName:n.fileName,uploaded:!0})}return i};e.prototype._getDialogStrings=function(){return{title:m.default.recycleAttachmentDialogTitle,subtext:m.default.recycleConfirmationText,doneButtonText:m.default.deleteButtonText,closeButtonText:m.default.cancelButtonText,closeButtonAriaLabel:m.default.close}};r.__decorate([o.autobind],e.prototype,"_endEdit",null);r.__decorate([o.autobind],e.prototype,"_onClickUploadButton",null);r.__decorate([o.autobind],e.prototype,"_onDeleteAttachment",null);r.__decorate([o.autobind],e.prototype,"_onDeleteConfirmed",null);r.__decorate([o.autobind],e.prototype,"_deleteAttachment",null);r.__decorate([o.autobind],e.prototype,"_onFileChange",null);return e}(i.BaseReactFieldEditor);t.AttachmentsEditor=s;t.default=s});define("aac",["require","exports","ap","aad"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("aad",["require","exports","ap","at","xH","wN","jP"],function(e,t,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isOpen:!e.hidden||!0};return t}e.prototype.componentWillReceiveProps=function(e){this.setState({isOpen:!e.hidden||!0})};e.prototype.render=function(){var e=this.props.strings;return o.createElement(n.Dialog,{isOpen:this.state.isOpen,type:n.DialogType.close,title:e.title,subText:e.subtext,onDismiss:this._onClose,isBlocking:!1,closeButtonAriaLabel:e.closeButtonAriaLabel},o.createElement(n.DialogFooter,null,this.props.showDoneButton&&o.createElement(a.DefaultButton,{onClick:this._onDone},e.doneButtonText),o.createElement(a.PrimaryButton,{onClick:this._onClose},e.closeButtonText)))};e.prototype._onDone=function(){this.props.onDone&&this.props.onDone();this.setState({isOpen:!1})};e.prototype._onClose=function(){this.props.onClose&&this.props.onClose();this.setState({isOpen:!1})};r.__decorate([s.autobind],e.prototype,"_onDone",null);r.__decorate([s.autobind],e.prototype,"_onClose",null);return e}(o.Component);t.WarningDialog=i});define("Y2",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.View=0]="View";e[e.Edit=1]="Edit"}(t.ReactFieldEditorMode||(t.ReactFieldEditorMode={}))});define("YZ",["require","exports","ap","at","l8","BZ","wN","jP","aL","o1","mo","V","Y2","Y1","Y0"],function(e,t,i,a,r,s,l,d,c,u,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(n,o);function n(e){var t=o.call(this,e)||this;t._renderWidth=190;t._inputElementMaxLength=t.props.field.schema.MaxLength;void 0===t._inputElementMaxLength&&(t._inputElementMaxLength=n.PROPERTY_MAX_LENGTH);t._deferredValidationTime=n.DEFERRED_VALIDATION_TIME;var i=t._getStateFromProps(t.props);t._updatedField=c.deepCopy(t.props.field);var r=t.props.field.hasException||t.props.field.clientSideErrorMessage;i.mode=e.interactiveSave&&!r?h.ReactFieldEditorMode.View:h.ReactFieldEditorMode.Edit;t.state=i;return t}n.prototype.componentDidMount=function(){this._postRender()};n.prototype.componentDidUpdate=function(){this._postRender()};n.prototype.componentWillReceiveProps=function(e){var t=this,i=this._getStateFromProps(e);if(1===this.state.field.state&&0===e.field.state&&!e.field.hasException){i.isNewlySaved=!0;setTimeout(function(){t.setState({isNewlySaved:!1})},1e3)}this.setState(i)};n.prototype.setMode=function(e,t){if(!this._isReadOnlyField()||e!==h.ReactFieldEditorMode.Edit){this.setState({mode:e});this._isUserSwitchingToEditMode=t;this.props.onChangeMode(this.state.field,e)}};n.prototype.getData=function(){};n.prototype.render=function(){var e=this.state.mode===h.ReactFieldEditorMode.View?this._renderRenderer():this._renderEditor();return e?a.createElement("div",{className:"ReactFieldEditor","data-automationtype":"clientFormField"},this._renderLabel(),e,this._renderEditButton(),this._renderState()):void 0};n.prototype.isUpdated=function(e){var t=!0,i=this.state.field.serverData;void 0!==e&&"object"!=typeof i&&(t=e!==i);return t};n.prototype.cancelEdit=function(){this._updatedField=c.deepCopy(this.state.field);this._updatedField.data=this._updatedField.serverData;var e=!1;if(this._updatedField.hasException||this._updatedField.clientSideErrorMessage){this._updatedField.clientSideErrorMessage="";this._updatedField.hasException=!1;this._updatedField.errorMessage="";e=!0}this._shouldViewerRegainFocus=!0;this.setState({mode:this._getModeAfterEdit(),field:this._updatedField});this.props.interactiveSave&&e&&this.props.onSave(this._updatedField)};n.prototype._renderLabel=function(){return a.createElement(s.Label,{className:"ReactFieldEditor-fieldTitle",required:this.props.field.schema.Required},this.state.field.schema.Title)};n.prototype._renderRenderer=function(){var t=this,e=this.state.field.data||this.props.field.schema.AppendOnly?this._getRenderer():this._renderPlaceHolder();this._showInvisibleRegionOnDispayMode&&(e=a.createElement("div",{className:"ReactFieldEditor-rendererContainer-withInvisibleRegion"},e));return a.createElement("div",{className:d.css("ReactFieldEditor-core--display",{"is-infoPane":this.props.isInfoPane}),onClick:this._startEdit,onKeyPress:this._keyPress,role:"button",ref:function(e){t._focusElement=e},"aria-label":this._getAriaLabel(),tabIndex:0},e)};n.prototype._getAriaLabel=function(){var e=this.state.field.data||f.default.EmptyFieldAriaLabel,t=this.state.field.schema.Required?m.format(f.default.RequiredFieldAriaLabel,this.state.field.schema.Title):this.state.field.schema.Title;t=t+", "+(e.displayName?e.displayName:e);return t=m.format(f.default.PressEnterToEditAriaLabel,t)};n.prototype._renderAppendedData=function(){};n.prototype._renderEditor=function(){var e=this._getEditor();return e?a.createElement("span",{className:d.css("ReactFieldEditor-core--edit",{"is-interactiveSave":this.props.interactiveSave}),onKeyDown:this._onEditorKeyDown},e,a.createElement("div",{className:"ReactFieldEditor-fieldDescription"},this._getFieldDescription()),this.props.field.schema.AppendOnly&&this._renderAppendedData()):void 0};n.prototype._renderEditButton=function(){var e=this,t=this.state,i=t.inlineEdit,r=t.mode;return!i||i&&this.props.field.schema.AppendOnly&&r===h.ReactFieldEditorMode.View?a.createElement(l.IconButton,{className:"ReactFieldEditor-editButton",iconProps:{iconName:"Edit"},title:f.default.EditButtonAriaLabel,onClick:function(){return e._editButtonOnClick()}}):null};n.prototype._renderState=function(){var e=this._renderErrorMsg(),t=!e&&this.props.interactiveSave;return a.createElement("div",{className:"ReactFieldEditor-state"},e,t&&this._renderFieldState())};n.prototype._renderFieldState=function(){var e,t,i,r=this.state.field;if(1===r.state){e=f.default.SavingState;t=a.createElement(u.Spinner,{className:"ReactFieldEditor-stateIndicator",size:u.SpinnerSize.xSmall});i=m.format(f.default.FieldSavingReadoutText,r.schema.Title)}else if(this.state.isNewlySaved){e=f.default.SavedState;t=a.createElement(p.Icon,{iconName:"CheckMark",className:"ReactFieldEditor-stateIndicator"});i=m.format(f.default.FieldSavedReadoutText,r.schema.Title)}return e&&a.createElement("div",{className:"ReactFieldEditor-stateMessageContainer"},t,e,a.createElement("span",{role:"alert",className:"ReactFieldEditor-accessible"},i))};n.prototype._renderErrorMsg=function(){var e=this.state.field.clientSideErrorMessage?this.state.field.clientSideErrorMessage:this.state.field.errorMessage;return e?a.createElement("div",{className:"ReactFieldEditor-required"},e):null};n.prototype._renderPlaceHolder=function(){return a.createElement("div",{className:d.css("ReactFieldEditor-placeHolder",{"is-required":this.props.field.schema.Required})},this._getPlaceHolderString())};n.prototype._postRender=function(){if(this.state.mode===h.ReactFieldEditorMode.Edit){if(this.props.shouldGetFocus||this._isUserSwitchingToEditMode){this._focusOnEditorIfNeeded();this._isUserSwitchingToEditMode=!1}}else if(this.state.mode===h.ReactFieldEditorMode.View&&this._shouldViewerRegainFocus&&this._focusElement){this._focusElement.focus();this._shouldViewerRegainFocus=!1}};n.prototype._getFieldDescription=function(){return this.props.field&&this.props.field.schema&&this.props.field.schema.Description||""};n.prototype.validate=function(){if(this._updatedField){!this.props.field.schema.Required||this._updatedField.data||this.props.isBulkEdit?this._updatedField.clientSideErrorMessage="":this._updatedField.clientSideErrorMessage=f.default.RequiredField;return this._updatedField.clientSideErrorMessage}};n.prototype._editButtonOnClick=function(){this.setMode(h.ReactFieldEditorMode.Edit)};n.prototype._getRenderer=function(){var e={text:this._getRendererText()};return r.TextRenderer(e)};n.prototype._getPlaceHolderString=function(){return f.default.DefaultEditorPlaceHolder};n.prototype._getRendererText=function(){return this.state.field.data&&this.state.field.data.toString()||""};n.prototype._getEditor=function(){return this._getRenderer()};n.prototype._startEdit=function(e){this.setMode(h.ReactFieldEditorMode.Edit,!0)};n.prototype._shouldSaveDataOnEnter=function(){return!0};n.prototype._onEditorKeyDown=function(e){13===e.which&&this.props.interactiveSave&&this.state.inlineEdit&&this._shouldSaveDataOnEnter()?this.saveData():27===e.which&&this.cancelEdit()};n.prototype._onSave=function(e){this._updatedField=c.deepCopy(this.state.field);this._updatedField.data=e;this.validate();var t=!1;if(this._updatedField.hasException){this._updatedField.hasException=!1;this._updatedField.errorMessage="";t=!0}this.setState({mode:this._getModeAfterEdit(),field:this._updatedField});this.props.interactiveSave&&(t||this.isUpdated(e))&&this.props.onSave(this._updatedField)};n.prototype._keyPress=function(e){13!==e.which&&32!==e.which||this._startEdit(e)};n.prototype._getModeAfterEdit=function(){return this._updatedField.clientSideErrorMessage||this._updatedField.hasException||!this.props.interactiveSave?h.ReactFieldEditorMode.Edit:h.ReactFieldEditorMode.View};n.prototype._isInlineEdit=function(){return!0};n.prototype._getStateFromProps=function(e){this._isUserSwitchingToEditMode=!1;return{field:c.deepCopy(e.field),inlineEdit:this._isInlineEdit()}};n.prototype._getArrayFromSPString=function(e){return e?e.split(n.ARRAY_DELIMITER).filter(function(e){return e&&0<e.length}):[]};n.prototype._isReadOnlyField=function(){return this.props.field.schema.ReadOnlyField};n.ARRAY_DELIMITER=";#";n.PROPERTY_MAX_LENGTH=255;n.DEFERRED_VALIDATION_TIME=200;i.__decorate([d.autobind],n.prototype,"_getAriaLabel",null);i.__decorate([d.autobind],n.prototype,"_startEdit",null);i.__decorate([d.autobind],n.prototype,"_onEditorKeyDown",null);i.__decorate([d.autobind],n.prototype,"_keyPress",null);return n}(d.BaseComponent);t.BaseReactFieldEditor=o;t.default=o});define("Y0",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ReactFieldEditor{padding:8px 3px;position:relative}.ReactFieldEditor .ReactFieldEditor-fieldTitle{font-weight:600;font-size:14px}.ReactFieldEditor .ReactFieldEditor-rendererContainer-withInvisibleRegion{width:calc(100% - 64px);overflow:hidden;text-overflow:ellipsis}.ReactFieldEditor .ReactFieldEditor-core--display{display:inline-block;vertical-align:top;width:100%;font-size:14px;font-weight:400;outline:0;padding:0 0 5px;border-bottom:1px solid transparent}.ReactFieldEditor .ReactFieldEditor-core--display:focus{border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.ReactFieldEditor .ReactFieldEditor-core--display .od-FieldRenderer-text{max-height:none}.ReactFieldEditor .ReactFieldEditor-core--display .od-FieldRenderer-text.is-truncated:after{background:linear-gradient(to bottom, rgba(0, 0, 0, 0), "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 100%)}.ReactFieldEditor .ReactFieldEditor-core--edit{display:inline-block;vertical-align:top;width:100%}.ReactFieldEditor .ReactFieldEditor-core--edit .ms-Dropdown-container .ms-Dropdown-title{border:0;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";outline:0;font-size:14px;padding:0;min-width:170px;min-height:32px;transition:background-color .2s ease,padding-left .2s ease}[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-Dropdown-container .ms-Dropdown-title{padding-left:0}[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-Dropdown-container .ms-Dropdown-title{padding-right:0}.ReactFieldEditor .ReactFieldEditor-core--edit .ms-Dropdown-container .ms-Dropdown-title:hover{border-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.ReactFieldEditor .ReactFieldEditor-core--edit .ms-Dropdown-container .is-open .ms-Dropdown-title,.ReactFieldEditor .ReactFieldEditor-core--edit .ms-Dropdown-container div:focus .ms-Dropdown-title{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-Dropdown-container .is-open .ms-Dropdown-title,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-Dropdown-container div:focus .ms-Dropdown-title{padding-left:12px}[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-Dropdown-container .is-open .ms-Dropdown-title,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-Dropdown-container div:focus .ms-Dropdown-title{padding-right:12px}.ReactFieldEditor .ReactFieldEditor-core--edit .ms-TextField-field{border:0;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";outline:0;font-size:14px;padding:6px 12px;min-width:170px;min-height:32px;transition:background-color .2s ease,padding-left .2s ease}[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-TextField-field{padding-left:0}[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-TextField-field{padding-right:0}.ReactFieldEditor .ReactFieldEditor-core--edit .ms-TextField-field:focus{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-TextField-field:focus{padding-left:12px}[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-TextField-field:focus{padding-right:12px}.ReactFieldEditor .ReactFieldEditor-core--edit .ms-BasePicker-input{font-size:14px;transition:background-color .2s ease,padding-left .2s ease}[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-BasePicker-input{padding-left:10px}[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-BasePicker-input{padding-right:10px}[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-BasePicker-input:focus{padding-left:12px}[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ms-BasePicker-input:focus{padding-right:12px}.ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-fieldDescription{font-size:12px;color:"},{theme:"bodySubtext",defaultValue:"#666666"},{rawString:";margin-top:4px}[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Note-Plain .ms-BasePicker-input,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Note-Plain .ms-Dropdown-title,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Note-Plain .ms-TextField-field,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Picture .ms-BasePicker-input,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Picture .ms-Dropdown-title,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Picture .ms-TextField-field,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .sp-DateTimePicker .ms-BasePicker-input,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .sp-DateTimePicker .ms-Dropdown-title,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit .sp-DateTimePicker .ms-TextField-field,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit:not(.is-interactiveSave) .ms-BasePicker-input,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit:not(.is-interactiveSave) .ms-Dropdown-title,[dir=ltr] .ReactFieldEditor .ReactFieldEditor-core--edit:not(.is-interactiveSave) .ms-TextField-field{padding-left:12px}[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Note-Plain .ms-BasePicker-input,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Note-Plain .ms-Dropdown-title,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Note-Plain .ms-TextField-field,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Picture .ms-BasePicker-input,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Picture .ms-Dropdown-title,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .ReactFieldEditor-Picture .ms-TextField-field,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .sp-DateTimePicker .ms-BasePicker-input,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .sp-DateTimePicker .ms-Dropdown-title,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit .sp-DateTimePicker .ms-TextField-field,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit:not(.is-interactiveSave) .ms-BasePicker-input,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit:not(.is-interactiveSave) .ms-Dropdown-title,[dir=rtl] .ReactFieldEditor .ReactFieldEditor-core--edit:not(.is-interactiveSave) .ms-TextField-field{padding-right:12px}.ReactFieldEditor .ReactFieldEditor-state{margin-top:4px;font-size:12px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";transition:height .15s ease}.ReactFieldEditor .ReactFieldEditor-stateMessageContainer{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}[dir=ltr] .ReactFieldEditor .ReactFieldEditor-stateIndicator{margin-right:4px}[dir=rtl] .ReactFieldEditor .ReactFieldEditor-stateIndicator{margin-left:4px}.ReactFieldEditor .ReactFieldEditor-placeHolder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:14px;font-weight:400}.ReactFieldEditor .ReactFieldEditor-placeHolder.is-required{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.ReactFieldEditor .ReactFieldEditor-required{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.ReactFieldEditor .ReactFieldEditor-Button{width:32px;height:32px;min-width:32px;min-height:32px;padding:0}.ReactFieldEditor .ReactFieldEditor-editButton{position:absolute;top:6px}html[dir=ltr] .ReactFieldEditor .ReactFieldEditor-editButton{right:3px}html[dir=rtl] .ReactFieldEditor .ReactFieldEditor-editButton{left:3px}.ReactFieldEditor .ReactFieldEditor-accessible{position:absolute;top:-9001px;left:-9001px;height:1px;width:1px}[dir=ltr] .ms-ComboBox-option.ms-Button+.ms-Button{margin-left:0}[dir=rtl] .ms-ComboBox-option.ms-Button+.ms-Button{margin-right:0}"}])});define("aaa",["require","exports","ap","at","wN","aab"],function(e,t,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.attachment,i=t&&t.serverUrl||"#",r=t.uploaded,o=t&&t.fileName||"";return n.createElement("div",{className:"React-Attachment"},r?n.createElement(a.DefaultButton,{className:"React-Attachment--uploaded",href:i,target:"_blank",title:o},o):n.createElement("span",{className:"React-Attachment--nativeFile"},o),this.props.onRemove?n.createElement(a.IconButton,{className:"React-Attachment--remove",onClick:function(){return e._onRemoveClick()},iconProps:{iconName:"Cancel"}}):null)};t.prototype._onRemoveClick=function(){this.props.onRemove&&this.props.onRemove(this.props.attachment)};return t}(n.Component);t.Attachment=r});define("aab",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".React-Attachment{margin:4px;white-space:nowrap;line-height:32px}.React-Attachment--uploaded+.React-Attachment--remove{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}html[dir=ltr] .React-Attachment--uploaded+.React-Attachment--remove{margin-left:0}html[dir=rtl] .React-Attachment--uploaded+.React-Attachment--remove{margin-right:0}.React-Attachment--remove{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer}.React-Attachment--remove:focus,.React-Attachment--remove:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.React-Attachment--remove:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.React-Attachment--remove:hover{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}.React-Attachment--uploaded{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";padding-left:0;padding-right:0;min-width:0}.React-Attachment--uploaded:focus,.React-Attachment--uploaded:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.React-Attachment--uploaded:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.React-Attachment--uploaded .ms-Button-label{overflow:hidden;text-overflow:ellipsis;max-width:160px;line-height:32px;font-size:14px;font-weight:400}.React-Attachment--nativeFile{overflow:hidden;text-overflow:ellipsis;max-width:160px;margin-left:4px;margin-right:4px;font-size:14px;font-weight:400}"}])});define("Z8",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ReactFieldEditor-Attachments{display:-ms-flexbox;display:flex}.ReactFieldEditor-Attachments-EditContainer{display:inline-block;width:100%;overflow:auto;min-height:inherit;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.ReactFieldEditor-Attachments-EditContainer:focus{outline:1px solid transparent;border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ReactFieldEditor-Attachments-UploadContainer{padding:4px 8px 4px 8px;margin-top:5px}html[dir=rtl] .ReactFieldEditor-Attachments-UploadContainer{padding:4px 8px 4px 8px}.ReactFieldEditor-Attachments-UploadContainer .ReactFieldEditor-Attachments-UploadLink{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;font-size:14px;font-weight:400}.ReactFieldEditor-Attachments-UploadContainer .ReactFieldEditor-Attachments-UploadLink:focus,.ReactFieldEditor-Attachments-UploadContainer .ReactFieldEditor-Attachments-UploadLink:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.ReactFieldEditor-Attachments-UploadContainer .ReactFieldEditor-Attachments-UploadLink:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ReactFieldEditor-Attachments-UploadInput{display:none}.ReactFieldEditor-Attachments-Renderer .ms-Link{white-space:normal}"}])});define("Z5",["require","exports","ap","at","IY","jP","Y2","YZ","Z6"],function(e,t,r,o,n,a,s,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._checkedValue="1"===t.props.field.data;return t}e.prototype.getData=function(){return this._checkedValue?"1":"0"};e.prototype.saveData=function(){this.state.mode===s.ReactFieldEditorMode.Edit&&this._onSave(this.getData())};e.prototype._getEditor=function(){var t=this;return o.createElement(n.Toggle,{defaultChecked:this._checkedValue,onAriaLabel:l.default.onAriaLabel,offAriaLabel:l.default.offAriaLabel,onText:l.default.yes,offText:l.default.no,componentRef:function(e){return t._toggle=e},onBlur:this._endEdit,onChanged:this._onChange})};e.prototype._focusOnEditorIfNeeded=function(){this._toggle&&this._toggle.focus()};e.prototype._onEditorKeyDown=function(e){27===e.which&&this.cancelEdit()};e.prototype._endEdit=function(e){this.setMode(this._getModeAfterEdit())};e.prototype._getRendererText=function(){return this._checkedValue?l.default.yes:l.default.no};e.prototype._onChange=function(e){this._checkedValue=e;this.saveData()};r.__decorate([a.autobind],e.prototype,"_onEditorKeyDown",null);r.__decorate([a.autobind],e.prototype,"_endEdit",null);r.__decorate([a.autobind],e.prototype,"_onChange",null);return e}(i.BaseReactFieldEditor);t.BooleanFieldEditor=d;t.default=d});define("Z4",["require","exports","ap","at","Dn","jP","YZ"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getData=function(){return this.state.field.data};t.prototype.saveData=function(){this.setMode(this._getModeAfterEdit())};t.prototype._getRendererText=function(){return this.state.field.data&&this.state.field.data.displayName||""};t.prototype._getEditor=function(){var t=this;this._populateChoiceOptions();return r.createElement(o.Dropdown,{placeHolder:this._getPlaceHolderString(),options:this._options,defaultSelectedKey:this._getChoiceKey(this.state.field.data),onChanged:this._endEdit,onBlur:this._onBlur,onDismiss:this._onBlur,componentRef:function(e){return t._dropdown=e}})};t.prototype._focusOnEditorIfNeeded=function(){this._dropdown&&this._dropdown.focus(!0)};t.prototype._endEdit=function(e){var t=this,i=this.props.switchContentType;this._selectedContentType=e&&e.data;this._selectedContentType&&(i?i(this._selectedContentType).then(function(){t._onSave(t._selectedContentType)}):this._onSave(this._selectedContentType))};t.prototype._onBlur=function(){this.setMode(this._getModeAfterEdit())};t.prototype._populateChoiceOptions=function(){var e=this.props.field&&this.props.field.schema&&this.props.field.schema.ContentTypes;if(e){this._options=[];for(var t=0,i=e;t<i.length;t++){var r=i[t];this._options.push({key:this._getChoiceKey(r),text:r.displayName,data:r})}}};t.prototype._getChoiceKey=function(e){return e.displayName};i.__decorate([n.autobind],t.prototype,"_endEdit",null);i.__decorate([n.autobind],t.prototype,"_onBlur",null);return t}(a.BaseReactFieldEditor);t.ContentTypeFieldEditor=s;t.default=s});define("Z3",["require","exports","ap","at","jP","hs","Y2","YZ","Ja","I8","Z1"],function(e,t,i,o,n,a,s,r,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.state=i.__assign({},t.state);return t}e.prototype.getData=function(){return this._dateTimePicker.getData()};e.prototype.isUpdated=function(e){var t=this.state,i=t.parsedServerDateTime,r=t.field;if(!i&&!e)return!1;if(!i||!e)return!0;var o=l.default.parseDate(e,r.schema);return o.Date!==i.Date||o.Hour!==i.Hour||o.Minute!==i.Minute};e.prototype.saveData=function(){if(this.state.mode===s.ReactFieldEditorMode.Edit){var e=this.getData();this._onSave(e)}};e.prototype.cancelEdit=function(){r.prototype.cancelEdit.call(this);this._dateTimePicker.cancelEdit(this.state.field.serverData)};e.prototype._getStateFromProps=function(e){var t=r.prototype._getStateFromProps.call(this,e),i=e.field&&e.field.serverData;t.parsedServerDateTime=i?l.default.parseDate(i,e.field.schema):i;return t};e.prototype._getEditor=function(){var e=this.state.field,t=e.schema,i=e.data;return o.createElement(d.DateTimePicker,{schema:t,data:i,pageContext:this.props.pageContext,displayFormat:t.DisplayFormat,underlined:!1,endEdit:this._endEdit,ref:this._resolveRef("_dateTimePicker")})};e.prototype._getRendererText=function(){var e=this.state.field.schema.Name||"",t=this.props.item.properties[e+".FriendlyDisplay"];return(t=t?a.getRelativeDateTimeStringForLists(t):this.props.item.properties[e])||""};e.prototype._focusOnEditorIfNeeded=function(){this._dateTimePicker.focusOnEditorIfNeeded()};e.prototype._endEdit=function(e){this.saveData()};i.__decorate([n.autobind],e.prototype,"_endEdit",null);return e}(r.BaseReactFieldEditor);t.DateTimeFieldEditor=c});define("Z1",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ReactFieldEditor-DateTime-DateContainer{display:-ms-flexbox;display:flex}.ReactFieldEditor-DateTime-DateContainer.is-focused .ReactFieldEditor-DateTime-DateButton,.ReactFieldEditor-DateTime-DateContainer.is-focused .ms-TextField-field{border-bottom-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ReactFieldEditor-DateTime-Date{-ms-flex-positive:1;flex-grow:1}.ReactFieldEditor-DateTime-DateButton{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-left-width:0;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.ReactFieldEditor-DateTime-Time{margin-top:8px}.ReactFieldEditor-DateTime-iFrame{border-style:none;width:200px;height:212px}"}])});define("Z0",["require","exports","ap","at","BT","jP","wN","wE","Jc","eq","U","aM","d","hs","Y2","YZ","Z2","Z1"],function(e,t,d,c,u,p,m,h,f,i,r,o,n,a,s,l,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y;!function(e){e[e.DateOnly=0]="DateOnly";e[e.DateTime=1]="DateTime"}(y||(y={}));var v=n.getTheme(),_=function(l){d.__extends(e,l);function e(e){var t=l.call(this,e)||this;t._isAMPMFirst=null;var i=t.state.field.schema;t._dateEditorElement=null;t._dateOnly=0===i.DisplayFormat;t._dateOnly||t._populateTimeChoiceArray();t._iframeBaseUrl=null;t._editorHasFocus=!1;var r=t._parseDate(t.state.field.data,i),o=r.Date,n="";if(!t._dateOnly){var a=t.state.field.schema;n=a.HoursOptions[Number(r.Hour)];if(a.HoursMode24||!1!==t._isAMPMFirst){-1===n.indexOf(a.TimeSeparator)&&(n+=a.TimeSeparator);n+=r.Minute}else{var s=n.split(" ");n=s[0]+a.TimeSeparator+r.Minute+" "+s[1]}}t.state=d.__assign({},t.state,{latestDate:o,latestTime:n});return t}e.prototype.getData=function(){return this._getLatestDateTimeValue()};e.prototype.isUpdated=function(e){var t=this.state,i=t.parsedServerDateTime,r=t.field;if(!i&&!e)return!1;if(!i||!e)return!0;var o=this._parseDate(e,r.schema);return o.Date!==i.Date||o.Hour!==i.Hour||o.Minute!==i.Minute};e.prototype.saveData=function(){if(this.state.mode===s.ReactFieldEditorMode.Edit){var e=this._getLatestDateTimeValue();this._onSave(e)}};e.prototype.cancelEdit=function(){l.prototype.cancelEdit.call(this);var e=this.state.field,t=this._parseDate(e.serverData,e.schema);this.setState({latestDate:t.Date})};e.prototype._getStateFromProps=function(e){var t=l.prototype._getStateFromProps.call(this,e),i=e.field&&e.field.serverData;t.parsedServerDateTime=i?this._parseDate(i,e.field.schema):i;return t};e.prototype._getEditor=function(){var t=this,e=this.state,i=e.isDateContainerFocused,r=e.isEditingPanelOpen,o=this._getDateTimeIframeControlUrl(),n=o?c.createElement(m.IconButton,{className:"ReactFieldEditor-DateTime-DateButton",iconProps:{iconName:"Calendar"},title:g.default.calendarButtonTitle,ariaLabel:g.default.openCalendarButtonLabel,onClick:function(){return t._dateEditButtonOnClick()},onFocus:this._onDatePickerButtonFocus,onBlur:this._onDatePickerButtonBlur}):null,a=this.state.isEditingPanelOpen&&o?c.createElement(h.Callout,{isBeakVisible:!1,gapSpace:0,directionalHint:4,directionalHintFixed:!0,target:this._dateEditorElement,onDismiss:this._onDatePickerDismiss},c.createElement("iframe",{className:"ms-slideDownIn20 ReactFieldEditor-DateTime-iFrame",src:o,onLoad:this._onDatePIckerLoad,ref:function(e){t._frame=e}})):null,s=this._dateOnly?null:c.createElement(f.ComboBox,{styles:{root:{borderColor:v.semanticColors.inputBorder,borderTopWidth:0,borderLeftWidth:0,borderRightWidth:0,marginBottom:0}},className:"ReactFieldEditor-DateTime-Time",allowFreeform:!0,value:this.state.latestTime,options:this._timeChoices,onChanged:this._onTimeChange,onBlur:this._onDateTimeEditorBlur,onFocus:this._setEditorFocusStatus,ariaLabel:g.default.timeInputLabel});return c.createElement("div",{className:"ReactFieldEditor-DateTime"},c.createElement("div",{ref:function(e){return t._dateEditorElement=e},className:p.css("ReactFieldEditor-DateTime-DateContainer",{"is-focused":i||r})},c.createElement(u.TextField,{placeholder:g.default.datePlaceHolder,ariaLabel:g.default.dateInputLabel,className:"ReactFieldEditor-DateTime-Date",value:this.state.latestDate,onChanged:this._onDateEditorChanged,borderless:!0,onBlur:this._onDateEditorBlur,onFocus:this._onDateEditorFocus,componentRef:function(e){return t._dateEditor=e}}),n),s,a)};e.prototype.componentWillUnmount=function(){this._frame&&(this._frame.src="")};e.prototype._getRendererText=function(){var e=this.state.field.schema.Name||"",t=this.props.item.properties[e+".FriendlyDisplay"];return(t=t?a.getRelativeDateTimeStringForLists(t):this.props.item.properties[e])||""};e.prototype._onDateEditorFocus=function(e){this._setEditorFocusStatus();this._dateEditor&&this._dateEditor.select();this.setState({isDateContainerFocused:!0})};e.prototype._onDateEditorBlur=function(e){this.setState({isDateContainerFocused:!1});this._onDateTimeEditorBlur(e)};e.prototype._onDateTimeEditorBlur=function(e){var t=this;this._editorHasFocus=!1;this._timeOut=this._async.setTimeout(function(){return t._endEdit(e)},100)};e.prototype._onDatePickerButtonFocus=function(e){this.setState({isDateContainerFocused:!0});this._setEditorFocusStatus()};e.prototype._onDatePickerButtonBlur=function(e){this._editorHasFocus=!1;this.setState({isDateContainerFocused:!1})};e.prototype._focusOnEditorIfNeeded=function(){if(this._dateEditor&&!this._editorHasFocus){this._dateEditor.focus();this._dateEditor.select()}};e.prototype._endEdit=function(e){this.saveData()};e.prototype._dateEditButtonOnClick=function(){this._async.clearTimeout(this._timeOut);this._editorHasFocus=!0;var e=this.state.isEditingPanelOpen;this.setState({isEditingPanelOpen:!e})};e.prototype._onTimeChange=function(e,t,i){var r=this,o=e&&e.text;o||(o=i);this.setState({latestTime:o});this._timeOut=this._async.setTimeout(function(){return r._endEdit(null)},100)};e.prototype._setEditorFocusStatus=function(){this._editorHasFocus=!0;this._timeOut&&this._async.clearTimeout(this._timeOut)};e.prototype._onDateEditorChanged=function(e){this.setState({latestDate:e})};e.prototype._onDatePIckerLoad=function(){var r=this;if(this._frame){this._frame.resultfield||(this._frame.resultfield=this._dateEditor);void 0===this._frame.firstUp&&(this._frame.firstUp=!0);this._frame.OnSelectDateCallback||(this._frame.OnSelectDateCallback=function(e,t,i){r._dateEditor.focus();r.setState({isEditingPanelOpen:!1,latestDate:t})})}};e.prototype._onDatePickerDismiss=function(){this._editorHasFocus=!1;this.setState({isEditingPanelOpen:!1})};e.prototype._getLatestDateTimeValue=function(e){var t=e?e.trim():this._dateEditor.value.trim(),i=this.state.field.schema;if(!this._dateOnly){var r=i.HoursMode24?this.state.latestTime:this._convertTimeTo24Hour(this.state.latestTime);t=""===t?"":t+" "+r}return t};e.prototype._convertTimeTo24Hour=function(e){var t=e.toUpperCase(),i=this._AMDesignator.toUpperCase(),r=this._PMDesignator.toUpperCase(),o=t.indexOf(i),n=t.indexOf(r);if(-1!==o){var a=(t=t.replace(i,"")).split(":");if(12===(s=Number(a[0]))){a[0]=String(0);t=a.join(":")}}else if(-1!==n){var s;a=(t=t.replace(r,"")).split(":");if(12!==(s=Number(a[0]))){a[0]=String(s+12);t=a.join(":")}}return t.replace(/\s+/g,"")};e.prototype._parseDate=function(e,t){var i={Hour:"0",Minute:"00",Date:e?e.trim():""};if(!e)return i;var r=t.TimeSeparator?e.lastIndexOf(t.TimeSeparator):-1;if(-1===r||r===e.length-1)return i;var o=e.substring(r+1),n=Number(o);if(isNaN(n))return i;i.Minute=n<10?"0"+String(n):o;var a=e.substring(0,r),s=a.lastIndexOf(" ");if(-1===s||s===a.length-1)return i;var l=a.substring(s+1);if(isNaN(Number(l)))return i;i.Hour=l;i.Date=a.substring(0,s);return i};e.prototype._populateTimeChoiceArray=function(){var e=this.state.field.schema;this._timeChoices=[];if(e.HoursMode24)for(var t=0,i=e.HoursOptions;t<i.length;t++){var r=i[t];this._timeChoices.push({key:r+"00",text:r+"00"});this._timeChoices.push({key:r+"30",text:r+"30"})}else for(var o=e.TimeSeparator,n=0;n<e.HoursOptions.length;n++){var a=(r=e.HoursOptions[n]).split(" ");null===this._isAMPMFirst&&(isNaN(parseInt(a[0],10))?this._isAMPMFirst=!0:this._isAMPMFirst=!1);0===n&&(this._AMDesignator=this._isAMPMFirst?a[0]:a[1]);12===n&&(this._PMDesignator=this._isAMPMFirst?a[0]:a[1]);this._timeChoices.push({key:n+o+"00",text:this._isAMPMFirst?r+o+"00":a[0]+o+"00 "+a[1]});this._timeChoices.push({key:n+o+"30",text:this._isAMPMFirst?r+o+"30":a[0]+o+"30 "+a[1]})}};e.prototype._getDateTimeIframeControlUrl=function(){null===this._iframeBaseUrl&&(this._iframeBaseUrl=this._getDateTimeIframeControlBaseUrl());if(this._iframeBaseUrl){var e=this._parseDate(this.state.field.data,this.state.field.schema);return this._iframeBaseUrl+"&date="+o.default.encodeURIComponent(e.Date)}return""};e.prototype._getDateTimeIframeControlBaseUrl=function(){var e=this.state.field.schema,t=this._getDateTimeControlIframeUrl();return t?t+"?cal="+r.default.encodeText(String(e.CalendarType))+"&lcid="+r.default.encodeText(String(e.LocaleId))+"&langid="+r.default.encodeText(String(e.LanguageId))+"&&tz="+r.default.encodeText(String(e.TimeZoneDifference))+"&ww="+r.default.encodeText(String(e.WorkWeek))+"&fdow="+r.default.encodeText(String(e.FirstDayOfWeek))+"&fwoy="+r.default.encodeText(String(e.FirstWeekOfYear))+"&hj="+r.default.encodeText(String(e.HijriAdjustment))+"&swn="+r.default.encodeText(String(e.ShowWeekNumber))+"&minjday="+r.default.encodeText(String(e.MinJDay))+"&maxjday="+r.default.encodeText(String(e.MaxJDay)):""};e.prototype._getDateTimeControlIframeUrl=function(){return this.props.pageContext&&this.props.pageContext.layoutsUrl?i.getSafeWebServerRelativeUrl(this.props.pageContext)+"/"+this.props.pageContext.layoutsUrl+"/iframe.aspx":""};d.__decorate([p.autobind],e.prototype,"_onDateEditorFocus",null);d.__decorate([p.autobind],e.prototype,"_onDateEditorBlur",null);d.__decorate([p.autobind],e.prototype,"_onDateTimeEditorBlur",null);d.__decorate([p.autobind],e.prototype,"_onDatePickerButtonFocus",null);d.__decorate([p.autobind],e.prototype,"_onDatePickerButtonBlur",null);d.__decorate([p.autobind],e.prototype,"_endEdit",null);d.__decorate([p.autobind],e.prototype,"_dateEditButtonOnClick",null);d.__decorate([p.autobind],e.prototype,"_onTimeChange",null);d.__decorate([p.autobind],e.prototype,"_setEditorFocusStatus",null);d.__decorate([p.autobind],e.prototype,"_onDateEditorChanged",null);d.__decorate([p.autobind],e.prototype,"_onDatePIckerLoad",null);d.__decorate([p.autobind],e.prototype,"_onDatePickerDismiss",null);return e}(l.BaseReactFieldEditor);t.DateTimeFieldEditor=_});define("ZX",["require","exports","ap","at","BT","jP","Y2","YZ","ZZ","ZY"],function(e,t,r,o,n,a,s,i,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._delayedValidate=t._async.debounce(t._validateInput,t._deferredValidationTime);return t}e.prototype.getData=function(){var e;if(this._textField){e=this._textField.value;this.props.item.extension&&(e+=this.props.item.extension)}return e};e.prototype.saveData=function(){if(this.state.mode===s.ReactFieldEditorMode.Edit){var e=this.getData();this._onSave(e)}};e.prototype._getEditor=function(){var t=this,e=this.state.isFocused,i=this._getFileName();return o.createElement("div",{className:a.css("ReactFieldEditor-File",{"is-focused":e})},o.createElement(n.TextField,{className:"ReactFieldEditor-File-filename",placeholder:this._getPlaceHolderString(),borderless:!0,defaultValue:i,onBlur:this._endEdit.bind(this),onFocus:this._inputOnFocus,onChanged:this._delayedValidate,componentRef:function(e){return t._textField=e}}),o.createElement("span",{className:"ReactFieldEditor-File-extension"},this.props.item.extension))};e.prototype._focusOnEditorIfNeeded=function(){if(this._textField){this._textField.focus();this._textField.select()}};e.prototype._endEdit=function(e){this.setState({isFocused:!1});this.saveData()};e.prototype.validate=function(){i.prototype.validate.call(this);if(this._updatedField.clientSideErrorMessage)return this._updatedField.clientSideErrorMessage;this._updatedField.clientSideErrorMessage=this._validateFileName();return this._updatedField.clientSideErrorMessage};e.prototype._inputOnFocus=function(e){this._textField&&this._textField.select();this.setState({isFocused:!0})};e.prototype._getFileName=function(){var e=this.props.item.extension,t=this.state.field.data;if(t&&e){var i=t.indexOf(e);return 0<=i?t.substr(0,i):t}return t};e.prototype._validateInput=function(){var e=this._validateFileName();if(!e&&this._updatedField.clientSideErrorMessage||e&&!this._updatedField.clientSideErrorMessage){this._updatedField.clientSideErrorMessage=e;this.setState({field:this._updatedField})}};e.prototype._validateFileName=function(){var e=this._textField&&this._textField.value||"",t="",i=this.props.pageContext&&this.props.pageContext.supportPoundStorePath?new RegExp('[/"*:<>?/|/]+'):new RegExp('[/"#%*:<>?/|/]+');"string"==typeof e?0===(e=e.trim()).length?t=l.default.emptyFileNameError:("~"===e[0]||"."===e[0]||0<=e.indexOf(String.fromCharCode(92))||i.test(e))&&(t=this.props.pageContext&&this.props.pageContext.supportPoundStorePath?l.default.invalidNameErrorWithSupportPoundStorePath:l.default.invalidNameError):t=l.default.emptyFileNameError;return t};r.__decorate([a.autobind],e.prototype,"validate",null);r.__decorate([a.autobind],e.prototype,"_inputOnFocus",null);r.__decorate([a.autobind],e.prototype,"_validateInput",null);return e}(i.BaseReactFieldEditor);t.FileFieldEditor=d;t.default=d});define("ZY",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ReactFieldEditor-File.is-focused .ReactFieldEditor-File-extension{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ReactFieldEditor-File-extension{display:table-cell;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";transition:background-color .2s ease;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .ReactFieldEditor-File-extension{padding-right:12px}[dir=rtl] .ReactFieldEditor-File-extension{padding-left:12px}.ReactFieldEditor-File-filename{direction:ltr;display:table-cell;width:100%}"}])});define("ZS",["require","exports","ap","at","BT","Du","jP","wN","U","l8","Y2","YZ","ZV","ZU","ZT"],function(e,t,o,s,r,n,a,l,d,c,u,i,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h="ms-rtegenerate-skip",f="ms-rtegenerate-allskip",g=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._iframeHeight=0;t._latestData=t._getRendererText();return t}e.prototype.getData=function(){!this._isRichText()&&this._textField&&(this._latestData=this._textField.value);return this._latestData};e.prototype.saveData=function(){if(this.state.mode===u.ReactFieldEditorMode.Edit&&this._textField){this._latestData=this._textField.value;this._onSave(this._latestData)}};e.prototype._getRenderer=function(e){var t=this;void 0===e&&(e=!1);var i=this._getRendererText(),r=!1;!i||this.props.field.schema.AppendOnly||this._isRichText()||(i=(i=d.default.encodeText(i)).replace(/\n/g,"<br>"));i&&(255<i.length||4<i.split(/\r|\r\n|\n|<br>/).length)&&(r=!0);var o,n={text:i,isSafeToInnerHTML:!0,isTruncated:r&&!this.state.isShowingFull};if(r){var a=this.state.isShowingFull?m.default.SeeLess:m.default.SeeMore;o=s.createElement("div",{className:"ReactFieldEditor-MoreToggle",onClick:this._onToggleMoreLess,onKeyDown:this._onMoreLessKeyDown,tabIndex:0},a)}return s.createElement("div",{onClick:function(e){return t._onRendererEvent(e)},onKeyDown:function(e){return t._onRendererEvent(e)}},c.TextRenderer(n),o,this.props.field.schema.AppendOnly&&!e&&this._renderAppendedData())};e.prototype._getRendererText=function(){return this.props.field.schema.AppendOnly?"":i.prototype._getRendererText.call(this)};e.prototype._focusOnEditorIfNeeded=function(){if(!this._isRichText()&&this._textField){this._textField.focus();this._textField.select()}};e.prototype._getEditor=function(){return this._isRichText()?this._getRichEditor():this._getPlainEditor()};e.prototype._editButtonOnClick=function(){i.prototype._editButtonOnClick.call(this);this._isRichText()&&this.setState({isEditingPanelOpen:!0})};e.prototype._endEdit=function(e){this.saveData()};e.prototype._getPlaceHolderString=function(){return this._isRichText()?"":i.prototype._getPlaceHolderString.call(this)};e.prototype._shouldSaveDataOnEnter=function(){return!1};e.prototype._isInlineEdit=function(){return!this._isRichText()};e.prototype._renderAppendedData=function(){var e=this.props.field.appendOnlyData;if(e&&0<e.length){for(var t=[],i=0,r=e;i<r.length;i++){var o=r[i];if(o.value){var n=this.props.item.properties&&this.props.item.properties.ID,a={text:o.createdTitle+' (<a href="DispForm.aspx?ID='+n+"&VersionNo="+o.versionId+'">'+o.createdTime+"</a>): "+o.value,isSafeToInnerHTML:!0};t.push(s.createElement("div",{key:o.versionId},c.TextRenderer(a)))}}return s.createElement("div",{className:"ReactFieldEditor-AppendedData"},t)}};e.prototype._onRendererEvent=function(e){this.props.field.schema.AppendOnly&&e.stopPropagation()};e.prototype._isRichText=function(){return this.props.field.schema.RichText&&"1"===this.props.field.schema.RichTextMode.toString()};e.prototype._getRichEditor=function(){var e=this.state.isEditingPanelOpen&&""!==this.props.alternativeEditorUrl,t={url:this.props.alternativeEditorUrl,onLoad:this._onIframeLoaded,panelProps:{type:n.PanelType.largeFixed,headerText:"Edit "+this.state.field.schema.Title,onDismissed:this._onRTEPanelDismissed}},i=e?s.createElement("div",{className:"ReactFieldEditor-TextField",role:"textbox"},s.createElement(p.IframeLoaderPanel,o.__assign({},t))):null,r=this._getRenderer(!0);return s.createElement("div",{className:"ReactFieldEditor-Note-Rich"},r,i)};e.prototype._getPlainEditor=function(){var t=this,e=this.state.field,i=this.props.interactiveSave?s.createElement(l.PrimaryButton,{className:"ReactFieldEditor-Button",iconProps:{iconName:"CheckMark"},onClick:this._endEdit}):void 0;return s.createElement("div",{className:"ReactFieldEditor-Note-Plain"},s.createElement(r.TextField,{multiline:!0,className:"ReactFieldEditor-TextField",placeholder:this._getPlaceHolderString(),borderless:!0,defaultValue:e&&e.data&&!e.schema.AppendOnly?e.data.toString():"",rows:8,onBlur:this._endEdit,componentRef:function(e){return t._textField=e}}),i)};e.prototype._onToggleMoreLess=function(e){e.stopPropagation();e.preventDefault();this.setState({isShowingFull:!this.state.isShowingFull})};e.prototype._onMoreLessKeyDown=function(e){if(13===e.which){e.stopPropagation();e.preventDefault();this.setState({isShowingFull:!this.state.isShowingFull})}};e.prototype._onIframeLoaded=function(e){var t=this;if(e&&e.contentWindow&&e.contentWindow.document){this._iframeHeight=e.clientHeight;var i=e.contentWindow.document;if(this._updateRichTextEditorSize(e)){var r=this._iframeHeight-255;r<95&&(r=95);var o=r+"px";this._overrideStyleInIframe(i,".ms-rtestate-field","min-height: "+o);this._overrideStyleInIframe(i,"#onetIDListForm","width: 100%");this._overrideStyleInIframe(i,"#onetIDListForm table","width: 100%");this._overrideStyleInIframe(i,".ms-formbody","width: 100%");this._overrideStyleInIframe(i,".ms-formtoolbar","display: none");this._overrideStyleInIframe(i,".ms-formlabel","display: none");e.cancelPopUp=function(){t._onRTEPanelDismissed()};var n=this.state.field.schema.Name+"_"+this.state.field.schema.Id+"_$TextField_inplacerte",a=i.getElementById(n);a&&a.focus();if(a){this.props.field.schema.AppendOnly?a.innerHTML="":a.innerHTML=this._getRendererText();e.ClientFormOverwriteSave=function(){var e=t._removeSkipElementsFromHTML(a);t._latestData=e.innerHTML;t.setState({isEditingPanelOpen:!1});t._onSave(t._latestData);return!1}}}}};e.prototype._removeSkipElementsFromHTML=function(e){var t=e.cloneNode(!0),i=t.getElementsByClassName(h),r=t.getElementsByClassName(f);this._removeSkipElements(r);for(var o=0;o<i.length;o++){var n=i[o];n&&this._moveSkipChildren(n)}this._removeSkipElements(i);return t};e.prototype._removeSkipElements=function(e){for(;0<e.length;){var t=e[0],i=t.parentNode;i&&i.removeChild(t)}};e.prototype._moveSkipChildren=function(e){for(var t=0<e.childElementCount?[].slice.call(e.children):[],i=0;i<t.length;i++){var r=t[i];if(r&&!this._isSkipElement(r)){var o=this._getNonSkipRoot(r);o&&o.appendChild(r)}}};e.prototype._getNonSkipRoot=function(e){for(var t=e;t.parentElement;){t=t.parentElement;if(!this._isSkipElement(t))return t}};e.prototype._isSkipElement=function(e){var t=e.className;return t&&(-1<t.indexOf(h)||-1<t.indexOf(f))};e.prototype._onRTEPanelDismissed=function(){this.setState({isEditingPanelOpen:!1})};e.prototype._overrideStyleInIframe=function(e,t,i){for(var r=e.querySelectorAll(t),o=0;o<r.length;o++){r[o].style.cssText=i}};e.prototype._updateRichTextEditorSize=function(e){var t=!1;if(e){var i=e.contentWindow.document;if(0<i.getElementsByClassName("ms-rtestate-write").length){t=!0;var r=i.getElementById("s4-ribbonrow"),o=i.getElementById("s4-workspace");if(o&&o.style){var n=this._iframeHeight-r.clientHeight;n<350&&(n=350);o.style.height=n+"px"}}}return t};o.__decorate([a.autobind],e.prototype,"_endEdit",null);o.__decorate([a.autobind],e.prototype,"_onToggleMoreLess",null);o.__decorate([a.autobind],e.prototype,"_onMoreLessKeyDown",null);o.__decorate([a.autobind],e.prototype,"_onIframeLoaded",null);o.__decorate([a.autobind],e.prototype,"_onRTEPanelDismissed",null);return e}(i.BaseReactFieldEditor);t.NoteFieldEditor=g;t.default=g});define("ZV",["require","exports","ap","at","Du","jP","ZW"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){var t=this,e={height:this._getIframeHeight()};return r.createElement(o.Panel,i.__assign({className:"ms-IframeLoaderPanel",firstFocusableSelector:"ms-TextField-field",isOpen:!0},this.props.panelProps),r.createElement("iframe",{className:"ms-IframeLoader-iframe",src:this.props.url,ref:function(e){t._frame=e},onLoad:this._onLoad,style:e}))};e.prototype.componentWillUnmount=function(){this._frame&&(this._frame.src="")};e.prototype._onLoad=function(){this.props.onLoad&&this.props.onLoad(this._frame)};e.prototype._getIframeHeight=function(){var e=document.body.clientHeight-50;return(e=e<50?50:e)+"px"};e.defaultProps={panelProps:{type:o.PanelType.largeFixed}};i.__decorate([n.autobind],e.prototype,"_onLoad",null);return e}(r.Component);t.IframeLoaderPanel=a});define("ZW",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-IframeLoaderPanel{width:100%}.ms-IframeLoader-loadingLabel{padding-bottom:15px;display:none}.ms-IFrameLoader-LoadingWithMargin.ms-IframeLoader-loadingLabel{margin:15px 15px 15px 30px}.ms-IframeLoader-title{display:none}.ms-IframeLoader-iframe{width:100%;border:none;display:block}.ms-IframeLoader-progressContainer{display:none}.ms-IframeLoader--visible,.ms-IframeLoader-iframe--visible,.ms-IframeLoader-loadingLabel--visible,.ms-IframeLoader-progressContainer--visible,.ms-IframeLoader-title--visible{display:block}"}])});define("ZT",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ReactFieldEditor-Note-Plain{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-height:100px;height:auto}.ReactFieldEditor-Note-Plain .ReactFieldEditor-TextField{display:inline-block;width:100%}.ReactFieldEditor-MoreToggle{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer}.ReactFieldEditor-MoreToggle:focus,.ReactFieldEditor-MoreToggle:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.ReactFieldEditor-MoreToggle:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ReactFieldEditor-AppendedData{color:"},{theme:"bodySubtext",defaultValue:"#666666"},{rawString:";font-size:12px}.ReactFieldEditor-AppendedData .od-FieldRenderer-text{margin-bottom:8px;max-height:initial}.ReactFieldEditor-core--edit:not(.is-interactiveSave) .ReactFieldEditor-Note-Rich~.ReactFieldEditor-AppendedData{border-bottom:1px solid "},{theme:"bodyDivider",defaultValue:"#eaeaea"},{rawString:"}.ReactFieldEditor-core--edit .ReactFieldEditor-AppendedData{margin-top:12px}"}])});define("ZM",["require","exports","ap","at","au","Dn","jP","aL","l8","V","ZP","Y2","YZ","ZO","ZN"],function(e,t,i,p,m,r,o,n,h,f,g,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(d){i.__extends(e,d);function e(e){var t=d.call(this,e)||this;t._showInvisibleRegionOnDispayMode=!0;return t}e.prototype.getData=function(){for(var t=this,e="",i=0,r=this._options&&this._options.filter(function(e){return-1<t.state.selectedKeys.indexOf(e.key)})||[];i<r.length;i++){var o=r[i];e&&(e+=s.BaseReactFieldEditor.ARRAY_DELIMITER);e+=o.key+s.BaseReactFieldEditor.ARRAY_DELIMITER+o.text}return e};e.prototype.saveData=function(){this.setMode(a.ReactFieldEditorMode.View)};e.prototype.isUpdated=function(e){if(!this._isLookupMulti())return d.prototype.isUpdated.call(this,e);var t=this.state,i=t.selectedKeys,r=t.field,o=this._getSelectedKeys(r.serverData);if(!o&&!i)return!1;if(!o||!i||o.length!==i.length)return!0;for(var n=!1,a=0,s=i;a<s.length;a++){var l=s[a];if(-1===o.indexOf(l)){n=!0;break}}return n};e.prototype._getStateFromProps=function(e){var t=d.prototype._getStateFromProps.call(this,e);t.selectedKeys=this._getSelectedKeys(e.field.data);this._populateChoiceOptions();return t};e.prototype._getRenderer=function(){for(var e=this.state,t=e.selectedKeys,i=e.field,r=[],o=0,n=t;o<n.length;o++)for(var a=n[o],s=0,l=this._options;s<l.length;s++){var d=l[s];d.key===a&&r.push({lookupId:d.key,lookupValue:d.text,ariaLabel:d.text})}var c=i.schema,u={lookup:r,dispFormUrl:f.format("{0}&ListId={{1}}",c.BaseDisplayFormUrl,c.LookupListId),launchDialog:function(e){var t=document.createElement("div");document.body.appendChild(t);var i=p.createElement(g.IframeDialog,{url:e});m.render(i,t)}};return h.LookupRenderer(u)};e.prototype._getEditor=function(){var t=this;return this._isLookupMulti()?p.createElement(r.Dropdown,{multiSelect:!0,placeHolder:this._getPlaceHolderString(),options:this._options,selectedKeys:this.state.selectedKeys,onChanged:this._onChanged,onBlur:this._onBlur,onDismiss:this._onBlur,componentRef:function(e){return t._dropdown=e}}):p.createElement(r.Dropdown,{placeHolder:this._getPlaceHolderString(),options:this._options,selectedKey:this.state.selectedKeys[0],onChanged:this._onChanged,onBlur:this._onBlur,onDismiss:this._onBlur,componentRef:function(e){return t._dropdown=e}})};e.prototype._getPlaceHolderString=function(){var e=this.props.field.schema;return e&&e.MaxQueryResult?f.format(l.default.lookupFieldEditorThrottleMessage,e.MaxQueryResult):this._isLookupMulti()?l.default.multiLookupFieldPlaceHolder:l.default.singleLookupFieldPlaceHolder};e.prototype._focusOnEditorIfNeeded=function(){this._dropdown&&this._dropdown.focus(!0)};e.prototype._endEdit=function(e){this._onSave(this.getData())};e.prototype._onChanged=function(e){var t=n.deepCopy(this.state.selectedKeys),i=e.key;this._isLookupMulti()?e.selected?t.push(i):t=t.filter(function(e){return e!==i}):t[0]=i;this.setState({selectedKeys:t})};e.prototype._onBlur=function(){this._endEdit(null)};e.prototype._isLookupMulti=function(){return"lookupmulti"===this.props.field.schema.FieldType.toLowerCase()};e.prototype._populateChoiceOptions=function(){var e=this.props.field&&this.props.field.schema&&this.props.field.schema.Choices;if(e){this._options=[];for(var t=0;t<e.length;t++){var i=e[t];i&&this._options.push({key:i.LookupId.toString(),text:i.LookupValue})}}};e.prototype._getSelectedKeys=function(e){var t=[],i=this._getArrayFromSPString(e);if(this._isLookupMulti()){if(i&&i.length)for(var r=0;r<i.length;r++)r/2===Math.floor(r/2)&&t.push(i[r])}else 0<i.length&&t.push(i[0]);return t};i.__decorate([o.autobind],e.prototype,"_endEdit",null);i.__decorate([o.autobind],e.prototype,"_onChanged",null);i.__decorate([o.autobind],e.prototype,"_onBlur",null);return e}(s.BaseReactFieldEditor);t.LookupFieldEditor=d;t.default=d});define("ZP",["require","exports","ap","ZQ"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("ZQ",["require","exports","ap","at","jP","o7","xH","o1","ZR"],function(e,t,r,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isOpen:!0,isIframeLoaded:!1};return t}e.prototype.componentWillReceiveProps=function(e){this.setState({isIframeLoaded:!1})};e.prototype.render=function(){var t=this,e=this.props.url,i=this.state.isIframeLoaded;return o.createElement(s.Dialog,{className:"ms-iframeDialog",isOpen:this.state.isOpen,type:s.DialogType.close,isBlocking:!1,onDismiss:this._onClose},o.createElement(a.FocusZone,null,!i&&o.createElement(l.Spinner,{size:l.SpinnerSize.large}),o.createElement("iframe",{ref:function(e){return t._setupIframeElementFunctions(e)},src:e,style:{display:i?"block":"none"},onLoad:this._iframeOnLoad})))};e.prototype._onClose=function(){this.setState({isOpen:!1})};e.prototype._iframeOnLoad=function(){this._iframeElement&&this._iframeElement.contentDocument&&(this._iframeElement.style.height=this._iframeElement.contentDocument.body.clientHeight+"px");this.setState({isIframeLoaded:!0})};e.prototype._setupIframeElementFunctions=function(e){if(e){e.cancelPopUp=this._onClose;e.commitPopup=this._onClose}this._iframeElement=e};r.__decorate([n.autobind],e.prototype,"_onClose",null);r.__decorate([n.autobind],e.prototype,"_iframeOnLoad",null);return e}(o.Component);t.IframeDialog=i});define("ZR",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-iframeDialog .ms-Dialog-main{width:100%;max-width:600px}.ms-iframeDialog iframe{border:none;width:100%}"}])});define("ZN",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ReactFieldEditor-core--display .od-FieldRender-lookup{display:block;white-space:nowrap;max-width:100%}"}])});define("ZK",["require","exports","ap","at","BT","jP","Y2","YZ","ZL"],function(e,t,o,n,a,s,l,i,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(i){o.__extends(r,i);function r(e){var t=i.call(this,e)||this;t._delayedValidate=t._async.debounce(t._validateInput,t._deferredValidationTime);return t}r.prototype.getData=function(){return this._textField&&this._textField.value};r.prototype.saveData=function(){if(this.state.mode===l.ReactFieldEditorMode.Edit){var e=this.getData();this._onSave(e)}};r.prototype._getEditor=function(){var t=this,e=this.state.field;return n.createElement(a.TextField,{className:"ReactFieldEditor-TextField",placeholder:d.default.numberFieldEditorPlaceHolder,defaultValue:e&&e.data?e.data.toString():"",onBlur:this._endEdit,onFocus:this._inputOnFocus,componentRef:function(e){return t._textField=e},borderless:!0,onChanged:this._delayedValidate})};r.prototype._focusOnEditorIfNeeded=function(){if(this._textField){this._textField.focus();this._textField.select()}};r.prototype._endEdit=function(e){this.saveData()};r.prototype._getRendererText=function(){var e=this.state.field.schema.Name||"",t=this.props.item&&this.props.item.properties&&this.props.item.properties[e];t||(t=this.state.field.data&&this.state.field.data.toString()||"");return t};r.prototype.validate=function(){i.prototype.validate.call(this);if(this._updatedField.clientSideErrorMessage)return this._updatedField.clientSideErrorMessage;this._updatedField.clientSideErrorMessage=r._isValidNumber(this.getData())?"":d.default.invalidNumberError;return this._updatedField.clientSideErrorMessage};r.prototype._inputOnFocus=function(e){this._textField&&this._textField.select()};r.prototype._validateInput=function(e){var t=r._isValidNumber(e);if(t&&this._updatedField.clientSideErrorMessage||!t&&!this._updatedField.clientSideErrorMessage){this._updatedField.clientSideErrorMessage=t?"":d.default.invalidNumberError;this.setState({field:this._updatedField})}};r._isValidNumber=function(e){return!e||/^[\d.,eE-\s'\*\.·٫٬˙]+$/.test(e)};o.__decorate([s.autobind],r.prototype,"_endEdit",null);o.__decorate([s.autobind],r.prototype,"validate",null);o.__decorate([s.autobind],r.prototype,"_inputOnFocus",null);o.__decorate([s.autobind],r.prototype,"_validateInput",null);return r}(i.BaseReactFieldEditor);t.NumberFieldEditor=r;t.default=r});define("ZG",["require","exports","ap","at","jP","hb","ZJ","l8","Y2","Cr","YZ","ZI","ZH"],function(e,t,i,n,a,s,l,r,d,c,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(o){i.__extends(e,o);function e(e){var t=o.call(this,e)||this;t._showInvisibleRegionOnDispayMode=!0;t._peoplePickerQueryParams={allowEmailAddresses:!1,allowOnlyEmailAddresses:!1,allowMultipleEntities:t.state.field.schema.AllowMultipleValues,allUrlZones:!1,groupID:t.state.field.schema.SharePointGroupID,maximumEntitySuggestions:50,principalSource:t.state.field.schema.ResolvePrincipalSource,principalType:t._createSPPrincipalType(t.state.field.schema.PrincipalAccountType),required:t.state.field.schema.Required};t._initialSelectedPeople=[];var i=t.state.field.data;if(i&&i.length){var r="string"==typeof i?JSON.parse(i):i;t._initialSelectedPeople=t._convertServerPeople(r)}return t}e.prototype.getData=function(){var e=this.state.currentSelectedPeople;e||(e=this._initialSelectedPeople);return this._getOverTheWireValue(e)};e.prototype.isUpdated=function(e){var t=this.state,i=t.currentSelectedPeople,r=t.serverPeople;if(!i&&!r)return!1;if(!i||!r||i.length!==r.length)return!0;for(var o={},n=0,a=r;n<a.length;n++){var s=a[n];o[s.EntityData&&s.EntityData.AccountName]=s}for(var l=0,d=i;l<d.length;l++){if(!o[d[l].userId])return!0}return!1};e.prototype.saveData=function(){this.state.mode===d.ReactFieldEditorMode.Edit&&this._onSave(this.getData())};e.prototype.cancelEdit=function(){o.prototype.cancelEdit.call(this);this.setState({currentSelectedPeople:this._convertServerPeople(this.state.serverPeople)})};e.prototype._getStateFromProps=function(e){var t=o.prototype._getStateFromProps.call(this,e),i=e.field&&e.field.serverData;t.serverPeople=i&&"string"==typeof i?JSON.parse(i):i;return t};e.prototype._focusOnEditorIfNeeded=function(){this._peoplePicker&&this._peoplePicker.focusInput()};e.prototype._getRenderer=function(){var e=this.state.currentSelectedPeople;e||(e=this._initialSelectedPeople);var t=[];e&&(t=e.map(function(e){return{title:e.name,email:e.email,picture:e.image,sip:e.sip,ariaLabel:e.name}}));var i={users:t,isAnonymous:!1};return r.UserRenderer(i)};e.prototype._getEditor=function(){var t=this,e=this.props.pageContext,i=this.state,r=i.isFocused,o=i.currentSelectedPeople;o||(o=this._initialSelectedPeople);return n.createElement("div",{className:"ReactFieldEditor-People"},n.createElement(c.PeoplePicker,{className:a.css("ReactFieldEditor-Picker",{"is-focused":r}),inputProps:{placeholder:u.default.peopleEditorPickerPlaceHolder,onFocus:this._onFocus,onBlur:this._onBlur},noResultsFoundText:u.default.noResultFound,dataSource:e?void 0:new l.PeoplePickerDataSource,context:e,loadingText:u.default.loadingText,onSelectedPersonasChange:this._onSelectedPersonasChange,selectedItems:o,peoplePickerQueryParams:this._peoplePickerQueryParams,componentRef:function(e){return t._peoplePicker=e}}))};e.prototype._onFocus=function(){this.setState({isFocused:!0})};e.prototype._onBlur=function(){var e=this;this._timeOut=this._async.setTimeout(function(){e.setState({isFocused:!1});e._peoplePickerQueryParams.allowMultipleEntities&&e.saveData()},100)};e.prototype._endEdit=function(e){e.stopPropagation();e.preventDefault();this.saveData()};e.prototype._getRendererText=function(){return this.state.currentSelectedPeople.map(function(e){return e.name}).join(" ")+" "};e.prototype._getPlaceHolderString=function(){return u.default.peopleEditorPickerPlaceHolder};e.prototype._onSelectedPersonasChange=function(e){var t=this;this._timeOut&&this._async.clearTimeout(this._timeOut);var i=this.state.currentSelectedPeople;i=this._peoplePickerQueryParams.allowMultipleEntities||e.length<=1?e:[e[e.length-1]];this.setState({currentSelectedPeople:i},function(){!t._peoplePickerQueryParams.allowMultipleEntities&&e&&1<=e.length&&t.saveData()})};e.prototype._createSPPrincipalType=function(e){if(!e)return 0;for(var t=0,i=0,r=e.split(",");i<r.length;i++){var o=r[i];"User"===o?t|=1:"DL"===o?t|=2:"SecGroup"===o?t|=4:"SPGroup"===o&&(t|=8)}return t};e.prototype._getOverTheWireValue=function(e){var t=[],i="";if(e){for(var r=0,o=e;r<o.length;r++){var n=o[r];if(n.isResolved||n.principalType===s.default.sharePointGroup){var a=n.rawData||n.rawPersonData;if(a){delete a.Claim;delete a.EntityDataElements;a.EntityData&&delete a.EntityData.DisplayText;t.push(a)}}}0<t.length&&(i=JSON.stringify(t))}return i};e.prototype._convertServerPeople=function(e){var t=[];e&&e.length&&(t=e.map(function(e){var t=e.EntityData||{};t.DisplayText=e.DisplayText;return{name:t.DisplayText,email:t.Email,userId:t.AccountName,job:t.Title,department:t.Department,sipAddress:t.SIPAddress,rawData:e,isResolved:!0}}));return t};i.__decorate([a.autobind],e.prototype,"_onFocus",null);i.__decorate([a.autobind],e.prototype,"_onBlur",null);i.__decorate([a.autobind],e.prototype,"_endEdit",null);i.__decorate([a.autobind],e.prototype,"_onSelectedPersonasChange",null);return e}(o.BaseReactFieldEditor);t.PeopleEditor=p;t.default=p});define("ZJ",["require","exports","aC","bS"],function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=[{name:"Annie Lindqvist",email:"AnnieLindqvist@contoso.com",sip:"AnnieLindqvist@contoso.com",userId:"AnnieLindqvist@contoso.com",job:"Software Engineer",isResolved:!0,rawPersonData:{EntityData:{PrincipalType:"GUEST_USER"}}},{name:"Aaron Reid",email:"AaronReid@contoso.com",sip:"AaronReid@contoso.com",userId:"AaronReid@contoso.com",job:"Software Engineer",isResolved:!0,rawPersonData:{EntityData:{PrincipalType:"GUEST_USER"}}},{name:"Roko Kolar",email:"RokoKolar@contoso.com",sip:"RokoKolar@contoso.com",userId:"RokoKolar@contoso.com",job:"Software Engineer",isResolved:!0,rawPersonData:{EntityData:{PrincipalType:"GUEST_USER"}}},{name:"Christian Bergqvist",email:"ChristianBergqvist@contoso.com",sip:"ChristianBergqvist@contoso.com",userId:"ChristianBergqvist@contoso.com",job:"Software Engineer",isResolved:!0,rawPersonData:{EntityData:{PrincipalType:"GUEST_USER"}}},{name:"Valentina Lovric",email:"ValentinaLovric@contoso.com",sip:"ValentinaLovric@contoso.com",userId:"ValentinaLovric@contoso.com",job:"Software Engineer",isResolved:!0,rawPersonData:{EntityData:{PrincipalType:"GUEST_USER"}}},{name:"Maor Sharett",email:"MaorSharett@contoso.com",sip:"MaorSharett@contoso.com",userId:"MaorSharett@contoso.com",job:"Software Engineer",isResolved:!0,rawPersonData:{EntityData:{PrincipalType:"GUEST_USER"}}},{name:"Annie Lindqvist2",email:"AnnieLindqvist2@contoso.com",sip:"AnnieLindqvist2@contoso.com",userId:"AnnieLindqvist2@contoso.com",job:"Software Engineer",isResolved:!0,rawPersonData:{EntityData:{PrincipalType:"GUEST_USER"}}},{name:"Aaron Reid2",email:"AaronReid2@contoso.com",sip:"AaronReid2@contoso.com",userId:"AaronReid2@contoso.com",job:"Software Engineer",isResolved:!0,rawPersonData:{EntityData:{PrincipalType:"GUEST_USER"}}}],r=function(){function n(){this._capabilities={supportsMruCaching:!0}}n.getMockPeople=function(t,e){return t?i.filter(function(e){return 0===e.name.toLowerCase().indexOf(t.toLowerCase())}):[]};n.prototype.getCapabilities=function(){return this._capabilities};n.prototype.getPersonaDetails=function(){return new a.default};n.prototype.search=function(i,r){var o=new s.default(this);return new a.default(function(t,e){o.setTimeout(function(){var e=n.getMockPeople(i,r.maximumEntitySuggestions);t(e)},10)})};n.prototype.resolve=function(e,t){return this.search(e,t).then(function(e){return e.splice(0,1)[0]})};n.prototype.subscribePresence=function(e,t){};n.prototype.getPickerEntityInformation=function(e){return a.default.resolve({person:e,totalMemberCount:10})};return n}();t.PeoplePickerDataSource=r});define("ZH",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ReactFieldEditor-People{display:-ms-flexbox;display:flex}.ReactFieldEditor-People .ReactFieldEditor-Picker{border:0;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";outline:0;display:inline-block;width:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:4px}[dir=ltr] .ReactFieldEditor-People .ReactFieldEditor-Picker{padding-left:0}[dir=rtl] .ReactFieldEditor-People .ReactFieldEditor-Picker{padding-right:0}.ReactFieldEditor-People .ReactFieldEditor-Picker .ms-BasePicker-text{border:none}.ReactFieldEditor-People .ReactFieldEditor-Picker.is-focused{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ReactFieldEditor-People .ReactFieldEditor-Picker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;overflow:hidden}"}])});define("ZD",["require","exports","ap","at","BT","l8","jP","V","Y2","YZ","ZF","ZE"],function(e,t,i,o,n,a,s,l,d,r,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._showInvisibleRegionOnDispayMode=!0;t._delayedValidate=t._async.debounce(t._validateUrlInput,t._deferredValidationTime);return t}e.prototype.getData=function(){var e=this.state,t=e.defaultAltText,i=e.defaultUrl,r=this._urlField?this._urlField.value:i,o=this._altTextField?this._altTextField.value:t;if(!r)return"";var n=r.replace(/\,/g,",,");n+=", ";o&&(n+=o);return n};e.prototype.saveData=function(){this.state.mode===d.ReactFieldEditorMode.Edit&&this._onSave(this.getData())};e.prototype.cancelEdit=function(){r.prototype.cancelEdit.call(this);var e=this._parseServerData(this.props.field.serverData);this.setState({defaultUrl:e.url,defaultAltText:e.altText})};e.prototype._getStateFromProps=function(e){var t=r.prototype._getStateFromProps.call(this,e),i=this._parseServerData(this.props.field.data);t.defaultUrl=i.url;t.defaultAltText=i.altText;return t};e.prototype._getEditor=function(){var t=this,e=this.state,i=e.defaultUrl,r=e.defaultAltText;return o.createElement("div",{className:"ReactFieldEditor-Picture"},o.createElement(n.TextField,{placeholder:c.default.url,defaultValue:i,borderless:!0,onBlur:this._txtFieldOnBlur,onFocus:this._txtFieldOnFocus,onChanged:this._delayedValidate,componentRef:function(e){return t._urlField=e}}),o.createElement(n.TextField,{className:"ReactFieldEditor-Picture-Text",placeholder:c.default.display,borderless:!0,defaultValue:r,onBlur:this._txtFieldOnBlur,onFocus:this._txtFieldOnFocus,componentRef:function(e){return t._altTextField=e}}))};e.prototype._focusOnEditorIfNeeded=function(){if(this._urlField){this._urlField.focus();this._urlField.select()}};e.prototype._endEdit=function(){this.saveData()};e.prototype._txtFieldOnBlur=function(e){this._timeOut=this._async.setTimeout(this._endEdit,0)};e.prototype._txtFieldOnFocus=function(e){this._timeOut&&this._async.clearTimeout(this._timeOut)};e.prototype._getRenderer=function(){var e=this.props.field.schema,t=this.state,i=t.defaultUrl,r=t.defaultAltText,o={url:this._urlField?this._urlField.value:i,urlDisplay:this._altTextField?this._altTextField.value:r,isImageUrl:1===e.DisplayFormat};return a.UrlRenderer(o)};e.prototype.validate=function(){r.prototype.validate.call(this);if(this._updatedField.clientSideErrorMessage)return this._updatedField.clientSideErrorMessage;this._updatedField.clientSideErrorMessage=this._validateUrl();return this._updatedField.clientSideErrorMessage};e.prototype._validateUrlInput=function(e){var t=this._validateUrl(e);if(!t&&this._updatedField.clientSideErrorMessage||t&&!this._updatedField.clientSideErrorMessage){this._updatedField.clientSideErrorMessage=t;this.setState({field:this._updatedField})}};e.prototype._validateUrl=function(e){void 0===e&&(e=this._urlField&&this._urlField.value);return e&&e.length>this._inputElementMaxLength?l.format(c.default.maxLengthUrlError,this._inputElementMaxLength):void 0};e.prototype._parseServerData=function(e){var t=e&&e.search?e.search(/[^,],[^,]/):-1,i=e,r="";if(0<=t){i=e.substr(0,t+1).trim();r=e.substr(t+2).trim()}return{url:i=i?i.replace(/\,\,/g,","):"",altText:r}};i.__decorate([s.autobind],e.prototype,"_endEdit",null);i.__decorate([s.autobind],e.prototype,"_txtFieldOnBlur",null);i.__decorate([s.autobind],e.prototype,"_txtFieldOnFocus",null);i.__decorate([s.autobind],e.prototype,"validate",null);i.__decorate([s.autobind],e.prototype,"_validateUrlInput",null);return e}(r.BaseReactFieldEditor);t.PictureFieldEditor=u;t.default=u});define("ZE",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ReactFieldEditor-Picture-Text{margin-top:8px}.ReactFieldEditor-core--display .od-FieldRender-image{max-width:128px;max-height:128px;margin:0}"}])});define("Y3",["require","exports","ap","Y2","YZ"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.getData=function(){return""};e.prototype.saveData=function(){this.state.mode===r.ReactFieldEditorMode.Edit&&this._onSave("")};e.prototype._endEdit=function(e){this.saveData()};e.prototype._focusOnEditorIfNeeded=function(){};return e}(o.BaseReactFieldEditor);t.PlaceHolderFieldEditor=n;t.default=n});define("Zy",["require","exports","ap","at","Dn","Jc","ZB","aL","jP","Y2","YZ","ZA","d","Zz"],function(e,t,r,o,n,a,s,l,d,c,p,m,i,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i.getTheme(),u=function(i){r.__extends(u,i);function u(e){return i.call(this,e)||this}u.prototype.getData=function(){for(var t=this,e="",i=0,r=this._hasFillIn()?this.state.comboBoxOptions&&this.state.comboBoxOptions.filter(function(e){return-1<t.state.selectedKeys.indexOf(e.key)})||[]:this._dropdownOptions&&this._dropdownOptions.filter(function(e){return-1<t.state.selectedKeys.indexOf(e.key)})||[];i<r.length;i++){var o=r[i];if(this._isMulti()){e+=p.BaseReactFieldEditor.ARRAY_DELIMITER;e+=o.text}else e=o.text}e&&this._isMulti()&&(e+=p.BaseReactFieldEditor.ARRAY_DELIMITER);return e};u.prototype.saveData=function(){this._onSave(this.getData());this.setMode(c.ReactFieldEditorMode.View)};u.prototype._getEditor=function(){var t=this;if(this._hasFillIn()){this._populateComboBoxOptions();var e={root:{borderColor:f.semanticColors.inputBorder,borderTopWidth:0,borderLeftWidth:0,borderRightWidth:0,marginBottom:0},divider:{borderWidth:0,borderBottomWidth:1,borderColor:f.palette.neutralTertiary}};return this._isMulti()?o.createElement(a.ComboBox,{multiSelect:!0,styles:e,options:l.deepCopy(this.state.comboBoxOptions),selectedKey:this.state.selectedKeys,allowFreeform:!0,onChanged:this._onComboBoxChanged,onKeyDown:this._onComboBoxKeyDown,onMenuOpen:this._onComboBoxMenuOpen,onBlur:this._onBlur,componentRef:function(e){return t._combobox=e},autoComplete:"on"}):o.createElement(a.ComboBox,{styles:e,options:l.deepCopy(this.state.comboBoxOptions),selectedKey:this.state.selectedKeys,allowFreeform:!0,onChanged:this._onComboBoxChanged,onKeyDown:this._onComboBoxKeyDown,onMenuOpen:this._onComboBoxMenuOpen,onBlur:this._onBlur,componentRef:function(e){return t._combobox=e},autoComplete:"on"})}this._populateDowndownOptions();return this._isMulti()?o.createElement(n.Dropdown,{multiSelect:!0,placeHolder:this._getPlaceHolderString(),options:this._dropdownOptions,onChanged:this._onDowndownChanged,selectedKeys:this.state.selectedKeys,onBlur:this._onBlur,onDismiss:this._onBlur,componentRef:function(e){return t._dropdown=e}}):o.createElement(n.Dropdown,{placeHolder:this._getPlaceHolderString(),options:this._dropdownOptions,onChanged:this._onDowndownChanged,selectedKey:this.state.selectedKeys[0],onBlur:this._onBlur,onDismiss:this._onBlur,componentRef:function(e){return t._dropdown=e}})};u.prototype._getStateFromProps=function(e){var t=i.prototype._getStateFromProps.call(this,e);t.selectedKeys=this._getSelectedKeys(e.field.data);this._hasFillIn()?this._populateComboBoxOptions():this._populateDowndownOptions();return t};u.prototype._getRendererText=function(){return this.state.selectedKeys?this.state.selectedKeys.join(", "):""};u.prototype._getPlaceHolderString=function(){return this._isMulti()?m.default.multiChoiceEditorPlaceHolder:m.default.singleChoiceEditorPlaceHolder};u.prototype._focusOnEditorIfNeeded=function(){this._dropdown&&this._dropdown.focus(!0);this._combobox&&this._combobox.focus(!0)};u.prototype._endEdit=function(e){this.saveData()};u.prototype._onComboBoxChanged=function(e,t,i){var r=this.state.comboBoxOptions;if(!e){this._comboBoxOptionHash[u._comboBoxSeperator.key]||r.push(u._comboBoxSeperator);e=this._constructComboBoxOption(i);r.push(e);this._comboBoxOptionHash[e.key]=e}var o=e?e.key:i,n=l.deepCopy(this.state.selectedKeys),a=n.indexOf(o);-1<a?n.splice(a,1):n.push(o);this.setState({comboBoxOptions:r,selectedKeys:n})};u.prototype._onComboBoxKeyDown=function(e){9===e.which&&this.saveData()};u.prototype._onComboBoxMenuOpen=function(){this._async.clearTimeout(this._timeOut)};u.prototype._onDowndownChanged=function(e){var t=l.deepCopy(this.state.selectedKeys),i=e.key;this._isMulti()?e.selected?t.push(i):t=t.filter(function(e){return e!==i}):t[0]=i;this.setState({selectedKeys:t})};u.prototype._isMulti=function(){var e=this.props.field.schema;return e&&e.FieldType&&"multichoice"===e.FieldType.toLowerCase()};u.prototype._hasFillIn=function(){var e=this.props.field.schema;return e&&e.FillInChoice||!1};u.prototype._constructComboBoxOption=function(e){return{key:e,text:e}};u.prototype._populateDowndownOptions=function(){var e=this.props.field&&this.props.field.schema;if(e){var t=this._isMulti()?e.MultiChoices:e.Choices;if(t){this._dropdownOptions=[];for(var i=0;i<t.length;i++){var r=t[i];r&&this._dropdownOptions.push({key:r,text:r})}}}};u.prototype._populateComboBoxOptions=function(){var n=this;if(!this._comboBoxOptionHash){var e=this.props,t=e.getFieldFilterData,i=e.field,a=i&&i.schema;if(a){var r=this._isMulti()?a.MultiChoices:a.Choices;if(r){var s=[];this._comboBoxOptionHash={};for(var o=0,l=r;o<l.length;o++){var d=l[o],c=this._constructComboBoxOption(d);s.push(c);this._comboBoxOptionHash[c.key]=c}(t?t(a.Name):Promise.resolve("")).then(function(e){for(var t=0,i=h.default.getFilterData(e,a.Name);t<i.length;t++){var r=i[t];if(r.value&&!n._comboBoxOptionHash[r.value]){if(!n._comboBoxOptionHash[u._comboBoxSeperator.key]){s.push(u._comboBoxSeperator);n._comboBoxOptionHash[u._comboBoxSeperator.key]=u._comboBoxSeperator}var o=n._constructComboBoxOption(r.value);s.push(o);n._comboBoxOptionHash[o.key]=o}}n.setState({comboBoxOptions:s})})}}}};u.prototype._getSelectedKeys=function(e){var t=[],i=this._getArrayFromSPString(e);if(!i)return t;if(this._isMulti())for(var r=0;r<i.length;r++)i[r]&&t.push(i[r]);else 0<i.length&&t.push(i[0]);return t};u.prototype._onBlur=function(){var e=this;this._timeOut=this._async.setTimeout(function(){return e._endEdit(null)},100)};u._comboBoxSeperator={key:"seperator",text:"-",itemType:s.SelectableOptionMenuItemType.Divider};r.__decorate([d.autobind],u.prototype,"_endEdit",null);r.__decorate([d.autobind],u.prototype,"_onComboBoxChanged",null);r.__decorate([d.autobind],u.prototype,"_onComboBoxKeyDown",null);r.__decorate([d.autobind],u.prototype,"_onComboBoxMenuOpen",null);r.__decorate([d.autobind],u.prototype,"_onDowndownChanged",null);r.__decorate([d.autobind],u.prototype,"_onBlur",null);return u}(p.BaseReactFieldEditor);t.ChoiceFieldEditor=u;t.default=u});define("ZB",["require","exports","ap","ZC"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("ZC",["require","exports","ap","Dq"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Zz",["require","exports","im"],function(e,t,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;(i||(i={})).getFilterData=function(e,t){var i=[];e=e.split("<br>")[0];var r=document.createElement("DIV");r.innerHTML=e;var o=r.querySelector("#diidFilter"+t);if(null!=o)for(var n=o.childNodes.length,a=o.childNodes,s=1;s<n;s++){var l=c.default.getText(a[s]),d=a[s].value.toString();i.push({display:l,value:d})}return i};t.default=i});define("Zw",["require","exports","ap","at","BT","jP","V","Y2","YZ","Zx"],function(e,t,i,r,o,n,a,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getData=function(){return this._textField&&this._textField.value};t.prototype.saveData=function(){if(this.state.mode===s.ReactFieldEditorMode.Edit){var e=this.getData();this._onSave(e)}};t.prototype._getEditor=function(){var t=this,e=this.state.field;return r.createElement(o.TextField,{className:"ReactFieldEditor-TextField",placeholder:this._getPlaceHolderString(),borderless:!0,defaultValue:e&&e.data?e.data.toString():"",onBlur:this._endEdit.bind(this),onFocus:this._inputOnFocus,onGetErrorMessage:this._onGetErrorMessage.bind(this),componentRef:function(e){return t._textField=e}})};t.prototype._focusOnEditorIfNeeded=function(){if(this._textField){this._textField.focus();this._textField.select()}};t.prototype._endEdit=function(e){this.saveData()};t.prototype._inputOnFocus=function(e){this._textField&&this._textField.select()};t.prototype._onGetErrorMessage=function(e){var t=this._getMaxLength();return e.length>t?a.format(d.default.inputExceedsMaxLength,t):""};t.prototype._getMaxLength=function(){var e=this.state.field;return e&&e.schema&&e.schema.MaxLength||255};i.__decorate([n.autobind],t.prototype,"_inputOnFocus",null);return t}(l.BaseReactFieldEditor);t.TextFieldEditor=c;t.default=c});define("Zt",["require","exports","ap","at","Dn","jP","Zv","Y2","YZ","Zu"],function(e,t,r,o,n,a,s,l,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selectedTagValue=e.field.data;return t}e.prototype.getData=function(){return this._selectedTagValue};e.prototype.saveData=function(){this.setMode(l.ReactFieldEditorMode.View)};e.prototype._getEditor=function(){var t=this,e=this.state.field,i=this._populateChoiceOptions();return i?o.createElement(n.Dropdown,{placeHolder:this._getPlaceHolderString(),options:i,onRenderOption:this._renderOption,onChanged:this._onChange,defaultSelectedKey:e&&e.data?e.data:e.schema.DefaultValue||"",onBlur:this._endEdit,onDismiss:this._endEdit,componentRef:function(e){return t._dropdown=e}}):void 0};e.prototype._getStateFromProps=function(e){var t=i.prototype._getStateFromProps.call(this,e);t.complianceTags=e.field.schema.ComplianceTags;return t};e.prototype._getPlaceHolderString=function(){return s.default.ComplianceTagEditorPlaceHolder};e.prototype._focusOnEditorIfNeeded=function(){this._dropdown&&this._dropdown.focus(!0)};e.prototype._endEdit=function(){this.setMode(this._getModeAfterEdit())};e.prototype._onChange=function(e){this._selectedTagValue=e&&e.key;var t=this.getData();t!==this.props.field.serverData&&this._onSave(t)};e.prototype._renderOption=function(e,t){var i,r=t(e);e&&e.data&&e.data.tagDescription&&(i=o.createElement("span",{className:"ReactFieldEditor-Compliance-description"},e.data.tagDescription));return i?o.createElement("div",{key:e.key},r,i):r};e.prototype._populateChoiceOptions=function(){var e,t=this.state.complianceTags;t&&t.length&&(e=t.map(function(e){return{key:e.tagValue,text:e.displayName?e.displayName:e.tagName,data:e}}));return e};r.__decorate([a.autobind],e.prototype,"_endEdit",null);r.__decorate([a.autobind],e.prototype,"_onChange",null);r.__decorate([a.autobind],e.prototype,"_renderOption",null);return e}(i.BaseReactFieldEditor);t.ComplianceTagEditor=d;t.default=d});define("Zu",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ReactFieldEditor-Compliance-description{display:block;font-size:11px;font-style:italic;padding-bottom:5px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});define("Y5",["require","exports","ap","at","YZ","Y2","wN","jP","Zc","Y9","Y8","Y7","Y6"],function(e,t,i,r,o,n,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(o){i.__extends(e,o);function e(e){var r=o.call(this,e)||this;r._updatingTerms=!1;r._taxonomyPicker=s.createRef();r._resolveSuggestions=function(e){return r._dataManager.resolveSuggestions(e,r.state.queryParams).then(function(e){return c.TaxonomyEditorDataManager.filterTaggedTerms(e,r.state.selectedTerms)}).catch(function(e){e&&"Canceled"!==e.name&&r._updateError(u.default.ServerError);return[]})};r._onBlur=function(e){r.saveData()};r._onItemsChange=function(e){r._clearError();r._updatingTerms=!0;r.setState({selectedTerms:e},function(){r._updatingTerms=!1;r._validateTerms(e)})};r._launchTree=function(e){r.state.taxonomyTreeOpen||r.setState({taxonomyTreeOpen:!0})};r._dismissTree=function(){r.state.taxonomyTreeOpen&&r.setState({taxonomyTreeOpen:!1})};r.handleTreeDialogResults=function(e){if(e){var t=e.value;try{var i=t.split(l.TERM_DELIMITER).map(function(e){var t=e.split(l.LABEL_ID_DELIMITER),i=t[1]!==l.INVALID_TERM_ID;return{term:{label:t[0],termId:t[1],isValid:i},isSynonym:!1,completions:[],start:"",state:i?1:2}});0===i.filter(function(e){return!e.term.isValid}).length&&r.setState({selectedTerms:i,taxonomyTreeOpen:!1})}catch(e){}}else r.setState({taxonomyTreeOpen:!1})};r._dataSource=new d.TaxonomyDataSource(e.pageContext);r._dataProvider=new d.TaxonomyProvider({},{dataSource:r._dataSource});r._dataManager=new c.TaxonomyEditorDataManager({dataProvider:r._dataProvider,dataSource:r._dataSource});return r}e.prototype.saveData=function(){this.state.mode===n.ReactFieldEditorMode.Edit&&this._onSave(this._getTermsAsSeverString())};e.prototype.getData=function(){return this._getTermsAsSeverString()};e.prototype.validate=function(){if(this.state.selectedTerms.some(function(e){return 2===e.state})){this._updatedField.clientSideErrorMessage=u.default.ClientValidationError;return this._updatedField.clientSideErrorMessage}return o.prototype.validate.call(this)};e.prototype.isUpdated=function(){var e=this.state,t=e.selectedTerms,i=e.serverTerms;if(!t&&!i)return!1;if(t.length!==i.length)return!0;for(var r={},o=0,n=i;o<n.length;o++){var a=n[o];r[a.term.termId]=a}for(var s=0,l=t;s<l.length;s++){if(!r[l[s].term.termId])return!0}return!1};e.prototype._getStateFromProps=function(e){var t=o.prototype._getStateFromProps.call(this,e),i=this.props.field.schema;if(!this.state||!this.state.serverTerms){var r=void 0;e.field.data?r=this._convertFieldDataToSuggestion(e.field.data):i.DefaultValueTyped&&(r=this._convertDefaultDataToSuggestion(i.DefaultValueTyped));t.selectedTerms=t.serverTerms=r||[]}void 0!==t.taxonomyTreeOpen&&null!==t.taxonomyTreeOpen||(t.taxonomyTreeOpen=!1);t.queryParams={lcid:i.Lcid||1033,sspList:i.SspId,termSetList:i.TermSetId,anchorId:i.AnchorId||l.INVALID_TERM_ID,excludedTermset:l.INVALID_TERM_ID,isSpanTermStores:i.IsSpanTermStores||!1,isSpanTermSets:i.IsSpanTermSets||!1,isIncludeUnavailable:!1,isIncludeDeprecated:!1,isAddTerms:i.IsAddTerms||!1,isIncludePathData:!1,excludeKeyword:!i.Name&&"TaxKeyword"!==i.Name,isUseCommaAsDelimiter:i.IsUseCommaAsDelimiter||!0,isIncludeTermSetName:!1,webServiceUrl:i.WebServiceUrl,allowFillIn:i.AllowFillIn||!0};return t};e.prototype._getRenderer=function(){var e=this.state.selectedTerms;return r.createElement("div",null,e.map(function(e){return r.createElement(l.TaxonomyLabel,{label:e.term.label,itemState:e.state,key:e.term.termId})}))};e.prototype._getEditor=function(){var e=this.props.field.schema.AllowMultipleValues?void 0:1;return r.createElement("div",{className:"ReactFieldEditor-Taxonomy"},r.createElement(l.TaxonomyPicker,{selectedTerms:this.state.selectedTerms,onItemsChange:this._onItemsChange,className:"ReactFieldEditor-Picker",resolveSuggestions:this._resolveSuggestions,termLimit:e,ref:this._taxonomyPicker,onBlur:this._onBlur}),r.createElement(a.ActionButton,{"aria-hidden":"true",iconProps:{iconName:"tag"},onClick:this._launchTree}),this.state.taxonomyTreeOpen&&r.createElement(l.TaxonomyTreePicker,{taxonomyTreeUrl:this.getTaxonomyTreeUrl(),field:this.state.field,resultHander:this.handleTreeDialogResults,onDismiss:this._dismissTree}))};e.prototype._focusOnEditorIfNeeded=function(){this._taxonomyPicker.value&&this._taxonomyPicker.value.focus()};e.prototype._endEdit=function(){return this.saveData()};e.prototype._shouldSaveDataOnEnter=function(){return!this._updatingTerms};e.prototype._updateError=function(e){var t=this.state.field;t.clientSideErrorMessage=e;this.setState({field:t})};e.prototype._clearError=function(){this._updateError("")};e.prototype._validateTerms=function(e){var t=this;this._timeout&&this._async.clearTimeout(this._timeout);this._timeout=this._async.setTimeout(function(){t._getValidatedTerms(e).then(function(e){t.setState({selectedTerms:e})})},300)};e.prototype._getValidatedTerms=function(e){return e.some(function(e){return 1!==e.state})?this._dataManager.validateTerms(this.state.queryParams,e):Promise.resolve(e)};e.prototype.getTaxonomyTreeUrl=function(){return this._dataSource.getTaxonomyTreeUrl(this.convertToTermsRawString(this.state.selectedTerms),{name:this.props.field.schema.Name,id:this.props.field.schema.Id,isMulti:this.props.field.schema.AllowMultipleValues},this.state.queryParams)};e.prototype.convertToTermsRawString=function(e){for(var t="",i=0;i<e.length;i++){var r=e[i];if(1===r.state){t+=r.term.label+l.LABEL_ID_DELIMITER+r.term.termId;i<e.length-1&&(t+=l.TERM_DELIMITER)}}return t};e.prototype._convertFieldDataToSuggestion=function(e){return e?e.split(l.TERM_DELIMITER).filter(function(e){return e&&0<e.length}).map(function(e){var t=e.split(l.LABEL_ID_DELIMITER),i=t[0],r=t[1],o=r!==l.INVALID_TERM_ID;return{term:{termId:r,label:i,isValid:o},isSynonym:!1,completions:[],start:"",state:o?1:2}}):[]};e.prototype._convertDefaultDataToSuggestion=function(e){var t=function(e){var t=e.TermGuid!==l.INVALID_TERM_ID;return{term:{termId:e.TermGuid,label:e.Label,isValid:t},isSynonym:!1,completions:[],start:"",state:t?1:2}};return Array.isArray(e)?e.map(t):[t(e)]};e.prototype._getTermsAsSeverString=function(){return this.state.selectedTerms.reduce(function(e,t){return e+t.term.label+l.LABEL_ID_DELIMITER+t.term.termId+l.TERM_DELIMITER},"")};return e}(o.BaseReactFieldEditor);t.TaxonomyEditor=p});define("Zc",["require","exports","ap","Zn","Zk","Zi","Zf","Ze","Zd"],function(e,t,i,r,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t);i.__exportStar(n,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t)});define("Zn",["require","exports","ap","at","CC","jP","Zq","Zf","Zd","V","Zp","Zo"],function(e,t,r,o,n,a,s,l,d,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TaxonomyTermPicker=n.BasePicker;var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._termPicker=a.createRef();t._getTextFromItem=function(e){return e.term.label};t._renderItem=function(e){return o.createElement(l.TaxonomyItem,r.__assign({},e))};t._validateInput=function(e){return e&&0<e.length?n.ValidationState.valid:n.ValidationState.invalid};t._renderSuggestion=function(e){return o.createElement(s.TaxonomySuggestion,r.__assign({},e))};t._onItemSelect=function(e){e.term.isValid&&(e.state=1);return e};t._onItemsChange=function(e){t.props.selectedTerms&&t.props.selectedTerms.length<e.length&&t.setState({tagUpdatedText:t.announceTagAdded(e[e.length-1].term.label)},function(){return t.focus()});t.props.onItemsChange(e)};t.state={tagUpdatedText:null};return t}e.prototype.render=function(){return o.createElement("div",{className:"ms-Taxonomy-termPickerContainer"},o.createElement(t.TaxonomyTermPicker,{className:a.css(this.props.className,"ms-Taxonomy-termPicker"),onResolveSuggestions:this.props.resolveSuggestions,onChange:this._onItemsChange,onItemSelected:this._onItemSelect,selectedItems:this.props.selectedTerms,getTextFromItem:this._getTextFromItem,createGenericItem:this._createGenericItem,onRenderItem:this._renderItem,onRenderSuggestionsItem:this._renderSuggestion,onBlur:this.props.onBlur,onValidateInput:this._validateInput,itemLimit:this.props.termLimit,ref:this._termPicker,inputProps:{placeholder:u.default.InputPlaceholderText,"aria-label":u.default.InputHint}}),o.createElement("span",{className:"ms-Taxonomy-termPickerAccessible",role:"status","aria-live":"polite"},this.state.tagUpdatedText))};e.prototype.focus=function(){this._termPicker.value&&this._termPicker.value.focus()};e.prototype._createGenericItem=function(e,t){return{item:{term:{termId:d.INVALID_TERM_ID,label:e,isValid:!1},isSynonym:!1,completions:[],start:"",state:0},selected:!1}};e.prototype.announceTagAdded=function(e){return c.format(u.default.TagAdded,e)};return e}(a.BaseComponent);t.TaxonomyPicker=i});define("Zq",["require","exports","ap","at","Zs","Zr"],function(e,t,i,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.term,i=e.start,r=this.getParentPath();return a.createElement("div",{className:"ms-TermSuggestion-container"},t.label,!!r&&a.createElement("div",null,a.createElement("span",{className:"ms-TermSuggestion-path"}," ",r," ")),a.createElement(n,{synonyms:this._getSynonyms(this.props),start:i}))};t.prototype._getSynonyms=function(r){var o=[];if(r&&0<r.completions.length)for(var e=function(e){var t=r.completions[e];if(r.term.label.toLowerCase()===r.start.toLowerCase()+t.toLowerCase())return"continue";if(0<r.start.length&&r.term&&r.term.synonyms){var i=r.term.synonyms.filter(function(e){return e.toLowerCase()===r.start.toLowerCase()+t.toLowerCase()});1===i.length&&o.push(i[0])}},t=0;t<r.completions.length;t++)e(t);return o};t.prototype.getParentPath=function(){if(this.props.term&&this.props.term.paths){var e=this.props.term.paths[0];e[0]+e[e.length-1]==="[]"&&(e=e.substr(1,e.length-2));var t=e.split(":");return 0<t.length?r.default.SuggestionPathPrefix+" "+t[t.length-1]:""}};return t}(a.Component);t.TaxonomySuggestion=o;var n=function(e){var t=e.synonyms,n=e.start;return t&&0<t.length?a.createElement("ul",{className:"ms-TermSynonym-List"},t.map(function(e){return a.createElement("li",{key:e+"synonym"},a.createElement("span",{className:"ms-TermSyonym-synonymPrefix"},(r=e,o=n,0===r.toLowerCase().indexOf(o.toLowerCase())?r.substr(0,o.length):"").trim()),a.createElement("span",null,(t=e,i=n,0===t.toLowerCase().indexOf(i.toLowerCase())?t.substr(i.length):t).trim()));var t,i,r,o})):null}});define("Zr",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:'@charset "UTF-8";.ms-TermSynonym-List{margin-top:2px;list-style:none;color:'},{theme:"bodySubtext",defaultValue:"#666666"},{rawString:"}[dir=ltr] .ms-TermSynonym-List{padding-left:0}[dir=rtl] .ms-TermSynonym-List{padding-right:0}.ms-TermSynonym-List .ms-TermSyonym-synonymPrefix{font-weight:600}.ms-TermSynonym-List>li:before{content:'•';font-size:11px;padding-right:4px}html[dir=ltr] .ms-TermSuggestion-container{text-align:left}html[dir=rtl] .ms-TermSuggestion-container{text-align:right}.ms-TermSuggestion-path{font-size:12px;color:"},{theme:"bodySubtext",defaultValue:"#666666"},{rawString:"}"}])});define("Zf",["require","exports","at","Zi","jP","mo","Zd","Zh","Zg"],function(e,t,i,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TaxonomyItem=function(e){var t=function(e){var t=e.term,i=t.paths&&0<t.paths.length?t.label+" "+t.paths[0]:t.label;if(t.synonyms&&0<t.synonyms.length)return i+"\r\n"+(s.default.SynonymsTitle+t.synonyms.reduce(function(e,t){return e+a.TERM_DELIMITER+t}));return i}(e.item);return i.createElement("div",{className:o.css("ms-TaxonomyPicker-termContainer",e.selected?"ms-TaxonomyPicker-termSelected":"ms-TaxonomyPicker-term"),role:"listitem",key:e.index,"data-selection-index":e.index,"data-is-focusable":!e.disabled&&!0,title:t,"aria-label":t},i.createElement(r.TaxonomyLabel,{label:e.item.term.label,itemState:e.item.state}),i.createElement("span",{className:"ms-TaxonomyPicker-termCloseContainer"},i.createElement(n.Icon,{iconName:"Cancel",className:"ms-TaxonomyPicker-termClose",onClick:e.onRemoveItem})))}});define("Zi",["require","exports","ap","at","jP","Zd","Zj"],function(e,t,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TaxonomyLabel=function(e){var t=e.label,i=e.itemState,r=e.className,o=s.getNativeProps(e,s.htmlElementProperties);return a.createElement("div",n.__assign({},o,{className:s.css("ms-TaxonomyPicker-termLabel",r,2===i&&"ms-TaxonomyPicker-termLabelInvalid",1===i&&"ms-TaxonomyPicker-termLabelValid",0===i&&"ms-TaxonomyPicker-TermLabelUnknown")}),t+l.TERM_DELIMITER)}});define("Zd",["require","exports","aZ"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INVALID_TERM_ID=i.default.Empty;t.LABEL_ID_DELIMITER="|";t.TERM_DELIMITER=";"});define("Zj",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-TaxonomyPicker-termLabel{padding:0 4px;max-width:100%;text-overflow:ellipsis;overflow:hidden}.ms-TaxonomyPicker-termLabel.ms-TaxonomyPicker-termLabelInvalid{color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:";text-decoration:dotted underline}.ms-TaxonomyPicker-termLabel.ms-TaxonomyPicker-termLabelValid{text-decoration:underline}.ms-TaxonomyPicker-termLabel.ms-TaxonomyPicker-TermLabelUnknown{color:"},{theme:"warningHighlight",defaultValue:"#ffb900"},{rawString:";text-decoration:dotted underline}"}])});define("Zg",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-TaxonomyPicker-termContainer{font-size:14px;cursor:pointer;text-align:center;-ms-flex-negative:1;flex-shrink:1;margin:2px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:-ms-flexbox;display:flex;max-width:100%}html[dir=ltr] .ms-TaxonomyPicker-termContainer{text-align:left}html[dir=rtl] .ms-TaxonomyPicker-termContainer{text-align:right}.ms-TaxonomyPicker-termContainer:focus{outline:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.ms-TaxonomyPicker-term:hover{background-color:"},{theme:"listItemBackgroundHovered",defaultValue:"#f8f8f8"},{rawString:"}.ms-TaxonomyPicker-termSelected{background-color:"},{theme:"listItemBackgroundChecked",defaultValue:"#eaeaea"},{rawString:"}.ms-TaxonomyPicker-termSelected:hover{background-color:"},{theme:"listItemBackgroundCheckedHovered",defaultValue:"#d0d0d0"},{rawString:"}.ms-TaxonomyPicker-termClose{cursor:pointer;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px;display:inline-block;padding:0 4px;height:100%}"}])});define("Zo",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-Taxonomy-termPickerContainer{width:100%}.ms-Taxonomy-termPicker{border:0;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";outline:0;display:inline-block;width:100%;background-color:"},{theme:"bodyBackground",defaultValue:"#ffffff"},{rawString:";padding:4px}[dir=ltr] .ms-Taxonomy-termPicker{padding-left:0}[dir=rtl] .ms-Taxonomy-termPicker{padding-right:0}.ms-Taxonomy-termPicker .ms-BasePicker-text{border:none}.ms-Taxonomy-termPicker .ms-BasePicker-text .ms-BasePicker-input{padding:0}.ms-Taxonomy-termPicker.is-focused{border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:"}.ms-Taxonomy-termPickerAccessible{position:absolute;top:-9001px;left:-9001px;height:1px;width:1px}"}])});define("Zk",["require","exports","ap","at","xH","o1","jP","b6","Zm","Zl"],function(e,t,i,r,o,n,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(t){i.__extends(e,t);function e(e){var n=t.call(this,e)||this;n._iFrame=a.createRef();n.iframeOnLoad=function(e){var t=e.target;if(t&&t.contentWindow){var i=t.contentWindow.document,r=s.default.getElementByTagAndPartialId(i,"input","OkButton"),o=s.default.getElementByTagAndPartialId(i,"input","CancelButton");if(r&&o){if(!r.onclickListenerAdded){r.onclickListenerAdded=!0;n._events.on(r,"click",function(e){var t=s.default.getElementByTagAndPartialId(i,"input","FieldEditorHiddenInput");n.props.resultHander(t)})}if(!o.onclickListenerAdded){o.onclickListenerAdded=!0;n._events.on(o,"click",function(e){n.props.resultHander(null);e.stopPropagation();e.preventDefault()})}}n.setInnerDialogStyle(i);n._async.setTimeout(function(){var e=t.style.height;e&&"0px"!==e||(e=.618*document.body.clientHeight+"px");n.setState({loading:!1,iFrameStyle:{height:e}})},200)}};n.state={loading:!0};return n}e.prototype.render=function(){return r.createElement(o.Dialog,{hidden:!1,modalProps:{containerClassName:"ms-TreePicker-dialog"},title:l.default.WebTaggingDialogTitle+this.props.field.schema.Name,onDismiss:this.props.onDismiss},this.state.loading&&r.createElement("div",{className:"ms-TreePicker-dialogSpinner"},r.createElement(n.Spinner,{label:l.default.TaxonomyTreeLoadingLabel}," ")),r.createElement("iframe",{className:"ms-TreePicker-iFrame",ref:this._iFrame,src:this.props.taxonomyTreeUrl,onLoad:this.iframeOnLoad,style:this.state.iFrameStyle,sandbox:"allow-same-origin allow-scripts"}))};e.prototype.componentWillUnmount=function(){this._iFrame.value&&(this._iFrame.value.src="")};e.prototype.setInnerDialogStyle=function(e){var t=e.getElementById("FieldEditoreditableRegion");if(t){t.parentElement.style.width="100%"}};return e}(a.BaseComponent);t.TaxonomyTreePicker=d});define("Zl",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-TreePicker-dialog.ms-Dialog-main{max-width:640px;width:100%;max-height:none}.ms-TreePicker-iFrame{border:none;width:100%}.ms-TreePicker-dialogSpinner{width:100%;padding:15px 0}"}])});define("Ze",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.unknown=0]="unknown";e[e.valid=1]="valid";e[e.invalid=2]="invalid"}(t.TermValidationState||(t.TermValidationState={}))});define("Y9",["require","exports","ap","Zb","Za"],function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(o,t)});define("Zb",["require","exports","ap","ef","aM","dK"],function(e,t,i,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getSuggestions=function(e,t){var r=this;return this.getData(function(){return r._pageContext.webAbsoluteUrl+"/_vti_bin/TaxonomyInternalService.json/GetSuggestions"},function(e){var t=JSON.parse(e);if(0===t.d.Groups.length)return[];var i=t.d.Groups[0].Suggestions;return r.transformSuggestionData(i)},"TaxonomySuggestion",function(){return r.constructSuggestionPostBody(e,t)})};t.prototype.getMatches=function(e,t){var i=this;return this.getData(function(){return i._pageContext.webAbsoluteUrl+"/_vti_bin/TaxonomyInternalService.json/GetMatches"},function(e){var t=JSON.parse(e).d.Matches;return i.transformMatchData(t)},"TaxonomyMatch",function(){return i.constructMatchPostBody(e,t)})};t.prototype.getTaxonomyTreeUrl=function(e,t,i){var r=a.default.escapeUrlForCallback(this._pageContext.webAbsoluteUrl),o=a.default.escapeUrlForCallback(this._pageContext.layoutsUrl),n={Field:t.name,IsDlg:1,lcid:i.lcid,sspIds:i.sspList,termSetIds:i.termSetList,anchorGuid:i.anchorId,fieldName:t.name,fieldId:t.id,IsMulti:t.isMulti,tags:e,allowFillIn:i.allowFillIn,webServiceUrl:i.webServiceUrl,isAddTerms:i.isAddTerms,isIgnoreFormatting:!1,isIncludeDeprecated:i.isIncludeDeprecated,isIncludePathData:i.isIncludePathData,isIncludeTermSetName:i.isIncludeTermSetName,isIncludeUnavailable:i.isIncludeUnavailable,isSpanTermSets:i.isSpanTermSets,isSpanTermStores:i.isSpanTermStores,isUseCommaAsDelimiter:i.isUseCommaAsDelimiter};return r+"/"+o+"/WebTaggingDialog.aspx?"+s.serializeQuery(n)};t.prototype.getDataSourceName=function(){return"TaxonomyDataSource"};t.prototype.transformSuggestionData=function(e){var r=this;return e.map(function(e){var t={label:e.DefaultLabel,description:e.Description,termId:e.Id,isKeyword:e.IsKeyword,paths:e.Paths,rawSynonyms:e.Synonyms,synonyms:r.processSynonymsData(e.Synonyms),isValid:!0},i={completions:e.Completions,starts:e.Starts,isSynonym:e.IsSynonym};return{term:t,isSynonym:i.isSynonym,start:i.starts?i.starts[0]:null,completions:i.completions}})};t.prototype.transformMatchData=function(e){var r=this;return e.map(function(e){var t={label:e.DefaultLabel,termId:e.Id,isAmbiguous:e.IsAmbiguous,disambiguationData:[]};if(t.isAmbiguous){var i=e.DisambiguationData;t.disambiguationData=i.map(function(e){return{label:e.DefaultLabel,description:e.Description,termId:e.Id,isSynonym:e.IsSynonym,paths:e.TermsetAndPaths,synonyms:r.processSynonymsData(e.Synonyms)}})}return t})};t.prototype.processSynonymsData=function(e){var t=[];e&&0<e.length&&(t=e.split(";").map(function(e){return e.trim()}).filter(function(e){return e&&0<e.length}));return t};t.prototype.constructSuggestionPostBody=function(e,t){var i={start:e,lcid:t.lcid,sspList:t.sspList,termSetList:t.termSetList,anchorId:t.anchorId,isSpanTermStores:t.isSpanTermStores,isSpanTermSets:t.isSpanTermSets,isIncludeUnavailable:t.isIncludeUnavailable,isIncludeDeprecated:t.isIncludeDeprecated,isAddTerms:t.isAddTerms,isIncludePathData:t.isIncludePathData,excludeKeyword:t.excludeKeyword,excludedTermset:t.excludedTermset};return JSON.stringify(i)};t.prototype.constructMatchPostBody=function(e,t){var i={terms:e,lcid:t.lcid,SSPList:t.sspList,termSetList:t.termSetList,anchorId:t.anchorId,isSpanTermStores:t.isSpanTermStores,isSpanTermSets:t.isSpanTermSets,isIncludeUnavailable:t.isIncludeUnavailable,isIncludeDeprecated:t.isIncludeDeprecated,isAddTerms:t.isAddTerms,isIncludeTermSetName:t.isIncludeTermSetName,isIncludePathData:t.isIncludePathData,isUseCommaAsDelimiter:t.isUseCommaAsDelimiter};return JSON.stringify(i)};return t}(r.default);t.TaxonomyDataSource=o;t.default=o});define("Za",["require","exports","aC"],function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){void 0===e&&(e={});this.dataSource=t.dataSource;this.matchResult={promise:null};this.suggestionResult={promise:null}}e.prototype.getSuggestions=function(i,r){var o=this,n=null;this.suggestionResult.promise=new a.default(function(t,e){n=o.dataSource.getSuggestions(i,r).then(function(e){t(e)})},function(){n&&n.cancel()});return this.suggestionResult};e.prototype.getMatches=function(e,t){this.matchResult.promise=this.dataSource.getMatches(e,t).then(function(e){return e},function(e){throw e});return this.matchResult};return e}();t.TaxonomyProvider=i;t.default=i});define("Y8",["require","exports","Zc","aC"],function(e,t,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function a(e){this._taxonomyProvider=e.dataProvider}Object.defineProperty(a.prototype,"hasActiveQuery",{get:function(){return!!this._suggestionsQuery||!!this._matchQuery},enumerable:!0,configurable:!0});a.filterTaggedTerms=function(i,r){for(var o=[],e=function(e){var t=i[e];0===r.filter(function(e){return e.term.label===t.term.label&&e.term.termId===t.term.termId}).length&&o.push(t)},t=0;t<i.length;t++)e(t);return o};a.convertTermsToRawString=function(e){for(var t="",i=0;i<e.length;i++){var r=e[i];if(r.term.isValid){t+=r.term.label+n.LABEL_ID_DELIMITER+r.term.termId;i<e.length-1&&(t+=n.TERM_DELIMITER)}else t+=r.term.label+n.LABEL_ID_DELIMITER+r.term.termId+n.TERM_DELIMITER}return t};a.createMatchString=function(e,t){var i="";i=a.convertTermsToRawString(e);t&&0<t.length&&(i+=t+n.LABEL_ID_DELIMITER+n.INVALID_TERM_ID);return i};a.prototype.resolveSuggestions=function(e,t){var i=this;this._abortSuggestionQuery();var r=this._taxonomyProvider.getSuggestions(e,t).promise,o=function(e){i._suggestionsQuery=null};this._suggestionsQuery=new s.default(function(t){r.then(function(e){t(e)}).catch(o)});return this._suggestionsQuery};a.prototype.validateTerms=function(e,t,i){var r=this;this._abortSuggestionQuery();var o=a.createMatchString(t,i);if(o&&0<o.length&&e){var n=this._taxonomyProvider.getMatches(o,e);this._matchQuery=new s.default(function(t){n.promise.then(function(e){e&&0<e.length?t(r.ProcessMatchResults(e)):t([])}).catch(function(e){r._matchQuery=null})});return this._matchQuery}return s.default.resolve([])};a.prototype.ProcessMatchResults=function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i],o={term:{termId:"",label:r.label},isSynonym:!1,completions:[],start:"",state:0};if(r.termId!==n.INVALID_TERM_ID){if(r.isAmbiguous){if(r.disambiguationData&&0<r.disambiguationData.length){o.term.label=r.disambiguationData[0].label;o.term.termId=r.disambiguationData[0].termId}}else{o.term.label=r.label;o.term.termId=r.termId}o.state=1}else{o.term.label=r.label;o.term.termId=r.termId;o.state=2}t.push(o)}return t};a.prototype._abortSuggestionQuery=function(){if(this._suggestionsQuery){this._suggestionsQuery.cancel();this._suggestionsQuery=null}if(this._matchQuery){this._matchQuery.cancel;this._matchQuery=null}};return a}();t.TaxonomyEditorDataManager=i});define("Y6",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ReactFieldEditor-Taxonomy{display:-ms-flexbox;display:flex}"}])});define("aag",["require","exports"],function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.COMPLIANCETAG_FIELD_NAME="_ComplianceTag";i.COMPLIANCETAG_FIELD_ID="D4B6480A-4BED-4094-9A52-30181EA38F1D";i.ASSETID_FIELD_NAME="ComplianceAssetId";i.ASSETID_FIELD_ID="3A6B296C-3F50-445C-A13F-9C679EA9DDA3";i.isClientFormComplianceAssetIdField=function(e){return!!(e&&e.schema&&t(e.schema.FieldType,e.schema.Id))};function t(e,t){return!(!e||"text"!==e.toLowerCase()||!t||t.toLowerCase()!==i.ASSETID_FIELD_ID.toLowerCase())}i.isComplianceAssetIdField=t;i.isClientFormComplianceTagField=function(e){return!!(e&&e.schema&&r(e.schema.FieldType,e.schema.Id))};function r(e,t){return!(!e||"lookup"!==e.toLowerCase()||!t||t.toLowerCase()!==i.COMPLIANCETAG_FIELD_ID.toLowerCase())}i.isComplianceTagField=r});define("aaf",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ReactClientForm .ReactClientFormFields{width:100%}.ReactClientForm .ReactClientForm-error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";margin-top:4px;font-size:12px;transition:height .15s ease;padding:8px 12px;border-left:4px solid #a6a6a6;max-width:372px;width:100%;-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.ReactClientForm .ReactClientForm-editButtons{margin-top:20px}[dir=ltr] .ReactClientForm .ReactClientForm-button-far{margin-left:8px}[dir=rtl] .ReactClientForm .ReactClientForm-button-far{margin-right:8px}.ReactClientForm .ReactClientForm-button-far .ms-Button{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ReactClientForm .ReactClientForm-button-far .ms-Button:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.ReactClientForm.is-bulkEdit{position:absolute;display:-ms-flexbox;display:flex;top:64px;left:0;right:0;-ms-flex-direction:column;flex-direction:column;overflow:hidden;width:auto}.ReactClientForm.is-bulkEdit .ReactClientFormFields{overflow-y:auto;padding:0 16px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";width:auto}.ReactClientForm.is-bulkEdit .ReactClientForm-editButtons{border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";-ms-flex-positive:0;flex-grow:0;margin-top:0;padding:20px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;min-height:32px}.ReactClientForm.is-bulkEdit .ReactClientForm-statusIndicator{margin:0 4px 0 8px;position:relative;display:inline-block}html[dir=rtl] .ReactClientForm.is-bulkEdit .ReactClientForm-statusIndicator{margin:0 8px 0 4px}.ReactClientForm.is-bulkEdit .ms-Button--primary:disabled{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}"}])});define("YX",["c","az"],function(e,t){e.loadStyles([{rawString:".ReactClientForm-noCommonPropertiesMessage{font-size:14px}"}])});