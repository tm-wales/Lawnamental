define("zP",["require","exports","zV","b5","zU","zT","pD","pG","zR","zQ","d0"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-filepicker",template:e("zU"),viewModel:r.default,synchronous:!0});t.default=o});define("zV",["require","exports","ap","rP","bF","A3","bX","A2","dZ","jG","iE","d7","re","q0","qT","ri","pO","At","ep","eA","As","Ar","z4","z2","kH","zj","cF","z1","aC","dd","rS","zW","bA","dH","te"],function(e,t,r,m,i,f,v,g,h,_,y,b,P,x,k,w,I,A,C,T,S,M,O,E,B,N,R,L,F,H,D,U,z,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(p){r.__extends(e,p);function e(e){void 0===e&&(e={});var t=p.call(this,e)||this;t.overlayHostTagName=P.default.tagName;t.dialogHostTagName=x.default.tagName;t.panelHostTagName=k.default.tagName;t.topBarTagName=w.default.tagName;t.standaloneListTagName=I.default.tagName;t.itemPickerTagName=A.default.tagName;t.dragAndDropTagName=H.default.tagName;t.addBindingHandlers({hideWhenInactive:D.default});var r=t,i=r.resources,o=r.observables;i.expose(v.disableCalloutInvoker,!0);i.exposeFactory(h.leftNav,new z.AliasResourceFactory(U.resourceKey));i.exposeFactory(h.itemPicker,new z.AliasResourceFactory(O.resourceKey));i.expose(_.files.isArrangeControlVisible,o.create(!1));i.expose(N.resourceKey,{canUserCreateGroup:function(){return F.default.wrap(!1)}});var n=t._pageContext=i.consume(y.pageContext),a=new(t.child(S.typeResourceKey)),s=a.getBehavior(),c=a.getAgent();i.expose(R.engagementSourceResourceKey,i.consume(R.engagementSourceResourceKey).withPart(L.filePickerEngagementPart,{behavior:s}));var d=new(i.consume(E.typeResourceKey))({behavior:s});t.resources.expose(B.resourceKey,d);var l=new(t.child(M.typeResourceKey))({behavior:s});t.scope.attach(m.default.exposeResources({resourceScope:i,pageContext:n,viewId:n.viewId,selectionOptions:{mode:g.SELECTION_MODE_MAPPING[s.selectionMode],maximumSelectedCount:s.maximumSelectedCount,canSelectItem:l.getCanSelectItem()},itemResultSetOptions:{fieldNames:["name.FileSystemItemId"]},disableAutomaticLayoutSwitch:!0}));t._dataManager=i.consume(_.dataManager);t._instrumentationProvider=i.consume(b.instrumentation);t._viewParams=i.consume(v.viewParams);t._urlDataSource=i.consume(h.url);t._itemParentHelper=i.consume(T.resourceKey);var u=new(t.managed(f.default))({behavior:s});t.standaloneListParams={hideContextMenus:!0,isCustomList:Number(n.webTemplate)!==C.WebTemplateType.mySite,breadcrumbBuilder:t._dataManager.getCrumbs.bind(t._dataManager)};t.itemPickerParams={behavior:s,agent:c,commandSet:u};u.navigateToPivot();t._initializeUpdatePageInstrumentation();return t}e.prototype._initializeUpdatePageInstrumentation=function(){var i=this;this.observables.backgroundCompute(function(){var e=i._dataManager.itemSet(),t=e.item.peek();if(t&&!t.isPlaceholder){var r=i._getCurrentPageName();i._instrumentationProvider.userViewPage({viewParams:i._viewParams.peek(),item:t,name:r})}else e.item()}).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}})};e.prototype._getCurrentPageName=function(){var e=this._dataManager.item.peek(),t=this._urlDataSource,r=t.getKeyParams(e.key),i=t.getQueryType(r),o=["FilePicker"],n=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"subsite"));n&&n.subsite.serverRelativeUrl!==this._pageContext.webAbsoluteUrl&&o.push("Sites");switch(i){case a.default.Subsites:o.push("Sites");break;case a.default.DocumentLibraries:o.push("Libraries");break;case a.default.Recent:o.push("Recent");break;case a.default.Files:default:o.push("Folder")}return o.join("-")};return e}(i.default);t.default=o});define("A3",["require","exports","ap","aq","rt","bX","rs","dm","dI","zZ","s5","A4","Ah","dG","dJ"],function(e,t,r,c,i,d,l,u,p,m,f,v,g,h,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){r.__extends(s,a);function s(e){void 0===e&&(e={});var t=a.call(this,e)||this;t._itemPickerProvider=t.resources.consume(g.resourceKey);t._viewParams=t.resources.consume(d.viewParams);var r=e.behavior,i=void 0===r?t.resources.consume(m.behavior):r;t._behavior=i;t._actionMap=t.resources.consume(d.actionMap);t._initializePivots(t._behavior);t._navigationAction=new(t.managed(t._actionMap.NavigationAction))({url:t.createPureComputed(t._computeInitialUrl),ignoreHistory:!0});var o,n=new(t.managed(f.default))({renderLabel:1}).command;(o=t.commands).push.apply(o,t._pivots.concat([new(t.managed(l.CommandViewModel))({location:0,action:new(t.managed(t._actionMap.OpenAction))({openRelation:3}),keys:["AltUp"]}),new(t.managed(l.CommandViewModel))({text:u.strings.CreateFolderCommand,icon:new p.default("Folder"),action:new(t.managed(t._actionMap.CreateFolderAction)),automationId:"createFolder",engagementName:"NewFolder"+s.sourceNameEngagement}),new(t.managed(l.CommandViewModel))({text:u.strings.Upload,tooltip:u.strings.UploadCommandTooltip,icon:new p.default("Upload"),requiredChildren:1,automationId:"upload",engagementName:"Upload"+s.sourceNameEngagement,children:c.observableArray([new(t.managed(l.CommandViewModel))({text:u.strings.UploadFile,collapsedText:t.createObservable(u.strings.Upload),action:new(t.managed(t._actionMap.UploadAction))({uploadProcessorType:h.UploadProcessorType.Html5file}),automationId:"uploadFiles",engagementName:"UploadFiles"+s.sourceNameEngagement}),new(t.managed(l.CommandViewModel))({text:u.strings.UploadFolder,action:new(t.managed(t._actionMap.UploadAction))({uploadProcessorType:h.UploadProcessorType.Folder}),automationId:"uploadFolder",engagementName:"UploadFolder"+s.sourceNameEngagement})])}),new(t.managed(l.CommandViewModel))({text:u.strings.selectItems,renderLabel:2,icon:new p.default("CheckboxComposite"),action:new(t.managed(t._actionMap.ToggleSelectionModeAction))}),n,(new(t.managed(v.default))).command,new(t.managed(l.CommandViewModel))({location:0,action:new(t.managed(t._actionMap.ShowSelectionAction)),keys:["CtrlD","MetaD"]})]));return t}s.prototype.navigateToPivot=function(){this._navigationAction.execute(null).done()};s.prototype._initializePivots=function(e){var t=this;this._pivots=[];if(!e.showNavigation){var r=this._itemPickerProvider.getPivots({behavior:e,viewParams:this._viewParams.peek()}).pivots;if(1===r.length)return;for(var i=function(e){return t.createPureComputed(function(){return e(t._viewParams())})},o=0;o<r.length;o++){var n=r[o],a=n.item,s=i(n.isActive),c=this.createObservable(a);this._pivots.push(new(this.managed(l.CommandViewModel))({text:a.displayName,isPermanent:!0,action:new(this.managed(this._actionMap.DefaultClickAction))({item:c,sourceEngagement:"FilePicker.Pivot.Click"}),isCurrentView:s,isLastPivot:o===r.length-1}))}}};s.prototype._computeInitialUrl=function(){var e=this._itemPickerProvider.getInitialViewParams({behavior:this._behavior,viewParams:this._viewParams.peek()}).viewParams;return"#"+o.serializeQuery(e)};s.sourceNameEngagement=".InFilePickerCommandBar";return s}(i.default);t.default=n});define("zZ",["require","exports","bA"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.actionMap=new r.ResourceKey("actionMap");t.agent=new r.ResourceKey("agent");t.behavior=new r.ResourceKey("behavior");t.status=new r.ResourceKey("status")});define("A4",["require","exports","ap","bN","V","rs","A5","bX","jG","dm","ba","lb","dI","aq"],function(e,t,r,i,o,v,g,h,_,y,n,b,P,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=n.isFeatureEnabled(n.CompactListViewInFiles),a=function(f){r.__extends(e,f);function e(e){void 0===e&&(e={});var t=f.call(this,e)||this,r=t.resources.consume(h.actionMap);t._layoutType=t.resources.consume(_.files.layoutType);var i=e.isSelectionMode,o=void 0===i?t.createObservable(!1):i,n=e.location,a=void 0===n?4:n,s=e.allowAlbumView,c=void 0!==s&&s,d=e.clearContextualFilter,l=void 0!==d&&d;t._shouldClearContextualFilter=l;var u=new(t.managed(g.default))({showLabels:null});t._viewToggleIcon=t.createPureComputed(function(){return u.computeViewSelectorIcon()},{deferEvaluation:!0});t._viewSelectorAriaLabel=t.createPureComputed(t._computeViewSelectorAriaLabel);var p=[new(t.managed(v.CommandViewModel))({text:y.strings.ViewList,tooltip:y.strings.ViewListCommandTooltip,icon:new P.default(g.default.detailsIcon),renderLabel:0,isToggleable:!0,isHidden:o,hasIconOnly:!0,action:new(t.managed(r.ToggleListLayoutAction))({layoutType:b.Details,clearContextualFilter:t._shouldClearContextualFilter}),automationId:"switchLayout",engagementName:"ViewList"})].concat(k?[new(t.managed(v.CommandViewModel))({text:y.strings.ViewCompactList,tooltip:y.strings.ViewCompactListCommandTooltip,icon:new P.default(g.default.compactDetailsIcon),renderLabel:0,isToggleable:!0,isHidden:o,hasIconOnly:!0,action:new(t.managed(r.ToggleListLayoutAction))({layoutType:b.CompactDetails,clearContextualFilter:t._shouldClearContextualFilter}),engagementName:"ViewCompactList"})]:[],[new(t.managed(v.CommandViewModel))({text:y.strings.ViewGrid,tooltip:y.strings.ViewGridCommandTooltip,icon:new P.default(g.default.gridIcon),renderLabel:0,isToggleable:!0,isHidden:o,hasIconOnly:!0,action:new(t.managed(r.ToggleListLayoutAction))({layoutType:b.Grid,clearContextualFilter:t._shouldClearContextualFilter}),engagementName:"ViewGrid"})]);c&&p.push(new(t.managed(v.CommandViewModel))({text:y.strings.ViewLargeGrid,renderLabel:0,icon:new P.default(g.default.singleAlbumIcon),isToggleable:!0,isHidden:o,hasIconOnly:!0,action:new(t.managed(r.ToggleListLayoutAction))({layoutType:b.SingleAlbum,clearContextualFilter:t._shouldClearContextualFilter}),engagementName:"ViewLargeGrid"}));var m=new(t.managed(v.CommandViewModel))({tooltip:y.strings.ViewsCommandTooltip,accessibleLabel:t._viewSelectorAriaLabel,renderLabel:0,icon:t._viewToggleIcon,location:a,isHidden:o,hasIconOnly:!0,collapseSingleChildCommands:!0,requiredChildren:2,children:x.observableArray(p)});t.command=m;return t}e.prototype._computeViewSelectorAriaLabel=function(){var e,t=this._layoutType();e=t===b.SingleAlbum?y.strings.ViewAlbumView:t===b.Grid||t===b.CustomGridList?y.strings.ViewGrid:t===b.CompactDetails?y.strings.ViewCompactList:y.strings.ViewList;return o.format(y.strings.ViewsCommandAriaLabel,e,"","")};return e}(i.default);t.default=a});define("Ah",["require","exports","ap","bN","dZ","eU","eU","bA"],function(e,t,o,r,n,a,s,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){o.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._itemPickerDataSource=t.itemPickerDataSource;r._urlDataSource=t.urlDataSource;return r}e.prototype.getHandler=function(e){return this._itemPickerDataSource.getHandler(e)};e.prototype.getPivots=function(e){return this._itemPickerDataSource.getPivots(e)};e.prototype.getInitialViewParams=function(e){var t=e.behavior.typeFilter,r=void 0===t?{filters:[]}:t,i=e.viewParams;return{viewParams:o.__assign({},i,this._urlDataSource.saveItemTypeFilter(r))}};e.prototype.getItemFromPickerItem=function(e){var t={key:""};a.default(t,{itemId:e.id,graph:{itemId:e.id,driveId:s.optional(e.parentReference&&e.parentReference.driveId)},name:s.backup(e.name),extension:s.backup(e.extension),folder:s.optional(e.folder&&{})});a.default(t,this._itemPickerDataSource.getItemFromPickerItem(e));return t};e.prototype.getPickerItemFromItem=function(e,t){var r={id:e.itemId};a.default(r,{id:e.itemId,parentReference:s.optional(e.graph&&{driveId:e.graph.driveId}),folder:s.optional(e.folder&&{})});0<t.hostAuthenticationLevel&&a.default(r,{name:e.name,extension:e.extension});a.default(r,this._itemPickerDataSource.getPickerItemFromItem(e,t));return r};e.dependencies=o.__assign({},r.default.dependencies,{itemPickerDataSource:n.itemPicker,urlDataSource:n.url});return e}(r.default);t.default=c;t.resourceKey=i.createResolvedResourceKey(e("module").id,c)});define("A2",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MSA_CLIENT_ID_PARAM="msa_client_id";t.AAD_CLIENT_ID_PARAM="aad_client_id";t.RETURN_URL_PARAM="ru";t.VIEW_TYPE_PARAM="view_type";t.SELECTION_MODE_PARAM="selection_mode";t.LINK_TYPE_PARAM="link_type";t.ACCESS_LEVEL_PARAM="access";t.PROMPT_PARAM="prompt";t.PROMPT_SELECT_ACCUNT_VALUE="select_account";t.SELECTION_MODE_VALUES={"":0,multi:1,multiple:1,single:0};t.SELECTION_MODE_MAPPING=((r={})[1]=0,r[0]=1,r);t.VIEW_TYPE_VALUES={"":1,file:1,folder:2,all:0};t.LINK_TYPE_VALUES={"":1,weblink:1,downloadlink:2,webviewlink:0};t.ACCESS_LEVEL_VALUES={"":0,read:0,readwrite:1};t.SELECTION_MAX_ITEMS=10;var r});define("At",["require","exports","b5","AF","AE","AD","uW","Ay","Au"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-item-picker",template:e("AE"),viewModel:i.default,synchronous:!0});t.default=o});define("AF",["require","exports","ap","bF","cA","A0","AZ","AM","zZ","bX","Au","qe","uW","s0","AL","ri","AI","zY","AH","qa","rw","rm","jG","b3","cI","cR","cT","cV","cp","d5","AG","iS","yi"],function(e,t,r,i,I,A,C,T,S,M,O,E,B,N,R,L,F,H,D,o,U,z,K,q,V,j,W,G,Z,Q,X,Y,$){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(w){r.__extends(e,w);function e(e,t){void 0===t&&(t={});var r=w.call(this,e)||this;r.itemPickerHeaderTagName=O.default.tagName;r.buttonBarTagName=B.default.tagName;r.topBarTagName=L.default.tagName;r.dialogOverlayTagName=F.default.tagName;r.leftNavExpanderTagName=z.default.tagName;r.overlayTagName=Z.default.tagName;r.secureExperienceWarningText=H.strings.secureExperienceWarningText;r.addBindingHandlers({host:I.default,control:q.default,dismiss:V.default,focusTrap:j.default,recoverFocus:W.default,preserveFocus:G.default});var i=e.behavior,o=void 0===i?{}:i,n=e.agent,a=e.commandSet,s=o.showActions,c=void 0!==s&&s,d=o.showBranding,l=void 0!==d&&d,u=o.showNavigation,p=void 0!==u&&u,m=o.enableFocusTrap,f=void 0!==m&&m,v=r,g=v.resources,h=v.observables;r._isNavigationEnabled=p;g.expose(S.actionMap,new(r.managed(T.default)));g.expose(S.agent,n);r._status=g.expose(S.status,h.create({state:0}));g.expose(S.behavior,o);g.expose(Y.resourceKey,o.typeFilter);g.expose($.resourceKey,X.mergeSourceTypeFilters(o.sourceTypes,X.getSourceTypeFilter(o.typeFilter)));r._responsiveUI=g.consume(Q.resourceKey);r._statusHelper=g.consume(D.resourceKey);r._itemsSelection=g.consume(M.itemsSelection);h.subscribe(r._itemsSelection.selection,r._onSelectionChanged);r.itemPickerHeaderParams={};if(a||!c){var _=[];c||_.push(new(r.managed(R.default)));_.push(a);r.commandBarSpecification=q.toSpecification(E.resourceKey,{commandSet:new(r.managed(N.default))({commandSets:_})})}if(c){var y=t.commandSet,b=void 0===y?new(r.managed(A.default)):y;r.buttonBarParams={commandSet:b}}r.showContent=h.create(!1);r.showSecureExperienceDialog=h.create(!1);r.secureExperienceErrorText=h.pureCompute(r._computeSecureExperienceErrorText);r.secureExperienceErrorStyle=h.pureCompute(r._computeSecureExperienceErrorStyle);r.showBranding=l;r.showActions=c;r.showCommandBar=!!a;r.isFocusTrapEnabled=h.create(f);var P=t.secureExperienceCommandSet,x=void 0===P?new(r.managed(C.default)):P;r.secureExperienceCommandSet=x;r.hostBindingOptions={data:{status:r._status}};r.showLeftPane=h.pureCompute(r._computeShowLeftPane);r.showLeftPaneExpander=h.pureCompute(r._computeShowLeftPaneExpander);var k=r.isLeftPaneOpen=h.create(!1);r.leftPaneSpecification=q.toSpecification(U.default,{isLeftNavVisible:h.pureCompute(function(){return r.showLeftPane()||k()})});g.expose(K.base.leftNav.isLeftNavUserExpanded,k);g.expose(K.base.leftNav.toggleIsLeftNavUserExpanded,function(){k(!k.peek());return!1});n.initialize().done(function(){r.showContent(!0)},function(e){r.showSecureExperienceDialog(!0)});return r}e.prototype._onSelectionChanged=function(){this._status({state:0})};e.prototype._computeSecureExperienceErrorText=function(){var e=this._statusHelper.commandStatus();return e&&e.text||""};e.prototype._computeSecureExperienceErrorStyle=function(){var e=this._statusHelper.commandStatus();return o.default[e&&e.state||o.default.initialized]};e.prototype._computeShowLeftPane=function(){var e=this._responsiveUI;return this._isNavigationEnabled&&0<e.compareSize(e.formFactorSize(),"Large")};e.prototype._computeShowLeftPaneExpander=function(){return this._isNavigationEnabled&&!this.showLeftPane()};return e}(i.default);t.default=n});define("A0",["require","exports","ap","rt","rs","zZ","A1","zY","d4"],function(u,e,t,r,p,m,f,v,g){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(l){t.__extends(e,l);function e(e){void 0===e&&(e={});var t=l.call(this,e)||this,r=t.resources.consume(m.behavior),i=t.resources.consume(m.actionMap),o=t.resources.consume(m.status),n="undefined"==typeof __webpack_public_path__?u.toUrl("odsp-media/images/loading/loadingspinner.gif"):u("@ms/odsp-media/dist/media/images/loading/loadingSpinner.gif"),a=r.completeText,s=void 0===a?2===r.viewType&&1===r.accessLevel?v.strings.completeReadWriteFoldersActionText:v.strings.completeReadFilesActionText:a,c=r.cancelText,d=void 0===c?v.strings.cancelActionText:c;t.commands.push(new(t.managed(f.default))({location:12}).command,new(t.managed(p.CommandViewModel))({location:12,iconUrl:n,isDisabled:t.createObservable(!0),isHidden:t.createPureComputed(function(){return 1!==o().state}),text:g.strings.LoadingText,renderLabel:0}),new(t.managed(p.CommandViewModel))({text:s,action:new(t.managed(i.ItemPickerCompleteAction)),isPermanent:!0}),new(t.managed(p.CommandViewModel))({text:d,action:new(t.managed(i.ItemPickerCancelAction)),isPermanent:!0}));return t}return e}(r.default);e.default=i});define("A1",["require","exports","ap","bN","rs","qa","AH"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this,r=t.resources.consume(a.resourceKey);t._commandStatus=r.commandStatus;t._label=t.createPureComputed(t._computeLabel);t.command=new(t.managed(o.CommandViewModel))({isDisabled:t.createObservable(!0),text:t._label,location:e.location,isHidden:t.createPureComputed(function(){return!t._label()}),state:t.createPureComputed(t._computeState)});return t}e.prototype._computeLabel=function(){var e=this._commandStatus();return e&&e.text};e.prototype._computeState=function(){var e=this._commandStatus();return e&&e.state||n.default.initialized};return e}(i.default);t.default=s});define("AH",["require","exports","ap","bN","zZ","bX","qa","V","zY","bA","aL"],function(e,t,r,i,n,a,s,c,d,o,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(o){r.__extends(e,o);function e(e,t){void 0===e&&(e={});var r=o.call(this,e,t)||this;r._itemPickerStatus=t.itemPickerStatus;r._behavior=t.behavior;r._itemsSelection=t.itemsSelection;r._error=r.createObservable();r._application=r.createObservable();r.commandStatus=r.createPureComputed(r._computeCommandStatus);r.commandStatus.equalityComparer=l.deepCompare;var i=t.agent;i&&r.trackPromise(i.getApplication()).done(function(e){r._application(e)},function(e){r._error(e)});return r}e.prototype._computeCommandStatus=function(){var e,t=this._itemPickerStatus(),r=this._behavior.viewType,i=this._itemsSelection.maximumSelectedCount,o=this._itemsSelection.selectedCount();1===t.state||(e=t.error?{text:c.pluralSelect(o,2===r?d.strings.shareSingleFolderErrorText:d.strings.shareSingleFileErrorText,2===r?d.strings.shareMultipleFolderErrorText:d.strings.shareMultipleFileErrorText),state:s.default.failed}:i&&i<=o?{text:c.format(2===r?d.strings.selectionMaxFoldersErrorFormat:d.strings.selectionMaxFilesErrorFormat,i),state:s.default.failed}:this._computeConsentCommandStatus());return e};e.prototype._computeConsentCommandStatus=function(){var e,t=this._application();if(t){var r=this._behavior,i=r.viewType,o=r.linkType,n=r.selectionMode,a=r.accessLevel;e={text:c.format(2===i&&1===a?d.strings.saveSingleConsentFormat:2!==o&&0===a?0===n?d.strings.shareSingleConsentFormat:d.strings.shareMultipleConsentFormat:0===n?d.strings.openSingleConsentFormat:d.strings.openMultipleConsentFormat,t.name)}}else this._error()&&(e={text:d.strings.unknownApplicationErrorText,state:s.default.failed});return e};e.dependencies=r.__assign({},i.default.dependencies,{behavior:n.behavior,agent:n.agent,itemsSelection:a.itemsSelection,itemPickerStatus:n.status});return e}(i.default);t.ItemPickerStatusHelper=u;t.resourceKey=o.createResolvedResourceKey(e("module").id,u);t.default=u});define("AZ",["require","exports","ap","rt","p3","zZ","zY"],function(e,t,r,i,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this,r=t.resources.consume(n.actionMap);t.commands.push(new(t.managed(o.default))({text:a.strings.secureExperienceActionText,action:new(t.managed(r.ItemPickerSecureExperienceAction)),isPermanent:!0}),new(t.managed(o.default))({text:a.strings.cancelActionText,action:new(t.managed(r.ItemPickerCancelAction)),isPermanent:!0}));return t}return e}(i.default);t.default=s});define("AM",["require","exports","AY","AX","AW","AN"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){this.ItemPickerCompleteAction=r.default;this.ItemPickerCancelAction=i.default;this.ItemPickerSwitchAccountAction=o.default;this.ItemPickerSecureExperienceAction=n.default};t.default=a});define("AY",["require","exports","ap","g4","aI","zZ","kp","Ar"],function(e,t,r,i,o,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(l){r.__extends(e,l);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=l.call(this,e,t)||this;r.name="ItemPicker.Complete";var i=r._itemPickerBehavior=r.resources.consume(u.behavior);r._itemPickerAgent=r.resources.consume(u.agent);r._itemPickerStatus=r.resources.consume(u.status);r._canSelectItem=new(r.child(m.typeResourceKey))({behavior:i}).getCanSelectItem();var o=i.viewType,n=void 0===o?0:o,a=i.selectionMode,s=void 0===a?0:a,c=t.ItemSelectionHelper,d=void 0===c?p.default:c;r._itemSelectionHelper=new(r.managed(d))({overrideItem:e.item,canFallback:1!==n,allowMultiSelect:1===s});return r}e.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.selection()[0],t=this.unwrapObservable(e),r=this._itemPickerStatus().state;return!!this._itemPickerAgent&&!!t&&this._canSelectItem(e)&&(0===r||2===r)};e.prototype.onExecute=function(e){var t=this;this._itemPickerStatus({state:1});return this._itemSelectionHelper.resolveSelection().then(function(e){return t._itemPickerAgent.complete(e)}).then(function(){t._itemPickerStatus({state:3});return{resultType:o.ResultTypeEnum.Success}},function(e){t._itemPickerStatus({state:2,error:e});return{resultType:o.ResultTypeEnum.ExpectedFailure}})};return e}(i.default);t.default=n});define("Ar",["require","exports","ap","bN","eO","eA","gQ","V","bA"],function(e,t,r,i,d,n,l,u,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(o){r.__extends(e,o);function e(e,t){var r=o.call(this,e,t)||this,i=e.behavior;r._behavior=i;r._itemParentHelper=t.itemParentHelper;return r}e.prototype.getCanSelectItem=function(){for(var r=this,e=this._behavior,t=e.viewType,i=e.typeFilter,o=[],n=function(t){if("string"==typeof t)"."===t[0]&&o.push(function(e){return u.equalsCaseInsensitive(e.extension,t)});else switch(t){case l.ItemTypeFilter.folder:break;case l.ItemTypeFilter.photo:o.push(function(e){return!!e.photo&&!e.video});break;case l.ItemTypeFilter.video:o.push(function(e){return!!e.video});break;case l.ItemTypeFilter.media:o.push(function(e){return!!e.audio||!!e.photo||!!e.video});break;case l.ItemTypeFilter.document:o.push(function(e){return!!e.appMap});break;case l.ItemTypeFilter.audio:o.push(function(e){return!!e.audio})}},a=0,s=(void 0===i?{filters:[]}:i).filters;a<s.length;a++){n(s[a])}var c=[];o.length&&c.push(function(t){return o.some(function(e){return e(t)})});switch(t){case 1:c.push(function(e){return e.type!==d.default.Folder});break;case 2:c.push(function(e){return e.type===d.default.Folder})}c.push(function(e){return!e.subsite});c.push(function(e){return!r.peekUnwrapObservable(r._itemParentHelper.getFacetedAncestorOrSelf(e,"mountPoint"))});return function(e){var t=r.peekUnwrapObservable(e);return!t||c.every(function(e){return e(t)})}};e.dependencies=r.__assign({},i.default.dependencies,{itemParentHelper:n.resourceKey});return e}(i.default);t.default=a;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,a)});define("AX",["require","exports","ap","g4","aI","aC","zZ"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="ItemPicker.Cancel";t._itemPickerAgent=t.resources.consume(a.agent);t._itemPickerStatus=t.resources.consume(a.status);return t}e.prototype.onIsAvailable=function(){return!!this._itemPickerAgent};e.prototype.onExecute=function(e){var t=this;this._itemPickerStatus({state:1});return this._itemPickerAgent.cancel().then(function(){t._itemPickerStatus({state:4});return{resultType:o.ResultTypeEnum.Success}},function(e){t._itemPickerStatus({state:2,error:e});return n.default.wrapError(e)})};return e}(r.default);t.default=s});define("AW",["require","exports","ap","g4","aI","aC","zZ"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.name="ItemPicker.SwitchAccount";t._behavior=t.resources.consume(a.behavior);t._agent=t.resources.consume(a.agent);return t}e.prototype.onExecute=function(e){return this._agent.switchAccount().then(function(){return n.default.wrap({resultType:o.ResultTypeEnum.Success})})};e.prototype.onIsAvailable=function(){var e=this._behavior.showSwitchAccount;return void 0!==e&&e};return e}(r.default);t.default=s});define("AN",["require","exports","ap","bN","kt","AO"],function(e,t,i,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t.state=t.createObservable({isAvailable:!0});return t}return e}(r.default);t.ItemPickerSecureExperienceHandler=a;var s=o.create({name:"ItemPickerSecureExperience",source:{component:n.default}});t.default=s});define("AO",["require","exports","b5","AQ","AP"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-item-picker-secure-experience-executor",template:e("AP"),viewModel:i.default,synchronous:!0});t.default=o});define("AQ",["require","exports","ap","AV","AR","zZ","aC"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.filePickerRemoteHostTagName=o.default.tagName;t._agent=t.resources.consume(n.agent);t._behavior=t.resources.consume(n.behavior);t._status=t.resources.consume(n.status);t.showFilePicker=t.createObservable(!0);t.filePickerRemoteHostParams={agent:{initialize:function(){return t._agent.initialize()},complete:function(e){return t._complete(e)},cancel:function(){return t._cancel()},switchAccount:function(){return t._switchAccount()},getApplication:function(){return t._agent.getApplication()}},behavior:t._behavior};return t}e.prototype._complete=function(e){var t=this;this._status({state:1});this.showFilePicker(!1);return this._agent.complete(e).then(function(){t._status({state:3});t.action.complete()},function(e){t._status({state:2,error:e});return a.default.wrapError(e)})};e.prototype._cancel=function(){var t=this;this._status({state:1});this.showFilePicker(!1);return this._agent.cancel().then(function(){t._status({state:4});t.action.cancel()},function(e){t._status({state:2,error:e});return a.default.wrapError(e)})};e.prototype._switchAccount=function(){var t=this;this._status({state:1});this.showFilePicker(!1);return this._agent.switchAccount().then(function(){t._status({state:3});t.action.complete()},function(e){t._status({state:2,error:e});return a.default.wrapError(e)})};return e}(r.default);t.default=s});define("AV",["require","exports","ap","bF","aC"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this,r=e.action;t.action=r;return t}e.prototype.endWith=function(e){var t=this;e.done(function(){return t.action.complete()},function(e){return t.action.fail(e)})};e.prototype.continueWith=function(e){var t=this;return e.then(null,function(e){t.action.fail(e);return o.default.wrapError(e)})};return e}(i.default);t.default=n});define("AR",["require","exports","b5","AT","AS"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-file-picker-remote-host",template:e("AS"),viewModel:i.default,synchronous:!0});t.default=o});define("AT",["require","exports","ap","bF","AU","z7","aC","Ah","aZ","dZ","eU","eU","bi","eO","a9","z6","z5","dJ","b7"],function(e,t,w,r,I,a,s,A,C,T,S,M,O,E,B,N,R,L,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var H=800,D=600,U=20,i=function(k){w.__extends(e,k);function e(e,t){void 0===e&&(e={});void 0===t&&(t={});var r=k.call(this,e,t)||this;r.addBindingHandlers({childWindow:I.default});r._itemPickerProvider=r.resources.consume(A.resourceKey);var i=r.resources.consume(T.url);r._messenger=r.createObservable();r._pickerId=C.default.generate();var o=e.itemKey,n=e.agent,a=t.window,s=void 0===a?window:a;r._agent=n;var c={};S.default(c,e.behavior||{});S.default(c,{id:r._pickerId,showBranding:!0,showActions:!0,returnUrl:M.remove(),origin:new O.default(s.location.href).authority,state:M.remove()});var d,l,u=i.getDefaultClickUrl({key:o||i.getRootItemKey(),type:E.default.Folder},{page:B.default.FilePicker,viewParams:{}}),p=i.qualifyUrl("#"+L.serializeQuery(w.__assign({},L.deserializeQuery(u.substring(1)),"7.2"===c.sdkVersion?R.saveItemPickerBehavior(c):N.saveItemPickerBehavior(c)))),m=s.screen,f=void 0===m?{availLeft:0,availTop:0,left:0,top:0,width:window.innerWidth,height:window.innerHeight}:m;d=void 0===(g=f.availLeft)?d=void 0===(v=f.left)?0:v:g,l=void 0===(_=f.availTop)?l=void 0===(h=f.top)?0:h:_;var v,g,h,_,y=Math.min(H,f.width-U),b=Math.min(D,f.height-U),P=(f.width-y)/2+d,x=(f.height-b)/2+l;r.childWindowOptions={url:p,position:new F.default(P,x,y,b),messenger:r._messenger,onMessage:function(e){return r._onMessage(e)},onCancel:function(){return r._agent.cancel().done()}};return r}e.prototype._onMessage=function(e){var t=this._messenger.peek();if(0===e.indexOf(a.MESSAGE_FROM_PICKER_PREFIX)){var r=JSON.parse(e.substring(a.MESSAGE_FROM_PICKER_PREFIX.length)),i=r.conversationId,o=r.pickerId;if(o!==this._pickerId)return;var n=void 0;switch(r.type){case"success":n=this._onSuccess(r);break;case"cancel":n=this._onCancel(r);break;case"switch":n=this._onSwitch(r);break;case"initialize":n=s.default.wrap({pickerId:o,conversationId:i,type:"activate"})}s.default.as(n).done(function(e){e&&t.postMessage(""+a.MESSAGE_TO_PICKER_PREFIX+JSON.stringify(e))})}};e.prototype._onSuccess=function(e){var t=this,r=e.items.map(function(e){return t._itemPickerProvider.getItemFromPickerItem(e)});return o(this._agent.complete(r),e)};e.prototype._onCancel=function(e){return o(this._agent.cancel(),e)};e.prototype._onSwitch=function(e){return o(this._agent.switchAccount(),e)};return e}(r.default);t.default=i;function o(e,t){return e.then(function(){return{pickerId:t.pickerId,conversationId:t.conversationId,type:"acknowledge"}},function(e){return{pickerId:t.pickerId,conversationId:t.conversationId,type:"error",error:{message:e.message}}})}});define("AU",["require","exports","ap","bH","bi"],function(e,t,r,i,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(m){r.__extends(e,m);function e(e,t){void 0===t&&(t={});var r=m.call(this,e,t)||this,i=r.valueAccessor(),o=i.url,n=i.position,a=i.messenger,s=i.onMessage,c=i.onCancel;r._onMessage=s;r._onCancel=c;var d=t.window,l=void 0===d?window:d;r._window=l;var u=new f.default(o);r._targetOrigin=u.authority;s&&r.events.on(r._window,"message",r._onMessageReceived);var p=["scrollbars=yes"];n&&p.push("left="+n.x,"top="+n.y,"width="+n.width,"height="+n.height);r._childWindow=r._window.open(o,"_blank",p.join(", "));r.async.setInterval(r._checkWindow,100);r.addDisposable({dispose:function(){r._childWindow&&!r._childWindow.closed&&r._childWindow.close()}});a&&a(r._createMessenger());return r}e.prototype._checkWindow=function(){this._childWindow&&!this._childWindow.closed||this._onCancel&&this._onCancel()};e.prototype._onMessageReceived=function(e){if(e.source===this._childWindow&&e.origin===this._targetOrigin){var t=""+(e.data||"");this._onMessage&&this._onMessage(t)}};e.prototype._createMessenger=function(){var t=this;return{postMessage:function(e){t._childWindow.postMessage(e,t._targetOrigin)}}};e.supportsVirtualElements=!0;return e}(i.default);t.default=o});define("z7",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MESSAGE_FROM_PICKER_PREFIX="[OneDrive-FromPicker]";t.MESSAGE_TO_PICKER_PREFIX="[OneDrive-ToPicker]";t.PICKER_PARAM_KEY="picker"});define("z6",["require","exports","ap","z9","z8","z7","eU","eU"],function(e,t,r,y,b,i,m,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="state",o="access_token";t.isApplicable=function(e){return!0};t.getItemPickerBehavior=function(e){return r.__assign({},a(s(e)),c(e))};function a(e){void 0===e&&(e={});var t=e.id,r=e.aid,i=e.a,o=e.v,n=e.s,a=e.l,s=e.f,c=e.o,d=e.sa,l=void 0===d||d,u=e.ss,p=void 0===u||u,m=e.tf,f=void 0!==m&&m,v=e.sn,g=void 0===v||v,h=!function(){try{return!!parent.document}catch(e){return!1}}()||g,_=y.getViewType(o);return{id:t,showActions:l,showBranding:h,showSwitchAccount:p,enableFocusTrap:f,aadClientId:r,accessLevel:y.getAccessLevel(i),viewType:_,selectionMode:y.getSelectionMode(n),linkType:y.getLinkType(a),origin:c,typeFilter:b.getItemTypeFilter({typeFilter:y.getTypeFilter(s),viewType:_}),sdkVersion:"7.1"}}t.getItemPickerBehaviorFromOptions=a;function s(e){var t,r=e[i.PICKER_PARAM_KEY]||"";try{t=JSON.parse(r)}catch(e){t={}}return t}t.getItemPickerOptions=s;function c(e){return{state:e[n],accessToken:e[o]}}t.getStateAndAccessToken=c;t.saveItemPickerBehavior=function(e){var t=l(e);return r.__assign({},u(e),d(t))};function d(e){return(t={})[i.PICKER_PARAM_KEY]=JSON.stringify(e),t;var t}t.saveItemPickerOptions=d;function l(e){var t=e.showActions,r=e.showBranding,i=e.showSwitchAccount,o=e.aadClientId,n=e.accessLevel,a=e.viewType,s=e.selectionMode,c=e.linkType,d=e.typeFilter,l=e.origin,u=e.id,p={};m.default(p,{sa:f.optional(t),sn:f.optional(r),ss:f.optional(i),aid:f.optional(o),id:f.optional(u),o:f.optional(l),a:f.optional(y.saveAccessLevel(n)),s:f.optional(y.saveSelectionMode(s)),v:f.optional(y.saveViewType(a)),f:f.optional(y.saveTypeFilter(d)),l:f.optional(y.saveLinkType(c))});return p}t.saveItemPickerBehaviorToOptions=l;function u(e){var t=e.msaClientId,r=e.state,i=e.accessToken,o={};r&&(o[n]=r);t&&(o.client_id=t);i&&(o.access_token=i);return o}t.saveStateAndAccessToken=u});define("z9",["require","exports","g0","gQ","z8","Aa"],function(e,m,f,c,v,g){"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.WINDOW_STATE_PICKER_KEY="picker";m.WINDOW_STATE_OPTIONS_KEY="options";m.isApplicable=function(e){return!!(new f.default).getState(m.WINDOW_STATE_PICKER_KEY)};m.getItemPickerBehavior=function(e){var t=new f.default,r=t.getState(m.WINDOW_STATE_PICKER_KEY)||{},i=t.getState(m.WINDOW_STATE_OPTIONS_KEY)||{},o=r.accessLevel,n=r.viewType,a=r.linkType,s=r.selectionMode,c=r.filter,d=i.clientId,l=i.advanced.redirectUri,u=!!d&&!!l,p=b(n);return{showActions:!0,showBranding:!0,accessLevel:h(o),viewType:p,linkType:y(a),selectionMode:_(s),typeFilter:v.getItemTypeFilter({typeFilter:P(c),viewType:p}),aadClientId:d,returnUrl:g.getSafeAbsoluteWebUrl(l),showSwitchAccount:u}};function h(e){void 0===e&&(e="");var t;switch(e){case"readwrite":t=1;break;default:case"read":t=0}return t}m.getAccessLevel=h;m.saveAccessLevel=function(e){void 0===e&&(e=0);var t;switch(e){case 1:t="readwrite";break;default:case 0:}return t};function _(e){void 0===e&&(e="");var t;switch(e){case"multiple":t=1;break;default:case"single":t=0}return t}m.getSelectionMode=_;m.saveSelectionMode=function(e){void 0===e&&(e=0);var t;switch(e){case 1:t="multiple";break;default:case 0:}return t};function y(e){void 0===e&&(e="");var t;switch(e){case"download":t=2;break;case"webView":t=0;break;case"share":t=3;break;case"all":t=4;break;default:case"web":t=1}return t}m.getLinkType=y;m.saveLinkType=function(e){void 0===e&&(e=1);var t;switch(e){case 2:t="download";break;case 0:t="webView";break;default:case 1:}return t};function b(e){void 0===e&&(e="");var t;switch(e){case"files":t=1;break;case"folders":t=2;break;default:t=0}return t}m.getViewType=b;m.saveViewType=function(e){void 0===e&&(e=0);var t;switch(e){case 1:t="files";break;case 2:t="folders";break;default:case 0:}return t};function P(e){void 0===e&&(e="");var t;if(e){for(var r=[],i=0,o="string"==typeof e?e.split(","):e;i<o.length;i++){var n=o[i];if("."===n.charAt(0)){var a=n.toLowerCase();r.indexOf(a)<0&&r.push(a)}else{var s=void 0;switch(n){case"folder":s=c.ItemTypeFilter.folder;break;case"photo":s=c.ItemTypeFilter.media}s&&r.push(s)}}r.length&&r.push(c.ItemTypeFilter.folder);t={filters:r}}return t}m.getTypeFilter=P;m.saveTypeFilter=function(e){void 0===e&&(e={filters:[]});for(var t,r=[],i=0,o=e.filters;i<o.length;i++){var n=o[i];if("string"==typeof n)r.push(n);else{var a=void 0;switch(n){case c.ItemTypeFilter.folder:a="folder";break;case c.ItemTypeFilter.photo:a="photo"}a&&r.push(a)}}1<r.length?t=r:r.length&&(t=r[0]);return t}});define("z8",["require","exports","gQ","ic"],function(e,t,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemTypeFilter=function(e){var t=e.viewType,r=void 0===t?0:t,i=e.typeFilter,o=(void 0===i?{filters:[]}:i).filters;2===r&&(o=o.concat([n.ItemTypeFilter.folder]));return{filters:a.removeDuplicates(o)}}});define("Aa",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["HTTP:","HTTPS:"];t.getSafeAbsoluteWebUrl=function(e){void 0===e&&(e="");var t=e.toUpperCase();return r.filter(function(e){return 0===t.indexOf(e)}).length?e:void 0};t.isGallatin=function(){return location.origin.indexOf(".cn")===location.origin.length-3}});define("z5",["require","exports","ap","z6","eU","eU"],function(e,t,i,o,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c={ONEDRIVE:"oneDrive",SITES:"sites",RECENT:"recent",SHARED:"shared",PHOTOS:"photos",BUSINESS:"business",CONSUMER:"consumer"};t.isApplicable=function(e){var t=o.getItemPickerOptions(e);return!!t&&"7.2"===t.sdk};t.getItemPickerBehavior=function(e){return i.__assign({},a(o.getItemPickerOptions(e)),o.getStateAndAccessToken(e))};t.saveItemPickerBehavior=function(e){var t=s(e);return i.__assign({},o.saveStateAndAccessToken(e),o.saveItemPickerOptions(t))};function a(e){var t=e.ln,r=void 0===t||t;return i.__assign({},o.getItemPickerBehaviorFromOptions(e),function(e){var t="string"==typeof e?e.split(","):e;if(t){for(var r={},i=0,o=t;i<o.length;i++){var n=o[i],a=(""+n).trim().toUpperCase(),s=c[a];s&&(r[s]=!0)}return{sourceTypes:r}}}(e.st)||{},{showNavigation:r,showBranding:!1,sdkVersion:"7.2"})}t.getItemPickerBehaviorFromOptions=a;function s(e){var t=i.__assign({},o.saveItemPickerBehaviorToOptions(e),{sdk:"7.2"});r.default(t,{ln:n.optional(e.showNavigation),st:n.optional(function(e){if(e){var t=[];for(var r in e)e[r]&&t.push(r);return 1===t.length?t[0]:t}}(e.sourceTypes)),sn:!1});return t}t.saveItemPickerBehaviorToOptions=s});define("AS",[],function(){return"\x3c!--ko childWindow: childWindowOptions--\x3e\x3c!--/ko--\x3e"});define("AP",[],function(){return"\x3c!--ko if: showFilePicker--\x3e\x3c!--ko component: {\r\n name: filePickerRemoteHostTagName,\r\n params: filePickerRemoteHostParams\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});define("Au",["require","exports","b5","Ax","ol","Aw","Av"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-item-picker-header",template:e("Aw"),viewModel:i.default,synchronous:!0});t.default=o});define("Ax",["require","exports","ap","bF","cI","lw","p3","c2","cL","zZ","dZ","zY"],function(n,e,t,r,a,s,c,d,l,u,p,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(o){t.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this;t.applicationText=m.strings.applicationName;t.addBindingHandlers({dismiss:a.default,imageLoader:s.default});t._identityDataSource=t.resources.consume(p.identity);var r=t.resources.consume(u.actionMap),i=t._identityDataSource.getIdentity();t.accountCommand=new(t.managed(c.default))({text:i.email?i.email:i.loginName,engagementName:"SwitchAccountMenu",requiredChildren:1,collapseSingleChildCommands:!1,isPermanent:!0});t.accountCommand.children.push(new(t.managed(c.default))({text:m.strings.switchAccountActionText,action:new(t.managed(r.ItemPickerSwitchAccountAction))}));t.accountMenuParams={items:t.accountCommand.children,isOpen:t.accountCommand.isOpen,alignment:t.createObservable(l.default.isRightToLeft?d.default.Left:d.default.Right),left:t.createObservable(l.default.isRightToLeft?"0":"100%"),hasExplicitAlignment:!0};t.applicationLogoUrl="undefined"==typeof __webpack_public_path__?n.toUrl("odsp-media/images/filepicker/onedrivelogolight.png"):n("@ms/odsp-media/dist/media/images/filePicker/oneDriveLogoLight.png");t.isLogoLoaded=t.createObservable(!1);return t}return e}(r.default);e.default=i});define("Aw",[],function(){return'<div class=od-ItemPickerHeader><div class=od-ItemPickerHeader-application data-bind="css: { \'od-ItemPickerHeader-application--hasLogo\': isLogoLoaded }"><span class=od-ItemPickerHeader-applicationLogo><img data-bind="imageLoader: { src: applicationLogoUrl, isLoaded: isLogoLoaded }"></span> <span class=od-ItemPickerHeader-applicationTitle data-bind="text: applicationText"></span></div><div class=od-ItemPickerHeader-account data-bind="dismiss: { isOpen: accountCommand.isOpen }"><span class=od-ItemPickerHeader-accountDropdown data-bind="css: { \'od-ItemPickerHeader-accountDropdown--isOpen\': accountCommand.isOpen, \'od-ItemPickerHeader-accountDropdown--isEnabled\': !accountCommand.isDisabled() }, click: accountCommand.onClick.bind(accountCommand)"><span class=od-ItemPickerHeader-accountDropdownLabel data-bind="text: accountCommand.label"></span>\x3c!--ko ifnot: accountCommand.isDisabled--\x3e<i class="ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e</span>\x3c!--ko if: accountCommand.isOpen--\x3e<div class=od-ItemPickerHeader-accountMenu data-bind="component: { name: \'ms-contextual-menu\', params: accountMenuParams }"></div>\x3c!--/ko--\x3e</div></div>'});define("Av",["c","az"],function(e,t){e.loadStyles([{rawString:".od-ItemPickerHeader{height:50px;background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ItemPickerHeader-application{position:absolute;line-height:50px;height:100%}[dir=ltr] .od-ItemPickerHeader-application{left:16px}[dir=rtl] .od-ItemPickerHeader-application{right:16px}.od-ItemPickerHeader-applicationTitle{font-size:21px;font-weight:300}.od-ItemPickerHeader-applicationLogo{display:none}.od-ItemPickerHeader-account{position:absolute;line-height:50px;height:100%}[dir=ltr] .od-ItemPickerHeader-account{right:16px}[dir=rtl] .od-ItemPickerHeader-account{left:16px}.od-ItemPickerHeader-accountDropdown{padding:0 4px;height:100%;display:inline-block;font-size:12px;font-weight:300}.od-ItemPickerHeader-accountDropdown .ms-Icon{font-size:14px;vertical-align:middle}[dir=ltr] .od-ItemPickerHeader-accountDropdown .ms-Icon{padding-left:4px}[dir=rtl] .od-ItemPickerHeader-accountDropdown .ms-Icon{padding-right:4px}.od-ItemPickerHeader-accountDropdown--isEnabled{cursor:pointer}.od-ItemPickerHeader-accountDropdown--isEnabled:hover{background-color:rgba(255,255,255,.28)}.od-ItemPickerHeader-application--hasLogo .od-ItemPickerHeader-applicationLogo{display:inline-block;padding-top:5px}.od-ItemPickerHeader-application--hasLogo .od-ItemPickerHeader-applicationTitle{display:inline-block;width:0;height:0;overflow:hidden}"}])});define("uW",["require","exports","b5","u5","u4","u3","uX"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-button-bar",template:e("u4"),viewModel:i.CommandBarViewModel,synchronous:!0});t.default=o});define("u4",[],function(){return'<span class=od-ButtonBar data-bind="keyboard: keyboardOptions, element: topTab"><span class=od-ButtonBar-main data-bind="foreach: mainCommands">\x3c!--ko component: {\r\n name: \'od-button-bar-command\',\r\n params: {\r\n command: $data,\r\n index: $index\r\n }\r\n }--\x3e\x3c!--/ko--\x3e</span> <span class=od-ButtonBar-side data-bind="foreach: sideCommands">\x3c!--ko component: {\r\n name: \'od-button-bar-command\',\r\n params: {\r\n command: $data,\r\n index: $index\r\n }\r\n }--\x3e\x3c!--/ko--\x3e</span></span>'});define("u3",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-ButtonBar{display:block;height:30px}[dir=ltr] .od-ButtonBar .od-Button{margin-right:10px}[dir=rtl] .od-ButtonBar .od-Button{margin-left:10px}[dir=ltr] .od-ButtonBar .od-Button:last-child{margin-right:0}[dir=rtl] .od-ButtonBar .od-Button:last-child{margin-left:0}.od-ButtonBar-main{display:block;height:30px;white-space:nowrap}html[dir=ltr] .od-ButtonBar-main{float:right}html[dir=rtl] .od-ButtonBar-main{float:left}.od-ButtonBarCommand{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;display:inline-block;box-sizing:border-box;border:1px solid transparent;padding:4px 20px 6px 20px;height:30px}html[dir=rtl] .od-ButtonBarCommand{padding:4px 20px 6px 20px}.od-ButtonBarCommand-icon{display:inline-block}.od-ButtonBarCommand-icon .ms-Icon{vertical-align:top}.od-ButtonBarCommand--failed{color:#a80000}'}])});define("uX",["require","exports","b5","u2","u1","u0","uZ","uY"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-button-bar-command",template:e("u0"),viewModel:i.default,synchronous:!0});r.registerTemplate(o.BUTTON,e("uZ"));r.registerTemplate(o.TEXT,e("uY"));t.default=n});define("u2",["require","exports","ap","bF","u1","qa","aq"],function(e,t,i,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._index=e.index;t.command=e.command;t.focused=a.observable(!1);t.selected=a.observable(!1);t.templateName=t.createPureComputed(t._computeTemplateName);t.isPrimary=t.createPureComputed(t._computeIsPrimary);t.state=t.createPureComputed(t._computeState);return t}e.prototype._computeTemplateName=function(){return!this.command.action||!this.unwrapObservable(this.command.isPermanent)&&this.command.isDisabled()?o.TEXT:o.BUTTON};e.prototype._computeIsPrimary=function(){return 0===this._index()};e.prototype._computeState=function(){return n.default[this.command.state()||n.default.initialized]};return e}(r.default);t.default=s});define("u1",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BUTTON="od-button-bar-command-button";t.TEXT="od-button-bar-command-text"});define("u0",[],function(){return"\x3c!--ko template: templateName--\x3e\x3c!--/ko--\x3e"});define("uZ",[],function(){return'<button class="od-Button od-ButtonBarCommand od-ButtonBarCommand--button" data-bind="attr: { title: command.tooltip }, css: { \'is-disabled\': command.isDisabled, \'is-focused\': command.focused, \'od-Button--primary\': isPrimary }, hasFocus: command.isActive, disable: command.isDisabled, click: command.onClick.bind(command)">\x3c!--ko if: command.icon--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon" data-bind="component: { name: \'od-icon-glyph\', params: { icon: command.icon, badge: command.iconBadge } }"></span>\x3c!--/ko--\x3e\x3c!--ko if: command.iconUrl--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="icon: true, style: { backgroundImage: \'url(\\\'\' + command.iconUrl() + \'\\\')\' }"></i></span>\x3c!--/ko--\x3e\x3c!--ko if: command.isLabelVisible--\x3e<span class="od-Button-label od-ButtonBarCommand-label" data-bind="text: command.label"></span>\x3c!--/ko--\x3e</button>'});define("uY",[],function(){return'<span class="od-ButtonBarCommand od-ButtonBarCommand--text" data-bind="class: \'od-ButtonBarCommand--\' + state()">\x3c!--ko if: command.icon--\x3e<span class=od-ButtonBarCommand-icon data-bind="component: { name: \'od-icon-glyph\', params: { icon: command.icon, badge: command.iconBadge } }"></span>\x3c!--/ko--\x3e\x3c!--ko if: command.iconUrl--\x3e<span class="od-Button-icon od-ButtonBarCommand-icon"><i class="ms-Icon ms-Icon--custom" data-bind="icon: true, style: { backgroundImage: \'url(\\\'\' + command.iconUrl() + \'\\\')\' }"></i></span>\x3c!--/ko--\x3e\x3c!--ko if: command.isLabelVisible--\x3e<span class=od-ButtonBarCommand-label data-bind="text: command.label"></span>\x3c!--/ko--\x3e</span>'});define("s0",["require","exports","ap","rt"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){r.__extends(e,o);function e(e){void 0===e&&(e={});var t=o.call(this,e)||this,r=e.commandSets,i=void 0===r?[]:r;t._commandSets=t.wrapObservable(i);t.createComputed(t._computeUpdateCommandSet);return t}e.prototype._computeUpdateCommandSet=function(){for(var e=[],t=[],r=[],i=0,o=this._commandSets();i<o.length;i++){for(var n=o[i],a=[],s=0,c=n.commands();s<c.length;s++){var d=c[s];d===n.overflowHostCommand?r.push.apply(r,d.children()):4==(4&d.location)?a.push(d):e.push(d)}t.unshift.apply(t,a)}var l,u,p=this.overflowHostCommand.children.peek();(l=this.overflowHostCommand.children).splice.apply(l,[0,p.length].concat(r));e.push(this.overflowHostCommand);e.push.apply(e,t);(u=this.commands).splice.apply(u,[0,this.commands.peek().length].concat(e))};return e}(i.default);t.default=o});define("AL",["require","exports","ap","rt","rs","zY","zZ","dI"],function(e,t,r,i,d,l,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(c){r.__extends(e,c);function e(e){void 0===e&&(e={});var t=c.call(this,e)||this,r=t.resources.consume(u.behavior),i=r.completeText,o=void 0===i?2===r.viewType&&1===r.accessLevel?l.strings.completeReadWriteFoldersActionText:l.strings.completeReadFilesActionText:i,n=r.cancelText,a=void 0===n?l.strings.cancelActionText:n,s=t.resources.consume(u.actionMap);t.commands.push(new(t.managed(d.CommandViewModel))({text:o,action:new(t.managed(s.ItemPickerCompleteAction)),icon:new p.default("CheckMark"),renderLabel:2}),new(t.managed(d.CommandViewModel))({text:a,action:new(t.managed(s.ItemPickerCancelAction)),icon:new p.default("Cancel"),location:12,renderLabel:0}));return t}return e}(i.default);t.default=o});define("AI",["require","exports","b5","AK","AJ","rb"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.registerComponent({tagName:"od-dialog-overlay-2",template:e("AJ"),viewModel:i.default,synchronous:!0});t.default=o});define("AK",["require","exports","ap","bF","cp","cI","cA","cl","cU","cV","cT","cR","bW","d5","qX","uW"],function(e,t,r,i,u,p,m,f,v,g,h,_,y,o,b,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(l){r.__extends(e,l);function e(e){void 0===e&&(e={});var t=l.call(this,e)||this;t.overlayTagName=u.default.tagName;t.buttonBarTagName=P.default.tagName;t.closeLabel=b.strings.closePanelLabel;t.addBindingHandlers({dismiss:p.default,element:y.default,host:m.default,interactionScope:f.default,focusTrap:_.default,recoverFocus:h.default,preserveFocus:g.default,scrollContainer:v.default});var r=e.size,i=void 0===r?"Small":r,o=e.title,n=void 0===o?"":o,a=e.onClose,s=e.showCloseButton,c=void 0===s||s,d=e.commandSet;t._size=i;t._onClose=a;t.contentElement=t.createObservable();t.title=t.wrapObservable(n);t.showCloseButton=t.createObservable(!!t._onClose&&c);t.showTitle=t.createPureComputed(t._computeShowTitle);t.widthClass=t.createPureComputed(t._computeWidthClass);t.showActions=t.createObservable(!!d);t.buttonBarParams={commandSet:d};return t}e.prototype.onClose=function(e,t){this._onClose&&this._onClose(t);return!1};e.prototype.onDismiss=function(e,t){this._onClose&&this._onClose(t);return!1};e.prototype._computeWidthClass=function(){return o.default.determineCssClass(this._size)};e.prototype._computeShowTitle=function(){return!!this.title()};return e}(i.default);t.default=n});define("AJ",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {\r\n beforeRemove: 500\r\n },\r\n alignToParent: false\r\n }\r\n}--\x3e<div class=od-Dialog data-bind="css: { \'od-Dialog--close\': showCloseButton }, focusTrap: {}"><div class="ms-ModalOverlay od-DialogOverlay"></div><div class="od-Dialog-main od-Dialog-main--dialog od-Dialog-main--visible" role=dialog tabindex=-1 data-bind="interactionScope: { isScope: true }, preserveFocus, recoverFocus: { isEnabled: $host.isOpen }, scrollContainer, dismiss: { close: $component.onDismiss.bind($component) }, class: \'od-Dialog-main--\' + $component.widthClass(), attr: { \'aria-label\': title }, element: $component.contentElement">\x3c!--ko if: showTitle--\x3e<div class="od-Dialog-header od-Dialog-header--s"><div class=od-Dialog-title data-bind="text: title"></div></div>\x3c!--/ko--\x3e<div class=od-Dialog-inner><div class=od-Dialog-content data-bind="host: {}"></div>\x3c!--ko if: showActions--\x3e<div class=od-Dialog-actions><div class=od-Dialog-actionsRight data-bind="component: { name: buttonBarTagName, params: buttonBarParams }"></div></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: showCloseButton--\x3e<button class="od-Dialog-button od-Dialog-button--close" data-bind="attr: { \'aria-label\': $component.closeLabel, title: $component.closeLabel }, click: $component.onClose.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e'});define("AG",["require","exports","gQ","dq","dl"],function(e,t,s,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSourceTypeFilter=function(e){void 0===e&&(e={filters:[]});var t=e.filters;if(t.length){for(var r={},i=0,o=t;i<o.length;i++){var n=o[i];if("string"==typeof n){var a=c.getIconNameFromExtension(n);if(d.OfficeIconFileTypeMap[a]){r.recent=!0;r.shared=!0}else switch(a){case"photo":case"video":r.photos=!0;r.shared=!0}}else switch(n){case s.ItemTypeFilter.media:case s.ItemTypeFilter.photo:case s.ItemTypeFilter.video:r.photos=!0;r.shared=!0;break;case s.ItemTypeFilter.audio:r.shared=!0;break;default:case s.ItemTypeFilter.folder:r.oneDrive=!0;r.sites=!0;r.shared=!0;r.business=!0;r.consumer=!0}}return r}};t.mergeSourceTypeFilters=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t){if(!t)return e;if(!e)return t;var r={};for(var i in t)e[i]&&t[i]&&(r[i]=!0);return r},void 0)}});define("AE",[],function(){return'<div class=od-ItemPicker data-bind="css: { \'od-ItemPicker--hasBranding\': showBranding, \'od-ItemPicker--hasActions\': showActions, \'od-ItemPicker--hasCommandBar\': showCommandBar, \'od-ItemPicker--hasLeftPane\': showLeftPane, \'od-ItemPicker--leftPaneIsOpen\': showLeftPane() && isLeftPaneOpen() }, focusTrap: { isEnabled: isFocusTrapEnabled }">\x3c!--ko if: showSecureExperienceDialog--\x3e\x3c!--ko component: {\r\n name: dialogOverlayTagName,\r\n params: {\r\n commandSet: secureExperienceCommandSet\r\n }\r\n }--\x3e<p data-bind="text: secureExperienceWarningText"></p>\x3c!--ko if: secureExperienceErrorText--\x3e<p data-bind="text: secureExperienceErrorText, class: \'od-ItemPicker-secureExperienceStatus--\' + secureExperienceErrorStyle()"></p>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showBranding--\x3e<div class=od-ItemPicker-branding data-bind="component: { name: itemPickerHeaderTagName, params: itemPickerHeaderParams }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showContent--\x3e\x3c!--ko if: showCommandBar--\x3e<div class=od-ItemPicker-topBar data-bind="component: { name: topBarTagName, params: {} }">\x3c!--ko if: showLeftPaneExpander--\x3e<div class="od-ItemPicker-leftNavExpander od-TopBar-item od-TopBar-leftNavExpander" data-bind="component: { name: leftNavExpanderTagName }"></div>\x3c!--/ko--\x3e<div class="od-ItemPicker-commandBar od-TopBar-item od-TopBar-commandBar" data-bind="control: commandBarSpecification"></div></div>\x3c!--/ko--\x3e\x3c!--ko if: showLeftPane()--\x3e<div class=od-ItemPicker-leftPane data-bind="control: leftPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--ko if: !showLeftPane() && isLeftPaneOpen()--\x3e\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n alignToParent: true,\r\n animation: {\r\n afterAdd: 1,\r\n beforeRemove: 500\r\n }\r\n }\r\n }--\x3e<div class="od-ItemPicker-leftPaneModal ms-ModalOverlay"></div>\x3c!--ko focusTrap: {}--\x3e<div class=od-ItemPicker-leftPaneOverlay tabindex=-1 data-bind="dismiss: { isOpen: isLeftPaneOpen }, recoverFocus: { isEnabled: $host.isOpen }, preserveFocus: {}, control: leftPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=od-ItemPicker-selector data-bind="host: hostBindingOptions"></div>\x3c!--ko if: showActions--\x3e<div class=od-ItemPicker-actions data-bind="component: { name: buttonBarTagName, params: buttonBarParams }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});define("AD",["c","az"],function(e,t){e.loadStyles([{rawString:".od-ItemPicker{position:absolute;top:0;left:0;bottom:0;right:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ItemPicker-branding{position:absolute;top:0;left:0;right:0;height:50px;z-index:3}.od-ItemPicker-topBar{position:absolute;top:0;left:0;right:0;height:40px}.md .od-ItemPicker-topBar,.sm .od-ItemPicker-topBar{height:44px}.od-ItemPicker-leftPane{position:absolute;top:0;bottom:0;width:208px;box-sizing:border-box}[dir=ltr] .od-ItemPicker-leftPane{left:0}[dir=rtl] .od-ItemPicker-leftPane{right:0}html[dir=ltr] .od-ItemPicker-leftPane{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .od-ItemPicker-leftPane{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.md .od-ItemPicker-commandBar,.sm .od-ItemPicker-commandBar{padding-left:4px;padding-right:4px}.lg .od-ItemPicker-commandBar,.xlg .od-ItemPicker-commandBar,.xxlg .od-ItemPicker-commandBar,.xxxlg .od-ItemPicker-commandBar,.xxxxlg .od-ItemPicker-commandBar{padding-left:16px;padding-right:16px}.od-ItemPicker-selector{position:absolute;top:0;left:0;right:0;bottom:0;z-index:1}.od-ItemPicker--hasBranding .od-ItemPicker-topBar{top:50px}.od-ItemPicker--hasBranding .od-ItemPicker-selector{top:50px}[dir=ltr] .od-ItemPicker--hasLeftPane .od-ItemPicker-actions,[dir=ltr] .od-ItemPicker--hasLeftPane .od-ItemPicker-selector,[dir=ltr] .od-ItemPicker--hasLeftPane .od-ItemPicker-topBar{left:208px}[dir=rtl] .od-ItemPicker--hasLeftPane .od-ItemPicker-actions,[dir=rtl] .od-ItemPicker--hasLeftPane .od-ItemPicker-selector,[dir=rtl] .od-ItemPicker--hasLeftPane .od-ItemPicker-topBar{right:208px}.od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:40px}.md .od-ItemPicker--hasCommandBar .od-ItemPicker-selector,.sm .od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:44px}.od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane{padding-top:40px}.md .od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane,.sm .od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane{padding-top:44px}.od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:90px}.md .od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-selector,.sm .od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-selector{top:94px}.od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane{padding-top:90px}.md .od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane,.sm .od-ItemPicker--hasBranding.od-ItemPicker--hasCommandBar .od-ItemPicker-leftPane{padding-top:94px}.od-ItemPicker--hasActions .od-ItemPicker-selector{bottom:50px}.od-ItemPicker-actions{position:absolute;left:0;right:0;bottom:0;height:50px;box-sizing:border-box;padding:10px 20px;z-index:1}html[dir=ltr] .od-ItemPicker-actions{text-align:right}html[dir=rtl] .od-ItemPicker-actions{text-align:left}.od-ItemPicker-actions .od-Button--primary:enabled,.od-ItemPicker-actions .od-Button:active{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ItemPicker-actions .od-ButtonBarCommand--text{font-size:12px}.od-ItemPicker .DetailsRow,.od-ItemPicker .ItemTile{opacity:.3}.od-ItemPicker .DetailsRow.can-select,.od-ItemPicker .DetailsRow.od-DetailsRow--isInvokable,.od-ItemPicker .DetailsRow.od-ItemTile--isInvokable,.od-ItemPicker .ItemTile.can-select,.od-ItemPicker .ItemTile.od-DetailsRow--isInvokable,.od-ItemPicker .ItemTile.od-ItemTile--isInvokable{opacity:1}.od-ItemPicker-secureExperienceStatus{font-style:italic}.od-ItemPicker-secureExperienceStatus--failed{color:#a80000}.od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{position:absolute;top:40px;bottom:0;width:272px;box-shadow:30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;opacity:0}[dir=ltr] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{left:0}[dir=rtl] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{right:0}html[dir=ltr] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay:focus{outline:1px solid transparent}.md .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay,.sm .od-OverlayHost-overlay .od-ItemPicker-leftPaneOverlay{top:44px}.od-OverlayHost-overlay .od-ItemPicker-leftPaneModal{opacity:0}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{opacity:1}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeIn,ms-slideRightIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeIn,ms-slideLeftIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneModal{opacity:1;animation-name:ms-fadeIn;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ItemPicker-leftPaneModal{animation:none}}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeOut,ms-slideLeftOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation-name:ms-fadeOut,ms-slideRightOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneModal{animation-name:ms-fadeOut;animation-duration:.1s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-ItemPicker-leftPaneModal{animation:none}}"}])});define("Ay",["require","exports","AB","b5","AA","Az"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.registerComponent({tagName:"od-notification-host",template:e("AA"),viewModel:r.default});t.default=o});define("AB",["require","exports","ap","bF","AC","cI","d7","d"],function(e,t,i,r,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.addBindingHandlers({dismiss:n.default});t.closeText=o.strings.Close;t.notification=t.resources.consume(a.notification).currentNotification;t.severityClass=t.createComputed(t._computeSeverityClass);t.iconClass=t.createComputed(t._computeIconClass);return t}e.prototype.dismiss=function(){var e=this.notification.peek();if(e&&e.canImplicitDismiss){e.dismiss();return!1}return!0};e.prototype.close=function(){var e=this.notification.peek();if(e&&e.showCloseButton){e.complete();return!1}return!0};e.prototype.onButtonClick=function(e,t){if(e&&e.action){e.action.execute(t);e.dismiss()}};e.prototype._computeSeverityClass=function(){var e=this.notification();switch(e?e.severity:0){default:case 0:return"ms-MessageBar--info";case 4:return"ms-MessageBar--remove";case 3:return"ms-MessageBar--error";case 2:return"ms-MessageBar--severeWarning";case 1:return"ms-MessageBar--warning";case 5:return"ms-MessageBar--success"}};e.prototype._computeIconClass=function(){var e=this.notification();switch(e?e.severity:0){default:case 0:case 1:return s.getIconClassName("Info");case 4:return s.getIconClassName("Blocked2");case 3:return s.getIconClassName("ErrorBadge");case 2:return s.getIconClassName("Warning");case 5:return s.getIconClassName("Success")}};return e}(r.default);t.default=c});define("AA",[],function(){return'<div class=NotificationHost>\x3c!--ko with: notification--\x3e<div class=od-Notification role=alert data-bind="css: { \'od-Notification--canClose\': showCloseButton }, dismiss: { isAutomatic: !!timeout, timeout: timeout, isOpen: isOpen, close: $component.dismiss.bind($component) }"><div class=od-Notification-content><div class=ms-MessageBar data-bind="class: $component.severityClass"><div class=ms-MessageBar-content><div class=ms-MessageBar-icon><i class=ms-Icon data-bind="class: $component.iconClass"></i></div><div class=ms-MessageBar-text><span data-bind="text: text"></span>\x3c!--ko if: action--\x3e<a class="od-Notification-link ms-Link" href=javascript:; data-bind="text: actionText, click: $component.onButtonClick.bind($component)"></a>\x3c!--/ko--\x3e</div></div></div></div>\x3c!--ko if: showCloseButton--\x3e<button class=od-Notification-close data-bind="attr: { \'aria-label\': $parent.closeText, title: $parent.closeText }, click: $component.close.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});define("Az",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-MessageBar{padding:8px;display:table;background-color:#f4f4f4}.ms-MessageBar-icon,.ms-MessageBar-text{display:table-cell;vertical-align:top}.ms-MessageBar-icon{padding-right:8px;font-size:16px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.ms-MessageBar-text{font-size:12px;font-weight:400}.ms-MessageBar.ms-MessageBar--warning{background-color:#fff4ce}.ms-MessageBar.ms-MessageBar--severeWarning{background-color:#fed9cc}.ms-MessageBar.ms-MessageBar--severeWarning .ms-MessageBar-icon{color:#d83b01}.ms-MessageBar.ms-MessageBar--error{background-color:#fde7e9}.ms-MessageBar.ms-MessageBar--error .ms-MessageBar-icon{color:#a80000}.ms-MessageBar.ms-MessageBar--remove{background-color:#fde7e9}.ms-MessageBar.ms-MessageBar--remove .ms-MessageBar-icon{color:#a80000}.ms-MessageBar.ms-MessageBar--remove .ms-Icon{font-size:8px;margin-left:3px}.ms-MessageBar.ms-MessageBar--success{background-color:#dff6dd}.ms-MessageBar.ms-MessageBar--success .ms-MessageBar-icon{color:#107c10}.ms-MessageBar.ms-MessageBar--success .ms-Icon{font-size:12px;top:3px}.ms-MessageBar.ms-MessageBar--success .ms-Icon:before{margin-left:1px}.ms-MessageBar.ms-MessageBar--success .ms-Icon:after{font-size:8px;margin-left:3px;top:1px}.NotificationHost{position:relative}.od-Notification-close{font-size:12px;width:40px;cursor:pointer;border:none;background-color:transparent;position:absolute;top:0;bottom:0;padding-top:4px}[dir=ltr] .od-Notification-close{right:0}[dir=rtl] .od-Notification-close{left:0}.od-Notification{width:100%}.od-Notification .ms-MessageBar{width:100%;padding:0}.od-Notification .ms-MessageBar-content{padding:8px}.od-Notification .ms-MessageBar-text{vertical-align:middle;cursor:default}.od-Notification .ms-MessageBar-icon .ms-Icon--Info{display:block}[dir=ltr] .od-Notification--canClose .ms-MessageBar .ms-MessageBar-content{padding-right:40px}[dir=rtl] .od-Notification--canClose .ms-MessageBar .ms-MessageBar-content{padding-left:40px}.od-Notification .ms-MessageBar--info{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-Notification-link{white-space:nowrap}[dir=ltr] .od-Notification-link{padding-left:4px}[dir=rtl] .od-Notification-link{padding-right:4px}"}])});define("As",["require","exports","ap","bN","bX","Ah","dZ","aC","bA"],function(e,t,r,i,o,n,a,c,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(s){r.__extends(e,s);function e(e,t){void 0===e&&(e={});var r=s.call(this,e,t)||this;r._applicationDataSource=t.applicationDataSource;var i=t.itemPickerProvider,o=t.viewParams.peek(),n=i.getHandler({viewParams:o}).handlerTypeKey,a=new(r.child(n))({viewParams:o,getApplication:function(){return r._getApplication()}});r._behavior=a.getBehavior();r._agent={initialize:function(){return a.initialize()},getApplication:function(){return r._getApplication()},complete:function(e){return a.complete(e)},cancel:function(){return a.cancel()},switchAccount:function(){return a.switchAccount()}};return r}e.prototype.getAgent=function(){return this._agent};e.prototype.getBehavior=function(){return this._behavior};e.prototype._getApplication=function(){var e,t=this._behavior.msaClientId;e=this._applicationDataSource&&t?this._applicationDataSource.getApplicationDetails({clientId:t}):c.default.wrap();this._getApplication=function(){return e};return e};e.dependencies=r.__assign({},i.default.dependencies,{applicationDataSource:a.application.optional,viewParams:o.viewParams,itemPickerProvider:n.resourceKey});return e}(i.default);t.default=d;t.typeResourceKey=s.createResolvedTypeResourceKey(e("module").id,d)});define("z4",["require","exports","ap","bN","eV","eO","dZ","iR","Ap","Al","Aj","Ad","Ac","Ab","z5","iJ","dH","fO","eA","eU","bA"],function(e,t,r,o,a,s,n,c,d,l,u,p,m,f,v,g,h,_,y,b,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=function(i){r.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._urlDataSource=t.urlDataSource;r._itemsStore=t.itemsStore;r._itemUrlHelper=t.itemUrlHelper;r._itemParentHelper=t.itemParentHelper;return r}e.prototype.getHandler=function(e){var t=e.viewParams;return{handlerTypeKey:m.isApplicable(t)?d.typeResourceKey:f.isApplicable(t)?l.typeResourceKey:v.isApplicable(t)?p.typeResourceKey:u.typeResourceKey}};e.prototype.getPivots=function(e){var t=this,r=e.behavior.typeFilter,i=void 0===r?{filters:[]}:r,o=new a.default(this._urlDataSource.getKey(this._urlDataSource.saveItemTypeFilter(i)));o.name=c.strings.Files;o.displayName=c.strings.Files;o.type=s.default.Folder;var n=this._itemsStore.getItem(o.key);n&&!n.peek().isPlaceholder||this._itemsStore.setItem(o);return{pivots:[{item:o,isActive:function(e){return t._urlDataSource.getQueryType(e)===h.default.Files}}]}};e.prototype.getItemFromPickerItem=function(e){var t,r=this._itemUrlHelper.getUrlParts({path:e.sharePoint.url,listUrl:e.sharePoint.listUrl});return{key:this._urlDataSource.getKey(((t={}).id=r.serverRelativeItemUrl,t.listurl=r.normalizedListUrl,t)),itemId:e.id,isRootFolder:!!e.root,properties:{uniqueId:e.sharePoint.uniqueId,listId:e.sharePoint.listId}}};e.prototype.getPickerItemFromItem=function(e,t){var r=this._itemUrlHelper.getItemUrlParts(e.key),i=0<t.hostAuthenticationLevel,o=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=o?o.list.id:void 0;return{id:e.itemId,root:b.optional(r.fullItemUrl===r.fullListUrl?{}:void 0),sharePoint:{uniqueId:e.properties.uniqueId,url:b.optional(i?r.fullItemUrl:void 0),listUrl:b.optional(i?r.fullListUrl:void 0),listId:n}}};e.dependencies=r.__assign({},o.default.dependencies,{urlDataSource:n.url,itemsStore:g.resourceKey,itemUrlHelper:_.resourceKey,itemParentHelper:y.resourceKey});return e}(o.default);t.default=P;t.resourceKey=i.createResolvedResourceKey(e("module").id,P)});define("Ap",["require","exports","ap","bN","Ac","Aq","dJ","fV","An","Am","iE","eq","Ae","bA"],function(e,t,r,i,s,c,o,n,d,l,u,p,m,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(a){r.__extends(e,a);function e(e,t){var r=a.call(this,e,t)||this;r._pageContext=t.pageContext;var i=e.viewParams,o=r._behavior=s.getItemPickerBehavior(i),n=r.scope;r._queryStringHelper=new(n.attached(t.queryStringHelperType))({behavior:o});r._accountChooserQueryStringHelper=new(n.attached(t.accountChooserQueryStringHelperType))({accountChooserUrl:c.getAccountChooserUrl(o)});r._secureExperienceHelper=new(n.attached(t.secureExperienceHelperType))({behavior:o});return r}e.prototype.getBehavior=function(){return this._behavior};e.prototype.initialize=function(){var e=this,t={tenant:p.getServerUrl(this._pageContext)};return n.request("https://onedrive.live.com/picker/setsuggestedtenant?"+o.serializeQuery(t,null,!0)).then(function(){},function(){}).then(function(){return e._secureExperienceHelper.validateExperience()})};e.prototype.complete=function(e){return this._queryStringHelper.complete(e)};e.prototype.cancel=function(){return this._queryStringHelper.cancel()};e.prototype.switchAccount=function(){return this._accountChooserQueryStringHelper.switchAccount()};e.dependencies=r.__assign({},i.default.dependencies,{queryStringHelperType:d.typeResourceKey,accountChooserQueryStringHelperType:l.typeResourceKey,secureExperienceHelperType:m.typeResourceKey,pageContext:u.pageContext});return e}(i.default);t.default=f;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,f)});define("Ac",["require","exports","A2","z8","Aa"],function(e,t,p,m,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return!!e.ru&&!!e.aad_client_id};t.getItemPickerBehavior=function(e){var t=e.link_type,r=e.aad_client_id,i=e.msa_client_id,o=e.selection_mode,n=e.view_type,a=e.access,s=e.ru,c=function(e){void 0===e&&(e="");var t;switch(e){case"file":t=1;break;case"folder":t=2;break;default:case"all":t=0}return t}(n),d=g(s),l=v(r),u=f(i);return{showActions:!0,showBranding:!0,showSwitchAccount:!(!d||!l&&!u),aadClientId:v(r),msaClientId:f(i),viewType:c,linkType:function(e){void 0===e&&(e="");var t;switch(e){case"downloadlink":t=2;break;case"webviewlink":t=0;break;default:case"weblink":t=1}return t}(t),selectionMode:function(e){void 0===e&&(e="");var t;switch(e){case"multi":case"multiple":t=1;break;default:case"single":t=0}return t}(o),accessLevel:function(e){void 0===e&&(e="");var t;switch(e){case"read":t=0;break;default:case"readwrite":t=1}return t}(a),returnUrl:g(s),maximumSelectedCount:p.SELECTION_MAX_ITEMS,typeFilter:m.getItemTypeFilter({viewType:c})}};function f(e){return e}function v(e){return e}function g(e){return r.getSafeAbsoluteWebUrl(e)}});define("Aq",["require","exports","dJ","A2"],function(e,o,n,a){"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.ACCOUNT_CHOOSER_BASE_URL="https://onedrive.live.com/picker/accountchooser";var t,r,i,s,c=((t={})[1]="file",t[2]="folder",t),d=((r={})[0]="webViewLink",r[1]="webLink",r[2]="downloadLink",r),l=((i={})[1]="multi",i[0]="single",i),u=((s={})[1]="readwrite",s[0]="read",s);o.getAccountChooserUrl=function(e){var t,r;if(e.msaClientId||e.aadClientId){var i=((r={})[a.MSA_CLIENT_ID_PARAM]=e.msaClientId,r[a.AAD_CLIENT_ID_PARAM]=e.aadClientId,r[a.RETURN_URL_PARAM]=e.returnUrl,r[a.VIEW_TYPE_PARAM]=c[e.viewType],r[a.SELECTION_MODE_PARAM]=l[e.selectionMode],r[a.LINK_TYPE_PARAM]=d[e.linkType],r[a.ACCESS_LEVEL_PARAM]=u[e.accessLevel],r[a.PROMPT_PARAM]=a.PROMPT_SELECT_ACCUNT_VALUE,r);t=o.ACCOUNT_CHOOSER_BASE_URL+"?"+n.serializeQuery(i,null,!0)}return t}});define("An",["require","exports","ap","bN","aC","dJ","dc","bA"],function(e,t,r,i,n,s,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(a){r.__extends(e,a);function e(e,t){var r=a.call(this,e,t)||this,i=e.behavior;r._navigation=t.navigation;r._behavior=i;var o=r._behavior.state,n=void 0===o?"aad_picker":o;r._state=n;return r}e.prototype.complete=function(e){var t=this._behavior.returnUrl;if(!t)return n.default.wrapError(new Error("No return URL specified to handle completion."));var r,i=e.map(function(e){return e.itemId}).filter(function(e){return!!e}).join(","),o=t+"#"+s.serializeQuery(((r={})["item-id"]=i,r.state=this._state,r),null,!0);this._navigation.navigateTo(o);return n.default.wrap()};e.prototype.cancel=function(){var e=this._behavior.returnUrl;if(!e)return n.default.wrapError(new Error("No return URL specified to handle cancellation."));var t,r=e+"#"+s.serializeQuery(((t={}).error="access_denied",t.state=this._state,t),null,!0);this._navigation.navigateTo(r);return n.default.wrap()};e.dependencies=r.__assign({},i.default.dependencies,{navigation:o.navigation});return e}(i.default);t.default=c;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,c)});define("Am",["require","exports","ap","bN","dc","aC","bA"],function(e,t,r,i,n,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(o){r.__extends(e,o);function e(e,t){var r=o.call(this,e,t)||this,i=e.accountChooserUrl;r._accountChooserUrl=i;r._navigation=t.navigation;return r}e.prototype.switchAccount=function(){var e=this._accountChooserUrl;this._navigation.navigateTo({url:e});return a.default.wrap()};e.dependencies=r.__assign({},i.default.dependencies,{navigation:n.navigation});return e}(i.default);t.default=s;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,s)});define("Ae",["require","exports","ap","bN","aC","bA"],function(e,t,r,i,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(n){r.__extends(e,n);function e(e,t){var r=n.call(this,e,t)||this,i=t.currentWindow,o=void 0===i?window:i;r._currentWindow=o;return r}e.prototype.validateExperience=function(e){void 0===e&&(e={authenticationLevel:0});var t=this._currentWindow;if(t.self===t.top)return o.default.wrap();var r=t.parent;if(r)try{if(r.location.href)return o.default.wrap()}catch(e){}return 0<e.authenticationLevel?o.default.wrap():this._createInsecureError()};e.prototype._createInsecureError=function(){return o.default.wrapError(new Error("The picker is not being loaded in a secure context."))};e.dependencies=r.__assign({},i.default.dependencies);return e}(i.default);t.default=a;t.typeResourceKey=n.createResolvedTypeResourceKey(e("module").id,a)});define("Al",["require","exports","ap","bN","Ab","Ao","An","Am","Ae","bA"],function(e,t,r,i,s,c,o,n,d,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(a){r.__extends(e,a);function e(e,t){var r=a.call(this,e,t)||this,i=e.viewParams,o=r._behavior=s.getItemPickerBehavior(i),n=r.scope;r._queryStringHelper=new(n.attached(t.queryStringHelperType))({behavior:o});r._accountChooserQueryStringHelper=new(n.attached(t.accountChooserQueryStringHelperType))({accountChooserUrl:c.getAccountChooserUrl(o)});r._secureExperienceHelper=new(n.attached(t.secureExperienceHelperType))({behavior:o});return r}e.prototype.getBehavior=function(){return this._behavior};e.prototype.initialize=function(){return this._secureExperienceHelper.validateExperience()};e.prototype.complete=function(e){return this._queryStringHelper.complete(e)};e.prototype.cancel=function(){return this._queryStringHelper.cancel()};e.prototype.switchAccount=function(){return this._accountChooserQueryStringHelper.switchAccount()};e.dependencies=r.__assign({},i.default.dependencies,{queryStringHelperType:o.typeResourceKey,accountChooserQueryStringHelperType:n.typeResourceKey,secureExperienceHelperType:d.typeResourceKey});return e}(i.default);t.default=l;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,l)});define("Ab",["require","exports","z9"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return r.isApplicable(e)};t.getItemPickerBehavior=function(e){return r.getItemPickerBehavior(e)}});define("Ao",["require","exports","dJ","aZ"],function(e,n,a,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.LOGIN_BASE_URL="https://login.microsoftonline.com/common/oauth2/v2.0/authorize";n.getAccountChooserUrl=function(e){var t=e.aadClientId,r=e.returnUrl,i=e.state;if(!t||!r)return"";var o={client_id:t,redirect_uri:r,response_type:{uriValue:"id_token+token"},scope:"profile openid https://graph.microsoft.com/Files.ReadWrite https://graph.microsoft.com/User.Read",response_mode:"fragment",state:void 0===i?"aad_login":i,nonce:s.default.generate()};return n.LOGIN_BASE_URL+"?"+a.serializeQuery(o,null,!0)}});define("Aj",["require","exports","ap","bN","Ak","Af","ej","Ae","fO","bA"],function(e,t,r,i,s,o,n,c,d,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(a){r.__extends(e,a);function e(e,t){var r=a.call(this,e,t)||this,i=e.viewParams,o=r._behavior=s.getItemPickerBehavior(i),n=r.scope;r._postMessageHelper=new(n.attached(t.postMessageHelperType))({behavior:o});r._secureExperienceHelper=new(n.attached(t.secureExperienceHelperType))({behavior:o});r._itemUrlHelper=t.itemUrlHelper;return r}e.prototype.getBehavior=function(){return this._behavior};e.prototype.initialize=function(){var t=this;return this._postMessageHelper.initialize().then(function(e){return t._secureExperienceHelper.validateExperience(e)})};e.prototype.complete=function(e){if(!this._behavior.origin){var t=e[0],r=this._itemUrlHelper.getItemUrlParts(t.key);this._postToSameDomainParent(r.serverRelativeItemUrl)}return this._postMessageHelper.complete(e)};e.prototype.cancel=function(){this._behavior.origin||this._postToSameDomainParent("cancel");return this._postMessageHelper.cancel()};e.prototype.switchAccount=function(){return this._postMessageHelper.switchAccount()};e.prototype._postToSameDomainParent=function(e){if(window.parent&&window.parent.postMessage)try{var t=new n.default(window.parent.location.href).getLeftPart(n.UriPartial.authority);window.parent.postMessage(e,t)}catch(e){}};e.dependencies={postMessageHelperType:o.typeResourceKey,secureExperienceHelperType:c.typeResourceKey,itemUrlHelper:d.resourceKey};return e}(i.default);t.default=l;t.typeResourceKey=a.createResolvedTypeResourceKey(e("module").id,l)});define("Ak",["require","exports","z6"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isApplicable=function(e){return r.isApplicable(e)};t.getItemPickerBehavior=function(e){return r.getItemPickerBehavior(e)}});define("Af",["require","exports","ap","bN","aC","bE","bi","Ai","z7","Ag","bA"],function(e,t,r,i,n,g,a,h,d,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(v){r.__extends(o,v);function o(e,t){var r=v.call(this,e,t)||this,i=e.behavior;r._behavior=i;var o=t.currentWindow,n=void 0===o?window:o,a=r._postMessageTargetSignal=new g.default,s=r._hostIdentitySignal=new g.default,c=n.parent!==n?n.parent:void 0,d=n.opener,l=i.origin,u=c||d;if(u){var p=r._getOrigin(u,l),m=p.origin,f=p.hostAuthenticationLevel;a.complete({window:u,origin:m});f&&s.complete({authenticationLevel:f})}h.isApprovedDomain(i.origin)||s.complete({authenticationLevel:0});r._pickerItemHelper=new t.pickerItemHelperType({behavior:i});r._responseSignals={};r.events.on(n,"message",r._onMessage);return r}o.prototype.initialize=function(){var e=this._behavior.id,t=this._hostIdentitySignal;this.async.setTimeout(function(){t.complete({authenticationLevel:0})},300);this._sendRequest({conversationId:++o._nextConversationId,pickerId:e,type:"initialize"}).done(function(e){t.complete({authenticationLevel:0})});return t.getPromise()};o.prototype.complete=function(t){var r=this,i=this._behavior.id;return this._hostIdentitySignal.getPromise().then(function(e){return r._pickerItemHelper.getPickerItemsFromItems(t,{hostAuthenticationLevel:e.authenticationLevel}).then(function(e){return r._sendRequest({conversationId:++o._nextConversationId,pickerId:i,type:"success",items:e})}).then(function(e){if("error"===e.type)return n.default.wrapError(new Error(e.error.message))})})};o.prototype.cancel=function(){var e=this._behavior.id;return this._sendRequest({conversationId:++o._nextConversationId,pickerId:e,type:"cancel"}).then(function(e){if("error"===e.type)return n.default.wrapError(new Error(e.error.message))})};o.prototype.switchAccount=function(){var e=this._behavior.id;return this._sendRequest({conversationId:++o._nextConversationId,pickerId:e,type:"switch"}).then(function(e){if("error"===e.type)return n.default.wrapError(new Error(e.error.message))})};o.prototype._getOrigin=function(e,t){var r,i;try{r=new a.default(e.location.href).authority;i=2}catch(e){t===this._behavior.origin&&(r=t)}return{origin:r,hostAuthenticationLevel:i}};o.prototype._sendRequest=function(a){var s=this;return this._postMessageTargetSignal.getPromise().then(function(e){var t=e.window,r=e.origin;h.validateOrigin(r);var i=a.conversationId,o=""+d.MESSAGE_FROM_PICKER_PREFIX+JSON.stringify(a),n=new g.default;s._responseSignals[i]=n;t.postMessage(o,r);return n.getPromise().then(function(e){delete s._responseSignals[i];return e})})};o.prototype._onMessage=function(r){var i=this,e=""+(r.data||"");if(0===e.indexOf(d.MESSAGE_TO_PICKER_PREFIX))try{var o=JSON.parse(e.substring(d.MESSAGE_TO_PICKER_PREFIX.length));if(o.pickerId===this._behavior.id){var t=this._postMessageTargetSignal;if("activate"===o.type){var n=this._getOrigin(r.source,r.origin),a=n.hostAuthenticationLevel,s=void 0===a?h.isApprovedDomain(r.origin)?2:0:a,c=n.origin;this._hostIdentitySignal.complete({authenticationLevel:s});t.complete({window:r.source,origin:c})}t.getPromise().done(function(e){if(r.origin===e.origin){var t=i._responseSignals[o.conversationId];t&&t.complete(o)}})}}catch(e){}};o.dependencies=r.__assign({},i.default.dependencies,{pickerItemHelperType:s.typeResourceKey});o._nextConversationId=0;return o}(i.default);t.default=c;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,c)});define("Ai",["require","exports","bi","ej"],function(e,t,a,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=["DOCS.COM","ONEDRIVE.COM","LIVE.COM","LIVE-INT.COM","OFFICE.COM","LIVE-TST.COM","OFFICEAPPS.LIVE.COM","GOV.ONLINE.OFFICE365.US","DOD.ONLINE.OFFICE365.US","OFFICEAPPS-DF.LIVE.COM","ONLINE.OFFICE.DE","PARTNER.OFFICEWEBAPPS.CN"];t.isApprovedDomain=function(e){for(var t=new a.default(e).domain.toUpperCase(),r=0,i=s;r<i.length;r++){var o=i[r],n="."+o;if(o===t||-1<t.indexOf(n,t.length-n.length))return!0}return!1};t.validateOrigin=function(e){if(!e)throw new Error("No specified origin");var t=new o.default(e),r=t.getScheme();if(!r||!/http(s)?/.test(r))throw new Error("Invalid origin scheme");var i=t.getHost();if(!i||-1<i.indexOf("*"))throw new Error("Invalid origin host")}});define("Ag",["require","exports","ap","bN","gf","Ah","dZ","aC","bA"],function(r,e,n,t,i,o,a,s,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var d;!function(e){var t=function(){function e(e,t){this._vroomDataRequestor=t.vroomDataRequestor}e.prototype.getItem=function(e){var t=e.itemUrl,r=e.accessToken;return this._vroomDataRequestor.send({path:t+"?select=*,sharePointIds",accessToken:r,apiName:"GetItem"})};e.prototype.createLink=function(e){var t=e.itemUrl,r=e.accessToken;return this._vroomDataRequestor.send({path:t+"/oneDrive.createLink",accessToken:r,apiName:"CreateLink",postData:JSON.stringify({type:"view"}),requestType:"POST"})};e.dependencies={vroomDataRequestor:i.resourceKey};return e}();e.PickerItemService=t;e.pickerItemServiceResourceKey=new c.ResourceKey({name:r("module").id+".internals.pickerItemService",factory:new c.ResolvedResourceFactory(t)})}(d=e.Internals||(e.Internals={}));var l=function(i){n.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r._pickerItemService=t.pickerItemService;r._itemPickerProvider=t.itemPickerProvider;r._behavior=e.behavior;return r}e.prototype.getPickerItemsFromItems=function(e,t){var i=this,o=t.hostAuthenticationLevel;return s.default.all(e.map(function(t){var e=s.default.wrap(i._itemPickerProvider.getPickerItemFromItem(t,{hostAuthenticationLevel:o}));if(2<=o){var r=i._behavior.linkType;4!==r&&2!==r||(e=e.then(function(e){return i._attachDriveItemToPickerItem(t,e)}));4!==r&&3!==r||(e=e.then(function(e){return i._attachShareUrlToPickerItem(t,e)}))}return e}))};e.prototype._attachDriveItemToPickerItem=function(e,t){var r=t.urls,i=void 0===r?{}:r,o=n.__rest(t,["urls"]);return this._getOneDrivePickerItem(e).then(function(e){return n.__assign({},o,{urls:n.__assign({},i,{download:e["@content.downloadUrl"]}),driveItem:e})})};e.prototype._attachShareUrlToPickerItem=function(e,t){var r=t.urls,i=void 0===r?{}:r,o=n.__rest(t,["urls"]);return this._getShareLink(e).then(function(e){return n.__assign({},o,{urls:n.__assign({},i,{share:e})})})};e.prototype._getOneDrivePickerItem=function(t){var r=this;return this.resources.consumeAsync(a.graph).then(function(e){return r._pickerItemService.getItem({itemUrl:e.getItemUrl(t,{useDirectEndpoint:!0,isPath:!1}),accessToken:e.getAccessToken(t)})})};e.prototype._getShareLink=function(t){var r=this;return this.resources.consumeAsync(a.graph).then(function(e){return r._pickerItemService.createLink({itemUrl:e.getItemUrl(t,{useDirectEndpoint:!0,isPath:!1}),accessToken:e.getAccessToken(t)}).then(function(e){return e.link.webUrl})})};e.dependencies=n.__assign({},t.default.dependencies,{pickerItemService:d.pickerItemServiceResourceKey,itemPickerProvider:o.resourceKey});return e}(t.default);e.default=l;e.typeResourceKey=c.createResolvedTypeResourceKey(r("module").id,l)});define("Ad",["require","exports","ap","bN","z5","Af","Ae","bA"],function(e,t,r,i,a,o,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(n){r.__extends(e,n);function e(e,t){var r=n.call(this,e,t)||this,i=r._behavior=a.getItemPickerBehavior(e.viewParams),o=r.scope;r._postMessageHelper=new(o.attached(t.postMessageHelperType))({behavior:i});r._secureExperienceHelper=new(o.attached(t.secureExperienceHelperType))({behavior:i});return r}e.prototype.getBehavior=function(){return this._behavior};e.prototype.initialize=function(){var t=this;return this._postMessageHelper.initialize().then(function(e){return t._secureExperienceHelper.validateExperience(e)})};e.prototype.complete=function(e){return this._postMessageHelper.complete(e)};e.prototype.cancel=function(){return this._postMessageHelper.cancel()};e.prototype.switchAccount=function(){return this._postMessageHelper.switchAccount()};e.dependencies={postMessageHelperType:o.typeResourceKey,secureExperienceHelperType:s.typeResourceKey};return e}(i.default);t.default=c;t.typeResourceKey=n.createResolvedTypeResourceKey(e("module").id,c)});define("z2",["require","exports","kH","z3","jc","i7","bA"],function(e,t,r,o,n,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._behavior=e.behavior;this._itemCommandProvider=t.itemCommandProvider}e.prototype.getCommand=function(e,t){var r,i=this._behavior.viewType;switch(t){case o.defaultClick:case n.createFolder:case n.open:r=!0;break;case a.upload:r=2!==i;break;default:r=!1}if(r)return this._itemCommandProvider.getCommand(e,t)};e.dependencies={itemCommandProvider:r.resourceKey};return e}();t.default=s;t.typeResourceKey=i.createResolvedTypeResourceKey(e("module").id,s)});define("z3",["require","exports","i8"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultClick=new r.default("defaultClick")});define("z1",["require","exports","cF"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filePickerEngagementPart=new r.EngagementPart("FilePicker",3,{getEngagementData:function(e){var t=e.behavior;return{scenario:"FilePicker",extraData:{clientId:t.aadClientId||t.msaClientId,isFilePicker:1}}}})});define("zW",["require","exports","ap","bN","rE","z0","zX","bA"],function(e,t,r,i,o,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getHandlerTypeKeys=function(){return[n.typeResourceKey,o.typeResourceKey,a.typeResourceKey]};return t}(i.default);t.LeftNavDataSource=c;t.resourceKey=s.createResolvedResourceKey(e("module").id,c)});define("z0",["require","exports","aC","bA","c7"],function(r,e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.typeResourceKey=new i.ResourceKey({name:r("module").id,loader:new i.AliasResourceLoader(function(){return o.loadModuleExport({path:"A6",getModule:function(){return new t.default(function(e,t){r(["A6"],e,t)})},getExport:function(e){return e.typeResourceKey.local}})})})});define("zX",["require","exports","ap","bN","zZ","zY","bA","dI"],function(e,t,r,i,o,a,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(n){r.__extends(e,n);function e(e,t){void 0===e&&(e={});var r=n.call(this,e,t)||this,i=r.observables;r._switchAccountAction=new(r.child(t.itemPickerActionMap.ItemPickerSwitchAccountAction));var o=i.createArray();o.push({url:"#",action:r._switchAccountAction,isActive:i.create(!1),isFocused:i.create(!1),text:a.strings.switchAccountActionText,engagementName:"SwitchAccount",altText:a.strings.switchAccountActionText,icon:new s.default("Contact")});(r.linkGroups=i.createArray()).push({text:"",url:void 0,isActive:i.create(!1),isFocused:i.create(!1),automationId:"switchAccount",hideGroupHeader:!0,isExpanded:i.create(!0),links:r.scope.attach(o.filter(function(e){return e.action.isAvailable()}))});return r}e.dependencies=r.__assign({},i.default.dependencies,{itemPickerActionMap:o.actionMap});return e}(i.default);t.default=c;t.typeResourceKey=n.createResolvedTypeResourceKey(e("module").id,c)});define("zU",[],function(){return'<div class=od-FilePicker><div class=od-FilePicker-picker data-bind="component: { name: itemPickerTagName, params: itemPickerParams }"><div class=od-FilePicker-list data-bind="component: { name: standaloneListTagName, params: standaloneListParams }"></div></div>\x3c!--ko component: { name: dragAndDropTagName }--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: panelHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: dialogHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: overlayHostTagName }--\x3e\x3c!--/ko--\x3e</div>'});define("zT",["c","az"],function(e,t){e.loadStyles([{rawString:".od-FilePicker{position:absolute;top:0;bottom:0;left:0;right:0}.od-FilePicker-list{position:absolute;top:0;bottom:0;left:0;right:0}"}])});define("zR",["require","exports","aq","zS","aC","ba","on","yq","pE","yQ"],function(r,e,t,i,o,n,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=window._spPageContextInfo,c=!s||"21"===s.webTemplate,d=n.isFeatureEnabled(n.UseReactGridList)&&!c?a.createComponent("ms-grid-list","azv",function(){return new o.default(function(e,t){r(["azv"],e,t)})}):{tagName:"ms-grid-list",template:r("yq"),viewModel:{createViewModel:function(e,t){return new(e.resources.injected(i.default))(e,t)}},synchronous:!0};t.components.isRegistered(d.tagName)||t.components.register(d.tagName,d);e.default=d});define("zS",["require","exports","ap","y8","yF"],function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e,t){var r=i.call(this,e,t)||this;r.initialize(new(r.managed(o.default))(e));return r}return e}(i.default);t.default=n});define("zQ",["require","exports","qN","b3","qK","qJ"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-empty-folder",name:e("module").id,template:e("qK"),viewModelType:r.default});t.default=t.resourceKey});define("A6",["require","exports","ap","bN","iE","bX","iR","lT","eA","yk","ep","V","dZ","yi","bA"],function(o,e,t,r,n,a,d,l,s,c,u,p,m,f,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var v=function(i){t.__extends(e,i);function e(e,t){void 0===e&&(e={});var r=i.call(this,e,t)||this;r._pageContext=t.pageContext;r._actionMap=t.actionMap;r._currentItem=t.currentItem;r._itemParentHelper=t.itemParentHelper;r._rootItems=t.rootItems;r._suiteNavProvider=t.suiteNavProvider;r._rootSourceTypeFilter=t.rootSourceTypeFilter;r.linkGroups=r._getLinkGroups();return r}e.prototype._getLinkGroups=function(){var e=this.observables,t=e.createArray(),r=this._getOneDriveNameAndIcon(),i=r.oneDriveName,o=r.icon;t.push({text:i,icon:o,subText:this._pageContext.userLoginName,url:null,isExpanded:e.create(!0),isActive:e.create(!1),isFocused:e.create(!1),automationId:"LeftNav-OneDriveGrouping",links:this._getOneDriveLinks()});return t};e.prototype._getOneDriveLinks=function(){var o=this,n=this.observables,e=this._rootSourceTypeFilter,t=!e||e.oneDrive||Number(this._pageContext.webTemplate)===u.default.mySite,a=t,s=t&&(!e||e.recent),c=n.createArray();n.backgroundCompute(function(){var e=o._rootItems();if(e){var t=e.files,r=e.recent,i=[];a&&i.push({text:d.strings.Files,altText:l.strings.filesAlt,action:new(o.child(o._actionMap.DefaultClickAction))({item:t}),isActive:o._getIsActive(t),isFocused:n.create(!1),engagementName:"Files"});s&&i.push({text:d.strings.Recent,altText:l.strings.recentAlt,action:new(o.child(o._actionMap.DefaultClickAction))({item:r}),isActive:o._getIsActive(r),isFocused:n.create(!1),engagementName:"Recent"});c.splice.apply(c,[0,1/0].concat(i))}});return c};e.prototype._getIsActive=function(e){var r=this,i=this.observables;return i.pureCompute(function(){var t=e().key;return!!i.unwrap(r._itemParentHelper.getAncestorOrSelf(r._currentItem(),function(e){return e.key===t}))})};e.prototype._getOneDriveNameAndIcon=function(){var e=this.observables,t=e.create(d.strings.oneDriveGroupTitle),r=e.create({iconUrl:"undefined"==typeof __webpack_public_path__?o.toUrl("@ms/odsp-media/lib/images/apps/onedrive_48x1_5.svg"):o("@ms/odsp-media/dist/media/images/apps/OneDrive_48x1_5.svg"),mode:"person"});this.trackPromise(this._suiteNavProvider.loadData()).done(function(e){t(p.format(d.strings.oneDriveGroupHeaderFormat,d.strings.oneDriveGroupTitle,e.CompanyDisplayName))});return{oneDriveName:t,icon:r}};e.dependencies=t.__assign({},r.default.dependencies,{pageContext:n.pageContext,actionMap:a.actionMap,currentItem:a.currentItem,itemParentHelper:s.resourceKey,rootItems:m.rootItems,suiteNavProvider:c.resourceKey,rootSourceTypeFilter:f.resourceKey.optional});return e}(r.default);e.default=v;e.typeResourceKey=i.createResolvedTypeResourceKey(o("module").id,v)});