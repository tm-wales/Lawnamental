define("ab6",["require","exports","afL","afI","afG","afE","afD","afn","aeS","aeP","aeO","aeM","aek","ad7","ad2","adT","adM","adg","ada","acu","act","acq","acn","ack","ach","ace","acb","ab9","ab7"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});define("afL",["require","exports","ap","bN","iE","eq","afM"],function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._currentItem=e.currentItem;t._createFolderHelper=new(t.managed(a.default));t._pageContext=t.resources.consume(n.pageContext);return t}e.prototype.execute=function(){var e=o.getServerUrl(this._pageContext),t=400-(e+=this._currentItem.id+"/").length;return this._createFolderHelper.showDialog(t,!1)};return e}(i.default);t.default=s});define("afM",["require","exports","ap","aq","dI","bN","aI","V","dm","ci","bX","afN","ab8","ae0","aL"],function(e,t,r,u,p,i,m,h,f,n,o,g,b,_,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._dialogProvider=t.resources.consume(n.resourceKey);t._currentItem=t.resources.consume(o.currentItem);return t}e.prototype.showDialog=function(e,t){var i=this,r=this.observables.create(""),n=this.observables.create(""),o=this.observables.create(!1),a=this.observables.create(!0),s=this.observables.create(!0),l=this.observables.create([]),c=this.observables.create(""),d=this.observables.create(!0);return this._dialogProvider.requestDialog({title:f.strings.CreateFolder,component:{name:g.default.tagName,params:{name:r,automationId:"createFolderDialog",status:n,hasError:o,isEnabled:a,maxNameLength:e,hasFocus:s,supportInlineSharing:t,selectedPeople:l,sharingNote:c,statusVisible:d}},actions:[{name:f.strings.CreateCommit,execute:function(){d(!1);var e={tasks:null};v.extend(e,u);e.tasks.runEarly();n(f.strings.CreateFolderCollapsed);d(!0);a(!1);o(!1);return i.resources.consumeAsync(b.typeResourceKey).then(function(e){var t=new e({parent:i._currentItem.peek(),folderName:r(),sharingNote:c(),selectedPeople:l().filter(function(e){return e.isResolved})});return i.trackPromise(t.start())}).then(function(){o(!1);a(!0);d(!1);var e=h.format(_.strings.CreateFolderSuccess,r());n(e);d(!0);return 2},function(e){o(!0);d(!1);i.async.setTimeout(function(){o(!0);a(!0);s(!0);n(e.message);d(!0)},200);return 1})},isAvailable:this.observables.pureCompute(function(){return!!r()&&a()}),isDefault:!0,icon:new p.default("Save"),automationId:"createFolderDialogCommit"}]}).wait().then(function(){return{resultType:m.ResultTypeEnum.Success}})};return e}(i.default);t.default=a});define("afN",["require","exports","afQ","b5","afP","afO"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-folder-builder",template:e("afP"),viewModel:i.default});t.default=n});define("afQ",["require","exports","ap","bF","ae0","XU","aq"],function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.namePlaceholder=n.strings.FolderNamePlaceholder;t.nameLabel=n.strings.FolderNameLabel;t.addEditors=n.strings.AddEditors;t.editorsLabel=n.strings.EditorsLabel;t.editorsDescription=n.strings.EditorsDescription;t.editorsNotePlaceholder=n.strings.EditorsNotePlaceholder;t.peoplePickerTagName=o.default.tagName;t.name=e.name;t.status=e.status||a.observable("");t.hasError=e.hasError||a.observable(!1);t.isEnabled=e.isEnabled||a.observable(!0);t.hasFocus=e.hasFocus||a.observable(!0);t.maxNameLength=e.maxNameLength;t.statusVisible=e.statusVisible||a.observable(!0);t.supportInlineSharing=e.supportInlineSharing;t.sharingNote=e.sharingNote;t.selectedPeople=e.selectedPeople;t.peoplePickerParams={selectedPeople:t.selectedPeople,peoplePickerQueryParams:void 0};t.areSharingFieldsVisible=a.observable(!1);return t}e.prototype.onAddEditorsClicked=function(){this.areSharingFieldsVisible(!0)};return e}(i.default);t.default=s});define("afP",[],function(){return'<div class=od-FolderBuilder><div class=od-TextField><input class="od-FolderBuilder-nameInput od-TextField-field" type=text data-bind="value: name, textInput: name, hasFocus: hasFocus, attr: { placeholder: namePlaceholder, maxlength: maxNameLength, \'aria-invalid\': hasError, \'aria-label\': nameLabel }, automation: automationId, css: { \'od-FolderBuilder-nameInput--error\': hasError }, enable: isEnabled">\x3c!--ko if: supportInlineSharing--\x3e<button class="od-FolderBuilder-addEditorsButton od-Button" data-bind="visible: !areSharingFieldsVisible(), click: onAddEditorsClicked, text: addEditors"></button><div class=od-FolderBuilder-sharingFields data-bind="visible: areSharingFieldsVisible"><label class="od-FolderBuilder-editorsLabel ms-Label" data-bind="text: editorsLabel"></label><div class=od-FolderBuilder-peoplePicker data-bind="component: { name: peoplePickerTagName, params: peoplePickerParams }"></div><div><textarea class=od-FolderBuilder-noteInput data-bind="value: sharingNote, attr: { placeholder: editorsNotePlaceholder, maxlength: 4000 }">\r\n                </textarea></div></div><div class="od-FolderBuilder-sharingDescription ms-font-s" data-bind="text: editorsDescription"></div>\x3c!--/ko--\x3e</div><div class=od-FolderBuilder-status role=alert aria-live=polite aria-relevant=text data-bind="visible: statusVisible, text: status, css: { \'od-FolderBuilder-status--error\': hasError }"></div></div>'});define("afO",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-FolderBuilder-status{margin-top:12px;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-FolderBuilder-status--error{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";word-wrap:break-word}.od-FolderBuilder-input--error{border-color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"!important}.od-FolderBuilder-sharingFields{margin-top:20px}.od-FolderBuilder-addEditorsButton.od-Button{margin-top:20px}.od-FolderBuilder-sharingDescription{margin-top:5px}.od-FolderBuilder-peoplePicker .PeoplePicker-resolvedItem-persona .od-Persona-emailText{display:none}.od-FolderBuilder-peoplePicker .AutoFill{min-width:100%;max-width:100%}.od-FolderBuilder-noteInput{height:80px;width:100%;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";overflow-y:auto;padding:5px;margin:10px 0 5px 0}"}])});define("ab8",["require","exports","ap","Sj","Sh","cg","bA"],function(e,t,i,r,o,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(n){i.__extends(e,n);function e(e,t){var i=n.call(this,e,t)||this;i._context=e;i._fileSystemProvider=t.fileSystemProvider;i._payloads={createFolder:{parent:e.parent,createdFolder:i.createObservable(null)}};return i}e.prototype.getOperationDetails=function(e){var t=n.prototype.getOperationDetails.call(this,e),i=e.input,r=this._context.parent;t.type=a.default.createFolder;t.name=i;t.iconName=r.iconName;t.payloads=this._payloads;t.visibility=2;e.output&&this._payloads.createFolder.createdFolder(e.output);return t};e.prototype.onStart=function(e){return this._fileSystemProvider.createFolder(this._context,e)};e.dependencies=i.__assign({},r.default.dependencies,{fileSystemProvider:o.resourceKey});return e}(r.default);t.default=s;t.typeResourceKey=n.createResolvedTypeResourceKey(e("module").id,s)});define("afI",["require","exports","ap","dH","Si","afJ","dm","V","dZ","MZ","iE"],function(e,t,r,n,a,i,s,l,o,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._urlDataSource=t.resources.consume(o.url);t._pageContext=t.resources.consume(d.pageContext);return t}e.prototype.getDeleteExecutionInfo=function(e){var t,i,r=this.currentItem.queryType,n=a.default.Recycle;if(this._urlDataSource.isRecycleBin(r)){i=this._getRecycleBinDialogTitle(r);t=this._getRecycleBinDialogText(e);n=this._getRecycleBinDeletionType(e)}else{var o=e&&1===e.length&&e[0].name;i=o?l.format(s.strings.deleteConfirmTitleWithFileName,o):s.strings.deleteConfirmTitle;t=s.strings.deleteConfirmText}return{text:t,title:i,type:n,allowUndo:!1,emptyRecycleBin:!1}};e.prototype.executeDelete=function(e){return e&&1===e.length&&c.default.isCheckedOutByOther(e[0],this._pageContext.userId)?c.default.showCheckedOutByOtherDialog(this.dialogProvider):i.prototype.executeDelete.call(this,e)};e.prototype._getRecycleBinDialogTitle=function(e){return e===n.default.RecycleBin?s.strings.deleteConfirmTitle:s.strings.recycleBinDeleteConfirmTitle};e.prototype._getRecycleBinDialogText=function(e){return 1===e[0].recycleBinProperties.itemState?1===e.length?l.format(s.strings.recycleBinSingleItemMoveToSecondStageConfirmText,e[0].name):s.strings.recycleBinMultiItemsMoveToSecondStageConfirmText:1===e.length?l.format(s.strings.recycleBinDeleteConfirmTextSingleSelection,e[0].name):s.strings.recycleBinDeleteConfirmTextMultiSelection};e.prototype._getRecycleBinDeletionType=function(e){return 1===e[0].recycleBinProperties.itemState?a.default.MoveToSecondStage:a.default.PermanantDelete};return e}(i.default);t.default=u});define("afJ",["require","exports","ap","aC","dI","bN","eO","Si","aI","dm","ci","dN","kL","ba","afK"],function(e,t,r,n,o,i,a,s,l,c,d,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.selectionHelper=e.selectionHelper;t.currentItem=e.currentItem;t.dialogProvider=t.resources.consume(d.resourceKey);return t}e.prototype.execute=function(e){var t=this;if(!this.currentItem)return n.default.wrap(this._getFailedQosData());m.isOneDrive&&this.trackPromise(this.resources.consumeAsync(p.resourceKey).then(function(e){e.fireEditEvent();e.fireDeleteEvent()}));return this.selectionHelper.resolveSelection().then(function(e){return e?t.executeDelete(e):t._getFailedQosData()})};e.prototype.getDeleteExecutionInfo=function(e){return null};e.prototype.executeDelete=function(e){var t=this,i=this.getDeleteExecutionInfo(e);return(i.title?this._getConfirmationDialog(i):n.default.wrap()).then(function(){return t._executeDelete(e,i)})};e.prototype._getFailedQosData=function(){return{resultType:l.ResultTypeEnum.Failure,extraMetrics:{count:0}}};e.prototype._executeDelete=function(i,r){var n=this;this.selectionHelper.clearSelection();return this.resources.consumeAsync(h.typeResourceKey).then(function(e){var t=new e({items:i,deletionType:r.type,allowUndo:r.allowUndo,emptyRecycleBin:r.emptyRecycleBin,parentKey:n.currentItem.key});n.trackPromise(t.start());return t.wait()}).then(function(){var e={deletionType:s.default[r.type]},t={count:i.length};if(1===i.length){e.fileType=a.default[i[0].type];e.extension=i[0].extension||""}return{resultType:l.ResultTypeEnum.Success,extraData:e,extraMetrics:t}})};e.prototype._getConfirmationDialog=function(e){return this.dialogProvider.requestDialog({title:e.title,component:{name:u.default.tagName,params:{text:e.text}},actions:[{name:c.strings.DeleteItem,execute:function(){return n.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new o.default("Delete"),isDefault:!1},{name:c.strings.cancelActionText,execute:function(){return n.default.wrap(3)},isAvailable:this.observables.create(!0),icon:new o.default("Cancel"),isDefault:!0}],focusOnPrimaryAction:!0}).wait()};return e}(i.default);t.default=f});define("afK",["require","exports","ap","eS","Sk","Sj","cg","Sh","Si","bA"],function(e,t,i,n,r,o,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,{},t)||this;i._fileSystemProvider=t.fileSystemProvider;i._context=e;i.registerActions({undo:i._onUndo,deleteLocked:i._onDeleteLocked});return i}e.prototype.getOperationDetails=function(e){var t=r.prototype.getOperationDetails.call(this,e),i=e.input.item;t.name=i.name;t.iconName=i.iconName;t.type=2===e.input.type?a.default.restoreItems:a.default.deleteItems;t.payloads.deleteItems={item:i,parent:i.parent};t.payloads.restoreItems={item:i};this._context.allowUndo&&this._canUndoItem(i)&&0===e.input.type&&1===e.status&&t.actions.push(this._onUndo);2===e.status&&e.error&&9001===e.error.code&&t.actions.push(this._onDeleteLocked);return t};e.prototype.onStart=function(e){var t=this._context.deletionType===l.default.PermanantDelete?1:0,i=this._context.overrideLock,r=this._context.items.map(function(e){return new n.default(e.key,{item:e,type:t,isOverride:i})});e.update(r);return this._fileSystemProvider.deleteItems({items:this._context.items,deletionType:this._context.deletionType,overrideLock:i,parentKey:this._context.parentKey,emptyRecycleBin:this._context.emptyRecycleBin},u(e,t,i))};e.prototype._canUndoItem=function(e){return!e.isAlbum};e.prototype._onDeleteLocked=function(e,t){e=e.map(function(e){return e.restart().changeInput(function(e){return{item:e.item,type:e.type,isOverride:!0}})});t.update(e);var i=e[0].input,r=i.type,n=i.isOverride;return this._fileSystemProvider.deleteItems({items:e.map(function(e){return e.input.item}),deletionType:this._context.deletionType,overrideLock:!0,parentKey:this._context.parentKey},u(t,r,n))};e.prototype._onUndo=function(e,t){e=e.map(function(e){return e.restart().changeInput(function(e){return{item:e.item,type:2,isOverride:!1}})});t.update(e);var i=e[0].input,r=i.type,n=i.isOverride;return this._fileSystemProvider.restoreItems({items:e.map(function(e){return e.input.item}),parentKey:this._context.parentKey,retainAcls:!0},u(t,r,n))};e.dependencies=i.__assign({},o.default.dependencies,{fileSystemProvider:s.resourceKey});return e}(o.default);t.default=d;function u(e,t,i){return r.default.map(e,function(e){return e.changeInput(function(e){return{item:e,type:t,isOverride:i}})})}t.typeResourceKey=c.createResolvedTypeResourceKey(e("module").id,d)});define("afG",["require","exports","ap","aC","MZ","gA","dZ","afH","aL","eO","Kd"],function(e,t,i,d,u,p,r,n,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(c){i.__extends(e,c);function e(e){var t=c.call(this,e)||this;t._microServiceDataSource=t.resources.consume(r.microService);return t}e.prototype.execute=function(e,t){var r=this,i=this.selectionHelper.selection.peek();t.data.extraData||(t.data.extraData={});if(1<i.length||u.default.isFolder(i[0].peek(),!1)){var n="",o=0,a=0,s=i.map(function(e){if(e){var t=e.peek();n+=t.urls[p.default.itemUrl];t.type===h.default.OneNote&&o++;var i=u.default.isFolder(t,!1);i&&a++;return{name:t.name,size:t.size,docId:r._microServiceDataSource.getitemUrlWithToken(t.urls[p.default.itemUrl]),isFolder:i}}});if(!s)return d.default.wrapError(new Error("No item metadata for download."));s=s.filter(Boolean);m.extend(t.data.extraData,{oneNotesCount:o,filesCount:i.length-a,foldersCount:a});var l=i[0].peek().urls[p.default.downloadAsZip];return c.prototype.executeVroomDownload.call(this,s,n,l,"spo","POST",t)}return c.prototype.execute.call(this,e,t)};return e}(n.default);t.default=o});define("afH",["require","exports","ap","aC","bN","eO","aI","ci","dZ","by","kv","gj","dc","kL","ba","c7","bA","aZ","iH","i0","YC"],function(i,b,e,o,t,a,_,r,s,n,c,d,u,p,v,l,m,y,S,h,f){"use strict";Object.defineProperty(b,"__esModule",{value:!0});var x="od-download-tab";b.downloadItemsOperatorTypeResourceKey=new m.ResourceKey({name:""+i("module").id,loader:new m.AliasResourceLoader(function(){return l.loadModuleExport({path:"afE",getModule:function(){return new o.default(function(e,t){i(["afE"],e,t)})},getExport:function(e){return e.typeResourceKey}})})});var g=function(i){e.__extends(l,i);function l(e){var t=i.call(this,e)||this;t._sessionManagementProvider=t.resources.consume(d.resourceKey.optional);t._platform=t.resources.consume(n.platformDetection);t._oAuthTokenProvider=t.resources.consume(h.resourceKey.optional);t._navigation=t.resources.consume(u.navigation);t._hiddenDomProvider=t.resources.consume(c.resourceKey);t.selectionHelper=e.selectionHelper;t.currentItem=e.currentItem;t.dialogProvider=t.resources.consume(r.resourceKey);return t}l.prototype.execute=function(e,t){var i,r=this,n=this.selectionHelper.selection;i={items:n.peek().map(function(e){return e.peek()})};v.isOneDrive&&this.trackPromise(this.resources.consumeAsync(p.resourceKey).then(function(e){var t=i.items&&0<i.items.length&&i.items[0];e.fireDownloadEvent(t)}));return this.onPreDownloadItems(i.items).then(function(e){return e?r.resources.consumeAsync(s.download).then(function(e){return e.downloadItems(i).then(function(){var e={},t={count:i.items.length};if(1===i.items.length){e.fileType=a.default[i.items[0].type];e.extension=i.items[0].extension||""}return{resultType:_.ResultTypeEnum.Success,extraData:e,extraMetrics:t}})}):o.default.wrap({resultType:_.ResultTypeEnum.ExpectedFailure})})};l.prototype.executeVroomDownload=function(t,i,r,n,e,o){var a=this;void 0===e&&(e="");if(!(l.doc_ids===i&&Date.now()-l.last_download<5e3)){l.last_download=Date.now();l.doc_ids=i;var s=function(){return a._doDownload(t,i,r,n,null)};if(t&&-1!==t[0].docId.indexOf("access_token")||"spo"===n&&this._oAuthTokenProvider)try{return this.resources.consumeAsync(f.resourceKey).then(function(e){return e.getMicroserviceEndPoints("media")}).then(function(e){return a._oAuthTokenProvider.getToken(e,!0)}).then(function(e){return a._doDownload(t,i,r,n,null,e)},s)}catch(e){return s()}return this._sessionManagementProvider.getToken().then(function(e){return a._doDownload(t,i,r,n,e)},function(e){if(e.message&&0===e.message.indexOf("Cannot request a token for an unauthenticated user."))return s()})}};l.prototype.onPreDownloadItems=function(e){return o.default.wrap(!0)};l.prototype._doDownload=function(e,t,i,r,n,o){return e?this._completeDownloadasZip(e,i,r,n,o):this._completeDownloadFile(i,n)};l.prototype._completeDownloadFile=function(e,t){e+=t?"?access_token="+t.accessToken:"";if(this._platform.isMobile){this._navigation.navigateTo({url:e,frameId:"_self"});return o.default.wrap({resultType:_.ResultTypeEnum.Success})}if(this._platform.isIE){this._downloadForIE(x,e);return o.default.wrap({resultType:_.ResultTypeEnum.Success})}var i=Math.random(),r=this._getDownloadIframe(i);document.body.appendChild(r);r.src=e;this.async.setTimeout(function(){r.remove()},2e4);return o.default.wrap({resultType:_.ResultTypeEnum.Success})};l.prototype._completeDownloadasZip=function(c,d,u,p,m){var h=this;l.zip_count++;var f=y.default.generate(),g="OneDrive_"+l.zip_count+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";c&&1===c.length&&(g=c[0].name+".zip");return this.resources.consumeAsync(S.resourceKey.optional).then(function(e){var t,i=e&&e.getNotificationUrl()||"";i&&v.isFeatureEnabled(v.DownloadNotifications)&&h.resources.consumeAsync(b.downloadItemsOperatorTypeResourceKey).then(function(e){var t=new e({items:[],guid:f,zipFileName:g});h.trackPromise(t.start());t.wait()});var r=2e4;if(h._platform.isIE){t=h._downloadForIE(x);r=5e3}var n=Math.random(),o=h._getDownloadIframe(n),a=h._hiddenDomProvider.requestControl({name:"od-downloadaszip",params:{filesValue:JSON.stringify({items:c}),notificationUrlValue:i,guid:f,formAction:d,providerValue:u,id:n,zipFileName:g,target:h._platform.isIE?x:o.id,oAuthToken:m,accessToken:p&&p.accessToken||"",resources:h.resources}}),s=document.getElementById("form_download_as_zip"+n);s.parentNode.appendChild(o);s.submit();var l=h.addDisposable({dispose:function(){h._hiddenDomProvider.disposeControl(a)}});h.async.setTimeout(function(){l.dispose();t&&t.close()},r);return{resultType:_.ResultTypeEnum.Success}})};l.prototype._getDownloadIframe=function(e){var t=document.createElement("iframe");t.id="od-download-iframe"+e;t.name=t.id;t.hidden=!0;return t};l.prototype._downloadForIE=function(e,t){void 0===t&&(t="");var i;i=window.open(t,e);this.async.setTimeout(function(){i.close()},5e3);return i};l.zip_count=0;return l}(t.default);b.default=g});define("Kd",["require","exports","Kg","b5","Kf","Ke"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-downloadaszip",template:e("Kf"),viewModel:i.default,synchronous:!0});t.default=n});define("Kg",["require","exports","ap","bF"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.formAction=e.formAction;t.filesValue=e.filesValue;t.providerValue=e.providerValue;t.id="form_download_as_zip"+e.id;t.notificationUrlValue=e.notificationUrlValue;t.accessToken=e.accessToken;t.zipFileName=e.zipFileName;t.target=e.target;t.oAuthToken=e.oAuthToken;t.guid=e.guid;t.method=e.method||"Post";return t}return e}(i.default);t.default=n});define("Kf",[],function(){return'<div id=od-Download-As-Zip class=od-DownloadAsZip><form class=DownloadAsZipForm name=form_download_as_zip data-bind="attr: { action: formAction, target: target, id: id, method: method}"><input id=download_input_1 name=provider type=hidden data-bind="value: providerValue"> <input id=download_input_2 name=guid type=hidden data-bind="value: guid"> <input id=download_input_3 name=files type=hidden data-bind="value: filesValue"> <input id=download_input_4 name=notificationUrl type=hidden data-bind="value: notificationUrlValue"> <input id=download_input_5 name=accessToken type=hidden data-bind="value: accessToken"> <input id=download_input_6 name=zipFileName type=hidden data-bind="value: zipFileName"> <input id=download_input_6 name=oAuthToken type=hidden data-bind="value: oAuthToken"></form></div>'});define("Ke",["c","az"],function(e,t){e.loadStyles([{rawString:".od-DownloadAsZip{visibility:hidden}"}])});define("afE",["require","exports","ap","Sj","afF","cg","aC","bA","iH"],function(e,t,i,n,o,a,s,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c;!function(e){e[e.Success=0]="Success";e[e.RemoteHostClosedConnection_HttpException=1]="RemoteHostClosedConnection_HttpException";e[e.FileAndFolderDownloadError=2]="FileAndFolderDownloadError";e[e.FolderDownloadError=3]="FolderDownloadError";e[e.FileDownloadError=4]="FileDownloadError"}(c=t.ZipPayloadErrorCode||(t.ZipPayloadErrorCode={}));var d="OverAllProgress",u=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._context=e;i._pushChannelProvider=t.pushChannelProvider;return i}e.prototype.getOperationDetails=function(e){var t=r.prototype.getOperationDetails.call(this,e);t.type=a.default.downloadAsZip;var i=e.input;t.name=i.name;e.output&&0<=e.output.current&&(t.progress={current:e.output.current,minimum:0,maximum:e.output.maximum});t.payloads={downloadAsZip:{fileName:this._context.zipFileName}};return t};e.prototype.onStart=function(e){var i=this;if(!this._pushChannelProvider)return s.default.wrap();var t=new n.Task(d,{key:this._context.guid}),r=[t=t.changeOutput(function(e){return{zipFileName:i._context.zipFileName}})];e.update(r);this._pushChannelProvider.setupNotificationHandler({source:o.NotificationSource.Meta,scenarios:[o.NotificationScenario.Zip],id:this._context.guid},function(t){if("ZipProgress"===t.type&&r&&i._context.guid===t.guid){r=r.map(function(e){if(e.key===d){e=e.changeOutput(function(e){return{current:t.filesProcessed,maximum:t.totalFiles,zipFileName:i._context.zipFileName}});t.isComplete&&t.errorCode===c[c.RemoteHostClosedConnection_HttpException]?e=e.cancel():t.isComplete&&(e=e.succeed())}return e});e.update(r)}});return s.default.wrap()};e.dependencies=i.__assign({},n.default.dependencies,{pushChannelProvider:l.resourceKey.optional});return e}(n.default);t.default=u;t.typeResourceKey=r.createResolvedTypeResourceKey(e("module").id,u)});define("afF",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.WebhookSubscription=0]="WebhookSubscription";e[e.Meta=1]="Meta"}(t.NotificationSource||(t.NotificationSource={}));(i=t.NotificationScenario||(t.NotificationScenario={}))[i.Zip=0]="Zip";!function(e){e[e.PushChannelProvider=0]="PushChannelProvider";e[e.ItemAutoRefreshProvider=1]="ItemAutoRefreshProvider";e[e.ItemAutoRefreshDataSource=2]="ItemAutoRefreshDataSource"}(t.PushChannelLogSource||(t.PushChannelLogSource={}))});define("afD",["require","exports","ap","afI"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){return i.call(this,e)||this}e.prototype.execute=function(e){this.selectionHelper.selectAll();return i.prototype.execute.call(this,e)};e.prototype.getDeleteExecutionInfo=function(e){var t=i.prototype.getDeleteExecutionInfo.call(this,e);t.emptyRecycleBin=!0;return t};return e}(i.default);t.default=n});define("afn",["require","exports","ap","ba","MZ","bN","afC","cE","Pn","qY","aI","fO","afo","dc","qf","iG"],function(e,t,i,a,s,r,c,d,u,p,m,h,f,g,b,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(l){i.__extends(e,l);function e(e){var t=l.call(this,e)||this,i=e.item,r=e.type,n=e.url,o=e.contentTypeId,a=e.isFullPageApp,s=void 0!==a&&a;t._formType=r;t._formTypeName=c.getClientFormString(t._formType);t._item=i;t._url=n;t._contentTypeId=o;t._isFullPageApp=s;t._clientFormProvider=t.resources.consume(u.resourceKey);t._itemUrlHelper=t.resources.consume(h.resourceKey);t._panelProvider=t.resources.consume(p.resourceKey);t._powerAppsStore=t.resources.consume(b.typeResourceKey);t._navigation=t.resources.consume(g.navigation);t._rumOneHelper=t.resources.consume(_.rumOneHelper);return t}e.prototype.execute=function(){var n=this;this._contentTypeId||(this._contentTypeId=this._item&&this._item.properties&&this._item.properties.ContentTypeId);var o=this.resources.consume(d.resourceKey);return this._clientFormProvider.getFormRenderMode(this._formType,this._contentTypeId).then(function(e){var t="ShowListForm."+n._formTypeName;if(3===e&&b.default.arePowerAppsFormsEnabled()){o.logData({name:t+".PowerApps.Click",isIntentional:!0});n._rumOneHelper.logPowerAppFormLaunch();n._powerAppsStore.setAndShowAppForm(n._item,n._formType,n._contentTypeId)}else if(2===e&&a.isFeatureEnabled(a.LaunchListFormsInPanel)&&!n._isFullPageApp){o.logData({name:t+".Modern.Click",isIntentional:!0});var i=s.default.isFolder(n._item,!1)&&!n._item.list?n._itemUrlHelper.getItemUrlParts(n._item.key).normalizedItemUrl:null,r=n._panelProvider.requestPanel({hasCommandBar:!0,scrollMode:"auto",noTitle:!0,size:"Medium",component:{name:f.default.tagName,params:{mode:n.createObservable(n._formType),item:n.createObservable(n._item),showCommandBar:!0,onClose:function(){r.state(1)},renderMode:2,contentTypeId:n._contentTypeId,rootFolder:i}}});r.wait()}else{o.logData({name:t+".Classic.Click",isIntentional:!0,extraData:{renderMode:e.toString()}});n._navigation.navigateTo({url:n._url})}}).then(function(){return{resultType:m.ResultTypeEnum.Success}})};return e}(r.default);t.default=n});define("afC",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getClientFormString=function(e){switch(e){case 1:return"Edit";case 2:return"New";case 3:return"Display";default:return"Unknown"}}});define("afo",["require","exports","afr","b5","afq","afp"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-list-form",template:e("afq"),viewModel:i.default,synchronous:!0});t.default=n});define("afr",["require","exports","ap","Sq","pX","afB","Pv","afC","p3","bX","cE","qf","Pn","eX","eA","e0","jH","iJ","afy","afx","dc","eV","re","qT","qY","afs","qf","aC","aI","aM","bF","d7","qe","b3","bb"],function(x,e,t,i,r,s,d,u,n,a,p,m,k,C,P,l,c,I,h,f,w,o,T,L,F,g,E,b,_,D,v,M,N,O,y){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var S=function(S){t.__extends(e,S);function e(e){var t=S.call(this,e)||this;t._fieldsManager=null;t.addBindingHandlers({control:O.default});var i=e.mode,r=void 0===i?t.createObservable(null):i,n=e.renderMode,o=void 0===n?0:n,a=e.isFullPageApp,s=void 0!==a&&a,l=e.isDialog,c=void 0!==l&&l,d=e.sourceUrl,u=void 0===d?"":d,p=e.rootFolder,m=void 0===p?"":p,h=e.itemId,f=e.item,g=e.contentTypeId,b=void 0===g?"":g,_=e.topCommandSet,v=void 0===_?t.createObservable(null):_,y=e.onClose;t._mode=r;t._renderMode=t.wrapObservable(o);t.isFullPageApp=s;t.isDialog=c;t._sourceUrl=u;t._rootFolder=m;t._itemId=h;t._item=f;t._contentTypeId=b;t._onClose=y;t._disableSaveButton=t.createObservable(!1);t._pageLoaded=!1;t.overlayHostTagName=T.default.tagName;t.panelHostTagName=L.default.tagName;t.isFullPageApp||t.resources.bind(F.resourceKey);t.topCommandSet=v;t.commandBarSpecification=O.toSpecification(N.resourceKey,{commandSet:v,isSearchVisible:!1});t.breadcrumbBarComponent=t.createObservable(null);t.clientFormComponent=t.createObservable(null);t._itemsStore=t.resources.consume(I.resourceKey);t._navigation=t.resources.consume(w.navigation);t._itemProvider=t.resources.consume(C.resourceKey);t._clientFormProvider=t.resources.consume(k.resourceKey);t._getItemContext={parentKey:t._rootFolder?"id="+D.default.encodeURIComponent(t._rootFolder):""};t._itemParentHelper=t.resources.consume(P.resourceKey);t.showCommandBar=t.createObservable(!t.isDialog&&!t.isFullPageApp);t.isModern=2===t._renderMode.peek();t._commands=t.observables.createArray();t._loadingSpinnerUrl="undefined"==typeof __webpack_public_path__?x.toUrl("odsp-media/images/loading/loadingspinner.gif"):x("@ms/odsp-media/dist/media/images/loading/loadingSpinner.gif");t._clientFormIsSaving=t.createObservable(!1);t._powerAppsStore=t.resources.consume(E.typeResourceKey);t._bundleLoader=t.resources.consume(M.bundleLoader);t.isPowerApp=t.createComputed(function(){return 3===t._renderMode()});3!==t._mode.peek()&&t._clientFormIsSaving.subscribe(function(e){e?t._changeCommandSetToSavingCommand():t._initCommandSet(t._mode.peek())});3===t._renderMode.peek()?t._createPowerAppFormComponent(t._powerAppsStore.appForm):t._itemId||2===t._mode.peek()?t._initForm():t._initForm(t._item.peek());return t}e.prototype.breadcrumbBuilder=function(e,t){var i=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list")),r=i&&i.list,n="";2===e?n=f.strings.NewItem:(n=r.isDocumentLibrary?t.name:t.properties.Title)||(n=f.strings.ItemProperties);var o=[{name:n,isDroppingTarget:!1,isOverflow:!1,isNavItem:!1,isStaticItem:!0,showNextChevron:!1}],a=this.isFullPageApp?t.parent:null;return o.concat(s.getBreadcrumbs(a))};e.prototype._initForm=function(e){var t=this,i=[];switch(this._mode.peek()){case 1:case 3:(e?b.default.wrap(e):t._itemProvider.getSpecifiedItems({itemKeys:[t._itemId],parentKey:t._getItemContext.parentKey,getRootFolderFromParentKey:!!t._rootFolder,recurseInFolders:!t._rootFolder,needSchema:!0,needContentTypes:!0,needForm:!1}).then(function(e){var t=e.children;i=e.contentTypes;if(t&&1===t.length)return t[0];throw"Unable to get specified item"})).then(function(e){t._exposeCurrentItemSet(e,i);t._createClientform(t._mode.peek(),e)});break;case 2:var r=new o.default("newitem");r.properties.ContentTypeId=this._contentTypeId;r.parentKey=this._getItemContext.parentKey;this._exposeCurrentItemSet(r,[]);this._createClientform(this._mode.peek(),r)}};e.prototype._exposeCurrentItemSet=function(e,t){var i=this;if(!this.resources.isExposed(a.currentItemSet)){var r=new l.default(e.parentKey,this._getItemContext,1);r.item=this.createObservable(e.parent);t&&0<t.length&&(r.contentTypes=this.observables.createArray(t));this.resources.expose(a.currentItemSet,this.createObservable(r));this.resources.expose(a.itemsSelection,new(this.managed(c.default))({mode:1,maximumSelectedCount:-1}))}var n=this._itemsStore.getItem(e.key);if(n&&3===this._mode.peek())var o=this.subscribe(n,function(e){if(e.isExpired){o.dispose();i._itemProvider.getSpecifiedItems({itemKeys:[i._itemId],parentKey:i._getItemContext.parentKey,getRootFolderFromParentKey:!!i._rootFolder,recurseInFolders:!i._rootFolder,needSchema:!0,needContentTypes:!0,needForm:!1}).then(function(e){var t=e.children;if(t&&1===t.length){i._exposeCurrentItemSet(t[0],e.contentTypes);i._createClientform(3,t[0])}else console.log("ListItemFormViewModel: Unable to get specified item.")})}})};e.prototype._createClientform=function(n,o){var a=this,e=this._itemsStore.setItem(o),s=u.getClientFormString(n),l=y.default.isActivated("EE9348BB-EE3D-4D30-A686-B9BCEFAF1917","4/4/2018","Signal page loaded event when the full page form is done rendering");if(3!==this._renderMode.peek()){var c=3===n,i=o.properties.ContentTypeId||"";this._clientFormProvider.getClientForm({item:e,clientFormType:n,contentType:o.properties.ContentType||"",contentTypeId:i}).then(function(r){var t=function(){var e=3===a._renderMode.peek()&&E.default.arePowerAppsFormsEnabled(),t=e?"PowerApps":"Modern",i=new _.Qos({name:"ListFormRender."+t+"."+s,extraData:{isFullPage:a.isFullPageApp}});if(e){a._powerAppsStore.loadPowerAppJs(function(){var e=a._clientFormProvider.getPowerAppFormId(),t={appId:e,appRunTimeUrl:m.getPowerAppRunTimeUrl(e),title:"",appRenderInfo:a._clientFormProvider.getPowerAppRenderInfo(),appAdditionalData:a._clientFormProvider.getPowerAppAdditionalData()};a._powerAppsStore.formData({item:a.createObservable(o),type:a.createObservable(n)});a._powerAppsStore.showAppForm(!0);a._createPowerAppFormComponent(a.createObservable(t));a.createComputed(function(){a._powerAppsStore.showAppForm()||a._closePanel()})})}else{a._clientForm=r;a.clientFormComponent({name:d.getClientFormTagName(a._clientForm,a.resources),params:{clientForm:a._clientForm,isReadOnly:!1,fieldsManagerAccessor:function(e){a._fieldsManager=e;a._initCommandSet(n)},onSaveCallback:function(e){e&&a._closePanel()},suppressDefaultSaveBehavior:!0,onCancelCallback:function(){return a._closePanel()},suppressDefaultCancelBehavior:!0,interactiveSave:c,isSaving:a._clientFormIsSaving,rootFolder:a._rootFolder}});l||a._signalPageLoaded()}i.end({resultType:_.ResultTypeEnum.Success})};0===a._renderMode.peek()?a._clientFormProvider.getFormRenderMode(n,i).then(function(e){a._renderMode(e);t()}):t()})}else{this.resources.consume(p.resourceKey).logData({name:"ListFormRender.PowerApps."+s,extraData:{isFullPage:this.isFullPageApp}});this._initCommandSet(n,e)}this.isDialog||this.breadcrumbBarComponent({name:r.default.tagName,params:{item:e,getCrumbs:function(e){return a.breadcrumbBuilder(n,e)}}});(l||0!==this._renderMode.peek()&&3!==this._renderMode.peek())&&this._signalPageLoaded();l||this.async.setTimeout(this._signalPageLoaded,15e3)};e.prototype._signalPageLoaded=function(){if(this.isFullPageApp&&!this._pageLoaded){this._bundleLoader.pageLoaded();i.default.addToLoggingManager();this._pageLoaded=!0}};e.prototype._initCommandSet=function(e,t){var i=this,r=t||this._fieldsManager&&this._fieldsManager.item,n={fieldsManager:this._fieldsManager||{processAndSaveChanges:function(){return i._powerAppEvents.peek().onSave()},cancelChanges:function(){i._powerAppEvents.peek().onCancel();i._closePanel()}}},o=new(this.managed(h.default))({mode:e,item:r,isFullPageApp:this.isFullPageApp,disableSaveButton:this._disableSaveButton,contentTypeId:this._contentTypeId,itemPropertiesActionParams:n});this._commands(o.commands.peek());this.isDialog||this.topCommandSet(o)};e.prototype._changeCommandSetToSavingCommand=function(){var e=new n.default({iconUrl:this._loadingSpinnerUrl,text:f.strings.SavingText});this._commands([e])};e.prototype._closePanel=function(){this._onClose?this._onClose():this._navigation.navigateTo({url:this._sourceUrl})};e.prototype._createPowerAppFormComponent=function(e){var t=this;this._powerAppEvents=this.createObservable();var i={app:e,showPowerApp:this._powerAppsStore.showAppForm,eventHandlers:this._powerAppEvents,disableSaveButton:this._disableSaveButton,loadedInBackground:!this.isFullPageApp,onPowerAppRendered:this._signalPageLoaded.bind(this)};this.clientFormComponent({name:g.default.tagName,params:i});this.createComputed(function(){if(t._powerAppsStore.formData()){var e=t._powerAppsStore.formData.peek();t._contentTypeId=e.contentTypeId;t._mode(e.type.peek());t._initForm(e.item.peek())}})};return e}(v.default);e.default=S});define("afB",["require","exports","V","dJ","cY","iR","hE","lc"],function(e,t,n,r,p,m,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function h(e){for(var t=[],i=void 0;e;){if(i){i=n.format(a.strings.breadCrumbItem,i,e.name||m.strings.Files);t.push(i)}else{i=e.name||m.strings.Files;var r=e.parent?e.parent.name:m.strings.Files;t.push(r)}e=e.parent}return t}t.getAriaLabelsForBreadCrumbs=h;t.getBreadcrumbs=function(e,t,i){var r=h(e),n=!0,o=[],a=e;if(a||i)for(;a&&(!this._userIsAnonymous||p.PermissionMask.hasItemPermission(a,p.PermissionMask.openItems));){var s=n,l=!n;if(a.isStub){s=!1;l=!0}var c=void 0,d=void 0;if(t){c=f(a);d=g(a)}else d=b(a);var u={key:a.key,url:d,name:a.name||m.strings.Files,showNextChevron:n,isDroppingTarget:!1,item:c,isOverflow:!1,isNavItem:s,isStaticItem:l,isFiltered:i,ariaLabel:r.pop()};o.push(u);n=!0;a=a.parent}return o};function f(e){return!!e.parent&&e?e:null}t.getListBreadcrumbItem=f;function g(e){var t="#"+e.key;if(!e.parent&&e){var i=r.deserializeQuery(e.key);delete i.id;t="#"+o.default.clearFilterInfo(r.serializeQuery(i))}return t}t.getListBreadCrumbUrl=g;function b(e){return r.deserializeQuery(e.key).id}t.getBreadcrumbUrl=b});define("afy",["require","exports","ap","rt","Pi","rs","bX","afz","dZ","dI","rZ"],function(e,t,i,r,d,u,p,m,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(c){i.__extends(e,c);function e(e){var t=c.call(this,e)||this,i=".ListItemForm",r=e.mode,n=e.item,o=e.disableSaveButton,a=e.isFullPageApp,s=e.contentTypeId,l=e.itemPropertiesActionParams;t._actionMap=t.resources.consume(p.actionMap);t._urlDataSource=t.resources.consume(h.url);3===r?t.commands.push(new u.CommandViewModel({engagementName:"EditProperties",source:i,icon:new f.default("Edit"),text:d.strings.EditAll,action:new(t.managed(t._actionMap.EditItemAction))({item:n,userInvokedItem:!0,isFullPageApp:a})})):t.commands.push(new u.CommandViewModel({engagementName:"Save",source:i,icon:new f.default("Save"),isDisabled:o,text:d.strings.SaveLabel,action:new(t.managed(t._actionMap.EditItemSaveAction))(l)}),new u.CommandViewModel({engagementName:"Cancel",source:i,icon:new f.default("Cancel"),text:d.strings.CancelLabel,action:new(t.managed(t._actionMap.EditItemCancelAction))(l)}));a||(2===r?t.commands.push(new(t.managed(m.default))({url:t._urlDataSource.getNewFormUrl(s)}).command):t.commands.push(new(t.managed(g.default))({renderLabel:2,mode:3,item:n}).command));t.commands.push(new(t.managed(u.CommandViewModel))({engagementName:"Customize",source:i,icon:new f.default("PowerApps2Logo"),text:d.strings.CustomizeForms,action:new(t.managed(t._actionMap.CustomizeFormsNavigationAction)),renderLabel:2}));t.commands.push(t.overflowHostCommand);return t}return e}(r.default);t.default=n});define("afz",["require","exports","ap","bX","bN","rs","afA","dI","bA","dm"],function(e,l,t,c,i,r,o,n,a,d){"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.copyFormResourceKey=new a.ResourceKey({name:e("module").id+".copyForm",factory:{dependencies:{observablesFactoryType:i.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(),disposable:t}}}});var s=function(s){t.__extends(e,s);function e(e,t){void 0===t&&(t={});var i=s.call(this,e,t)||this,r=i,n=r.observables,o=r.resources,a=e.url;i._actionMap=o.consume(c.actionMap);i._copyFormData=i.resources.consume(l.copyFormResourceKey);i._url=a;n.backgroundCompute(i._computeIsOpen);n.backgroundCompute(i._computeShouldClearItem);i._initializeCommand();return i}e.prototype._initializeCommand=function(){var e=this._getCommandProperties();this.command=new(this.managed(r.CommandViewModel))(e)};e.prototype._computeIsOpen=function(){this._copyFormData()&&this.command.isOpen(!0)};e.prototype._computeShouldClearItem=function(){this.command.isOpen()||this._copyFormData(void 0)};e.prototype._dismissForm=function(){this._copyFormData(void 0)};e.prototype._getPayload=function(){var e=this,t=this.observables,i=this.createPureComputed(this._computeFormParams),r=this.createPureComputed(function(){return!!e._copyFormData()}),n=t.create();t.backgroundCompute(function(){r.peek()?e.trackPromise(e.resources.consumeAsync(o.default.local)).done(function(e){n(e)}):r()});return this.createPureComputed(function(){var e=n(),t=i();if(e&&t)return e.toSpecification(t)})};e.prototype._computeFormParams=function(){var e=this._copyFormData();if(e)return{itemName:e.itemName,linkUrl:e.linkUrl,onDismiss:this._dismissForm.bind(this)}};e.prototype._getCommandProperties=function(){var e={text:void 0,tooltip:void 0,icon:void 0,keys:void 0,action:void 0,payload:void 0,engagementName:void 0,renderLabel:2,enableRecoverFocusBinding:void 0,autoDismissPayload:void 0};e.text=d.strings.CopyLinkCommandText;e.tooltip=d.strings.CopyLinkCommandTooltipV3;e.icon=new n.default("Link");e.action=new(this.managed(this._actionMap.CopyFormAction))({url:this._url});e.payload={control:this._getPayload(),timeout:36e5,announce:!1,autoDismiss:!0};e.enableRecoverFocusBinding=!1;return e};return e}(i.default);l.default=s});define("afA",["require","exports","aC","bA","c7"],function(i,e,t,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new r.ResourceKey({name:i("module").id,loader:new r.AliasResourceLoader(function(){return n.loadModuleExport({path:"aw5",getModule:function(){return new t.default(function(e,t){i(["aw5"],e,t)})},getExport:function(e){return e.resourceKey.local}})})});e.default=e.resourceKey});define("afs",["require","exports","b5","afv","afu","aft"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"ms-powerapp",template:e("afu"),viewModel:r.default,synchronous:!0});t.default=n});define("afv",["require","exports","ap","aq","bF","bM","bW","afw","qG","bX","iE","aC","aZ","aI","cp","i0","qf","uB","p3","cE","ba","Sf","eX","zo","cL","iG"],function(e,t,r,n,i,o,a,s,l,c,d,h,u,f,p,m,g,b,_,v,y,S,x,k,C,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I="od-PowerApp-iframeContainer-",w="PowerAppView",T="sp-App-body",L=function(i){r.__extends(e,i);function e(e){var r=i.call(this,e)||this;r.commandBarItemTagName=b.default.tagName;r.resx=s.strings;r.appViewResx=l.strings;r.overlayTagName=p.default.tagName;r._getAccessToken=function(e,t,i){r._oAuthTokenProvider.getToken(e).then(function(e){t(e)},function(e){var t="Error: "+e.message+", Status: "+e.httpResponseStatus;i(t)})};r._oAuthTokenProvider=r.resources.consume(m.resourceKey);r._powerAppsStore=r.resources.consume(g.typeResourceKey);r._itemProvider=r.resources.consume(x.resourceKey);r._rumOneHelper=r.resources.consume(P.rumOneHelper);r.titleCommand=n.observable(null);r.iframeContainerElement=n.observable(null);r.titleElement=n.observable(null);r.containerId=I+u.default.generate();r.isAppLoaded=n.observable(!1);r._disableSaveButton=e.disableSaveButton;r._loadedInBackground=e.loadedInBackground;r._onPowerAppRendered=e.onPowerAppRendered;r.addBindingHandlers({automation:o.default,visible:S.default,element:a.default});r.isProcessing=r.resources.expose(d.appViewChangeInProgress,n.observable(!1));r._targetWindowName="openAppView"+Math.floor(12345*Math.random());r.pageContainerElement=document.querySelector("div."+T);r._actionMap=r.resources.consume(c.actionMap);r._engagement=r.resources.consume(v.resourceKey);r.app=e.app;r.showPowerApp=e.showPowerApp||r.createObservable(!0);r.isAppView=e.appViewMode;if(e.eventHandlers){var t=function(e){r._powerAppSdk.executeAction(e);return h.default.wrap(!0)};e.eventHandlers({onSave:function(){return t("save")},onCancel:function(){return t("cancel")}})}r.createComputed(function(){r.app()&&r._loadPowerAppView(r.app.peek(),r.isAppView)});r.addDisposable({dispose:function(){r.iframeContainerElement()&&k.disposeIframe(r.iframeContainerElement().getElementsByTagName("iframe")[0])}});return r}e.prototype.onClose=function(){this._engagement.logData({name:w+".Close.Click",isIntentional:!0});this.showPowerApp(!1)};e.prototype._loadPowerAppView=function(l,c){var d=this,u=y.isFeatureEnabled(y.PowerAppsAndAndProcessSimpleTestEnvironment),p=l.hostName||(u?g.POWERAPPS_TEST_ENV_RUNTIME:g.POWERAPPS_PROD_ENV_RUNTIME),m=(l.pageContainerElement||this.pageContainerElement).getBoundingClientRect();c&&this._createViewActions(l.title,l.appRunTimeUrl);this._powerAppSdk&&this._powerAppSdk.dispose();var e=function(){var i=new f.Qos({name:"PowerApps.Embedded.Render"});d._engagement.logData({name:"PowerApps.EmbeddedForms.Render.Start"});d._rumOneHelper.logPowerAppFormLoadSdkStart();var e,t,r=l.appRenderInfo;if(r){e=r.PrimaryDeviceWidth;t=r.PrimaryDeviceHeight}else{var n=c?12:0;e=m.width.toString();t=(m.height-d.titleElement().getBoundingClientRect().height-n).toString()}var o=c?"SPOListView":"SPOListForm";o+=d._loadedInBackground?"Background":"";var a={appId:l.appId,containerId:d.iframeContainerElement().id,getAccessToken:d._getAccessToken,enableOnBehalfOf:!0,hostName:p,appInfo:l.appInfo,maxWidth:e,maxHeight:t,hideAppSplashScreen:!c,source:o,locale:C.default.language,packagePropertiesJson:l.appAdditionalData};d._powerAppSdk=new WebPlayer.Sdk.PowerAppsEmbedding(a);u&&d._powerAppSdk.overrideWebPlayerPathSegment("webplayer-int");var s=new h.default(function(e,t){d._powerAppSdk.addEventListener("load",function(){i.end({resultType:f.ResultTypeEnum.Success});d._engagement.logData({name:"PowerApps.EmbeddedForms.Render.Complete"});d._rumOneHelper.logPowerAppFormLoadSdkEnd();d.isAppLoaded(!0);e()});d._powerAppSdk.addEventListener("error",function(){i.end({resultType:f.ResultTypeEnum.Failure,resultCode:"LoadError"})});d._powerAppSdk.addEventListener("unload",function(){i.end({resultType:f.ResultTypeEnum.Failure,resultCode:"Unload"})})});if(!d.isAppView){d._disableSaveButton&&d._disableSaveButton(!1);d._powerAppSdk.addEventListener("requestHide",function(){var e=d._powerAppsStore.formData.peek(),t=e.item.peek(),i=2===e.type.peek()?t.key:t.parentKey;d._itemProvider.invalidateItem(i);d.onClose()});d._powerAppSdk.addEventListener("enableSave",function(){d._disableSaveButton&&d._disableSaveButton(!1)});d.createComputed(function(){if(d._powerAppsStore.formData()){var i;if(!d._powerAppsStore.isFormInitialized){i=new f.Qos({name:"PowerApps.Embedded.UserPercievedRender"});d._powerAppsStore.isFormInitialized=!0;d._rumOneHelper.logPowerAppFormEnd()}s.then(function(){i&&i.end({resultType:f.ResultTypeEnum.Success});var e=d._powerAppsStore.formData.peek(),t=e.item.peek();d._powerAppSdk.executeAction(d._getPowerAppsSdkAction(e.type.peek()),{itemId:t&&t.properties.ID});d._onPowerAppRendered&&d._onPowerAppRendered()},function(){i&&i.end({resultType:f.ResultTypeEnum.Failure})})}})}d._powerAppSdk.renderApp()};if(this.iframeContainerElement.peek()&&this.titleElement.peek())e();else var t=this.createComputed(function(){if(d.iframeContainerElement()&&d.titleElement()){e();t.dispose()}})};e.prototype._createViewActions=function(e,t){var i=new(this.managed(this._actionMap.DeleteViewAction))({isProcessing:this.isProcessing});this._launchAppViewAction=new(this.managed(this._actionMap.NavigationAction))({url:t,target:this._targetWindowName});this.titleCommand(new _.default({text:e,requiredChildren:1,resources:this.resources,collapseSingleChildCommands:!1,children:n.observableArray([new _.default({text:this.appViewResx.AppViewOpenInPowerAppsCommandBarItemLabel,resources:this.resources,action:this._launchAppViewAction,engagementName:w+".OpenInPowerApp"}),new _.default({text:this.appViewResx.AppViewRemovalCommandBarItemLabel,resources:this.resources,action:i,engagementName:w+".Remove"})])}))};e.prototype._getPowerAppsSdkAction=function(e){return 2===e?"new":1===e?"edit":"view"};return e}(i.default);t.default=L});define("afu",[],function(){return'<div class=od-PowerApp data-bind="visible: showPowerApp, css : { \'od-PowerApp-view\': isAppView, \'od-PowerApp-form\': !isAppView }">\x3c!--ko if: app--\x3e<div class=od-PowerApp-title data-bind="if: titleCommand, element: titleElement">\x3c!--ko component: {\r\n name: commandBarItemTagName,\r\n params: {\r\n command: titleCommand()\r\n }\r\n }--\x3e\x3c!--/ko--\x3e<button class="od-Dialog-button od-Dialog-button--close" data-bind="automation: \'closePowerAppFrame\', attr: {\'aria-label\': resx.closeLabel, title: resx.closeLabel }, click: $component.onClose.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e<div data-bind="attr: { id: containerId }, element: iframeContainerElement"></div></div>'});define("aft",["c","az"],function(e,t){e.loadStyles([{rawString:".od-PowerApp{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-PowerApp iframe{border:0 none;display:block}.od-PowerApp--hide{display:none}.od-PowerApp .od-Dialog-button.od-Dialog-button--close{display:block;margin:0;padding:0;border:0;background:0 0;cursor:pointer;padding-top:12px}[dir=ltr] .od-PowerApp .od-Dialog-button.od-Dialog-button--close{padding-right:14px}[dir=rtl] .od-PowerApp .od-Dialog-button.od-Dialog-button--close{padding-left:14px}.od-PowerApp .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:16px}.sm .od-PowerApp .od-Dialog-button.od-Dialog-button--close{top:8px;line-height:20px}.sm .od-PowerApp .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{font-size:20px}.od-PowerApp-form{overflow:auto;position:absolute;left:0;right:0;bottom:0}.od-PowerApp-view{box-shadow:0 0 4px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";margin:4px;display:inline-block}.od-PowerApp-title{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}[dir=ltr] .od-PowerApp-title{padding-left:8px}[dir=rtl] .od-PowerApp-title{padding-right:8px}"}])});define("afq",[],function(){return"<div class=od-ListForm-root data-bind=\"css: { 'od-ListForm-position': isPowerApp() && !isFullPageApp, 'od-ListForm-fullPage': isFullPageApp }\">\x3c!--ko if: showCommandBar--\x3e<div class=\"od-ListForm-topBar od-TopBar-item od-TopBar-commandBar od-BasePage-commandBar\" data-bind=\"control: commandBarSpecification, css: { 'od-ListForm-position': isModern }\"></div>\x3c!--/ko--\x3e\x3c!--ko if: !isPowerApp() || isFullPageApp--\x3e\x3c!--ko with: breadcrumbBarComponent()--\x3e<div class=od-ListForm-breadcrumb data-bind=\"attr: { role: 'heading', 'aria-level': 3 }\">\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko with: clientFormComponent()--\x3e\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isDialog--\x3e\x3c!--ko component: { name: overlayHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: isFullPageApp--\x3e\x3c!--ko component: { name: panelHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>"});define("afp",["c","az"],function(e,t){e.loadStyles([{rawString:"[dir=ltr] .od-ListForm-topBar{padding-left:24px}[dir=rtl] .od-ListForm-topBar{padding-right:24px}.od-ListForm-position{position:absolute;left:0;top:0;right:0;bottom:0}.od-ListForm-position .od-PowerApp{top:40px}.od-ListForm-fullPage .od-PowerApp{top:77px}"}])});define("aeS",["require","exports","ap","bN","afm","aeT"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name=e.actionName;t._isMove=e.isMove;t._selectionHelper=e.selectionHelper;t._itemReedemer=new(t.managed(n.default));t._launchMoveCopyPanelHelper=new(t.managed(o.default));return t}e.prototype.execute=function(){var t=this;return this._selectionHelper.resolveSelection().then(function(e){return t._itemReedemer.redeemItems(e,t).then(function(){return t._launchMoveCopyPanelHelper.launchPanel(e,t._isMove)})})};return e}(i.default);t.default=a});define("afm",["require","exports","ap","aC","bN","aI","d7"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){void 0===e&&(e={});var t=i.call(this,e)||this;t._ticketRedeemer=t.resources.consume(a.ticketRedeemer.optional);return t}e.prototype.redeemItem=function(e,t,i){return this.redeemItems([e],t,i)};e.prototype.redeemItems=function(e,t,i){return this._ticketRedeemer&&(this._doAnyItemsNeedRedemption(e)||i)?this._startTokenRedemption(t,e[0]):n.default.wrap({resultType:o.ResultTypeEnum.Success})};e.prototype._doAnyItemsNeedRedemption=function(e){if(e)for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r&&r.tokenNeedsRedeeming)return!0}return!1};e.prototype._startTokenRedemption=function(t,i){return this._ticketRedeemer.getTicketRedeemerManager().then(function(e){return e.startRedeem(t,i)},function(e){return n.default.wrapError({})})};return e}(i.default);t.default=s});define("aeT",["require","exports","ap","bN","ba","ae7","aeU","aI","qY","cE","ig","bX","dZ","dm"],function(e,t,r,i,u,p,m,h,n,o,a,s,l,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._urlDataSource=t.resources.consume(l.url);t._currentItem=t.resources.consume(s.currentItem);t._panelProvider=t.resources.consume(n.resourceKey);t._engagement=t.resources.consume(o.resourceKey);return t}e.prototype.launchPanel=function(e,t){this._logEngagement(e,t);var i=this._currentItem(),r=this.observables.create({items:e,parentKey:i.key,targetId:null,targetKey:null,cid:this._urlDataSource.getOwnerId(),group:i.isGroup?1:0,isAsync:!1,isMove:t}),n=t?f.strings.moveItemDialogTitle:f.strings.copyItemDialogTitle,o=t?f.strings.moveItemsDialogTitle:f.strings.copyItemsDialogTitle,a=1===e.length?n:o,s=u.isFeatureEnabled(u.MoveCopyFolderSelectionUX),l=s?p.default.tagName:m.default.tagName,c=s?"Action.LaunchMoveCopyPanel.UseFolderSelectUX":"Action.LaunchMoveCopyPanel.UseFolderTreeUX";c+=t?".Move":".Copy";this._engagement.logData({name:c,extraData:{ItemCount:null!==e?e.length:0}});var d=this._panelProvider.requestPanel({hasCommandBar:!s,scrollMode:s?"hidden":"auto",noTitle:!0,title:a,component:{name:l,params:{context:r,onComplete:function(){d.state(1)},title:a,resources:this.resources}}});return d.wait().then(function(){return{resultType:h.ResultTypeEnum.Success}})};e.prototype._logEngagement=function(e,t){var i=this._engagement,r=e.filter(function(e){return a.default.isShortcutItem(e)}).length;0<r&&(t?i.logData({name:"ShortcutLink.MoveInitiateAggregate",extraData:{count:r}}):i.logData({name:"ShortcutLink.CopyInitiateAggregate",extraData:{count:r}}))};return e}(i.default);t.default=c});define("ae7",["require","exports","afb","b5","afa","ae9","ae8","cM","adY"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-folder-select",template:e("afa"),viewModel:i.default,synchronous:!0});r.registerTemplate("od-folder-select-content",e("ae9"));t.default=n});define("afb",["require","exports","ap","aq","bX","MY","dZ","bW","cE","bT","ba","df","EN","ae4","eX","afi","acB","DI","Ol","yk","eO","eA","iL","cJ","cL","lB","aC","b4","aI","dz","dB","lh","afh","bV","iE","V","afc","aP","bF","ey","dH","vN","cI","fO","oy","Aa"],function(e,t,i,x,k,r,C,P,I,n,o,w,T,L,F,E,D,M,a,N,s,O,l,A,c,B,H,U,R,G,V,q,W,z,j,K,J,$,d,Q,Z,X,Y,ee,te,ie){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var re=8,u=function(S){i.__extends(e,S);function e(e){var n=S.call(this,e)||this;n.chooseDestination=T.strings.chooseDestination;n.placesAltText=T.strings.placesAltText;n.stillSpinningTagName=J.default.tagName;n.loadingSpinnerTagName=B.default.tagName;n.siteIconTagName=q.default.tagName;n.fileTypeIconTagName=w.default.tagName;n.inlineCreateFolderTagName=E.default.tagName;n.infoBarTagName=D.default.tagName;n.sharingHintText=T.strings.sharingHintText;n._suiteNavProvider=n.resources.consume(N.resourceKey);var t=n._engagement=n.resources.consume(I.resourceKey);n.isSharingIconFocused=x.observable(!1);n.sharingHintIcon=x.observable(null);n.isSharingHintVisible=x.observable(!1);n.showSharingHintTooltip=x.observable(!1);n._sharingProvider=n.resources.consume(M.resourceKey);n.sharingInfoText=x.observable("");n.titleAccessibilityHint=L.strings.titleAccessibilityHint;n.loading=x.observable(!0);n.loadingOneDrive=x.observable(!0);var i=new R.Qos({name:"MoveCopySelect.LaunchPane"});n.context=e.context;n.itemOne=n._createContentItem();n.itemTwo=n._createContentItem();n._itemOneUsedLast=!1;var r=function(e){e&&n._showSharingInformation(e)};n.subscribe(n.itemOne.item,r);n.subscribe(n.itemTwo.item,r);n.subscribe(n.isSharingIconFocused,function(e){e?n._showSharingHint():n._dismissSharingHint()});n.waitingForItem=x.observable(!1);n.addFolderFocused=x.observable(!1);n.useLocationFocused=x.observable(!1);n.packageTooBig=x.observable(!1);n.newFolderActive=x.observable(!0);n.isSingleItem=n.isFileInfoVisible(n.context.peek().items);n.isSingleItem&&(n.fileItem=n.context.peek().items[0]);n._offset=new z.default(0,0);n.sharingHintOffset=x.observable(n._offset);n.top=x.observable("0px");n.left=x.observable("12px");n.chooseLocationText=n.context().isMove?T.strings.moveButtonLabel:T.strings.copyButtonLabel;n.chooseLocationButtonEnabled=x.observable(!0);n.onComplete=e.onComplete;n.newFolderItem=x.observable(null);n.newFolderItemFocused=x.observable(!1);n.showMinimalPackageWarning=x.observable(!0);n.createComputed(function(){if(n.newFolderItem()){var e=n.getCurrentItem();if(n.newFolderItem().parentKey===n._getParentKey(e)){var t=n._createFolderItem(n.newFolderItem(),e);e.subItems.push(t);t.focused(!0);n.focusedItem(t);n.selectionModel.selectItem(t);n.newFolderItemFocused(!1);n.newFolderItem(null)}else $.Verbose.logData({name:"FolderSelect.AddFolder.InvalidParent",message:"Tried to add folder but current item is different than the folder that was just created."})}});n._serverDataPromise=new U.default;n.waitingForItemParams={stillWaitingTimeout:4e3,promise:null,showControl:n.waitingForItem};n._breadCrumbItems=x.observableArray([]);n.hasBackToRootButton=x.observable(!1);n.parentBreadCrumbClass=x.observable("");n._isBreadCrumbRootClickable=!0;n.parentFolderName=n.createComputed(function(){var e=n._breadCrumbItems().length;return 1<e?n.unwrapObservable(n._breadCrumbItems()[e-2].title):""});n.currentFolderName=n.createComputed(function(){var e=n._breadCrumbItems().length;return 0<e?n.unwrapObservable(n._breadCrumbItems()[e-1].title):""});1===e.context().items.length?n.moveCopyText=K.format(e.context().isMove?T.strings.moveSingleItem:T.strings.copySingleItem,e.context().items.length):n.moveCopyText=K.format(e.context().isMove?T.strings.moveMultipleItems:T.strings.copyMultipleItems,e.context().items.length);n._urlDataSource=n.resources.consume(C.url);n._itemProvider=n.resources.consume(F.resourceKey);n._actionMap=n.resources.consume(k.actionMap);n._moveCopyDataSource=n.resources.consume(C.copy);n._pageContext=n.resources.consume(j.pageContext);n._itemUrlHelper=n.resources.consume(ee.resourceKey);n._itemParentHelper=n.resources.consume(O.resourceKey);n._sitesTitle=n._getSitesTitle();n.onItemClick=function(e){return n._onItemClick(e)};n.onBreadCrumbParentClick=function(){if(n.isParentBreadCrumbClickable())return n._onBreadCrumbClick(!1)};n.onBreadCrumbRootClick=function(){return n._onBreadCrumbClick(!0)};n.onShowMoreClick=function(e){return n._onShowMoreClick(e)};n.onUseLocationClick=function(e,t){return n._onUseLocationClick(e,t)};n.onKeyEnter=function(e,t){n._onItemClick(e);return!0};n.showSharingHint=function(){return n._showSharingHint()};n.dismissSharingHint=function(){return n._dismissSharingHint()};n.focusedItem=x.observable();n.selectionModel=new V.default;n.addBindingHandlers({selection:G.default,keyboard:A.default,element:P.default,stickyFooter:W.default,dismiss:Y.default,delayedHasFocus:te.default});var o=n.context().isMove?T.strings.itemTooBigInfoMove:T.strings.itemTooBigInfo;n.infoBarParams={type:x.observable(1),infoText:x.observable(o)};n.context().isMove?n.packageSizeWarning=1===n.context().items.length?T.strings.itemTooBigMove:T.strings.itemsTooBigMove:n.packageSizeWarning=1===n.context().items.length?T.strings.itemTooBig:T.strings.itemsTooBig;n.stickyFooterElement=x.observable();var a,s,l={title:T.strings.places,key:void 0,focused:x.observable(!1),selected:x.observable(!1),type:3,subItems:null,sections:[{title:n.chooseDestination,altTitle:T.strings.currentSite,items:x.observableArray(),listElement:x.observable(),focusedItem:x.observable(),showMore:x.observable(!1),showMoreInfo:x.observable(""),showMoreError:x.observable(""),showMoreFocused:n.createObservable(!1),showMoreLoading:n.createObservable(!1)}]},c=n.resources.consume(k.currentItem),d=n._getRootItem(c(),"list"),u=n._getRootItem(c(),"subsite");if(d){var p=n._itemUrlHelper.getItemUrlParts(d.key);n._siteAbsoluteUrl=u?n._itemUrlHelper.getItemUrlParts(u.key).fullItemUrl:n._pageContext.webAbsoluteUrl;n._siteTitle=u&&u.name?u.name:n._pageContext.webTitle;n._webId=u&&u.subsite&&u.subsite.id?u.subsite.id:n._pageContext.webId;n._siteId=u&&u.subsite&&u.subsite.itemReference&&u.subsite.itemReference.SiteId?u.subsite.itemReference.SiteId:n._pageContext.siteId;n._listTitle=d.name?d.name:n._pageContext.listTitle;n._siteLogoUrl=u?u.subsite.icon:n._pageContext.webLogoUrl;n._isOneDrive=d.list.templateType===Q.default.mySiteDocumentLibrary;a=n._loadWebDataSource().then(function(e){return e.getMyOneDriveUrl()});var m=!1;n.context().items.forEach(function(e){e.isDocSet&&(m=!0)});n._supportsCrossSite=(n._moveCopyDataSource.getCapabilities().supportsCopyCrossSite&&!n.context().isMove||n._moveCopyDataSource.getCapabilities().supportsMoveCrossSite&&n.context().isMove)&&(!n._pageContext||n._pageContext.isNoScriptEnabled||!1)&&n._pageContext&&n._pageContext.listBaseTemplate!==Q.default.webPageLibrary&&d.list.isDocumentLibrary&&!m&&!ie.isGallatin();var h=function(e,t,i,r){return{title:n._getLocalLibraryTitle(r),key:t,oneDriveItem:e,focused:x.observable(!1),selected:x.observable(!1),type:n._isOneDrive?5:1,siteIcon:null,folderIcon:"folder",subItems:null,sections:null,retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,listUrl:i,isCrossSite:!1,webId:n._webId,siteId:n._siteId}};(s=n._isOneDrive?a.then(function(e){return h(d,p.fullItemUrl,p.fullListUrl,e)},function(e){return h(d,p.fullItemUrl,p.fullListUrl)}):H.default.wrap(h(d,p.fullItemUrl,p.fullListUrl))).then(function(e){0<l.sections[0].items().length?l.sections[0].items.unshift(e):l.sections[0].items.push(e)});var f=n._isPackageSizeWithinLimit()}if(n._supportsCrossSite&&f){n._initialSitesQos=new R.Qos({name:"MoveCopySelect.GetInitialSites"});n._initialSitesQosDone=!1;var g=new R.Qos({name:"MoveCopySelect.GetMyOneDriveCrossSite"});a.then(function(e){if(null!==e){if(e!==n._siteAbsoluteUrl){var t={title:T.strings.personalOneDriveRootfolder,key:e,focused:x.observable(!1),selected:x.observable(!1),type:5,siteIcon:null,folderIcon:null,subItems:null,sections:null,retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,isCrossSite:!0};l.sections[0].items.push(t)}g.end({resultType:R.ResultTypeEnum.Success})}else{g.end({resultType:R.ResultTypeEnum.ExpectedFailure});$.Verbose.logData({name:"MoveCopySelect.GetMyOneDriveCrossSite",message:"User does not have a my site provisioned"})}n.loadingOneDrive(!1)},function(e){g.end({resultType:R.ResultTypeEnum.Failure});n.loadingOneDrive(!1)});var b={title:n._sitesTitle,altTitle:T.strings.frequentSitesAltText,type:3,lastIndex:0,listElement:x.observable(),focusedItem:x.observable(),items:x.observableArray(),showMore:x.observable(!0),showMoreLoading:x.observable(!1),showMoreInfo:x.observable(""),showMoreError:x.observable(""),showMoreFocused:x.observable(!1)};l.sections[1]=b;n._breadCrumbItems.push(l);n._acronymDataSource=new X.AcronymAndColorDataSource(n._pageContext);n._itemProvider.getItemSync({parentKey:n._urlDataSource.getRootItemKey(Z.default.Subsites)});if(n._isOneDrive)n._getInitialSitesData(l.sections[1]);else{var _=new R.Qos({name:"MoveCopySelect.GetCurrentTeamSiteAcronymAndColor"}),v=new R.Qos({name:"MoveCopySelect.GetCurrentTeamSiteDocumentLibraryCount"}),y=[];n._loadWebDataSource().then(function(e){y.push(n._getInitialSitesData(l.sections[1]));y.push(n._getCurrentSiteData(_));y.push(n._getHasMultipleDocumentLibraries(v));H.default.all(y).done(function(e){var t=e[0],i=e[1],r=e[2];if(t){i&&r&&t.unshift(i);t=t.slice(0,re);l.sections[1].items(t);l.sections[1].showMoreLoading(!1)}})})}n._initialLoadSuccess(l,i,!!d)}else if(d){n._breadCrumbItems.push(l);n._isBreadCrumbRootClickable=!1;n.loadingOneDrive(!1);if(!f&&n._supportsCrossSite){t.logData({name:"MoveCopySelect.PackageTooBig",extraData:{numItems:n.context.peek().items.length}});n.packageTooBig(!0)}s.then(function(e){var t=e;n._updateContextWithCurrentItem(t);n._getItemData(n._getParentKey(t),t.webId,t.siteId,function(e){l=t;n._parseFolderItems(e,l);n._breadCrumbItems.push(l);n._initialLoadSuccess(l,i,!0)},function(){n._initialLoadFailure(l,i)})},function(e){n._initialLoadFailure(l,i)})}else{$.Verbose.logData({name:"MoveCopySelect.LaunchPane",message:"List root item is null"});n.loadingOneDrive(!1);n._initialLoadFailure(l,i)}return n}e.prototype.getStatusText=function(e){if(e&&e.subItems&&0===e.subItems().length)switch(e.type){case 2:case 1:return T.strings.noSubFolders;case 0:return T.strings.noLibraries}return null};e.prototype.isSite=function(e){return!!e&&0===e.type};e.prototype.isRootItem=function(e){return!!e&&3===e.type};e.prototype.isLibraryOrFolder=function(e){return!!e&&(1===e.type||2===e.type)};e.prototype.isLibraryOrFolderOrOneDrive=function(e){return!!e&&(this.isLibraryOrFolder(e)||this.isOneDrive(e))};e.prototype.isOneDrive=function(e){return!!e&&5===e.type};e.prototype.showAddFolder=function(){var e=this.getCurrentItem(),t=e.oneDriveItem,i=this._getRootItem(t,"list");return!(e.remote||!t||!i)&&r.isSpoCreateFolderAvailable(t,i)};e.prototype.showBottomLine=function(e){return!!(e&&e.subItems&&0<e.subItems().length||this.isLibraryOrFolderOrOneDrive(e)&&this.showAddFolder())};e.prototype.getListType=function(e){if(e)return e.title===T.strings.siteCurrentLibrary?K.format(T.strings.currentLibraryFolders,e.title):0===e.type?K.format(T.strings.docLibs,e.title):5===e.type||1===e.type?K.format(T.strings.libraryFolders,e.title):K.format(T.strings.folders,e.title)};e.prototype.getShowMoreText=function(e){return e&&3===e.type?T.strings.browseSites:T.strings.showMore};e.prototype.getShowMoreAccText=function(e){var t=T.strings.browseMoreSites;e&&(0===e.type?t=T.strings.showMoreFollowedSites:1===e.type&&(t=T.strings.showMoreRecentSites));return t};e.prototype.getChooseLocationAccText=function(e){return this.context().isMove?K.format(T.strings.moveButtonAccText,e.title):K.format(T.strings.copyButtonAccText,e.title)};e.prototype.getCurrentItem=function(){return this._itemOneUsedLast?this.itemTwo.item():this.itemOne.item()};e.prototype.isParentBreadCrumbClickable=function(){return 2<this._breadCrumbItems.peek().length||this._isBreadCrumbRootClickable};e.prototype.onInfoBarClick=function(){if(this.showMinimalPackageWarning.peek()){this.infoBarParams.type(0);this.infoBarParams.infoText(this.packageSizeWarning);this.showMinimalPackageWarning(!1)}return!1};e.prototype.isFileInfoVisible=function(e){return 1===e.length};e.prototype._initialLoadSuccess=function(e,t,i){void 0===i&&(i=!1);this._setCurrentItemClass("od-FolderSelect-itemInitial");this.loading(!1);this._setCurrentItem(e,i);t.end({resultType:R.ResultTypeEnum.Success})};e.prototype._initialLoadFailure=function(e,t){e.error=x.observable(T.strings.serverError);this.loading(!1);this._setCurrentItem(e);t.end({resultType:R.ResultTypeEnum.Failure})};e.prototype._getRootItem=function(e,t){var i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,t));return i||null};e.prototype._showSharingHint=function(){this.showSharingHintTooltip(!0);return!1};e.prototype._dismissSharingHint=function(){this.showSharingHintTooltip(!1);return!1};e.prototype._loadWebDataSource=function(){return this.resources.consumeAsync(l.resourceKey)};e.prototype._loadSitesDataSource=function(){return this.resources.consumeAsync(C.sites)};e.prototype._onItemClick=function(a){var s=this,e=this._engagement;a.focused(!1);this._breadCrumbItems.push(a);this._updateBreadcrumb();this._exitCurrentItemLeft();0===a.type?e.logData({name:"MoveCopySelect.SelectSite.Click",isIntentional:!0}):e.logData({name:"MoveCopySelect.SelectLibraryOrFolder.Click",isIntentional:!0});if(null===a.subItems)if(0===a.type||5===a.type&&a.isCrossSite){this.waitingForItemParams.promise=new H.default(function(o,e){s._loadWebDataSource().then(function(t){var e;e=5===a.type?function(e){return t.getDefaultOneDriveLibrary(e)}:function(e){return t.getDocumentLibraries(e)};s._serverDataPromise.debounce(e(a.key)).then(function(e){for(var t=[],i=0;i<e.length;i++){var r={title:e[i].title,key:e[i].target,focused:x.observable(!1),selected:x.observable(!1),listUrl:e[i].customSettingsUrl,type:1,folderIcon:"folder",subItems:null,sections:null,isCrossSite:a.isCrossSite,webId:a.webId,siteId:a.siteId,rootItemType:a.type,remote:e[i].remote};t.push(r)}if(1===t.length){var n=t[0];n.title=a.title;s._breadCrumbItems()[s._breadCrumbItems().length-1]=n;s._getItemWithWaiting(n).then(function(){o()})}else{a.subItems=x.observableArray(t);o();s._enterNextItem(a,!1)}},function(e){s._handleGetItemError(e,a);o()})})});this.waitingForItem(!0)}else 1!==a.type&&2!==a.type&&5!==a.type||this._getItemWithWaiting(a);else{this._serverDataPromise.clear();this._enterNextItem(a,!1)}return!1};e.prototype._onBreadCrumbClick=function(e){var t,i=this._engagement;if(e){i.logData({name:"MoveCopySelect.Breadcrumb.Root.Click",isIntentional:!0});if(this._isBreadCrumbRootClickable){t=this._breadCrumbItems.shift();this._breadCrumbItems([t])}else{var r=this._breadCrumbItems.slice(0,2);t=r[1];this._breadCrumbItems(r)}}else{i.logData({name:"MoveCopySelect.Breadcrumb.Click",isIntentional:!0});this._breadCrumbItems.pop();t=this._breadCrumbItems()[this._breadCrumbItems().length-1]}var n=this.getCurrentItem();n.error&&n.error()&&(n.error=null);this._serverDataPromise.isExecuting()?this._serverDataPromise.clear():this._exitCurrentItemRight();this._updateBreadcrumb();this._enterNextItem(t,!0);return!1};e.prototype._onShowMoreClick=function(t){var i=this,e=this._engagement,r=!1,n=function(){r=!0};if(3===t.type){e.logData({name:"MoveCopySelect.ShowMoreSites.Click",isIntentional:!0});t.showMoreFocused(!1);if(this._sitesFolderItem){this._breadCrumbItems.push(this._sitesFolderItem);this._exitCurrentItemLeft();this._enterNextItem(this._sitesFolderItem,!1)}else{t.showMoreLoading(!0);var o={title:this._sitesTitle,key:void 0,focused:x.observable(!1),selected:x.observable(!1),type:4,subItems:null,sections:[{title:T.strings.followed,altTitle:T.strings.followedSites,type:0,lastIndex:0,listElement:x.observable(),focusedItem:x.observable(),items:x.observableArray(),showMore:x.observable(!0),showMoreLoading:x.observable(!1),showMoreInfo:x.observable(""),showMoreError:x.observable(""),showMoreFocused:x.observable(!1)},{title:T.strings.recent,altTitle:T.strings.recentSites,type:1,lastIndex:0,listElement:x.observable(),focusedItem:x.observable(),items:x.observableArray(),showMore:x.observable(!0),showMoreLoading:x.observable(!1),showMoreInfo:x.observable(""),showMoreError:x.observable(""),showMoreFocused:x.observable(!1)}]},a=new R.Qos({name:"MoveCopySelect.GetFollowedSites"}),s=new R.Qos({name:"MoveCopySelect.GetRecentSites"});this._serverDataPromise.debounce(H.default.all([this._getSitesData(o.sections[0],a,n),this._getSitesData(o.sections[1],s,n)])).done(function(e){if(!r)if(o.sections[0].showMoreError()&&o.sections[1].showMoreError()){t.showMoreError(T.strings.serverError);t.showMore(!1)}else{i._breadCrumbItems.push(o);i._updateBreadcrumb();i._exitCurrentItemLeft();i._sitesFolderItem=o;i._enterNextItem(i._sitesFolderItem,!1)}t.showMoreLoading(!1)})}}else{e.logData({name:"MoveCopySelect.ShowMore.Click",isIntentional:!0,extraData:{Type:t.type}});var l=new R.Qos({name:"MoveCopySelect.ShowMoreSites"});this._serverDataPromise.debounce(this._getSitesData(t,l,n)).then(function(){if(r){t.showMoreLoading(!1);i._exitCurrentItemRight()}else t.listElement().focus()})}return!1};e.prototype._onUseLocationClick=function(e,t){var i=this._engagement;this.chooseLocationButtonEnabled(!1);var r=this.getCurrentItem(),n="MoveCopySelect.ChooseLocation",o=void 0!==r.rootItemType?r.rootItemType:r.type,a={ItemCount:this.context().items.length,FolderCount:this._getFolderCount(this.context().items),FileCount:this._getFileCount(this.context().items)};n+=this.context().isMove?".Move":".Copy";var s=this._getRootItem(r.oneDriveItem,"list");s&&!s.list.isDocumentLibrary&&(n+=".List");r.isCrossSite?n+=".CrossSite.Click":n+=0===o?".WithinSite.Click":".InLibrary.Click";i.logData({name:n,isIntentional:!0,extraData:a});if(r.isCrossSite){var l="MoveCopySelect.ChooseLocation";l+=this.context().isMove?".Move":".Copy";if(0!==o||this._isOneDrive)if(0===o&&this._isOneDrive)l+=".ODBToTeamSite.Click";else if(5!==o||this._isOneDrive)if(5===o&&this._isOneDrive)l+=".ODBToODB.Click";else{l+=".UnknownCrossSite.Click";$.Verbose.logData({name:"MoveCopySelect.ChooseLocation.UnknownCrossSite.Click",message:"rootItemType: "+o})}else l+=".TeamSiteToODB.Click";else l+=".TeamSiteToTeamSite.Click";i.logData({name:l,isIntentional:!0,extraData:a})}!this._initialSitesQosDone&&this._initialSitesQos&&this._initialSitesQos.end({resultType:R.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:3}});r.webId&&(this.context.peek().webId=r.webId);r.siteId&&(this.context.peek().siteId=r.siteId);var c={context:this.context,onComplete:this.onComplete,isMove:this.context().isMove,isCrossSite:r.isCrossSite};new(this.managed(this._actionMap.MoveCopyAction))(c).execute(t);t.stopPropagation();return!1};e.prototype._getFolderCount=function(e){for(var t=0,i=0;i<e.length;i++)e[i].folder&&t++;return t};e.prototype._getFileCount=function(e){return e.length-this._getFolderCount(e)};e.prototype._getItem=function(e,t,i){var r={parentKey:e,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(e),filters:this._getFilters(),sortField:"LinkFilename",isAscending:!0,needSchema:!0,expandGroup:!0,ignoreListContext:!0,webId:t,siteId:i};return this._itemProvider.getItem(r)};e.prototype._getItemData=function(e,t,i,r,n){return this._getItem(e,t,i).then(r,n)};e.prototype._getItemWithWaiting=function(t){var i=this;this.waitingForItemParams.promise=this._serverDataPromise.debounce(this._getItemData(this._getParentKey(t),t.webId,t.siteId,function(e){1!==t.type&&5!==t.type||(t.oneDriveItem=e.item());i._parseFolderItems(e,t);i._enterNextItem(t,!1)},function(e){i._handleGetItemError(e,t)}));this.waitingForItem(!0);return this.waitingForItemParams.promise};e.prototype._handleGetItemError=function(e,t){if(!H.default.isCanceled(e)){e.status?404===e.status&&(t.error=x.observable(T.strings.itemNotFoundError)):0===t.type?t.error=x.observable(T.strings.loadLibrariesFailure):t.error=x.observable(T.strings.loadFoldersFailure);this._setNextItemClass("");this._setNextItem(t)}};e.prototype._parseFolderItems=function(e,t){t.subItems=x.observableArray();for(var i=e.content().items,r=0;r<i.length;r++){var n=i[r]();n.type===s.default.Folder&&t.subItems.push(this._createFolderItem(n,t))}};e.prototype._createFolderItem=function(e,t){return{title:e.name,key:e.id,focused:x.observable(!1),selected:x.observable(!1),listUrl:t.listUrl,oneDriveItem:e,type:2,siteIcon:null,folderIcon:e.iconName,subItems:null,sections:null,isCrossSite:t.isCrossSite,webId:t.webId,siteId:t.siteId,remote:t.remote,rootItemType:void 0!==t.rootItemType?t.rootItemType:t.type}};e.prototype._createContentItem=function(){var e=x.observable(),t={item:x.observable(),className:x.observable(""),element:e,regionElement:x.observable(),listElement:x.observable(),stickyFooterElement:x.observable(),resizeStickyFooter:x.observable(!1),isActive:x.observable(!1),eventGroup:new n.default(e),isEntering:!1};this.addDisposable(t.eventGroup);return t};e.prototype._addAnimationEvents=function(t,i){var r=this;void 0===i&&(i=!1);var e=function(){if(i||t.isEntering){r._setInitialFocus(t);t.isEntering=!1;var e=t.item.peek();e.subItems&&(0===e.subItems.peek().length?r.useLocationFocused(!0):r.selectionModel.selectItem(e.subItems.peek()[0]))}else t.isActive(!1)};t.element()?function(){if(i)e();else{t.eventGroup.on(t.element(),"transitionEnd",e);t.eventGroup.on(t.element(),"webkitTransitionEnd",e)}}():this.async.setTimeout(function(){r._addAnimationEvents(t,i)},10)};e.prototype._getSitesData=function(r,n,i){r.showMoreLoading(!0);var e,t=function(e){n.end({resultType:R.ResultTypeEnum.Success,extraData:{Length:e.length,Type:r.type}});r.lastIndex+=e.length;0===e.length&&0===r.lastIndex&&(0===r.type?r.showMoreInfo(T.strings.noFollowedSites):r.showMoreInfo(T.strings.loadRecentSitesFailure));for(var t=0;t<e.length;t++){var i={title:e[t].title,key:e[t].serverRelativeUrl,focused:x.observable(!1),selected:x.observable(!1),siteIcon:{iconUrl:e[t].icon,color:e[t].color,acronym:e[t].acronym},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!0,webId:e[t].itemReference&&e[t].itemReference.WebId,siteId:e[t].itemReference&&e[t].itemReference.SiteId};r.items.push(i)}5!==e.length&&r.showMore(!1);r.showMoreLoading(!1)},o=function(e){if(H.default.isCanceled(e)){n.end({resultType:R.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:r.type}});i&&i()}else{var t=!1;if(0===r.type)r.showMoreError(T.strings.loadFollowedSitesFailure);else if(1===r.type){if(500011===(e.responseData&&e.responseData.ErrorCode)){r.showMoreInfo(T.strings.noGraphRecentSitesFailure);t=!0}else r.showMoreError(T.strings.loadRecentSitesFailure)}else r.showMoreError(T.strings.loadSitesFailure);r.showMoreLoading(!1);t?n.end({resultType:R.ResultTypeEnum.ExpectedFailure,extraData:{Type:r.type}}):n.end({resultType:R.ResultTypeEnum.Failure,extraData:{Type:r.type}});r.showMore(!1)}};switch(r.type){case 0:e=this._loadSitesDataSource().then(function(e){return e.getFollowedSites(r.lastIndex,5).then(t,o)});break;case 1:e=this._loadSitesDataSource().then(function(e){return e.getRecentSites(r.lastIndex,5).then(t,o)});break;default:$.Verbose.logData({name:"FolderSelect.GetSites.InvalidSectionType",message:"Invalid section type:"+r.type.toString()})}return e};e.prototype._getInitialSitesData=function(u){var p=this;u.showMoreLoading(!0);return this._itemProvider.getItem({parentKey:this._urlDataSource.getRootItemKey(Z.default.Subsites)}).then(function(e){for(var t=0,i=e.content().groupings[0].itemGroups,r=0;r<i.length;r++)t+=i[r].count;u.lastIndex+=t;if(0===t&&0===u.lastIndex){u.showMoreInfo(T.strings.noFollowedSites);u.showMoreLoading(!1);p._initialSitesQos.end({resultType:R.ResultTypeEnum.Success,extraData:{Length:t,Type:u.type}});p._initialSitesQosDone=!0;return null}for(var n=[],o={},a=0;a<t;a++){var s=p.peekUnwrapObservable(e.content().items[a]),l=p._itemUrlHelper.getItemUrlParts(s.key),c=l.fullItemUrl&&l.fullItemUrl.replace(/\/$/,"");if(p._isOneDrive||c!==p._siteAbsoluteUrl){var d={title:s.name,key:l.fullItemUrl,focused:x.observable(!1),selected:x.observable(!1),siteIcon:{iconUrl:s.subsite.icon,color:s.subsite.color,acronym:s.subsite.acronym},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!0,webId:s.subsite.id,siteId:s.subsite.itemReference&&s.subsite.itemReference.SiteId};if(!o[l.fullItemUrl]){o[l.fullItemUrl]=!0;n.push(d)}}}if(p._isOneDrive){n=n.slice(0,re);u.items(n);u.showMoreLoading(!1)}p._initialSitesQos.end({resultType:R.ResultTypeEnum.Success,extraData:{Length:t,Type:u.type}});p._initialSitesQosDone=!0;return n},function(e){H.default.isCanceled(e)?p._initialSitesQos.end({resultType:R.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:u.type}}):p._initialSitesQos.end({resultType:R.ResultTypeEnum.Failure,extraData:{Type:u.type}});p._initialSitesQosDone=!0;u.showMoreError(T.strings.loadSitesFailure);u.showMoreLoading(!1);return null})};e.prototype._getCurrentSiteData=function(t){var i={title:this._siteTitle,key:this._siteAbsoluteUrl,focused:x.observable(!1),selected:x.observable(!1),siteIcon:{iconUrl:"_layouts/15/images/siteicon.png"===this._siteLogoUrl?"":this._siteLogoUrl},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!!o.isFeatureEnabled(o.MoveCopyCrossLibraryUsePrime),webId:this._webId,siteId:this._siteId};return this._acronymDataSource.getAcronymData(this._siteTitle).then(function(e){t.end({resultType:R.ResultTypeEnum.Success});i.siteIcon.color=e.color;i.siteIcon.acronym=e.acronym;return i},function(e){t.end({resultType:R.ResultTypeEnum.Failure});return null})};e.prototype._getHasMultipleDocumentLibraries=function(t){var i=this;return this._loadWebDataSource().then(function(e){return e.getDocumentLibraries(i._siteAbsoluteUrl).then(function(e){t.end({resultType:R.ResultTypeEnum.Success});return 1<e.length})},function(e){t.end({resultType:R.ResultTypeEnum.Failure});return!0})};e.prototype._setCurrentItem=function(e,t){void 0===t&&(t=!1);var i;(i=this._itemOneUsedLast?this.itemTwo:this.itemOne).item(e);i.isActive(!0);this._addAnimationEvents(i,t)};e.prototype._setNextItem=function(e){var t,i,r=this;this._updateContextWithCurrentItem(e);if(this._itemOneUsedLast){t=this.itemOne;i=this.itemTwo}else{t=this.itemTwo;i=this.itemOne}this._itemOneUsedLast=!this._itemOneUsedLast;t.item(e);t.isActive(!0);i.isActive(!1);e.error||(t.isEntering=!0);this._addAnimationEvents(t);this.async.setTimeout(function(){r._setElementLeft(t.element(),0)},0)};e.prototype._setNextItemClass=function(e){this._itemOneUsedLast?this.itemOne.className(e):this.itemTwo.className(e)};e.prototype._setCurrentItemClass=function(e){this._itemOneUsedLast?this.itemTwo.className(e):this.itemOne.className(e)};e.prototype._setCurrentItemLeft=function(e){var t,i=(t=this._itemOneUsedLast?this.itemTwo.element():this.itemOne.element()).getBoundingClientRect().width+40;(e&&!c.default.isRightToLeft||!e&&c.default.isRightToLeft)&&(i=-i);this._setElementLeft(t,i)};e.prototype._setElementLeft=function(e,t){c.default.isRightToLeft?e.style.right=t+"px":e.style.left=t+"px"};e.prototype._setInitialFocus=function(e){var t,i=e.item().sections;(t=i&&0<i.length?i[0].listElement():e.listElement())&&t.focus()};e.prototype._exitCurrentItemLeft=function(){this._setCurrentItemLeft(!0)};e.prototype._exitCurrentItemRight=function(){this._setCurrentItemLeft(!1)};e.prototype._enterNextItem=function(e,t){t&&!c.default.isRightToLeft||!t&&c.default.isRightToLeft?this._setNextItemClass("od-FolderSelect-itemEnterLeft"):this._setNextItemClass("od-FolderSelect-itemEnterRight");this._setNextItem(e)};e.prototype._updateBreadcrumb=function(){this.hasBackToRootButton(2<this._breadCrumbItems().length);this.isParentBreadCrumbClickable()?this.parentBreadCrumbClass("od-FolderSelect-clickableCrumb"):this._isBreadCrumbRootClickable||this.parentBreadCrumbClass("")};e.prototype._updateContextWithCurrentItem=function(e){this.context().targetKey=this._getParentKey(e);this.context().targetId=e.key};e.prototype._getLocalLibraryTitle=function(e){var t=this._pageContext.isSiteAdmin&&this._isOneDrive;e&&(t=e===this._siteAbsoluteUrl);return this._isOneDrive?t?T.strings.personalOneDriveRootfolder:K.format(T.strings.oneDriveRootfolder,this._pageContext.webTitle):this._supportsCrossSite?T.strings.siteCurrentLibrary:this._listTitle};e.prototype._getFilters=function(){return this._moveCopyDataSource.getCapabilities().supportsMoveCopyFilterParams?{FilterField1:"FSObjType",FilterValue1:"1"}:{}};e.prototype._isPackageSizeWithinLimit=function(){if(!this._moveCopyDataSource.getCapabilities().supportsThrottling||o.isFeatureEnabled(o.MoveCopyCrossSiteMaxSizeIncrease))return!0;for(var e=this.context().items.length,t=0,i=0;i<e;i++){var r=this.context().items[i];r.folder||!r.size?t+=r.totalSize:t+=r.size}return t<=524288e3};e.prototype._getParentKey=function(e){var t,i=e.key,r=e.listUrl,n=this._itemUrlHelper.getUrlParts({path:i,listUrl:r});return this._urlDataSource.getKey(((t={}).id=n.serverRelativeItemUrl,t.listurl=n.normalizedListUrl,t))};e.prototype._showSharingInformation=function(i){var r=this;if(i.key)if(i.retrievedSharingPermissions){this.sharingInfoText(i.sharingInfoText);this.isSharingHintVisible(!!i.sharingInfoText)}else{this.isSharingHintVisible(!1);if(i.oneDriveItem){this._sharingProvider.getSharingData(i.oneDriveItem).getPermissions().then(function(e){var t=e[0];i.retrievedSharingPermissions=!0;i.sharingPermissions=t;i.sharingInfoText=a.getSharingStatusText(t,r.peekUnwrapObservable(i.title));r.sharingInfoText(i.sharingInfoText);r.isSharingHintVisible(!!i.sharingInfoText)},function(e){})}}};e.prototype._getSitesTitle=function(){var t=this.createObservable();this.trackPromise(this._suiteNavProvider.loadData().then(function(e){return e.CompanyDisplayName})).done(function(e){t(e)});return this.createPureComputed(function(){return t()||T.strings.sites})};return e}(d.default);t.default=u});define("afi",["require","exports","afl","b5","afk","afj"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-inline-create-folder",template:e("afk"),viewModel:i.default,synchronous:!0});t.default=n});define("afl",["require","exports","ap","aq","bX","cE","ae0","eX","cJ","V","bF","lB"],function(e,t,i,n,o,a,s,l,c,d,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.namePlaceholder=s.strings.FolderNamePlaceholder;t.nameLabel=s.strings.FolderNameLabel;t.createLabel=s.strings.CreateFolderLabel;t.newFolderText=s.strings.NewFolderText;t.loadingSpinnerTagName=u.default.tagName;t.height=(e.height||38).toString()+"px";t.inputHeight=(e.height||32).toString()+"px";t._newFolderItem=e.newFolderItem;t._newItemFocused=e.newItemFocused;t.focused=e.focused;t._item=e.item;t.newFolderName=n.observable("");t.isFolderCreating=n.observable(!1);t.showAddFolderText=n.observable(!0);t.inputFocused=n.observable(!1);t._createActionStatus=n.observable("");t.errorText=n.observable("");t.successText=n.observable("");t.addBindingHandlers({keyboard:c.default});t._itemProvider=t.resources.consume(l.resourceKey);t._actionMap=t.resources.consume(o.actionMap);t._engagement=t.resources.consume(a.resourceKey);if(e.isActive){var i=new(t.managed(t._actionMap.CreateFolderAction))({item:n.observable(t._item)});t.createComputed(function(){e.isActive(i.isAvailable())})}return t}e.prototype.onEnterAddFolder=function(){this._newItemFocused&&this._newItemFocused(!0);this.onClickAddFolder()};e.prototype.onClickAddFolder=function(){this._engagement.logData({name:"InlineCreateFolder.NewFolder.Click",isIntentional:!0});this.showAddFolderText(!1);this.inputFocused(!0)};e.prototype.onExecuteClick=function(e,t){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Click",isIntentional:!0});this.createNewFolder(t)};e.prototype.onEnter=function(e,t){if(0!==this.newFolderName().length){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Enter",isIntentional:!0});this.createNewFolder(t);return!1}};e.prototype.onEscape=function(e,t){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Dismiss",isIntentional:!0});this._resetControl();t.stopPropagation();return!1};e.prototype.createNewFolder=function(e){var n=this;this.isFolderCreating(!0);this.inputFocused(!1);this.errorText("");var t={parentKey:this._item.key},i={status:this._createActionStatus};new(this.managed(this._actionMap.CreateNewFolderAction))({parentItem:this._item,newFolderName:this.newFolderName,options:i}).execute(e).then(function(){if(n._createActionStatus()){n.errorText(n._createActionStatus());n.isFolderCreating(!1)}else{n.successText(d.format(s.strings.CreateFolderSuccess,n.newFolderName.peek()));if(n._newFolderItem)n._itemProvider.getItem(t).then(function(e){for(var t=e.content().items,i=0;i<t.length;i++){var r=t[i]();if(r.displayName===n.newFolderName.peek()){n._resetControl();n._newFolderItem(r);n._itemProvider.invalidateItem(n._item.key)}}});else{n._resetControl();n._newFolderItem()}}});e.stopPropagation();return!1};e.prototype._resetControl=function(){this.showAddFolderText(!0);this.newFolderName("");this.isFolderCreating(!1);this.errorText("");this.focused(!1)};return e}(r.default);t.default=p});define("afk",[],function(){return'<div class=od-InlineCreateFolder data-bind="attr: { \'aria-label\': newFolderText }, css: {\'is-focused\': focused }, style: { height: height }">\x3c!--ko if: isFolderCreating--\x3e<span class=od-InlineCreateFolder-icon data-bind="component: {name: loadingSpinnerTagName, params: { loadingText: \'\' }}"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot: isFolderCreating--\x3e<i class="od-InlineCreateFolder-icon ms-Icon ms-Icon--FabricNewFolder" data-bind="icon: true"></i>\x3c!--/ko--\x3e\x3c!--ko if: showAddFolderText--\x3e<span role=button tabindex=0 class=od-InlineCreateFolder-addFolderText data-bind="text: newFolderText, click: onClickAddFolder, keyboard: { allowInputEvents: true, mappings: { Enter: onEnterAddFolder, Space: onEnterAddFolder } }, hasFocus: focused"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot: showAddFolderText--\x3e<input class=od-InlineCreateFolder-textInput type=text data-bind="value: newFolderName, textInput: newFolderName, keyboard: { allowInputEvents: true, mappings: { Enter: onEnter, Esc: onEscape } }, attr: { maxlength: 255, placeholder: namePlaceholder, \'aria-label\': namePlaceholder, \'aria-busy\': isFolderCreating }, hasFocus: inputFocused, automation: automationId, style: { height: inputHeight }, enable: !isFolderCreating()"> <button class="od-Button od-Button--primary od-InlineCreateFolder-createButton" data-bind="style: { visibility : newFolderName() ? \'\' : \'hidden\' }, click: onExecuteClick, attr: { \'aria-label\': createLabel }, css: { \'is-disabled\': isFolderCreating }"><span class="ms-Icon ms-Icon--CheckMark od-InlineCreateFolder-createButtonIcon" data-bind="icon: true"></span></button>\x3c!--/ko--\x3e</div>\x3c!--ko if: errorText--\x3e<div class=od-InlineCreateFolder-error aria-live=assertive data-bind="text: errorText"></div>\x3c!--/ko--\x3e\x3c!--ko if: successText--\x3e<div class=ms-accessible aria-live=polite data-bind="text: successText"></div>\x3c!--/ko--\x3e'});define("afj",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-FolderSelect-panel{position:absolute;top:0;height:100%;width:100%}[dir=ltr] .od-FolderSelect-panel{left:0}[dir=rtl] .od-FolderSelect-panel{right:0}.od-FolderSelect-region{padding-top:15px}[dir=ltr] .od-FolderSelect-region{padding-left:40px}[dir=rtl] .od-FolderSelect-region{padding-right:40px}.od-FolderSelect-loading{padding-top:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:'}.od-FolderSelect-title{font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400}.od-FolderSelect-title-fileInfo{font-size:14px;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:20px}[dir=ltr] .od-FolderSelect-title-fileInfo{padding-right:40px}[dir=rtl] .od-FolderSelect-title-fileInfo{padding-left:40px}.od-FolderSelect-breadCrumbContainer{padding:10px 40px 10px 0;font-size:14px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;cursor:default}html[dir=rtl] .od-FolderSelect-breadCrumbContainer{padding:10px 0 10px 40px}[dir=ltr] .od-FolderSelect-breadCrumbContainer{margin-left:-4px}[dir=rtl] .od-FolderSelect-breadCrumbContainer{margin-right:-4px}.od-FolderSelect-breadCrumbItem{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 4px;padding-bottom:2px;height:30px;line-height:30px}.od-FolderSelect-clickableCrumb{cursor:pointer}.od--isNonMobile .od-FolderSelect-clickableCrumb:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.od-FolderSelect-breadCrumbRootIcon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:10px;height:30px;line-height:30px;font-weight:800}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-right:4px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-left:4px}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-left:2px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-right:2px}.od-FolderSelect-breadCrumbIcon{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:10px;font-weight:800;padding:0}.od-FolderSelect-ruledLine{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-FolderSelect-ruledLine{margin-left:-40px}[dir=rtl] .od-FolderSelect-ruledLine{margin-right:-40px}.od-FolderSelect-sectionHeader{margin-top:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-destinationHeader{padding-bottom:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-waitingForData{padding-top:10px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px}.od-FolderSelect-sectionContainer{padding-bottom:10px}.od-FolderSelect-itemsContainer{margin-top:10px;outline:0}.od-FolderSelect-itemsRegion{overflow-y:auto;overflow-x:hidden}[dir=ltr] .od-FolderSelect-itemsRegion{padding-left:40px}[dir=rtl] .od-FolderSelect-itemsRegion{padding-right:40px}.od-FolderSelect-addTopMargin{margin-top:10px}.od-FolderSelect-addBottomMargin{margin-bottom:10px}.od-FolderSelect-itemContainer,.od-FolderSelect-showMore{overflow:hidden;height:28px;padding-top:5px;padding-bottom:5px;width:100%;white-space:nowrap;text-overflow:ellipsis;min-height:28px}.od-FolderSelect-itemContainer .ms-Icon--OneDrive{vertical-align:top;line-height:28px;width:28px}.sm .od-FolderSelect-itemContainer .ms-Icon--OneDrive{line-height:20px}[dir=ltr] .od-FolderSelect-itemWrapper{padding-right:40px}[dir=rtl] .od-FolderSelect-itemWrapper{padding-left:40px}.od-folderSelect-showMoreExtra{display:block;font-size:13px;line-height:28px}.od-FolderSelect-showMoreLoading{padding-top:5px;padding-bottom:5px}.od-FolderSelect-clickable{cursor:pointer}[dir=ltr] .od-FolderSelect-clickable{padding-left:5px}[dir=rtl] .od-FolderSelect-clickable{padding-right:5px}[dir=ltr] .od-FolderSelect-clickable{margin-left:-5px}[dir=rtl] .od-FolderSelect-clickable{margin-right:-5px}.od-FolderSelect-clickable .ms-Icon--OneDrive{color:#094ab2;font-size:23px;padding-top:0;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:3px}[dir=rtl] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:3px}.od-FolderSelect-clickable .od-FolderSelect-itemTitle{font-size:14px;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-left:8px}[dir=rtl] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-right:8px}.od-FolderSelect-clickable:focus{outline:1px solid transparent;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-FolderSelect-clickable:focus{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderSelect-clickable:focus{background:#00c0ff}}.od-FolderSelect-clickable.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.od--isNonMobile .od-FolderSelect-clickable:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.od-FolderSelect-folderIcon{width:28px;text-align:center;display:inline-block}.od-FolderSelect-siteIcon{position:relative;display:inline-block;vertical-align:top;width:28px;height:28px}[dir=ltr] .od-FolderSelect-stickyFooter{padding-left:40px}[dir=rtl] .od-FolderSelect-stickyFooter{padding-right:40px}.od-FolderSelect-statusLabel{font-size:14px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";padding-top:15px}[dir=ltr] .od-FolderSelect-statusLabel{padding-right:40px}[dir=rtl] .od-FolderSelect-statusLabel{padding-left:40px}.od-folderSelect-itemError{color:#a80000;font-size:13px;margin-top:10px}[dir=ltr] .od-folderSelect-itemError{padding-right:40px}[dir=rtl] .od-folderSelect-itemError{padding-left:40px}.od-folderSelect-itemInfo{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px}[dir=ltr] .od-folderSelect-itemInfo{padding-right:40px}[dir=rtl] .od-folderSelect-itemInfo{padding-left:40px}[dir=ltr] .od-folderSelect-itemErrorPadding{padding-left:40px}[dir=rtl] .od-folderSelect-itemErrorPadding{padding-right:40px}.od-FolderSelect-addFolder{margin-bottom:10px}.od-FolderSelect-hidden{display:none}.od-FolderSelect-addFolderContainer{min-height:38px}.od-FolderSelect-actionContainer{padding-top:20px;padding-bottom:20px;white-space:nowrap}.od-FolderSelect-itemAnimation{width:100%;position:absolute;transition:left .3s,right .3s;-webkit-transition:left .3s,right .3s}[dir=ltr] .od-FolderSelect-itemEnterLeft{left:-300px}[dir=rtl] .od-FolderSelect-itemEnterLeft{right:-300px}[dir=ltr] .od-FolderSelect-itemEnterRight{left:300px}[dir=rtl] .od-FolderSelect-itemEnterRight{right:300px}[dir=ltr] .od-FolderSelect-itemInitial{left:0}[dir=rtl] .od-FolderSelect-itemInitial{right:0}.od-FolderSelect-infoBar{padding-top:10px;cursor:default}[dir=ltr] .od-FolderSelect-infoBar{padding-right:40px}[dir=rtl] .od-FolderSelect-infoBar{padding-left:40px}.od-FolderSelect-infoBarClickable{cursor:pointer}.od-FolderSelect-sharingHint{width:32px;height:32px;padding:0 10px;background-color:transparent;margin:0 10px;border:none}html[dir=ltr] .od-FolderSelect-sharingHint{float:right}html[dir=rtl] .od-FolderSelect-sharingHint{float:left}html[dir=ltr] .od-FolderSelect-sharingHintTooltip{float:right}html[dir=rtl] .od-FolderSelect-sharingHintTooltip{float:left}.od-FolderSelect-sharingHintIcon{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";size:16pt;position:relative;cursor:pointer;padding:8px}[dir=ltr] .od-FolderSelect-sharingHintIcon{right:9px}[dir=rtl] .od-FolderSelect-sharingHintIcon{left:9px}.od-FolderSelect-sharingInfoText{width:150px;word-wrap:break-word}html[dir=ltr] .od-FolderSelect-sharingInfoText{text-align:left}html[dir=rtl] .od-FolderSelect-sharingInfoText{text-align:right}.od-FolderSelect-fileItemName{vertical-align:bottom}.od-InlineCreateFolder{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;cursor:pointer}.od-InlineCreateFolder.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent;background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-InlineCreateFolder.is-focused{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-InlineCreateFolder.is-focused{background:#00c0ff}}.od-InlineCreateFolder.is-focused .od-InlineCreateFolder-addFolderText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-InlineCreateFolder-textInput{-ms-flex-positive:1;flex-grow:1;font-size:14px;border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";outline:1px solid transparent;box-sizing:border-box;min-width:100px}[dir=ltr] .od-InlineCreateFolder-textInput{padding-left:10px}[dir=rtl] .od-InlineCreateFolder-textInput{padding-right:10px}[dir=ltr] .od-InlineCreateFolder-textInput{margin-left:7px}[dir=rtl] .od-InlineCreateFolder-textInput{margin-right:7px}.od-InlineCreateFolder-textInput:focus,.od-InlineCreateFolder-textInput:hover{outline:1px solid transparent;border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-InlineCreateFolder-createButton{display:inline-block;width:32px;min-width:32px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:0 0 3px 0}[dir=ltr] .od-InlineCreateFolder-createButton{margin-right:5px}[dir=rtl] .od-InlineCreateFolder-createButton{margin-left:5px}.od-InlineCreateFolder-createButtonIcon{font-size:18px;vertical-align:middle}.od-InlineCreateFolder-addFolderText{-ms-flex-positive:1;flex-grow:1;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";font-size:14px;cursor:pointer;outline:0}[dir=ltr] .od-InlineCreateFolder-addFolderText{padding-left:10px}[dir=rtl] .od-InlineCreateFolder-addFolderText{padding-right:10px}.od-InlineCreateFolder-icon{width:30px;min-width:30px;text-align:center;font-size:16px;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";padding-top:2px;position:relative}[dir=ltr] .od-InlineCreateFolder-icon{left:-1px}[dir=rtl] .od-InlineCreateFolder-icon{right:-1px}.od-InlineCreateFolder-icon .od-LoadingSpinner-loadingGif{vertical-align:inherit}.od-InlineCreateFolder-error{font-size:12px;color:#a80000}[dir=ltr] .od-InlineCreateFolder-error{padding-left:38px}[dir=rtl] .od-InlineCreateFolder-error{padding-right:38px}"}])});define("acB",["require","exports","acE","b5","acD","acC"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-infoBar",template:e("acD"),viewModel:i.default,synchronous:!0});t.default=n});define("acE",["require","exports","ap","qH","aq","bF","d"],function(e,t,r,n,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.infoText=e.infoText;t.clickHandler=e.clickHandler;t._initInfoBarClasses();t.iconClass=o.observable("");t.infoBarClass=o.observable("");t.createComputed(function(){t.infoBarClass(t._infoBarClasses[e.type()].infoBarClass);t.iconClass(t._infoBarClasses[e.type()].iconClass)});e.linkText&&e.linkUrl;t.addBindingHandlers({bindableHtml:n.default});return t}e.prototype._initInfoBarClasses=function(){this._infoBarClasses=((e={})[0]={iconClass:a.getIconClassName("Info"),infoBarClass:"ms-bgColor-info"},e[1]={iconClass:a.getIconClassName("Info"),infoBarClass:""},e[2]={iconClass:"od-InfoBar-iconPlaceholder",infoBarClass:"ms-bgColor-success"},e[3]={iconClass:a.getIconClassName("Warning")+" ms-fontColor-alert",infoBarClass:"od-InfoBar-alert"},e[4]={iconClass:a.getIconClassName("DRM")+" ms-fontColor-error",infoBarClass:"ms-bgColor-error"},e[5]={iconClass:a.getIconClassName("ErrorBadge")+" ms-fontColor-error",infoBarClass:"ms-bgColor-info"},e);var e};return e}(i.default);t.default=s});define("acD",[],function(){return'<div class=od-InfoBar data-bind="class: infoBarClass"><i class="od-InfoBar-icon ms-Icon" data-bind="class: iconClass"></i> <span class=od-InfoBar-text data-bind="bindableHtml: infoText"></span></div>'});define("acC",["c","az"],function(e,t){e.loadStyles([{rawString:".od-InfoBar{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding:6px 8px 8px 8px;display:-ms-flexbox;display:flex;-ms-flex-align:start;align-items:flex-start}html[dir=rtl] .od-InfoBar{padding:6px 8px 8px 8px}.od-InfoBar-icon{font-size:16px;padding-top:2px}[dir=ltr] .od-InfoBar-icon{padding-left:1px}[dir=rtl] .od-InfoBar-icon{padding-right:1px}.od-InfoBar-iconPlaceholder{width:31px}.od-InfoBar-alert{background-color:#fed9cc}.od-InfoBar-text{font-size:12px}[dir=ltr] .od-InfoBar-text{padding-left:8px}[dir=rtl] .od-InfoBar-text{padding-right:8px}"}])});define("afh",["require","exports","ap","bH","aq"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=n.unwrap(t.valueAccessor());t._scrollContainer=i.scrollableElement();t._forceResize=i.forceResize;t._forceResize(!1);t.events.on(window,"resize",t._sizeContainer);t.subscribe(t._forceResize,t._forceResizeContainer);t._sizeContainer();return t}e.prototype._forceResizeContainer=function(){if(this._forceResize()){this._sizeContainer();this._forceResize(!1)}};e.prototype._sizeContainer=function(){var e=window.innerHeight,t=this._scrollContainer.getBoundingClientRect(),i=this.element.offsetHeight,r=e-t.top-i;this._scrollContainer.style.maxHeight=r.toString()+"px"};return e}(r.default);t.default=o});define("afc",["require","exports","aff","b5","afe","afd"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-stillSpinning",template:e("afe"),viewModel:i.default});t.default=n});define("aff",["require","exports","ap","aq","bF","afg","Sf","d0","lB"],function(n,e,t,o,i,a,s,l,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(i){t.__extends(r,i);function r(e){var t=i.call(this,e)||this;t.addBindingHandlers({visibility:s.default});t.params=e;t.resx=a.strings;t.showControl=t.params.showControl||o.observable(!0);t.showSpinner=o.observable(!1);t.showStillWaiting=o.observable(!1);t.showError=o.observable(!1);t.errorImgUrl="undefined"==typeof __webpack_public_path__?n.toUrl("odsp-media/images/sitehub/error_icecream.png"):n("@ms/odsp-media/dist/media/images/siteHub/error_icecream.png");t.spinnerTagName=0===t.params.spinnerType?c.default.tagName:l.default.tagName;t.spinnerParams=0===t.params.spinnerType?{loadingText:""}:{};t._spinnerTimeoutId=t.async.setTimeout(function(){t.showSpinner(!0);var e=t.params.stillWaitingTimeout;e?t._stillWaitingTimeoutId=t.async.setTimeout(function(){t.showStillWaiting(!0);t._startErrorTimeout()},e):t._startErrorTimeout()},t.params.spinnerTimeout||r.SPINNER_TIMEOUT);t.params.promise.then(function(e){t.showControl(!1);t._clearDataSourceTimeouts()},function(e){t.showSpinner(!1);t.showStillWaiting(!1);t.showError(!0);t._clearDataSourceTimeouts()});return t}r.prototype._startErrorTimeout=function(){var e=this;this.params.errorTimeout&&(this._errorTimeoutId=this.async.setTimeout(function(){e.showSpinner(!1);e.showStillWaiting(!1);e.showError(!0)},this.params.errorTimeout))};r.prototype._clearDataSourceTimeouts=function(){this._spinnerTimeoutId&&this.async.clearTimeout(this._spinnerTimeoutId);this._stillWaitingTimeoutId&&this.async.clearTimeout(this._stillWaitingTimeoutId);this._errorTimeoutId&&this.async.clearTimeout(this._errorTimeoutId)};r.SPINNER_TIMEOUT=1e3;return r}(i.default);e.default=r});define("afe",[],function(){return'<div data-bind="if: showControl()"><div data-bind="component: {name: spinnerTagName, params: spinnerParams }, visibility: showSpinner()"></div>\x3c!--ko if: showStillWaiting()--\x3e<div class=od-StillSpinning-text aria-live=polite data-bind="text: resx.StillWaiting"></div>\x3c!--/ko--\x3e\x3c!--ko if: showError()--\x3e<div class=od-StillSpinning-error><img class=od-StillSpinning-imgError role=presentation data-bind="attr: {src: errorImgUrl}"><div class="ms-fontWeight-semibold ms-font-l ms-fontColor-neutralSecondary" data-bind="text: resx.Error"></div><div class="ms-font-s ms-fontColor-neutralSecondary" data-bind="text: resx.Refresh"></div></div>\x3c!--/ko--\x3e</div>'});define("afd",["c","az"],function(e,t){e.loadStyles([{rawString:".od-StillSpinning-text{text-align:center;padding-top:10px}.od-StillSpinning-error{text-align:center}.od-StillSpinning-imgError{padding-bottom:10px}"}])});define("Aa",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["HTTP:","HTTPS:"];t.getSafeAbsoluteWebUrl=function(e){void 0===e&&(e="");var t=e.toUpperCase();return i.filter(function(e){return 0===t.indexOf(e)}).length?e:void 0};t.isGallatin=function(){return location.origin.indexOf(".cn")===location.origin.length-3}});define("afa",[],function(){return'<div class=od-FolderSelect-panel><div class=od-FolderSelect-region><div class=od-FolderSelect-title data-bind="text: moveCopyText"></div><div class=ms-accessible data-bind="text: titleAccessibilityHint"></div><div class=od-FolderSelect-title-fileInfo>\x3c!--ko if: isSingleItem--\x3e\x3c!--ko component: { name: \'ms-fileName-with-icon\', params: { oneDriveItem: fileItem} }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: packageTooBig--\x3e<div class=od-FolderSelect-infoBar data-bind="css: { \'od-FolderSelect-infoBarClickable\': showMinimalPackageWarning }, component: {name: infoBarTagName, params: infoBarParams}, click: onInfoBarClick"></div><div class=ms-accessible aria-live=polite data-bind="text: packageSizeWarning"></div>\x3c!--/ko--\x3e<div class=od-FolderSelect-breadCrumbContainer><span class="od-FolderSelect-breadCrumbRootIcon od-FolderSelect-clickableCrumb" role=button data-bind="click: onBreadCrumbRootClick, keyboard: { mappings: { Enter: onBreadCrumbRootClick, Space: onBreadCrumbRootClick } }, style: { display: hasBackToRootButton() ? \'\' : \'none\' }, attr: { title: placesAltText, tabindex: hasBackToRootButton() ? 0 : -1 , \'aria-label\': placesAltText }"><i class="ms-Icon ms-Icon--DoubleChevronLeft" data-bind="icon: true"></i></span> <span class="od-FolderSelect-breadCrumbItem ms-fontWeight-semilight" role=button data-bind="text: parentFolderName, class: parentBreadCrumbClass, click: onBreadCrumbParentClick, keyboard: { mappings: { Enter: onBreadCrumbParentClick, Space: onBreadCrumbParentClick } }, style: { display: parentFolderName() ? \'\' : \'none\' }, attr: { title: parentFolderName, tabindex: isParentBreadCrumbClickable() ? 0 : -1 , \'aria-label\': parentFolderName}"></span> <i class="od-FolderSelect-breadCrumbIcon ms-Icon ms-Icon--ChevronRight" data-bind="style: {display: parentFolderName() ? \'\' : \'none\'}" aria-hidden=true></i> <span class="od-FolderSelect-breadCrumbItem ms-fontWeight-semibold" data-bind="text: currentFolderName, attr: { title: currentFolderName }"></span></div><div class=od-FolderSelect-ruledLine aria-hidden=true></div>\x3c!--ko if:loading--\x3e<div class=od-FolderSelect-loading data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e\x3c!--ko if: itemOne.isActive()--\x3e<div data-bind="automationType: \'FolderSelectContent\', template: { name: \'od-folder-select-content\', data: itemOne, afterRender: itemOne.resizeStickyFooter.bind(true) }"></div>\x3c!--/ko--\x3e\x3c!--ko if: itemTwo.isActive()--\x3e<div data-bind="automationType: \'FolderSelectContent\', template: { name: \'od-folder-select-content\', data: itemTwo, afterRender: itemTwo.resizeStickyFooter.bind(true) }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: waitingForItem--\x3e<div class=od-FolderSelect-waitingForData data-bind="component: {name: stillSpinningTagName, params: waitingForItemParams}"></div>\x3c!--/ko--\x3e</div>'});define("ae9",[],function(){return'<div class=od-FolderSelect-itemAnimation data-bind="class: className, element: element">\x3c!--ko if: item().error--\x3e<div class="od-folderSelect-itemError od-folderSelect-itemErrorPadding" aria-live=assertive data-bind="text: item().error"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: item().error--\x3e\x3c!--ko if: item().sections--\x3e<div class=od-FolderSelect-itemsRegion data-bind="element: regionElement"><div class=od-FolderSelect-sectionContainer data-bind="foreach: item().sections">\x3c!--ko if: title--\x3e<div class=od-FolderSelect-sectionHeader data-bind="text: title"></div>\x3c!--/ko--\x3e<div class=od-FolderSelect-itemsContainer tabindex=0 role=list data-bind="foreach: items, element: listElement, attr: { tabindex: focusedItem() ? -1 : 0, \'aria-label\': altTitle }, selection: { data: items, mode: \'single\', direction: \'vertical\', focused: focusedItem, selectFirstItemOnActivate: true, clearSelectionOnRemoval: true }"><div class=od-FolderSelect-itemWrapper><div class="od-FolderSelect-itemContainer od-FolderSelect-clickable" role=listitem data-bind="click: $component.onItemClick.bind($data), keyboard: { mappings: { Enter: $component.onKeyEnter, Space: $component.onKeyEnter }}, css: {\'is-focused\': focused }, attr: { tabindex: focused() || selected() ? 0 : -1, \'aria-label\': title }, hasFocus: focused"><i role=presentation class="ms-Icon ms-Icon--OneDrive" data-bind="icon: true, style: {display: $component.isOneDrive($data) ? \'\' : \'none\'}"></i>\x3c!--ko if: $component.isSite($data)--\x3e<span class=od-FolderSelect-siteIcon data-bind="component: { name: $component.siteIconTagName, params: siteIcon }"></span>\x3c!--/ko--\x3e\x3c!--ko if: $component.isLibraryOrFolder($data)--\x3e<span class=od-FolderSelect-folderIcon data-bind="component: { name: $component.fileTypeIconTagName, params: { iconName: folderIcon, desiredSize: 16 } }"></span>\x3c!--/ko--\x3e<span class=od-FolderSelect-itemTitle data-bind="text: title"></span></div></div></div>\x3c!--ko if: showMoreInfo--\x3e<div class=od-folderSelect-itemInfo aria-live=polite data-bind="text: showMoreInfo"></div>\x3c!--/ko--\x3e\x3c!--ko if: showMoreError--\x3e<div class=od-folderSelect-itemError aria-live=assertive data-bind="text: showMoreError"></div>\x3c!--/ko--\x3e\x3c!--ko if: showMore--\x3e<div>\x3c!--ko ifnot: showMoreLoading()--\x3e<div class=od-FolderSelect-itemWrapper><a class="od-FolderSelect-showMore od-folderSelect-showMoreExtra od-FolderSelect-clickable" role=button tabindex=0 data-bind="click: $component.onShowMoreClick.bind($data), keyboard: { mappings: { Enter: $component.onShowMoreClick.bind($data), Space: $component.onShowMoreClick.bind($data) }}, css: {\'is-focused\': showMoreFocused }, attr: { \'aria-label\': $component.getShowMoreAccText($data) }, hasFocus: showMoreFocused, text: $component.getShowMoreText($data), automationType: \'FolderSelectShowMoreSites\'"></a></div>\x3c!--/ko--\x3e\x3c!--ko if: showMoreLoading--\x3e<div class=od-FolderSelect-showMoreLoading aria-busy=true data-bind="component: {name: $component.loadingSpinnerTagName, params: { loadingText: \'\' }}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if: item().subItems--\x3e<div class=od-FolderSelect-itemsRegion data-bind="element: regionElement">\x3c!--ko if: item().subItems().length > 0--\x3e<div class=od-FolderSelect-itemsContainer role=list data-bind="foreach: item().subItems, element: listElement, selection: { data: item().subItems, mode: \'single\', direction: \'vertical\', focused: $component.focusedItem, selectionModel: $component.selectionModel, selectFirstItemOnActivate: true, clearSelectionOnRemoval: true }, attr: { \'aria-label\': $component.getListType(item()), tabindex: $component.selectionModel.selection().length > 0 ? -1 : 0, }, css: { \'od-FolderSelect-addBottomMargin\' : !$component.showAddFolder() }">\x3c!--ko if: $index() === 0--\x3e<div class=od-FolderSelect-destinationHeader data-bind="text: $component.chooseDestination"></div>\x3c!--/ko--\x3e<div class=od-FolderSelect-itemWrapper><div class="od-FolderSelect-itemContainer od-FolderSelect-clickable" role=listitem data-bind="click: $component.onItemClick.bind($data), keyboard: { mappings: { Enter: $component.onKeyEnter, Space: $component.onKeyEnter }}, css: {\'is-focused\': focused, \'is-selected\': selected}, attr: { tabindex: focused() || selected() ? 0 : -1, \'aria-label\': title}, hasFocus: focused"><span class=od-FolderSelect-folderIcon data-bind="component: { name: $component.fileTypeIconTagName, params: { iconName: folderIcon, desiredSize: 16 } }"></span> <span class=od-FolderSelect-itemTitle data-bind="text: title"></span></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.showAddFolder()--\x3e<div class=od-FolderSelect-addFolder data-bind="css: { \'od-FolderSelect-addTopMargin\' : item().subItems().length === 0 }"><div class=od-FolderSelect-itemWrapper data-bind="css: { \'od-FolderSelect-hidden\': !$component.newFolderActive() }"><div class="od-FolderSelect-addFolderContainer od-FolderSelect-clickable" data-bind="component: { name: $component.inlineCreateFolderTagName, params: { item: $component.getCurrentItem().oneDriveItem, newFolderItem: $component.newFolderItem, focused: $component.addFolderFocused, newItemFocused: $component.newFolderItemFocused, isActive: $component.newFolderActive }}"></div></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class=od-FolderSelect-stickyFooter data-bind="stickyFooter: { scrollableElement: regionElement, forceResize: resizeStickyFooter }">\x3c!--ko if: $component.showBottomLine(item())--\x3e<div class=od-FolderSelect-ruledLine role=separator aria-hidden=true></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.getStatusText(item())--\x3e<div class=od-FolderSelect-statusLabel><span role=status data-bind="text: $component.getStatusText(item())"></span></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.isLibraryOrFolderOrOneDrive(item())--\x3e<div class=od-FolderSelect-actionContainer><button class="od-Button od-Button--primary" data-bind="click: $component.onUseLocationClick, enable: $component.chooseLocationButtonEnabled, automationType: \'FolderSelectUseLocation\', delayedHasFocus: $component.useLocationFocused, attr: { \'aria-label\': $component.getChooseLocationAccText(item()) }"><span class=od-Button-label data-bind="text: $component.chooseLocationText"></span></button>\x3c!--ko if: $component.isSharingHintVisible()--\x3e<button class=od-FolderSelect-sharingHint data-bind="click: $component.showSharingHint, event: { mouseover: $component.showSharingHint, mouseout: $component.dismissSharingHint }, element: $component.sharingHintIcon, hasFocus: $component.isSharingIconFocused, attr: { \'aria-label\': $component.sharingInfoText }">\x3c!--ko if: $component.showSharingHintTooltip()--\x3e<div class=od-FolderSelect-sharingHintTooltip><div data-bind="component: { name: \'ms-anchor-overlay\', params: { anchorElement: $component.sharingHintIcon, alignment: \'BottomRight\', allowMenuNudging: false, hasExplicitAlignment: true, isBeakVisible: ko.observable(true), offset: $component.sharingHintOffset, top: $component.top, left: $component.left }}"><div class=od-FolderSelect-sharingInfoText data-bind="text: $component.sharingInfoText"></div></div></div>\x3c!--/ko--\x3e<div class="od-FolderSelect-sharingHintIcon ms-Icon ms-Icon--People" data-bind="icon: true"></div></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});define("ae8",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-FolderSelect-panel{position:absolute;top:0;height:100%;width:100%}[dir=ltr] .od-FolderSelect-panel{left:0}[dir=rtl] .od-FolderSelect-panel{right:0}.od-FolderSelect-region{padding-top:15px}[dir=ltr] .od-FolderSelect-region{padding-left:40px}[dir=rtl] .od-FolderSelect-region{padding-right:40px}.od-FolderSelect-loading{padding-top:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:'}.od-FolderSelect-title{font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400}.od-FolderSelect-title-fileInfo{font-size:14px;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:20px}[dir=ltr] .od-FolderSelect-title-fileInfo{padding-right:40px}[dir=rtl] .od-FolderSelect-title-fileInfo{padding-left:40px}.od-FolderSelect-breadCrumbContainer{padding:10px 40px 10px 0;font-size:14px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;cursor:default}html[dir=rtl] .od-FolderSelect-breadCrumbContainer{padding:10px 0 10px 40px}[dir=ltr] .od-FolderSelect-breadCrumbContainer{margin-left:-4px}[dir=rtl] .od-FolderSelect-breadCrumbContainer{margin-right:-4px}.od-FolderSelect-breadCrumbItem{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 4px;padding-bottom:2px;height:30px;line-height:30px}.od-FolderSelect-clickableCrumb{cursor:pointer}.od--isNonMobile .od-FolderSelect-clickableCrumb:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.od-FolderSelect-breadCrumbRootIcon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:10px;height:30px;line-height:30px;font-weight:800}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-right:4px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-left:4px}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-left:2px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-right:2px}.od-FolderSelect-breadCrumbIcon{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:10px;font-weight:800;padding:0}.od-FolderSelect-ruledLine{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-FolderSelect-ruledLine{margin-left:-40px}[dir=rtl] .od-FolderSelect-ruledLine{margin-right:-40px}.od-FolderSelect-sectionHeader{margin-top:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-destinationHeader{padding-bottom:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-waitingForData{padding-top:10px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px}.od-FolderSelect-sectionContainer{padding-bottom:10px}.od-FolderSelect-itemsContainer{margin-top:10px;outline:0}.od-FolderSelect-itemsRegion{overflow-y:auto;overflow-x:hidden}[dir=ltr] .od-FolderSelect-itemsRegion{padding-left:40px}[dir=rtl] .od-FolderSelect-itemsRegion{padding-right:40px}.od-FolderSelect-addTopMargin{margin-top:10px}.od-FolderSelect-addBottomMargin{margin-bottom:10px}.od-FolderSelect-itemContainer,.od-FolderSelect-showMore{overflow:hidden;height:28px;padding-top:5px;padding-bottom:5px;width:100%;white-space:nowrap;text-overflow:ellipsis;min-height:28px}.od-FolderSelect-itemContainer .ms-Icon--OneDrive{vertical-align:top;line-height:28px;width:28px}.sm .od-FolderSelect-itemContainer .ms-Icon--OneDrive{line-height:20px}[dir=ltr] .od-FolderSelect-itemWrapper{padding-right:40px}[dir=rtl] .od-FolderSelect-itemWrapper{padding-left:40px}.od-folderSelect-showMoreExtra{display:block;font-size:13px;line-height:28px}.od-FolderSelect-showMoreLoading{padding-top:5px;padding-bottom:5px}.od-FolderSelect-clickable{cursor:pointer}[dir=ltr] .od-FolderSelect-clickable{padding-left:5px}[dir=rtl] .od-FolderSelect-clickable{padding-right:5px}[dir=ltr] .od-FolderSelect-clickable{margin-left:-5px}[dir=rtl] .od-FolderSelect-clickable{margin-right:-5px}.od-FolderSelect-clickable .ms-Icon--OneDrive{color:#094ab2;font-size:23px;padding-top:0;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:3px}[dir=rtl] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:3px}.od-FolderSelect-clickable .od-FolderSelect-itemTitle{font-size:14px;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-left:8px}[dir=rtl] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-right:8px}.od-FolderSelect-clickable:focus{outline:1px solid transparent;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-FolderSelect-clickable:focus{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderSelect-clickable:focus{background:#00c0ff}}.od-FolderSelect-clickable.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.od--isNonMobile .od-FolderSelect-clickable:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.od-FolderSelect-folderIcon{width:28px;text-align:center;display:inline-block}.od-FolderSelect-siteIcon{position:relative;display:inline-block;vertical-align:top;width:28px;height:28px}[dir=ltr] .od-FolderSelect-stickyFooter{padding-left:40px}[dir=rtl] .od-FolderSelect-stickyFooter{padding-right:40px}.od-FolderSelect-statusLabel{font-size:14px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";padding-top:15px}[dir=ltr] .od-FolderSelect-statusLabel{padding-right:40px}[dir=rtl] .od-FolderSelect-statusLabel{padding-left:40px}.od-folderSelect-itemError{color:#a80000;font-size:13px;margin-top:10px}[dir=ltr] .od-folderSelect-itemError{padding-right:40px}[dir=rtl] .od-folderSelect-itemError{padding-left:40px}.od-folderSelect-itemInfo{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px}[dir=ltr] .od-folderSelect-itemInfo{padding-right:40px}[dir=rtl] .od-folderSelect-itemInfo{padding-left:40px}[dir=ltr] .od-folderSelect-itemErrorPadding{padding-left:40px}[dir=rtl] .od-folderSelect-itemErrorPadding{padding-right:40px}.od-FolderSelect-addFolder{margin-bottom:10px}.od-FolderSelect-hidden{display:none}.od-FolderSelect-addFolderContainer{min-height:38px}.od-FolderSelect-actionContainer{padding-top:20px;padding-bottom:20px;white-space:nowrap}.od-FolderSelect-itemAnimation{width:100%;position:absolute;transition:left .3s,right .3s;-webkit-transition:left .3s,right .3s}[dir=ltr] .od-FolderSelect-itemEnterLeft{left:-300px}[dir=rtl] .od-FolderSelect-itemEnterLeft{right:-300px}[dir=ltr] .od-FolderSelect-itemEnterRight{left:300px}[dir=rtl] .od-FolderSelect-itemEnterRight{right:300px}[dir=ltr] .od-FolderSelect-itemInitial{left:0}[dir=rtl] .od-FolderSelect-itemInitial{right:0}.od-FolderSelect-infoBar{padding-top:10px;cursor:default}[dir=ltr] .od-FolderSelect-infoBar{padding-right:40px}[dir=rtl] .od-FolderSelect-infoBar{padding-left:40px}.od-FolderSelect-infoBarClickable{cursor:pointer}.od-FolderSelect-sharingHint{width:32px;height:32px;padding:0 10px;background-color:transparent;margin:0 10px;border:none}html[dir=ltr] .od-FolderSelect-sharingHint{float:right}html[dir=rtl] .od-FolderSelect-sharingHint{float:left}html[dir=ltr] .od-FolderSelect-sharingHintTooltip{float:right}html[dir=rtl] .od-FolderSelect-sharingHintTooltip{float:left}.od-FolderSelect-sharingHintIcon{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";size:16pt;position:relative;cursor:pointer;padding:8px}[dir=ltr] .od-FolderSelect-sharingHintIcon{right:9px}[dir=rtl] .od-FolderSelect-sharingHintIcon{left:9px}.od-FolderSelect-sharingInfoText{width:150px;word-wrap:break-word}html[dir=ltr] .od-FolderSelect-sharingInfoText{text-align:left}html[dir=rtl] .od-FolderSelect-sharingInfoText{text-align:right}.od-FolderSelect-fileItemName{vertical-align:bottom}"}])});define("adY",["require","exports","ad1","b5","ad0","adZ","df"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-fileName-with-icon",template:e("ad0"),viewModel:i.default,synchronous:!0});t.default=n});define("ad1",["require","exports","ap","WR","bF","df","ob"],function(e,t,i,o,r,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=16,n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this,i=e.oneDriveItem;t.fileName=i.name;t.fileTypeIconTagName=a.default.tagName;var r=t.createObservable(i);t.fileTypeIconParams={iconName:i.iconName,iconUrl:i.iconUrl,extension:i.extension,desiredSize:l,overlayType:o.default.getOverlayType(r),iconFieldAriaLabel:s.getIconFieldAriaLabelForItem(i)||"",hoverText:o.default.getHoverText(r)};return t}return e}(r.default);t.default=n});define("ad0",[],function(){return'<span><span class=od-FileNameWithIcon-icon data-bind="component: { name: fileTypeIconTagName, params: fileTypeIconParams }"></span> <span class=od-FileNameWithIcon-fileName data-bind="text: fileName"></span></span>'});define("adZ",["c","az"],function(e,t){e.loadStyles([{rawString:".od-FileNameWithIcon-fileName{vertical-align:bottom}[dir=ltr] .od-FileNameWithIcon-fileName{padding-left:3px}[dir=rtl] .od-FileNameWithIcon-fileName{padding-right:3px}.od-FileNameWithIcon-icon .FileTypeIcon{width:20px;height:20px}"}])});define("aeU",["require","exports","ae3","b5","ae2","ae1","aeW","aeV","df"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-folder-tree",template:e("ae2"),viewModel:i.default,synchronous:!0});r.registerTemplate("od-folder-tree-row",e("ae1"));t.default=n});define("ae3",["require","exports","ap","aq","bF","bX","eX","ae6","dz","cJ","dB","dZ","ae5","aC","ae4","dH","DI","gQ","ba","Ol","cL","by","lB","oy","qe","b3"],function(n,e,t,o,i,a,s,l,c,d,u,p,m,h,f,g,b,_,v,y,S,x,k,C,P,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(r){t.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._folderTreeWidth=260;t._folderTreeIndent=20;t.loadingSpinnerTagName=k.default.tagName;t.context=e.context;t.onComplete=e.onComplete;t.title=e.title;t.dataUpdated=o.observable(!1);t.isDisabled=o.observable(!1);t.isNewFolderDisabled=o.observable(!1);t.hasData=o.observable(!1);t.height=document.body.clientHeight+"px";t._platform=t.resources.consume(x.platformDetection);t.isMobile=t._platform.isMobile;t.rootFolderItem=o.observable();t.sharedFolderItem=o.observable();t.focusedItem=o.observable();t.selectedItems=o.observableArray();t.selectionModel=new u.default;t.itemArrayForSelection=o.observableArray();t.isRtl=S.default.isRightToLeft;t.loadingImageUrl="undefined"==typeof __webpack_public_path__?n.toUrl("odsp-media/images/loading/loadingspinner.gif"):n("@ms/odsp-media/dist/media/images/loading/loadingSpinner.gif");t._urlDataSource=t.resources.consume(p.url);t._moveCopyDataSource=t.resources.consume(p.copy);t.newFolderName=o.observable("");t.needsRefocus=o.observable(!1);t.loadingText=f.strings.loadingText;t.addBindingHandlers({selection:c.default,delayedHasFocus:C.default,control:I.default,keyboard:d.default});t.keyboardOptions=[{target:null,useRtlMappings:!0,mappings:{Down:t.keyDown,Up:t.keyUp,Left:t.keyLeft,Right:t.keyRight,Enter:t.onEnter}},{useRtlMappings:!0,target:window,mappings:{}}];t.subscribe(t.dataUpdated,t._updateItemSet);t.subscribe(t.needsRefocus,t._setFocus);t._itemProvider=t.resources.consume(s.resourceKey);t._actionMap=t.resources.consume(a.actionMap);t._currentSet=t.resources.consume(a.currentItemSet);t._itemSet=o.observable(null);t._sharedItemSet=o.observable(null);t._sharingProvider=t.resources.consume(b.resourceKey);t.showSharingInfo=o.observable(!1);t.sharingInfoText=o.observable("");var i=t._currentSet().item();t.showSharedRoot=t._moveCopyDataSource.getCapabilities().supportsMoveCopyOnShared&&0!==i.sharingRole&&i.queryType!==g.default.SharedWithMe;t._fetchParentItem(i);t.titleAccessibilityHint=f.strings.titleAccessibilityHint;t.commandBarSpecification=I.toSpecification(P.resourceKey,{commandSet:new(t.managed(m.default))({componentViewModel:t})});return t}e.prototype.getWidth=function(e,t,i){return e._folderTreeWidth-e._folderTreeIndent*t.level};e.prototype.onClick=function(e,t,i){e.focusedItem()&&e.focusedItem().showNewFolderInput(!1);e._selectFolder(t);if(t.isOpen()){e._closeChildren(t);e._updateSelectionArray()}else{t.isLoading(!0);e._showChildren(t)}};e.prototype.keyLeft=function(e,t){this.focusedItem().showNewFolderInput(!1);if(this.focusedItem().isOpen()){e._closeChildren(this.focusedItem());e._updateSelectionArray()}else if(this.focusedItem().parent){var i=this.focusedItem().parent;e._changeSelection(i);e._selectFolder(i)}t.stopPropagation();return!0};e.prototype.keyRight=function(e,t){this.focusedItem().showNewFolderInput(!1);if(this.focusedItem().isOpen()){if(0<this.focusedItem().children().length){var i=this.focusedItem().children()[0]();e._changeSelection(i);e._selectFolder(i)}}else{e.focusedItem().isLoading(!0);e._showChildren(this.focusedItem())}t.stopPropagation();return!0};e.prototype.keyUp=function(e,t){this.focusedItem().showNewFolderInput(!1);var i=this.itemArrayForSelection.indexOf(this.focusedItem());0!==i&&e._selectFolder(this.itemArrayForSelection()[i-1]);return!0};e.prototype.keyDown=function(e,t){this.focusedItem().showNewFolderInput(!1);var i=this.itemArrayForSelection.indexOf(this.focusedItem());i!==this.itemArrayForSelection().length-1&&e._selectFolder(this.itemArrayForSelection()[i+1]);return!0};e.prototype.onEnter=function(e,t){this.isDisabled(!0);this.isNewFolderDisabled(!0);var i={context:this.context,onComplete:this.onComplete,isMove:this.context().isMove};new(this.managed(this._actionMap.MoveCopyAction))(i).execute(t);t.stopPropagation();return!1};e.prototype._selectFolder=function(e){var t=this._urlDataSource.getKeyParams(e.key),i=this._urlDataSource.saveItemTypeFilter({filters:[_.ItemTypeFilter.folder]});for(var r in i)delete t[r];var n=this._urlDataSource.getKey(t);this.context().targetId=e.id;this.context().targetKey=n;this.context().cid=this._urlDataSource.getOwnerId(n);this.isNewFolderDisabled(!1);v.isFeatureEnabled(v.FileMoveSharingHint)&&this._showSharingInformation(e)};e.prototype._changeSelection=function(e){this.selectionModel.selectItem(e)};e.prototype._setFocus=function(){if(this.needsRefocus()){this.focusedItem().focused(!0);this.isNewFolderDisabled(!1);this.needsRefocus(!1)}};e.prototype._updateItemSet=function(){this.focusedItem().isLoading(!0);this._showChildren(this.focusedItem())};e.prototype._showChildren=function(i){var r=this;if(i.retrievedChildren()&&!this.dataUpdated()){i.isLoading(!1);0<i.children().length?i.isOpen(!0):i.isOpen(!1);this._updateSelectionArray()}else{var e={parentKey:i.key,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(i.key),skipCache:!0,filters:this._getFilters()};this._itemProvider.getItem(e).then(function(e){r._itemSet(e);i.children(l.default.convertChildren(i,r._itemSet().content().items));i.retrievedChildren(!0);i.isLoading(!1);0<i.children().length?i.isOpen(!0):i.isOpen(!1);0===i.children().length?i.iconVisible(!1):i.iconVisible(!0);if(r.dataUpdated()){for(var t=0;t<i.children().length;t++)if(i.children()[t]().name===r.newFolderName()){r._changeSelection(i.children()[t]());r._selectFolder(i.children()[t]())}r.isNewFolderDisabled(!1);r.dataUpdated(!1)}r._updateSelectionArray()})}};e.prototype._getFilters=function(){return this._moveCopyDataSource.getCapabilities().supportsMoveCopyFilterParams?{FilterField1:"FSObjType",FilterValue1:"1"}:{}};e.prototype._closeChildren=function(e){e.isOpen(!1);for(var t=0;t<e.children().length;t++)this._closeChildren(e.children()[t]())};e.prototype._fetchParentItem=function(e){var t=this,i=this._urlDataSource.saveItemTypeFilter({filters:[_.ItemTypeFilter.folder]}),r=this._urlDataSource.getKey(i),n={parentKey:r,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(r),filters:this._getFilters()},o=this._itemProvider.getItem(n).then(function(e){t._itemSet(e)}),a=h.default.wrap();if(this.showSharedRoot){var s=null;if(e.parent){for(var l=e;l.parent&&!l.parent.isStub&&l.parent.parent;)l=l.parent;s=l}else s=e;n={parentKey:s.key,ownerId:s.ownerId};a=this._itemProvider.getItem(n).then(function(e){t._sharedItemSet(e)},function(e){t.showSharedRoot=!1})}h.default.all([o,a]).done(this._createFolderItems.bind(this),this._createFolderItems.bind(this))};e.prototype._createFolderItems=function(){var e=null;if(this._sharedItemSet()){var t=this._getFolderItem(this._sharedItemSet());e=t;this.sharedFolderItem(t)}if(this._itemSet()){var i=this._getFolderItem(this._itemSet());i.isRoot=!0;e||(e=i);this.rootFolderItem(i);this._selectFolder(e);this._changeSelection(e);this._updateSelectionArray();this.hasData(!0)}};e.prototype._getFolderItem=function(e){var t=l.default.convertItem(null,e.item());t.children(l.default.convertChildren(t,e.content().items));t.isOpen(!0);t.retrievedChildren(!0);t.focused(!0);0===t.children().length&&t.iconVisible(!1);return t};e.prototype._updateSelectionArray=function(){var e=this._updateSelectionArrayHelper(this.rootFolderItem(),!0),t=this.sharedFolderItem()?this._updateSelectionArrayHelper(this.sharedFolderItem(),!0):[];this.itemArrayForSelection(t.concat(e))};e.prototype._updateSelectionArrayHelper=function(e,t){var i=[];t&&i.push(e);if(0<e.children().length)for(var r=0;r<e.children().length;r++)i=i.concat(this._updateSelectionArrayHelper(e.children()[r](),e.isOpen()));return i};e.prototype._showSharingInformation=function(i){var r=this;if(i.retrievedSharingPermissions){this.showSharingInfo(!!i.sharingInfoText);this.sharingInfoText(i.sharingInfoText)}else{this.showSharingInfo(!1);this._sharingProvider.getSharingData({key:"",openUrl:i.id}).getPermissions().then(function(e){var t=e[0];i.retrievedSharingPermissions=!0;i.sharingPermissions=t;i.sharingInfoText=y.getSharingStatusText(t,i.name);if(i.selected()){r.showSharingInfo(!!i.sharingInfoText);r.sharingInfoText(i.sharingInfoText)}},function(e){})}};return e}(i.default);e.default=r});define("ae6",["require","exports","aq","eO"],function(e,t,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function o(){}o.convertItem=function(e,t){return{name:t.name,key:t.key,type:t.type,id:t.id,iconName:t.iconName,focused:a.observable(!1),isSelectable:!0,selected:a.observable(!1),children:a.observableArray(),isOpen:a.observable(!1),retrievedChildren:a.observable(!1),iconVisible:a.observable(!0),isRoot:!1,isLoading:a.observable(!1),level:0,parent:e,showNewFolderInput:a.observable(!1),focusNewFolderInput:a.observable(!1),retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,oneDriveItem:t}};o.convertChildren=function(e,t){for(var i=[],r=0;r<t.length;r++)if(t[r]&&t[r]().type===s.default.Folder){var n=a.observable(o.convertItem(e,t[r]()));n().level=e.level+1;i.push(n)}return i};return o}();t.default=i});define("ae5",["require","exports","ap","aq","dI","bN","dm","bX","p3"],function(e,t,i,s,l,r,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){i.__extends(e,a);function e(e){var t=a.call(this,e)||this;t.commands=s.observableArray();var i=".FolderPanelTopMenu",r=c.strings;t._actionMap=t.resources.consume(d.actionMap);t.componentViewModel=e.componentViewModel;t.context=e.componentViewModel.context;t.onComplete=e.componentViewModel.onComplete;t.isDisabled=e.componentViewModel.isDisabled;t.isNewFolderDisabled=e.componentViewModel.isNewFolderDisabled;t.isNewFolderHidden=s.observable(!0);t.createComputed(function(){if((!t._focusedItem||t._focusedItem()!==t.componentViewModel.focusedItem())&&t.componentViewModel.focusedItem()){t._focusedItem=t.componentViewModel.focusedItem;var e=s.observable(t._focusedItem().oneDriveItem);t._createFolderAction=new(t.managed(t._actionMap.CreateFolderAction))({item:e})}t._createFolderAction&&t.isNewFolderHidden(!t._createFolderAction.isAvailable())});var n={context:t.context,onComplete:t.onComplete,isMove:!0},o={context:t.context,onComplete:t.onComplete,isMove:!1};t.commands=s.observableArray([new u.default({text:r.moveConfirmButton,isDisabled:t.isDisabled,icon:new l.default("CheckMark"),automationId:"folderTree-move",action:new(t.managed(t._actionMap.MoveCopyAction))(n),engagementName:"Move"+i}),new u.default({text:r.copyConfirmButton,isDisabled:t.isDisabled,icon:new l.default("CheckMark"),automationId:"folderTree-copy",action:new(t.managed(t._actionMap.MoveCopyAction))(o),engagementName:"Copy"+i}),new(t.managed(u.default))({text:r.CreateFolderCommand,isHidden:t.isNewFolderHidden,isDisabled:t.isNewFolderDisabled,icon:new l.default("CirclePlus"),callback:function(){t.componentViewModel.focusedItem().showNewFolderInput(!0);t.componentViewModel.focusedItem().focusNewFolderInput(!0);t.isNewFolderDisabled(!0)},engagementName:"NewFolder"+i})]);return t}return e}(r.default);t.default=n});define("ae2",[],function(){return'\x3c!--ko if: hasData--\x3e<div class="od-FolderTree-commandBar od--hasSelection" data-bind="control: commandBarSpecification"></div><div class=od-FolderTree-contentContainer><div class="od-FolderTree-sharingInfo ms-font-m" data-bind="visible: showSharingInfo, text: sharingInfoText"></div><div class="od-Panel--hasPadding od-FolderTree-padding"><div class="od-FolderTree-title ms-font-xl ms-fontWeight-semilight" data-bind="text: title"></div><span class=ms-accessible data-bind="text: titleAccessibilityHint"></span>\x3c!--ko if: showSharedRoot && sharedFolderItem()--\x3e<div class=od-FolderTree role=tree data-bind="template: { name: \'od-folder-tree-row\', data: sharedFolderItem }, keyboard: keyboardOptions, selection: { data: itemArrayForSelection, mode: \'single\', direction: \'vertical\', key: sharedFolderItem().key, focused: focusedItem, selected: selectedItems, clearSelectionOnRemoval: false, selectFirstItemOnActivate: false, selectionModel: selectionModel }"></div>\x3c!--/ko--\x3e<div class=od-FolderTree role=tree data-bind="template: { name: \'od-folder-tree-row\', data: rootFolderItem }, keyboard: keyboardOptions, selection: { data: itemArrayForSelection, mode: \'single\', direction: \'vertical\', key: rootFolderItem().key, focused: focusedItem, selected: selectedItems, clearSelectionOnRemoval: false, selectFirstItemOnActivate: false, selectionModel: selectionModel }"></div></div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: hasData--\x3e<span class=ms-font-m data-bind="component: { name: loadingSpinnerTagName, params: { loadingText: loadingText } }"></span>\x3c!--/ko--\x3e'});define("ae1",[],function(){return"<div class=od-FolderTree-row role=treeitem data-bind=\"css: {'is-selected': selected, 'is-focused': focused, 'icon-visible': iconVisible}, click: $component.onClick.bind($data, $component), attr: { tabindex: selected() || focused() ? 0 : -1, 'aria-expanded': isOpen(), 'aria-selected': selected(), 'aria-label': name}, delayedHasFocus: { hasFocus: focused, timeout: 300 }\"><i class=\"ms-Icon ms-Icon--ChevronDown\" data-bind=\"icon: true, style: {display: !isLoading() && isOpen() ? 'inline-block' : 'none'}\"></i> <i class=ms-Icon data-bind=\"icon: true, style: {display: !isLoading() && !isOpen() ? 'inline-block' : 'none'}, css: { 'ms-Icon--ChevronRight': !$component.isRtl, 'ms-Icon--ChevronLeft': $component.isRtl }\"></i> <img class=od-FolderTree-loadingGif data-bind=\"attr: { src: $component.loadingImageUrl}, style: {display: isLoading() ? 'inline-block' : 'none'}\"> <i class=\"ms-Icon ms-Icon--OneDrive\" data-bind=\"icon: true, style: {display: isRoot ? 'inline-block' : 'none'}\"></i> <span class=od-FolderTree-folderIcon data-bind=\"component: { name: 'ms-file-type-icon', params: { iconName: iconName, desiredSize: 16 } }, style: {display: isRoot ? 'none' : 'inline-block'}\"></span> <span class=\"od-FolderTree-folderName ms-font-m\" data-bind=\"text: name\"></span></div><div class=od-FolderTree-inlineFolderBuilder data-bind=\"visible: showNewFolderInput, component: { name: 'ms-inline-folder-builder', params: { newFolderName: $component.newFolderName, iconName: iconName, width: $component.getWidth($component, $data), itemKey: key, optionalParams: { dataUpdated: $component.dataUpdated, showNewFolderInput: showNewFolderInput, hasFocus: focusNewFolderInput, needsRefocus: $component.needsRefocus } } }\"></div><ul class=od-FolderTree-children role=group data-bind=\"template: { name: 'od-folder-tree-row', foreach: children }, style: { display: isOpen() ? 'block' : 'none' }\"></ul>"});define("aeW",["require","exports","aeZ","b5","aeY","aeX","df"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-inline-folder-builder",template:e("aeY"),viewModel:i.default});t.default=n});define("aeZ",["require","exports","ap","aq","bF","eX","ae0","bX","cJ"],function(e,t,i,n,r,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.namePlaceholder=a.strings.FolderNamePlaceholder;t.nameLabel=a.strings.FolderNameLabel;t.createLabel=a.strings.CreateFolderLabel;t.iconName=e.iconName;t.width=(e.width-57).toString()+"px";t.inputWidth=(e.width-89).toString()+"px";t.newFolderName=e.newFolderName||n.observable("");t.newFolderName("");t.buttonText=a.strings.CreateFolderLabel;t.itemKey=e.itemKey;t.isActive=n.observable(!0);var i=e.optionalParams;t.optionalParams={dataUpdated:i&&i.dataUpdated?i.dataUpdated:n.observable(!1),showNewFolderInput:i&&i.showNewFolderInput?i.showNewFolderInput:n.observable(!0),hasError:i&&i.hasError?i.hasError:n.observable(!1),status:i&&i.status?i.status:n.observable(""),hasFocus:i&&i.hasFocus?i.hasFocus:n.observable(!0),isEnabled:i&&i.isEnabled?i.isEnabled:n.observable(!0),needsRefocus:i&&i.needsRefocus?i.needsRefocus:n.observable(!1)};t.addBindingHandlers({keyboard:l.default});t._itemProvider=t.resources.consume(o.resourceKey);t._actionMap=t.resources.consume(s.actionMap);return t}e.prototype.onClick=function(e,t){e.createNewFolder(t)};e.prototype.onEnter=function(e,t){e.createNewFolder(t);return!0};e.prototype.onClickTextField=function(e,t){t.stopPropagation()};e.prototype.onEscape=function(e,t){this.optionalParams.showNewFolderInput(!1);this.newFolderName("");this.optionalParams.status("");this.optionalParams.isEnabled(!0);this.optionalParams.needsRefocus(!0);t.stopPropagation();return!1};e.prototype.createNewFolder=function(i){var r=this,e={parentKey:this.itemKey};this._itemProvider.getItem(e).then(function(e){var t=e.item();new(r.managed(r._actionMap.CreateNewFolderAction))({parentItem:t,newFolderName:r.newFolderName,options:r.optionalParams}).execute(i)});i.stopPropagation()};return e}(r.default);t.default=c});define("aeY",[],function(){return'<div class=od-InlineFolderBuilder data-bind="style: { width: width}, keyboard: { allowInputEvents: true, mappings: { Enter: onEnter.bind($component), Esc: onEscape.bind($component) } }"><span><span class=od-InlineFolderBuilder-folderIcon data-bind="component: { name: \'ms-file-type-icon\', params: { iconName: iconName, desiredSize: 16 } }"></span> <input class="od-InlineFolderBuilder-textInput od-TextField-field" type=text data-bind="value: newFolderName, textInput: newFolderName, click: onClickTextField.bind($component), hasFocus: optionalParams.hasFocus, style: { width: inputWidth }, attr: { maxlength: 255, placeholder: namePlaceholder, \'aria-label\': nameLabel }, automation: automationId, enable: optionalParams.isEnabled"></span><div class=od-InlineFolderBuilder-status aria-live=assertive data-bind="text: optionalParams.status, css: { \'od-InlineFolderBuilder-status--error\': optionalParams.hasError }"></div><div><button class="od-Button od-Button--primary od-InlineFolderBuilder-createButton" data-bind="visible: newFolderName() && optionalParams.isEnabled(), click: onClick.bind($component), attr: { \'aria-label\': createLabel }"><span class=od-Button-label data-bind="text: buttonText"></span></button></div></div>'});define("aeX",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-InlineFolderBuilder{overflow:visible;white-space:nowrap;word-wrap:break-word;display:inline-block}.od-InlineFolderBuilder-textInput{display:inline-block}[dir=ltr] .od-InlineFolderBuilder-textInput{margin-left:8px}[dir=rtl] .od-InlineFolderBuilder-textInput{margin-right:8px}.od-InlineFolderBuilder-createButton{margin-top:2px;line-height:0}html[dir=ltr] .od-InlineFolderBuilder-createButton{float:right}html[dir=rtl] .od-InlineFolderBuilder-createButton{float:left}.od-InlineFolderBuilder-status{margin-top:2px;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";white-space:pre-wrap;word-wrap:break-word;line-height:15px}.od-InlineFolderBuilder-status--error{color:#a80000}"}])});define("aeV",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-Icon--xs{font-size:10px}.ms-Icon--s{font-size:12px}.ms-Icon--m{font-size:16px}.ms-Icon--l{font-size:20px}.od-FolderTree-row{overflow:hidden;cursor:default;height:34px;line-height:14px;position:relative;margin:2px 0;min-width:220px;white-space:nowrap;text-overflow:ellipsis}.od-FolderTree-row.is-selected{background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-FolderTree-row.is-selected{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderTree-row.is-selected{background:#00c0ff}}.od-FolderTree-row:focus{outline:1px solid transparent}.od-FolderTree-row .ms-Icon--ChevronDown{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";opacity:0;padding:10px;font-size:12px}.od-FolderTree-row .ms-Icon--ChevronRight{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";opacity:0;padding:10px 8px 10px 14px;font-size:12px}html[dir=rtl] .od-FolderTree-row .ms-Icon--ChevronRight{padding:10px 14px 10px 8px}.od-FolderTree-row.icon-visible .ms-Icon--ChevronRight{opacity:1}.od-FolderTree-row.icon-visible .ms-Icon--ChevronDown{opacity:1}.od-FolderTree-row .ms-Icon--OneDrive{font-size:16px;padding:10px 0;width:16px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";vertical-align:top}[dir=ltr] .od-FolderTree-row .ms-Icon--OneDrive{margin-left:-3px}[dir=rtl] .od-FolderTree-row .ms-Icon--OneDrive{margin-right:-3px}.od-FolderTree-row .od-FolderTree-loadingGif{vertical-align:bottom;padding:9px}.od-FolderTree-row>i{display:inline}.od-FolderTree-folderIcon{vertical-align:top;line-height:30px}.od--isNonMobile .od-FolderTree-row:hover{background:"},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:"}.od--isNonMobile .od-FolderTree-row:hover.is-selected{background:"},{theme:"themeLightAlt",defaultValue:"#beddf4"},{rawString:"}.od-focus--enabled .od-FolderTree-row.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;outline:1px solid transparent}.od-FolderTree-folderName{cursor:pointer;position:relative;top:-1px;line-height:32px}[dir=ltr] .od-FolderTree-folderName{margin-left:3px}[dir=rtl] .od-FolderTree-folderName{margin-right:3px}.od-FolderTree-children{margin:0}[dir=ltr] .od-FolderTree-children{padding-left:20px}[dir=rtl] .od-FolderTree-children{padding-right:20px}.od-FolderTree-title{margin-bottom:20px}.od-FolderTree-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:0;width:100%;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-FolderTree-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-FolderTree-commandBar .ms-CommandBar{animation:none}}.od-FolderTree-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 #2488d8;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button i{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-FolderTree-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}.od-FolderTree-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-FolderTree-commandBar .CommandBar{animation:none}}.od-FolderTree-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 #2488d8}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:12px;padding-right:12px}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:1px solid "},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";margin:2px -8px}.od-FolderTree-contentContainer{position:absolute;overflow-y:scroll;top:40px;bottom:0}[dir=ltr] .od-FolderTree-contentContainer{left:0}[dir=rtl] .od-FolderTree-contentContainer{right:0}[dir=ltr] .od-FolderTree-contentContainer{right:0}[dir=rtl] .od-FolderTree-contentContainer{left:0}.od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:22px}.lg .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding,.md .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding,.sm .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:10px}.od-FolderTree-sharingInfo{background-color:"},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:";padding:4px 6px}.od-FolderTree-inlineFolderBuilder{margin:2px 0;line-height:34px}[dir=ltr] .od-FolderTree-inlineFolderBuilder{padding-left:57px}[dir=rtl] .od-FolderTree-inlineFolderBuilder{padding-right:57px}"}])});define("aeP",["require","exports","ap","bN","aeQ","MZ","iE","ci","kL","ba"],function(e,t,r,i,n,o,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selectionHelper=e.selectionHelper;t._renameHelper=new(t.managed(n.default));t._pageContext=t.resources.consume(a.pageContext);t._dialogProvider=t.resources.consume(s.resourceKey);return t}e.prototype.execute=function(){var t=this;c.isOneDrive&&this.trackPromise(this.resources.consumeAsync(l.resourceKey).then(function(e){e.fireEditEvent()}));return this._selectionHelper.resolveFirst().then(function(e){return o.default.isCheckedOutByOther(e,t._pageContext.userId)?o.default.showCheckedOutByOtherDialog(t._dialogProvider):t._renameHelper.renameItem(e,!1)})};return e}(i.default);t.default=d});define("aeQ",["require","exports","ap","aC","dI","bN","aI","dm","ci","aeR","bX","MT","dZ"],function(e,t,r,u,p,i,m,h,n,f,o,g,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._dialogProvider=t.resources.consume(n.resourceKey);t._urlDataSource=t.resources.consume(a.url);t._parentItem=t.resources.consume(o.currentItem);return t}e.prototype.renameItem=function(r,n){var o=this,e=r.properties.FileName||r.name,t=r.extension;if(n){e+=r.extension;t=null}var a=this.observables.create(e),s=this.observables.create(""),l=this.observables.create(!1),c=this.observables.create(!0),d=this.observables.create(!0);return this._dialogProvider.requestDialog({title:h.strings.Rename,component:{name:g.default.tagName,params:{name:a,extension:t,status:s,hasError:l,isEnabled:c,hasFocus:d}},actions:[{name:h.strings.RenameCommit,execute:function(){var i=o.unwrapObservable(a);if(i===e)return u.default.wrap(2);if(i&&""===i.trim())return u.default.wrap(1);s(h.strings.Saving);c(!1);l(!1);return o.resources.consumeAsync(f.typeResourceKey).then(function(e){var t=new e({parentKey:o._parentItem().key,newName:i,nameHasExtension:n,item:r,ownerId:o._urlDataSource?o._urlDataSource.getOwnerId():""});return o.trackPromise(t.start())}).then(function(){return 2},function(e){l(!0);c(!0);d(!0);s(e.message);return 1})},isDefault:!0,isAvailable:this.observables.pureCompute(function(){return!!a().trim()&&c()}),automationId:"renameDialogCommit",icon:new p.default("Save")}]}).wait().then(function(){return{resultType:m.ResultTypeEnum.Success}})};return e}(i.default);t.default=s});define("aeR",["require","exports","ap","Sj","Sh","cg","bA"],function(e,t,i,n,o,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._context=e;i._fileSystemProvider=t.fileSystemProvider;return i}e.prototype.getOperationDetails=function(e){var t=r.prototype.getOperationDetails.call(this,e),i=e.input;t.type=a.default.renameItems;t.name=i.name;t.iconName=i.iconName;t.payloads.renameItems={item:i,parent:i.parent};t.visibility=2;return t};e.prototype.onStart=function(e){return this._fileSystemProvider.renameItem(this._context,e)};e.dependencies=i.__assign({},n.default.dependencies,{fileSystemProvider:o.resourceKey});return e}(n.default);t.default=s;t.typeResourceKey=r.createResolvedTypeResourceKey(e("module").id,s)});define("aeO",["require","exports","ap","aC","bN","aI","eX","bX","UW"],function(e,t,r,n,i,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selectionHelper=e.selectionHelper;t._overrideItem=e.overrideItem;t._itemProvider=t.resources.consume(a.resourceKey);t._parentItem=t.resources.consume(s.currentItem);return t}e.prototype.execute=function(){var r=this,e=this._overrideItem?n.default.wrap(this._overrideItem):this._selectionHelper.resolveFirst(),t=this.resources.consumeAsync(l.resourceKey);return n.default.all({item:e,provider:t}).then(function(e){var t=e.item,i=e.provider;return n.default.all({item:t,pinStatus:i.changePinStatus(t)}).then(function(e){var t=e.item;t.mruState.isPinnedToMru=!t.mruState.isPinnedToMru;var i=r._parentItem.peek().key;r._itemProvider.invalidateItem(i,{triggerFetch:!0,updateGrouping:!0});return{resultType:o.ResultTypeEnum.Success}})})};return e}(i.default);t.default=c});define("aeM",["require","exports","ap","aeN"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getFullFileName=function(e){return e.name};return t}(r.default);t.default=n});define("aeN",["require","exports","ap","bN","aI","So","Em","dG","kL","ba"],function(e,t,r,i,a,s,n,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selectionHelper=e.selectionHelper;t._currentItem=e.currentItem;t._itemContentsProvider=t.resources.consume(n.resourceKey);return t}e.prototype.execute=function(){var o=this;return this._selectionHelper.resolveFirst().then(function(i){var e=o._itemContentsProvider.getItemContent(i),t=e.memoryContent.peek(),r=o.getFullFileName(i);d.isOneDrive&&o.trackPromise(o.resources.consumeAsync(c.resourceKey).then(function(e){e.fireEditEvent()}));var n=new Blob([t.text],{type:i.textEditorMimeType});n.name=r;n.eTag=e.correspondingETag;return o.resources.consumeAsync(s.typeResourceKey).then(function(e){var t=new e({files:[n],parentItem:o._currentItem,wasDragAndDropped:!1,type:l.UploadProcessorType.Html5file,item:i});o.trackPromise(t.start());return t.wait()}).then(function(){return{resultType:a.ResultTypeEnum.Success}},function(e){return{resultType:a.ResultTypeEnum.Failure,error:e?e.message||e:"Unkown error occurred whil trying to save a file"}})})};e.prototype.getFullFileName=function(e){return e.name+e.extension};return e}(i.default);t.default=o});define("aek",["require","exports","ap","bN","ael"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selectionHelper=e.selectionHelper;t._deferredItems=e.deferredItems;t._shareHelper=new(t.managed(n.default))({activeTab:e.activeTab,initialTab:e.initialTab});return t}e.prototype.execute=function(){var t=this;this._shareHelper.showLoadingDialog();return this._deferredItems?this._deferredItems.then(function(e){return t._shareHelper.shareItems(e)}):this._selectionHelper.resolveSelection().then(function(e){return t._shareHelper.shareItems(e)})};return e}(i.default);t.default=o});define("ael",["require","exports","ap","cE","aI","bN","dI","ci","eO","lB","aC","DL","aen","aem"],function(e,t,r,n,o,i,a,s,l,c,d,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._activeTab=e.activeTab;t._initialTab=e.initialTab;t._dialog=t.createObservable(null);t._dialogProvider=t.resources.consume(s.resourceKey);return t}e.prototype.showLoadingDialog=function(){this._loadingDialog=this._dialogProvider.requestDialog({title:u.strings.ShareText,size:"Large",component:{name:c.default.tagName,params:{}}})};e.prototype.shareItems=function(i){var e=this._getSharingParams(i);if(this._loadingDialog){this._loadingDialog.dismiss();this._loadingDialog=null}if(!i||!i[0])return d.default.wrapError({resultType:o.ResultTypeEnum.Failure,resultCode:"ItemNotFound"});this._activeTab(this._initialTab);var t=this._shareItems(i,e);this._dialog(t);return t.wait().then(function(){var e={},t={count:i.length};if(1===i.length){e.fileType=l.default[i[0].type];e.extension=i[0].extension||""}return{resultType:o.ResultTypeEnum.Success,extraData:e,extraMetrics:t}})};e.prototype._closeSharingDialog=function(){this._dialog.peek().state(2)};e.prototype._shareItems=function(e,t){var i=this,r={sharingParams:t,activeTab:this._activeTab,resources:this.resources,item:e[0],hasError:this.createObservable(!1)};return this._dialogProvider.requestDialog({title:t.dialogTitle,size:"Large",component:{name:p.default.tagName,params:r},actions:[{name:m.strings.CloseText,execute:function(){i.resources.consume(n.resourceKey).logData({name:"Close.SharingDialog.Click",isIntentional:!0,extraData:{tab:i._activeTab()}});return d.default.wrap(2)},isVisible:this.observables.pureCompute(function(){return 1!==i._activeTab()||r.hasError()}),isDefault:!0,icon:new a.default("Cancel"),automationId:"shareDialogClose"}],executeDefaultAction:!1})};e.prototype._getSharingParams=function(e){return{items:e,selectedPeople:this.observables.createArray([]),roleValue:this.observables.create(""),emailMessage:this.observables.create(""),errorMessage:this.observables.create(""),sendEmail:this.observables.create(!0),requireSignIn:this.observables.create(!0),propagateSharing:this.observables.create(!1),hasUnresolvedText:this.observables.create(!1),emailMessageExceedsLimit:this.observables.create(!1),dialogTitle:this.observables.create(""),showSendEmailOption:!0,currentLink:this.observables.create(null),blockSharingViaPolicyTip:this.observables.create(!1),canUserShareExternally:this.observables.create(!1),selectedPeopleContainsExternal:this.observables.create(!1),onExecuteAction:this._closeSharingDialog.bind(this),expiration:null}};return e}(i.default);t.default=h});define("aen",["require","exports","aeL","b5","aeK","aeJ","aeF","aez","acY","aeu","aeo"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-tabbedShare",template:e("aeK"),viewModel:i.default});t.default=n});define("aeL",["require","exports","ap","aq","bF","bX","cE","aI","aI","aem","DI","eO","V","DL","lB","aeo","cJ","aeF","acY"],function(e,t,r,o,i,n,a,s,l,c,d,u,p,m,h,f,g,b,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(i){r.__extends(e,i);function e(e){var t=i.call(this)||this;t.sharingTagName=b.default.tagName;t.sharingHintsTagName=_.default.tagName;t.loadingSpinnerTagName=h.default.tagName;t.sharingParams=e.sharingParams;t.addBindingHandlers({keyboard:g.default});t._sharingProvider=t.resources.consume(d.resourceKey);t._selectionModel=t.resources.consume(n.itemsSelection);t.itemName=o.observable("");t.isLoading=o.observable(!0);t.inviteText=c.strings.InviteTabTitle;t.sharedWithText=c.strings.SharedWithTabTitle;t.linksText=c.strings.LinksTabTitle;t.anonymousLinksText=c.strings.GuestLinkText;t.linksAvailable=o.observable(!1);t.guestLinkExists=o.observable(!1);t.sharedWithMany=o.observable(!1);t.sharedWith=o.observableArray([]);t.dialogTab=e.activeTab?e.activeTab:o.observable(1);t.item=e.item;t.hasError=e.hasError;t.canUserShareExternally=t.observables.create(!1);t.getSharingSettings();t.sharingLinksComponentTagName=f.default.tagName;t.sharingHintsOption=15;t.blockSharingViaPolicyTip=t.observables.create(!1);t.sharingParams.blockSharingViaPolicyTip=t.blockSharingViaPolicyTip;t.sharingParams.canUserShareExternally=t.canUserShareExternally;return t}e.prototype.switchToSharedWith=function(){this.switchTab(3)};e.prototype.switchTab=function(e){if(e!==this.dialogTab()){var t="";switch(e){case 1:t="InviteTab";break;case 2:t="GetALinkTab";break;case 3:t="SharedWithTab"}t+=".SharingDialog.Click";this.resources.consume(a.resourceKey).logData({name:t,isIntentional:!0});this.dialogTab(e)}};e.prototype.getSharingSettings=function(){var t,e,i=this,r=new s.Qos({name:"TabbedSharingViewModel.getSharingSettings"});this.item?t=this.item:this._selectionModel&&this._selectionModel.selection()&&0<(e=this._selectionModel.selection()).length&&(t=o.utils.unwrapObservable(e[0]));if(t)if(e&&1<e.length){this.sharingParams.dialogTitle(p.format(m.strings.MultiShareTitleText,e.length));this.isLoading(!1)}else{var n=this.item.type===u.default.Folder?c.strings.MissingFolderTitle:c.strings.MissingFileTitle;this.missingItemError=this.item.type===u.default.Folder?m.strings.MissingFolderError:m.strings.MissingFileError;this._sharingProvider.getSharingData(t).getSettings().then(function(e){i._sharingSettings=e;i.linksAvailable(!0);i.sharedWithMany(e.sharedWithMany);i.itemName(e.itemName);i.canUserShareExternally(e.canCurrentUserShareExternally);i.sharingParams.dialogTitle(i._sharingSettings.itemId?p.format(m.strings.TitleText,e.itemName):n);i._sharingSettings.itemId||i.hasError(!0);e.sharedWith&&i.sharedWith(e.sharedWith);i.isLoading(!1);r.end({resultType:l.ResultTypeEnum.Success})},function(e){i.sharingParams.dialogTitle(p.format(m.strings.TitleText,t.name));i.itemName(t.name);i.isLoading(!1);r.end({resultType:l.ResultTypeEnum.Failure,resultCode:"ServerError",extraData:{error:e}})})}else r.end({resultType:l.ResultTypeEnum.Failure,resultCode:"ItemNotFound"})};return e}(i.default);t.default=v});define("aeo",["require","exports","aer","b5","aeq","aep"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-sharingLinksSelector",template:e("aeq"),viewModel:i.default});t.default=n});define("aer",["require","exports","ap","aq","bF","aC","bX","ci","cE","lB","d0","aeo","aet","DI","Sf","p3","c2","cI","V","aes","qH","cL","uA","ac3","Ol","hs","yk"],function(e,t,i,a,r,n,s,l,c,d,u,p,m,h,f,g,b,_,v,y,S,x,k,C,P,I,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(o){i.__extends(e,o);function e(t){var i=o.call(this,t)||this;i.sharingLinksSelectorTagName=p.default.tagName;i.loadingSpinnerTagName=d.default.tagName;i.progressSpinnerFlatTagName=u.default.tagName;i.addBindingHandlers({bindableHtml:S.default,dismiss:_.default,selectOnFocus:k.default,visibility:f.default});i.createLinkButtonText=m.strings.CreateLinkButtonText;i._selectionModel=i.resources.consume(s.itemsSelection);i._sharingProvider=i.resources.consume(h.resourceKey);i._engagement=i.resources.consume(c.resourceKey);i.loading=a.observable(!0);i.hasLoadingError=a.observable(!1);i.sharingLinksSelectorStrings=m.strings;i.error=a.observable("");i._item=t.item;i.shouldShowSharingLinkCopyButton=C.default.CanUseClipboardData();i._guestLinkExists=t.guestLinkExists?t.guestLinkExists:a.observable(!1);i.sharingLinkMenuItems=a.observableArray();i.isSharingLinkMenuOpen=a.observable(!1);i.menuAlignment=a.observable(x.default.isRightToLeft?b.default.Right:b.default.Left);i.menuLeft=a.observable(x.default.isRightToLeft?"0":"auto");i.linkSelectorCurrentLabelText=a.observable("");i.currentSharingLink=a.observable(null);i.canRemoveCurrentSharingLink=a.observable(!1);i.processingSharingLink=a.observable(!0);i.sharingLinkError=a.observable("");i._hasShareEventFired=!1;i.inputHasFocus=i.observables.create(!1);i.inputAriaLabel=i.sharingLinksSelectorStrings.LinkAvailable;i.linkExpirationMenuItems=a.observableArray();i.isLinkExpirationMenuOpen=a.observable(!1);i.shouldShowLinkExpiration=a.observable(!1);i.shouldShowCustomExpiration=a.observable(!1);i.sharingLinkExpirationDate=a.observable("");i.sharingLinkExpirationLabel=a.observable("");i.sharingLinkExpirationNumDays=a.observable(0);i.shouldShowSetExpirationDropDown=a.observable(!0);i._companyDisplayName=a.observable("");var e=i.resources.consume(w.resourceKey.optional);e&&e.loadData().then(function(e){i._companyDisplayName(e.CompanyDisplayName);null!=i.currentSharingLink()&&i._setCurrentLinkLabelText(i.currentSharingLink())});var r=i._sharingProvider.getSharingData(i._getCurrentItem()),n=null;i.isSingleLinkLabelVisible=!0;i.isReady=r.getSettings().then(function(e){i.canManageLinks=e.canManageLinks;i._adminRequiredAnonymousLinkExpirationInDays=e.requiredAnonymousLinkExpirationInDays;i._enforceRequiredAnonymousLinkExpiration=0<Number(e.requiredAnonymousLinkExpirationInDays);i.shouldShowSetExpirationDropDown(!i._enforceRequiredAnonymousLinkExpiration);i._defaultSharingLinkType=e.defaultLinkType;return r.getBestSharingLink(i._defaultSharingLinkType)},function(e){}).then(function(e){if(e){n=e;i._setCurrentSharingLink(e);i.processingSharingLink(!1)}return i._getSharingLinks()},function(e){i._handleSharingLinkError();i.hasLoadingError(!0)}).then(function(e){if(null!=e){i.isSingleLinkLabelVisible=e.length<2;null==i.currentSharingLink()&&i._setCurrentSharingLink(n||(0<e.length?e[0]:null));t.linksAvailable&&t.linksAvailable(!0)}i.loading(!1)},function(e){i._handleSharingLinkError();i.hasLoadingError(!0);i.loading(!1)});return i}e.prototype.removeSharingLink=function(){var t=this;if(this.processingSharingLink())return!1;this.processingSharingLink(!0);var e=this.resources.consume(l.resourceKey);this._confirmDialog=P.disableLinkConfirm(function(){t._engagement.logData({name:"Disable"+t.currentSharingLink().tag+"Link.SharingLinksSelector.Click",isIntentional:!0});var e={type:t.currentSharingLink().type,role:t.currentSharingLink().role,create:!1};return t._sharingProvider.manageSharingLinks([t._getCurrentItem()],e).then(function(e){if(null!=e&&0===e.length){return t._sharingProvider.getSharingData(t._getCurrentItem()).getBestSharingLink(t._defaultSharingLinkType).then(function(e){t.processingSharingLink(!1);if(e){t._setCurrentSharingLink(e);return!0}t._handleSharingLinkError();return!1},function(e){t._handleSharingLinkError();return!1})}t._handleSharingLinkError();return n.default.wrap(!1)},function(e){t._handleSharingLinkError();return!1})},function(e){t.isReady=e},e,"SharingLinkSelector")};e.prototype.copySharingLink=function(){this._engagement.logData({name:this.currentSharingLink().tag+"Link.SharingLinksSelector.Copy",isIntentional:!0});this._hasShareEventFired||(this._hasShareEventFired=!0);return!0};e.prototype.executeDisableConfirm=function(){this._confirmDialog&&this._confirmDialog.actions[0].execute()};e.prototype.onClickSharingLinkMenu=function(e,t){var o=this;if(this.processingSharingLink())return null;var a=[];this.isReady=this._getSharingLinks().then(function(e){null!=e&&e.forEach(function(t,e,i){var r=o._getLinkLabelText(t),n=new g.default({text:t.isActive?v.format(o.sharingLinksSelectorStrings.SharingLinkCreated,r):r,isToggleable:!1,action:new(o.managed(y.default))({items:[o._getCurrentItem()],link:t,expiration:o._getLinkExpiration(t),isExecuting:o.processingSharingLink,successCallback:function(e){o.shouldShowCustomExpiration(!1);if(null!=e)if(e.isActive){if(e.type!==o.currentSharingLink().type||e.role!==o.currentSharingLink().role||e.expiration!==o.currentSharingLink().expiration){t.url=e.url;t.expiration=e.expiration;t.isActive=!!t.url;o._setCurrentSharingLink(t);o.processingSharingLink(!1);o._engagement.logData({name:"SwitchTo"+o.currentSharingLink().tag+"Link.SharingLinksSelector.Click",isIntentional:!0})}}else{o._setCurrentSharingLink(e);o.processingSharingLink(!1)}else o._handleSharingLinkError()},failureCallback:function(e){o._handleSharingLinkError(e)}})});a.push(n)})},function(e){o._handleSharingLinkError()});this.sharingLinkMenuItems(a);this.isSharingLinkMenuOpen(!this.isSharingLinkMenuOpen());return a};e.prototype.onDismissSharingLinksMenu=function(e,t){this.isSharingLinkMenuOpen(!1)};e.prototype.onClickCopyLink=function(e,t){if(this.processingSharingLink())return!1;this.copySharingLink();C.default.CopyToClipboard(this.currentSharingLink().url)};e.prototype.onClickCreateLink=function(e,t){var i=this;if(this.processingSharingLink())return!1;var r={type:this.currentSharingLink().type,role:this.currentSharingLink().role,create:!0,expiration:this.currentSharingLink().expiration};this._sharingProvider.manageSharingLinks([this._getCurrentItem()],r).then(function(e){var t;if(0<e.length&&null!=(t=e[0])){i.currentSharingLink().url=t.url;i.currentSharingLink().expiration=t.expiration;i.currentSharingLink().isActive=!!i.currentSharingLink().url;i._setCurrentSharingLink(i.currentSharingLink());i.processingSharingLink(!1);i.inputHasFocus(!0);i._engagement.logData({name:"SwitchTo"+i.currentSharingLink().tag+"Link.SharingLinksSelector.Create.Click",isIntentional:!0})}},function(e){i._handleSharingLinkError()})};e.prototype.onClickLinkExpirationMenu=function(e,t){var a=this;if(this.processingSharingLink())return null;var s=this.currentSharingLink();if(s&&(6===s.type||5===s.type)&&this._enforceRequiredAnonymousLinkExpiration){this.shouldShowCustomExpiration(!0);this.sharingLinkError("");return null}var l=[],c=this._getAvailableExpirationOptions();Object.keys(c).forEach(function(e,t,i){var r=c[e],n=!isNaN(r)&&0<=r?a._calculateLinkExpiration(r):"CUSTOM",o=new g.default({text:e,isToggleable:!1,action:new(a.managed(y.default))({items:[a._getCurrentItem()],link:s,expiration:n,isExecuting:a.processingSharingLink,successCallback:function(e,t){if(null!=e){var i=a._engagement;if("CUSTOM"===t){a.shouldShowCustomExpiration(!0);i.logData({name:"Custom.LinkExpiration.SharingLinksSelector.Click",isIntentional:!0})}else if(e.type!==a.currentSharingLink().type||e.role!==a.currentSharingLink().role||e.expiration!==a.currentSharingLink().expiration){s.url=e.url;s.expiration=e.expiration;s.isActive=!!s.url;a._setCurrentSharingLink(s);i.logData({name:(null!=e.expiration?"Set":"Remove")+".LinkExpiration.SharingLinksSelector.Click",isIntentional:!0})}}else a._handleSharingLinkError();a.processingSharingLink(!1)},failureCallback:function(e){a._handleSharingLinkError()}})});l.push(o)});this.linkExpirationMenuItems(l);this.isLinkExpirationMenuOpen(!this.isLinkExpirationMenuOpen());return l};e.prototype.onDismissLinkExpirationMenu=function(e,t){this.isLinkExpirationMenuOpen(!1)};e.prototype.onClickSaveCustomExpiration=function(e,t){var n=this;if(this.processingSharingLink())return!1;var o=parseInt(String(this.sharingLinkExpirationNumDays()),10),i=this.currentSharingLink.peek().expiration;if(i){if(this._calculateDays(i)===o){this.shouldShowCustomExpiration(!1);return!1}}if(String(this.sharingLinkExpirationNumDays())===String(o)){var r;if(o<0||730<o)r=this.sharingLinksSelectorStrings.LinkExpiration_InvalidValueErrorMessage;else if(this._enforceRequiredAnonymousLinkExpiration&&o>this._adminRequiredAnonymousLinkExpirationInDays){var a=v.getLocalizedCountValue(this.sharingLinksSelectorStrings.LinkExpiration_AdminRequiredValueErrorMessage,this.sharingLinksSelectorStrings.LinkExpiration_ExpirationDaysIntervals,this._adminRequiredAnonymousLinkExpirationInDays);r=v.format(a,this._adminRequiredAnonymousLinkExpirationInDays)}if(r)this._handleSharingLinkError(r);else{var s=0<o?this._calculateLinkExpiration(1440*o):null;this.sharingLinkError("");this.processingSharingLink(!0);var l={type:this.currentSharingLink().type,role:this.currentSharingLink().role,create:!0,expiration:s};this._sharingProvider.manageSharingLinks([this._getCurrentItem()],l).then(function(e){n.processingSharingLink(!1);if(null!=e&&0<e.length){var t=n.currentSharingLink(),i=e[0];t.url=i.url;t.expiration=i.expiration;t.isActive=!!t.url;n._setCurrentSharingLink(t);if(n._enforceRequiredAnonymousLinkExpiration&&o>n.sharingLinkExpirationNumDays.peek()){n._adminRequiredAnonymousLinkExpirationInDays=n.sharingLinkExpirationNumDays();var r=v.getLocalizedCountValue(n.sharingLinksSelectorStrings.LinkExpiration_AdminRequiredValueMessage,n.sharingLinksSelectorStrings.LinkExpiration_ExpirationDaysIntervals,n._adminRequiredAnonymousLinkExpirationInDays);n._handleSharingLinkError(v.format(r,n._adminRequiredAnonymousLinkExpirationInDays))}}},function(e){n._handleSharingLinkError()})}}};e.prototype.onClickCancelCustomExpiration=function(e,t){if(this.processingSharingLink())return!1;this.shouldShowCustomExpiration(!1);this.sharingLinkError("")};e.prototype._calculateDays=function(e){var t=new Date(e),i=new Date;return Math.round((t.getTime()-i.getTime())/864e5)};e.prototype._getAvailableExpirationOptions=function(){var o=this,a=[];a[this.sharingLinksSelectorStrings.LinkExpiration_Never]=0;[1,30,60].forEach(function(e,t,i){var r=1===e?o.sharingLinksSelectorStrings.LinkExpiration_SingleDay:v.format(o.sharingLinksSelectorStrings.LinkExpiration_MultiDay,e),n=1440*e;a[r]=n});a[this.sharingLinksSelectorStrings.LinkExpiration_Custom]=-1;return a};e.prototype._getSharingLinks=function(){var i=this;return this._sharingProvider.getSharingData(this._getCurrentItem()).getLinks().then(function(e){var t=!1;e&&e.forEach(function(e){5!==e.type&&6!==e.type||!e.isActive||(t=!0)});i._guestLinkExists(t);return e.filter(function(e){return 6!==e.kind})},function(e){i.error(i.sharingLinksSelectorStrings.ServerError);i.hasLoadingError(!0);return null})};e.prototype._setCurrentSharingLink=function(e){if(e){this.currentSharingLink(e);this._setCurrentLinkLabelText(e);5!==e.type&&6!==e.type||!e.isActive||this._guestLinkExists(!0);this.canRemoveCurrentSharingLink(8!==e.type&&this.canManageLinks);this.shouldShowLinkExpiration(e.supportsExpiration&&!!e.url);if(e.supportsExpiration){var t=e.expiration?new Date(e.expiration):null,i=I.getShortDisplayDate(t);this.sharingLinkExpirationDate(i?v.format(this.sharingLinksSelectorStrings.LinkExpiration_DateDescription,i):"");this.sharingLinkExpirationLabel(i?this.sharingLinksSelectorStrings.UpdateSharingLinkExpiration:this.sharingLinksSelectorStrings.SetSharingLinkExpiration);this.sharingLinkExpirationNumDays(P.getNumberOfDaysUntilExpiry(t));this.shouldShowCustomExpiration(!1)}}};e.prototype._setCurrentLinkLabelText=function(e){this.linkSelectorCurrentLabelText(this._getLinkLabelText(e))};e.prototype._getLinkLabelText=function(e){if(e)switch(e.type){case 8:return this.sharingLinksSelectorStrings.DirectLinkLabel;case 9:var t=this._companyDisplayName()?v.format(this.sharingLinksSelectorStrings.OrganizationTenantAccountRequired,this._companyDisplayName()):this.sharingLinksSelectorStrings.OrganizationAccountRequired;return v.format(2===e.role?this.sharingLinksSelectorStrings.DropdownEditLabel:this.sharingLinksSelectorStrings.DropdownViewOnlyLabel,t);case 5:return v.format(this.sharingLinksSelectorStrings.DropdownViewOnlyLabel,this.sharingLinksSelectorStrings.NoSignInRequiredLabel);case 6:return v.format(this.sharingLinksSelectorStrings.DropdownEditLabel,this.sharingLinksSelectorStrings.NoSignInRequiredLabel)}return""};e.prototype._getLinkExpiration=function(e){if(!e.expiration&&e.supportsExpiration&&this._enforceRequiredAnonymousLinkExpiration){e.expiration=this._calculateLinkExpiration(1440*this._adminRequiredAnonymousLinkExpirationInDays)}return e.expiration};e.prototype._calculateLinkExpiration=function(e){if(0<e){var t=new Date;t.setUTCMinutes(t.getUTCMinutes()+e);return t.toString()}return null};e.prototype._getCurrentItem=function(){return this._item?this._item:a.utils.unwrapObservable(this._selectionModel.selection()[0])};e.prototype._handleSharingLinkError=function(e){this.processingSharingLink(!1);this.sharingLinkError(e||this.sharingLinksSelectorStrings.ServerError)};return e}(r.default);t.default=o});define("aes",["require","exports","ap","g4","aC","aI","DI"],function(e,t,r,i,o,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="SwitchSharingLink";t._items=e.items;t._newLink=e.link;t._successCallback=e.successCallback;t._failureCallback=e.failureCallback;t._isExecuting=e.isExecuting;t._sharingProvider=t.resources.consume(n.resourceKey);t._expiration=e.expiration;return t}e.prototype.onExecute=function(e,t){var n=this,i=this._expiration&&"CUSTOM"!==this._expiration?new Date(this._expiration).toLocaleDateString():null,r=this._newLink.expiration?new Date(this._newLink.expiration).toLocaleDateString():null;if(this._expiration&&"CUSTOM"!==this._expiration&&i!==r||!this._expiration&&this._newLink.expiration){this._isExecuting&&this._isExecuting(!0);return new o.default(function(t,e){var i={},r={type:n._newLink.type,role:n._newLink.role,create:!0,expiration:n._expiration};n._sharingProvider.manageSharingLinks(n._items,r).then(function(e){n._successCallback&&n._successCallback(e[0]);i.resultType=a.ResultTypeEnum.Success;t(i)},function(e){n._failureCallback&&n._failureCallback(e&&e.message?e.message.value:"");i.resultType=a.ResultTypeEnum.Failure;t(i)})})}if(this._newLink.isActive){this._successCallback&&this._successCallback(this._newLink,this._expiration);return o.default.wrap({resultType:a.ResultTypeEnum.Success})}this._successCallback(this._newLink);return o.default.wrap({resultType:a.ResultTypeEnum.Success})};e.prototype.onIsAvailable=function(){return!0};return e}(i.default);t.default=s});define("ac3",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function t(){}t.CopyToClipboard=function(e){return!!t.CanUseClipboardData()&&window.clipboardData.setData("Text",e)};t.CanUseClipboardData=function(){var e=window;return e&&void 0!==e.clipboardData&&void 0!==e.clipboardData.setData};return t}();t.default=i});define("aeq",[],function(){return'\x3c!--ko if:loading--\x3e<div class=od-SharingLinksSelector-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e<div aria-live=assertive class=od-SharingLinksSelector-error data-bind="if: error"><span data-bind="text: error"></span></div><div class=od-SharingLinksSelector-sharingLinkSelector data-bind="ifnot: hasLoadingError"><div class=od-SharingLinksSelector-linkPickerArea data-bind="dismiss: onDismissSharingLinksMenu">\x3c!--ko if:isSingleLinkLabelVisible--\x3e<span class=od-SharingLinksSelector-linkInput-label data-bind="text: linkSelectorCurrentLabelText()"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot:isSingleLinkLabelVisible--\x3e<a href=javascript:; class="od-SharingLinksSelector-dropdownLinkContainer ms-fontColor-neutralPrimary ms-lines ms-fullWidth" aria-haspopup=true data-bind="click: onClickSharingLinkMenu, attr: {\'aria-expanded\': isSharingLinkMenuOpen}"><span class=od-SharingLinksSelector-dropdownText data-bind="text: linkSelectorCurrentLabelText()"></span> <i class="ms-Icon ms-Icon--ChevronDown od-SharingLinksSelector-dropdownArrow" data-bind="icon: true, title: sharingLinksSelectorStrings.OpenMenuTooltip"></i></a>\x3c!--ko if: isSharingLinkMenuOpen()--\x3e<div data-bind="component: { name: \'ms-contextual-menu\', params: { items: sharingLinkMenuItems, isOpen: isSharingLinkMenuOpen, alignment: menuAlignment, left: menuLeft, target: $element.parentElement } }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class="Sharing-table od-SharingLinksSelector-linkBoxArea" aria-live=polite><div class=Sharing-row>\x3c!--ko if: currentSharingLink().url--\x3e<div class="Sharing-cell od-SharingLinksSelector-linksArea"><input class=od-SharingLinksSelector-linkInput-textbox type=text role=textbox readonly data-bind="selectOnFocus: { isPermanent: true }, value: currentSharingLink().url, event: { copy: copySharingLink }, disable: processingSharingLink, attr: { \'aria-label\': inputAriaLabel, title: currentSharingLink().url }, hasFocus: inputHasFocus"></div><div data-bind="visible: shouldShowSharingLinkCopyButton" class=Sharing-cell><button class="od-Dialog-action od-Button od-Button--primary od-SharingLinksSelector-copyCreateButton" data-bind="click: onClickCopyLink"><span class="od-Button-label od-SharingLinksSelector-copyCreateButton-label" data-bind="text: sharingLinksSelectorStrings.CopyLink"></span></button></div>\x3c!--/ko--\x3e\x3c!--ko if: !currentSharingLink().url && canManageLinks--\x3e<div class=Sharing-cell><button class="od-Dialog-action od-Button od-Button--primary od-SharingLinksSelector-copyCreateButton" data-bind="click: onClickCreateLink"><span class="od-Button-label od-SharingLinksSelector-copyCreateButton" data-bind="text: createLinkButtonText"></span></button></div>\x3c!--/ko--\x3e\x3c!--ko if: currentSharingLink().url--\x3e<div class=Sharing-cell><button class=od-SharingLinksSelector-updateLinkButton data-bind="visible: canRemoveCurrentSharingLink, text: sharingLinksSelectorStrings.RemoveLink, click: removeSharingLink, automation: \'SharingLinksSelector-removeLink\'"></button></div>\x3c!--/ko--\x3e</div><div class="Sharing-row od-SharingLinksSelector-progressBox" data-bind="component: {name: progressSpinnerFlatTagName}, visibility: processingSharingLink"></div></div>\x3c!--ko if:shouldShowLinkExpiration--\x3e<div class=od-SharingLinksSelector-linkExpirationArea><div data-bind="visible: !shouldShowCustomExpiration() && currentSharingLink().url, automation: \'SharingLinksSelector-expiration-selector\'"><span class=od-SharingLinksSelector-expiration-expirationText data-bind="visible: !!sharingLinkExpirationDate(), text: sharingLinkExpirationDate, automation: \'SharingLinksSelector-expiration-expirationSpan\'"></span> <span class=od-SharingLinksSelector-LinkExpirationMenuArea`><button class="od-SharingLinksSelector-updateLinkButton od-SharingLinksSelector-expiration-dropdownLinkContainer" aria-haspopup=true data-bind="click: onClickLinkExpirationMenu, dismiss: onDismissLinkExpirationMenu, attr: { \'aria-expanded\': isLinkExpirationMenuOpen }"><span class="od-SharingLinksSelector-expiration-dropdownText ms-uppercase" data-bind="text: sharingLinkExpirationLabel"></span> <i class="ms-Icon ms-Icon--ChevronDown ms-callout-icon od-SharingLinksSelector-expiration-dropdownArrow" data-bind="icon: true, visible: shouldShowSetExpirationDropDown, title: sharingLinksSelectorStrings.OpenMenuTooltip"></i></button><ms-contextual-menu params="{ items: linkExpirationMenuItems, isOpen: isLinkExpirationMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu></span></div><div class=ms-fullWidth data-bind="visible: shouldShowCustomExpiration"><div class=od-SharingLinksSelector-expiration-expirationText><span data-bind="text: sharingLinksSelectorStrings.LinkExpiration_CustomValueLabel_BeforeTextBox"></span> <input type=text class=od-SharingLinksSelector-expirationInput data-bind="selectOnFocus: { isPermanent: true }, value: sharingLinkExpirationNumDays, title: sharingLinksSelectorStrings.LinkExpiration_CustomValueTooltip"> <span data-bind="text: sharingLinksSelectorStrings.LinkExpiration_CustomValueLabel_AfterTextBox"></span></div><div class=od-SharingLinksSelector-expiration-buttons><button class="od-SharingLinksSelector-updateLinkButton od-SharingLinksSelector-expiration-expirationSave" data-bind="click: onClickSaveCustomExpiration, text: sharingLinksSelectorStrings.SaveCustomExpiration, automation: \'SharingLinksSelector-expiration-saveLink\'"></button> <button class="od-SharingLinksSelector-updateLinkButton od-SharingLinksSelector-expiration-expirationSave" data-bind="click: onClickCancelCustomExpiration, text: sharingLinksSelectorStrings.CancelCustomExpiration, automation: \'SharingLinksSelector-expiration-cancelLink\'"></button></div></div></div>\x3c!--/ko--\x3e<div aria-live=assertive class=od-SharingLinksSelector-error data-bind="if: sharingLinkError"><span data-bind="text: sharingLinkError"></span></div></div>\x3c!--/ko--\x3e'});define("aep",["c","az"],function(e,t){e.loadStyles([{rawString:".od-SharingLinksSelector-sharingLinkSelector{height:200px}.od-SharingLinksSelector-loadingSpinner{text-align:center;padding:75px 0}.od-SharingLinksSelector-linkInput-label{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';display:block;padding-top:5px}.od-SharingLinksSelector-linkInput-textbox{width:75%;padding:1px 5px 2px 10px;text-overflow:ellipsis}html[dir=rtl] .od-SharingLinksSelector-linkInput-textbox{padding:1px 10px 2px 5px}[dir=ltr] .od-SharingLinksSelector-linkInput-textbox{margin-right:15px}[dir=rtl] .od-SharingLinksSelector-linkInput-textbox{margin-left:15px}.od-SharingLinksSelector-linksArea{width:100%}.od-SharingLinksSelector-updateLinkButton{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;text-transform:uppercase;white-space:nowrap;cursor:pointer;background:0 0;border:none;color:'},{theme:"blue",defaultValue:"#0078d4"},{rawString:";padding:0}.od-SharingLinksSelector-updateLinkButton:focus,.od-SharingLinksSelector-updateLinkButton:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-SharingLinksSelector-linksSection{padding-bottom:20px}.od-SharingLinksSelector-error{color:#a80000}.od-SharingLinksSelector-linkPickerArea{margin-bottom:14px;white-space:nowrap}.od-SharingLinksSelector-dropdownLinkContainer{display:inline-block;box-sizing:border-box;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";width:433px;padding:4px 10px;padding-bottom:2px}@media (max-width:639px){.od-SharingLinksSelector-dropdownLinkContainer{width:223px}}.od-SharingLinksSelector-dropdownLinkContainer:hover,.od-SharingLinksSelector-dropdownLinkContainer:visited{color:inherit;text-decoration:none}.od-SharingLinksSelector-dropdownArrow,.od-SharingLinksSelector-expiration-dropdownArrow{display:inline-block;position:relative;top:-1px}.sm .od-SharingLinksSelector-dropdownArrow,.sm .od-SharingLinksSelector-expiration-dropdownArrow{top:1px}.od-SharingLinksSelector-linkTypeText{padding:10px}.od-SharingLinksSelector-expiry-div{border-collapse:separate}.od-SharingLinksSelector-singleLinkLabel{display:inline-block;width:433px;padding:4px 0;margin-bottom:5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width:639px){.od-SharingLinksSelector-singleLinkLabel{width:223px}}.od-SharingLinksSelector-dropdownText{display:inline-block;width:393px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width:639px){.od-SharingLinksSelector-dropdownText{width:183px}}.od-SharingLinksSelector-expiration-dropdownText{display:inline-block;overflow:hidden}.od-SharingLinksSelector-linkBoxArea{margin-bottom:5px}.od-SharingLinksSelector-sharingLinkSelector .od-SharingLinksSelector-linkInput-textbox{box-sizing:border-box;width:95%}button.od-SharingLinksSelector-copyCreateButton{min-width:90px}[dir=ltr] button.od-SharingLinksSelector-copyCreateButton{margin-right:15px}[dir=rtl] button.od-SharingLinksSelector-copyCreateButton{margin-left:15px}.od-SharingLinksSelector-copyCreateButton-label{position:relative;top:-1px}.od-SharingLinksSelector-linkExpirationArea{margin-bottom:7px}.od-SharingLinksSelector-LinkExpirationMenuArea{display:inline-block}.od-SharingLinksSelector-expiration-dropdownLinkContainer{display:inline-block;vertical-align:middle}.od-SharingLinksSelector-expiration-expirationText{display:inline-block}[dir=ltr] .od-SharingLinksSelector-expiration-expirationText{padding-right:10px}[dir=rtl] .od-SharingLinksSelector-expiration-expirationText{padding-left:10px}.od-SharingLinksSelector-expirationInput{display:inline-block;width:30px;margin-top:-5px;cursor:text}.od-SharingLinksSelector-expiration-buttons{display:inline-block}.od-SharingLinksSelector-expiration-expirationSave{display:inline-block;vertical-align:text-bottom}[dir=ltr] .od-SharingLinksSelector-expiration-expirationSave{margin-right:10px}[dir=rtl] .od-SharingLinksSelector-expiration-expirationSave{margin-left:10px}.od-SharingLinksSelector-expiration-expirationError{margin-top:6px}"}])});define("aeF",["require","exports","aeI","b5","aeH","aeG","XU"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-share-by-email",template:e("aeH"),viewModel:i.default});t.default=n});define("aeI",["require","exports","ap","cE","dZ","ba","DI","eO","aq","lB","qY","XU","DL","acI","V","bF","eX","hs","ac9","OX"],function(e,t,i,o,a,s,r,l,c,d,u,p,m,h,f,n,g,b,_,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.loadingSpinnerTagName=d.default.tagName;t.peoplePickerTagName=p.default.tagName;t.sharingTipsTagName=h.default.tagName;t._params=e;t._items=e.items;t._itemProvider=t.resources.consume(g.resourceKey);t._engagement=t.resources.consume(o.resourceKey);t._expiration=t.wrapObservable(e.expiration);var i=t._expiration&&t._expiration.peek();t.expirationLabel=i?b.getShortDisplayDate(new Date(t._expiration.peek())):null;t.isPasswordProtectedLink=t._params.currentLink&&t._params.currentLink.peek()&&t._params.currentLink.peek().hasPassword;var r=t._items[0].key;t.item=t._itemProvider.getItemSync({parentKey:r}).item;t._referenceRevision=t.createPureComputed(function(){return t.item().revision});t._isDoneGettingSharingSettings=t.createObservable(!1);t.canUserShareExternally=t._params.canUserShareExternally||t.observables.create(!1);t.policyTipInfo=t.createObservable(null);t._policyTipDataSource=t.resources.isExposed(a.policyTip)?t.resources.consume(a.policyTip):null;t.showShareButton=!!e.onExecuteAction;t.permissionLabel=m.strings.PermissionLabel;t.passwordProtectedLabel=m.strings.PasswordProtectedLabel;t.arePasswordProtectedLinksEnabled=s.isFeatureEnabled(s.EnablePasswordProtectedLinks);t.inputPlaceholder=m.strings.EmailPlaceholder;t.sendEmailLabel=m.strings.EmailInvitation;t.requireSignInLabel=m.strings.RequireSignInLabel;t.propagateSharingLabel=m.strings.PropagateSharingLabel;t.requireSignInTooltip=m.strings.RequireSignInTooltip;t.shareButtonText=m.strings.ShareText;t.charLimitVisible=c.observable(!1);t.charLimitReached=t._params.emailMessageExceedsLimit;t.charCountText=c.observable("");t._emailCharLimit=-1;t.canSendEmail=c.observable(!1);t.canSendLink=c.observable(!1);t.supportsSharingPropagation=c.observable(!1);t.sharingRoleOptions=c.observableArray([]);t.hideOptions=!!e.hideOptions;t.showSendEmailOption=e.showSendEmailOption;t.propagateSharing=e.propagateSharing;t.currentSharingLink=e.currentLink;t.hasSharingLink=!!t.currentSharingLink&&null!==t.currentSharingLink();if(t.hasSharingLink){t.requireSignIn=t.createComputed(function(){var e=t.currentSharingLink();return 6!==e.type&&5!==e.type});t.roleSelection=t.createComputed(function(){return t.currentSharingLink().role.toString()});t.linkType=t.createComputed(function(){return t.currentSharingLink().type});t.sendEmail=c.observable(!0)}else{t.requireSignIn=e.requireSignIn;t.roleSelection=e.roleValue;t.linkType=e.linkType?t.createObservable(e.linkType):t.createObservable(8);t.sendEmail=e.sendEmail}t.emailInputText=e.emailMessage||c.observable("");t.error=e.errorMessage||c.observable("");t._canCurrentUserShareExternally=t.createObservable(!1);t.loading=c.observable(!0);t.hasLoadingError=c.observable(!1);t.sharedWithSize=c.observable(2);t.shareAvailable=t.createComputed(t._computeShareAvailable);t.createComputed(t._computeValidateMessageLength);t.peopleSharingWith=c.observableArray([]);t.resources.bind(u.resourceKey);t._sharingSettings2=t.observables.create(null);t.ppQueryParams=t.createPureComputed(t._computePeoplePickerQueryParams);t.policyTipType=t.createPureComputed(t._computePolicyTipType);t.blockViaPolicy=t.createPureComputed(t._computeBlockViaPolicy);t._policyTipDataSource&&(t.policyTipType?t._policyTipDataSource.getPolicyTip(t.item.peek()).done(function(e){e&&e.issueDescriptions&&e.issueDescriptions.length&&t.policyTipInfo(e)}):t.policyTipInfo(null));t.sharingTipsParams=t.createComputed(t._computeSharingTipsParams);t.missingItemError=t._items[0].type===l.default.Folder?m.strings.MissingFolderError:m.strings.MissingFileError;t.sharingError=t.createObservable("");t.getSharingSettings(!!t.item.peek().policyTip);t.createBackgroundComputed(t._refreshSharingSettings);return t}e.prototype.requireSignInChanged=function(){this.requireSignIn()&&this.sendEmail(!0)};e.prototype.shareClicked=function(){var e;e=1<this._items.length?this._items:[this.item.peek()];var t=this.resources.consume(r.resourceKey),i={items:e,roleValue:this.roleSelection.peek(),message:this._params.emailMessage.peek(),sendEmail:this.sendEmail.peek(),requireSignIn:this.requireSignIn.peek(),propagateSharing:this._params.propagateSharing.peek(),expiration:this._expiration.peek()};this._engagement.logData({name:"Share.SharingDialog.Click",isIntentional:!0});t.share(this._params.selectedPeople.peek(),i);this._params.onExecuteAction&&this._params.onExecuteAction()};e.prototype._computePolicyTipType=function(){var e=this.item();if(e)return e.policyTip};e.prototype._computeBlockViaPolicy=function(){if(!s.isFeatureEnabled(s.PolicyTipPanel))return!1;var e=this.policyTipType();return e?v.isPolicyTipFlagSet(e,4):void 0};e.prototype._computeSharingTipsParams=function(){if(this._isDoneGettingSharingSettings()){return{selectedPeople:this.peoplePickerParams.selectedPeople,showAdditionalSharingWarning:this.showExternalUserWarning,policyTipType:this.policyTipType(),policyTipInfo:this.policyTipInfo,item:this.item()}}};e.prototype._computeShareAvailable=function(){if(!this._isDoneGettingSharingSettings())return!1;if(this.peoplePickerParams.hasUnresolvedText&&this.peoplePickerParams.hasUnresolvedText())return!1;if(this.blockViaPolicy()&&this.peoplePickerParams&&this.peoplePickerParams.selectedPeopleContainsExternal&&this.peoplePickerParams.selectedPeopleContainsExternal())return!1;for(var e=0,t=this.peoplePickerParams.selectedPeople();e<t.length;e++){if(!t[e].isResolved)return!1}this._emailCharLimit=this._mailSettings&&this._mailSettings.defaultCharacterLimit;this._evaluateMessageLength(this.emailInputText.peek());return!this.charLimitReached()&&0<this.peoplePickerParams.selectedPeople().length};e.prototype._computeValidateMessageLength=function(){var e=this.emailInputText();this._evaluateMessageLength(e)};e.prototype._computePeoplePickerQueryParams=function(){var e=this._sharingSettings2();if(e){var t={maximumEntitySuggestions:30,blockViaPolicy:this.blockViaPolicy()};if(e.pickerProperties){var i=e.pickerProperties;t.principalSource=i.PrincipalSource;t.principalType=i.PrincipalAccountType;t.querySettings=i.QuerySettings;t.allowEmailAddresses=i.AllowEmailAddresses;t.filterExternalUsers=!1}return t}};e.prototype._evaluateMessageLength=function(e){var t=this._getEncodedMessageLength(e),i=this._emailCharLimit;if(9999999999!==i){!this.charLimitVisible.peek()&&t&&i-100<t&&this.charLimitVisible(!0);if(this.charLimitVisible.peek()){this.charCountText(f.format(m.strings.CharacterCounterFormat,t,i));i<t?this.charLimitReached(!0):this.charLimitReached.peek()&&this.charLimitReached(!1)}}else{this.charLimitVisible(!1);this.charLimitReached(!1)}};e.prototype._getEncodedMessageLength=function(e){var t=0,i=e.length,r=0,n=!1;if(!e||0===e.length)return 0;for(var o="&#160;",a="<br />",s="&quot;&quot;&quot;",l="&amp;",c="&#39;",d="&lt;",u="&gt;",p=" ";r<i;){var m=null,h=e[r];if(" "===h)m=r+1<i&&" "===e[r+1]||n?o:" ";else if("\n"===h){m=a;n=!0}else{'"'===h?m=s:"&"===h?m=l:"'"===h?m=c:"<"===h?m=d:">"===h?m=u:"\r"===h&&(m=p);n=!1}t+=null!==m?m.length:1;r++}return t};e.prototype.getSharingSettings=function(e){var i=this,t=this.resources.consume(r.resourceKey).getSharingData(this.item(),e);this.isReady=t.getSettings().then(function(e){i.sharingSettings=e;i._sharingSettings2(e);i.sharingSettings.itemId?i.sharingSettings.blockPeoplePickerAndSharing&&i.sharingError(_.strings.CannotShareText):i.sharingError(i.missingItemError);i.showExternalUserWarning=i.sharingSettings.showAdditionalExternalWarning;i._canCurrentUserShareExternally(i.sharingSettings.canCurrentUserShareExternally);i.peoplePickerParams={selectedPeople:i._params.selectedPeople,selectedPeopleContainsExternal:i._params.selectedPeopleContainsExternal,peoplePickerQueryParams:i.ppQueryParams,hasUnresolvedText:i._params.hasUnresolvedText,contactInviteLimit:e.contactInviteLimit};i.sharingRoleOptions(e.sharingRoles);i._mailSettings=e.mailSettings;i.canSendEmail(e.canSendEmail);i.canSendLink(e.canSendLink);i.supportsSharingPropagation(e.supportsSharingPropagation);i._params.propagateSharing&&i._params.propagateSharing(e.supportsSharingPropagation);i.peopleSharingWith(e.sharedWith);i._isDoneGettingSharingSettings(!0);i.hasLoadingError(!1);i.loading(!1)},function(e){var t=i.item();if(t&&t.parentLink){i._engagement.logData({name:"GetSettings.SharingDialog.Redirect"});window.location.href=t.parentLink+"?sharingDialogForListItemId="+t.id}else{e&&403===e.status?i.error(m.strings.AccessDenied):i.error(m.strings.ServerError);i._isDoneGettingSharingSettings(!0);i.hasLoadingError(!0);i.loading(!1)}})};e.prototype._refreshSharingSettings=function(){var t=this;this._referenceRevision()&&this._itemProvider.getItem({parentKey:this.item.peek().key,skipCache:!0,skipInMemoryCache:!0}).then(function(e){t.getSharingSettings(!0)})};return e}(n.default);t.default=y});define("acI",["require","exports","acQ","b5","acP","acO","acJ"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-sharingTips",template:e("acP"),viewModel:i.default});t.default=n});define("acQ",["require","exports","ap","cE","OX","qH","ba","qY","DM","aq","OY","acI","acR","V","bF"],function(e,t,i,d,u,p,m,h,f,g,r,b,_,v,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(a){i.__extends(c,a);function c(e){var s=a.call(this,e)||this;s.SharingTipsTagName=b.default.tagName;var t=e.showPolicyTip,i=void 0===t?m.isFeatureEnabled(m.PolicyTipPanel):t;s.addBindingHandlers({bindableHtml:p.default});var l=s._engagement=s.resources.consume(d.resourceKey);s._item=e.item;s._policyTipType=e.policyTipType;s._policyTipInfo=e.policyTipInfo;s.hasPolicyTip=s.createObservable(s._item&&u.isPolicyTipFlagSet(s._item.policyTip,4));s.policyTipText=u.getPolicyTipText(s._policyTipType,"onViewPolicyTipClick");s._resolvedUsers=e.selectedPeople;s.showAdvancedMessage=e.showAdditionalSharingWarning;s.showPolicyTip=i;s.advancedWarningText=_.strings.GallatinMessage;s.multiExternalUserText=g.observable("");s.expandUsersText=g.observable(_.strings.Show);s.expandGroupsText=g.observable(_.strings.Show);s.showMultiUsers=g.observable(!1);s.isUserBlocked=g.observable(!1);s.showGroups=g.observable(!1);s.singleExternalUserText=g.observable("");s.groupsText=g.observable("");s.groupsMemberCountText=g.observable("");s._renderedExternalUsers=!1;s._renderedGroups=!1;s._peoplePickerProvider=s.resources.consume(f.resourceKey);s._pickerEntityInformations=[];if(e.pickerEntityInformations)for(var r=0,n=e.pickerEntityInformations;r<n.length;r++){var o=n[r];s._pickerEntityInformations[o.person.userId]=o}s.externalUsers=s.createComputed(function(){for(var e=!1,t=[],i=0,r=s._resolvedUsers();i<r.length;i++){var n=r[i];if(1===n.entityType){var o=n.rawPersonData.EntityData.IsBlocked;e=e||o&&"true"===o.toLowerCase();t.push(n)}}s.isUserBlocked(e);if(1===t.length){var a='<span class="od-SharingTips-resolvedUser">'+(t[0].email||t[0].name)+"</span>";s.singleExternalUserText(v.format(e?_.strings.SingleEmailBlockedByAllowDenyList:_.strings.SingleExternalUserText,a));s.showMultiUsers(!1)}else 1<t.length&&s.multiExternalUserText(e?_.strings.MultipleEmailBlockedByAllowDenyList:_.strings.MultiExternalUserText);if(0<t.length&&!s._renderedExternalUsers){s._renderedExternalUsers=!0;s._engagement.logData({name:"ExternalUsers.SharingTips.Render"})}return t});s.groups=s.createComputed(function(){for(var e=[],t=0,i=0,r=s._resolvedUsers();i<r.length;i++){var n=r[i];if(2===n.entityType){var o={group:n,memberCountText:g.observable("")};if(m.isFeatureEnabled(m.OversharingMitigations)){var a=s.getGroupMemberCount(o);t+=a;o.memberCountText(c.getMemberCountText(a,!1))}e.push(o)}}1<e.length?s.groupsText(v.format(_.strings.MultiGroupText,e.length)):s.groupsText(v.format(_.strings.SingleGroupText,e.length));s.groupsMemberCountText(c.getMemberCountText(t,!0));if(0<e.length&&!s._renderedGroups){s._renderedGroups=!0;l.logData({name:"Groups.SharingTips.Render"})}return e});s.resources.bind(h.resourceKey);s._panelProvider=s.resources.consume(h.resourceKey);return s}c.getMemberCountText=function(e,t){return 1===e?t?_.strings.GroupOneMemberCountText:_.strings.SingleGroupOneMemberCountText:1<e&&e<1e3?v.format(t?_.strings.GroupMemberCountText:_.strings.SingleGroupMemberCountText,e):1e3<=e?t?_.strings.GroupMemberCountTextGreaterThan1000:_.strings.SingleGroupMemberCountTextGreaterThan1000:""};c.prototype.onViewPolicyTipClick=function(){var e={item:this._item,policyTipInfo:this._policyTipInfo()};this._panelProvider.requestPanel({component:{name:r.default.tagName,params:e}})};c.prototype.clickExpandUsers=function(){if(this.showMultiUsers()){this.expandUsersText(_.strings.Show);this.showMultiUsers(!1)}else{this._engagement.logData({name:"ExpandUsers.SharingTips.Click",isIntentional:!0});this.expandUsersText(_.strings.Hide);this.showMultiUsers(!0)}};c.prototype.clickExpandGroups=function(){if(this.showGroups()){this.expandGroupsText(_.strings.Show);this.showGroups(!1)}else{this._engagement.logData({name:"ExpandGroups.SharingTips.Click",isIntentional:!0});this.expandGroupsText(_.strings.Hide);this.showGroups(!0)}};c.prototype.getGroupMemberCount=function(e){var t=0;this._pickerEntityInformations[e.group.userId]?t=this._pickerEntityInformations[e.group.userId].totalMemberCount:this._retrievePickerEntityInformation(e);return t};c.prototype.updateGroupsMemberCountText=function(){for(var e=0,t=0,i=this._resolvedUsers();t<i.length;t++){var r=i[t];2===r.entityType&&this._pickerEntityInformations[r.userId]&&(e+=this._pickerEntityInformations[r.userId].totalMemberCount)}this.groupsMemberCountText(c.getMemberCountText(e,!0))};c.prototype._retrievePickerEntityInformation=function(t){var i=this;this._peoplePickerProvider.getPickerEntityInformation(t.group).then(function(e){i._pickerEntityInformations[t.group.userId]=e;t.memberCountText(c.getMemberCountText(e.totalMemberCount,!1));i.updateGroupsMemberCountText()},function(e){})};return c}(n.default);t.default=o});define("acP",[],function(){return'<div class=od-SharingTips><div class=od-SharingTips-section data-bind="if: externalUsers().length > 0"><div data-bind="if: externalUsers().length === 1"><div class=od-SharingTips-singleExternalUser data-bind="html: singleExternalUserText, css: {\'od-SharingTips-error\': isUserBlocked}"></div></div><div data-bind="if: externalUsers().length > 1"><span class=od-SharingTips-multiUser data-bind="text: multiExternalUserText, css: {\'od-SharingTips-error\': isUserBlocked}"></span> <button class=od-SharingTips-expandLink data-bind="text: expandUsersText, click: clickExpandUsers"></button><div>\x3c!--ko if: showMultiUsers--\x3e<ul class=od-SharingTips-multiUserList data-bind="foreach: externalUsers"><li class=od-SharingTips-resolvedUser data-bind="text: email || name"></li></ul>\x3c!--/ko--\x3e</div></div><ms-dlplite></ms-dlplite>\x3c!--ko if: showAdvancedMessage--\x3e<div data-bind="text: advancedWarningText"></div>\x3c!--/ko--\x3e\x3c!--ko if: hasPolicyTip() && showPolicyTip--\x3e<div class=od-SharingTips-policyTip data-bind="bindableHtml: policyTipText"></div>\x3c!--/ko--\x3e</div><div class=od-SharingTips-section data-bind="if: groups().length > 0"><span class=od-SharingTips-multiUser data-bind="text: groupsText"></span> <span class=od-SharingTips-groupsMemberCount data-bind="text: groupsMemberCountText"></span> <button class=od-SharingTips-expandLink data-bind="text: expandGroupsText, click: clickExpandGroups"></button><div>\x3c!--ko if: showGroups--\x3e<ul class=od-SharingTips-multiUserList data-bind="foreach: groups"><li class=od-SharingTips-resolvedUser><span data-bind="text: group.name"></span> <span data-bind="text: memberCountText"></span></li></ul>\x3c!--/ko--\x3e</div></div>\x3c!--ko component: { name: \'ms-panel-host\' }--\x3e\x3c!--/ko--\x3e</div>'});define("acO",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-SharingTips-section{margin-top:6px}[dir=ltr] .od-SharingTips-section{margin-left:6px}[dir=rtl] .od-SharingTips-section{margin-right:6px}.od-SharingTips-resolvedUser{display:inline-block;font-weight:700}.od-SharingTips-multiUserList{display:inline;list-style:none;padding:0}.od-SharingTips-multiUserList li{display:inline}.od-SharingTips-multiUserList li:after{content:", "}.od-SharingTips-multiUserList li:last-child:after{content:""}.od-SharingTips-expandLink{color:'},{theme:"blue",defaultValue:"#0078d4"},{rawString:";background:0 0;border:none;padding:0;cursor:pointer}.od-SharingTips-expandLink:focus,.od-SharingTips-expandLink:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-SharingTips-error{color:#a80000}.od-SharingTips-policyTip{color:#a80000;margin-top:6px}"}])});define("acJ",["require","exports","acM","b5","acL","acK"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-dlplite",template:e("acL"),viewModel:i.default});t.default=n});define("acM",["require","exports","ap","bF","aq","acN","dZ"],function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this)||this;t.strings=o.strings;t.isVisible=n.observable(!1);t.externalSharingLearnUrl=n.observable("javascript:");t.resources.consume(a.policyTip).getExternalSharingStatus().then(function(e){if(e){t.isVisible(e.isExternalSharingTipEnabled);t.externalSharingLearnUrl(e.externalSharingTipsLearnMoreUrl)}},function(e){});return t}return e}(i.default);t.default=s});define("acL",[],function(){return'<div class=ms-DlpLite data-bind="visible: isVisible"><span class=ms-DlpLite-middle data-bind="text: strings.bannerWarning"></span> <a class=ms-DlpLite-middle target=_blank data-bind="text:strings.learnMore, attr: {href: externalSharingLearnUrl}"></a></div>'});define("acK",["c","az"],function(e,t){e.loadStyles([{rawString:".ms-DlpLite{overflow:hidden}"}])});define("aeH",[],function(){return'<div class=Sharing>\x3c!--ko if:loading--\x3e<div class=Sharing-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if: !sharingError()--\x3e\x3c!--ko ifnot:loading--\x3e<div class=Sharing-table data-bind="ifnot: hasLoadingError"><div class=Sharing-row><div class="Sharing-cell Sharing-peoplePicker" id=Sharing-peoplePicker data-bind="component: {name: peoplePickerTagName, params: peoplePickerParams}"></div>\x3c!--ko if: !hasSharingLink--\x3e<select class="Sharing-cell Sharing-simpleRoleSelector" data-bind="foreach: sharingRoleOptions, value: roleSelection, attr: {\'aria-label\': permissionLabel }, visible: sharingRoleOptions().length > 0"><option data-bind="text: name, value: value"></option></select>\x3c!--/ko--\x3e</div></div><div aria-live=assertive class=PeoplePicker-error data-bind="if: error"><span data-bind="text: error"></span></div><div data-bind="ifnot: hasLoadingError"><div aria-live=polite data-bind="component: { name: sharingTipsTagName, params: sharingTipsParams }"></div></div><div class=od-ShareByEmail-textInput data-bind="visible: canSendEmail()"><textarea class=Sharing-mailInput data-bind="enable: sendEmail, textInput: emailInputText, attr: { placeholder: inputPlaceholder }">\r\n        </textarea>\x3c!--ko if: expirationLabel--\x3e<div class=od-ShareByEmail-expirationLabel><i class="od-ShareByEmail-expirationIcon ms-Icon ms-Icon--Calendar" data-bind="icon: true"></i> <span class=od-ShareByEmail-expirationText data-bind="text: expirationLabel"></span></div>\x3c!--/ko--\x3e\x3c!--ko if: arePasswordProtectedLinksEnabled--\x3e\x3c!--ko if: isPasswordProtectedLink--\x3e<div class=od-ShareByEmail-passwordLabel><i class="ms-Icon ms-Icon--Lock" data-bind="icon: true"></i> <span class=od-ShareByEmail-passwordProtectedText data-bind="text: passwordProtectedLabel"></span></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: !hasSharingLink--\x3e<div class=Sharing-link data-bind="visible: supportsSharingPropagation()"><input id=Sharing-aclPropagation type=checkbox data-bind="checked: propagateSharing"> <label for=Sharing-aclPropagation class=Sharing-aclPropagationLabel data-bind="text: propagateSharingLabel"></label></div><div class=Sharing-options data-bind="visible: canSendEmail() && sharingRoleOptions().length > 0 && !hideOptions"><div class=Sharing-link data-bind="visible: canSendLink"><input id=Sharing-requireSignIn type=checkbox data-bind="checked: requireSignIn, event: { change: requireSignInChanged }"> <label for=Sharing-requireSignIn data-bind="text: requireSignInLabel, attr: { title: requireSignInTooltip }"></label></div><div class=Sharing-link data-bind="visible: showSendEmailOption"><input id=Sharing-sendEmailCheckbox type=checkbox data-bind="checked: sendEmail, enable: requireSignIn()"> <label for=Sharing-sendEmailCheckbox data-bind="text: sendEmailLabel"></label></div></div>\x3c!--/ko--\x3e<div class=Sharing-charCounter data-bind="visible: charLimitVisible, css: { \'Sharing-charCounter--limitReached\': charLimitReached }, text: charCountText" aria-live=polite></div><div class=ms-clearfix></div>\x3c!--ko if: showShareButton--\x3e<div class=Sharing-submit><button class="Sharing-submitButton od-Button od-Button--primary" data-bind="click: shareClicked, enable: shareAvailable, automation: \'shareDialogCommit\'"><span class=od-Button-label data-bind="text: shareButtonText"></span></button></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: sharingError()--\x3e<div class=od-ShareByEmail-error data-bind="text: sharingError" aria-live=assertive></div>\x3c!--/ko--\x3e\x3c!--ko component: { name: \'ms-panel-host\' }--\x3e\x3c!--/ko--\x3e</div>'});define("aeG",["c","az"],function(e,t){e.loadStyles([{rawString:".Sharing{overflow:hidden}.Sharing .Sharing-requireSignInLabel{border-bottom-style:dotted;border-bottom-width:1px}.Sharing-options{width:85%}html[dir=ltr] .Sharing-options{float:left}html[dir=rtl] .Sharing-options{float:right}html[dir=ltr] .Sharing-charCounter{text-align:right}html[dir=rtl] .Sharing-charCounter{text-align:left}.Sharing-charCounter--limitReached{color:#a80000}.Sharing-submitButton{position:relative;width:100%;height:30px;margin-top:5px}html[dir=ltr] .Sharing-submit{float:right}html[dir=rtl] .Sharing-submit{float:left}.Sharing-loadingSpinner{text-align:center;padding:75px 0}.Sharing-table{display:table;width:100%;border-collapse:collapse}.Sharing-row{display:table-row;width:100%}.Sharing-cell{display:table-cell}.Sharing-peoplePicker{width:100%;vertical-align:top}.Sharing-link{padding-bottom:5px}.Sharing-simpleRoleSelector{padding:2px;vertical-align:top;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:';font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;height:33px}[dir=ltr] .Sharing-simpleRoleSelector{margin-left:8px}[dir=rtl] .Sharing-simpleRoleSelector{margin-right:8px}.Sharing-mailInput{resize:none;height:80px;width:100%;box-sizing:border-box;border:1px solid '},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";overflow-y:auto;padding:5px;margin:10px 0 5px 0}#Sharing-aclPropagation,#Sharing-requireSignIn,#Sharing-sendEmailCheckbox{display:inline-block;vertical-align:sub}[dir=ltr] #Sharing-aclPropagation,[dir=ltr] #Sharing-requireSignIn,[dir=ltr] #Sharing-sendEmailCheckbox{margin-right:5px}[dir=rtl] #Sharing-aclPropagation,[dir=rtl] #Sharing-requireSignIn,[dir=rtl] #Sharing-sendEmailCheckbox{margin-left:5px}.od-Sharing-linkSwitcher{display:inline-block;margin-bottom:10px}.od-ShareByEmail-textInput{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-ShareByEmail-expirationLabel{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}[dir=ltr] .od-ShareByEmail-expirationIcon{margin-right:8px}[dir=rtl] .od-ShareByEmail-expirationIcon{margin-left:8px}.od-ShareByEmail-expirationText{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}"}])});define("acY",["require","exports","ac1","b5","ac0","acZ","Os"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-sharingHints",template:e("ac0"),viewModel:i.default});t.default=n});define("ac1",["require","exports","ap","bF","ac2","V","qH","ba","DL","eO"],function(e,t,i,r,s,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){i.__extends(e,a);function e(e){var t=a.call(this,e)||this;t._openAnchorHtml='<a href="javascript:;" data-bind="attr:{title: sharedWithLinkTitle}, click: switchTabs">';t._closeAnchorHtml="</a>";t._lastPersonTemplate='<od-persona class="od-SharingHints-persona" params="{ person: lastPerson, personaSize: 1, showPresence: true, profileLinkOn: true }" ></od-persona>';t._peopleTemplate='<span data-bind = "foreach: usersTrimmed" >    <od-persona class="od-SharingHints-persona" params="{ person: $data, personaSize: 1, showPresence: true, profileLinkOn: true, includeComma: true }" ></od-persona></span>';var i=s.strings.SharedWithText,r=s.strings.SharedWithOneText;t.sharedWithLinkTitle=t.createObservable("");t.addBindingHandlers({bindableHtml:c.default});t.guestLinkExists=e.guestLinkExists;t.sharedWithMany=e.sharedWithMany||t.observables.create(!1);t.anonymousLinksText=s.strings.GuestLinkText;t.showGuestLinkHint=8==(8&e.sharingHintsOption);t.showOnlyYouHint=4==(4&e.sharingHintsOption);t.showSharedWithHint=2==(2&e.sharingHintsOption);t.showNumberOfFilesHint=1==(1&e.sharingHintsOption);t.showNumberOfFilesOnlyHint=0===e.sharingHintsOption;if(1===e.items.length){var n=e.items[0],o=s.strings.SharedWithManyText;t.sharedWithLinkTitle(l.format(s.strings.SharedWithLinkTitle,n.name));t._isFolder=n.type===p.default.Folder;t._totalFileCount=t._isFolder&&n.folder?n.folder.totalCount:0;t.totalFileCountText=l.format(u.strings.SharingHintNumberOfFilesText,t._totalFileCount);t.showNumberOfFilesHint=t.showNumberOfFilesHint&&d.isFeatureEnabled(d.OversharingMitigations)&&t._isFolder&&1<t._totalFileCount;t.showNumberOfFilesOnlyHint=t.showNumberOfFilesOnlyHint&&d.isFeatureEnabled(d.OversharingMitigations)&&t._isFolder&&1<t._totalFileCount;t.showNumberOfFilesHint&&(o=o.toLowerCase());t.sharedWithManyHtml=l.format(o,t._openAnchorHtml,t._closeAnchorHtml)}else{t.sharedWithManyHtml="";t._isFolder=!1;t._totalFileCount=0;t.totalFileCountText="";t.showNumberOfFilesHint=!1}t.onlyYouText=s.strings.OnlyYouText;t._sharedWithCallBack=e.sharedWithCallback;t.users=e.sharedWith?t.observables.createArray(e.sharedWith().reverse()):t.observables.createArray([]);t.usersTrimmed=t.createComputed(function(){var e=t.users().length;return e<4?t.users().slice(0,e-1):t.users().slice(0,3)});t.lastPerson=t.createComputed(function(){var e=t.users().length;return 0<e?t.users()[e-1]:null});t._moreLink=t.createComputed(function(){return t._openAnchorHtml+l.format(s.strings.NumberMoreText,t.users().length-3)+t._closeAnchorHtml});if(t.showNumberOfFilesHint){i=i.toLowerCase();r=r.toLowerCase()}4<t.users().length?t.sharedWithHtml=l.format(i,t._peopleTemplate,t._moreLink()):1===t.users().length?t.sharedWithHtml=l.format(r,t._lastPersonTemplate):t.sharedWithHtml=l.format(i,t._peopleTemplate,t._lastPersonTemplate);return t}e.prototype.switchTabs=function(){this._sharedWithCallBack&&this._sharedWithCallBack()};return e}(r.default);t.default=n});define("ac0",[],function(){return'<div class=od-SharingHints><div class=od-SharingHints-shared data-bind="visible: showSharedWithHint && sharedWithMany()"><span class=od-SharingHints-text data-bind="visible: showNumberOfFilesHint, text: totalFileCountText"></span> <span class=od-SharingHints-text data-bind="bindableHtml: sharedWithManyHtml"></span></div><div class=od-SharingHints-shared data-bind="visible: showNumberOfFilesOnlyHint"><span class=od-SharingHints-text data-bind="text: totalFileCountText"></span></div>\x3c!--ko if: showSharedWithHint && users().length > 0 && !sharedWithMany()--\x3e<div class=od-SharingHints-shared><span class=od-SharingHints-text data-bind="visible: showNumberOfFilesHint, text: totalFileCountText"></span> <span class=od-SharingHints-text data-bind="bindableHtml: sharedWithHtml"></span></div>\x3c!--/ko--\x3e<div class=od-SharingHints-private data-bind="visible: showOnlyYouHint && users().length === 0 && !guestLinkExists() && !sharedWithMany()"><i class="ms-Icon ms-Icon--Lock" data-bind="icon: true"></i> <span class=od-SharingHints-text data-bind="visible: showNumberOfFilesHint, text: totalFileCountText"></span> <span class=od-SharingHints-text data-bind="text: onlyYouText"></span></div><div class=od-SharingHints-externalWarning data-bind="visible: showGuestLinkHint && guestLinkExists"><i class="ms-Icon ms-Icon--Globe" data-bind="icon: true"></i> <span class=od-SharingHints-text data-bind="text: anonymousLinksText"></span></div></div>'});define("acZ",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-SharingHints{width:100%}.od-SharingHints .od-Persona--tiny{line-height:13px}.od-SharingHints .od-Persona--tiny .od-Persona-details{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:'}[dir=ltr] .od-SharingHints .od-Persona--tiny .od-Persona-details{padding-left:0}[dir=rtl] .od-SharingHints .od-Persona--tiny .od-Persona-details{padding-right:0}.od-SharingHints-text{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharingHints-persona{display:inline-block}"}])});define("aeK",[],function(){return'<div class=od-TabbedSharing>\x3c!--ko if: isLoading--\x3e<div class=od-TabbedSharing-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if: !isLoading() && !hasError()--\x3e<div class=od-TabbedSharing-sharingHints data-bind="component: {name: sharingHintsTagName, params: { guestLinkExists: guestLinkExists, sharedWithMany: sharedWithMany, sharedWithCallback: switchToSharedWith.bind($data), sharedWith: sharedWith, items: [ item ], sharingHintsOption: sharingHintsOption }}"></div>\x3c!--/ko--\x3e<div class=od-TabbedSharing-table style="display: none" data-bind="visible: !isLoading()">\x3c!--ko if: !hasError()--\x3e<div class=od-TabbedSharing-row><div class=od-TabbedSharing-tabs role=tablist><a href=javascript: role=tab aria-controls=tsd-invite class=od-TabbedSharing-tab-link data-bind="click: switchTab.bind($data, 1), keyboard: { Space: switchTab.bind($data, 1)}, css: {selected: dialogTab() == 1}, text: inviteText, attr: {\'aria-selected\': (dialogTab() == 1).toString()}"></a> <a href=javascript: role=tab aria-controls=tsd-links style="display: none" class=od-TabbedSharing-tab-link data-bind="click: switchTab.bind($data, 2), keyboard: { Space: switchTab.bind($data, 2)}, css: {selected: dialogTab() == 2}, text: linksText, attr: {\'aria-selected\': (dialogTab() == 2).toString()}, visible: linksAvailable()"></a> <a href=javascript: role=tab aria-controls=tsd-sharedWith class=od-TabbedSharing-tab-link data-bind="click: switchTab.bind($data, 3), keyboard: { Space: switchTab.bind($data, 3)}, css: {selected: dialogTab() == 3}, text: sharedWithText, attr: {\'aria-selected\': (dialogTab() == 3).toString()}"></a></div><div class=od-TabbedSharing-spacer>&nbsp;</div><div style="display: table-cell"><div role=tabpanel id=tsd-invite data-bind="if: dialogTab() == 1"><div class=od-TabbedSharing-sharing data-bind="component: {name: sharingTagName, params: sharingParams }"></div></div>\x3c!--ko if: linksAvailable--\x3e<div role=tabpanel id=tsd-links data-bind="if: dialogTab() == 2"><div class=od-TabbedSharing-links data-bind="component: {name: sharingLinksComponentTagName, params: { linksAvailable: linksAvailable, guestLinkExists: guestLinkExists, item: item }}"></div></div>\x3c!--/ko--\x3e<div role=tabpanel id=tsd-sharedWith data-bind="if: dialogTab() == 3"><div class=od-TabbedSharing-sharedWith data-bind="component: {name: \'ms-sharedWith\', params: { height: \'300px\', item: item }}"></div></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if: hasError()--\x3e<div class=od-TabbedSharing-error data-bind="text: missingItemError" aria-live=assertive></div>\x3c!--/ko--\x3e</div></div>'});define("aeJ",["c","az"],function(e,t){e.loadStyles([{rawString:'.od-TabbedSharing{box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;overflow:hidden;min-height:200px}[dir=ltr] .od-Dialog-content .od-TabbedSharing{margin-left:-20px}[dir=rtl] .od-Dialog-content .od-TabbedSharing{margin-right:-20px}[dir=ltr] .sm .od-Dialog-content .od-TabbedSharing{margin-left:0}[dir=rtl] .sm .od-Dialog-content .od-TabbedSharing{margin-right:0}.od-TabbedSharing-sharingHints{margin-bottom:15px}[dir=ltr] .od-TabbedSharing-sharingHints{margin-left:20px}[dir=rtl] .od-TabbedSharing-sharingHints{margin-right:20px}[dir=ltr] .sm .od-TabbedSharing-sharingHints{margin-left:0}[dir=rtl] .sm .od-TabbedSharing-sharingHints{margin-right:0}.od-TabbedSharing-table{display:table;width:100%;border-collapse:collapse}.od-TabbedSharing-row{display:table-row}.od-TabbedSharing-tabs{display:table-cell;vertical-align:top;width:130px}.sm .od-TabbedSharing-tabs{display:none}.od-TabbedSharing-spacer{width:32px;display:table-cell}html[dir=ltr] .od-TabbedSharing-spacer{border-left:1px solid '},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}html[dir=rtl] .od-TabbedSharing-spacer{border-right:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.sm .od-TabbedSharing-spacer{display:none}.od-TabbedSharing-loadingSpinner{margin-top:90px;text-align:center}.od-TabbedSharing-tab-link,.od-TabbedSharing-tab-link:visited{text-decoration:none;padding:8px 20px;display:block;white-space:nowrap;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:';font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;font-weight:300}.od-TabbedSharing-tab-link.selected,.od-TabbedSharing-tab-link:visited.selected{background-color:'},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:";font-weight:600}.od-TabbedSharing-tab-link:hover{background-color:"},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-TabbedSharing-tab-link:hover.selected{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}[dir=ltr] .od-TabbedSharing-error{margin-left:20px}[dir=rtl] .od-TabbedSharing-error{margin-right:20px}[dir=ltr] .sm .od-TabbedSharing-error{margin-left:0}[dir=rtl] .sm .od-TabbedSharing-error{margin-right:0}"}])});define("aez",["require","exports","aeC","b5","aeB","aeA","Os"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-sharedWith",template:e("aeA"),viewModel:i.default});t.default=n});define("aeC",["require","exports","ap","aq","bF","aC","bX","dZ","ci","cE","lB","aez","DI","yk","Ok","aM","Om","Or","uA","V","Ol","dI","zk","dc","cJ","OJ","aeE","dz","aeD"],function(e,t,i,o,r,n,a,s,l,c,d,u,p,m,h,f,g,b,_,v,y,S,x,k,C,P,I,w,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=function(t){i.__extends(e,t);function e(e){var n=t.call(this,e)||this;n.SharedWithTagName=u.default.tagName;n.loadingSpinnerTagName=d.default.tagName;n.personaTileTagName=P.default.tagName;n._sharingProvider=n.resources.consume(p.resourceKey);n._engagement=n.resources.consume(c.resourceKey);n._navigation=n.resources.consume(k.navigation);n._personaTileHelper=new I.default;n.keyNav=new T.default;n.personaTileCollection=n.observables.createArray([]);n.addBindingHandlers({keyboard:C.default,selection:w.default,selectOnFocus:_.default});n.removePerson=function(e){n.people.remove(e)};n._item=e.item;n._items=e.items;e.personaSize?n.cardSize=e.personaSize:n.cardSize=o.observable(4);n.height=e.height?e.height:"none";n.showEmailLink=o.observable(!1);n.hasSettings=o.observable(!1);n.hasData=o.observable(!1);n.showRequests=o.observable(!1);n.loading=o.observable(!0);n.isMultiSelect=o.observable(!1);n.error=o.observable("");n.advancedUrl=o.observable("");n.disableLinkText=h.strings.DisableLinkText;n.emailText=h.strings.EmailEveryone;n.advancedText=h.strings.Advanced;n.requestsPending=h.strings.RequestPending;n.stopSharingText=h.strings.StopSharing;n.viewRequests=h.strings.ViewRequests;n.multiSelectErrorText=h.strings.MultiSelectError;n.userListTrimmedText=h.strings.SharedWithManyText;n.showUserListTrimmedText=n.createObservable(!1);n._selectionModel=n.resources.consume(a.itemsSelection);n._urlDataSource=n.resources.consume(s.url);n.people=o.observableArray([]);n.links=o.observableArray([]);n.canManageLinks=o.observable(!1);n.canManagePermissions=o.observable(!1);n.showAdvanced=n.createComputed(function(){return!!n.advancedUrl()});n.canUnshare=o.observable(!1);n.requestsLink=o.observable("");n.mailto=n.createComputed(function(){if(!n.hasSettings())return"";for(var e=n.people(),t="mailto:",i=new Array,r=0;r<e.length;r++)e[r].email&&i.push(e[r].email);n.showEmailLink(0<i.length&&i.length<29);t+=f.default.encodeURIComponent(i.join(";"));t+="?subject="+f.default.encodeURIComponent(n._settings.itemName);return t+="&body="+encodeURI(encodeURI(n._settings.itemUrl))});n.hasError=n.createComputed(function(){return!!n.error()});if(n._selectionModel&&n._selectionModel.selection&&1<n._selectionModel.selection().length||n._items&&1<n._items.length){n.isMultiSelect(!0);n.loading(!1)}else{e.includeLinks&&n._getLinks();n._getSharedWith()}return n}e.prototype.logCopy=function(e,t){this._engagement.logData({name:e.tag+"Link.SharedWith.Copy",isIntentional:!0});return!0};e.prototype.calculateScope=function(e){var t="";e.item&&this._getCurrentItem()!==e.item&&(t=v.format(h.strings.SharingFrom,e.item.name));return t};e.prototype.scopeClick=function(e){this._navigation.navigateTo(this._urlDataSource.getItemUrl(e.item.key));return!0};e.prototype.calculateHint=function(e){return b.getLinkHintText(e,this._companyDisplayName)};e.prototype.clickEmail=function(){this._engagement.logData({name:"EmailEveryone.SharingDialog.Click",isIntentional:!0});this._navigation.navigateTo(this.mailto.peek())};e.prototype.clickAdvanced=function(){this._engagement.logData({name:"AdvancedSettings.SharingDialog.Click",isIntentional:!0});if(this._settings.advancedUrlOpenInPlace){this._showAdvancedDialog();return!1}return!0};e.prototype.clickAccessRequests=function(){this._engagement.logData({name:"PendingAccessRequests.SharingDialog.Click",isIntentional:!0});return!0};e.prototype.stopSharing=function(){this._engagement.logData({name:"StopSharing.SharingDialog.Click",isIntentional:!0});this._stopSharingConfirm()};e.prototype.removeSharingLink=function(t){var i=this,e=this.resources.consume(l.resourceKey);y.disableLinkConfirm(function(){i._engagement.logData({name:"Disable"+t.tag+"Link.SharedWith.Click",isIntentional:!0});var e={type:t.type,role:t.role,create:!1};return i._sharingProvider.manageSharingLinks([i._getCurrentItem()],e).then(function(e){i._updateSharingLinks(e);return n.default.wrap(!0)},function(e){return!1})},function(e){i.isReady=e},e,"SharedWith")};e.prototype._stopSharing=function(){var e=this._sharingProvider.unshare(this._getCurrentItem());this.loading(!0);return e};e.prototype._getLinks=function(){var t=this,e=this.resources.consume(m.resourceKey.optional);e&&e.loadData().then(function(e){t._companyDisplayName=e.CompanyDisplayName;0<t.links.peek().length&&t._updateSharingLinks(t.links())});this._sharingProvider.getSharingData(this._getCurrentItem()).getLinks().then(function(e){e&&t._updateSharingLinks(e)},function(e){t.error(h.strings.LinksError)})};e.prototype._updateSharingLinks=function(e){this.links(e.filter(function(e){return e.isActive&&8!==e.type}))};e.prototype._getSharedWith=function(){var i=this,e=this._sharingProvider.getSharingData(this._getCurrentItem());this.isReady=e.getPermissions(!0).then(function(e){var t=e[0];if(t){if(t.hasPendingAccessRequests){i.showRequests(!0);i._engagement.logData({name:"PendingAccessRequests.SharingDialog.Render"})}i.requestsLink(t.pendingAccessRequestsLink);i.canUnshare(t.canUnshare);i._parseSharedWith(t?t.people:null)}else i.loading(!1)},function(e){e&&403===e.status?i.error(h.strings.AccessDenied):i.error(h.strings.ServerError);i.loading(!1)});e.getSettings().done(function(e){i._settings=e;i.canManageLinks(e.canManageLinks);i.canManagePermissions(e.canManagePermissions);i.advancedUrl(e.advancedUrlOpenInPlace?"javascript:;":e.advancedUrl);i.hasSettings(!0)},function(e){})};e.prototype._parseSharedWith=function(e){if(e){this.people(e);this._convertPeopleToPersonaTiles();this.showUserListTrimmedText(30<=this.people().length)}this.loading(!1)};e.prototype._convertPeopleToPersonaTiles=function(){for(var e=this.people.peek(),t=new Array,i=0;i<e.length;i++){var r=e[i],n={inputEvent:this.observables.create(),openContextMenu:this.observables.create(!1),person:this.observables.create(r),personaSize:this.cardSize,removePerson:this.removePerson,showPresence:!0},o=this._personaTileHelper.convertPersonaToPersonaTile(n,r.userId);t.push(o)}this.personaTileCollection(t);this.keyNav.focusableTiles(t)};e.prototype._getCurrentItem=function(){return this._item?this._item:o.utils.unwrapObservable(this._selectionModel.selection()[0])};e.prototype._stopSharingConfirm=function(){var e=this,t=this.resources.consume(l.resourceKey),i=this._engagement,r=o.observable(!0);t.requestDialog({title:h.strings.StopSharingConfirmationTitle,size:"Medium",component:{name:g.default.tagName,params:{message:h.strings.StopSharingConfirmationMessage}},actions:[{name:h.strings.StopSharingConfirmationButton,execute:function(){i.logData({name:"Unshare.SharedWithDialog.Click",isIntentional:!0});r(!1);return e._stopSharing().then(function(e){return 2},function(e){return 3})},isDefault:!0,isAvailable:r,icon:new S.default("Save"),automationId:"UnshareConfirm"},{name:h.strings.StopSharingCancelButton,execute:function(){i.logData({name:"CancelStopSharing.SharedWithDialog.Click",isIntentional:!0});return n.default.wrap(3)},isDefault:!1,icon:new S.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};e.prototype._showAdvancedDialog=function(){var e=this,t=this.resources.consume(l.resourceKey),i=t.currentDialog();i&&i.dismiss();i=t.requestDialog({title:v.format(h.strings.AdvancedDialogTitle,this._getCurrentItem().name),size:"Large",component:{name:x.default.tagName,params:{url:this._settings.advancedUrl,onload:function(e){var t=e.target;if(t){t.commitPopup=function(){i.dismiss()};t.style.height=Math.max(300,.25*window.innerHeight)+"px"}}}},actions:[{name:h.strings.ShowAdvancedDialogCloseButton,execute:function(){e._engagement.logData({name:"AdvancedSharingClose.SharedWithDialog.Click",isIntentional:!0});return n.default.wrap(3)},isDefault:!0,isAvailable:o.observable(!0),icon:new S.default("Cancel"),automationId:"AdvancedSharingClose"}],executeDefaultAction:!1})};return e}(r.default);t.default=L});define("aeE",["require","exports","ap","bN"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return e.call(this)||this}t.prototype.convertPersonaToPersonaTile=function(e,t){return{personaParams:e,key:t,focused:this.observables.create(!1)}};return t}(r.default);t.default=n});define("aeD",["require","exports","ap","bN"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(){var e=t.call(this)||this;e.keyboardOptions=[{target:null,mappings:{Right:e.onKeyRight}},{target:window,mappings:{}}];e.focusedTile=e.observables.create();e.focusableTiles=e.observables.createArray();return e}e.prototype.onKeyRight=function(e,t){var i=e.keyNav.focusedTile();i.personaParams.inputEvent(t);i.personaParams.openContextMenu(!0);t.stopPropagation();return!0};return e}(r.default);t.default=n});define("aeB",["c","az"],function(e,t){e.loadStyles([{rawString:".od-SharedWith-Container{width:100%}.od-SharedWith-loadingSpinner{text-align:center;padding:75px 0}.od-SharedWith-wrapper{margin:2px;width:100%;overflow-x:hidden;overflow-y:auto;min-height:175px}.od-SharedWith-accessRequests{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";padding:8px 0}.od-SharedWith-accessRequestsIcon{padding:0 8px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:';font-size:12pt;vertical-align:middle}[dir=ltr] .od-SharedWith-accessRequestsLink{padding-left:5px}[dir=rtl] .od-SharedWith-accessRequestsLink{padding-right:5px}.od-SharedWith-person{margin:0 0 10px;width:100%}.od-SharedWith-person .od-Persona .od-Persona-details{max-width:75%;padding-left:0}.od-SharedWith-error{color:#a80000}.od-SharedWith-linksBox{margin:10px 0 1px}button.od-SharedWith-link{border:none;background:0 0}.od-SharedWith-link{text-decoration:none;cursor:pointer;padding:2px;text-transform:uppercase;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-SharedWith-link{margin-right:10px}[dir=rtl] .od-SharedWith-link{margin-left:10px}.od-SharedWith-link:focus,.od-SharedWith-link:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-SharedWith-iconCell{width:50px;vertical-align:top}.od-SharedWith-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:';font-size:25px;border-radius:50%;width:50px;height:50px}[dir=ltr] .od-SharedWith-icon{margin-right:10px}[dir=rtl] .od-SharedWith-icon{margin-left:10px}.od-SharedWith-icon .ms-Icon--Link{position:relative;top:8px}[dir=ltr] .od-SharedWith-icon .ms-Icon--Link{left:9px}[dir=rtl] .od-SharedWith-icon .ms-Icon--Link{right:9px}.od-SharedWith-mailRow{white-space:nowrap}.od-SharedWith-mailRow .od-SharedWith-icon{vertical-align:middle}.od-SharedWith-linkSwitcher{display:inline-block;margin-bottom:10px}a.od-SharedWith-linkScope,a.od-SharedWith-linkSwitcher{cursor:pointer}.od-SharedWith-url .od-SharedWith-cell{width:100%}.od-SharedWith-input{padding:3px;width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}button.od-SharedWith-copyButton{padding:0 10px;height:1.9em}.od-SharedWith-copyButton-label{position:relative;top:-1px}.od-SharedWith-mailText{font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.od-SharedWith-trimmedText{color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SharedWith-trimmedText{margin-right:5px}[dir=rtl] .od-SharedWith-trimmedText{margin-left:5px}.od-SharedWith-table{display:table;width:100%}.od-SharedWith-row{display:table-row}.od-SharedWith-cell{display:table-cell}.od-SharedWith-removeLinkButton{margin:0;padding:5px;border:0;background:0 0;cursor:pointer}[dir=ltr] .od-SharedWith-removeLinkButton{margin-left:10px}[dir=rtl] .od-SharedWith-removeLinkButton{margin-right:10px}.od-SharedWith--hidden{display:none}"}])});define("aeA",[],function(){return'<div class=od-SharedWith-Container>\x3c!--ko if:loading--\x3e<div class=od-SharedWith-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e<div data-bind="if: showRequests"><div aria-live=polite class=od-SharedWith-accessRequests role=alert><i class="ms-Icon ms-Icon--Info od-SharedWith-accessRequestsIcon" data-bind="icon: true"></i> <span data-bind="text: requestsPending"></span> <a class=od-SharedWith-accessRequestsLink target=_blank data-bind="attr: {href: requestsLink }, text: viewRequests, click: $component.clickAccessRequests.bind($component)"></a></div></div><div aria-live=assertive class=od-SharedWith-error data-bind="if: hasError"><span data-bind="text: error"></span></div><div aria-live=polite data-bind="if: isMultiSelect"><span data-bind="text: multiSelectErrorText"></span></div><div class=od-SharedWith-wrapper aria-live=polite aria-relevant=text data-bind="style: { maxHeight: height }, keyboard: keyNav.keyboardOptions, selection: { data: keyNav.focusableTiles, mode: \'single\', direction: \'vertical\', focused: keyNav.focusedTile }"><div data-bind="foreach: links"><div class=od-SharedWith-table><div class=od-SharedWith-row><div class="od-SharedWith-cell od-SharedWith-iconCell"><div class=od-SharedWith-icon><i class="ms-Icon ms-Icon--Link" data-bind="icon: true"></i></div></div><div class=od-SharedWith-cell>\x3c!--ko if: $parent.canManageLinks--\x3e<a class=od-SharedWith-linkScope data-bind="text: $parent.calculateScope($data), click: $parent.scopeClick.bind($parent, $data)"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot: $parent.canManageLinks--\x3e<span class=od-SharedWith-linkScope data-bind="text: $parent.calculateScope($data)"></span>\x3c!--/ko--\x3e<div class="od-SharedWith-table od-SharedWith-url"><div class=od-SharedWith-row><div class=od-SharedWith-cell><input class=od-SharedWith-input readonly data-bind="value: url, selectOnFocus: { isPermanent: true }, event: { copy: $component.logCopy.bind($component) }, attr: { \'aria-label\': $parent.calculateHint($data)}"></div>\x3c!--ko if: $parent.canManageLinks--\x3e<div class=od-SharedWith-cell><button class=od-SharedWith-removeLinkButton data-bind="click: $parent.removeSharingLink.bind($parent, $data), attr: { \'title\': $parent.disableLinkText, \'aria-label\': $parent.disableLinkText }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e</div></div><span class=od-SharedWith-linkSwitcher data-bind="text: $parent.calculateHint($data)"></span></div></div></div></div><div class=od-SharedWith-PersonaTiles role=tree data-bind="foreach: { data: personaTileCollection, as: \'personaTile\' }"><div class=od-SharedWith-person data-bind="component: { name: $parent.personaTileTagName, params: { tile: personaTile } }"></div></div>\x3c!--ko if: showUserListTrimmedText()--\x3e<div class=od-SharedWith-trimmedText data-bind="text: userListTrimmedText"></div>\x3c!--/ko--\x3e</div><div class=od-SharedWith-linksBox data-bind="if: hasSettings()"><button class=od-SharedWith-link data-bind="click: stopSharing, text: stopSharingText, visible: canUnshare"></button> <button class=od-SharedWith-link data-bind="text: emailText, visible: showEmailLink(), click: $component.clickEmail.bind($component)"></button>\x3c!--ko if: canManagePermissions--\x3e<a class=od-SharedWith-link target=_blank data-bind="attr: {href: advancedUrl}, text: advancedText, visible: showAdvanced, click: clickAdvanced"></a>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});define("aeu",["require","exports","aex","b5","aew","aev"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-sharingLinks",template:e("aew"),viewModel:i.default});t.default=n});define("aex",["require","exports","ap","aq","bF","aC","bX","ci","cE","lB","d0","aeu","aey","U","kq","DI","Sf","uA","Om","dI"],function(e,t,i,a,r,s,n,l,o,c,d,u,p,m,h,f,g,b,_,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(r){i.__extends(e,r);function e(t){var i=r.call(this,t)||this;i.sharingLinksTagName=u.default.tagName;i.loadingSpinnerTagName=c.default.tagName;i.progressSpinnerFlatTagName=d.default.tagName;t.item&&(i._item=t.item);i._guestLinkExists=t.guestLinkExists?t.guestLinkExists:a.observable(!1);i.addBindingHandlers({visibility:g.default,selectOnFocus:b.default});i._selectionModel=i.resources.consume(n.itemsSelection);i._sharingProvider=i.resources.consume(f.resourceKey);i._selectionHelper=i.resources.consume(h.resourceKey);i._engagement=i.resources.consume(o.resourceKey);i.loading=a.observable(!0);i.viewLinkHeader=m.default.encodeText(p.strings.ViewLinkHeader);i.viewLinkDescription=m.default.encodeText(p.strings.ViewLinkDescription);i.editLinkHeader=m.default.encodeText(p.strings.EditLinkHeader);i.editLinkDescription=m.default.encodeText(p.strings.EditLinkDescription);i.anonymousViewLink=a.observable(null);i.anonymousEditLink=a.observable(null);i.showAnonymousViewLink=a.observable(!1);i.showAnonymousEditLink=a.observable(!1);i.anonymousViewLinkUrl=a.observable("");i.anonymousEditLinkUrl=a.observable("");i.anonymousViewLinkButtonText=a.observable("");i.anonymousEditLinkButtonText=a.observable("");i.processingViewLink=a.observable(!1);i.processingEditLink=a.observable(!1);i.error=a.observable("");i.viewLinkError=a.observable("");i.editLinkError=a.observable("");i.createComputed(i._computeUpdateAnonymousViewLink);i.createComputed(i._computeUpdateAnonymousEditLink);var e=i._sharingProvider.getSharingData(i._getCurrentItem());i.isReady=e.getLinks().then(function(e){e&&i._updateSharingLinks(e);i.loading(!1)},function(e){i.error(p.strings.ServerError);i.loading(!1)});t.linksAvailable&&e.getSettings().done(function(e){t.linksAvailable(e.anonymousLinksEnabled)},function(e){});return i}e.prototype.modifyViewLink=function(){this.viewLinkError("");this._modifyLink(this.anonymousViewLink()||{type:5,role:1,url:""},this.showAnonymousViewLink())};e.prototype.modifyEditLink=function(){this.editLinkError("");this._modifyLink(this.anonymousEditLink()||{type:6,role:2,url:""},this.showAnonymousEditLink())};e.prototype.copyViewLink=function(){this._engagement.logData({name:"AnonViewLink.SharingDialog.Copy",isIntentional:!0});return!0};e.prototype.copyEditLink=function(){this._engagement.logData({name:"AnonEditLink.SharingDialog.Copy",isIntentional:!0});return!0};e.prototype.executeDisableConfirm=function(){this._confirmDialog&&this._confirmDialog.actions[0].execute()};e.prototype._computeUpdateAnonymousViewLink=function(){var e=this.anonymousViewLink(),t=e?e.url:"";this.showAnonymousViewLink(!!e);this.anonymousViewLinkUrl(t);this.anonymousViewLinkButtonText(this._getLinkButtonText(t))};e.prototype._computeUpdateAnonymousEditLink=function(){var e=this.anonymousEditLink(),t=e?e.url:"";this.showAnonymousEditLink(!!e);this.anonymousEditLinkUrl(t);this.anonymousEditLinkButtonText(this._getLinkButtonText(t))};e.prototype._updateSharingLinks=function(e){for(var t=!1,i=0;i<e.length;i++)if(5===e[i].type&&1===e[i].role){this.anonymousViewLink(e[i]);this.processingViewLink(!1);t=!0}else if(6===e[i].type&&2===e[i].role){this.anonymousEditLink(e[i]);this.processingEditLink(!1);t=!0}this._guestLinkExists(t)};e.prototype._modifyLink=function(e,t){var i=t?"Disable":"Create";i+="Anon"+(1===e.role?"View":"Edit")+"Link.SharingDialog.Click";this._engagement.logData({name:i,isIntentional:!0});if(t)this._disableLinkConfirm(e,!1);else{1===e.role?this.processingViewLink(!0):this.processingEditLink(!0);this._modifyLinkServer(e,!0)}};e.prototype._modifyLinkServer=function(i,r){var n=this,e=this._selectionModel&&this._selectionModel.selection&&this._selectionModel.selection(),o=[];return(e&&1<e.length?this._selectionHelper.resolveSelection():s.default.wrap([])).then(function(e){o=e;var t={type:i.type,role:i.role,id:i.id,create:r};return n.isReady=n._sharingProvider.manageSharingLinks(o,t).then(function(e){n._updateSharingLinks(e);if(!r)if(1===i.role){n.anonymousViewLink(null);n.viewLinkError("");n.processingViewLink(!1)}else if(2===i.role){n.anonymousEditLink(null);n.editLinkError("");n.processingEditLink(!1)}},function(e){if(1===i.role){n.viewLinkError(p.strings.ServerError);n.processingViewLink(!1)}else if(2===i.role){n.editLinkError(p.strings.ServerError);n.processingEditLink(!1)}})})};e.prototype._getLinkButtonText=function(e){return e?p.strings.DisableLinkButtonText:p.strings.CreateLinkButtonText};e.prototype._getCurrentItem=function(){return this._item?this._item:a.utils.unwrapObservable(this._selectionModel.selection()[0])};e.prototype._disableLinkConfirm=function(e,t){var i=this,r=this._engagement,n=this.resources.consume(l.resourceKey),o=a.observable(!0);this._confirmDialog=n.requestDialog({title:p.strings.DisableLinkConfirmationTitle,size:"Medium",component:{name:_.default.tagName,params:{message:p.strings.DisableLinkConfirmationMessage}},actions:[{name:p.strings.DisableLinkConfirmationButton,execute:function(){r.logData({name:"Confirm.DisableLink.SharingDialog.Click",isIntentional:!0});o(!1);return i._modifyLinkServer(e,t).then(function(){return 2},function(){return 3})},isDefault:!0,isAvailable:o,icon:new v.default("Save"),automationId:"UnshareConfirm"},{name:p.strings.KeepExistingLinkButton,execute:function(){r.logData({name:"KeepExisting.DisableLink.SharingDialog.Click",isIntentional:!0});return s.default.wrap(3)},isDefault:!1,icon:new v.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};return e}(r.default);t.default=y});define("aew",[],function(){return'\x3c!--ko if:loading--\x3e<div class=SharingLinks-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e<div aria-live=assertive class=SharingLinks-error data-bind="if: error"><span data-bind="text: error"></span></div><div class=Sharing-linksSection data-bind="ifnot: error"><div class=Sharing-linksHeading data-bind="text: viewLinkHeader"></div><label class=Sharing-linkInput-label data-bind="text: viewLinkDescription"></label><div class=Sharing-linksArea>\x3c!--ko if:showAnonymousViewLink--\x3e<input class=Sharing-linkInput-textbox readonly data-bind="value: anonymousViewLinkUrl, selectOnFocus: { isPermanent: true }, event: { copy: $component.copyViewLink.bind($component) }, disable: processingViewLink, attr: { \'aria-label\': viewLinkDescription }">\x3c!--/ko--\x3e<a class=Sharing-updateLinkButton href=javascript; data-bind="text: anonymousViewLinkButtonText, click: modifyViewLink"></a></div><div class=SharingLinks-progressBox data-bind="component: {name: progressSpinnerFlatTagName}, visibility: processingViewLink"></div><div aria-live=assertive class=SharingLinks-error data-bind="if: viewLinkError"><span data-bind="text: viewLinkError"></span></div></div><div data-bind="ifnot: error"><div class=Sharing-linksHeading data-bind="text: editLinkHeader"></div><label class=Sharing-linkInput-label data-bind="text: editLinkDescription"></label><div class=Sharing-linksArea>\x3c!--ko if:showAnonymousEditLink--\x3e<input class=Sharing-linkInput-textbox readonly data-bind="value: anonymousEditLinkUrl, selectOnFocus: true, event: { copy: $component.copyEditLink.bind($component) }, disable: processingEditLink, attr: { \'aria-label\': editLinkDescription }">\x3c!--/ko--\x3e<a class=Sharing-updateLinkButton href=javascript; data-bind="text: anonymousEditLinkButtonText, click: modifyEditLink"></a></div><div class=SharingLinks-progressBox data-bind="component: {name: progressSpinnerFlatTagName}, visibility: processingEditLink"></div><div aria-live=assertive class=SharingLinks-error data-bind="if: editLinkError"><span data-bind="text: editLinkError"></span></div></div>\x3c!--/ko--\x3e'});define("aev",["c","az"],function(e,t){e.loadStyles([{rawString:'.SharingLinks-loadingSpinner{text-align:center;padding:75px 0}.Sharing-linkInput-label{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:';display:block;padding-top:5px;padding-bottom:8px}.Sharing-linkInput-textbox{width:75%;padding:1px 5px 2px 10px;text-overflow:ellipsis}html[dir=rtl] .Sharing-linkInput-textbox{padding:1px 10px 2px 5px}[dir=ltr] .Sharing-linkInput-textbox{margin-right:15px}[dir=rtl] .Sharing-linkInput-textbox{margin-left:15px}.Sharing-linksHeading{padding:0 0 5px 0}.Sharing-linksArea{height:25px}.Sharing-updateLinkButton{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;text-transform:uppercase}a.Sharing-updateLinkButton{color:'},{theme:"blue",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.Sharing-linksSection{padding-bottom:20px}.SharingLinks-error{color:#a80000}"}])});define("ad7",["require","exports","b5","ad9","ad8"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"od-show-operations-executor",template:e("ad8"),viewModel:r.default,synchronous:!0});t.default=n});define("ad9",["require","exports","ap","AV","Oh","dR","eP","aea","b3"],function(e,t,r,i,n,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({control:l.default});t.panelOverlayTagName=n.default.tagName;t.operationMonitorSpecification=l.toSpecification(s.resourceKey,{});t.panelTitle=a.strings.title;t._operationProvider=t.resources.consume(o.resourceKey);t.addDisposable(t._operationProvider.lock());return t}e.prototype.onClosePanel=function(){this.action.complete()};return e}(i.default);t.default=c});define("AV",["require","exports","ap","bF","aC"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=e.action;t.action=i;return t}e.prototype.endWith=function(e){var t=this;e.done(function(){return t.action.complete()},function(e){return t.action.fail(e)})};e.prototype.continueWith=function(e){var t=this;return e.then(null,function(e){t.action.fail(e);return n.default.wrapError(e)})};return e}(r.default);t.default=o});define("aea",["require","exports","aed","b3","aec","aeb"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"ms-operation-monitor",name:e("module").id,template:e("aec"),viewModelType:i.default});t.default=t.resourceKey});define("aed",["require","exports","ap","bF","dR","aeh","aeg","aee","df","eP","bQ"],function(e,t,i,r,n,u,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(d){i.__extends(e,d);function e(e,t){void 0===e&&(e={});var i=d.call(this,e,t)||this;i.noOperationsText=f.strings.noOperationsText;i.progressBarTagName=m.default.tagName;i.fileTypeIconTagName=h.default.tagName;var r=t.operationProvider,n=e.expandGroups,o=void 0===n||n,a=e.groups,s=void 0===a?r.groups:a,l=e.onViewAll,c=e.onExecuteAction;i.addBindingHandlers({preRender:p.default});i.groups=i.addDisposable(s.map({mappingWithDisposeCallback:function(e){var t=new(i.managed(u.default))({group:e,showIndividualOperations:o,onViewAll:l,onExecuteAction:c});return{mappedValue:t,dispose:function(){t.dispose()}}}}));return i}e.dependencies=i.__assign({},r.default.dependencies,{operationProvider:n.resourceKey});return e}(r.default);t.default=o});define("aeh",["require","exports","ap","bF","aC","aej","aei","dY","cg","s7","dR","qH","eP"],function(e,t,i,r,n,o,a,p,m,h,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(l){i.__extends(e,l);function e(e){var t=l.call(this,e)||this;t.viewAllText=u.strings.viewAllText;t.addBindingHandlers({bindableHtml:d.default});t._group=e.group;t._showIndividualOperations=e.showIndividualOperations;t._showOneOperation=e.showOneOperation;t._onExecuteAction=e.onExecuteAction;t._onViewAll=e.onViewAll;t._disallowedActions={};t.progress=t._group.progress;t.context={count:t._group.count,states:t._group.states,progress:t._group.progress,payloads:t._group.payloads,error:t._group.error};e.stringMappings?t._stringMappings=e.stringMappings:t._stringMappings=h.default;t._operationProvider=t.resources.consume(c.resourceKey);t._showCloseAction=t.createPureComputed(t._computeShowCloseAction);t._operations=t._getOperations();var i=t._getActions(),r=i.buttonActions,n=i.iconActions;t.buttonActions=r;t.iconActions=n;var o=t._getOperationViewModels(),a=o.operations,s=o.showViewAll;t.operations=a;t.showViewAll=s;t.title=t.createComputed(t._computeTitle);t.description=t.createComputed(t._computeDescription);t.showProgress=t.createPureComputed(t._computeShowProgress);t.showDescription=t.createPureComputed(t._computeShowDescription);t.css=t.createComputed(t._computeCss);return t}e.prototype.onClickViewAll=function(e,t){if(this._onViewAll){this._onViewAll();t.stopPropagation();t.preventDefault()}};e.prototype._computeTitle=function(){var e=p.default[this._group.state()],t=m.default[m.default.multiple],i=this._getMappingForType(),r=i.states[e],n=h.default.types[t],o=n.states[e],a=r&&r.title||i.title||o&&o.title||n.title;return h.resolveEntry(a,this.context)};e.prototype._computeDescription=function(){var e=p.default[this._group.state()],t=m.default[m.default.multiple],i=this._getMappingForType().states[e],r=h.default.types[t].states[e],n=i&&i.description||r&&r.description;return h.resolveEntry(n,this.context)};e.prototype._computeShowProgress=function(){var e=this._getMappingForType().showProgress;if(e)return h.resolveEntry(e,this.context);var t=this._group;return this._showIndividualOperations&&(t.state()===p.default.started||t.progress.current()>t.progress.minimum())};e.prototype._computeShowDescription=function(){var e=this._getMappingForType().showDescription;return e?h.resolveEntry(e,this.context):this._showIndividualOperations&&(this._group.state()!==p.default.failed||!!this.buttonActions().length)};e.prototype._computeShowCloseAction=function(){var e=this._group.state();if(e!==p.default.canceled&&e!==p.default.completed&&e!==p.default.failed)return!1;var t=this._group.actions().cancel;return!t||!1===t.isAvailable()};e.prototype._computeCss=function(){return"OperationMonitor-item--"+p.default[this._group.state()]};e.prototype._getMappingForType=function(){var e=this._stringMappings.types,t=m.default[this._group.type()];return e[t+"Group"]||e[t]};e.prototype._getActions=function(){var c=this,e=this.observables.createArray(),d=this._group,t={key:"close",count:d.count,isAvailable:this._showCloseAction,execute:function(){return n.default.wrap().then(function(){c._operationProvider.deleteGroupOperation(d)})}};this._group.actions().close=t;this.createComputed(function(){e(Object.keys(d.actions()).map(function(e){return d.actions.peek()[e]}))});var u=this._disallowedActions,i=this.addDisposable(e.filter(function(e){var t=m.default[d.type()],i=c._stringMappings.types[t].actions,r=i&&i[e.key],n=h.default.actions[e.key],o=r&&r.mode||n.mode||0,a=1!==o&&3<e.count()||1===o,s=!c._showIndividualOperations&&c._group.state()!==p.default.failed||!!n.icon||a,l=!a||3===o;u[e.key]?u[e.key](!l):u[e.key]=c.createObservable(!l);return s&&e.isAvailable()})),r=this.addDisposable(i.map({mappingWithDisposeCallback:function(e){var t=new(c.managed(a.default))({action:e,onExecuteAction:c._onExecuteAction,actionMapping:c._stringMappings.actions});return{mappedValue:t,dispose:function(){t.dispose()}}}}));return{buttonActions:this.addDisposable(r.filter(function(e){return!e.icon})),iconActions:this.addDisposable(r.filter(function(e){return!!e.icon}))}};e.prototype._getOperations=function(){var t=this,e=this._group,i=this.createPureComputed(function(){return 1===e.operations().length}),r=this.createPureComputed(function(){return 10<e.operations().length}),n=this.createPureComputed(function(){return e.states().started<10}),o=this.createPureComputed(function(){return e.states().created+e.states().started<10});return this.addDisposable(e.operations.filter(function(e){return!(!t._showIndividualOperations&&!i()&&e.state()!==p.default.failed)&&(!(!t._showOneOperation&&i()&&e.state()!==p.default.failed)&&(!r()||e.state()===p.default.failed||(!(!o()||e.state()!==p.default.created)||!(!n()||e.state()!==p.default.started))))}))};e.prototype._getOperationViewModels=function(){var e,i=this,t=this.observables;if(this._showIndividualOperations)e=this._operations;else{e=t.createArray();t.compute(function(){e.splice.apply(e,[0,1/0].concat(i._operations().slice(0,1)))})}return{operations:this.addDisposable(e.map({mappingWithDisposeCallback:function(e){var t=new(i.managed(o.default))({operation:e,onExecuteAction:i._onExecuteAction,disallowedActions:i._disallowedActions,stringMapping:i._stringMappings});return{mappedValue:t,dispose:function(){t.dispose()}}}})),showViewAll:t.pureCompute(function(){return!!i._onViewAll&&e().length<i._operations().length})}};return e}(r.default);t.default=s});define("aej",["require","exports","ap","bF","dY","cg","aei","s7","qH","aq"],function(e,t,r,i,a,s,n,l,o,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({bindableHtml:o.default});t._operation=e.operation;t._onExecuteAction=e.onExecuteAction;t._disallowedActions=e.disallowedActions||{};e.stringMapping?t._stringMappings=e.stringMapping:t._stringMappings=l.default;t.context={count:t._operation.count,states:t.createComputed(t._computeStates),progress:t._operation.progress,payloads:t._operation.payloads,error:t._operation.error};t.progress=t._operation.progress;t.iconName=t._operation.iconName;t._initializeActions();t.title=t.createComputed(t._computeTitle);t.description=t.createComputed(t._computeDescription);t.css=t.createPureComputed(t._computeCss);t.showProgress=t.createPureComputed(t._computeShowProgress);return t}e.prototype._computeStates=function(){var e={created:0,started:0,completed:0,failed:0,canceled:0,expired:0};e[a.default[this._operation.state()]]=1;return e};e.prototype._computeTitle=function(){return this._operation.name};e.prototype._computeDescription=function(){var e=a.default[this._operation.state()],t=s.default[this._operation.type()],i=s.default[s.default.multiple],r=this._stringMappings.types[t].states[e],n=l.default.types[i].states[e],o=r&&r.description||n&&n.description;return this._evaluateOperationEntry(o)};e.prototype._initializeActions=function(){var i=this,e=c.observableArray();this.createComputed(function(){e(Object.keys(i._operation.actions()).map(function(e){return i._operation.actions.peek()[e]}))});var t=this.addDisposable(e.filter(function(e){return(!i._disallowedActions[e.key]||!i._disallowedActions[e.key]())&&e.isAvailable()})),r=this.addDisposable(t.map({mappingWithDisposeCallback:function(e){var t=new(i.managed(n.default))({action:e,onExecuteAction:i._onExecuteAction,actionMapping:i._stringMappings.actions});return{mappedValue:t,dispose:function(){t.dispose()}}}}));this.buttonActions=this.addDisposable(r.filter(function(e){return!e.icon}));this.iconActions=this.addDisposable(r.filter(function(e){return!!e.icon}))};e.prototype._computeCss=function(){return"OperationMonitor-item--"+a.default[this._operation.state()]};e.prototype._computeShowProgress=function(){var e=this._operation;return e.state()!==a.default.created&&e.progress.current()>e.progress.minimum()||this._evaluateOperationEntry(this._stringMappings.types[s.default[e.type.peek()]].showProgress)};e.prototype._evaluateOperationEntry=function(e){return"function"==typeof e?e(this.context):e};return e}(i.default);t.default=d});define("aei",["require","exports","ap","bF","s7","aC"],function(e,t,i,r,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t._action=e.action;t._onExecuteAction=e.onExecuteAction;t._context={count:t._action.count,states:t.createObservable({}),payloads:t.createObservable({}),progress:null,error:t.createObservable()};t.key=t._action.key;var i=e.actionMapping,r=void 0===i?o.default.actions:i;t._actionMapping=r[t.key];t.icon=t._actionMapping.icon;t.title=t.createPureComputed(t._computeTitle);t.iconCss=t.createPureComputed(t._computeIconCss);return t}e.prototype.execute=function(){var e=this;a.default.wrap().then(function(){return e._action.execute()}).done();this._onExecuteAction&&this._onExecuteAction()};e.prototype._computeTitle=function(){return o.resolveEntry(this._actionMapping.name,this._context)};e.prototype._computeIconCss=function(){return this.icon&&this.icon.getClass()||""};return e}(r.default);t.default=n});define("aeg",["require","exports","ap","bH","aq"],function(e,t,i,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(s){i.__extends(e,s);function e(e){for(var t=s.call(this,e)||this,i=[],r=0,n=l.virtualElements.childNodes(t.element);r<n.length;r++){var o=n[r];i.push(o)}l.virtualElements.emptyNode(t.element);var a=document.createElement(t.element.tagName);l.applyBindingsToNode(a,{template:{nodes:i}},t.bindingContext);t.element.appendChild(a);t.controlsDescendantBindings=!0;return t}return e}(r.default);t.default=n});define("aee",["require","exports","WD","b5","aef","WB"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"ms-progress-bar",template:e("aef"),viewModel:i.default,synchronous:!0});t.default=n});define("aef",[],function(){return"<div class=ProgressBar role=progressbar data-bind=\"attr: { 'aria-valuemin': minimum, 'aria-valuemax': maximum, 'aria-valuenow': current, 'aria-valuetext': description }\"><div class=ProgressBar-track>\x3c!--ko if: size--\x3e<div class=\"ProgressBar-value ProgressBar-value--under\" data-bind=\"style: { width: normalizedPercentage() + '%' }\"></div><div class=\"ProgressBar-value ProgressBar-value--exceeded\" data-bind=\"visible: percentage() > 100, style: { width: 100 - normalizedPercentage() + '%' }\"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: size--\x3e<div class=\"ProgressBar-value is-indeterminate\"></div>\x3c!--/ko--\x3e</div></div>"});define("aec",[],function(){return'<div class=OperationMonitor data-bind=preRender>\x3c!--ko if: groups().length--\x3e<div class=OperationMonitor-groups data-bind="foreach: groups"><div class=OperationMonitor-group><div class=OperationMonitor-item data-bind="class: css()">\x3c!--ko if: iconActions().length--\x3e<div class=OperationMonitor-itemIconActions data-bind="foreach: iconActions"><button class=OperationMonitor-itemIconAction data-bind="click: execute, attr: { title: title, \'aria-label\': title }, class: key"><i data-bind="css: iconCss"></i></button></div>\x3c!--/ko--\x3e<div class=OperationMonitor-itemName data-bind="bindableHtml: title"></div>\x3c!--ko if: showProgress--\x3e<div class=OperationMonitor-itemProgress data-bind="component: { name: $component.progressBarTagName, params: { progress: progress, description: description } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showDescription--\x3e<div class=OperationMonitor-itemDescription data-bind="text: description"></div>\x3c!--/ko--\x3e\x3c!--ko if: buttonActions().length--\x3e<div class=OperationMonitor-itemButtonActions data-bind="foreach: buttonActions"><button class="od-Button OperationMonitor-itemButtonAction" data-bind="click: execute"><span class=od-Button-label data-bind="text: title"></span></button></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: operations().length--\x3e<hr aria-hidden=true><div class=OperationMonitor-items data-bind="foreach: operations"><div class=OperationMonitor-item data-bind="class: css(), css: { \'OperationMonitor-item--icon\': !!iconName }">\x3c!--ko if: iconActions().length--\x3e<div class=OperationMonitor-itemIconActions data-bind="foreach: iconActions"><button class=OperationMonitor-itemIconAction data-bind="click: execute, attr: { title: title, \'aria-label\': title }, class: key"><i data-bind="css: iconCss"></i></button></div>\x3c!--/ko--\x3e<div class=OperationMonitor-itemType data-bind="component: { name: $component.fileTypeIconTagName, params: { desiredSize: 48, iconName: iconName } }"></div><div class=OperationMonitor-itemName data-bind="text: title"></div>\x3c!--ko if: showProgress--\x3e<div class=OperationMonitor-itemProgress data-bind="component: { name: $component.progressBarTagName, params: { progress: progress, description: description } }"></div>\x3c!--/ko--\x3e<div class=OperationMonitor-itemDescription data-bind="text: description"></div>\x3c!--ko if: buttonActions().length--\x3e<div class=OperationMonitor-itemButtonActions data-bind="foreach: buttonActions"><button class="od-Button OperationMonitor-itemButtonAction" data-bind="click: execute"><span class=od-Button-label data-bind="text: title"></span></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: showViewAll--\x3e<button class=od-OperationMonitor-viewAll data-bind="click: onClickViewAll, text: viewAllText"></button>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: groups().length--\x3e<p class=od-OperationMonitor-empty data-bind="text: noOperationsText"></p>\x3c!--/ko--\x3e</div>'});define("aeb",["c","az"],function(e,t){e.loadStyles([{rawString:".OperationMonitor hr{border:none;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:';margin:8px 0 16px 0}html[dir=rtl] .OperationMonitor hr{margin:8px 0 16px 0}.OperationMonitor-group:not(:last-child){padding-bottom:32px}.OperationMonitor-items .OperationMonitor-item:not(:last-child){margin-bottom:16px}.OperationMonitor-item{padding:0 40px 0 0}html[dir=rtl] .OperationMonitor-item{padding:0 0 0 40px}.OperationMonitor-item--icon .OperationMonitor-itemType{display:block}[dir=ltr] .OperationMonitor-item--icon{padding-left:56px}[dir=rtl] .OperationMonitor-item--icon{padding-right:56px}.OperationMonitor-itemName{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;padding-top:4px;line-height:20px}.OperationMonitor-itemProgress{padding:8px 0}.OperationMonitor-itemDescription{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;color:'},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:";font-size:11px;line-height:18px}.OperationMonitor-item--failed .OperationMonitor-itemDescription{color:#a80000;font-size:11px;word-wrap:break-word}.OperationMonitor-itemType{display:none;width:48px;height:48px;text-align:center;box-sizing:border-box;overflow:hidden;line-height:48px;margin-top:8px}html[dir=ltr] .OperationMonitor-itemType{float:left}html[dir=rtl] .OperationMonitor-itemType{float:right}[dir=ltr] .OperationMonitor-itemType{margin-left:-56px}[dir=rtl] .OperationMonitor-itemType{margin-right:-56px}.OperationMonitor-item:after{display:table;width:100%;content:'';clear:both}.OperationMonitor-itemIconActions{width:32px}html[dir=ltr] .OperationMonitor-itemIconActions{float:right}html[dir=rtl] .OperationMonitor-itemIconActions{float:left}[dir=ltr] .OperationMonitor-itemIconActions{margin-right:-40px}[dir=rtl] .OperationMonitor-itemIconActions{margin-left:-40px}.OperationMonitor-itemIconAction{width:32px;height:32px;text-align:center;padding-top:12px;text-align:center;box-sizing:border-box;overflow:hidden;background:0 0;border:0;cursor:pointer}.OperationMonitor-itemIconAction .ms-Icon{-ms-transform:translate(0,-50%);transform:translate(0,-50%);display:block;font-size:14px}.OperationMonitor-itemIconAction.cancel{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.OperationMonitor-itemButtonActions{width:218px}html[dir=ltr] .OperationMonitor-itemButtonActions{clear:right}html[dir=rtl] .OperationMonitor-itemButtonActions{clear:left}[dir=ltr] .OperationMonitor-itemButtonActions{margin-right:-40px}[dir=rtl] .OperationMonitor-itemButtonActions{margin-left:-40px}.OperationMonitor-itemButtonAction.od-Button{margin-top:6px}.OperationMonitor-itemButtonAction.od-Button .od-Button{padding:4px 16px 6px 16px}html[dir=rtl] .OperationMonitor-itemButtonAction.od-Button .od-Button{padding:4px 16px 6px 16px}.OperationMonitor-itemButtonAction.od-Button .od-Button-label{font-size:12px}[dir=ltr] .OperationMonitor-itemButtonAction.od-Button+.od-Button{margin-left:0}[dir=rtl] .OperationMonitor-itemButtonAction.od-Button+.od-Button{margin-right:0}[dir=ltr] .OperationMonitor-itemButtonAction.od-Button:not(:last-child){margin-right:6px}[dir=rtl] .OperationMonitor-itemButtonAction.od-Button:not(:last-child){margin-left:6px}.od-OperationMonitor-viewAll{padding:0;border:none;margin-top:16px;cursor:pointer;background:0 0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:'}.od-OperationMonitor-empty{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}.AnchorOverlay .OperationMonitor{max-width:400px;padding:10px}.ms-Callout .OperationMonitor{max-width:400px;padding:10px}'}])});define("ad8",[],function(){return"\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: {\r\n onClose: $component.onClosePanel.bind($component),\r\n title: panelTitle\r\n }\r\n}--\x3e\x3c!--ko control: operationMonitorSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});define("ad2",["require","exports","ad5","b5","ad4","ad3"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-show-permissions-panel-executor",template:e("ad4"),viewModel:i.default,synchronous:!0});t.default=n});define("ad5",["require","exports","ap","cE","AV","q0","adY","d7","ci","qH","cJ","dz","OJ","Oh","sX","OP","N7","eX","ad6","ba","qe","b3","oq","Ra"],function(e,t,i,n,r,o,a,s,l,c,d,u,p,m,h,f,g,b,_,v,y,S,x,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=h.strings,P=function(r){i.__extends(e,r);function e(e){var n=r.call(this,e)||this;n.malwareDetectedMessageComponent=k.malwareDetectedMessage;n.addBindingHandlers({bindableHtml:c.default,keyboard:d.default,control:S.default,selection:u.default,react:x.default});n.panelOverlayTagName=m.default.tagName;n.dialogHostTagName=o.default.tagName;n.personaTileTagName=p.default.tagName;n.sharingLinkTagName=g.default.tagName;n.permissionsPanelName=C.sharingPermissionsPanelName;n.FileNameWithIconTagname=a.default.tagName;n.addPeopleText=C.addPeople;n.advancedText=C.advanced;n.stopSharingText=C.stopSharing;n.personaListScreenReaderText=C.personaListScreenReaderText;var t=e.item,i=e.engagementSource;n.item=n.resources.consume(b.resourceKey).getItemSync({parentKey:t.key}).item;n.isLoading=n.createObservable(!1);n.hasFocus=!1;n.resources.bind(l.resourceKey);n.engagementSource=i;n.commandBarSpecification=S.toSpecification(y.resourceKey,{commandSet:new(n.managed(_.default))({engagementSource:n.engagementSource,item:n.item})});n._sharingSectionHelper=new(n.managed(f.default))({item:n.item});n.updateComplete=n._sharingSectionHelper.updateComplete;n.readPermissionsUpdated=n._sharingSectionHelper.readPermissionsUpdated;n._initializeUpdateText();n.links=n._sharingSectionHelper.links;n.personaTileCollection=n._sharingSectionHelper.personaTileCollection;n.scopes=n._sharingSectionHelper.scopes;n.createComputed(n._permissionsChanged);n.canUnshare=n.createPureComputed(function(){return!n._sharingSectionHelper.privateDescription()&&n._sharingSectionHelper.canUnshare()});n.hasSettings=n._sharingSectionHelper.hasSettings;n.isLoading=n._sharingSectionHelper.isLoading;n.advancedUrl=n._sharingSectionHelper.advancedUrl;n.isShareLinkVisible=n._sharingSectionHelper.isShareLinkVisible;n.hasFocus=n._sharingSectionHelper.hasFocus||!1;n.canManagePermissions=n._sharingSectionHelper.canManagePermissions;n.isSharedGlyphFeatureOn=v.isFeatureEnabled(v.EnableFolderShareAccessHint);n.isItemMalwareDetected=n.createPureComputed(n._computeIsItemMalwareDetected);n._storageOptionsProvider=n.resources.consume(s.storageOptions.optional);n.isPremium=n.createPureComputed(n._computeIsPremium);n.personaListTabIndex=n.createPureComputed(function(){for(var e=!1,t=0,i=n.keyNav.focusableTiles();t<i.length;t++){var r=i[t];e=e||r.focused()}return e});n.virtualParentElement=e.event?n._getVirtualParent(e.event.target):void 0;return n}e.prototype.stopSharing=function(){this._sharingSectionHelper.stopSharing(this.onClosePanel.bind(this))};e.prototype.onClosePanel=function(){this.action.complete()};e.prototype.onPermissionsPanelShareClick=function(){this._sharingSectionHelper.onShareClick()};e.prototype.onLinkRemoved=function(){this._sharingSectionHelper.onLinkRemoved()};e.prototype.onAdvancedClick=function(){this.resources.consume(n.resourceKey).logData({name:"AdvancedSettings.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};e.prototype.onScopeClick=function(e){this._sharingSectionHelper.onScopeClick(e.scope.item)};e.prototype._permissionsChanged=function(){this.keyNav=this._sharingSectionHelper.keyNav;this.fileItem=this._sharingSectionHelper.fileItem};e.prototype._initializeUpdateText=function(){this.updateComplete("");this.readPermissionsUpdated(!1)};e.prototype._computeIsPremium=function(){if(this._storageOptionsProvider.isReady())return this._storageOptionsProvider.hasOffice.peek()};e.prototype._getVirtualParent=function(e){for(;e;){if("true"===e.getAttribute("data-overlay-parent"))return e;e=e.parentElement}};e.prototype._computeIsItemMalwareDetected=function(){var e=this.item();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};return e}(r.default);t.default=P});define("ad6",["require","exports","ap","aq","bN","ba","dI","bX","rs","dm","rZ"],function(e,t,r,n,i,o,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.commands=n.observableArray();t._actionMap=t.resources.consume(s.actionMap);t.engagementSource=e.engagementSource;t.commands=n.observableArray([new(t.managed(d.default))({renderLabel:2,mode:2,item:e.item}).command]);o.isFeatureEnabled(o.ShareV3)&&t.commands.push(new(t.managed(l.CommandViewModel))({text:c.strings.grantAccess,icon:new a.default("PlayerSettings"),renderLabel:2,tooltip:c.strings.grantAccessCommandLabel,accessibleLabel:c.strings.grantAccessCommandLabel,engagementName:"GrantAccessFlowStartedFrom"+t.engagementSource,action:o.isFeatureEnabled(o.SharingDialogRedux)?new(t.managed(t._actionMap.ShareByLinkAction))({item:e.item}):new(t.managed(t._actionMap.ShareAction))({activeTab:1,item:e.item})}));return t}return e}(i.default);t.default=u});define("ad4",[],function(){return'\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: {\r\n ariaLabel: permissionsPanelName,\r\n onClose: $component.onClosePanel.bind($component),\r\n virtualParentElement: virtualParentElement\r\n }\r\n }--\x3e\x3c!--ko if: isSharedGlyphFeatureOn--\x3e<div class="od-ShowPermissions-commandBar od--hasSelection" data-bind="control: commandBarSpecification"></div>\x3c!--/ko--\x3e<div class=od-PermissionsPanel-container data-bind="css: { \'od-PermissionsPanel-container-withCommandbar\': isSharedGlyphFeatureOn }"><div class=od-PermissionsPanel-titleBar><div class=od-PermissionsPanel-head data-bind="text: permissionsPanelName"></div><div class=od-PermissionsPanel-fileName>\x3c!--ko component: { name: FileNameWithIconTagname, params: { oneDriveItem: fileItem} }--\x3e\x3c!--/ko--\x3e</div><div class=od-PermissionsPanel-stopSharing data-bind="visible: canUnshare"><a role=button href=javascript:; data-bind="click: stopSharing, text: stopSharingText"></a><br></div></div><div class=od-PermissionsPanel-content><div class=od-PermissionsPanel data-bind="keyboard: keyNav.keyboardOptions, selection: { data: keyNav.focusableTiles, mode: \'single\', direction: \'vertical\', focused: keyNav.focusedTile }">\x3c!--ko if: !isLoading() && isShareLinkVisible && !isSharedGlyphFeatureOn--\x3e<div class=od-PermissionsPanel-addPeople><a role=button href=# data-bind="click: onPermissionsPanelShareClick, hasFocus: hasFocus"><div class=od-PermissionsPanel-addPeople-icon><i class="ms-Icon ms-Icon--PeopleAdd" data-bind="icon: true"></i></div><span class=od-PermissionsPanel-addPeople-text data-bind="text: addPeopleText"></span></a></div>\x3c!--/ko--\x3e\x3c!--ko if: isItemMalwareDetected--\x3e<div class=od-PermissionsPanel-malwareDetectedMessageBar data-bind="react: { componentType: malwareDetectedMessageComponent }"></div>\x3c!--/ko--\x3e<span role=alert class=ms-accessible data-bind="text: updateComplete, visible: readPermissionsUpdated()"></span>\x3c!--ko if: !isLoading()--\x3e<div class=od-PermissionsPanel-links data-bind="foreach: { data: links, as: \'link\' }"><div class=od-PermissionsPanel-link data-bind="component: { name: $component.sharingLinkTagName, params: { link: link, isShareLinkVisible: $component.isShareLinkVisible, onLinkRemoved: function() { $component.onLinkRemoved(); } } }"></div></div><div class=od-PermissionPanel-shareScope data-bind="foreach: { data: scopes, as: \'scope\' }"><div class=od-PermissionPanel-shareScopeHeader data-bind="bindableHtml: headerHtml"></div><div class=od-PermissionPanel-shareEntities data-bind="foreach: { data: people, as: \'person\' }">\x3c!--ko if: person.sharingInfo.link--\x3e<div class=od-PermissionsPanel-link data-bind="component: { name: $component.sharingLinkTagName, params: { link: person.sharingInfo.link, isShareLinkVisible: $component.isShareLinkVisible, onLinkRemoved: function() { $component.onLinkRemoved(); }, isEditable: $component.isPremium() } }"></div>\x3c!--/ko--\x3e</div></div><div class=id-PermissionsPanel-PersonaList role=tree data-bind="attr: { \'aria-label\': personaListScreenReaderText, \'tabindex\': personaListTabIndex() ? -1 : 0 }"><div class=od-PermissionsPanel-PersonaTiles>\x3c!--ko foreach: personaTileCollection--\x3e<div class=od-PermissionsPanel-entity data-bind="component: { name: $parent.personaTileTagName, params: { canManagePermissions: $parent.canManagePermissions(), tile: $data } }"></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: canManagePermissions()--\x3e<div class=od-PermissionsPanel-linksBox data-bind="if: hasSettings()"><a target=_blank data-bind="attr: {href: advancedUrl}, text: advancedText, visible: advancedUrl(), click: onAdvancedClick"></a></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div></div>\x3c!--ko component: { name: dialogHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});define("ad3",["c","az"],function(e,t){e.loadStyles([{rawString:".od-PermissionsPanel-malwareDetectedMessageBar{padding:0 40px 20px 0}html[dir=rtl] .od-PermissionsPanel-malwareDetectedMessageBar{padding:0 0 20px 40px}"}])});define("adT",["require","exports","adV","b5","adU"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-show-itemAnalytics-executor",template:e("adU"),viewModel:i.default,synchronous:!0});t.default=n});define("adV",["require","exports","ap","AV","Oh","Ot","sX","adY","oq","adX","adW","bb"],function(e,t,r,i,n,o,a,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=a.strings,m=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({react:l.default});t.FileNameWithIconTagname=s.default.tagName;t.panelOverlayTagName=n.default.tagName;t.itemAnalyticsPanelName=p.ItemAnalyticsPanelName;t.item=e.item;t.personaImageTagName=o.default.tagName;t.showHighChart=!u.default.isActivated("BEB2CE2C-D271-49FE-BC06-1A952E93BBBC","04/16/2017","Enable item chart version2(weekly)");t.analyticsActivityListComponent=c.default;t.analyticsActivityListProps=t.createPureComputed(t._updateAnalyticsActivityListProps);t.analyticsItemChartComponent=d.default;t.analyticsItemChartProps=t.createPureComputed(t._updateAnalyticsItemChartListProps);return t}e.prototype.onClosePanel=function(){this.action.complete()};e.prototype._updateAnalyticsActivityListProps=function(){return{item:this.item(),resources:this.resources}};e.prototype._updateAnalyticsItemChartListProps=function(){return{item:this.item(),resources:this.resources}};return e}(i.default);t.default=m});define("adX",["require","exports","ap","at","jP","M9","dZ","M8","n7"],function(e,t,r,o,n,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.resources=e.resources;t.state={fileHoverCardStore:t.resources.consume(l.resourceKey.optional),graphDataSource:t.resources.consume(s.graph.optional)};return t}e.prototype.componentDidMount=function(){var t=this;this.resources.consumeAsync(l.resourceKey).then(function(e){t.setState({fileHoverCardStore:e})});this.resources.consumeAsync(s.graph).then(function(e){t.setState({graphDataSource:e})})};e.prototype.render=function(){var e=this.state,t=e.fileHoverCardStore,i=e.graphDataSource,r=c.getGraphItemUrl(i,this.props.item),n={itemId:this.props.item.itemId,graph:this.props.item.graph,extension:this.props.item.extension,graphItemUrl:r,getAccessToken:this.getAccessToken};return o.createElement("div",{className:"AnalyticsActivityListField"},t?o.createElement(d,{item:n,fileHoverCardStore:t}):this.props.children)};e.prototype.getAccessToken=function(){return c.getGraphAccessToken(this.state.graphDataSource,this.props.item)};r.__decorate([n.autobind],e.prototype,"getAccessToken",null);return e}(o.Component);t.default=i;var d=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={itemAnalyticsResult:t.props.fileHoverCardStore.getItemAnalytics(t.props.item)};return t}e.prototype.componentWillReceiveProps=function(e){e.item!==this.props.item&&this.setState({itemAnalyticsResult:this.props.fileHoverCardStore.getItemAnalytics(e.item)})};e.prototype.componentDidMount=function(){this._addListener()};e.prototype.componentDidUpdate=function(e){var t=this.props.fileHoverCardStore;if(this.props.item.itemId!==e.item.itemId){t.removeListener(this._storeListener,e.item);this._addListener()}};e.prototype.componentWillUnmount=function(){this.props.fileHoverCardStore.removeListener(this._storeListener,this.props.item)};e.prototype.render=function(){var e=this,t=this.props.fileHoverCardStore,i=this.state.itemAnalyticsResult,r=i&&i.data,n=i&&i.skipToken;return o.createElement("div",{className:"AnalyticsActivityList--item"},o.createElement(a.AnalyticsActivityList,{itemAnalytics:r,moreActivities:!!n,onLoadMoreActivities:function(){return t.fetchItemAnalytics(e.props.item,n)}}))};e.prototype._addListener=function(){var e=this,t=this.props.fileHoverCardStore;this._storeListener=t.addListener(function(){e.setState({itemAnalyticsResult:t.getItemAnalytics(e.props.item)})},this.props.item);t.fetchItemAnalytics(this.props.item)};r.__decorate([n.autobind],e.prototype,"_addListener",null);return e}(o.Component);t.AnalyticsActivityListWrap=d});define("adW",["require","exports","ap","at","c7","aC","jP","M9","dZ","M8","n7"],function(i,e,r,o,n,a,t,s,l,c,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var u=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.resources=e.resources;t.state={itemAnalyticsStore:t.resources.consume(c.resourceKey.optional),graphDataSource:t.resources.consume(l.graph.optional)};return t}e.prototype.componentDidMount=function(){var t=this;this.resources.consumeAsync(c.resourceKey).then(function(e){t.setState({itemAnalyticsStore:e})});this.resources.consumeAsync(l.graph).then(function(e){t.setState({graphDataSource:e})})};e.prototype.render=function(){var e=this.state,t=e.itemAnalyticsStore,i=e.graphDataSource,r=d.getGraphItemUrl(i,this.props.item),n={itemId:this.props.item.itemId,graph:this.props.item.graph,graphItemUrl:r,getAccessToken:this.getAccessToken};return o.createElement("div",{className:"AnalyticsItemChartField"},t&&i?o.createElement(p,{item:n,itemAnalyticsStore:t}):this.props.children)};e.prototype.getAccessToken=function(){return d.getGraphAccessToken(this.state.graphDataSource,this.props.item)};r.__decorate([t.autobind],e.prototype,"getAccessToken",null);return e}(o.Component);e.default=u;var p=function(t){r.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){var e=this.props.itemAnalyticsStore,t=n.loadModule({path:"aw",getModule:function(){return new a.default(function(e,t){i(["aw"],e,t)})}});return o.createElement("div",{className:"AnalyticsItemChart--item"},o.createElement(s.AnalyticsItemChart,{item:this.props.item,itemAnalyticsStore:e,highchartsInstance:t}))};return e}(o.Component);e.AnalyticsItemChartWrap=p});define("adU",[],function(){return'\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: {\r\n ariaLabel: itemAnalyticsPanelName,\r\n onClose: $component.onClosePanel.bind($component)\r\n }\r\n }--\x3e<div class=od-ItemAnalytics-container><div class=od-ItemAnalytics-titleBar><div class=od-PermissionsPanel-head data-bind="text: itemAnalyticsPanelName"></div><div class=od-ItemAnalytics-fileName data-bind="component: { name: FileNameWithIconTagname, params: { oneDriveItem: item() } }"></div></div>\x3c!--ko if: showHighChart--\x3e<div class=od-ItemAnalytics-highChart data-bind="react: { componentType: analyticsItemChartComponent, props: analyticsItemChartProps }"></div>\x3c!--/ko--\x3e<div class=od-ItemAnalytics-activities data-bind="react: { componentType: analyticsActivityListComponent, props: analyticsActivityListProps }"></div></div>\x3c!--/ko--\x3e'});define("adM",["require","exports","adP","b5","adO","adN"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-show-version-history-executor",template:e("adO"),viewModel:i.default,synchronous:!0});t.default=n});define("adP",["require","exports","ap","AV","oq","qH","adS","Oh","adR","adQ"],function(e,t,i,r,o,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this;t.addBindingHandlers({bindableHtml:a.default,react:o.default});t.panelTagName=l.default.tagName;t.panelSize="Medium";t.panelTitle=s.strings.panelName;var i=e.item,r=t.createObservable([]);t.addBindingHandlers({react:o.default});t.resources.consume(c.resourceKey).getVersionHistoryInfo(i()).then(function(e){r(e)});t.listComponent=d.default;t.listComponentProps={items:r,fileItem:i(),resources:t.resources};return t}e.prototype.onClosePanel=function(){this.action.complete()};return e}(r.default);t.default=n});define("adR",["require","exports","bA","dZ"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._dataSource=t.dataSource}e.prototype.getVersionHistoryInfo=function(e){return this._dataSource.getVersionHistoryInfo(e)};e.prototype.restoreVersionByLabel=function(e,t){return this._dataSource.restoreVersionByLabel(e,t)};e.prototype.deleteVersionByLabel=function(e,t){return this._dataSource.deleteVersionByLabel(e,t)};e.prototype.canRestoreVersions=function(e){return this._dataSource.canRestoreVersions(e)};e.prototype.canDeleteVersions=function(e){return this._dataSource.canDeleteVersions(e)};e.prototype.showVersionLabel=function(){return this._dataSource.showVersionLabel()};return e}();t.default=n;t.resourceKey=i.createResolvedResourceKey(e("module").id,n,{dataSource:r.versionHistory})});define("adQ",["require","exports","ap","at","oB","pz","bN","px","bD","wN","wt","hO","hs","bX","adR","dZ","dc","eV","adS","dm","V","eU","nP","by"],function(e,t,n,o,a,s,r,l,c,d,u,p,m,h,f,g,b,_,v,y,S,x,k,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){n.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.resources=e.resources;t.fileItem=e.fileItem;t.state={items:[],onItemContextMenu:null,menuProps:null};t._versionHistoryProvider=t.resources.consume(f.resourceKey);t.columns=t._getColumns();t.selectionMode=e.selectionMode;t.scope=new c.default;t.observables=t.scope.attach(new(t.resources.consume(r.observablesFactoryTypeResourceKey))({owner:t}));t._actionMap=t.resources.consume(h.actionMap);t._platform=t.resources.consume(C.platformDetection);return t}e.prototype.componentWillMount=function(){this.observables.compute(this._computeItems).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})};e.prototype.render=function(){var e=this.state,t=e.items,i=e.onItemContextMenu,r=e.menuProps;return o.createElement(s.Fabric,null,o.createElement(a.DetailsList,{ref:"list",items:t,columns:this.columns,selectionMode:l.SelectionMode.none,onItemContextMenu:i,getRowAriaLabel:this._getAriaLabel,className:"od-versionHistoryList",ariaLabel:"List of versions, use up and down arrow keys to navigate, use the SPACE key to select within the list."}),r&&o.createElement(u.ContextualMenu,n.__assign({},r)))};e.prototype._getAriaLabel=function(e){return v.strings.columnNameNumber+" "+e.versionLabel+", "+v.strings.columnNameModifiedDate+" "+e.created.toString()+", "+v.strings.columnNameModifiedBy+" "+e.createdBy.Title+", "+v.strings.columnNameSize+" "+p.default.getDisplayString(e.size,{ignoreZero:!0})};e.prototype._reLoadPage=function(){var t=this;this._versionHistoryProvider.getVersionHistoryInfo(this.fileItem).then(function(e){t.setState({items:e})})};e.prototype._computeItems=function(){var r=this,e=this.props.items();this.setState({items:e,onItemContextMenu:function(e,t,i){r.setState({menuProps:n.__assign({target:"#more-"+e.id},r._getMenuProps(e))})}})};e.prototype._getColumns=function(){var r=this,e=[{key:"version.modifiedDate",columnActionsMode:a.ColumnActionsMode.disabled,name:v.strings.columnNameModifiedDate,ariaLabel:S.format(v.strings.columnHeaderAriaLabel,v.strings.columnNameModifiedDate),fieldName:null,minWidth:160,maxWidth:160,onRender:function(e,t,i){return o.createElement("div",{className:"od-modifiedDateColumn"},o.createElement("a",{className:"od-modifiedDateColumn-modifiedDate","aria-label":S.format(v.strings.cellAriaLabel,v.strings.columnNameModifiedDate,m.getFriendlyDateTimeStringPast(new Date(e.created))),href:r._getOpenFileLink(e)},m.getFriendlyDateTimeStringPast(new Date(e.created))))}},{key:"version.dotdotdot",name:"",columnActionsMode:a.ColumnActionsMode.disabled,ariaLabel:S.format(v.strings.columnHeaderAriaLabel,v.strings.columnNameDotdotdot),fieldName:null,minWidth:40,maxWidth:40,onRender:function(e,t,i){return o.createElement(d.IconButton,{id:"more-"+e.id,className:"od-FieldRenderer-dot od-modifiedDateColumn-moreButton",role:"button",ariaLabel:v.strings.buttonNameDotdotdot,iconProps:{iconName:"More"},onClick:function(){return r.setState({menuProps:n.__assign({target:"#more-"+e.id},r._getMenuProps(e))})}})}},{key:"version.modifiedBy",name:v.strings.columnNameModifiedBy,columnActionsMode:a.ColumnActionsMode.disabled,ariaLabel:S.format(v.strings.columnHeaderAriaLabel,v.strings.columnNameModifiedBy),fieldName:null,minWidth:160,maxWidth:160,onRender:function(e,t,i){return k.userRendererByUser([{title:e.createdBy.Title,email:e.createdBy.Email,picture:void 0,sip:e.createdBy.Email}],r.resources,{text:"version.modifiedBy",isDisabled:!1,ariaLabel:S.format(v.strings.cellAriaLabel,v.strings.columnNameModifiedBy,e.createdBy.Title)},"od-modifiedByColumn")}},{key:"version.size",name:v.strings.columnNameSize,columnActionsMode:a.ColumnActionsMode.disabled,ariaLabel:S.format(v.strings.columnHeaderAriaLabel,v.strings.columnNameSize),fieldName:null,minWidth:80,maxWidth:80,onRender:function(e,t,i){return o.createElement("div",{"data-is-focusable":"true",className:"od-fileSizeColumn","aria-label":S.format(v.strings.cellAriaLabel,v.strings.columnNameSize,p.default.getDisplayString(e.size,{ignoreZero:!0}))},e.size?p.default.getDisplayString(e.size,{ignoreZero:!0}):"")}}];this._versionHistoryProvider.showVersionLabel()&&e.unshift({key:"version.number",name:v.strings.columnNameNumber,columnActionsMode:a.ColumnActionsMode.disabled,fieldName:null,minWidth:40,maxWidth:40,ariaLabel:S.format(v.strings.columnHeaderAriaLabel,v.strings.columnNameNumber),onRender:function(e,t,i){return o.createElement("div",{"data-is-focusable":"true",className:"od-versionNumberColumn","aria-label":S.format(v.strings.cellAriaLabel,v.strings.columnNameNumber,e.versionLabel)},e.versionLabel)}});return e};e.prototype._getOpenFileLink=function(e){var t=this.fileItem,i=new _.default(t.key);x.default(i,t);e.isCurrentVersion||x.default(i,{properties:{path:e.url}});var r=this.resources.consume(g.url),n=this.resources.consume(b.navigation),o=this._platform.isMac;return t.appMap&&!o?r.getOpenInOfficeClientUrl(i,n.viewParams):e.url};e.prototype._getMenuProps=function(e){var t=this;return{directionalHint:7,isBeakVisible:!1,items:this._getMenuItems(e),gapSpace:0,onDismiss:function(){return t.setState({menuProps:null})}}};e.prototype._getMenuItems=function(i){var r=this,e={key:"version.restore",name:v.strings.versionActionNameRestore,onClick:function(){r._versionHistoryProvider.restoreVersionByLabel(r.fileItem,i.versionLabel).then(function(e){e&&r._reLoadPage()})}},t={key:"version.open",name:v.strings.versionActionNameOpen,onClick:function(e,t){return new(r.resources.injected(r._actionMap.NavigationAction))({url:r._getOpenFileLink(i)}).execute(e)}},n={key:"version.download",name:y.strings.Download,onClick:function(e,t){return new(r.resources.injected(r._actionMap.NavigationAction))({url:r._getOpenFileLink(i)}).execute(e)}},o={key:"version.delete",name:v.strings.versionActionNameDelete,onClick:function(){r._versionHistoryProvider.deleteVersionByLabel(r.fileItem,i.versionLabel).then(function(e){e&&r._reLoadPage()})}},a=[];this._canRestoreVersion(i)&&a.push(e);this._platform.isMac?a.push(n):a.push(t);this._canDeleteVersion(i)&&a.push(o);return a};e.prototype._canDeleteVersion=function(e){return!e.isCurrentVersion&&this._versionHistoryProvider.canDeleteVersions(this.fileItem)};e.prototype._canRestoreVersion=function(e){return!e.isCurrentVersion&&this._versionHistoryProvider.canRestoreVersions(this.fileItem)};return e}(o.Component);t.ReactVersionHistoryList=i;t.default=i});define("adO",[],function(){return'\x3c!--ko component: {\r\n name: panelTagName,\r\n params: {\r\n ariaLabel: panelTitle,\r\n size: panelSize,\r\n onClose: $component.onClosePanel.bind($component)\r\n }\r\n}--\x3e<div class=od-versionHistory-panelTitle data-bind="text: panelTitle"></div><div class=od-versionHistory-container role=application><div data-bind="react: { componentType: listComponent, props: listComponentProps }"></div></div>\x3c!--/ko--\x3e'});define("adN",["c","az"],function(e,t){e.loadStyles([{rawString:".od-versionHistory-panelTitle{top:50px;position:absolute;padding-bottom:20px;font-size:20px}.od-versionHistory-container{position:absolute;top:100px;overflow:auto}.od-versionHistory-container .od-fileSizeColumn,.od-versionHistory-container .od-modifiedByColumn,.od-versionHistory-container .od-versionNumberColumn{line-height:32px}.od-versionHistory-container .od-modifiedDateColumn{height:32px;line-height:32px}.od-versionHistory-container .od-FieldRenderer-dot.od-modifiedDateColumn-moreButton.ms-Button.ms-Button--icon{margin:0}"}])});define("adg",["require","exports","b5","adi","adh"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"od-show-Filters-executor",template:e("adh"),viewModel:r.default,synchronous:!0});t.default=n});define("adi",["require","exports","ap","AV","d7","adj","bX","dH","gN","dZ","LT","bT"],function(e,t,i,r,n,o,a,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.filtersPaneComponent=o.default.tagName;t._isFiltersPaneVisible=t.resources.consume(d.isFilterPaneOpenResourceKey);var i=t.resources.consume(n.infoPane);t._currentItem=t.resources.consume(a.currentItem);t._urlDataSource=t.resources.consume(c.url);t.createBackgroundComputed(function(){return t._computePaneVisibility()});t.createComputed(function(){t._isFiltersPaneVisible();u.default.raise(document.body,"resize",void 0,!0)});t.infoPaneTransclusionContentParams={provider:i};return t}e.prototype._computePaneVisibility=function(){var e=l.default.getKeyParams(this._currentItem().key);if(!this._isFiltersPaneVisible()||!(this._urlDataSource.isCurrentQuery(s.default.Search,e)||this._urlDataSource.isCurrentQuery(s.default.SharedWithMe,e))){this._isFiltersPaneVisible(!1);this.action.cancel()}};return e}(r.default);t.default=p});define("adj",["require","exports","aC","on","aq","adL","adk"],function(i,e,t,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=r.createComponent("ms-filters-pane","adk",function(){return new t.default(function(e,t){i(["adk"],e,t)})});n.components.isRegistered(o.tagName)||n.components.register(o.tagName,o);e.default=o});define("adL",["c","az"],function(e,t){e.loadStyles([{rawString:'.FiltersPane{padding:20px;box-sizing:border-box;outline:0;position:absolute;top:0;bottom:0;left:0;right:0;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}.FiltersPane::after,.FiltersPane::before{display:table;content:\'\';line-height:0}.FiltersPane::after{clear:both}.FiltersPane button{font-family:inherit}.FiltersPane-title{display:inline-block;max-width:60%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;vertical-align:text-bottom;cursor:default;font-family:"Segoe UI Light WestEuropean","Segoe UI Light","Segoe UI",Tahoma,Arial,sans-serif;font-size:21px;font-weight:400}[dir=ltr] .FiltersPane-title{margin-right:15px}[dir=rtl] .FiltersPane-title{margin-left:15px}.FiltersPane-section{margin-bottom:18px}.FiltersPane-sectionContent{margin-top:4px;font-size:12px}.FiltersPane-sectionFooter{margin-top:0}.FiltersPane-header{margin-bottom:18px;position:relative}.FiltersPane-filterClear-icon.ms-Button.ms-Button--icon{position:absolute}[dir=ltr] .FiltersPane-filterClear-icon.ms-Button.ms-Button--icon{right:0}[dir=rtl] .FiltersPane-filterClear-icon.ms-Button.ms-Button--icon{left:0}.FiltersPane-slider .ms-Slider{margin-bottom:0}.FiltersPane-slider .ms-Slider>.ms-Label{padding-bottom:12px}.FiltersPane-slider .ms-Slider .ms-Label{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:'}.FiltersPane-slider .ms-Slider .ms-Slider-container .ms-Slider-slideBox{height:16px}.FiltersPane-slider .FiltersPane-slider-bottomLabel{margin-top:8px;position:relative}.FiltersPane-slider .FiltersPane-slider-maxLabel{position:absolute}[dir=ltr] .FiltersPane-slider .FiltersPane-slider-maxLabel{right:0}[dir=rtl] .FiltersPane-slider .FiltersPane-slider-maxLabel{left:0}.FiltersPane-slider .FiltersPane-slider-maxLabel,.FiltersPane-slider .FiltersPane-slider-minLabel{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:400;color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:'}.FiltersPane-noFilter{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:400}'}])});define("adk",["require","exports","ap","at","bN","bD","aL","a0","adK","adI","E7","bX","d7","qY","gP","iE","FK","adz","adw","adt","dc","dZ","ex","dJ","V","jG","hD","adr","adm","adl"],function(e,t,r,a,n,o,u,p,s,l,c,d,m,h,f,g,b,_,v,y,S,x,k,C,P,I,w,T,L,F){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._scope=new o.default;t._resources=e.hostViewModel.resources;t._observables=t._scope.attach(new(t._resources.consume(n.observablesFactoryTypeResourceKey))({owner:t}));t._viewParams=t._resources.consume(d.viewParams);t._currentView=t._resources.consume(d.currentView);t.filtersProvider=t._resources.isExposed(m.smartFilters)?t._resources.consume(m.smartFilters):new(t._resources.injected(l.default));t._panelProvider=t._resources.consume(h.resourceKey);t._navigation=t._resources.consume(S.navigation);t._dataSource=t._resources.consume(x.items);t._currentItem=t._resources.consume(d.currentItem);t._pageContext=t._resources.consume(g.pageContext);t._eventScope=t._resources.isExposed(I.eventScope)?t._resources.consume(I.eventScope):void 0;t.state={filterSectionInfos:[],isLoading:!0,isTeachingBubbleVisible:!1};return t}e.prototype.componentDidMount=function(){var r=this;this._getSmartFilters();this._observables.compute(function(){return r._currentItem()&&r._viewParams()}).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}}).subscribe(function(){r._getSmartFilters(!1)});if(this._eventScope){this._events.on(this._eventScope,f.FiltersPaneEvents.applyPanel,function(e){var t=r.state.filterSectionInfos,i=e;r.filtersProvider.shouldShowEditButton&&r.filtersProvider.shouldShowEditButton()&&(i.showEditButton=!0);c.addOrUpdateSectionInfo(t,i,5);r.setState({filterSectionInfos:t})});this._events.on(this._eventScope,f.FiltersPaneEvents.showInFiltersPaneChanged,function(e){r.filtersProvider.updateShowInFiltersPaneProperty(e.fieldName,e.showInFiltersPane);r._getSmartFilters(!0)});this._events.on(this._eventScope,f.FiltersPaneEvents.sectionInfosChanged,function(){r._getSmartFilters(!1)})}this._root&&this._root.focus()};e.prototype.componentWillUnmount=function(){this._scope.dispose()};e.prototype.render=function(){var t=this,e=this.state,i=e.filterSectionInfos,r=e.isLoading,n=!r&&i&&0===i.length,o=!this._hasFilterApplied(r,i,n);return a.createElement("div",{className:"FiltersPane",ref:this._resolveRef("_root"),role:"dialog",tabIndex:0,"aria-label":s.strings.FiltersPaneAriaLabel},a.createElement("div",{className:"FiltersPane-header"},a.createElement("div",{className:"FiltersPane-title"},s.strings.FiltersPaneTitle),a.createElement(b.IconButton,{className:"FiltersPane-filterClear-icon",iconProps:{iconName:"ClearFilter"},ariaLabel:s.strings.ClearFilterButtonTitle,onClick:this._clearFilter,"data-automationid":"ClearFilter",title:s.strings.ClearFilterButtonTitle,disabled:o})),r&&a.createElement(b.Spinner,{type:b.SpinnerType.large,label:s.strings.LoadingStatus}),!r&&i&&i.map(function(e){return t._renderSection(e)}),n&&a.createElement("div",{className:"FiltersPane-noFilter"},s.strings.NoApplicableFilter))};e.prototype._renderSection=function(e){var t={label:s.strings.SeeAllLinkLabel,filterSectionInfo:e,getFilterData:this._getFilterData,getOptionFromServerFilterValue:this._getOptionFromServerFilterValue,ariaDescription:P.format(s.strings.SeeAllLinkAriaDescription,e.title),launchFilterSelectPanel:this._launchFilterSelectPanel},i=e.showEditButton?this.filtersProvider.getCommandItems(e.fieldName):[];if(e.isLoading)return a.createElement("div",{className:"FiltersPane-section FiltersPane-hierachyFilterSection","data-automationtype":"FilterSection","data-section-type":e.type,"data-section-key":e.fieldName,key:e.fieldName},a.createElement(T.default,{text:e.title,showEditButton:e.showEditButton,commandItems:i}),a.createElement(b.Spinner,{type:b.SpinnerType.large,label:s.strings.LoadingStatus}));if(4===e.type){var r=e;return a.createElement(v.HierachyFilterSection,{key:e.fieldName,sectionInfo:r,commandItems:i,onCheckChange:this._onCheckChange,onExpandChange:this._onExpandChange})}if(1===e.type){var n=e;t.label=s.strings.SelectSpecificDatesLabel;return a.createElement(y.SliderFilterSection,{key:e.fieldName,sectionInfo:n,onChange:this._onSliderChange,onDateCheckboxChange:this._onFilterChange,seeAllLinkProps:t,commandItems:i})}return a.createElement(_.CheckboxFilterSection,{key:e.fieldName,strings:F.strings,sectionInfo:e,onChange:this._onFilterChange,seeAllLinkProps:t,pageContext:this._pageContext,showFilterPicker:e.showFilterPicker,onResolveSuggestions:function(){return[]},onSelectedSuggestionChange:this._onSelectedSuggestionsChange,commandItems:i})};e.prototype._launchFilterSelectPanel=function(e){var t=this,i=P.format(s.strings.SeeAllPanelAriaLabel,e.title),r=this._panelProvider.requestPanel({noTitle:!0,title:i||e.title,component:{name:L.default.tagName,params:{filterSectionInfo:e,getFilterSuggestions:this.filtersProvider&&this.filtersProvider.getFilterSuggestions.bind(this.filtersProvider),onComplete:function(e){t._onSeeAllComplete(e);r.state(1)}}}})};e.prototype._onCheckChange=function(e,t,i,r){for(var n=this.state.filterSectionInfos,o=0;o<n.length;o++){var a=n[o];if(a.fieldName===e){var s=a;s.checkedKeys=r;s.checkedValues=i;this.filtersProvider.filter(e,k.ColumnFieldType.Taxonomy,a.serverFieldType,i);this.setState({filterSectionInfos:n});return}}};e.prototype._onExpandChange=function(i,o,r,a){for(var s=this,l=this.state.filterSectionInfos,e=function(e){var t=l[e];if(t.fieldName===i){var n=t;n.expandedKeys=a;r?c.filtersProvider.getTaxonomyFieldNextFilteringHierachy(t.fieldId,o.key).then(function(e){o.children=e;if(0<=n.checkedKeys.indexOf(o.key))for(var t=0,i=e;t<i.length;t++){var r=i[t];-1===n.checkedKeys.indexOf(r.key)&&n.checkedKeys.push(r.key)}s.setState({filterSectionInfos:l})}):c.setState({filterSectionInfos:l});return{value:void 0}}},c=this,t=0;t<l.length;t++){var n=e(t);if("object"==typeof n)return n.value}};e.prototype._onFilterChange=function(e,t,i,r){for(var n=this.state.filterSectionInfos,o=0;o<n.length;o++){var a=n[o];if(a.fieldName===e){1!==a.type||i&&0!==i.length||(a.value=f.DateTimeSliderValue.none);if(a.options){for(var s=0,l=a.options;s<l.length;s++){for(var c=l[s],d=!1,u=0,p=c.values;u<p.length;u++){var m=p[u];if(i&&0<=i.indexOf(m)){d=!0;break}}c.checked=d}r&&a.options.splice(5)}this.filtersProvider.filter(e,t,a.serverFieldType,i);this.setState({filterSectionInfos:n});return}}};e.prototype._onSelectedSuggestionsChange=function(e,t,i){if(i)for(var r=this.state.filterSectionInfos,n=0;n<r.length;n++){var o=r[n];if(o.fieldName===e){for(var a=[],s=void 0,l=0,c=o.options;l<c.length;l++){var d=c[l];i.key===d.key&&((s=d).checked=!0);d.checked&&(a=a.concat(d.values))}if(!s){i.checked=!0;o.options.push(i);a=a.concat(i.values)}this.setState({filterSectionInfos:r});this.filtersProvider.filter(e,t,o.serverFieldType,a);break}}};e.prototype._getFilterData=function(e,t){var i=C.serializeQuery(this._navigation.viewParams),r=this._currentView.peek(),n=r&&r.id;return this._dataSource.getFilterData(e,i,n,t)};e.prototype._clearFilter=function(e){for(var t=this.state.filterSectionInfos,i=[],r=u.deepCopy(t),n=0,o=r;n<o.length;n++){if(1===(d=o[n]).type)d.value=f.DateTimeSliderValue.none;else if(4===d.type){d.checkedKeys=[];continue}if(d.options){for(var a=0,s=d.options;a<s.length;a++){s[a].checked=!1}d.options.splice(5)}}for(var l=0,c=t;l<c.length;l++){var d=c[l];i.push(d.fieldName)}p.Engagement.logData({name:"ClearFilter.SmartFiltersPane.Click",isIntentional:!0});this.filtersProvider.clearFilters(i,r);this.setState({filterSectionInfos:r})};e.prototype._getSmartFilters=function(e){var i=this,t=this._currentView.peek(),r=this._viewParams.peek(),n=r.hasOwnProperty("viewid")&&r.viewid,o=r.newTargetListUrl,a=r.needsAttentionView;if(n&&n!==t.id||a&&t.id!==w.NeedsAttentionViewId||o&&o!==this._pageContext.listUrl){var s=this._currentView.subscribe(function(){s.dispose();i._getSmartFilters(e)});this._scope.attach(s)}else this.filtersProvider.getSections(5,e).then(function(e){var t={filterSectionInfos:e};i.setState(t);i.setState({isLoading:!1})})};e.prototype._onSeeAllComplete=function(e){var t=this.state.filterSectionInfos;this.filtersProvider.filterBySectionOptions(e);c.addOrUpdateSectionInfo(t,e,5);this.setState({filterSectionInfos:t})};e.prototype._getOptionFromServerFilterValue=function(e,t){return c.getFilterOption(this._resources,e,t.display,t.value)};e.prototype._onSliderChange=function(e,t,i){for(var r=this.state.filterSectionInfos,n=0;n<r.length;n++){var o=r[n];if(o.fieldName===e){o.value=i;this.filtersProvider.filterByDateTimeSliderValue(e,i);this.setState({filterSectionInfos:r});return}}};e.prototype._hasFilterApplied=function(e,t,i){var r=!1;if(!e&&!i)for(var n=0,o=t;n<o.length;n++){var a=o[n];if(1===a.type)r=a.value!==f.DateTimeSliderValue.none;else if(4===a.type){var s=a.checkedKeys;r=s&&0<s.length}if(!r&&a.options)for(var l=0,c=a.options;l<c.length;l++){if(c[l].checked){r=!0;break}}if(r)break}return r};r.__decorate([b.autobind],e.prototype,"_renderSection",null);r.__decorate([b.autobind],e.prototype,"_launchFilterSelectPanel",null);r.__decorate([b.autobind],e.prototype,"_onCheckChange",null);r.__decorate([b.autobind],e.prototype,"_onExpandChange",null);r.__decorate([b.autobind],e.prototype,"_onFilterChange",null);r.__decorate([b.autobind],e.prototype,"_onSelectedSuggestionsChange",null);r.__decorate([b.autobind],e.prototype,"_getFilterData",null);r.__decorate([b.autobind],e.prototype,"_clearFilter",null);r.__decorate([b.autobind],e.prototype,"_getSmartFilters",null);r.__decorate([b.autobind],e.prototype,"_onSeeAllComplete",null);r.__decorate([b.autobind],e.prototype,"_getOptionFromServerFilterValue",null);r.__decorate([b.autobind],e.prototype,"_onSliderChange",null);return e}(b.BaseComponent);t.default=i});define("adI",["require","exports","ap","bN","dc","dJ","aI","aI","iE","iJ","iF","hK","bX","dZ","cE","in","aC","E9","gP","bp","hE","im","ex","E4","adJ","E7","eX","gl","fZ","eA","fO","ba","bT","jG","aZ"],function(e,t,d,i,r,y,u,Y,n,o,a,p,s,l,c,h,ee,S,te,g,m,x,ie,re,f,ne,b,_,v,k,C,P,oe,I,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T="Modified",L="DocIcon",F="ContentType",E=[T,L],D=["Editor","DocIcon","Modified"],M=function(t){d.__extends(e,t);function e(){var e=t.call(this)||this;e._columnInfoHash={};e._itemsStore=e.resources.consume(o.resourceKey);e._smartFiltersStore=e.resources.isExposed(a.smartFiltersStore)?e.resources.consume(a.smartFiltersStore):new f.default;e._pageContext=e.resources.consume(n.pageContext);e._listContext=e.resources.consume(n.listContext);e._navigation=e.resources.consume(r.navigation);e._viewParams=e.resources.consume(s.viewParams);e._urlDataSource=e.resources.consume(l.url);e._currentView=e.resources.consume(s.currentView);e._currentItemKey=e.createPureComputed(e._computeCurrentItemKey,{deferEvaluation:!0});e._currentItem=e.resources.consume(s.currentItem);e._currentItemSet=e.resources.consume(s.currentItemSet);e._itemProvider=e.resources.consume(b.resourceKey);e._dataRequestor=new(e.child(_.typeResourceKey))({qosName:"SmartFiltersDataSource"});e._apiUrlHelper=e.resources.consume(v.resourceKey);e._itemParentHelper=e.resources.consume(k.resourceKey);e._itemUrlHelper=e.resources.consume(C.resourceKey);e._actionMap=e.resources.consume(s.actionMap);e._eventScope=e.resources.consume(I.eventScope);e._engagement=e.resources.consume(c.resourceKey);e._pendingGetSectionsPromises={};return e}e.prototype.getSections=function(J,e){var $,Q=this;this._updateGetItemContext();J||(J=5);var t=this._smartFiltersStore.getFilterSectionInfos(this._getItemContext.parentKey,this._currentView.peek().id,this._viewParams.peek()),Z=this._getPendingPromiseKey(this._getItemContext.parentKey,this._currentView.peek().id);if(t){for(var i=0,r=t.sectionInfos;i<r.length;i++){var n=r[i];1===n.type&&(n.value=te.DateTimeSliderValue.none);if(n.options)for(var o=0,a=n.options;o<a.length;o++){a[o].checked=!1}}this._updateSectionInfos(t.sectionInfos);$=t.sectionInfos}else{var s=this._pendingGetSectionsPromises[Z];if(s)return s;this._itemsStore.invalidateItemSet(this._itemProvider.getItemSetKey(this._getItemContext))}if($&&!e)return ee.default.wrap($);e&&this._smartFiltersStore.invalidateAll();var X=new u.Qos({name:"SmartFiltersProvider.getSections"}),l=this.getMetadataNavigationSettings(),c=this._itemProvider.getItem(this._getItemContext),d=ee.default.all([l,c]).then(function(e){var t=e[0],i=e[1],r=i.schema.peek();Q._viewParams.peek().needsAttentionView&&(r=Q._getUpdatedNeedsAttentionSchema(r));for(var n=[],o={},a=0,s=r;a<s.length;a++){o[s[a].internalName]=!0}if(t)for(var l=0,c=t;l<c.length;l++){var d=c[l];d.isContentTypeField?o[F]||n.push(F):d.isFolderHierarchy||o[d.fieldTitle]||n.push(d.fieldTitle)}if(0===n.length)return{metadataNavigationSettings:t,itemSet:i};Q._updateGetItemContext(n);return Q._itemProvider.getItem(Q._getItemContext).then(function(e){return{metadataNavigationSettings:t,itemSet:e}})}).then(function(e){var t,i=e.metadataNavigationSettings,r=e.itemSet,n=r.content.peek().items,o=r.schema.peek();Q._viewParams.peek().needsAttentionView&&(o=Q._getUpdatedNeedsAttentionSchema(o));Q._fieldOptionsHash={};Q._columnInfoHash={};for(var a=0,s=o;a<s.length;a++){var l=s[a];Q._columnInfoHash[l.internalName]=Q._getColumnInfo(l);l.filterable&&(Q._fieldOptionsHash[l.internalName]={})}n&&0<n.length&&!n[n.length-1]&&(t=r.isTokenBasedApi);if(t){var c=Q._currentItemSet.peek().content.peek().items;if(c){for(var d={},u=0,p=n;u<p.length;u++){if(v=p[u]){d[v.peek().key]=!0}}for(var m=[],h=0,f=c;h<f.length;h++){var g=f[h];if(g){d[g.peek().key]||m.push(g)}}m.length&&(n=m.concat(n))}}for(var b=0,_=n;b<_.length;b++){var v;if(v=_[b])for(var y=0,S=o;y<S.length;y++){if((l=S[y]).filterable){(K=ne.getFilterOptionsFromItem(l.fieldType,l.internalName,v.peek()&&v.peek().properties,re.strings,function(e,t,i,r){return ne.getFilterOption(Q.resources,e,t,i,r)}))&&0<K.length&&!Q._isEmptyFilterOption(K[0])&&Q._columnInfoHash[l.internalName].totalCount++;for(var x=0,k=K;x<k.length;x++){var C=k[x],P=Q._fieldOptionsHash[l.internalName][C.key];if(P)P.count++;else{Q._fieldOptionsHash[l.internalName][C.key]={count:1,option:C};Q._isEmptyFilterOption(C)||Q._columnInfoHash[l.internalName].uniqueValueCount++}}}}}var I=[];if(n&&0<n.length){var w=Q._getSmartFilterNames(i),T={key:Q._pageContext.userDisplayName,values:[Q._pageContext.userDisplayName],iconUrl:"/_layouts/15/userphoto.aspx?size=S&accountname="+Q._pageContext.userLoginName,label:Q._pageContext.userDisplayName,shouldAlwaysRender:!0},L={};if($)for(var F=0,E=$;F<E.length;F++){var D=E[F];0<=w.indexOf(D.fieldName)&&(L[D.fieldName]=D)}for(var M=[],N={},O=0,A=w;O<A.length;O++){var B=A[O],H=(W=Q._columnInfoHash[B]).fieldType;if(!L[B]&&H===ie.ColumnFieldType.Taxonomy&&4===ne.getSectionType(H,B)){var U=W.columnDefinition;M.push(Q.getTaxonomyFilterSectionInfo(U));var R={fieldName:B,fieldId:U.id,fieldType:H,type:ne.getSectionType(H,B),serverFieldType:U.serverFieldType,title:ne.getSectionTitle(H,W.displayName),isLoading:!0};N[B]=R;L[B]=R}}ee.default.all(M).then(function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];N[r.fieldName]=r}var n=Q._smartFiltersStore.updateFilterSectionInfos(Q._getItemContext.parentKey,Q._currentView.peek().id,Q._viewParams.peek(),N);Q._eventScope&&n&&oe.default.raise(Q._eventScope,te.FiltersPaneEvents.sectionInfosChanged)});for(var G=0,V=w;G<V.length;G++){var q=L[B=V[G]];if(q)I.push(q);else{H=(W=Q._columnInfoHash[B]).fieldType;var W,z=Q._fieldOptionsHash[B];if(H===ie.ColumnFieldType.DateTime){var j=ne.getNewDateTimeFilterSectionInfo(B,W.columnDefinition.id,H,W.displayName,Q._fieldOptionsHash[B]);I.push(j)}else{var K=void 0;K=H===ie.ColumnFieldType.User&&z[T.key]?Q._getTopOptions(z,J,T,function(e,t){return e.key===t.key}):Q._getTopOptions(z,J);j={fieldName:B,fieldId:W.columnDefinition.id,fieldType:H,type:ne.getSectionType(H,B),serverFieldType:W.columnDefinition.serverFieldType,title:ne.getSectionTitle(H,W.displayName),options:K,showSeeAllLink:t};I.push(j)}}}}Q._updateSectionInfos(I);Q._smartFiltersStore.setFilterSectionInfos({parentKey:Q._currentItem.peek().key,viewId:Q._currentView.peek().id,sectionInfos:I,viewParams:Q._viewParams.peek()});Q._pendingGetSectionsPromises[Z]=void 0;X.end({resultType:Y.ResultTypeEnum.Success});return I},function(e){Q._pendingGetSectionsPromises[Z]=void 0;X.end({resultType:Y.ResultTypeEnum.Failure,error:e});throw e});return this._pendingGetSectionsPromises[Z]=d};e.prototype.filterBySectionOptions=function(e){if(e&&e.options&&!(e.options.length<=0)){var t=[];if(4===e.type)t=e.checkedValues||t;else for(var i=0;i<e.options.length;i++){var r=e.options[i];r.checked&&t.push.apply(t,r.values)}this.filter(e.fieldName,e.fieldType,e.serverFieldType,t)}};e.prototype.updateMultipleFilters=function(e){this._engagement.logData({name:"SmartFiltersProvider.UpdateFilter"});var t=this._convertToFilters(e);if(t){var i=this._currentView.peek(),r=this._viewParams.peek(),n=r.useFiltersInViewXml;P.isFeatureEnabled(P.SPListNextColumnHeaderFilter)&&!n&&(n=r.useFiltersInViewXml="1");var o=y.serializeQuery(r),a=this._getFilterListFromQueryString();if(n){var s=!1;if(i&&!i.isDirty())for(var l=0,c=a;l<c.length;l++){var d=c[l];if(d.values&&0<d.values.length){d.id=d.fieldName;s=this._isGroupedByField(d.fieldName);d.type||this._engagement.logData({name:"SmartFiltersProvider.UpdateMultipleFilters.MissingFilterType",extraData:{fieldName:d.fieldName,filterOperator:d.operator,queryString:o}});S.updateFilter(i,d)}}for(var u=0,p=t;u<p.length;u++){var m=p[u];o=x.default.updateFilterInfo(o,m.fieldName,m.values,m.type,m.lookupId);if(0<m.values.length){s=this._isGroupedByField(m.fieldName);m.type||this._engagement.logData({name:"SmartFiltersProvider.UpdateMultipleFilters.MissingFilterType",extraData:{fieldName:m.fieldName,filterOperator:m.operator}});S.updateFilter(i,m)}else S.removeFilter(i,m.id)}s&&i.updateGroupByCollapseAttribute(!1);this._navigation.updateViewParams(o,{clearOtherParams:!0,ignoreHistory:!0})}}};e.prototype.filter=function(e,t,i,r){var n=ne.getSectionType(t,e),o=4===n,a={fieldName:e,values:r,type:i,operator:"multichoice"===i.toLowerCase()?"Eq":"In",id:e};t===ie.ColumnFieldType.Taxonomy&&4===n&&(a.type="Counter");o&&(a.lookupId=!0);this._updateFilter(a)};e.prototype.filterByDateTimeSliderValue=function(e,t){var i;switch(t){case te.DateTimeSliderValue.last3Months:i=-92;break;case te.DateTimeSliderValue.last30Days:i=-30;break;case te.DateTimeSliderValue.last7Days:i=-7;break;case te.DateTimeSliderValue.yesterday:i=-1;break;case te.DateTimeSliderValue.today:i=0;break;case te.DateTimeSliderValue.tomorrow:i=1;break;case te.DateTimeSliderValue.next7Days:i=7;break;case te.DateTimeSliderValue.next30Days:i=30;break;case te.DateTimeSliderValue.next3Months:i=92;break;case te.DateTimeSliderValue.nextYear:i=365}this._updateFilter({fieldName:e,values:t===te.DateTimeSliderValue.none?[]:[g.getTodayString(i)],type:"DateTime",operator:"Geq",id:e})};e.prototype.clearFilters=function(e,t){for(var i=this._currentView.peek(),r=0,n=e;r<n.length;r++){var o=n[r];S.removeFilter(i,o)}this._currentView.valueHasMutated();this._clearAllFiltersFromQueryString();if(t){var a=this._smartFiltersStore.getFilterSectionInfos(this._getItemContext.parentKey,this._currentView.peek().id,this._viewParams.peek());if(a){a.sectionInfos=t;this._smartFiltersStore.setFilterSectionInfos(a)}}};e.prototype.updateShowInFiltersPaneProperty=function(e,t,i){for(var r=0,n=this._itemsStore.getAllItemSetKeys();r<n.length;r++){var o=n[r],a=this._itemsStore.getItemSet(o);if(0===a.item.peek().id.indexOf(this._pageContext.listUrl))for(var s=a.schema.peek(),l=0;l<s.length;l++){var c=s[l];if(c.internalName===e){a.schema(s.slice(0,l).concat([d.__assign({},c,{showInFiltersPane:t})],s.slice(l+1)));break}}}i&&this.getSections(void 0,!0)};e.prototype.getMetadataNavigationSettings=function(){var i=this;if(this._viewParams.peek().needsAttentionView)return ee.default.wrap([]);var r=this._itemUrlHelper.getItemUrlParts(this._currentItem.peek().key),e=this._smartFiltersStore.getMetadataNavigationSettings(r.fullListUrl);if(e)return ee.default.wrap(e);var n=new u.Qos({name:"SmartFiltersProvider.getMetadataNavigationSettings"}),t=this._apiUrlHelper.build();t=t.methodWithAliases("SP.MetadataNavigation.MetadataNavigationSettings.GetConfiguredSettings",{DecodedUrl:r.serverRelativeItemUrl});return this._dataRequestor.getData({url:t.toString(),method:"POST",qosName:"GetMetadataNavigationConfiguredSettings",noRedirect:!0}).then(function(e){var t=i._processMetadataNavigationSettingsResponse(e);i._smartFiltersStore.setMetadataNavigationSettings(r.fullListUrl,t);n.end({resultType:Y.ResultTypeEnum.Success});return t},function(e){n.end({resultType:Y.ResultTypeEnum.Failure,error:e});return[]})};e.prototype.getFilterSuggestions=function(i,r,e){var n=this;this._updateGetItemContext();var t=ne.getViewXmlWithBeginWithFilter(this._getItemContext.viewXml,i,r,e);return this._itemProvider.getItem({parentKey:this._currentItemKey(),viewXml:t}).then(function(e){var t=e.content.peek().items.map(function(e){return e.peek()});return ne.getFilterOptionsFromItems(r,i,t,re.strings,function(e,t,i,r){return ne.getFilterOption(n.resources,e,t,i,r)})})};e.prototype.getCommandItems=function(e){var t=this._columnInfoHash[e].columnDefinition,i=[];if(t&&t.filterable&&void 0!==t.showInFiltersPane){var r=new(this.child(this._actionMap.ModifyShowInFiltersPaneAction))({column:t,showInFiltersPane:p.ShowInFiltersPaneStatus.Pinned}),n=new(this.child(this._actionMap.ModifyShowInFiltersPaneAction))({column:t,showInFiltersPane:p.ShowInFiltersPaneStatus.Auto}),o=new(this.child(this._actionMap.ModifyShowInFiltersPaneAction))({column:t,showInFiltersPane:p.ShowInFiltersPaneStatus.Removed}),a=[];t.showInFiltersPane===p.ShowInFiltersPaneStatus.Pinned?a.push({name:re.strings.unpinFromFiltersPaneCommandText,ariaLabel:re.strings.unpinFromFiltersPaneCommandAriaLabel,key:"UnPinInMenu",onClick:function(e,t){n.execute(e)}}):a.push({name:re.strings.pinToFiltersPaneCommandText,ariaLabel:re.strings.pinToFiltersPaneCommandAriaLabel,key:"PinInMenu",onClick:function(e,t){r.execute(e)}});t.showInFiltersPane!==p.ShowInFiltersPaneStatus.Removed&&a.push({name:re.strings.removeFromFiltersPaneCommandText,ariaLabel:re.strings.removeFromFiltersPaneCommandAriaLabel,key:"RemoveInMenu",onClick:function(e,t){o.execute(e)}});t.showInFiltersPane===p.ShowInFiltersPaneStatus.Pinned&&i.push({name:re.strings.unpinFromFiltersPaneCommandText,ariaLabel:re.strings.unpinFromFiltersPaneCommandAriaLabel,iconProps:{iconName:"Pinned"},key:"UnPin",onClick:function(e,t){n.execute(e)}});i.push({name:re.strings.moreCommandAriaLabel,ariaLabel:re.strings.moreCommandAriaLabel,iconProps:{iconName:"More"},key:"More",subMenuProps:{items:a}})}return i};e.prototype.getTaxonomyFieldNextFilteringHierachy=function(e,t,i){return this._getTaxonomyFieldNextFilteringHierachyWithPaging(e,t,!1,0,[])};e.prototype.getTaxonomyFilterSectionInfo=function(t){return this._getTaxonomyFieldNextFilteringHierachyWithPaging(t.id,t.anchorId,!1,0,[]).then(function(e){return{fieldName:t.internalName,fieldId:t.id,fieldType:t.fieldType,type:ne.getSectionType(t.fieldType,t.internalName),serverFieldType:t.serverFieldType,title:ne.getSectionTitle(t.fieldType,t.name),options:e,checkedKeys:[],expandedKeys:[],checkedValues:[],showSeeAllLink:!1}})};e.prototype.shouldShowEditButton=function(){var e=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._currentItem.peek(),"list"));return!!(e&&e.list&&e.list.permissions&&e.list.permissions.manageLists)};e.prototype._getAutoSelectedFilterNames=function(){var e=[],t=[];for(var i in this._columnInfoHash){var r=this._columnInfoHash[i];r&&r.showInFiltersPane!==p.ShowInFiltersPaneStatus.Removed&&1<r.uniqueValueCount&&e.push(i)}e.sort(this._sortFieldName.bind(this));this._listContext.isDocLib&&0<=e.indexOf(T)&&t.push(T);for(var n=0,o=e;n<o.length;n++){i=o[n];if(this._columnInfoHash[i].fieldType===ie.ColumnFieldType.User){t.push(i);break}}this._listContext.isDocLib&&0<=e.indexOf(L)&&t.push(L);for(var a=Math.min(e.length,4),s=0,l=e;s<l.length;s++){i=l[s];if(t.indexOf(i)<0){t.push(i);if(t.length>=a)break}}return t};e.prototype._getSmartFilterNames=function(e){for(var t=this._getAutoSelectedFilterNames(),i=[],r=0,n=Object.keys(this._columnInfoHash);r<n.length;r++){var o=n[r];if(!(c=this._columnInfoHash[o]).isSelected&&this._isPinnedToFilterspane(c)){i.push(o);c.isSelected=!0}}if(e)for(var a=0,s=e;a<s.length;a++){var l=s[a],c=(o=l.isContentTypeField?F:l.fieldTitle,this._columnInfoHash[o]);if(!l.isFolderHierarchy&&c&&!c.isSelected&&c.showInFiltersPane!==p.ShowInFiltersPaneStatus.Removed){i.push(o);c.isSelected=!0;c.isConfiguredMetadataNavSetting=!0}}for(var d=0,u=t;d<u.length;d++){o=u[d];if(!(c=this._columnInfoHash[o]).isSelected){i.push(o);c.isSelected=!0}}return i};e.prototype._updateGetItemContext=function(e){var t=this._currentView.peek(),i=new h.default(t.getEffectiveViewXml());i.updateGroupBy(null);var r,n=this._viewParams.peek();for(var o in n)if(0===o.indexOf("Filter")){r||(r={});r[o]=n[o]}if(this._listContext.isDocLib||e){var a=i.getEffectiveFieldNames(),s=a.length,l=[];e&&e.length&&(l=l.concat(e));this._listContext.isDocLib&&(l=l.concat(E));for(var c=0,d=l;c<d.length;c++){var u=d[c];if(-1===a.indexOf(u)){i.updateField(u,s);s++}}}if(t&&t.isDirty()||n.useFiltersInViewXml&&r)try{S.removeSmartFilters(i)}catch(e){0}var p=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._currentItem.peek(),"list")),m="Modified";p&&p.list&&5e3<=p.list.itemCount&&(m="ID");i.updateSort({fieldName:m,isAscending:!1},{overwriteAll:!0});i.updateRowLimit({rowLimit:300,isPerPage:!0});this._getItemContext={parentKey:this._currentItemKey(),viewXml:i.getEffectiveViewXml(),needSchema:!0}};e.prototype._getFilterListFromQueryString=function(){var e=y.serializeQuery(this._viewParams.peek()),t=this._listContext&&this._listContext.rawListSchema?this._listContext.rawListSchema.Field:null;return m.default.getFilterList(e,t,!0)};e.prototype._updateFilter=function(e){this._engagement.logData({name:"SmartFiltersProvider.UpdateFilter"});var t=this._currentView.peek(),i=this._viewParams.peek(),r=i.useFiltersInViewXml;P.isFeatureEnabled(P.SPListNextColumnHeaderFilter)&&!r&&(r=i.useFiltersInViewXml="1");for(var n,o=y.serializeQuery(i),a=this._getFilterListFromQueryString(),s=0,l=a;s<l.length;s++){var c=l[s];if(c.fieldName===e.fieldName){n=c.values;break}}if(r){if(t&&!t.isDirty())for(var d=0,u=a;d<u.length;d++){var p=u[d];if(p.values&&0<p.values.length){p.id=p.fieldName;p.type||this._engagement.logData({name:"SmartFiltersProvider.UpdateFilter.MissingFilterType",extraData:{fieldName:p.fieldName,filterOperator:p.operator,queryString:o}});S.updateFilter(t,p)}}o=x.default.updateFilterInfo(o,e.fieldName,e.values,e.type,e.lookupId);if(0<e.values.length){e.type||this._engagement.logData({name:"SmartFiltersProvider.UpdateFilter.MissingFilterType",extraData:{fieldName:e.fieldName,filterOperator:e.operator}});S.updateFilter(t,e)}else S.removeFilter(t,e.id);this._navigation.updateViewParams(o,{clearOtherParams:!0,ignoreHistory:!0})}else{var m=!0;if(0<e.values.length&&n){for(var h=!0,f=0,g=e.values;f<g.length;f++){var b=g[f];if(-1===n.indexOf(b)){h=!1;break}}h&&(m=!1)}if(0<e.values.length){if(m){e.type||this._engagement.logData({name:"SmartFiltersProvider.MoveAllFiltersToView.MissingFilterType",extraData:{fieldName:e.fieldName,filterOperator:e.operator}});S.updateFilter(t,e)}}else S.removeFilter(t,e.id);this._currentView.valueHasMutated();if(n){for(var _=0,v=n;_<v.length;_++){b=v[_];(m||-1===e.values.indexOf(b))&&(o=x.default.addFilterInfo(o,e.fieldName,b))}this._navigation.updateViewParams(o,{clearOtherParams:!0,ignoreHistory:!0})}}};e.prototype._computeCurrentItemKey=function(){var e=this._viewParams(),t=this._urlDataSource.getCurrentItemKey(e),i=this._urlDataSource.getKeyParams(t);return this._urlDataSource.getKey(i)};e.prototype._getPriority=function(e){return e.fieldType===ie.ColumnFieldType.Choice?e.isRequired?6:3:e.fieldType===ie.ColumnFieldType.DateTime?e.isRequired?5:2:e.fieldType===ie.ColumnFieldType.Number?e.isRequired?4:1:0};e.prototype._sortFieldName=function(e,t){var i=this._columnInfoHash[e],r=this._columnInfoHash[t];return i&&r?i.priority===r.priority?i.fieldType===ie.ColumnFieldType.Choice?r.uniqueValueCount-i.uniqueValueCount:i.isRequired?0:r.totalCount-i.totalCount:r.priority-i.priority:0};e.prototype._getTopOptions=function(i,e,t,r){var n=Object.keys(i).sort(function(e,t){return i[e].count>i[t].count?-1:1}),o=[];t&&o.push(t);for(var a=0;a<Math.min(e,n.length)&&!(o.length>=e);a++){var s=n[a],l=i[s].option;r&&t&&r(l,t)||o.push(l)}return o};e.prototype._clearAllFiltersFromQueryString=function(){var e=this._getFilterListFromQueryString();if(e){for(var t=y.serializeQuery(this._viewParams.peek()),i=0,r=e;i<r.length;i++){var n=r[i];t=x.default.addFilterInfo(t,n.fieldName,"",!0)}this._navigation.updateViewParams(t,{clearOtherParams:!0,ignoreHistory:!0})}};e.prototype._updateSectionInfosFromQueryString=function(e){var t=this._getFilterListFromQueryString();void 0===this._columnInfoHash&&(this._columnInfoHash={});var i=this._currentItemSet.peek().schema.peek();this._viewParams.peek().needsAttentionView&&(i=this._getUpdatedNeedsAttentionSchema(i));for(var r=0,n=i;r<n.length;r++){var o=n[r];this._columnInfoHash[o.internalName]||(this._columnInfoHash[o.internalName]=this._getColumnInfo(o))}ne.updateSectionInfos(this.resources,e,t,this._columnInfoHash,this._fieldOptionsHash);if(this._viewParams.peek().useFiltersInViewXml){var a={};if(t)for(var s=0,l=t;s<l.length;s++){var c=l[s];a[c.fieldName]=c}e.map(function(e){if(4===e.type&&!a[e.fieldName]){e.checkedKeys=[];e.checkedValues=[]}return e})}};e.prototype._updateSectionInfosFromViewXml=function(e){var t=this._currentView.peek();if(t)try{var i=S.getAllSmartFilters(t);i&&ne.updateSectionInfos(this.resources,e,i,this._columnInfoHash,this._fieldOptionsHash)}catch(e){0}};e.prototype._updateSectionInfos=function(e){this._updateSectionInfosFromQueryString(e);this._updateSectionInfosFromViewXml(e);if(e){for(var t={},i=e.length-1;4<=i;i--){var r=e[i];if(!(this._columnInfoHash&&this._columnInfoHash[r.fieldName]&&this._columnInfoHash[r.fieldName].isSelected))if(1===r.type)r.options||r.value!==te.DateTimeSliderValue.none||(t[r.fieldName]=!0);else{for(var n=!0,o=0,a=r.options;o<a.length;o++){if(a[o].checked){n=!1;break}}n&&(t[r.fieldName]=!0)}}if(0<Object.keys(t).length){for(var s=[],l=0,c=e;l<c.length;l++){t[(r=c[l]).fieldName]||s.push(r)}e.splice(0,e.length);e.push.apply(e,s)}var d=this.shouldShowEditButton();e.map(function(e){return e.showEditButton=d})}};e.prototype._getColumnInfo=function(e){var t;e&&(t={columnDefinition:e,fieldType:e.fieldType,uniqueValueCount:0,totalCount:0,displayName:e.name,isRequired:e.isRequired,priority:this._getPriority(e),showInFiltersPane:e.showInFiltersPane});return t};e.prototype._isPinnedToFilterspane=function(e){return e.showInFiltersPane===p.ShowInFiltersPaneStatus.Pinned};e.prototype._isEmptyFilterOption=function(e){return!(!e||e.label!==re.strings.EmptyFilterOptionLabel)};e.prototype._processMetadataNavigationSettingsResponse=function(e){var t=[];if(e&&e.d&&e.d.GetConfiguredSettings&&e.d.GetConfiguredSettings.Items)for(var i=0,r=e.d.GetConfiguredSettings.Items.results;i<r.length;i++){var n=r[i],o={fieldDisplayName:n.FieldDisplayName,fieldTitle:n.FieldTitle,fieldTypeAsString:n.FieldTypeAsString,isContentTypeField:n.IsContentTypeField,isFolderHierarchy:n.IsFolderHierarchy,isHierarchy:n.IsHierarchy,isMultiValueLookup:n.IsMultiValueLookup,isTaxonomyField:n.IsTaxonomyField};t.push(o)}return t};e.prototype._processFilteringHierachyResponse=function(e,t,i){var r,n,o=[];try{var a=g.xmlToDom(i.d),s=a.getElementsByTagName("ul")[0],l=s.getAttribute("paging");r=l&&"true"===l.toLowerCase();n=s.getAttribute("lastTermId");for(var c=a.getElementsByTagName("li"),d=0;d<c.length/5;d++){var u=c[5*d].firstChild?c[5*d].firstChild.textContent:c[5*d].innerHTML,p=u?u.split(","):["0"],m=c[5*d+1].firstChild?c[5*d+1].firstChild.textContent:c[5*d+1].innerHTML,h=!!c[5*d+2].firstChild,f=c[5*d+4].firstChild?c[5*d+4].firstChild.textContent:c[5*d+4].innerHTML;o.push({key:f,values:p,label:m,hasChildren:h})}}catch(e){}return{fieldId:e,startTermId:t,paging:r,lastTermId:n,options:o}};e.prototype._getPendingPromiseKey=function(e,t){return e+t};e.prototype._convertToFilters=function(e){for(var t,i={},r=0,n=this._currentItemSet.peek().schema.peek();r<n.length;r++){var o=n[r];i[o.internalName]=o}for(var a=0,s=Object.keys(e);a<s.length;a++){var l=s[a],c={fieldName:l,values:e[l],type:i[l]&&i[l].serverFieldType,operator:"In",id:l};c.type||(c.type=this._getFieldTypeFromGroupSchema(l));t||(t=[]);t.push(c)}return t};e.prototype._getTaxonomyFieldNextFilteringHierachy=function(t,i,e){var r=this,n={fieldId:t,listId:this._pageContext.listId,termId:i,isIncludeDescendants:!0,currentFilteredId:w.default.Empty},o=this._pageContext.webAbsoluteUrl+"/_vti_bin/TaxonomyInternalService.json/"+(e?"GetRestOfFilteringHierarchy":"GetNextFilteringHierarchy");return this._dataRequestor.getData({url:o,method:"POST",qosName:"GetTaxonomyFieldNextFilteringHierachy",noRedirect:!0,additionalPostData:JSON.stringify(n)}).then(function(e){return r._processFilteringHierachyResponse(t,i,e)})};e.prototype._getTaxonomyFieldNextFilteringHierachyWithPaging=function(e,t,i,r,n){var o=this;return this._getTaxonomyFieldNextFilteringHierachy(e,t,i).then(function(e){return!e.paging||5<r?n.concat(e.options):o._getTaxonomyFieldNextFilteringHierachyWithPaging(e.fieldId,e.lastTermId,e.paging,++r,n.concat(e.options))})};e.prototype._getUpdatedNeedsAttentionSchema=function(e){return e.map(function(e){var t=-1!==D.indexOf(e.internalName);return e=d.__assign({},e,{filterable:t})})};e.prototype._getFieldTypeFromGroupSchema=function(e){var t;if(this._listContext.groupSchema){var i=this._listContext.groupSchema[e];t=i?i.Type:t}return t};e.prototype._isGroupedByField=function(e){return!(!this._listContext.groupSchema||!this._listContext.groupSchema[e])};return e}(i.default);t.default=M});define("adJ",["require","exports","ap","a3"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="metadatanavsettings=",o=function(t){i.__extends(e,t);function e(){var e=t.call(this,"SmartFiltersStore")||this;e._filterSectionInfoStoreKeys=[];return e}e.prototype.setFilterSectionInfos=function(e){var t=this._getStoreKey(e.parentKey,e.viewId,e.viewParams);-1===this._filterSectionInfoStoreKeys.indexOf(t)&&this._filterSectionInfoStoreKeys.push(t);this.setValue(t,e)};e.prototype.getFilterSectionInfos=function(e,t,i){return this.getValue(this._getStoreKey(e,t,i))};e.prototype.updateFilterSectionInfos=function(e,t,i,r){var n=!1,o=this._getStoreKey(e,t,i),a=this.getValue(o);if(a&&a.sectionInfos){for(var s=0;s<a.sectionInfos.length;s++){var l=r[a.sectionInfos[s].fieldName];if(l){a.sectionInfos[s]=l;n=!0}}this.setValue(o,a)}return n};e.prototype.setMetadataNavigationSettings=function(e,t){var i=n+e;this.setValue(i,t)};e.prototype.getMetadataNavigationSettings=function(e){var t=n+e;return this.getValue(t)};e.prototype.invalidate=function(e){for(var t=0,i=this._filterSectionInfoStoreKeys;t<i.length;t++){var r=i[t],n=this.getValue(r);n&&n.parentKey&&n.parentKey===e&&this.remove(r)}};e.prototype.invalidateAll=function(){for(var e=0,t=this._filterSectionInfoStoreKeys;e<t.length;e++){var i=t[e];this.remove(i)}};e.prototype._getStoreKey=function(e,t,i){return e+t};return e}(r.default);t.default=o});define("E7",["require","exports","ap","E4","E8","dn","E8"],function(e,t,i,o,a,s,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.getFilterOption=function(t,e,i,r,n){return a.getFilterOptionCore({getIconUrlFromExtension:function(e){return s.getIconUrlFromExtension(t,e,16)}},o.strings,e,i,r,n)};t.updateSectionInfos=function(t,e,i,r,n){return a.updateSectionInfosCore({getIconUrlFromExtension:function(e){return s.getIconUrlFromExtension(t,e,16)}},o.strings,e,i,r,n)};t.getSectionTitle=function(e,t){return a.getSectionTitleCore(o.strings,e,t)}});define("E8",["require","exports","bp","aL","Fb","aW","gP","dl","in","E9","hQ"],function(e,a,D,p,M,i,s,u,l,c,x){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={ODB:108},k="/_layouts/15/userphoto.aspx?size=S&accountname=";a.MODIFIED_FIELD_NAME="Modified";a.ENTERPRICE_KEYWORD_INTERNAL_NAME="TaxKeyword";function N(e,t,i,r,n,o){var a,s=r,l=[n];if(i===M.ColumnFieldType.FileIcon){var c=n,d=u.OfficeIconFileTypeMap[c];c&&"pdf"===c.toLowerCase()&&(d=void 0);if(d){l=u.OfficeAppToExtensionsMap[d];d=u.getOfficeAppFriendlyName(d)}s=d||c||t.OtherFileTypeOption;a=e.getIconUrlFromExtension(c)}else if(void 0===s){s=m(i,n);l=[h(i,n)]}return{key:s=s||t.EmptyFilterOptionLabel,checked:!!o,values:l,label:s,iconUrl:a}}a.getFilterOptionCore=N;function O(e,t){if(e===M.ColumnFieldType.Taxonomy&&i.default.isFeatureEnabled(r)&&t!==a.ENTERPRICE_KEYWORD_INTERNAL_NAME)return 4;switch(e){case M.ColumnFieldType.User:return 0;case M.ColumnFieldType.DateTime:return 1;case M.ColumnFieldType.FileIcon:return 2;default:return 3}}a.getSectionType=O;a.getSectionTitleCore=function(e,t,i){return t===M.ColumnFieldType.FileIcon?e.FileTypeFilterSectionTitle:i};a.updateSectionInfosCore=function(e,t,i,r,n,o){if(r&&!(r.length<1)&&i)for(var a=0,s=r;a<s.length;a++){for(var l=s[a],c=n[l.fieldName],d=void 0,u=0,p=i;u<p.length;u++){var m=p[u];if(m.fieldName===l.fieldName){d=m;break}}if(d){1===d.type?void 0!==(E=B(l))&&(d.value=E):4!==d.type||d.isLoading||(d.checkedValues=l.values);for(var h=0,f=l.values;h<f.length;h++){var g=f[h];if(4!==d.type||"0"!==g){var b=void 0;d.options||(d.options=[]);for(var _=0,v=d.options;_<v.length;_++){var y=v[_];if(H(y,g)){b=y;break}}if(b){b.checked=!0;if(4===d.type&&!d.isLoading){for(var S=d,x=0,k=b.values;x<k.length;x++){var C=k[x];if("0"!==C&&-1===l.values.indexOf(C)){b.checked=!1;break}}b.checked&&S.checkedKeys&&-1===S.checkedKeys.indexOf(b.key)&&S.checkedKeys.push(b.key)}}else{if(1===d.type&&D.isTodayString(g)||4===d.type)continue;var P=N(e,t,c.fieldType,void 0,g,!0);d.options.push(P)}}}}else{for(var I=[],w=void 0,T=0,L=l.values;T<L.length;T++){var F=L[T];P=N(e,t,c.fieldType,void 0,F,!0);I.push(P)}if(c.fieldType===M.ColumnFieldType.DateTime){w=A(l.fieldName,c.columnDefinition.id,c.fieldType,c.displayName,o[l.fieldName]);var E;void 0!==(E=B(l))&&(w.value=E);w.options=I}else w={fieldName:l.fieldName,fieldId:c.columnDefinition.id,fieldType:c.fieldType,type:O(c.fieldType,l.fieldName),serverFieldType:c.columnDefinition.serverFieldType,title:c.displayName,options:I,showSeeAllLink:!0};i.push(w)}}};function A(e,t,i,r,n){var o={fieldName:e,fieldId:t,fieldType:i,type:1,serverFieldType:"DateTime",title:r,value:s.DateTimeSliderValue.none,minValueLabel:function(e){var t;for(var i in e)try{var r=e[i].option&&e[i].option.values&&e[i].option.values[0];if(r&&4===r.indexOf("-")){var n=parseInt(r.substr(0,4),10);(!t||n<t)&&(t=n)}}catch(e){0}return t&&t.toString()}(n),maxValueLabel:(new Date).getFullYear()+1+"+",maxValue:s.DateTimeSliderValue.nextYear,showSeeAllLink:!0,options:[]};e===a.MODIFIED_FIELD_NAME&&(o.maxValue=s.DateTimeSliderValue.today);return o}a.getNewDateTimeFilterSectionInfo=A;function m(e,t){var i;if(e===M.ColumnFieldType.Number||e===M.ColumnFieldType.AverageRating){i=function(e,t){var i;if(!e)return e;try{var r=parseFloat(e);isNaN(r)||(i=void 0===t?r.toString():r.toFixed(t))}catch(e){0}return i}(t,e===M.ColumnFieldType.AverageRating?2:void 0)}else if(e===M.ColumnFieldType.DateTime){var r=t.split("-");if(r&&3===r.length&&4===r[0].length){var n=parseInt(r[0],10);i=parseInt(r[1],10)+"/"+parseInt(r[2],10)+"/"+n}}void 0===i&&(i=t);return i}a.normalizeFilterDisplayString=m;function h(e,t){e===M.ColumnFieldType.Currency&&(t=t.replace(/[^0-9\.]+/g,""));return t}a.normalizeFilterValue=h;a.addOrUpdateSectionInfo=function(e,t,i){for(var r,n,o=0;o<e.length;o++)if(e[o].fieldName===t.fieldName){r=o;break}if(4===t.type)n=p.deepCopy(t);else{var a=void 0,s={};if(t.options&&0<t.options.length){a=[];for(o=0;o<t.options.length;o++){var l=t.options[o];if(l.shouldAlwaysRender){a.splice(0,0,l);s[l.key]=l}else if(l.checked){a.push(l);s[l.key]=l}}if(a.length<i)for(var c=0,d=0<=r?e[r].options:t.options;c<d.length;c++){var u=d[c];if(!s[u.key]){u.checked=!1;a.push(u);s[u.key]=u;if(a.length>=i)break}}}(n=p.deepCopy(t)).options=a}0<=r?e[r]=n:e.push(n)};a.getViewXmlWithBeginWithFilter=function(e,t,i,r){var n,o=new l.default(e);switch(i){case M.ColumnFieldType.User:n="Lookup";break;case M.ColumnFieldType.FileIcon:n="Computed";break;case M.ColumnFieldType.Choice:n="Choice";break;case M.ColumnFieldType.DateTime:n="DateTime";break;default:n="Text"}var a={fieldName:t,values:[r],type:n,operator:"BeginsWith",id:t};c.updateFilter(o,a);return o.getEffectiveViewXml()};a.getFilterOptionsFromItems=function(e,t,i,r,n){for(var o={},a=0,s=i;a<s.length;a++){var l=s[a];if(l)for(var c=0,d=f(e,t,l.properties,r,n);c<d.length;c++){var u=d[c];o[u.key]||(o[u.key]=u)}}var p=[];for(var m in o)o.hasOwnProperty(m)&&p.push(o[m]);return p};function f(e,t,i,r,n){var o=i[t],a=[];if(e===M.ColumnFieldType.FileIcon)o=i.File_x0020_Type;else if(e===M.ColumnFieldType.Title)o=i.Title;else if(e===M.ColumnFieldType.WorkflowStatus&&o){var s=x.default.getWorkflowStatusFromRawHtml(o);if(s){var l=n(e,s.display,s.value);a.push(l);return a}}if(null!=o)if(e===M.ColumnFieldType.User)for(var c=0,d=o||[];c<d.length;c++){var u=d[c],p=k+u.email,m=u.title||r.EmptyFilterOptionLabel;a.push({key:m,values:[u.title],iconUrl:p,label:m})}else if(e===M.ColumnFieldType.Lookup&&Array.isArray(o))if(0<o.length)for(var h=0,f=o;h<f.length;h++){l=n(e,void 0,f[h].lookupValue);a.push(l)}else{l=n(e,void 0,"");a.push(l)}else if(e===M.ColumnFieldType.Boolean){l=n(e,o,i[t+".value"]);a.push(l)}else if(e===M.ColumnFieldType.Taxonomy&&o){o instanceof Array||(o=[o]);if(0<o.length)for(var g=0,b=o;g<b.length;g++){l=n(e,void 0,b[g].Label);a.push(l)}else{l=n(e,void 0,"");a.push(l)}}else if(e===M.ColumnFieldType.Currency||e===M.ColumnFieldType.Number||e===M.ColumnFieldType.DateTime){var _=t+".";l=void 0;l=void 0!==i[_]?n(e,o,i[_]):n(e,void 0,o);a.push(l)}else{var v=o instanceof Array?o:[o];if(0<v.length)for(var y=0,S=v;y<S.length;y++){l=n(e,void 0,S[y]);a.push(l)}}return a}a.getFilterOptionsFromItem=f;function B(e){var t,i=e.values&&0<e.values.length&&e.values[0],r=D.isTodayString(i)&&D.getTodayOffset(i);if(void 0!==r)t=g(r);else for(var n=0,o=e.values;n<o.length;n++){var a=d(o[n]);t=void 0===t?a:Math.min(t,a)}return t}function d(e){var t,i=s.DateTimeSliderValue.none;try{var r=e.split(/[^0-9]/),n=new Date(Number(r[0]),Number(r[1])-1,Number(r[2])),o=(t=new Date,new Date(t.getFullYear(),t.getMonth(),t.getDate()));i=g(Math.round((n.getTime()-o.getTime())/864e5))}catch(e){0}return i}function g(e){return 0===e?s.DateTimeSliderValue.today:-1===e?s.DateTimeSliderValue.yesterday:e<-1&&-7<=e?s.DateTimeSliderValue.last7Days:e<-7&&-30<=e?s.DateTimeSliderValue.last30Days:e<-30&&-92<=e?s.DateTimeSliderValue.last3Months:1<=e&&e<7?s.DateTimeSliderValue.tomorrow:7<=e&&e<30?s.DateTimeSliderValue.next7Days:30<=e&&e<92?s.DateTimeSliderValue.next30Days:92<=e&&e<365?s.DateTimeSliderValue.next3Months:365<=e?s.DateTimeSliderValue.nextYear:s.DateTimeSliderValue.none}function H(e,t){var i=!1;try{if(/^-?\d+(?:[.,]\d*?)?$/.test(t)){var r=parseFloat(t);if(!isNaN(r))for(var n=0,o=e.values;n<o.length;n++){var a=o[n];if(r===parseFloat(a)){i=!0;break}}}else i=0<=e.values.indexOf(t)}catch(e){0}return i}});define("Fb",["require","exports","ap","hT","hK","hR","hM","Fc"],function(e,t,i,r,n,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(o,t);i.__exportStar(a,t);i.__exportStar(s,t)});define("Fc",["require","exports","hT","hR","Fd","hM","ey"],function(e,t,l,r,c,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._listContext=e.listContext;this._pageContext=e.pageContext;this._itemStore=e.itemStore}e.prototype.processData=function(e,t){l.ListItemBuilderHelpers.updateListContext(t,this._listContext);l.ListItemBuilderHelpers.updateListContextGroupInfo(this._listContext);var i=t.ListSchema&&"TRUE"===t.ListSchema.Collapse,r=this._processSchema(t.ListSchema),n=t.ListContenTypes,o=t.ListData||t,a=c.ListItemBuilder.buildRootItem(e,t,this._listContext,this._itemStore),s=this._processItems(o,i,a);return{root:a,items:s.items,groups:s.groups,totalCount:s.totalCount,startIndex:this._getStartIndex(o),columns:r,contentTypes:n,nextRequestToken:this._getNextRequestToken(o),isAllGroupsCollapsed:i}};e.prototype._processSchema=function(e){if(e){var t={},i={hasFixedSchema:this._listContext.listTemplateType===o.default.mySiteDocumentLibrary};this._listContext.listSchema=r.SchemaBuilder.buildSchema(e,this._listContext,i,t);Object.keys(t).length&&(this._listContext.groupSchema=t)}return this._listContext.listSchema};e.prototype._processItems=function(e,t,i){var r;(r=t?n.GroupBuilder.buildCollapsedGroups(e.Row,this._listContext):c.ListItemBuilder.buildItems(e,this._listContext,this._pageContext,i,this._itemStore)).groups&&0<r.groups.length&&(this._listContext.lastGroup=r.groups[r.groups.length-1]);return{items:r.items?r.items:[],groups:r.groups,totalCount:r.totalCount}};e.prototype._getStartIndex=function(e){var t=0;this._listContext.group?t=this._listContext.group.startIndex:e.FirstRow&&(t=e.FirstRow-1);return t};e.prototype._getNextRequestToken=function(e){var t="";e.NextHref&&(t=(t=e.NextHref).replace("&View=00000000-0000-0000-0000-000000000000",""));return t};return e}();t.SPListItemProcessor=i});define("Fd",["require","exports","hT","hM","Fe","hs","aZ","ig","dq","dp","ds","br","hJ","eU","eU","ey"],function(e,t,h,f,F,g,b,_,v,E,y,D,M,N,O,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.buildItems=function(e,t,i,r,n){for(var o=[],a=[],s=e.Row,l=s.length,c=0;c<l;c++){var d=m(s[c],a,t,i);d.parent=r;d.parentKey=r.key;n&&n.setItem(d.key,d);o.push(d)}var u=0;if(0<a.length){var p=a[a.length-1];u=p.startIndex+p.count}else{a=void 0;u=0<l?e.LastRow:0}return{items:o,groups:a,totalCount:u}};e.buildRootItem=function(e,t,i,r){var n=function(e){var t=e;if(0===e.indexOf("id")){var i=D.deserializeQuery(e);t=i.id}return t}(e),o=M.buildItemKey(n,i.listUrl),a={key:o},s=t.ListTitle,l=t.AllowCreateFolder,c=t.EnableMinorVersions,d=t.verEnabled,u=t.AllowGridMode,p=t.DisableGridEditing,m=t.ListTemplateType,h=t.BasePermissions,f=void 0===h?{}:h,g=f.ManageLists,b=void 0===g?void 0:g,_=f.ManagePersonalViews,v=void 0===_?void 0:_,y=f.OpenItems,S=void 0===y?void 0:y,x=t.ListSchema,k=(void 0===x?{}:x).DefaultItemOpen,C=void 0===k?void 0:k,P=t.ExcludeFromOfflineClient,I=t.WebExcludeFromOfflineClient,w=t.ListData,T="string"==typeof C?"0"===C:void 0;if(r){var L=r.getItem(o);L&&(a=L)}a.type=E.default.Folder;a.isRootFolder=n===i.listUrl;N.default(a,{permissions:O.optional(w?F.fromHexString(w.FolderPermissions):void 0)});void 0===a.list&&(a.list={});N.default(a.list,{id:O.optional(t.listName),title:O.optional(s),allowGridMode:"boolean"==typeof u?u:O.backup(!0),allowCreateFolder:O.optional(l),disableGridEditing:"boolean"==typeof p?p:O.backup(!1),enableMinorVersions:O.optional(c),enableVersions:O.optional(d),templateType:O.optional("string"==typeof m?Number(m):void 0),isDocumentLibrary:O.optional("string"==typeof m?A.isDocumentLibrary(m):void 0),isPromotedLinks:O.optional("string"==typeof m?A.isPromotedLinksList(m):void 0),isModerated:O.optional(t.isModerated),newWOPIDocumentEnabled:O.optional(t.NewWOPIDocumentEnabled),newWOPIDocumentTypes:O.optional(t.NewWOPIDocumentTypes),permissions:{manageLists:O.optional(b),managePersonalViews:O.optional(v),openItems:O.optional(S)},openInClient:O.optional(T),excludeFromOfflineClient:O.optional("boolean"==typeof P||"boolean"==typeof I?P||I:void 0),contentTypesEnabled:O.optional(t.ContentTypesEnabled),metadataNavFeatureEnabled:O.optional(t.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:O.optional(t.canUserCreateMicrosoftForm),itemCount:O.optional(t.ListSchema&&t.ListSchema.ItemCount),rowLimit:O.optional(w&&w.RowLimit)});a.isRootFolder&&(a.name=a.displayName=s);r&&r.setItem(o,a);return a};function m(e,t,i,r){if(e){var n,o={key:M.buildItemKey((n=e).id||n.FileRef||n.ServerRelativeUrl,i.listUrl)};o.id=e.id||e.FileRef;o.itemId=e["name.FileSystemItemId"];var a=e.File_x0020_Type;o.extension=a?"."+a:void 0;o.policyTip=e._ip_UnifiedCompliancePolicyUIAction?Number(e._ip_UnifiedCompliancePolicyUIAction):0;o.type=function(e,t,i){var r=E.default.File,n=e.File_x0020_Type;if("1"===e.FSObjType){var o=e["File_x0020_Type.mapapp"],a=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];r=o&&"onenote"===o.substring(0,7)||a&&-1!==a.indexOf("onenote")?E.default.OneNote:E.default.Folder}else _.default.isShortcutEnabled()&&_.default.isShortcutFileType(n)?r=E.default.Shortcut:"pdf"===n?r=E.default.Media:(r=v.getItemTypeFromExtension(n))===E.default.Unknown&&A.isGenericList(i.listTemplateType)&&(r=E.default.File);".ai"!==t.extension&&".eps"!==t.extension&&".psd"!==t.extension||(r=E.default.Media);r===E.default.Folder?t.isDocSet="Sharepoint.DocumentSet"===e.ProgId:r===E.default.File&&i&&!i.isDocLib&&(t.listItem={});return r}(e,o,i);o.iconName=v.getIconNameFromItem(o);o.isRootFolder=e.isRootFolder;var s=h.ListItemBuilderHelpers.getItemName(e,o.type,i);s&&(o.displayName=o.name=s);o.dateModifiedValue=e.Modified;o.dateModified=e["Modified.FriendlyDisplay"]?g.getRelativeDateTimeStringForLists(e["Modified.FriendlyDisplay"]):String(e.Modified);o.permissions=e.PermMask?F.fromHexString(e.PermMask):void 0;o.isPlaceholder=!e.PermMask;o.hasMissingMetadata=function(e,t){var i=t.listSchema.filter(function(e){return e.isRequired&&Boolean(e.name)}),r=!1;if(i&&0<i.length)for(var n in i)if(n){var o=i[n];if(!e[o.internalName]){r=!0;break}}return r}(e,i);var l=e["serverurl.progid"];o.openUrl=l?l.substring(1):e.FileRef;-1!==o.openUrl.toLowerCase().indexOf("/wopiframe?")&&(o.openUrl=o.openUrl.replace(/\/_layouts\/WopiFrame.aspx\?/,"/_layouts/15/WopiFrame.aspx?"));o.previewIFrameUrl=e.ServerRedirectedEmbedUrl;o.appMap=e["File_x0020_Type.mapapp"]||e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];o.size=e.File_x0020_Size?Number(e.File_x0020_Size):void 0;o.totalSize=e.SMTotalSize?Number(e.SMTotalSize):void 0;r.blockDownloadsExperienceEnabled&&(o.type===E.default.Media||o.openUrl&&o.appMap)?o.itemStatus=4:r.blockDownloadsExperienceEnabled?o.itemStatus=3:r.viewOnlyExperienceEnabled&&(o.itemStatus=4);if(o.type===E.default.Folder){o.folder={};o.childCount=Number(e.ItemChildCount)+Number(e.FolderChildCount);var c=Number(e.SMTotalFileCount);o.folder.totalCount=0<c?c:o.childCount;o.folder.childCount=o.childCount}o.isDraggable=!0;o.isDropEnabled=o.type===E.default.Folder;o.properties={};for(var d in e)e.hasOwnProperty(d)&&(o.properties[d]=e[d]);var u=e.UniqueId&&b.default.normalizeLower(e.UniqueId);u&&(o.properties.uniqueId=u);var p=o.name;o.extension&&(p=o.name.substring(0,o.name.toLowerCase().lastIndexOf(o.extension.toLowerCase())));o.properties.FileName=p;0<Number(e.PrincipalCount)?o.sharingType=y.default.Shared:void 0===e.PrincipalCount?o.sharingType=y.default.Unknown:o.sharingType=y.default.Private;f.GroupBuilder.buildGroupFromItem(e,t,i);return o}}}(t.ListItemBuilder||(t.ListItemBuilder={}))});define("Fe",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fromHexString=function(e,t){var i=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},r=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(r){var n=void 0,o=void 0;if((e=(e=r[2]||"0").slice(-16)).length<=8){n=0;o=parseInt(e,16)}else{n=parseInt(e.slice(0,-8),16);o=parseInt(e.slice(-8),16)}if(!isNaN(n)&&!isNaN(o)){i.High=n;i.Low=o}}return i}});define("FK",["require","exports","ap","J8","J4","JW","JS","JG","Jv","Jq","IN","II","Iz","It","H6","HU","HN","HM","GZ","GT","GO","GH","GB","Gw","Gv","Cq","Gc","FU","wt","mo","o7","Dz","xA","wN","mb","FQ","jP","FL","o1","CC","BZ"],function(e,t,i,r,n,o,a,s,l,c,d,u,p,m,h,f,g,b,_,v,y,S,x,k,C,P,I,w,T,L,F,E,D,M,N,O,A,B,H,U,R){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.GridList=n.GridList;t.GroupMembershipPanel=o.GroupMembershipPanel;t.GroupMembershipPanelContainer=a.GroupMembershipPanelContainer;t.SitePermissionsPanel=s.SitePermissionsPanel;t.SitePermissionsPanelContainer=l.SitePermissionsPanelContainer;t.ListCreationPanel=c.ListCreationPanel;t.ColumnManagementPanel=d.ColumnManagementPanel;t.EditNavStateManager=u.EditNavStateManager;t.EditNav=p.EditNav;t.SiteSettingsPanel=m.SiteSettingsPanel;t.SiteSettingsPanelContainer=h.SiteSettingsPanelContainer;t.HubSettingsPanel=f.HubSettingsPanel;t.HubSettingsPanelStateManager=g.HubSettingsPanelStateManager;t.HubSettingsPanelContainer=b.HubSettingsPanelContainer;t.ChangeTheLookPanel=_.ChangeTheLookPanel;t.ChangeTheLookPanelContainer=_.ChangeTheLookPanelContainer;t.ChangeTheLookPanelStateManager=_.ChangeTheLookPanelStateManager;t.FlowPanelContainer=v.FlowPanelContainer;t.ListCreationPanelContainerStateManager=y.ListCreationPanelContainerStateManager;t.ColumnManagementPanelContainerStateManager=S.ColumnManagementPanelContainerStateManager;t.GroupCard=x.GroupCard;t.LivePersonaCardAdapter=k.LivePersonaCardAdapter;t.SpLivePersonaCard=C.SpLivePersonaCard;t.PeoplePicker=P.PeoplePicker;t.PeoplePickerType=P.PeoplePickerType;t.HubNav=I.HubNav;t.SiteUsageChart=w.default;t.ContextualMenu=T.ContextualMenu;t.Icon=L.Icon;t.FocusZone=F.FocusZone;t.FocusZoneDirection=F.FocusZoneDirection;t.Checkbox=E.Checkbox;t.Persona=D.Persona;t.PersonaSize=D.PersonaSize;t.IconButton=M.IconButton;t.PrimaryButton=M.PrimaryButton;t.DefaultButton=M.DefaultButton;t.Image=N.Image;t.Slider=O.Slider;t.autobind=A.autobind;t.BaseComponent=A.BaseComponent;t.getId=A.getId;t.getRTL=A.getRTL;t.TeachingBubble=B.TeachingBubble;t.Spinner=H.Spinner;t.SpinnerType=H.SpinnerType;t.BasePicker=U.BasePicker;t.BasePickerListBelow=U.BasePickerListBelow;t.Label=R.Label});define("J8",["require","exports","vX","jP"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CompositeHeader=i.CompositeHeader;t.FollowState=i.FollowState;t.css=r.css;t.EventGroup=r.EventGroup});define("J4",["require","exports","ap","J5","J5"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=n.GridList});define("J5",["require","exports","ap","J6"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("J6",["require","exports","ap","at","o7","oN","oR","px","pj","jP","ph","J7"],function(e,t,m,h,f,g,b,_,r,p,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){m.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._selection=e.selection||new _.Selection;t._selection.setItems(e.items,!1);t._dragDropHelper=e.dragDropEvents?new r.DragDropHelper({selection:t._selection}):null;t._cellProps=new Array(e.items.length);t._fixedPageWidth=0;t.state={isFocusedOnCell:!1};return t}e.prototype.componentWillUnmount=function(){this._dragDropHelper&&this._dragDropHelper.dispose()};e.prototype.componentWillReceiveProps=function(e){var t=this.props,i=t.items,r=t.selectionMode,n=!1;if(e.items!==i){this._cellProps=new Array(e.items.length);this._fixedPageWidth=0;this._selection.setItems(e.items,!0);n=!0}e.selectionMode!==r&&(n=!0);n&&this.forceUpdate()};e.prototype.render=function(){var i=this,e=this.props,t=e.dragDropEvents,r=e.eventsToRegister,n=e.groups,o=e.groupProps,a=e.items,s=e.onItemInvoked,l=e.selectionMode,c=e.viewport,d=this._selection,u=this._dragDropHelper,p={getItemCountForPage:this._getItemCountForPage,getPageHeight:this._getPageHeight};return h.createElement("div",{className:"ms-GridList","data-automationid":"GridList",role:"grid"},h.createElement(f.FocusZone,{ref:"focusZone",isInnerZoneKeystroke:this._isInnerZoneKeystroke,onActiveElementChanged:this._onActiveItemChanged},h.createElement(_.SelectionZone,{selection:d,selectionMode:l,onItemInvoked:s},n?h.createElement(g.GroupedList,{groups:n,groupProps:o,items:a,listProps:p,onRenderCell:this._onRenderCell,selection:d,selectionMode:l,dragDropEvents:t,dragDropHelper:u,eventsToRegister:r,viewport:c,ref:"groups"}):h.createElement(b.List,m.__assign({items:a,onRenderCell:function(e,t){return i._onRenderCell(0,e,t)}},p,{ref:"list"})))))};e.prototype.forceUpdate=function(){i.prototype.forceUpdate.call(this);this._forceUpdateLists()};e.prototype._forceUpdateLists=function(){this.refs.groups&&this.refs.groups.forceUpdate();this.refs.list&&this.refs.list.forceUpdate()};e.prototype._getItemAspectRatio=function(e,t){var i=this.props,r=i.defaultItemAspectRatio,n=i.getItemAspectRatio;return e&&n?n(e,t):r};e.prototype._onRenderCell=function(e,t,i){var r=this.props,n=r.dragDropEvents,o=r.onRenderCell,a=r.onRenderMissingItem;if(!t||!this._cellProps[i])return a?a(i):null;var s=this._cellProps[i],l=s.height,c=s.isLastRow,d=s.isRightCell,u={cellHeight:l,cellWidth:s.width,item:t,index:i,selection:this._selection,dragDropEvents:n,dragDropHelper:this._dragDropHelper};return h.createElement("div",{className:p.css("ms-GridList-cell",{"cell-right":d,"cell-last-row":c}),role:"gridcell"},o(u))};e.prototype._onActiveItemChanged=function(e,t){var i=this.props,r=i.items,n=i.onActiveItemChanged;if(e){if(-1<e.className.indexOf("ms-GroupHeader"))this.state.isFocusedOnCell&&this.setState({isFocusedOnCell:!1});else{this.state.isFocusedOnCell||this.setState({isFocusedOnCell:!0});if(n){var o=parseInt(e.getAttribute("data-item-index"),10);!isNaN(o)&&0<=o&&n(r[o],o,t)}}}};e.prototype._isInnerZoneKeystroke=function(e){return!this.state.isFocusedOnCell&&e.which===p.getRTLSafeKeyCode(39)};e.prototype._getItemCountForPage=function(e,t){var i=this.props,r=i.fixedCellRatio,n=i.minimumCellRatio,o=i.maximumHeight,a=i.minimumHeight,s=i.items,l=i.rowsPerPage;if(!s)return 10;var c=0,d=e,u=t.width/a;0===t.width&&(u=this._fixedPageWidth/a);for(var p=0;p<l;p++){if(d>=s.length)return c;if(r){if(this._fixedPageWidth!==t.width&&0<t.width){this._fixedPageCount=Math.max(Math.floor(u/r),1);this._fixedRatioScale=(t.width-8*(this._fixedPageCount-1))/a/(this._fixedPageCount*r);this._fixedCellHeight=Math.min(this._fixedRatioScale*a,o);this._fixedCellWidth=this._fixedCellHeight*r;this._fixedPageWidth=t.width}for(var m=d;m<d+this._fixedPageCount&&m<this._cellProps.length;){this._cellProps[m]={height:this._fixedCellHeight,width:this._fixedCellWidth,isRightCell:!1,isLastRow:d+this._fixedPageCount>=s.length,itemsInRow:this._fixedPageCount};m++}this._cellProps&&this._cellProps.length>=m-1&&this._cellProps[m-1]&&(this._cellProps[m-1].isRightCell=!0);c+=this._fixedPageCount;d+=this._fixedPageCount}else{0<t.width&&(this._fixedPageWidth=t.width);if(s[d]){var h=s[d];if(u<(b=this._getItemAspectRatio(h,d))){this._cellProps[d]={width:Math.max(this._fixedPageWidth,a*n),height:a,isRightCell:!1,isLastRow:!s[d+1],itemsInRow:1};c+=1;d+=1}else{for(var f=0,g=0;d+g<s.length;){h=s[d+g];var b=this._getItemAspectRatio(h,d),_=Math.max(b,n);this._cellProps[d+g]={ratio:_};if(!(_+f<u))break;f+=_;g++}g=Math.max(g,1);var v=a*((u=(this._fixedPageWidth-8*(g-1))/a)/f);for(m=d;m<d+g;m++){_=this._cellProps[m].ratio;this._cellProps[m]={width:v*Math.max(_,n),height:Math.max(Math.min(v,o),a),isRightCell:!1,isLastRow:d+g>=s.length,itemsInRow:g}}var y=d+g-1;this._cellProps&&this._cellProps.length>=y&&this._cellProps[y]&&(this._cellProps[y].isRightCell=!0);c+=g;d+=g}}else{c+=1;d+=1}}}return c};e.prototype._getPageHeight=function(e,t){if(e>=this._cellProps.length)return 0;var i=this.props,r=i.fixedCellRatio,n=i.minimumHeight,o=i.rowsPerPage,a=0,s=e;if(r&&0<this._fixedCellHeight){for(var l=0;l<o;l++){a+=this._fixedCellHeight;this._cellProps[s]&&(this._cellProps[s].isLastRow||(a+=8));s+=this._fixedPageCount;s=Math.min(s,this._cellProps.length-1)}return a}for(l=0;l<o;l++)if(this._cellProps[s]){a+=this._cellProps[s].height;this._cellProps[s].isLastRow||(a+=8);s+=this._cellProps[s].itemsInRow}else{a+=n+8;s+=1}return a};e.defaultProps={defaultItemAspectRatio:1,minimumCellRatio:0,maximumHeight:1/0,minimumHeight:192,rowsPerPage:1,selectionMode:_.SelectionMode.none};m.__decorate([p.autobind],e.prototype,"_forceUpdateLists",null);m.__decorate([p.autobind],e.prototype,"_onRenderCell",null);m.__decorate([p.autobind],e.prototype,"_onActiveItemChanged",null);m.__decorate([p.autobind],e.prototype,"_isInnerZoneKeystroke",null);m.__decorate([p.autobind],e.prototype,"_getItemCountForPage",null);m.__decorate([p.autobind],e.prototype,"_getPageHeight",null);return e=m.__decorate([n.withViewport],e)}(h.Component);t.GridList=i});define("J7",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-GridList{font-size:0}.ms-GridList .ms-List-cell,.ms-GridList .ms-List-page{display:inline-block;overflow:hidden}.ms-GridList .ms-GroupedList{font-size:0}.ms-GridList-cell{margin-bottom:8px}[dir=ltr] .ms-GridList-cell{margin-right:8px}[dir=rtl] .ms-GridList-cell{margin-left:8px}[dir=ltr] .ms-GridList-cell.cell-right{margin-right:0}[dir=rtl] .ms-GridList-cell.cell-right{margin-left:0}.ms-GridList-cell.cell-last-row{margin-bottom:0}"}])});define("JW",["require","exports","ap","JX","JX"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=n.GroupMembershipPanel});define("JX",["require","exports","ap","JY"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("JY",["require","exports","ap","at","Du","xA","jP","J2","J0","wN","Cv","Cu","o1","mh","a0","xH","x6","JZ"],function(e,t,r,a,n,o,s,l,c,d,u,p,m,h,f,g,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={showPanel:!0,isAddingMembers:!1,isAddingGuest:!1,selectedMembers:[],showSavingSpinner:!1,saveButtonDisabled:!0};f.Engagement.logData({name:"GroupMembershipPanel.Opened.Click"});return t}e.prototype.render=function(){var e=a.createElement(m.Spinner,{className:"ms-groupMemberList-spinner"}),t=void 0;this.props.largeGroupMessage&&(t=this._getMessageWithLink(this.props.largeGroupMessage,this.props.outlookLinkText,"ms-groupMember-largeGroupMessage",this._logLargeGroupOutlookClick));var i=this.props?this.props.personas:void 0;i&&0<i.length&&(e=a.createElement(c.GroupMembershipList,{members:i,totalNumberOfMembers:this.props.totalNumberOfMembers,onRenderPersona:this._onRenderPersona,onLoadMoreMembers:this.props.onLoadMoreMembers}));return a.createElement(n.Panel,{className:"ms-groupMemberPanel",isOpen:this.state.showPanel,type:n.PanelType.smallFixedFar,onDismiss:this._closePanel,isLightDismiss:!0,closeButtonAriaLabel:this.props.closeButtonAriaLabel,headerText:this.state.isAddingMembers?this.props.addMembersText:this.props.title},a.createElement("div",{"data-automationid":"GroupMembershipPanelContents"},a.createElement(g.Dialog,{isOpen:this.props.showConfirmationDialog,type:g.DialogType.close,onDismiss:this._closeDialog,subText:this.props.confirmationText,isBlocking:!1,closeButtonAriaLabel:this.props.closeButtonAriaLabel},a.createElement(g.DialogFooter,null,a.createElement(d.PrimaryButton,{onClick:this._approveDialog},this.props.okButtonText),a.createElement(d.DefaultButton,{onClick:this._closeDialog},this.props.cancelButtonText))),this.props.errorMessageText&&a.createElement("div",{className:"ms-groupMember-errorMessage"},a.createElement(b.MessageBar,{messageBarType:b.MessageBarType.error,isMultiline:!0,onDismiss:this._dismissErrorMessage,dismissButtonAriaLabel:this.props.dismissErrorMessageAriaLabel},this.props.errorMessageText)),!this.state.isAddingMembers&&a.createElement("div",{"data-automationid":"GroupMembersList"},t,this.props.numberOfMembersText&&a.createElement("div",{"aria-live":"assertive",className:"ms-groupMember-membersCount","data-automationid":"PanelNumberOfMembersText"},this.props.numberOfMembersText),this.props.canAddMembers&&a.createElement(d.PrimaryButton,{onClick:this._onClick,iconProps:{iconName:"PeopleAdd"},"data-automationid":"AddMembersButton"},this.props.addMembersText),e),this.state.isAddingMembers&&a.createElement("div",{"data-automationid":"AddMembersView"},this.state.isAddingGuest&&a.createElement("div",{className:"ms-groupMember-addingGuest"},a.createElement(b.MessageBar,{messageBarType:b.MessageBarType.info,isMultiline:!0},this.props.addingGuestText)),this._getAddMemberInstructions(),a.createElement("div",{className:"ms-groupMember-peoplePicker","data-automationid":"AddMembersPeoplePicker"},a.createElement(u.PeoplePicker,{context:this.props.pageContext,peoplePickerType:p.PeoplePickerType.listBelow,peoplePickerQueryParams:this._getPeoplePickerQueryParams(),onSelectedPersonasChange:this._onSelectedMembersChange,inputProps:this._getPeoplePickerInputProps()})),a.createElement("span",{className:"ms-groupMemberButton-container"},a.createElement(d.PrimaryButton,{disabled:this.state.saveButtonDisabled,onClick:this._onDoneClick,"data-automationid":"AddMembersSaveButton"},this.props.doneButtonText)),a.createElement("span",{className:"ms-groupMemberButton-container"},a.createElement(d.DefaultButton,{onClick:this._onCancelClick,"data-automationid":"AddMembersCancelButton"},this.props.cancelButtonText)),this.state.showSavingSpinner&&a.createElement(m.Spinner,{className:"ms-groupMember-spinner"}))))};e.prototype._onRenderPersona=function(e,t){if(e&&"number"==typeof t){var i=this._getPersonaControl(e);return a.createElement("div",{className:"ms-groupMember-itemBtn",title:e.name,key:t},a.createElement("div",{className:"ms-groupMember-personName"},i))}};e.prototype._getPersonaControl=function(e){return a.createElement(o.Persona,{imageUrl:e.imageUrl,primaryText:e.name,size:o.PersonaSize.small,hidePersonaDetails:!1,"data-automationid":"GroupMemberPersona"},a.createElement(l.GroupMembershipMenu,{menuItems:this.props.canChangeMemberStatus?e.memberStatusMenuItems:null,title:e.contextualMenuTitle,showSpinner:e.showSpinner}))};e.prototype._getAddMemberInstructions=function(){var e="ms-groupMember-addMemberInstructions";return this.props.showGuestsMessage&&this.props.addMembersOrGuestsInstructionsText&&this.props.addGuestsLinkText?this._getMessageWithLink(this.props.addMembersOrGuestsInstructionsText,this.props.addGuestsLinkText,e,this._logAddGuestsLinkClick):a.createElement("div",{className:e},this.props.addMembersInstructionsText)};e.prototype._getMessageWithLink=function(e,t,i,r){var n=null;if(this.props.membersUrl&&e&&-1!==e.indexOf("{0}")&&t){var o=e.split("{0}");2===o.length&&(n=a.createElement("div",{className:i},a.createElement("span",null,o[0]),a.createElement(h.Link,{href:this.props.membersUrl,onClick:r,target:"_blank"},t),a.createElement("span",null,o[1])))}return n};e.prototype._getPeoplePickerQueryParams=function(){return{allowEmailAddresses:!1,allowMultipleEntities:null,allUrlZones:null,enabledClaimProviders:null,forceClaims:null,groupID:0,maximumEntitySuggestions:30,principalSource:15,principalType:1,required:null,urlZone:null,urlZoneSpecified:null,filterExternalUsers:!this.props.canAddGuests,blockExternalUsers:!this.props.canAddGuests}};e.prototype._getPeoplePickerInputProps=function(){return{placeholder:this.props.peoplePickerPlaceholderText}};e.prototype._closePanel=function(){this.setState({showPanel:!1});this.props.onDismiss&&this.props.onDismiss()};e.prototype._onClick=function(){f.Engagement.logData({name:"GroupMembershipPanel.AddMembers.Click"});this._setIsAddingMembers(!0)};e.prototype._onCancelClick=function(){f.Engagement.logData({name:"GroupMembershipPanel.Cancel.Click"});this._setIsAddingMembers(!1)};e.prototype._onDoneClick=function(){var t=this;f.Engagement.logData({name:"GroupMembershipPanel.Save.Click"});this.props.errorMessageText&&this.props.clearErrorMessage();if(this.state.selectedMembers&&0<this.state.selectedMembers.length){if(this.props.onSave){this.setState({showSavingSpinner:!0,saveButtonDisabled:!0});this.props.onSave(this.state.selectedMembers).then(function(){t.setState({isAddingMembers:!1,isAddingGuest:!1,selectedMembers:[],showSavingSpinner:!1,saveButtonDisabled:!0})},function(e){t.setState({showSavingSpinner:!1,saveButtonDisabled:!1})})}}else this._setIsAddingMembers(!1)};e.prototype._logLargeGroupOutlookClick=function(){f.Engagement.logData({name:"GroupMembershipPanel.LargeGroupSearchLink.Click"});return!0};e.prototype._logAddGuestsLinkClick=function(){f.Engagement.logData({name:"GroupMembershipPanel.AddGuestOutlookLink.Click"});return!0};e.prototype._onSelectedMembersChange=function(e){var t=!1;this.props.canAddGuests&&(t=e.some(function(e){return 1===e.entityType}));this.setState({selectedMembers:e,isAddingGuest:t,saveButtonDisabled:!e.length})};e.prototype._setIsAddingMembers=function(e){this.setState({isAddingMembers:e,isAddingGuest:!1,selectedMembers:[],saveButtonDisabled:!0});this.props.errorMessageText&&this.props.clearErrorMessage()};e.prototype._closeDialog=function(){this.props.onCloseConfirmationDialog&&this.props.onCloseConfirmationDialog()};e.prototype._approveDialog=function(){this.props.onApproveConfirmationDialog&&this.props.onApproveConfirmationDialog()};e.prototype._dismissErrorMessage=function(){this.props.clearErrorMessage()};r.__decorate([s.autobind],e.prototype,"_onRenderPersona",null);r.__decorate([s.autobind],e.prototype,"_closePanel",null);r.__decorate([s.autobind],e.prototype,"_onClick",null);r.__decorate([s.autobind],e.prototype,"_onCancelClick",null);r.__decorate([s.autobind],e.prototype,"_onDoneClick",null);r.__decorate([s.autobind],e.prototype,"_logLargeGroupOutlookClick",null);r.__decorate([s.autobind],e.prototype,"_logAddGuestsLinkClick",null);r.__decorate([s.autobind],e.prototype,"_onSelectedMembersChange",null);r.__decorate([s.autobind],e.prototype,"_closeDialog",null);r.__decorate([s.autobind],e.prototype,"_approveDialog",null);r.__decorate([s.autobind],e.prototype,"_dismissErrorMessage",null);return e}(a.Component);t.GroupMembershipPanel=i});define("J2",["require","exports","ap","at","wt","jP","o7","o1","mo","J3"],function(e,t,i,n,o,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._resolveMenu=function(e){return i.menu=e};i.state={isContextualMenuVisible:!1};return i}e.prototype.render=function(){var e=this.props.menuItems&&0<this.props.menuItems.length;return n.createElement("div",null,n.createElement(s.FocusZone,{direction:s.FocusZoneDirection.horizontal},n.createElement("div",{className:"ms-groupMembershipMenu-titleArea",ref:this._resolveMenu},n.createElement("span",{className:e?"ms-groupMembershipMenu-linkText":void 0,onClick:this._onClick,"data-is-focusable":!0,role:"button","aria-haspopup":!0},this.props.showSpinner&&n.createElement(l.Spinner,{className:"ms-groupMembershipMenu-updatingSpinner",size:l.SpinnerSize.small}),this.props.title,e&&n.createElement(c.Icon,{iconName:"ChevronDown",className:"ms-groupMembershipMenu-chevron"}))),e&&this.state.isContextualMenuVisible&&n.createElement(o.ContextualMenu,{items:this.props.menuItems,isBeakVisible:!1,target:this.menu,directionalHint:4,onDismiss:this._onDismiss,gapSpace:0})))};e.prototype._onClick=function(){this.props.menuItems&&0<this.props.menuItems.length&&this.setState({isContextualMenuVisible:!this.state.isContextualMenuVisible})};e.prototype._onDismiss=function(e){this.setState({isContextualMenuVisible:!1});e.stopPropagation();e.preventDefault()};i.__decorate([a.autobind],e.prototype,"_onClick",null);i.__decorate([a.autobind],e.prototype,"_onDismiss",null);return e}(n.Component);t.GroupMembershipMenu=r});define("J3",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-groupMembershipMenu-linkText{cursor:pointer}.ms-groupMembershipMenu-titleArea{line-height:20px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .ms-groupMembershipMenu-chevron.ms-Icon{margin-left:10px}[dir=rtl] .ms-groupMembershipMenu-chevron.ms-Icon{margin-right:10px}.ms-groupMembershipMenu-updatingSpinner{float:left}[dir=ltr] .ms-groupMembershipMenu-updatingSpinner{margin-right:5px}[dir=rtl] .ms-groupMembershipMenu-updatingSpinner{margin-left:5px}"}])});define("J0",["require","exports","ap","at","oR","o1","J1"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){return r.createElement(o.Spinner,{className:"ms-groupMemberList-spinner"})};e.prototype.componentDidMount=function(){this.props.onLoadMoreMembers&&this.props.onLoadMoreMembers()};return e}(r.Component),s=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){var i=this,e=[];if(this.props.members){e=this.props.members;this.props.onLoadMoreMembers&&this.props.totalNumberOfMembers>this.props.members.length&&(e=e.concat([null]))}return r.createElement(n.List,{items:e,onRenderCell:function(e,t){return e?i.props.onRenderPersona(e,t):r.createElement(a,{onLoadMoreMembers:i.props.onLoadMoreMembers})}})};return e}(r.Component);t.GroupMembershipList=s});define("J1",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-groupMemberList-spinner{overflow:hidden}"}])});define("JZ",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-groupMember-itemBtn{text-align:center;margin-top:20px;margin-bottom:20px}[dir=ltr] .ms-groupMember-itemBtn{margin-right:4px}[dir=rtl] .ms-groupMember-itemBtn{margin-left:4px}.ms-groupMember-personName{white-space:nowrap;text-overflow:ellipsis}[dir=ltr] .ms-groupMember-personName{text-align:left}[dir=rtl] .ms-groupMember-personName{text-align:right}.ms-groupMember-personName .ms-Persona-secondaryText{display:none}.ms-groupMember-personName>div{margin-top:10px;margin-bottom:10px}.ms-groupMember-largeGroupMessage{margin-bottom:10px}.ms-groupMember-membersCount{font-weight:600;margin-bottom:10px}.ms-groupMember-list{list-style-type:none}[dir=ltr] .ms-groupMember-list{padding-left:0}[dir=rtl] .ms-groupMember-list{padding-right:0}.ms-groupMember-errorMessage{box-sizing:border-box;box-shadow:none;margin:0;padding:0;margin-top:20px;margin-bottom:13px}.ms-groupMember-addingGuest{box-sizing:border-box;box-shadow:none;margin:0;padding:0;margin-bottom:20px}.ms-groupMember-addMemberInstructions{margin-bottom:5px}.ms-groupMember-peoplePicker{margin-bottom:20px}.ms-groupMember-peoplePicker .ms-BasePicker-selectedItems{margin-top:20px}.ms-groupMemberButton-container{padding:0 4px}.ms-groupMember-spinner{overflow:hidden}.ms-groupMemberList-spinner{margin-top:10px;margin-bottom:10px;overflow:hidden}"}])});define("JS",["require","exports","ap","at","FK","JU","JT","iE","d7","aC","If"],function(e,t,r,n,o,a,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._resources=e.hostModel.resources;t._pageContext=t._resources.consume(l.pageContext);t._state=new a.GroupMembershipPanelStateManager({groupMembershipPanelContainer:t,pageContext:t._pageContext,getGroupsProvider:t._getGroupsProvider.bind(t),getGroupSiteProvider:t._getGroupSiteProvider.bind(t),strings:{title:s.strings.title,memberText:s.strings.member,ownerText:s.strings.owner,updatingText:s.strings.updating,guestText:s.strings.guest,removeFromGroupText:s.strings.removeFromGroup,membersCountText:s.strings.membersCount,membersCountIntervalsText:s.strings.membersCountIntervals,addMembersText:s.strings.addMembers,doneButtonText:s.strings.save,cancelButtonText:s.strings.cancel,removeLastOwnerErrorText:s.strings.removeLastOwnerError,demoteLastOwnerErrorText:s.strings.demoteLastOwnerError,addMembersInstructionsText:s.strings.addMembersInstructions,addMembersOrGuestsInstructionsText:s.strings.addMembersOrGuestsInstructions,addGuestsLinkText:s.strings.addGuestsLink,peoplePickerPlaceholderText:s.strings.enterNameOrEmailAddress,addMemberFailedSingularText:s.strings.addMemberFailedErrorMessageSingular,addMemberFailedPluralText:s.strings.addMemberFailedErrorMessageMultiple,addMemberFailedText:s.strings.addMemberFailedErrorMessage,serverErrorMessage:s.strings.errorMessage,largeGroupMessage:s.strings.largeGroupMessage,outlookLinkText:s.strings.outlookLink,searchMembersMessage:s.strings.searchMembersMessage,searchLinkText:s.strings.searchMembersLink,closeButtonAriaLabel:s.strings.closeButtonLabel,dismissErrorMessageAriaLabel:s.strings.closeErrorMessageLabel,okButtonText:s.strings.ok,confirmationText:s.strings.removeOwnerConfirmation,addingGuestText:s.strings.addingGuest,loadingMembersErrorText:s.strings.loadingMembersErrorMessage}});return t}e.prototype.componentDidMount=function(){this._state.componentDidMount()};e.prototype.componentWillUnmount=function(){this._state.componentWillUnmount()};e.prototype.render=function(){var e=this._state.getRenderProps();return n.createElement(o.GroupMembershipPanel,r.__assign({},e))};e.prototype._getGroupsProvider=function(){var e=this._resources;return e.isExposed(c.groupsAsync)?e.consume(c.groupsAsync):null};e.prototype._getGroupSiteProvider=function(){var e=this._resources;return e.isExposed(c.groupSiteProvider)?d.default.wrap(e.consume(c.groupSiteProvider)):d.default.wrap(new u.GroupSiteProvider({pageContext:this._pageContext}))};return e}(n.Component);t.GroupMembershipPanelContainer=i;t.default=i});define("JU",["require","exports","ap","JV"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("JV",["require","exports","ap","Ij","jP","V","aC","a0","aW","bf","aM"],function(e,t,i,r,n,c,a,s,o,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e){this._params=e;this._pageContext=e.pageContext;this._isAddRemoveGuestsFeatureEnabled=o.default.isFeatureEnabled({ODB:208,ODC:null,Fallback:!1});this._membershipCountChanged=!1}e.prototype.componentDidMount=function(){var t=this;this._params.getGroupsProvider().done(function(e){if(!e)throw new Error("GroupMembershipStateManager fatal error: Groups provider not available.");t._groupsProvider=e;if(!t._groupsProvider.group)throw new Error("GroupMembershipStateManager fatal error: Groups provider does not have an observed group.");t._isMembershipDynamic=!l.Killswitch.isActivated("56213E86-E001-42AD-B118-4A79CA1A90B4")&&!0===t._groupsProvider.group.isDynamic;t._checkOwnersCanAddGuests().then(function(e){t._ownersCanAddGuests=e;t._groupsProvider.currentUser?t._updateGroupInformation(!0):t._groupsProvider.getCurrentUser().then(function(){t._updateGroupInformation(!0)},function(e){t._setErrorMessage(e)})})})};e.prototype.componentWillUnmount=function(){};e.prototype.getRenderProps=function(){var e=this._params,t=this._pageContext,i=e.groupMembershipPanelContainer.state,r=!l.Killswitch.isActivated("E3ECD103-34DE-4ECA-9914-74D9110BB09C");return{title:null!==i?i.title:e.strings.title,onDismiss:this._onDismiss,personas:null!==i?i.personas:null,onLoadMoreMembers:this._onLoadMoreMembers,canAddMembers:!this._isMembershipDynamic&&(i&&i.currentUserIsOwner||t&&t.groupType&&"Public"===t.groupType),canAddGuests:!this._isMembershipDynamic&&i&&i.currentUserIsOwner&&this._ownersCanAddGuests&&this._isAddRemoveGuestsFeatureEnabled,showGuestsMessage:!this._isMembershipDynamic&&i&&i.currentUserIsOwner&&this._ownersCanAddGuests&&r,canChangeMemberStatus:!this._isMembershipDynamic&&i&&i.currentUserIsOwner,numberOfMembersText:null!==i?i.numberOfMembersText:void 0,totalNumberOfMembers:null!=i?i.totalNumberOfMembers:void 0,largeGroupMessage:null!=i?i.largeGroupMessage:void 0,membersUrl:this._groupsProvider?this._groupsProvider.group.membersUrl:void 0,outlookLinkText:e.strings.searchLinkText,showConfirmationDialog:null!==i&&i.showConfirmationDialog,onApproveConfirmationDialog:null!=i?i.onApproveConfirmationDialog:void 0,onCloseConfirmationDialog:this._closeConfirmationDialog,okButtonText:e.strings.okButtonText,confirmationText:e.strings.confirmationText,pageContext:this._pageContext,addMembersText:e.strings.addMembersText,doneButtonText:e.strings.doneButtonText,cancelButtonText:e.strings.cancelButtonText,addMembersInstructionsText:e.strings.addMembersInstructionsText,addMembersOrGuestsInstructionsText:e.strings.addMembersOrGuestsInstructionsText,addGuestsLinkText:e.strings.addGuestsLinkText,peoplePickerPlaceholderText:e.strings.peoplePickerPlaceholderText,onSave:this._onSave,addingGuestText:e.strings.addingGuestText,closeButtonAriaLabel:e.strings.closeButtonAriaLabel,dismissErrorMessageAriaLabel:e.strings.dismissErrorMessageAriaLabel,errorMessageText:null!==i?i.errorMessageText:void 0,clearErrorMessage:this._clearErrorMessage}};e.prototype._updateGroupInformation=function(e){var i=this;void 0===e&&(e=!1);var t=this._groupsProvider.group;e&&t.membership.source!==r.SourceType.None&&this.setState({title:this._params.strings.title,currentUserIsOwner:!!t.membership.isOwner,numberOfMembersText:this._getNumberOfMembersText(t.membership.totalNumberOfMembers),errorMessageText:void 0});if(this._isPageLoading&&this._currentMembershipPagePromise){this._currentMembershipPagePromise.cancel();this._isPageLoading=!1}this._membershipPager=this._groupsProvider.getMembershipPager();this._membershipPager.loadPage(0).then(function(e){var t=i._getGroupMemberPersonas(e.page,0);i._getNextMembershipPage=e.getNextPagePromise;i.setState({title:i._params.strings.title,personas:t,currentUserIsOwner:i._membershipPager.isOwner,numberOfMembersText:i._getNumberOfMembersText(i._membershipPager.totalNumberOfMembers),totalNumberOfMembers:i._membershipPager.totalNumberOfMembers,totalNumberOfOwners:i._membershipPager.totalNumberOfOwners,largeGroupMessage:i._getLargeGroupMessage(i._membershipPager.totalNumberOfMembers),errorMessageText:void 0})},function(e){i.setState({errorMessageText:i._params.strings.loadingMembersErrorText})})};e.prototype._checkOwnersCanAddGuests=function(){return this._groupsProvider.group.allowToAddGuests&&this._params.getGroupSiteProvider?this._params.getGroupSiteProvider().then(function(e){var t;e&&(t=e.getGroupCreationContext());return t}).then(function(e){var t;e&&(t=e.allowToAddGuests);return a.default.resolve(t)},function(e){return a.default.resolve(!1)}):a.default.resolve(!1)};e.prototype._onDismiss=function(){this._membershipCountChanged&&this._groupsProvider.group.membership.loadWithOptions(4)};e.prototype._onLoadMoreMembers=function(){var o=this;if(this._getNextMembershipPage&&!this._isPageLoading){this._isPageLoading=!0;this._currentMembershipPagePromise=this._getNextMembershipPage();this._currentMembershipPagePromise.then(function(e){var t=o._params.groupMembershipPanelContainer.state,i=t&&t.personas?t.personas:[],r=o._getGroupMemberPersonas(e.page,i.length),n=i.concat(r);o._getNextMembershipPage=e.getNextPagePromise;o._isPageLoading=!1;t.totalNumberOfMembers===o._membershipPager.totalNumberOfMembers?o.setState({personas:n}):o.setState({personas:n,numberOfMembersText:o._getNumberOfMembersText(o._membershipPager.totalNumberOfMembers),totalNumberOfMembers:o._membershipPager.totalNumberOfMembers})},function(e){o._isPageLoading=!1;if(!a.default.isCanceled(e)){o.setState({errorMessageText:o._params.strings.loadingMembersErrorText});o._getNextMembershipPage=void 0}})}};e.prototype._getGroupMemberPersonas=function(e,i){var r=this;return e.map(function(e,t){return{name:e.name,imageUrl:e.image,isGroupOwner:e.isOwnerOfCurrentGroup,memberStatusMenuItems:r._getMemberStatusMenuItems(e,t+i),contextualMenuTitle:r._getContextualMenuTitle(e)}})};e.prototype._getNumberOfMembersText=function(e){var t=c.getLocalizedCountValue(this._params.strings.membersCountText,this._params.strings.membersCountIntervalsText,e);return c.format(t,e)};e.prototype._getLargeGroupMessage=function(e){if(100<e){s.Engagement.logData({name:"GroupMembershipPanel.RenderLargeGroup",extraData:{numberOfMembers:e}});return this._params.strings.searchMembersMessage}s.Engagement.logData({name:"GroupMembershipPanel.RenderSmallGroup",extraData:{numberOfMembers:e}})};e.prototype._getContextualMenuTitle=function(e){return e.isOwnerOfCurrentGroup?this._params.strings.ownerText:1===e.entityType?this._params.strings.guestText:this._params.strings.memberText};e.prototype._getMemberStatusMenuItems=function(t,i){var r=this,e=[];1!==t.entityType?e.push({name:this._params.strings.memberText,key:"member",onClick:function(e){r._makeMember(t,i)},canCheck:!0,checked:!t.isOwnerOfCurrentGroup},{name:this._params.strings.ownerText,key:"owner",onClick:function(e){r._makeOwner(t,i)},canCheck:!0,checked:!!t.isOwnerOfCurrentGroup},{name:this._params.strings.removeFromGroupText,key:"remove",onClick:function(e){r._removeFromGroup(t,i)},canCheck:!1,checked:!1}):this._ownersCanAddGuests&&this._isAddRemoveGuestsFeatureEnabled&&e.push({name:this._params.strings.removeFromGroupText,key:"remove",onClick:function(e){r._removeFromGroup(t,i)},canCheck:!1,checked:!1});return e};e.prototype._makeMember=function(e,t){var i=this;s.Engagement.logData({name:"GroupMembershipPanel.MakeMember.Click"});if(e.isOwnerOfCurrentGroup){this._params.groupMembershipPanelContainer.state&&this._params.groupMembershipPanelContainer.state.totalNumberOfOwners<2?this.setState({errorMessageText:this._params.strings.demoteLastOwnerErrorText}):e.userId===this._groupsProvider.currentUser.userId?this._launchConfirmationDialog(function(){i.setState({showConfirmationDialog:!1});i._changeGroupOwnerToMember(e,t)}):this._changeGroupOwnerToMember(e,t)}};e.prototype._changeGroupOwnerToMember=function(e,t){var i=this,r=this._params.groupMembershipPanelContainer.state.personas,n=r[t].contextualMenuTitle,o=r[t].memberStatusMenuItems;this._setMemberStatusToUpdating(t);this._groupsProvider.removeUserFromGroupOwnership(this._pageContext.groupId,e.userId).then(function(){i._updateGroupInformation()},function(e){i._setErrorMessage(e);i._undoSetMemberStatusToUpdating(t,n,o)})};e.prototype._launchConfirmationDialog=function(e){this.setState({showConfirmationDialog:!0,onApproveConfirmationDialog:e})};e.prototype._closeConfirmationDialog=function(){this.setState({showConfirmationDialog:!1})};e.prototype._makeOwner=function(e,t){var i=this;s.Engagement.logData({name:"GroupMembershipPanel.MakeOwner.Click"});if(!e.isOwnerOfCurrentGroup){var r=this._params.groupMembershipPanelContainer.state.personas,n=r[t].contextualMenuTitle,o=r[t].memberStatusMenuItems;this._setMemberStatusToUpdating(t);this._groupsProvider.addUserToGroupOwnership(this._pageContext.groupId,e.userId).then(function(){i._updateGroupInformation()},function(e){i._setErrorMessage(e);i._undoSetMemberStatusToUpdating(t,n,o)})}};e.prototype._removeFromGroup=function(e,t){var i=this;s.Engagement.logData({name:"GroupMembershipPanel.RemovePerson.Click"});if(e.isOwnerOfCurrentGroup){this._params.groupMembershipPanelContainer.state&&this._params.groupMembershipPanelContainer.state.totalNumberOfOwners<2?this.setState({errorMessageText:this._params.strings.removeLastOwnerErrorText}):e.userId===this._groupsProvider.currentUser.userId?this._launchConfirmationDialog(function(){i.setState({showConfirmationDialog:!1});i._removeOwnerFromGroup(e,t)}):this._removeOwnerFromGroup(e,t)}else this._removeMemberFromGroup(e,t)};e.prototype._removeOwnerFromGroup=function(e,t){var i=this,r=this._params.groupMembershipPanelContainer.state.personas,n=r[t].contextualMenuTitle,o=r[t].memberStatusMenuItems;this._setMemberStatusToUpdating(t);this._groupsProvider.removeUserFromGroupOwnership(this._pageContext.groupId,e.userId).then(function(){i._groupsProvider.removeUserFromGroupMembership(i._pageContext.groupId,e.userId).then(function(){i._processingAfterRemoveMember(e.userId)},function(e){i._setErrorMessage(e);i._undoSetMemberStatusToUpdating(t,n,o)})},function(e){i._setErrorMessage(e);i._undoSetMemberStatusToUpdating(t,n,o)})};e.prototype._removeMemberFromGroup=function(e,t){var i=this,r=this._params.groupMembershipPanelContainer.state.personas,n=r[t].contextualMenuTitle,o=r[t].memberStatusMenuItems;this._setMemberStatusToUpdating(t);this._groupsProvider.removeUserFromGroupMembership(this._pageContext.groupId,e.userId).then(function(){i._processingAfterRemoveMember(e.userId)},function(e){i._setErrorMessage(e);i._undoSetMemberStatusToUpdating(t,n,o)})};e.prototype._setMemberStatusToUpdating=function(e){var t=this._params.groupMembershipPanelContainer.state.personas.concat([]);t[e].showSpinner=!0;t[e].contextualMenuTitle=this._params.strings.updatingText;t[e].memberStatusMenuItems=void 0;this.setState({personas:t})};e.prototype._undoSetMemberStatusToUpdating=function(e,t,i){var r=this._params.groupMembershipPanelContainer.state.personas.concat([]);r[e].showSpinner=!1;r[e].contextualMenuTitle=t;r[e].memberStatusMenuItems=i;this.setState({personas:r})};e.prototype._processingAfterRemoveMember=function(e){this._membershipCountChanged=!0;e===this._groupsProvider.currentUser.userId&&"Public"!==this._pageContext.groupType?this._navigateOnRemoveMember():this._updateGroupInformation()};e.prototype._navigateOnRemoveMember=function(){this._params.onMemberRemoved?this._params.onMemberRemoved():window.open(this._getSharePointHomePageUrl(),"_self")};e.prototype._getSharePointHomePageUrl=function(){var e=this._pageContext.webAbsoluteUrl,t=this._pageContext.webServerRelativeUrl;return e&&t?e.replace(t,"")+"/_layouts/15/sharepoint.aspx":void 0};e.prototype.setState=function(e){this._params.groupMembershipPanelContainer.setState(e)};e.prototype._onSave=function(e){var t=this;this._membershipCountChanged=!0;var i=e?e.map(function(e){return e.name}):[],r=e?e.map(function(e){return t._extractPrincipalName(e.userId)}):[];return this._groupsProvider.addUsersToGroup(this._pageContext.groupId,null,null,null,r).then(function(e){t._updateGroupInformation()},function(e){t._setAddMembersErrorMessage(e,[],i);return a.default.reject(e)})};e.prototype._setErrorMessage=function(e){var t=this._params.strings.serverErrorMessage;e&&e.message&&e.message.value&&(t=e.message.value);this.setState({errorMessageText:t})};e.prototype._clearErrorMessage=function(){this.setState({errorMessageText:void 0})};e.prototype._setAddMembersErrorMessage=function(e,t,i){var r=[],n=[];if(e&&e.hasError&&e.items)for(var o=e.items,a=0;a<o.length;a++){var s=o[a].error;s&&(s.code||s.message)&&(a<t.length?n.push(t[a]):r.push(i[a-t.length]))}var l="";1===r.length?l=l+" "+c.format(this._params.strings.addMemberFailedSingularText,r[0]):2<=r.length&&(l=l+" "+c.format(this._params.strings.addMemberFailedPluralText,r.join(", ")));l||(l=this._params.strings.addMemberFailedText);this.setState({errorMessageText:l})};e.prototype._extractPrincipalName=function(e){var t=e;if(t){var i=e.lastIndexOf("|");if(-1!==i){var r=t.substring(i+1);return d.default.encodeRestUriStringToken(r)}}return t};i.__decorate([n.autobind],e.prototype,"_onDismiss",null);i.__decorate([n.autobind],e.prototype,"_onLoadMoreMembers",null);i.__decorate([n.autobind],e.prototype,"_closeConfirmationDialog",null);i.__decorate([n.autobind],e.prototype,"_onSave",null);i.__decorate([n.autobind],e.prototype,"_clearErrorMessage",null);return e}();t.GroupMembershipPanelStateManager=u});define("Ij",["require","exports","ap","Ir","Ip","Io","In","Im","Il","Ik"],function(e,t,i,r,n,o,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(o,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t);i.__exportStar(c,t)});define("Ir",["require","exports","a3","a2","Im","Ik","Ip","Is","aC","eq","bT","eg"],function(e,t,i,n,o,a,r,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p="Yammer.FeedURL",m="MicrosoftTeams.TeamHomeURL",h="Missing group id.",f="GroupsNext",g="CurrentUser",b=function(){function t(e){this._missingLoginNameError="Missing user login name information.";this._pageContext=e.pageContext;this._dataRequestor=new u.default({},{pageContext:e.pageContext});this._dataSource=e.dataSource||new r.default(e.pageContext);this._dataStore=e.dataStore||new i.default(f,n.default.session);this._userLoginName=e.pageContext&&e.pageContext.userLoginName;this._groups=[];this._eventGroup=new d.default(this);this.switchCurrentGroup(e.groupId||e.pageContext&&e.pageContext.groupId)}t.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};t.prototype.getSPPageContext=function(){return this._pageContext};t.prototype.getMembershipPager=function(e){var r=this;return new s.default(this,this.group,function(e,t,i){return e?r._userLoginName?r._dataSource.getGroupMembershipPage(e,r._userLoginName,t,i):l.default.reject(r._missingLoginNameError):l.default.reject(h)},e,this._userLoginName)};t.prototype.loadGroupInfoFromCache=function(e){if(this._dataStore&&e)return this._dataStore.getValue(e,n.default.session)};t.prototype.saveGroupToCache=function(e){e&&this._dataStore&&this._dataStore.setValue(e.id,e,n.default.session)};t.prototype.saveMembershipToCache=function(e,t){if(this._dataStore){var i=this._dataStore.getValue(e,n.default.session);if(i){i.membership={isMember:t.isMember,totalNumberOfMembers:t.totalNumberOfMembers,totalNumberOfOwners:t.totalNumberOfOwners,membersList:t.membersList,isOwner:t.isOwner,isJoinPending:t.isJoinPending,lastLoadTimeStampFromServer:t.lastLoadTimeStampFromServer};this.saveGroupToCache(i)}}};t.prototype.loadGroupInfoContainerFromServer=function(e){var t=this;return e?this._dataSource.getGroupBasicProperties(e).then(function(e){t._performBasicPropertiesPostProcessing(e);c.isGroupWebContext(t._pageContext)&&t.doesCachedGroupPropertiesDiffer(e)&&t.syncGroupProperties();return e}):l.default.reject(h)};t.prototype.loadMembershipContainerFromServer=function(e,t,i){void 0===t&&(t=!1);void 0===i&&(i=!1);return e?this._userLoginName?this._dataSource.getGroupMembership(e,this._userLoginName,t,i):l.default.reject(this._missingLoginNameError):l.default.reject(h)};t.prototype.loadOwnershipContainerFromServer=function(e,t){return e?this._dataSource.getGroupOwnership(e,t):l.default.reject(h)};t.prototype.loadUserGroups=function(i){var r=this;return this.loadUserGroupsFromCache(i).then(function(e){return e&&0!==e.length?l.default.resolve(e):r.getCurrentUser().then(function(t){return i?r._dataSource.getUserGroupsFromAAD(t).then(function(e){r._dataStore&&r._dataStore.setValue("UserGroupsFromAAD"+t.userId,e,n.default.session);return e}):r._dataSource.getUserGroups(t).then(function(e){r._dataStore&&r._dataStore.setValue("UserGroups"+t.userId,e,n.default.session);r._setUsersGroups(e,a.SourceType.Server);return e})})})};t.prototype.loadUserGroupsFromCache=function(i){var r=this;return this._dataStore?this.getCurrentUser().then(function(e){var t;if(t=i?r._dataStore.getValue("UserGroupsFromAAD"+e.userId,n.default.session):r._dataStore.getValue("UserGroups"+e.userId,n.default.session)){i||r._setUsersGroups(t,a.SourceType.Cache);return l.default.resolve(t)}return l.default.resolve(void 0)}):l.default.resolve(void 0)};t.prototype.isUserInGroup=function(r){return this.loadUserGroups(!0).then(function(e){for(var t=0,i=e.length;t<i;t++)if(e[t].id===r)return!0;return!1})};t.prototype.getGroup=function(e,t){var r=this;void 0===t&&(t=!1);if(e)throw new Error("NotImplemented: Calling getGroup() on groupsProvider supplying a groupId is not yet implemented.");if(t||e&&0!==e.length&&(!this.group||e!==this.group.id)){e&&0!==e.length||(e=this.group.id);return this.loadGroupInfoContainerFromServer(e)}return new l.default(function(t,e){var i=r.group;r.group?i.source===a.SourceType.None?r._eventGroup.on(i,o.default.onSourceChange,function(e){e===a.SourceType.None||t(i)}):t(i):e("There is no group currently being managed by GroupsProvider.")})};t.prototype.getCurrentUser=function(){var t=this;if(!this._userLoginName)return l.default.reject(this._missingLoginNameError);this.currentUser||(this.currentUser=this._getUserFromCache(g));return this.currentUser?l.default.resolve(this.currentUser):this._dataSource.getUserInfo(this._userLoginName).then(function(e){t._saveUserToCache(e,g);return t.currentUser=e})};t.prototype.addUserToGroupMembership=function(t,i,r,n){var o,a=this;return t?this._getUserIdForCacheClear(i,r).then(function(e){o=e;return a._dataSource.addGroupMember(t,i,r,n)}).then(function(){a._clearUserGroupsCache(o)}):l.default.reject(h)};t.prototype.addUserToGroupOwnership=function(t,i,r,n){var o,a=this;return t?this._getUserIdForCacheClear(i,r).then(function(e){o=e;return a._dataSource.addGroupOwner(t,i,r,n)}).then(function(){a._clearUserGroupsCache(o)}):l.default.reject(h)};t.prototype.removeUserFromGroupMembership=function(t,i,r){var n,o=this;return t?this._getUserIdForCacheClear(i).then(function(e){n=e;return o._dataSource.removeGroupMember(t,i,r)}).then(function(){o._clearUserGroupsCache(n)}):l.default.reject(h)};t.prototype.removeUserFromGroupOwnership=function(t,i,r){var n,o=this;return t?this._getUserIdForCacheClear(i).then(function(e){n=e;return o._dataSource.removeGroupOwner(t,i,r)}).then(function(){o._clearUserGroupsCache(n)}):l.default.reject(h)};t.prototype.addUsersToGroup=function(e,t,i,r,n){var o,a=this;if(!e)return l.default.reject(h);if(this.currentUser){o=this.currentUser.userId;return this._dataSource.addUsersToGroup(e,t,i,r,n).then(function(e){a._clearUserGroupsCache(o);return e})}return this.getCurrentUser().then(function(e){o=e.userId}).then(function(){return a._dataSource.addUsersToGroup(e,t,i,r,n)}).then(function(e){a._clearUserGroupsCache(o);return e})};t.prototype.saveGroupProperties=function(e){return this._dataSource.setGroupBasicProperties(e)};t.prototype.switchCurrentGroup=function(e){var t=this.group?this.group.id:void 0;if(e&&e!==t){var i=this.getCachedGroup(e);i.load();this.group=i}};t.prototype.getCachedGroup=function(e,t){var i=this._groups[e];if(!i){i=new o.default(t,this,e,this._pageContext);this._groups[e]=i}return i};t.prototype.syncGroupProperties=function(){var e=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SyncGroupProperties";return this._dataRequestor.getData({url:e,qosName:"SyncGroupProperties",method:"POST",noRedirect:!0})};t.prototype.setGroupImage=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SetGroupImage";return this._dataRequestor.getData({url:t,qosName:"SetGroupImage",method:"POST",noRedirect:!0,additionalPostData:e,contentType:e?e.type:"image/jpeg"})};t.prototype.doesCachedGroupPropertiesDiffer=function(e){var t=this._pageContext;return t.groupId===e.id&&(t.webTitle!==e.name||(t.siteClassification||e.classification)&&t.siteClassification!==e.classification||null===t.groupType||void 0===t.groupType||"Public"===t.groupType!==e.isPublic)};t.prototype.deleteGroup=function(e){return this._dataSource.deleteGroup(e)};t.prototype._setUsersGroups=function(e,i){var r=this;this.userGroups=e.map(function(e){var t=r.getCachedGroup(e.id,e);i!==a.SourceType.Server&&t.source===a.SourceType.Server||t.extend(e);t.pictureUrl||t.load();return t});this._eventGroup.raise(t.onUserGroupsChange,this.userGroups)};t.prototype._performBasicPropertiesPostProcessing=function(e){if(this._pageContext){e.hasPictureUrl=!!e.pictureUrl;e.pictureUrl=this._pageContext.webAbsoluteUrl+"/_api/GroupService/GetGroupImage";e.inboxUrl=this._getWorkloadUrl(e,"inboxUrl","conversations",p);e.calendarUrl=this._getWorkloadUrl(e,"calendarUrl","CALENDAR",null);e.membersUrl=this._getWorkloadUrl(e,"membersUrl","members",null);e.teamsUrl=this._getWorkloadUrl(e,"teamsUrl",null,m)}};t.prototype._getWorkloadUrl=function(e,t,i,r){var n=null,o=e.yammerResources,a=e.teamsResources,s=function(e){var t=e.filter(function(e){return e.Key===r});return t&&t[0]?t[0].Value:null};r===m?a&&a.results&&0<a.results.length&&(n=s(a.results)):o&&o.results&&0<o.results.length?r===p&&(n=s(o.results)):n=e[t]?e[t]:this._pageContext.webAbsoluteUrl+"/_layouts/15/groupstatus.aspx?id="+e.id+"&target="+i;return n};t.prototype._saveUserToCache=function(e,t){e&&this._dataStore&&this._dataStore.setValue(t,e,n.default.session)};t.prototype._getUserFromCache=function(e){return this._dataStore?this._dataStore.getValue(e,n.default.session):void 0};t.prototype._clearUserGroupsCache=function(e){if(e&&this._dataStore){this._dataStore.setValue("UserGroupsFromAAD"+e,void 0,n.default.session);this._dataStore.setValue("UserGroups"+e,void 0,n.default.session)}};t.prototype._getUserIdForCacheClear=function(t,i){var r;if(this.currentUser&&t){r=t===this.currentUser.userId?t:null;return l.default.resolve(r)}return this.getCurrentUser().then(function(e){return r=t?t===e.userId?e.userId:null:i===e.principalName?e.userId:null})};t.onUserGroupsChange="userGroups";return t}();t.GroupsProvider=b;t.default=b});define("Im",["require","exports","Il","bT","V","Ik"],function(e,t,o,a,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function n(e,t,i,r){this._eventGroup=new a.default(this);this.source=s.SourceType.None;this.lastLoadTimeStampFromServer=-1;this._groupsProvider=t;this.id=i;e?this.extend(e):this.load();this.membership=new o.default(void 0,this._groupsProvider,this);!r&&t&&(r=t.getSPPageContext());this.plannerUrl=n._getPlannerUrl(r,i)}n._getPlannerUrl=function(e,t){if(e){t||(t=e.groupId);return e.webAbsoluteUrl+i.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",t,"planner")}};n.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};n.prototype.load=function(e){var t=this;if(this._groupsProvider&&this.id){if(this.source===s.SourceType.None){var i=this._groupsProvider.loadGroupInfoFromCache(this.id);if(i&&0<i.lastLoadTimeStampFromServer){this.extend(i);this.source=s.SourceType.Cache;this._eventGroup.raise(n.onSourceChange,this.source)}}if(this._shouldLoadNewData(e)){this._startLoadingFromServer();this._groupsProvider.loadGroupInfoContainerFromServer(this.id).then(function(e){e.lastLoadTimeStampFromServer=Date.now();t.extend(e);t._finishLoadingFromServer();t._groupsProvider.saveGroupToCache(e)},function(e){t._errorLoading(e)})}}};n.prototype.extend=function(e){this.name=e.name;this.principalName=e.principalName;this.alias=e.alias;this.mail=e.mail;this.description=e.description;this.creationTime=e.creationTime;this.profileUrl=e.profileUrl;this.inboxUrl=e.inboxUrl;this.calendarUrl=e.calendarUrl;this.filesUrl=e.filesUrl;this.notebookUrl=e.notebookUrl;this.pictureUrl=e.pictureUrl;this.hasPictureUrl=e.hasPictureUrl;this.sharePointUrl=e.sharePointUrl;this.editUrl=e.editUrl;this.membersUrl=e.membersUrl;this.teamsUrl=e.teamsUrl;this.isPublic=e.isPublic;this.classification=e.classification;this.allowToAddGuests=e.allowToAddGuests;this.isDynamic=e.isDynamic;this.yammerResources=e.yammerResources;this.teamsResources=e.teamsResources;this.lastLoadTimeStampFromServer=e.lastLoadTimeStampFromServer};n.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&(e||this.source!==s.SourceType.Server&&(!this.lastLoadTimeStampFromServer||6e4<Date.now()-this.lastLoadTimeStampFromServer))};n.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0};n.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1;this.source=s.SourceType.Server;this._eventGroup.raise(n.onSourceChange,this.source)};n.prototype._errorLoading=function(e){this.isLoadingFromServer=!1;this.error=e};n.onSourceChange="source";return n}();t.Group=r;t.default=r});define("Il",["require","exports","In","Ik","aC","bT"],function(e,t,r,o,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s;!function(e){e[e.none=0]="none";e[e.allMembers=1]="allMembers";e[e.ownershipInformation=2]="ownershipInformation";e[e.forceSkipCache=4]="forceSkipCache"}(s=t.MembershipLoadOptions||(t.MembershipLoadOptions={}));var i=function(){function i(e,t,i){this._eventGroup=new a.default(this);this.source=o.SourceType.None;this.lastLoadTimeStampFromServer=-1;this._groupsProvider=t;this._parent=i;e&&this.extend(e,o.SourceType.None);this.membersList||(this.membersList=new r.default)}i.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}this._parent=void 0};i.prototype.load=function(e,t){var i=this;void 0===e&&(e=!1);void 0===t&&(t=!1);if(this._groupsProvider&&this._parent.id){var r=0;e&&(r|=s.allMembers);t&&(r|=s.ownershipInformation);if(this.source===o.SourceType.None&&!r){var n=this._groupsProvider.loadGroupInfoFromCache(this._parent.id);n&&n.membership&&0<n.membership.lastLoadTimeStampFromServer&&this.extend(n.membership,o.SourceType.Cache)}if(this._shouldLoadNewData(r)){this._startLoadingFromServer(r);this._groupsProvider.loadMembershipContainerFromServer(this._parent.id,e,t).then(function(e){i.extend(e,o.SourceType.Server);i._finishLoadingFromServer();if(!r){e.lastLoadTimeStampFromServer=i.lastLoadTimeStampFromServer;i._groupsProvider.saveMembershipToCache(i._parent.id,e)}},function(e){i._errorLoading(e)})}}};i.prototype.loadWithOptions=function(t){var i=this;if(this._groupsProvider&&this._parent.id){if(this.source===o.SourceType.None&&!t){var e=this._groupsProvider.loadGroupInfoFromCache(this._parent.id);e&&e.membership&&0<e.membership.lastLoadTimeStampFromServer&&this.extend(e.membership,o.SourceType.Cache)}if(this._shouldLoadNewData(t)){this._startLoadingFromServer(t);return this._groupsProvider.loadMembershipContainerFromServer(this._parent.id,t&&(t&s.allMembers)===s.allMembers,t&&(t&s.ownershipInformation)===s.ownershipInformation).then(function(e){i.extend(e,o.SourceType.Server);i._finishLoadingFromServer();if(!t||t===s.forceSkipCache){e.lastLoadTimeStampFromServer=i.lastLoadTimeStampFromServer;i._groupsProvider.saveMembershipToCache(i._parent.id,e)}},function(e){i._errorLoading(e)})}}return n.default.resolve(void 0)};i.prototype.extend=function(e,t){this.isMember=e.isMember;this.isOwner=e.isOwner;this.isJoinPending=e.isJoinPending;this.membersList=e.membersList;this.totalNumberOfMembers=e.totalNumberOfMembers;this.totalNumberOfOwners=e.totalNumberOfOwners;this.lastLoadTimeStampFromServer=e.lastLoadTimeStampFromServer;(this._parent.membership=this).source=t;this._eventGroup.raise(i.onSourceChange,this.source)};i.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&this.source!==o.SourceType.Server&&(this.lastLoadTimeStampFromServer<0||12e4<Date.now()-this.lastLoadTimeStampFromServer)||e&&(e&s.forceSkipCache)===s.forceSkipCache||e&&(e&s.allMembers)===s.allMembers&&!(this._currentLoadOptions&&(this._currentLoadOptions&s.allMembers)===s.allMembers)||e&&(e&s.ownershipInformation)===s.ownershipInformation&&!(this._currentLoadOptions&&(this._currentLoadOptions&s.ownershipInformation)===s.ownershipInformation)};i.prototype._startLoadingFromServer=function(e){this.isLoadingFromServer=!0;this._currentLoadOptions=e};i.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1;this._currentLoadOptions=void 0;this.lastLoadTimeStampFromServer=Date.now()};i.prototype._errorLoading=function(e){this.isLoadingFromServer=!1;this._currentLoadOptions=void 0;this.error=e};i.onSourceChange="source";return i}();t.Membership=i;t.default=i});define("In",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.members=new Array}e.prototype.addUserToList=function(e){this.members.unshift(e)};e.prototype.removeUserFromList=function(e){for(var t=-1,i=0;i<this.members.length;i++)this.members[i].userId===e.userId&&(t=i);0<=t&&this.members.splice(t,1)};e.prototype.containsUserByPrincipalName=function(e){if(e)for(var t=e.toLowerCase(),i=0;i<this.members.length;i++)if(this.members[i].principalName&&this.members[i].principalName.toLowerCase()===t)return!0;return!1};return e}();t.MembersList=i;t.default=i});define("Ik",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Cache=0]="Cache";e[e.Server=1]="Server";e[e.None=2]="None"}(i=t.SourceType||(t.SourceType={}));t.default=i});define("Ip",["require","exports","ap","In","ef","aC","V","aM","aZ","Iq"],function(e,t,i,r,n,h,f,o,g,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="Group('{0}')",l="Group('{0}')/{1}?$skip={2}&$top={3}&$inlinecount=allpages&$select=PrincipalName,Id,DisplayName,PictureUrl,UserType",_="Group('{0}')/Members/Add(objectId='{1}', principalName='{2}')",v="Group('{0}')/Owners/Add(objectId='{1}', principalName='{2}')",c="/_layouts/15/groupstatus.aspx?id={0}&target={1}",a=function(e){i.__extends(a,e);function a(){return null!==e&&e.apply(this,arguments)||this}a._copyMember=function(e){return{sip:e.alias,userId:e.id,email:e.principalName,principalName:e.principalName,name:e.displayName,job:e.title,image:e.sharePointPictureUrl,profilePage:e.profilePage,entityType:e&&e.userType&&"guest"===e.userType?1:void 0}};a._parseUser=function(e){var t=JSON.parse(e);return a._copyMember(t.d)};a._copyMembers=function(e){var t=new r.default;t.members=e.map(function(e){return a._copyMember(e)});return t};a._parseGroup=function(e){var t=JSON.parse(e);return a._copyGroup(t.d)};a._parseMembership=function(e){var t=JSON.parse(e);return a._copyMembership(t.d)};a._copyGroup=function(e){return{description:e.description,alias:e.alias,name:e.displayName,principalName:e.principalName,creationTime:e.creationTime,pictureUrl:e.pictureUrl,inboxUrl:e.inboxUrl,calendarUrl:e.calendarUrl,filesUrl:e.documentsUrl,sharePointUrl:e.siteUrl,editUrl:e.editGroupUrl,membersUrl:e.peopleUrl,notebookUrl:e.notebookUrl,teamsUrl:e.teamsUrl,isPublic:e.isPublic,mail:e.mail,classification:e.classification,yammerResources:e.yammerResources,teamsResources:e.teamsResources,allowToAddGuests:e.allowToAddGuests,isDynamic:e.isDynamic,membership:a._copyMembership(e)}};a._copyMembership=function(e){return{totalNumberOfMembers:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,membersList:e&&e.results?a._copyMembers(e.results):void 0}};a._parseOwnership=function(e){var t=JSON.parse(e);return a._copyOwnership(t.d)};a._copyOwnership=function(e){return{totalNumberOfOwners:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,ownersList:e&&e.results?a._copyMembers(e.results):void 0}};a.prototype.getDataSourceName=function(){return"GroupsDataSource"};a.prototype.getGroupBasicProperties=function(i){var r=this;return this.getData(function(){return r._getUrl(f.format("Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic",i),"SP.Directory.DirectorySession")},function(e){var t=a._parseGroup(e);t.id||(t.id=i);r._calculateMissingGroupProperties(t,i);return t},"GetBasicProperties",void 0,"GET",void 0,void 0,3)};a.prototype.setGroupBasicProperties=function(t){var e=this;if(!t)return h.default.reject("Group parameter is null or undefined");return this.getData(function(){return e._getUrl(f.format(s,t.id),"SP.Directory.DirectorySession")},void 0,"SetBasicProperties",function(){var e={__metadata:{type:"SP.Directory.Group"},displayName:t.name,description:t.description,isPublic:t.isPublic};t.classification&&(e.classification=t.classification);return JSON.stringify(e)},"PATCH",void 0,void 0,3)};a.prototype.getGroupByAlias=function(e){var t=this;return this.getData(function(){return t._getUrl(f.format("Group(alias='{0}')",e),"SP.Directory.DirectorySession")},function(e){return a._parseGroup(e)},"GetGroupByAlias",void 0,"GET",void 0,void 0,0)};a.prototype.getGroupMembership=function(t,i,e,r){var n=this;void 0===e&&(e=!1);void 0===r&&(r=!1);var o=e?"100":"3";return this.getData(function(){return n._getUrl(f.format(l,t,"members","0",o),"SP.Directory.DirectorySession")},function(e){var t=a._parseMembership(e);n._calculateMissingMembershipProperties(t,i);return t},"GetMembership",void 0,"GET",void 0,void 0,3).then(function(e){return r?n._addOwnerInformation(t,i,e):h.default.resolve(e)})};a.prototype.getGroupMembershipPage=function(e,i,t,r){var n=this;return this.getData(function(){return n._getUrl(f.format(l,e,"members",t,r),"SP.Directory.DirectorySession")},function(e){var t=a._parseMembership(e);n._calculateMissingMembershipProperties(t,i);return t},"GetMembershipPage",void 0,"GET",void 0,void 0,3)};a.prototype.getGroupOwnership=function(e,t){var i=this,r=t||"100";return this.getData(function(){return i._getUrl(f.format(l,e,"owners","0",r),"SP.Directory.DirectorySession")},function(e){var t=a._parseOwnership(e);i._calculateMissingOwnershipProperties(t);return t},"GetOwnership",void 0,"GET",void 0,void 0,3)};a.prototype.getUserGroupsFromAAD=function(e){var t=this;return this.getData(function(){return t._getCsomUrl("ProcessQuery")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroupsFromAAD",function(){return f.format('<Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="Javascript Library"><Actions><ObjectPath Id="4" ObjectPathId="3" /><Query Id="5" ObjectPathId="3"><Query SelectAllProperties="true"><Properties /></Query></Query></Actions><ObjectPaths><StaticMethod Id="3" Name="GetMyGroups" TypeId="{1e54feb9-52a0-49f7-b464-6b722cf86f94}"><Parameters><Parameter Type="String">{0}</Parameter><Parameter Type="Number">0</Parameter><Parameter Type="Number">100</Parameter></Parameters></StaticMethod></ObjectPaths></Request>',e.email)},"POST")};a.prototype.getUserGroups=function(e){var t=this,i=function(){return t.getUserGroupsFromAAD(e)};return this.getData(function(){return t._getUrl(f.format("User('{0}')/RankedMembership?$top=100&$select=DisplayName,DocumentsUrl,SharePointPictureUrl,PictureUrl,Id,IsFavorite",e.userId),"SP.Directory.DirectorySession")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroups",void 0,"GET",void 0,void 0,0).then(function(e){return e&&e.length?e:i()},i)};a.prototype.addGroupMember=function(e,t,i,r){var n=this;t=t||g.default.Empty;i=i||"";return this.getData(function(){return n._getUrl(f.format(_,e,t,i),"SP.Directory.DirectorySession")},void 0,r||"AddMember",void 0,"POST",void 0,void 0,3)};a.prototype.addGroupOwner=function(e,t,i,r){var n=this;t=t||g.default.Empty;i=i||"";return this.getData(function(){return n._getUrl(f.format(v,e,t,i),"SP.Directory.DirectorySession")},void 0,r||"AddOwner",void 0,"POST",void 0,void 0,3)};a.prototype.removeGroupMember=function(e,t,i){var r=this;return this.getData(function(){return r._getUrl(f.format("Group('{0}')/Members/Remove('{1}')",e,t),"SP.Directory.DirectorySession")},void 0,i||"RemoveMember",void 0,"POST",void 0,void 0,3)};a.prototype.removeGroupOwner=function(e,t,i){var r=this;return this.getData(function(){return r._getUrl(f.format("Group('{0}')/Owners/Remove('{1}')",e,t),"SP.Directory.DirectorySession")},void 0,i||"RemoveOwner",void 0,"POST",void 0,void 0,3)};a.prototype.addUsersToGroup=function(l,e,t,i,r){var c=this,n=g.default.generate(),o="multipart/mixed; boundary=batch_"+n,d=[],u=[],a=0,s=0,p=function(e,t,i){for(var r=t?v:_,n=0;n<e.length;n++){var o=void 0,a=void 0;i?a=e[n]:o=e[n];if(o||a){o=o||g.default.Empty;a=a||"";var s=c._getUrl(f.format(r,l,o,a),"SP.Directory.DirectorySession");t?u.push(s):d.push(s)}}};if(e){p(e,!0,!1);a=e.length}else if(i){p(i,!0,!0);a=i.length}if(t){p(t,!1,!1);s=t.length}else if(r){p(r,!1,!0);s=r.length}if(!(u.length<1&&d.length<1)){var m=this.getData(function(){return b.DataBatchOperationHelper.getBatchOperationUrl(c._pageContext.webAbsoluteUrl)},function(e){return e},"AddUsersToGroup",function(){return b.DataBatchOperationHelper.getBatchContent(n,[u,d],"POST",b.DataBatchOperationHelper.defaultBatchRequestPostData)},"POST",void 0,o,void 0,void 0,void 0,function(e){e.extraData={OwnersNumber:a,MembersNumber:s};return e.status.toString()});return new h.default(function(i,r){m.then(function(e){var t=b.DataBatchOperationHelper.processBatchResponse(e);t.hasError?r(t):i(t)},function(e){r(e)})})}};a.prototype.getUserInfo=function(i){var e=this;return this.getData(function(){return e._getUrl(f.format("User(principalName='{0}')",o.default.encodeRestUriStringToken(i)),"SP.Directory.DirectorySession")},function(e){var t=a._parseUser(e);t.email=i;return t},"GetGraphUser",void 0,"GET",void 0,void 0,3)};a.prototype.deleteGroup=function(e){var t=this;if(!e)return h.default.reject("Group parameter is null or undefined");return this.getData(function(){return t._getUrl(f.format(s,e.id),"SP.Directory.DirectorySession")},void 0,"DeleteGroup",void 0,"DELETE",void 0,void 0,3)};a.prototype._getUrl=function(e,t){return this._pageContext.webAbsoluteUrl+"/_api/"+t+"/"+e};a.prototype._getCsomUrl=function(e){return this._pageContext.webAbsoluteUrl+"/_vti_bin/client.svc/"+e};a.prototype._getGroupStatusNotebookUrl=function(e){return this._pageContext.webAbsoluteUrl+f.format(c,e,"notebook")};a.prototype._getGroupStatusFilesUrl=function(e){return this._pageContext.webAbsoluteUrl+f.format(c,e,"documents")};a.prototype._addOwnerInformation=function(e,s,l){return this.getGroupOwnership(e,"100").then(function(e){var t=e.ownersList.members,i=l.membersList.members,r=[],n={};t.forEach(function(e){n[e.userId]=!0;e.principalName.toLowerCase()===s.toLowerCase()&&(l.isOwner=!0)});var o=0,a={};i.forEach(function(e){if(n[e.userId]){e.isOwnerOfCurrentGroup=!0;r.push(e);o++;a[e.userId]=!0}else r.push(e);e.principalName===s&&(l.isMember=!0)});o<t.length&&t.forEach(function(e){if(!a[e.userId]){e.isOwnerOfCurrentGroup=!0;r.push(e)}});l.membersList.members=r;l.totalNumberOfMembers<r.length&&(l.totalNumberOfMembers=r.length);l.totalNumberOfOwners=e.totalNumberOfOwners;return h.default.resolve(l)})};a.prototype._fixUserImages=function(e){!e.image&&e.email&&(e.image=f.format("/_layouts/15/userphoto.aspx?size=S&accountname={0}",e.email));!e.profilePage&&e.email&&(e.profilePage=f.format("/_layouts/15/me.aspx?p={0}&v=profile&origin=ProfileODB",e.email))};a.prototype._calculateMissingMembershipProperties=function(e,t){var i=this;e.membersList.members.forEach(function(e){i._fixUserImages(e)})};a.prototype._calculateMissingOwnershipProperties=function(e){var t=this;e.ownersList.members.forEach(function(e){t._fixUserImages(e)})};a.prototype._calculateMissingGroupProperties=function(e,t){e.creationTime||(e.creationTime=Date.now());e.pictureUrl&&(e.pictureUrl=e.pictureUrl.replace("EWS/Exchange.asmx/s/GetUserPhoto","OWA/service.svc/s/GetPersonaPhoto"));!e.notebookUrl&&t&&(e.notebookUrl=this._getGroupStatusNotebookUrl(t));!e.filesUrl&&t&&(e.filesUrl=this._getGroupStatusFilesUrl(t))};a.prototype._parseResponseForGetUserGroups=function(e){var i=this,t=JSON.parse(e);if(t.constructor===Array)return t[4].GroupsList.map(function(e){return{filesUrl:e.DocumentsUrl,name:e.DisplayName,id:e.Id}});var r=t.d.results.map(function(e){var t={filesUrl:e.documentsUrl,name:e.displayName,id:e.id,pictureUrl:e.pictureUrl,isFavorite:e.isFavorite};i._calculateMissingGroupProperties(t,t.id);return t}),n=r.filter(function(e){return e.isFavorite});n.push.apply(n,r.filter(function(e){return!e.isFavorite}));return n};return a}(n.default);t.default=a});define("Is",["require","exports","aC"],function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=20,i=function(){function e(e,t,i,r,n){this._groupsProvider=e;this._parentGroup=t;this._loadPageFromServerDelegate=i;this._pageSize=r&&"number"==typeof r.pageSize?r.pageSize:a;this._shouldAddOwnershipInformation=!r||(r.ownershipInformation,!1)||r.ownershipInformation;this._userLoginName=n;this._foundOwnersDictionary={};this._numberOfOwnersFound=0}e.prototype.loadPage=function(e){var t=this,i=e||0;if(this._groupsProvider&&this._parentGroup.id){return this._loadPageFromServerDelegate(this._parentGroup.id,i,this._pageSize).then(function(e){return t._processPage(e,i)},function(e){t.error=e;return o.default.reject(e)})}return o.default.reject(void 0)};e.prototype._processPage=function(t,e){var i=this;this.totalNumberOfMembers=t.totalNumberOfMembers;var r=e+this._pageSize>=this.totalNumberOfMembers,n=r?void 0:this._computeGetNextPagePromise(e+this._pageSize);if(this._shouldAddOwnershipInformation){if(this._ownersDictionary){this._addOwnershipInformationToPage(t,r);return o.default.resolve({page:t.membersList.members,getNextPagePromise:n})}return this._groupsProvider.loadOwnershipContainerFromServer(this._parentGroup.id).then(function(e){i._addOwnershipInformationToPage(t,r,e);return o.default.resolve({page:t.membersList.members,getNextPagePromise:n})})}return o.default.resolve({page:t.membersList.members,getNextPagePromise:n})};e.prototype._addOwnershipInformationToPage=function(e,t,i){var r=this;if(i){this.totalNumberOfOwners=i.totalNumberOfOwners;this._ownersDictionary={};i.ownersList.members.forEach(function(e){e.userId&&(r._ownersDictionary[e.userId]=e)});this.isOwner=i.ownersList.containsUserByPrincipalName(this._userLoginName)}e.membersList.members.forEach(function(e){e.isOwnerOfCurrentGroup=r._ownersDictionary&&!!r._ownersDictionary[e.userId];if(e.isOwnerOfCurrentGroup){r._numberOfOwnersFound++;r._foundOwnersDictionary[e.userId]=!0}});if(t&&this._ownersDictionary&&this._numberOfOwnersFound<this.totalNumberOfOwners)for(var n in this._ownersDictionary){var o=this._ownersDictionary[n];if(!this._foundOwnersDictionary[o.userId]){o.isOwnerOfCurrentGroup=!0;e.membersList.members.push(o);this.totalNumberOfMembers++}}};e.prototype._computeGetNextPagePromise=function(e){var t=this;return function(){return t.loadPage(e)}};return e}();t.MembershipPager=i;t.default=i});define("Io",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e.public="Public";e.private="Private"}(i=t.GroupType||(t.GroupType={}));t.default=i});define("If",["require","exports","ap","Ii","Ih","Ig"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(o,t)});define("Ii",["require","exports","aC","Ih"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="Missing group id.",o=function(){function e(e){this._dataSource=e.dataSource||new r.default(e.pageContext)}e.prototype.checkGroupExists=function(e){return this._dataSource.checkGroupExists(e)};e.prototype.checkSiteExists=function(e){return this._dataSource.checkSiteExists(e)};e.prototype.getSiteUrlFromAlias=function(e){return e?this._dataSource.getSiteUrlFromAlias(e):i.default.resolve(void 0)};e.prototype.getGroupCreationContext=function(){return this._dataSource.getGroupCreationContext()};e.prototype.validateGroupName=function(e,t){return this._dataSource.validateGroupName(e,t)};e.prototype.createGroup=function(e,t,i,r,n,o,a,s){return this._dataSource.createGroup(e,t,i,r,n,o,a,s)};e.prototype.groupify=function(e,t,i,r,n,o,a){return this._dataSource.groupify(e,t,i,r,n,o,a)};e.prototype.getGroupSiteConversionData=function(){return this._dataSource.getGroupSiteConversionData()};e.prototype.getNotebookUrl=function(e){return e?this._dataSource.getNotebookUrl(e):i.default.reject(n)};e.prototype.getGroupSiteStatus=function(e){return e?this._dataSource.getSiteStatus(e):i.default.reject(n)};e.prototype.createGroupSite=function(e){return e?this._dataSource.createSite(e):i.default.reject(n)};return e}();t.GroupSiteProvider=o;t.default=o});define("Ih",["require","exports","ap","Ie","V","aW","aM"],function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="SP.Directory.DirectorySession",l={ODB:257,ODC:null,Fallback:!1};!function(e){e[e.invalidLength=0]="invalidLength";e[e.missingPrefixSuffix=1]="missingPrefixSuffix";e[e.containsBlockedWord=2]="containsBlockedWord";e[e.propertyConflict=3]="propertyConflict"}(t.GroupNameValidationErrorCode||(t.GroupNameValidationErrorCode={}));var c=function(e){r.__extends(i,e);function i(){return null!==e&&e.apply(this,arguments)||this}i._parseGroupSiteInfoResponse=function(e,t){var i=JSON.parse(e).d[t];return{siteUrl:i.SiteUrl,errorMessage:i.ErrorMessage,siteStatus:i.SiteStatus,documentsUrl:i.DocumentsUrl}};i.prototype.getDataSourceName=function(){return"GroupSiteDataSource"};i.prototype.checkGroupExists=function(e){var t=this;return this.getData(function(){return t._getUrl(n.format("Group(alias='{0}')",e),s)},function(e){return!0},"GetGroupByAlias",void 0,"GET",void 0,void 0,0).then(function(e){return e},function(e){var t=e.code;if(t){var i=t.split(",")[1];if(i&&-1===i.indexOf("ResourceNotFoundException"))return!0}return!1})};i.prototype.getNotebookUrl=function(e){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+n.format("/_api/GroupSiteManager/Notebook?groupId='{0}'",e)},function(e){return JSON.parse(e).d.Notebook},"GetNotebookUrl",void 0,"GET",void 0,void 0,3)};i.prototype.getSiteStatus=function(e){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+n.format("/_api/GroupSiteManager/GetSiteStatus?groupId='{0}'",e)},function(e){return i._parseGroupSiteInfoResponse(e,"GetSiteStatus")},"GetSiteStatus",void 0,"GET",void 0,void 0,3)};i.prototype.createSite=function(e){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+n.format("/_api/GroupSiteManager/Create?groupId='{0}'",e)},function(e){return i._parseGroupSiteInfoResponse(e,"Create")},"CreateSite",void 0,"POST",void 0,void 0,3)};i.prototype.createGroup=function(r,n,o,a,s,l,c,d){var u=this;return this.getData(function(){return u._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/CreateGroupEx"},function(e){var t=JSON.parse(e);if(t.d)return{status:"200",response:e,groupId:t.d.CreateGroupEx}},"CreateGroupSiteFromSP",function(){var e=[];l&&e.push("AllowFileSharingForGuestUsers");if(c){var t=u._extractSiteAlias(c);""!==t&&t!==n&&e.push("SiteAlias:"+t)}d&&e.push("implicit_formula_292aa8a00786498a87a5ca52d9f4214a_"+d);var i={displayName:r,alias:n,isPublic:o,optionalParams:{Description:a,CreationOptions:{results:e},Classification:s}};return JSON.stringify(i)},"POST",void 0,void 0,0)};i.prototype.groupify=function(i,r,n,o,a,s,l){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/CreateGroupForSite"},function(e){var t=JSON.parse(e);if(t.d)return{status:"200",response:e,groupId:t.d.CreateGroupForSite}},"Groupify",function(){var e=[];s&&e.push("AllowFileSharingForGuestUsers");l&&e.push("SharePointKeepOldHomepage");var t={displayName:i,alias:r,isPublic:n,optionalParams:{Description:o,CreationOptions:{results:e},Classification:a}};return JSON.stringify(t)},"POST",void 0,void 0,0)};i.prototype.getGroupSiteConversionData=function(){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/GetGroupSiteConversionData"},function(e){var t=JSON.parse(e);if(t.d)return{status:"200",response:e,conversionInfo:{GroupType:t.d.GetGroupSiteConversionData.GroupType,SuggestedMembers:t.d.GetGroupSiteConversionData.SuggestedMembers.results,SuggestedOwners:t.d.GetGroupSiteConversionData.SuggestedOwners.results,UnsuggestablePrincipals:t.d.GetGroupSiteConversionData.UnsuggestablePrincipals.results}}},"GetGroupSiteConversionData",null,"POST",void 0,void 0,0)};i.prototype.canUserCreateGroup=function(){var e=this;return this.getDataUtilizingCache({getUrl:function(){return e._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/CanUserCreateGroup"},parseResponse:function(e){var t=JSON.parse(e);if(t&&t.d&&t.d.CanUserCreateGroup)return t.d.CanUserCreateGroup},qosName:"CanUserCreateGroup",method:"GET",maxRetries:3,noRedirect:!0})};i.prototype.getGroupCreationContext=function(){var n=this;return this.getDataUtilizingCache({getUrl:function(){return n._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/GetGroupCreationContext"},parseResponse:function(e){var t=o.default.isFeatureEnabled(l),i=JSON.parse(e);if(i&&i.d&&i.d.GetGroupCreationContext){var r=i.d.GetGroupCreationContext;return{requireSecondaryContact:r.RequireSecondaryContact,usageGuidelineUrl:r.UsageGuidelineUrl,dataClassificationOptions:r.DataClassificationOptions.results,customFormUrl:r.CustomFormUrl,allowToAddGuests:r.ExternalInvitationEnabled,sitePath:r.SitePath,defaultClassification:t?r.DefaultClassification:void 0,classificationDescriptions:t?n._parseClassificationDescriptions(r.ClassificationDescriptions):void 0}}},qosName:"GetGroupCreationContext",method:"GET",maxRetries:3,noRedirect:!0})};i.prototype.getSiteUrlFromAlias=function(e){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+n.format("/_api/GroupSiteManager/GetValidSiteUrlFromAlias?alias='{0}'",e)},function(e){var t=JSON.parse(e);if(t&&t.d&&t.d.GetValidSiteUrlFromAlias)return t.d.GetValidSiteUrlFromAlias},"GetSiteUrlFromAlias",void 0,"GET",void 0,void 0,3,void 0,void 0,function(e){return-1<(e&&e.code?e.code:"").indexOf("2147467261")?"AliasNullException":e.status.toString()})};i.prototype.validateGroupName=function(e,t){var i=this,o=function(e){return{validationPropertyName:e.ValidationPropertyName,validationErrorCode:function(e){var t;switch(e.toLowerCase()){case"InvalidLength".toLowerCase():t=0;break;case"MissingPrefixSuffix".toLowerCase():t=1;break;case"ContainsBlockedWord".toLowerCase():t=2;break;case"PropertyConflict".toLowerCase():t=3}return t}(e.ValidationErrorCode),validationErrorMessage:e.ValidationErrorMessage,prefix:e.Prefix,suffix:e.Suffix,blockedWord:e.BlockedWord}};return this.getData(function(){return i._getUrl(n.format("ValidateGroupName(displayName='{0}', alias='{1}')",a.default.encodeRestUriStringToken(e),a.default.encodeRestUriStringToken(t)),s)},function(e){var t=JSON.parse(e);if(t&&t.d&&t.d.ValidateGroupName){var i=t.d.ValidateGroupName,r=i.DisplayNameErrorDetails?o(i.DisplayNameErrorDetails):void 0,n=i.AliasErrorDetails?o(i.AliasErrorDetails):void 0;return{isValidName:i.IsValidName,errorCode:i.ErrorCode,errorMessage:i.ErrorMessage,displayNameErrorDetails:r,aliasErrorDetails:n}}},"ValidateGroupName",void 0,"GET",void 0,void 0,3)};i.prototype._getUrl=function(e,t){return this._pageContext.webAbsoluteUrl+"/_api/"+t+"/"+e};i.prototype._extractSiteAlias=function(e){var t="";if(e&&0<e.length){var i=e.lastIndexOf("/")+1;if(-1!==i){i===e.length&&(i=(e=e.substr(0,e.length-1)).lastIndexOf("/")+1);var r=e.length-i;t=e.substr(i,r)}}return t};i.prototype._parseClassificationDescriptions=function(e){return e&&e.results?e.results.map(function(e,t){return{classificationTitle:e.Key,classificationDescription:e.Value}}):void 0};return i}(i.default);t.GroupSiteDataSource=c;t.default=c});define("Ie",["require","exports","ap","fB","V","aM"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){i.__extends(e,t);function e(e){return t.call(this,e,"SiteCreationDataSource",{cacheTimeoutTime:18e5})||this}e.prototype.checkSiteExists=function(e){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+n.format("/_api/SP.Site.Exists(url=@v)?@v='{0}'",o.default.encodeRestUriStringToken(e))},function(e){var t=JSON.parse(e);return t&&t.d&&t.d.Exists},"GetSiteExists",void 0,"GET",void 0,void 0,0)};return e}(r.default);t.SiteCreationDataSource=a;t.default=a});define("Ig",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.NotFound=0]="NotFound";e[e.Provisioning=1]="Provisioning";e[e.Ready=2]="Ready";e[e.Error=3]="Error"}(t.GroupSiteStatus||(t.GroupSiteStatus={}))});define("JG",["require","exports","ap","JH","JH"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=n.SitePermissionsPanel});define("JH",["require","exports","ap","JI"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("JI",["require","exports","ap","at","Du","JP","wN","wt","jP","Cv","Jx","Cu","o1","mh","a0","JN","bf","BT","Dz","eq","Cx","x6","cY","JM","JK","JJ"],function(e,t,a,V,q,r,W,z,n,j,K,o,J,$,s,l,Q,Z,X,Y,c,d,ee,te,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){a.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._resolveMenu=function(e){return t.menu=e};t._mailMessage="";t.state={showPanel:!0,isInvitePeopleContextualMenuVisible:!1,showShareSiteOnly:t.props.showShareSiteOnly,showSavingSpinner:!1,saveButtonDisabled:!1,shouldHidePermControl:!1,shouldSendEmail:!0,isPersonaSelected:!1};t._peoplePickerProvider=new c.PeoplePickerProvider({pageContext:t.props.pageContext});t._currentPicker=o.PeoplePickerType.listBelow;s.Engagement.logData({name:"SitePermissionsPanel.Opened.Click"});return t}e.prototype.render=function(){var i=this,e=this.props,t=e.showShareSiteOnly,r=e.shareSiteOnlyVerboseText,n=e.shareSiteOnlyAddMembersLinkText,o=e.goToOutlookOnClick,a=e.permissionLevelOfCurrentUser,s=e.shouldDismissPanel,l=e.shareSiteTitle,c=e.title,d=e.panelDescription,u=e.pageContext,p=e.onShareSiteCallback,m=e.menuItems,h=e.sitePermissions,f=e.advancedPermSettingsUrl,g=e.addUserOrGroupText,b=e.shouldLoadSharePanelOnly,_=e.sendEmailText,v=e.messagePlaceHolderText,y=e.saveButton,S=e.cancelButton,x=e.invitePeople,k=e.advancedPermSettings,C=e.sitePreviewLoader,P=e.isEmailSharingEnabled,I=e.pickerSettings,w=e.hasCustomizedGroups,T=this.state,L=T.showPanel,F=T.isInvitePeopleContextualMenuVisible,E=T.showSavingSpinner,D=T.shouldHidePermControl,M=T.shouldSendEmail,N=T.isPersonaSelected,O=T.peoplePickerError,A=T.peoplePickerWarnings,B=Y.isGroupWebContext(u),H=null;if(r&&-1!==r.indexOf("{0}")&&n&&o){var U=r.split("{0}");2===U.length&&(H=V.createElement("div",{className:"ms-SitePermPanel-PeoplePicker","data-automationid":"SitePermissionsPanelPeoplePicker"},V.createElement("span",null,U[0]),V.createElement($.Link,{className:"ms-SitePermPanel-Link",onClick:o,"data-automationid":"SitePermissionsPanelAddMemberLink"},n),V.createElement("span",null,U[1])))}var R,G=V.createElement($.Link,{href:f,target:"_blank",className:"ms-MessageBar-link","data-automationid":"SitePermissionsPanelAdvancedPermLink"},k);Q.Killswitch.isActivated("06357ED9-875B-4BED-A1AD-F7AA1A8E5B94")||(R=function(e){return i.renderPeoplePickerItemWithMenu(e)});return V.createElement(q.Panel,{className:"ms-SitePermPanel",isOpen:L&&!s,type:q.PanelType.smallFixedFar,onDismiss:this._closePanel,isLightDismiss:!0,headerText:t?l:c,forceFocusInsideTrap:!1},!t&&V.createElement("div",null,V.createElement("div",null,V.createElement("p",{className:"ms-sitePermPanel-TextArea","data-automationid":"SitePermissionsPanelDescription"},d),V.createElement("div",{className:"ms-sitePerm-ContextMenu"},(a===K.PermissionLevel.FullControl||a===K.PermissionLevel.Edit)&&V.createElement("div",{className:"ms-sitePermPanel-buttonArea",ref:this._resolveMenu},B?V.createElement(W.PrimaryButton,{className:"ms-sitePermPanel-itemBtn ms-sitePermPanel-invitePeopleButton",onClick:this._onClick,"data-automationid":"SitePermissionsPanelInviteButton"},x):V.createElement(W.PrimaryButton,{className:"ms-sitePermPanel-itemBtn ms-sitePermPanel-shareSiteButton",onClick:p,"data-automationid":"SitePermissionsPanelInviteButton"},l)),F&&V.createElement(z.ContextualMenu,{className:"ms-sitePermPanel-invitePeopleContextualMenu",items:m,isBeakVisible:!1,target:this.menu,directionalHint:4,onDismiss:this._onDismiss,gapSpace:0}))),V.createElement("div",null,void 0!==h?h.map(function(e,t){return i._getSitePermissions(e,t)}):void 0),f&&(a===K.PermissionLevel.FullControl||ee.PermissionMask.hasPermission(u.webPermMasks,ee.PermissionMask.managePermissions))&&V.createElement("div",{className:"ms-SitePermPanel-AdvancedPerm"},w?V.createElement("span",null,te.default.additionalGroupsDescription," ",G,te.default.period):G)),t&&I&&V.createElement("div",null,V.createElement("div",{onClick:this._removePermControl,className:"ms-SitePermPanel-PeoplePicker","data-automationid":"SitePermissionsPanelPeoplePicker"},V.createElement("div",{className:"ms-SitePermPanel-PeoplePicker"},g),H,V.createElement(j.PeoplePicker,{noResultsFoundText:" ",context:u,peoplePickerType:this._currentPicker,ref:function(e){e&&(i._peoplePicker=e)},onSelectedPersonasChange:this._onSelectedPeopleChange,onRenderItem:R,onSuggestionSelected:this._onSuggestionSelected,dataProvider:this._peoplePickerProvider,peoplePickerQueryParams:{allowEmailAddresses:!0,allowMultipleEntities:null,allUrlZones:null,enabledClaimProviders:null,forceClaims:null,groupID:0,maximumEntitySuggestions:30,principalSource:I.PrincipalSource,blockExternalUsers:!0,principalType:I.PrincipalAccountType,required:null,urlZone:null,urlZoneSpecified:null}}),O,!O&&A),V.createElement("div",null,b&&!D&&V.createElement("div",null,void 0!==h?h.map(function(e,t){return i._getSitePermissions(e,t)}):void 0),P&&N&&V.createElement("div",{className:"ms-SitePermPanel-ShareSiteEmail"},V.createElement(X.Checkbox,{className:"ms-SitePermPanel-ShareSiteEmail-checkbox",defaultChecked:M,label:_,onChange:this._onChangeSendEmail}),M&&V.createElement("div",null,V.createElement(Z.TextField,{className:"ms-SitePermPanel-ShareSiteEmail-message",multiline:!0,resizable:!1,placeholder:v,onChanged:function(e){return i._mailMessage=e}}),C))),V.createElement("div",null,V.createElement("span",{className:"ms-SitePermPanelButton-container"},V.createElement(W.PrimaryButton,{className:"ms-SitePermPanel-saveButton",disabled:!N,onClick:this._onSaveClick,"data-automationid":"SitePermissionsPanelSaveButton"},y)),V.createElement("span",{className:"ms-SitePermPanelButton-container"},V.createElement(W.DefaultButton,{className:"ms-SitePermPanel-cancelButton",onClick:this._onCancelClick,"data-automationid":"SitePermissionsPanelCancelButton"},S))),E&&V.createElement(J.Spinner,null)))};e.prototype._onChangeSendEmail=function(e){this.setState({shouldSendEmail:!this.state.shouldSendEmail})};e.prototype._removePermControl=function(e){this.setState({shouldHidePermControl:!0})};e.prototype.renderPeoplePickerItemWithMenu=function(r){var t,e=l.PeoplePickerItemWithMenu,i=this.props.sitePermissionsContextualMenuItems.map(function(e){return e.permissionLevel});t=r.item.permissionLevel?r.item.permissionLevel:this.props.addMemberDefaultPermissionLevel&&-1<i.indexOf(this.props.addMemberDefaultPermissionLevel)?this.props.addMemberDefaultPermissionLevel:-1<i.indexOf(K.PermissionLevel.Edit)?K.PermissionLevel.Edit:-1<i.indexOf(K.PermissionLevel.Read)?K.PermissionLevel.Read:K.PermissionLevel.FullControl;var n=this.props.permissionLevelOfCurrentUser===K.PermissionLevel.FullControl?this.props.sitePermissionsContextualMenuItems.filter(function(e){return e.permissionLevel!==t}):void 0,o=n?n.map(function(e){return a.__assign({},e,{onClick:function(e,t){var i=r.item;i.permissionLevel=t.permissionLevel;r.onItemChange(i,r.index)}})}):void 0;return V.createElement(e,a.__assign({},r,{menuTitle:this.props.permissionStrings[t],menuItems:o}))};e.prototype._getSitePermissions=function(e,t){return V.createElement(r.SitePermissions,a.__assign({},e))};e.prototype._closePanel=function(){this.setState({showPanel:!1});this.props.onDismiss&&this.props.onDismiss()};e.prototype._onClick=function(){this.setState({isInvitePeopleContextualMenuVisible:!this.state.isInvitePeopleContextualMenuVisible});s.Engagement.logData({name:"SitePermissionsPanel.InvitePeople.Click"})};e.prototype._onDismiss=function(e){this.setState({isInvitePeopleContextualMenuVisible:!1});e.stopPropagation();e.preventDefault()};e.prototype._onSaveClick=function(e){var t=this;this.setState({showSavingSpinner:!0,saveButtonDisabled:!0});if(this._peoplePicker.selectedPeople&&0<this._peoplePicker.selectedPeople.length){var i=this._peoplePicker.selectedPeople;this.props.onSave&&this.props.onSave(i,this.state.shouldSendEmail,this._mailMessage).done(function(e){t.setState({showSavingSpinner:!1,saveButtonDisabled:!1,showPanel:!t.props.shouldLoadSharePanelOnly&&t.state.showPanel});t._resetSharePanel()})}s.Engagement.logData({name:"SitePermissionsPanel.Save.Click"})};e.prototype._onCancelClick=function(e){if(this.props.onCancel){this._resetSharePanel();this.props.onCancel()}s.Engagement.logData({name:"SitePermissionsPanel.Cancel.Click"})};e.prototype._onSuggestionSelected=function(e){var t=this.props.pickerSettings,i={principalSource:t.PrincipalSource,principalType:t.PrincipalAccountType,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,forceResolve:!0};return this._peoplePickerProvider.resolve(e.userId,i).then(function(e){!e.email&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);return e})};e.prototype._onSelectedPeopleChange=function(e){var t,i,r,n=[],o=u.renderPickerError({selectedItems:e}),a=u.getOversharingExternalsWarning(e),s=u.getOversharingGroupsWarning(e);o&&(i=V.createElement(d.MessageBar,{className:"ms-SitePermPanel-PeoplePicker-error",messageBarType:d.MessageBarType.error},o));a&&n.push(V.createElement(d.MessageBar,{className:"ms-SitePermPanel-PeoplePicker-warning",messageBarType:d.MessageBarType.warning},a));s&&n.push(V.createElement(d.MessageBar,{className:"ms-SitePermPanel-PeoplePicker-warning",messageBarType:d.MessageBarType.warning},s));0<n.length&&(r=V.createElement("div",{className:"ms-SitePermPanel-PeoplePicker-warnings"},n));t=0<this._peoplePicker.selectedPeople.length&&!i;this.setState({isPersonaSelected:t,peoplePickerError:i,peoplePickerWarnings:r})};e.prototype._resetSharePanel=function(){this.setState({shouldSendEmail:!0,isPersonaSelected:!1,peoplePickerWarnings:void 0,peoplePickerError:void 0})};a.__decorate([n.autobind],e.prototype,"_onChangeSendEmail",null);a.__decorate([n.autobind],e.prototype,"_removePermControl",null);a.__decorate([n.autobind],e.prototype,"_closePanel",null);a.__decorate([n.autobind],e.prototype,"_onClick",null);a.__decorate([n.autobind],e.prototype,"_onDismiss",null);a.__decorate([n.autobind],e.prototype,"_onSaveClick",null);a.__decorate([n.autobind],e.prototype,"_onCancelClick",null);a.__decorate([n.autobind],e.prototype,"_onSuggestionSelected",null);a.__decorate([n.autobind],e.prototype,"_onSelectedPeopleChange",null);return e}(V.Component);t.SitePermissionsPanel=i});define("JP",["require","exports","ap","at","xA","JR","jP","o7","mo","JQ"],function(e,t,i,n,o,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i.state={isExpanded:!0};return i}e.prototype.render=function(){var r=this,e=this.props.title;return n.createElement("div",{className:"ms-sitePerm-body","data-automationid":"SitePermissionsBody"},n.createElement(l.FocusZone,{direction:l.FocusZoneDirection.vertical,isInnerZoneKeystroke:function(e){return e.which===s.getRTLSafeKeyCode(39)}},n.createElement("span",{className:"ms-sitePerm-itemBtn",onClick:this._onClick,"data-is-focusable":!0},n.createElement(c.Icon,{iconName:"ChevronDown",className:"ms-sitePerm-chevron"+(this.state.isExpanded?" is-expanded":"")}),n.createElement("span",{className:"ms-sitePerm-itemBtn-title","data-automationid":"SitePermissionsBodyButton"},e)),n.createElement("div",{className:"ms-sitePerm-personaContainer"},this.state.isExpanded&&this.props&&this.props.personas&&0<this.props.personas.length?this.props.personas.map(function(e,t){var i=r._getPersonaControl(e);return r._getPersona(i,e,t)}):this.state.isExpanded?n.createElement("div",{className:"ms-sitePerm-emptyGroupText"}," ",this.props.emptyGroupText," "):null)))};e.prototype._getPersonaControl=function(e){return n.createElement(o.Persona,{"data-is-focusable":!0,imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,primaryText:e.name,size:o.PersonaSize.small,hidePersonaDetails:!1,"data-automationid":"SitePermissionsPersonaControl"},n.createElement(a.SitePermissionsMenu,{menuItems:e.menuItems,title:this.props.title,permLevelTitle:this.props.permLevelTitle}))};e.prototype._getPersona=function(e,t,i){return n.createElement("div",{className:"ms-sitePerm-Persona",title:t.name,key:i+t.name,"data-automationid":"SitePermissionsPersona"},n.createElement("div",{className:"ms-sitePerm-personName","data-automationid":"SitePermissionsPersonaName"},e))};e.prototype._onClick=function(){this.setState({isExpanded:!this.state.isExpanded})};i.__decorate([s.autobind],e.prototype,"_onClick",null);return e}(n.Component);t.SitePermissions=r});define("JR",["require","exports","ap","at","wt","jP","o7","mo","JQ"],function(e,t,i,n,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._resolveMenu=function(e){return i.menu=e};i.state={isContextualMenuVisible:!1};return i}e.prototype.render=function(){return this.props.menuItems?n.createElement("div",{className:"ms-sitePerm-ContextMenuButton","data-automationid":"SitePermissionsPersonaContextMenuButton"},n.createElement(s.FocusZone,{direction:s.FocusZoneDirection.horizontal},n.createElement("div",{className:"ms-sitePerm-buttonArea",ref:this._resolveMenu},n.createElement("span",{className:"ms-sitePerm-linkText",onClick:this._onClick,"data-is-focusable":!0,role:"button","aria-haspopup":!0,"data-automationid":"SitePermissionsPersonaContextMenuButton"},this.props.permLevelTitle,n.createElement(l.Icon,{iconName:"ChevronDown",className:"ms-sitePermMenu-chevron"}))),this.state.isContextualMenuVisible&&n.createElement(o.ContextualMenu,{className:"ms-sitePerm-PersonaContextMenu",items:this.props.menuItems,isBeakVisible:!1,target:this.menu,directionalHint:4,onDismiss:this._onDismiss,gapSpace:0}))):n.createElement("div",{className:"ms-sitePerm-noButtonArea","data-automationid":"SitePermissionsNoButtonArea"},this.props.permLevelTitle)};e.prototype._onClick=function(){this.setState({isContextualMenuVisible:!this.state.isContextualMenuVisible})};e.prototype._onDismiss=function(e){this.setState({isContextualMenuVisible:!1});e.stopPropagation();e.preventDefault()};i.__decorate([a.autobind],e.prototype,"_onClick",null);i.__decorate([a.autobind],e.prototype,"_onDismiss",null);return e}(n.Component);t.SitePermissionsMenu=r});define("JQ",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-sitePerm-body{-ms-flex-positive:1;flex-grow:1}.ms-sitePerm-Title{font-weight:700}.ms-sitePerm-itemBtn{height:20px;width:32px;vertical-align:middle;text-align:center;padding:10px;border-radius:50%;vertical-align:top;display:table-row;cursor:pointer}[dir=ltr] .ms-sitePerm-itemBtn{margin-right:4px}[dir=rtl] .ms-sitePerm-itemBtn{margin-left:4px}.ms-sitePerm-itemBtn-title{position:relative}[dir=ltr] .ms-sitePerm-itemBtn-title{left:-12px}[dir=rtl] .ms-sitePerm-itemBtn-title{right:-12px}.ms-sitePerm-personName{white-space:nowrap;text-overflow:ellipsis}.ms-sitePerm-personName>div{margin-top:10px;margin-bottom:10px}.ms-Fabric .ms-sitePerm-personName>div::-moz-focus-inner{border:0}.ms-Fabric .ms-sitePerm-personName>div{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .ms-sitePerm-personName>div:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .ms-sitePerm-personName>div:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .ms-sitePerm-personName>div:focus:after{border-color:#37006e}}.ms-sitePerm-ContextMenu{position:relative}.ms-sitePerm-buttonArea{max-width:95px;max-height:40px;cursor:pointer;font-size:12px}.ms-sitePerm-noButtonArea{max-width:95px;max-height:40px;font-size:12px}.ms-sitePerm-linkText{width:100%}.ms-sitePerm-chevron{position:relative;line-height:20px;font-size:12px;transition:transform .1s linear}[dir=ltr] .ms-sitePerm-chevron{left:-27px}[dir=rtl] .ms-sitePerm-chevron{right:-27px}.ms-sitePermMenu-chevron{line-height:20px;font-size:12px;transition:transform .1s linear}[dir=ltr] .ms-sitePermMenu-chevron{left:15px}[dir=rtl] .ms-sitePermMenu-chevron{right:15px}[dir=ltr] .ms-sitePermMenu-chevron{margin-left:10px}[dir=rtl] .ms-sitePermMenu-chevron{margin-right:10px}.ms-sitePerm-chevron.is-expanded{transform:rotate(-180deg)}.ms-sitePerm-personaContainer{margin-bottom:20px}.ms-sitePerm-emptyGroupText{color:#666}.ms-sitePerm-Persona{height:32px;width:32px;vertical-align:middle;text-align:center;padding:10px;border-radius:50%;vertical-align:top;display:table-row}[dir=ltr] .ms-sitePerm-Persona{margin-right:4px}[dir=rtl] .ms-sitePerm-Persona{margin-left:4px}.ms-sitePerm-Persona .ms-Persona.ms-Persona--sm{line-height:20px}.ms-sitePerm-Persona .ms-Persona-secondaryText{display:none}"}])});define("Jx",["require","exports","ap","JC","jP","aC","a0","V","cY","Jy"],function(e,t,i,r,n,s,o,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d;!function(e){e[e.Limited=0]="Limited";e[e.FullControl=1]="FullControl";e[e.Edit=2]="Edit";e[e.Read=3]="Read"}(d=t.PermissionLevel||(t.PermissionLevel={}));var u,p,m=((u={})[d.Limited]="Limited",u[d.FullControl]="FullControl",u[d.Edit]="Edit",u[d.Read]="Read",u),h=((p={})[1]=d.Limited,p[2]=d.Read,p[3]=d.Edit,p[4]=d.Edit,p[6]=d.Edit,p[5]=d.FullControl,p),f=function(){function e(e){this._permissionGroups={};this._params=e;this._pageContext=e.pageContext;this._sitePermissionsProvider=new r.SitePermissionsProvider(this._params.pageContext);this._sitePermissionsDataSource=new r.SitePermissionsDataSource(this._params.pageContext);this._permissionLevelOfCurrentUser=this._getPermissionLevelOfCurrentUser();this.setPropsState(this._sitePermissionsProvider)}e.prototype.componentDidMount=function(){var e=this,t=[];this._sharingSiteProvider||(this._sharingSiteProvider=new c.SharingSiteProvider({pageContext:this._pageContext}));t.push(this._getPickerSettings());t.push(this._checkCustomizedGroup());s.default.all(t).then(function(){e._params.sitePermissionsPanelContainer.setState({pickerSettings:e._pickerSettings,hasCustomizedGroups:e._hasCustomizedGroups})})};e.prototype.componentWillUnmount=function(){};e.prototype.getRenderProps=function(){var e,t=this._params,i=t.sitePermissionsPanelContainer.state,r=((e={})[d.Edit]=this._params.edit,e[d.FullControl]=this._params.fullControl,e[d.Read]=this._params.read,e);return{title:null!==i?i.title:t.title,sitePermissions:null!==i?i.sitePermissions:void 0,panelDescription:this._params.panelDescription,invitePeople:this._params.invitePeople,showShareSiteOnly:null!==i&&i.showShareSiteOnly,showSavingSpinner:null!==i&&i.showSavingSpinner,menuItems:this._getPanelAddMenu(),pageContext:this._pageContext,onSave:this._shareSite,onCancel:this._onCancel,saveButton:this._params.saveButton,cancelButton:this._params.cancelButton,shareSiteOnlyDescription:this._params.shareSiteOnlyDescription,addUserOrGroupText:this._params.addUserOrGroupText,advancedPermSettings:this._params.advancedPermSettings,advancedPermSettingsUrl:this._params.advancedPermSettingsUrl,goToOutlookLink:this._params.goToOutlookLink,goToOutlookText:this._params.goToOutlookText,manageSitePermissions:this._params.manageSitePermissions,closeButton:this._params.closeButton,permissionStrings:r,sitePermissionsContextualMenuItems:this._getSitePermissionsContextualMenuItems(),shareSiteOnlyVerboseText:this._params.shareSiteOnlyVerboseText,shareSiteOnlyAddMembersLinkText:this._params.shareSiteOnlyAddMembersLinkText,goToOutlookOnClick:this._params.goToOutlookOnClick,shareSiteTitle:this._params.shareSiteTitle,addMemberDefaultPermissionLevel:this._params.addMemberDefaultPermissionLevel,sitePreviewLoader:this._params.sitePreviewLoader,shouldDismissPanel:i&&i.shouldDismissPanel,shouldLoadSharePanelOnly:this._params.shouldLoadSharePanelOnly,sendEmailText:this._params.sendEmailText,messagePlaceHolderText:this._params.messagePlaceHolderText,onShareSiteCallback:this._shareSiteOnlyOnClick.bind(this),permissionLevelOfCurrentUser:this._permissionLevelOfCurrentUser,isEmailSharingEnabled:this._params.isEmailSharingEnabled,pickerSettings:i&&i.pickerSettings,hasCustomizedGroups:i&&i.hasCustomizedGroups}};e.prototype.setState=function(e){this._params.sitePermissionsPanelContainer.setState(e)};e.prototype.setPropsState=function(e){var r,n=this;r=[];this._sitePermissionsProvider.getSiteGroupsAndUsersWithPermissions().done(function(e){if(e&&0<e.length){e.forEach(function(e){var t=h[e.roleType];n._permissionGroups[t]=e.id});e.forEach(function(e){var t=n.getPersona(e),i=h[e.roleType];r.push({personas:t,title:n._getTitle(e),permLevel:i,permLevelTitle:n._getPermLevel(i),emptyGroupText:n._params.emptyGroupText})});n._params.sitePermissionsPanelContainer.setState({title:n._params.title,sitePermissions:r,menuItems:n._getPanelAddMenu()})}})};e.prototype.getPersona=function(e){var t;t=[];if(e.users&&0<e.users.length)for(var i=0;i<e.users.length;i++){var r=e.users[i];"SHAREPOINT\\system"!==r.loginName&&t.push({name:this._getUserTitle(r),imageUrl:r.urlImage,initialsColor:r.initialsColor,imageInitials:r.imageInitials,menuItems:this._isGroupClaimOwner(r.loginName)||this._permissionLevelOfCurrentUser!==d.FullControl&&(this._permissionLevelOfCurrentUser!==d.Edit||h[r.roleType]!==d.Edit)?void 0:this.getUserPermissions(r,e)})}return t};e.prototype.getUserPermissions=function(t,i){var r=this,e=this._getSitePermissionsContextualMenuItems().filter(function(e){return e.permissionLevel!==h[i.roleType]});e.forEach(function(e){e.onClick=function(){return r._updatePerm(t,e.permissionLevel)}});this._isGroupClaim(t.loginName)||e.push({name:this._params.remove,key:"remove",onClick:function(e){r._removePerm(t)}});return e};e.prototype._getSitePermissionsContextualMenuItems=function(){var t=this,e=[],i=[{name:this._params.read,key:"read",permissionLevel:d.Read},{name:this._params.fullControl,key:"full",permissionLevel:d.FullControl},{name:this._params.edit,key:"edit",permissionLevel:d.Edit}];this._permissionLevelOfCurrentUser===d.FullControl?e=i.filter(function(e){return t._permissionGroups[e.permissionLevel]}):this._permissionLevelOfCurrentUser===d.Edit?e=i.filter(function(e){return t._permissionGroups[e.permissionLevel]&&e.permissionLevel===d.Edit}):this._permissionLevelOfCurrentUser===d.Read&&(e=i.filter(function(e){return t._permissionGroups[e.permissionLevel]&&e.permissionLevel===d.Read}));return e};e.prototype._updatePerm=function(e,t){var i=this,r=this._permissionGroups[t];this._sitePermissionsDataSource.addUserToGroup(r,e.loginName).then(function(){i._sitePermissionsDataSource.removeFromGroupById(e.principalId.toString(),e.id.toString()).then(function(){i.setPropsState(i._sitePermissionsProvider)})});o.Engagement.logData({name:"SitePermissionsPanel.UpdatePermTo"+m[t]})};e.prototype._shareSite=function(e,t,i){var r=this,n=this._assignUsersToPermssionGroup(e),o=[];this._sharingSiteProvider||(this._sharingSiteProvider=new c.SharingSiteProvider({pageContext:this._pageContext}));for(var a in n)n[a]&&0<n[a].length&&o.push(this._sharingSiteProvider.shareSite(n[a],{siteUrl:this._pageContext.webAbsoluteUrl,roleValue:"group:"+this._permissionGroups[a],sendEmail:this._params.isEmailSharingEnabled&&t,message:i,requireSignIn:!0}));return s.default.all(o).then(function(e){r._params.shouldLoadSharePanelOnly?r.setState({showShareSiteOnly:!0}):r.setState({showShareSiteOnly:!1});r.setPropsState(r._sitePermissionsProvider);return!0})};e.prototype._onCancel=function(){this._params.shouldLoadSharePanelOnly?this.setState({shouldDismissPanel:!0}):this.setState({showShareSiteOnly:!1});this.setPropsState(this._sitePermissionsProvider)};e.prototype._removePerm=function(e){var t=this;this._sitePermissionsDataSource.removeFromGroupById(e.principalId.toString(),e.id.toString()).then(function(){t.setPropsState(t._sitePermissionsProvider)})};e.prototype._getTitle=function(e){switch(h[e.roleType]){case d.FullControl:return this._params.siteOwners?this._params.siteOwners:this._params.fullControl;case d.Edit:return this._params.siteMembers?this._params.siteMembers:this._params.edit;case d.Read:return this._params.siteVisitors?this._params.siteVisitors:this._params.read;default:return""}};e.prototype._getUserTitle=function(e){return this._isGroupClaim(e.loginName)?this._isGroupClaimOwner(e.loginName)?a.format(this._params.groupOwners,e.title):a.format(this._params.groupMembers,e.title):e.title};e.prototype._isGroupClaim=function(e){return e&&-1!==e.indexOf("federateddirectoryclaimprovider")&&-1!==e.indexOf(this._pageContext.groupId)};e.prototype._isGroupClaimOwner=function(e){return this._isGroupClaim(e)&&-1!==e.indexOf("_o")};e.prototype._getPanelAddMenu=function(){var t=this,e=[];this._params.addMembersToGroup&&this._pageContext.groupId&&e.push({name:this._params.addMembersToGroup,key:"addToGroup",onClick:function(e){t._goToOutlookClick()}});this._params.shareSiteOnly&&e.push({name:this._params.shareSiteOnly,key:"shareSiteOnly",onClick:function(e){t._shareSiteOnlyOnClick()}});return e};e.prototype._shareSiteOnlyOnClick=function(){o.Engagement.logData({name:"SitePermissions.ShareSiteOnlyClick"});this.setState({showShareSiteOnly:!this._params.sitePermissionsPanelContainer.state.showShareSiteOnly,showSavingSpinner:!1})};e.prototype._goToOutlookClick=function(){o.Engagement.logData({name:"SitePermissions.GoToOutlookClick"});this._params.goToOutlookOnClick()};e.prototype._getPermLevel=function(e){switch(e){case d.FullControl:return this._params.fullControl;case d.Edit:return this._params.edit;case d.Read:return this._params.read;default:return""}};e.prototype._getPermissionLevelOfCurrentUser=function(){var e,t=l.PermissionMask.hasPermission(this._pageContext.webPermMasks,l.PermissionMask.manageWeb),i=l.PermissionMask.hasPermission(this._pageContext.webPermMasks,l.PermissionMask.editListItems),r=l.PermissionMask.hasPermission(this._pageContext.webPermMasks,l.PermissionMask.viewPages);t?e=d.FullControl:i?e=d.Edit:r&&(e=d.Read);return e};e.prototype._assignUsersToPermssionGroup=function(e){var t,n=this,o=((t={})[d.FullControl]=[],t[d.Edit]=[],t[d.Read]=[],t);e.map(function(e){var t=n._params.addMemberDefaultPermissionLevel,i=n._getSitePermissionsContextualMenuItems().map(function(e){return e.permissionLevel}),r=e.permissionLevel;r||(r=n._params.addMemberDefaultPermissionLevel&&n._permissionGroups[t]&&-1<i.indexOf(t)?t:n._permissionGroups[d.Edit]&&-1<i.indexOf(d.Edit)?d.Edit:n._permissionGroups[d.Read]&&-1<i.indexOf(d.Read)?d.Read:d.FullControl);switch(r){case d.FullControl:o[d.FullControl].push(e);break;case d.Edit:o[d.Edit].push(e);break;case d.Read:o[d.Read].push(e)}});return o};e.prototype._getPickerSettings=function(){var t=this;return this._sharingSiteProvider.getSharingSettings().then(function(e){t._pickerSettings=e.pickerProperties}).catch(function(e){t._pickerSettings=void 0})};e.prototype._checkCustomizedGroup=function(){var t=this;return this._sitePermissionsProvider.getSiteGroupsAndUsers(!0).then(function(e){t._hasCustomizedGroups=3<e.length}).catch(function(e){t._hasCustomizedGroups=!1})};i.__decorate([n.autobind],e.prototype,"_shareSite",null);i.__decorate([n.autobind],e.prototype,"_onCancel",null);i.__decorate([n.autobind],e.prototype,"_goToOutlookClick",null);return e}();t.SitePermissionsPanelStateManager=f;t.default=f});define("JC",["require","exports","ap","JF","JE","hb","JD"],function(e,t,i,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(o,t);i.__exportStar(a,t)});define("JF",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Guest=1]="Guest";e[e.Reader=2]="Reader";e[e.Contributor=3]="Contributor";e[e.WebDesigner=4]="WebDesigner";e[e.Administrator=5]="Administrator";e[e.Edit=6]="Edit";e[e.System=255]="System"}(t.RoleType||(t.RoleType={}))});define("JE",["require","exports","ap","ef","eq","V"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="$expand=Users";!function(e){e[e.Owners=0]="Owners";e[e.Members=1]="Members";e[e.Vistors=2]="Vistors"}(t.AssociatedPermGroups||(t.AssociatedPermGroups={}));var s=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDataSourceName=function(){return"SitePermissionsDataSource"};t.prototype.getSiteGroupsAndUsers=function(e){var t=this,i=e?"":"?"+a;return this.getData(function(){return t._getUrl("web/SiteGroups"+i)},function(e){return t._parseSiteGroupsAndUsers(e)},"GetSiteGroupsAndUsers",void 0,"GET")};t.prototype.getSiteGroupAndUsersById=function(e){var t=this;return this.getData(function(){return t._getUrl("web/SiteGroups/GetById(id="+e+")?"+a)},function(e){return t._parseSiteGroupAndUsers(e)},"GetSiteGroupAndUsersById",void 0,"GET")};t.prototype.associatedPermissionGroups=function(){var t=this;return this.getData(function(){return n.getSafeWebServerRelativeUrl(t._pageContext)+"/_api/web?$expand=AssociatedOwnerGroup,AssociatedMemberGroup,AssociatedVisitorGroup"},function(e){return t._parseAssociatedPermissionGroups(e)},"associatedPermissionGroups",void 0,"GET")};t.prototype.addRoleAssignment=function(e,t){var i=this;return this.getData(function(){return i._getUrl(o.format("web/RoleAssignments/addroleassignment(principalid={0},roledefid={1})",e,t))},void 0,"AddRoleAssignment",void 0,"POST",void 0,void 0,3)};t.prototype.removeRoleAssignment=function(e,t){var i=this;return this.getData(function(){return i._getUrl(o.format("web/RoleAssignments/removeroleassignment(principalid={0},roledefid={1})",e,t))},void 0,"RemoveRoleAssignment",void 0,"POST",void 0,void 0,3)};t.prototype.addUserToGroup=function(e,t){var i=this,r={__metadata:{type:"SP.User"},LoginName:t};return this.getData(function(){return i._getUrl(o.format("web/sitegroups(id={0})/users",e))},void 0,"addToGroupById",function(){return JSON.stringify(r)},"POST",void 0,void 0,3)};t.prototype.removeFromGroupById=function(e,t){var i=this;return this.getData(function(){return i._getUrl(o.format("web/sitegroups(id={0})/users/removebyid(id={1})",e,t))},void 0,"removeFromGroupById",void 0,"POST",void 0,void 0,3)};t.prototype._parseSiteGroupsAndUsers=function(e){var t=this,i=JSON.parse(e);return i&&i.d&&i.d.results&&0<i.d.results.length?i.d.results.map(function(e){return t._parseSPUser(e)}):e};t.prototype._parseSiteGroupAndUsers=function(e){var t=JSON.parse(e);return t&&t.d?this._parseSPUser(t.d):void 0};t.prototype._parseSPUser=function(t){var i=this;return{id:t.Id,loginName:t.LoginName,principalType:t.PrincipalType,title:t.Title,allowMembersEditMembership:t.AllowMembersEditMembership,allowRequestToJoinLeave:t.AllowRequestToJoinLeave,autoAcceptRequestToJoinLeave:t.AutoAcceptRequestToJoinLeave,description:t.Description,users:t.Users&&t.Users.results&&0<t.Users.results.length?t.Users.results.map(function(e){return{id:e.Id,principalId:t.Id,loginName:e.LoginName,isSiteAdmin:e.IsSiteAdmin,principalType:e.PrincipalType,title:e.Title,urlImage:i._fixUserImage(e)}}):void 0}};t.prototype._parseAssociatedPermissionGroups=function(e){var t=JSON.parse(e),i={};if(t&&t.d&&t.d.AssociatedMemberGroup&&t.d.AssociatedOwnerGroup&&t.d.AssociatedVisitorGroup){this._addGroupToDictionary(i,t.d.AssociatedMemberGroup,6,1);this._addGroupToDictionary(i,t.d.AssociatedOwnerGroup,5,0);this._addGroupToDictionary(i,t.d.AssociatedVisitorGroup,2,2)}return i};t.prototype._addGroupToDictionary=function(e,t,i,r){e[r]={id:t.Id,loginName:t.LoginName,principalType:t.PrincipalType,title:t.Title,roleType:i}};t.prototype._fixUserImage=function(e){if(1===e.PrincipalType&&e.Email)return o.format("/_layouts/15/userphoto.aspx?size=S&accountname={0}",e.Email)};t.prototype._getUrl=function(e){return this._pageContext.webAbsoluteUrl+"/_api/"+e};return t}(r.default);t.SitePermissionsDataSource=s;t.default=s});define("JD",["require","exports","JE","vN","aC"],function(e,t,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._context=e;this._dataSource=new i.SitePermissionsDataSource(this._context);this._siteHeaderLogoAcronymDataSource=new n.default(this._context)}e.prototype.getSiteGroupsAndUsersWithPermissions=function(){var n=this,o=[];return this._dataSource.associatedPermissionGroups().then(function(i){if(i){var r=[],e=function(e){var t=n._dataSource.getSiteGroupAndUsersById(i[e].id).then(function(t){t.roleType=i[e].roleType;t.users&&0<t.users.length&&t.users.forEach(function(e){e.roleType=t.roleType});o[e]=t});r.push(t)};for(var t in i)e(t);return a.default.all(r).then(function(){return n._fixUsersImage(o)})}return a.default.resolve(void 0)})};e.prototype.getSiteGroupsAndUsers=function(e){return this._dataSource.getSiteGroupsAndUsers(e)};e.prototype._fixUsersImage=function(i){var r=[];if(i&&0<i.length){i.forEach(function(e){e.users&&0<e.users.length&&e.users.forEach(function(e){e.urlImage||r.push(e)})});if(r&&0<r.length)return this._siteHeaderLogoAcronymDataSource.getAcronyms(r.map(function(e){return e.title})).then(function(e){if(e&&0<e.length)for(var t=0;t<e.length;t++){r[t].imageInitials=e[t].acronym;r[t].initialsColor=n.default.decodeAcronymColor(e[t].color)}return i},function(){return i})}return a.default.resolve(i)};return e}();t.SitePermissionsProvider=r;t.default=r});define("Jy",["require","exports","ap","hf","JA","ho","hq","hp","hn","he","Jz"],function(e,t,i,r,n,o,a,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(o,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t);i.__exportStar(c,t);i.__exportStar(d,t)});define("JA",["require","exports","JB"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._dataSource=e.sharingSiteDataSource||new i.SharingSiteDataSource(e.pageContext)}e.prototype.getSharingSettings=function(){return this._dataSource.getSharingSettings()};e.prototype.shareSite=function(e,t){return this._dataSource.shareSite(e,t)};return e}();t.SharingSiteProvider=r});define("JB",["require","exports","ap","ef","eq"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){i.__extends(a,r);function a(e){var t=r.call(this,e)||this;t._pageContext=e;var i=n.getSafeWebServerRelativeUrl(t._pageContext);t._getSharingSettingsUrl=i+"/_api/SP.Web.GetObjectSharingSettings?$expand=ObjectSharingInformation,SharePointSettings/PickerProperties";t._shareUrl=i+"/_api/SP.Web.ShareObject";return t}a.prototype.getSharingSettings=function(){var t=this;return this._getSharingSettingsRawResponse().then(function(e){return t._parseSettings(e)},function(e){return t._parseError(e)})};a.prototype.shareSite=function(n,o){var e=this;return this.getData(function(){return e._shareUrl},function(e){var t=JSON.parse(e).d,i=[];t.UniquelyPermissionedUsers&&t.UniquelyPermissionedUsers.results&&(i=t.UniquelyPermissionedUsers.results);var r=[];t.InvitedUsers&&t.InvitedUsers.results&&(r=t.InvitedUsers.results);var n={};n.statusCode=t.StatusCode;n.errorMessage=t.ErrorMessage;n.people=a._parsePeople(i,o.siteUrl);n.invitedUsers=a._parsePeople(r,o.siteUrl);return n},"ShareSite",function(){for(var e=[],t=0;t<n.length;t++){var i=n[t];e.push(i.rawPersonData)}o.roleValue===2..toString()?o.roleValue="role:1073741827":o.roleValue===1..toString()?o.roleValue="role:1073741826":o.roleValue===(0).toString()&&(o.roleValue="role:1073741829");var r={url:o.siteUrl,peoplePickerInput:JSON.stringify(e),roleValue:o.roleValue,groupId:o.groupId,sendEmail:o.sendEmail,emailBody:o.message,includeAnonymousLinkInEmail:!o.requireSignIn,propagateAcl:o.propagateSharing,useSimplifiedRoles:!0};return JSON.stringify(r)})};a.prototype.getDataSourceName=function(){return"SharingSiteDataSource"};a.prototype._getSharingSettingsRawResponse=function(){var e=this,t={useSimplifiedRoles:!0};t.objectUrl=this._pageContext.webAbsoluteUrl;return this.getData(function(){return e._getSharingSettingsUrl},function(e){return JSON.parse(e).d},"SP.Web.GetObjectSharingSettings",function(){return JSON.stringify(t)},"POST",null,null,null,!0)};a._parsePeople=function(e,i){return e.map(function(e){var t={siteUrl:i,role:a._parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:t}})};a._parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;default:return 1}};a.prototype._parseError=function(e){var t={};t.sharingApiErrorMessage=e.message.value;return t};a.prototype._parseSettings=function(e){var t={};t.canSendEmail=e.canSendEmail;t.pickerProperties={};t.itemUrl=e.itemUrl;t.mailSettings={defaultCharacterLimit:500};t.itemId=e.ItemId;t.itemName=e.ItemName;t.canManagePermissions=e.ObjectSharingInformation.CanManagePermissions;t.canSendEmail=e.CanSendEmail;t.pickerProperties={};t.supportsSharingPropagation=e.SupportsAclPropagation;t.showAdditionalExternalWarning=e.ShowExternalSharingWarning;t.sharedWithMany=e.ObjectSharingInformation.IsSharedWithSecurityGroup||e.ObjectSharingInformation.IsSharedWithMany;t.blockPeoplePickerAndSharing=e.BlockPeoplePickerAndSharing;t.canCurrentUserShareExternally=e.CanCurrentUserShareExternally;e.SharePointSettings&&e.SharePointSettings.PickerProperties&&this._setPickerProperties(e.SharePointSettings.PickerProperties,e.SharePointSettings.PickerProperties.PrincipalAccountType,t);var i=[];if(e.SimplifiedRoles&&e.SimplifiedRoles.results)for(var r=0;r<e.SimplifiedRoles.results.length;r++){var n={};n.name=e.SimplifiedRoles.results[r].Key;n.value=e.SimplifiedRoles.results[r].Value;i.push(n)}t.sharingRoles=i;t.showAdvanced=t.canManagePermissions;return t};a.prototype._setPickerProperties=function(e,t,i){i.pickerProperties=e;i.pickerProperties.PrincipalAccountType=this._convertPrincipalType(t)};a.prototype._convertPrincipalType=function(e){if(!e)return 0;for(var t=0,i=0,r=e.split(",");i<r.length;i++){var n=r[i];"User"===n?t|=1:"DL"===n?t|=2:"SecGroup"===n?t|=4:"SPGroup"===n&&(t|=8)}return t};return a}(r.default);t.SharingSiteDataSource=o;t.default=o});define("Jz",["require","exports","he"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._dataSource=e.sharingDataSource||new i.SharingDataSource({getParentListId:e.getParentListId,pageContext:e.pageContext});this._itemProvider=e.itemProvider}e.prototype.getSharingInformation=function(e,t){return this._dataSource.getSharingInformation(e,t)};e.prototype.shareLink=function(t){var i=this;return this._dataSource.shareLink(t).then(function(e){i._invalidateItem(t.items[0]);return e})};e.prototype.unshareLink=function(t){var i=this;return this._dataSource.unshareLink(t).then(function(e){i._invalidateItem(t.item);return e})};e.prototype.updatePermissions2=function(e,t,i){var r=this;return this._dataSource.updatePermissions2(e,t,i).then(function(e){r._invalidateItem(t);return e})};e.prototype.getClientId=function(){return this._dataSource.getClientId()};e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};e.prototype.emailWithoutPermissioning=function(e,t,i){return this._dataSource.emailWithoutPermissioning(e,t,i).then(function(e){return e})};e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};e.prototype.share=function(e,t,i){return this._dataSource.share(e,t).then(function(e){return e})};e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};return e}();t.SharingProvider=r});define("JN",["require","exports","ap","at","xA","jP","mo","wN","wt","o7","JO"],function(e,t,a,s,l,c,d,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){a.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isContextualMenuVisible:!1};return t}e.prototype.render=function(){var e=this.props,t=e.item,i=e.onRemoveItem,r=e.index,n=e.selected,o=this._convertIPersonToIPersonaProps(t);return s.createElement("div",{className:c.css("ms-PickerPersonaMenu-container",{"is-selected":n}),"data-selection-index":r,key:r,"data-is-focusable":!0},s.createElement(m.FocusZone,{className:"ms-PickerPersona-item"},s.createElement("div",{className:"ms-PickerPersona-content"},s.createElement(l.Persona,a.__assign({},o,{presence:l.PersonaPresence.none,size:l.PersonaSize.small,secondaryText:this.props.menuTitle&&!this.props.menuItems?this.props.menuTitle:void 0}),this.props.menuTitle&&this.props.menuItems&&s.createElement("div",{className:"ms-sitePerm-ContextMenu"},s.createElement("div",{className:"ms-sitePerm-buttonArea",ref:this._resolveRef("_buttonTarget")},s.createElement("span",{className:"ms-sitePerm-linkText",onClick:this._onClick,"data-is-focusable":!0,role:"button","aria-haspopup":!0},this.props.menuTitle,s.createElement(d.Icon,{iconName:"ChevronDown",className:"ms-sitePermMenu-chevron"}))),this.state.isContextualMenuVisible&&s.createElement(p.ContextualMenu,{items:this.props.menuItems,isBeakVisible:!1,target:this._buttonTarget,directionalHint:4,onDismiss:this._onDismiss,gapSpace:0})))),s.createElement("div",{className:"ms-PickerItem-sideContent"},s.createElement(u.IconButton,{onClick:function(){i&&i()},iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content"}))))};e.prototype._onClick=function(){this.setState({isContextualMenuVisible:!this.state.isContextualMenuVisible})};e.prototype._onDismiss=function(e){this.setState({isContextualMenuVisible:!1});e.stopPropagation();e.preventDefault()};e.prototype._convertIPersonToIPersonaProps=function(e){return{primaryText:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:""}};a.__decorate([c.autobind],e.prototype,"_onClick",null);a.__decorate([c.autobind],e.prototype,"_onDismiss",null);return e}(c.BaseComponent);t.PeoplePickerItemWithMenu=i});define("JO",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-PickerPersonaMenu-container{cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-top:10px}.ms-PickerPersonaMenu-container .ms-PickerPersona-item{width:100%;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;margin:1px;white-space:nowrap;-ms-flex-align:center;align-items:center}.ms-PickerPersonaMenu-container .ms-PickerPersona-item:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ms-PickerPersonaMenu-container .ms-PickerPersona-item .ms-PickerItem-sideContent{-ms-flex-positive:0;flex-grow:0;display:inline-block}.ms-PickerPersonaMenu-container .ms-PickerPersona-item .ms-PickerPersona-content{-ms-flex-positive:1;flex-grow:1;vertical-align:middle;min-width:50px}.ms-PickerPersonaMenu-container .ms-PickerPersona-item .ms-PickerPersona-content .ms-Persona{height:auto}.ms-PickerPersonaMenu-container .ms-PickerPersona-item .ms-PickerPersona-content .ms-sitePerm-ContextMenu{line-height:0}.ms-PickerPersonaMenu-container .ms-PickerPersona-item .ms-Persona-primaryText{margin-bottom:2px}"}])});define("JK",["require","exports","at","V","mh","JL","hb"],function(e,t,m,s,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getExternalPeopleCount=function(e){return e&&0!==e.length?e.filter(function(e){return 1===e.entityType}).length:0};t.getOversharingExternalsWarning=function(e){var t=e.filter(function(e){return 1===e.entityType}),i=t.length,r=t.map(function(e){return e.name});if(2===i){var n=(a=r.join(", ")).lastIndexOf(","),o=a.substring(0,n)+" "+f.default.and+" "+a.substring(n+1);return s.format(f.default.outsideOfYourOrgPlural,o)}if(2<i){var a;n=(a=r.join(", ")).lastIndexOf(","),o=a.substring(0,n+1)+" "+f.default.and+" "+a.substring(n+1);return s.format(f.default.outsideOfYourOrgPlural,o)}return 1===i?s.format(f.default.outsideOfYourOrgSingular,r[0]):""};t.getOversharingGroupsWarning=function(e,t){var i=e.filter(function(e){return 2===e.entityType}).length,r="";1===i?r=f.default.oneGroupInvited:1<i&&(r=s.format(f.default.multipleGroupsInvited,i));1e3<=t?r+=" "+f.default.groupsMemberCountLargeLabel:25<=t&&(r+=" "+s.format(f.default.groupsMemberCountLabel,t));return r};t.renderPickerError=function(e){for(var t=e.selectedItems,i=e.sharingLinkKind,r=e.canAddExternalPrincipal,n=e.hasDlpPolicyTip,o=e.viewPolicyTipCallback,a=e.permissionsMap,s=0,l=t;s<l.length;s++){var c=l[s];if(!c.isResolved)return n&&!r?m.createElement("div",null,m.createElement("span",null,f.default.PolicyTipNotifyAndBlock," "),m.createElement(h.Link,{onClick:o},f.default.ViewPolicyTip)):c.rawData?c.rawData.Description:m.createElement("span",null,f.default.noExactMatch);if(c.isExternal&&c.principalType===g.default.distributionList&&2===c.entityType)return m.createElement("span",null,f.default.peoplePickerErrorDLNotSupported);var d=3===i||2===i;if(c.isExternal&&d)return m.createElement("span",null,f.default.peoplePickerErrorCsl)}if(a&&1===i){var u=0;for(var p in a)1===a[p]&&u++;if(1===u)return m.createElement("span",null,f.default.insufficientPermissionsError);if(1<u)return m.createElement("span",null,f.default.insufficientPermissionsErrorPlural)}return null}});define("JJ",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-Button.ms-Button--primary.ms-sitePermPanel-itemBtn{bottom:10px}.ms-sitePermPanel-buttonArea{max-width:150px;max-height:40px;margin-bottom:10px}.ms-SitePermPanel-PeoplePicker{margin-bottom:20px}.ms-SitePermPanel-Link{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;display:inline-block}.ms-Fabric .ms-SitePermPanel-Link::-moz-focus-inner{border:0}.ms-Fabric .ms-SitePermPanel-Link{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .ms-SitePermPanel-Link:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .ms-SitePermPanel-Link:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .ms-SitePermPanel-Link:focus:after{border-color:#37006e}}.ms-SitePermPanel-Link.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.ms-SitePermPanel-Link:focus,.ms-SitePermPanel-Link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.ms-SitePermPanel-Link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-sitePermPanel-TextArea{margin-bottom:20px}.ms-SitePermPanel-AdvancedPerm{padding-top:20px;padding-bottom:40px}.ms-SitePermPanelButton-container{padding:0 4px}.ms-SitePermPanel{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.ms-SitePermPanel .ms-Panel-content{padding-left:40px;padding-right:40px;-ms-flex-positive:1;flex-grow:1}.ms-SitePermPanel-ShareSiteEmail{margin-bottom:30px}.ms-SitePermPanel-ShareSiteEmail-checkbox{margin-bottom:8px}.ms-SitePermPanel-PeoplePicker-error,.ms-SitePermPanel-PeoplePicker-warning{margin-top:8px}"}])});define("Jv",["require","exports","ap","at","JG","Jx","Jx","Jw","iE","bX","eq"],function(e,t,i,n,o,a,s,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t._resources=e.hostModel.resources;t._pageContext=t._resources.consume(c.pageContext);var i=u.isGroupWebContext(t._pageContext);t._state=new a.default({sitePermissionsPanelContainer:t,pageContext:t._pageContext,title:l.strings.title,fullControl:l.strings.fullControl,edit:l.strings.edit,read:l.strings.read,remove:l.strings.remove,panelDescription:l.strings.panelDescription,addMembersToGroup:i&&l.strings.addMembersToGroup,shareSiteOnly:l.strings.shareSiteOnly,invitePeople:l.strings.invitePeople,groupOwners:l.strings.groupOwners,groupMembers:l.strings.groupMembers,saveButton:l.strings.addButton,cancelButton:l.strings.cancelButton,addUserOrGroupText:l.strings.addUserOrGroupText,shareSiteOnlyDescription:l.strings.shareSiteOnlyDescription,advancedPermSettingsUrl:t.getAdvancedPermissionsSettingsUrl(),advancedPermSettings:l.strings.advancedPermSettings,goToOutlookLink:l.strings.goToOutlookLink,goToOutlookText:l.strings.goToOutlookText,manageSitePermissions:l.strings.manageSitePermissions,goToOutlookOnClick:t._goToMembersOnClick.bind(t),siteOwners:l.strings.siteOwners,siteMembers:l.strings.siteMembers,siteVisitors:l.strings.siteVisitors,shareSiteOnlyVerboseText:l.strings.shareSiteOnlyVerboseText,shareSiteOnlyAddMembersLinkText:i&&l.strings.shareSiteOnlyAddMembersLinkText,emptyGroupText:l.strings.emptyGroupText,shareSiteTitle:l.strings.shareSiteTitle,addMemberDefaultPermissionLevel:i?void 0:s.PermissionLevel.Read,isEmailSharingEnabled:!0,sendEmailText:l.strings.sendEmailText,messagePlaceHolderText:l.strings.messagePlaceHolderText});return t}e.prototype.componentDidMount=function(){this._state.componentDidMount()};e.prototype.componentWillUnmount=function(){this._state.componentWillUnmount()};e.prototype.render=function(){var e=this._state.getRenderProps();return n.createElement(o.SitePermissionsPanel,i.__assign({},e))};e.prototype.getAdvancedPermissionsSettingsUrl=function(){return this._pageContext.webAbsoluteUrl+"/"+this._pageContext.layoutsUrl+"/user.aspx"};e.prototype._goToMembersOnClick=function(){var e=this._resources.consume(d.actionMap),t=new(this._resources.injected(e.LaunchGroupMembershipPanelAction))({}),i=function(){t.dispose()};t.execute(null).done(i,i)};return e}(n.Component);t.SitePermissionsPanelContainer=r;t.default=r});define("Jq",["require","exports","ap","Jr","Jr"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=n.ListCreationPanel});define("Jr",["require","exports","ap","Ju","Js"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t)});define("Ju",["require","exports","ap","at","Jr","Du","Jt"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){return r.createElement(o.Panel,i.__assign({className:"ms-ListCreationPanel"},this.props.panelProps,{firstFocusableSelector:"ms-TextField-field"}),r.createElement(n.ListCreationPanelContent,i.__assign({},this.props.listCreationPanelContentProps)))};e.defaultProps={panelProps:{type:o.PanelType.smallFixedFar}};return e}(r.Component);t.ListCreationPanel=a});define("Jt",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-ListCreationPanel{margin-top:50px;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.ms-ListCreationPanel-PanelDescription{margin-top:10px;margin-bottom:0;font-size:12px;font-weight:400;font-weight:300}.ms-ListCreationPanel-DescriptionField{resize:none}.ms-ListCreationPanel-ErrorMessage{font-size:12px;font-weight:400;color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:";box-sizing:border-box;box-shadow:none;margin:0;padding:0;margin-top:20px;margin-bottom:13px}.ms-ListCreationPanel-NameFieldLabel{margin-top:17px;margin-bottom:7px;font-size:12px;font-weight:400}.ms-ListCreationPanel-DescriptionFieldLabel{margin-top:17px;margin-bottom:7px;font-size:12px;font-weight:400}.ms-ListCreationPanel-DescriptionField .ms-TextField-field{display:block}.ms-ChoiceField.ms-ListCreationPanel-Checkbox{margin-top:13px;margin-bottom:13px;font-size:12px;font-weight:400}.ms-Checkbox.ms-ListCreationPanel-Checkbox{margin-top:13px;margin-bottom:13px;font-size:12px;font-weight:400}[dir=ltr] .ms-ListCreationPanel-CancelButton.ms-Button{margin-left:8px}[dir=rtl] .ms-ListCreationPanel-CancelButton.ms-Button{margin-right:8px}.ms-ListCreationPanel-Spinner{margin-top:20px}.ms-ListCreationPanel-Spinner .ms-Spinner-label{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});define("Js",["require","exports","ap","at","wN","BT","Dz","o1","jP","Jt"],function(e,t,r,y,S,x,k,C,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={showInQuickLaunch:t.props.showInQuickLaunchDefault,createButtonDisabled:!0,showLoadingSpinner:!1};return t}e.prototype.componentDidMount=function(){this._events.on(window,"keydown",this._onKeyDown.bind(this))};e.prototype.componentWillReceiveProps=function(e){e.errorMessage&&this.setState({showLoadingSpinner:!1,createButtonDisabled:!1})};e.prototype.componentWillUnmount=function(){this._events.dispose()};e.prototype.render=function(){var e=this.props,t=e.panelDescription,i=e.nameFieldLabel,r=e.nameFieldPlaceHolder,n=e.descriptionFieldLabel,o=e.descriptionFieldPlaceHolder,a=e.showInQuickLaunchString,s=e.errorMessage,l=e.spinnerString,c=this.state,d=c.showInQuickLaunch,u=c.listTitle,p=c.listDescription,m=c.createButtonDisabled,h=c.showLoadingSpinner,f=y.createElement(S.PrimaryButton,{className:"ms-ListCreationPanel-CreateButton",disabled:m,ariaLabel:this.props.onCreate.onCreateString,onClick:this._onCreateClick.bind(this,u,p,d),onKeyDown:this._onKeyDown.bind(this)},this.props.onCreate.onCreateString),g=y.createElement(S.DefaultButton,{className:"ms-ListCreationPanel-CancelButton",ariaLabel:this.props.onCancel.onCancelString,onClick:this._onCancelClick.bind(this)},this.props.onCancel.onCancelString),b=y.createElement(x.TextField,{className:"ms-ListCreationPanel-NameField",placeholder:r,ref:this._resolveRef("_listTitleInput"),ariaLabel:i,onChanged:this._onListTitleChanged}),_=y.createElement(x.TextField,{className:"ms-ListCreationPanel-DescriptionField",placeholder:o,ref:this._resolveRef("_listDescriptionInput"),ariaLabel:n,multiline:!0,resizable:!1,onChanged:this._onListDescriptionChanged}),v=y.createElement(k.Checkbox,{className:"ms-ListCreationPanel-Checkbox",label:a,onChange:this._onShowInQuickLaunchChanged,checked:d});return y.createElement("div",{className:"ms-ListCreationPanelContent"},t?y.createElement("div",{className:"ms-ListCreationPanel-PanelDescription"},t):null,i?y.createElement("div",{className:"ms-ListCreationPanel-NameFieldLabel"},i):null,b,n?y.createElement("div",{className:"ms-ListCreationPanel-DescriptionFieldLabel"},n):null,_,y.createElement("div",{className:"ms-ListCreationPanel-ErrorMessage","aria-live":"polite"},s||null),v,y.createElement("div",{className:"ms-ListCreationPanel-Buttons"},f,g),h?y.createElement(C.Spinner,{className:"ms-ListCreationPanel-Spinner",label:l}):null)};e.prototype._onCreateClick=function(e,t,i,r){this.setState({showLoadingSpinner:!0,createButtonDisabled:!0});if(this.props.onCreate.onCreateAction){this.props.onCreate.onCreateAction(e,t,i,r);r.stopPropagation();r.preventDefault()}};e.prototype._onCancelClick=function(e){if(this.props.onCancel.onCancelAction){this.props.onCancel.onCancelAction(e);e.stopPropagation();e.preventDefault()}};e.prototype._onListTitleChanged=function(){var e=this._listTitleInput&&this._listTitleInput.value?this._listTitleInput.value.trim():"";e&&this.state.listTitle!==e?this.setState({createButtonDisabled:!1,listTitle:e}):e&&this.state.listTitle===e?this.setState({createButtonDisabled:!1}):this.setState({createButtonDisabled:!0})};e.prototype._onListDescriptionChanged=function(){var e=this._listDescriptionInput&&this._listDescriptionInput.value?this._listDescriptionInput.value:"";this.state.listDescription!==e&&this.setState({listDescription:e})};e.prototype._onShowInQuickLaunchChanged=function(){this.setState({showInQuickLaunch:!this.state.showInQuickLaunch})};e.prototype._onKeyDown=function(e){if(!0!==this.state.createButtonDisabled&&13===e.which){var t=this.state,i=t.showInQuickLaunch,r=t.listTitle,n=t.listDescription;this._onCreateClick(r,n,i,e)}else 27===e.which&&this._onCancelClick(e);e.stopPropagation()};e.defaultProps={showInQuickLaunchDefault:!0};r.__decorate([n.autobind],e.prototype,"_onCreateClick",null);r.__decorate([n.autobind],e.prototype,"_onCancelClick",null);r.__decorate([n.autobind],e.prototype,"_onListTitleChanged",null);r.__decorate([n.autobind],e.prototype,"_onListDescriptionChanged",null);r.__decorate([n.autobind],e.prototype,"_onShowInQuickLaunchChanged",null);r.__decorate([n.autobind],e.prototype,"_onKeyDown",null);return e}(n.BaseComponent);t.ListCreationPanelContent=i});define("IN",["require","exports","ap","IO","IO"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=n.ColumnManagementPanel});define("II",["require","exports","ap","IK","IJ"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t)});define("IK",["require","exports","ap","jP","Iz","eq","IL","eo","bE","a0"],function(e,t,i,r,a,c,n,s,l,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.updateParams(e)}e.prototype.componentWillMount=function(){var t=this,e=this._params,i=e.group,r=e.getGroupsProvider,n=e.resourceLinkInfo,o=e.pageContext,a=c.isGroupWebContext(o),s="HubNav"===i.key,l=function(){return t._setState({isLoading:!1})};if(s){this._setState({isLoading:!0});i.getNewLinks().then(function(e){i.links=e;l()})}else if(a&&r&&n){this._setState({isLoading:!0});r().then(function(e){if(e&&e.group)return e.getGroup().then(function(e){t._updateO365GroupsInfo(e)})}).then(l,l)}else l()};e.prototype.updateParams=function(e){this._params=e;this._resourceLinks=void 0;this._editNavDataSource=new n.EditNavDataSource(e.pageContext)};e.prototype.getEditNavProps=function(){var e=this._params,t=e.container&&e.container.state;return{isOnTop:e.isOnTop,group:e.group,onSave:this._onSaveClick,onCancel:this._onCancelClick,resourceLinks:this._resourceLinks,maxLevelCount:e.maxLevelCount,isLoading:t&&t.isLoading,isSaving:t&&t.isSaving,errorMessage:t&&t.errorMessage}};e.prototype._setState=function(e){this._params.container.setState(e)};e.prototype._updateO365GroupsInfo=function(e){if(e){this._resourceLinks=[];for(var t=0,i=this._params.resourceLinkInfo;t<i.length;t++){var r=i[t],n=e[r.keyName];n&&this._resourceLinks.push({name:r.title,icon:r.icon,url:n,engagementName:r.keyName})}}};e.prototype._onSaveClick=function(e){var t=this;d.Engagement.logData({name:"EditNav.Save.Click"});this._setState({isSaving:!0,errorMessage:void 0});var i=this._params.group,r="GlobalNav"===i.key||"HubNav"===i.key,n=e.getLinksToSave(),o=new l.default;this._editNavDataSource.onSave({links:n},r).then(function(e){return e?o.complete():o.error()},function(e){return o.error(e)});o.getPromise().then(function(){s.default({retries:2,callback:function(){return i.getNewLinks?i.getNewLinks():t._editNavDataSource.getMenuState({isGlobalNav:r,useCache:!0,forceRefresh:!0}).then(function(e){return e.links})}}).then(function(e){i.augmentLinks&&i.augmentLinks(e);t._params.updateDisplayedLinks(e);t._params.exitEditMode()},function(){window.location.reload()})},function(e){t._setState({isSaving:!1,errorMessage:e&&e.message||a.EditNavResx.DefaultError})})};e.prototype._onCancelClick=function(){d.Engagement.logData({name:"EditNav.Cancel.Click"});this._params.exitEditMode()};i.__decorate([r.autobind],e.prototype,"_onSaveClick",null);i.__decorate([r.autobind],e.prototype,"_onCancelClick",null);return e}();t.EditNavStateManager=o;t.default=o});define("Iz",["require","exports","ap","IA","IA"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=n.EditNav});define("IA",["require","exports","ap","ID","IC","IB"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);t.EditNavResx=o.default});define("ID",["require","exports","ap","at","o7","jP","wN","mo","wt","jP","V","ej","IB","IF","IC","IE"],function(e,t,d,u,p,m,o,h,f,g,b,c,_,v,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={name:"",url:"",elementId:"EditNavLink-root"};!function(e){e[e.moveUp=0]="moveUp";e[e.moveDown=1]="moveDown";e[e.makeSubLink=2]="makeSubLink";e[e.promoteSubLink=3]="promoteSubLink";e[e.remove=4]="remove"}(t.CtxMenuCommand||(t.CtxMenuCommand={}));var y=[{key:String(0),name:_.default.ContextMenuMoveUp},{key:String(1),name:_.default.ContextMenuMoveDown},{key:String(2),name:_.default.ContextMenuIndentLink},{key:String(3),name:_.default.ContextMenuPromoteLink},{key:String(4),name:_.default.ContextMenuUnpin}];function S(e,t,i,r,n){var o=i.indexOf(t),a=i.length;switch(e){case 0:return 0<o;case 1:return o<a-1;case 4:return!0;case 2:if(0<o&&1<a){return r+1+l(t)<n}return!1;case 3:return 0<r}}t.isCommandAllowed=S;function l(e){return e.links&&e.links.length?1+Math.max.apply(Math,e.links.map(l)):0}function x(e){return e.elementId+"-ellipsis"}function k(e){return e.elementId+"-insert"}var i=function(i){d.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isSaveButtonDisabled:!0,isLoading:e.isLoading};t._maxLevelCount=e.maxLevelCount||2;t._dataCache=new r.EditNavDataCache(e.group,t._maxLevelCount);return t}e.prototype.componentDidMount=function(){this._focusIfNeeded()};e.prototype.componentDidUpdate=function(){this._focusIfNeeded()};e.prototype.componentWillReceiveProps=function(e){var t=this,i=this.props;if(i.isLoading&&!e.isLoading){this._dataCache=new r.EditNavDataCache(e.group,this._maxLevelCount);this.setState({isLoading:!1},function(){e.group.links.length||t.setState({calloutVisibleForLink:s})})}else i.isSaving&&!e.isSaving?this.setState({isSaving:!1,errorMessage:e.errorMessage,isSaveButtonDisabled:!1}):e.isSaving&&this.setState({isSaving:!0,isSaveButtonDisabled:!0,errorMessage:void 0})};e.prototype.render=function(){var e=this._dataCache&&this._dataCache.getGroupToEdit(),t=this.state,i=this.props.isOnTop,r=m.css("ms-EditNav",i&&"is-onTop ms-u-slideRightIn40"),n=u.createElement("div",{className:"ms-EditNav-Buttons"},u.createElement(o.PrimaryButton,{disabled:t.isSaveButtonDisabled,className:"ms-EditNav-SaveButton","data-logging-id":"EditNav.Save",onClick:this._onSaveClick},_.default.SaveButtonLabel),u.createElement(o.DefaultButton,{className:"ms-EditNav-CancelButton",onClick:this._onCancelClick},_.default.CancelButtonLabel));return!e||t.isLoading?u.createElement("div",{className:r},n):u.createElement("div",null,u.createElement(p.FocusZone,{direction:p.FocusZoneDirection.vertical,ref:"root"},u.createElement("nav",{role:"region","aria-label":_.default.EditNavAriaLabel,className:r},u.createElement("div",{className:"ms-EditNav-links"},this._renderLinks(e.links,0)),n)))};e.prototype._renderLinks=function(i,r){var n=this,e=this.props,t=this.state;if(!i||!i.length){if(0<r)return;var o=k(s);return u.createElement("div",{className:"ms-EditNav-link"},u.createElement("span",{className:"ms-EditNav-insertLine is-visible",id:o,role:"button","data-is-focusable":!0,"aria-label":_.default.CalloutAddLinkTitle,onClick:this._onShowCalloutClicked.bind(this,s,!0)},u.createElement(h.Icon,{iconName:"Add",className:"ms-EditNav-plusIcon"})),t.calloutVisibleForLink?u.createElement(v.EditNavCallout,{target:document.getElementById(o),onOKClicked:this._onCalloutOkClicked.bind(this,void 0),onCancelClicked:this._onHideCalloutClicked,resourceLinks:e.resourceLinks,insertMode:!0}):void 0)}var a=i.map(function(e,t){return n._renderLink(e,i,r)});return u.createElement("ul",{className:m.css(e.horizontal&&"ms-EditNav-horizontal"),role:"list"},a)};e.prototype._renderLink=function(e,t,i){return u.createElement("li",{className:"ms-EditNav-linkRow",key:e.elementId,role:"listitem"},this._renderCompositeLink(e,t,i),e.isExpanded?this._renderLinks(e.links,i+1):void 0)};e.prototype._renderCompositeLink=function(e,t,i){var r=this.props,n=this.state,o=n.insertMode,a=x(e),s=k(e),l=n.calloutVisibleForLink===e,c=n.menuVisibleForLink===e,d=!(!e.links||!e.links.length);return u.createElement("div",null,u.createElement("div",{className:"ms-EditNav-link",title:e.name,"aria-label":e.ariaLabel||e.title,id:e.elementId,"data-is-focusable":!0,role:"button",onClick:this._onShowCalloutClicked.bind(this,e,!1)},u.createElement("span",{className:"ms-EditNav-linkText"},e.name)),u.createElement(h.Icon,{iconName:"More",className:m.css("ms-EditNav-linkButton",c&&"is-visible"),id:a,role:"button","aria-label":b.format(_.default.ContextMenuAriaLabel,e.name),"data-is-focusable":!0,onClick:this._onShowHideMenuClicked.bind(this,e)}),c&&this._renderContextMenu(e,t,i),!d&&u.createElement("span",{className:m.css("ms-EditNav-insertLine",l&&o&&"is-visible"),id:s,role:"button","data-is-focusable":!0,"aria-label":_.default.CalloutAddLinkTitle,onClick:this._onShowCalloutClicked.bind(this,e,!0)},u.createElement(h.Icon,{iconName:"Add",className:"ms-EditNav-plusIcon"})),l&&u.createElement(v.EditNavCallout,{target:document.getElementById(s),address:o?"":e.url,display:o?"":e.name,onOKClicked:this._onCalloutOkClicked.bind(this,e),onCancelClicked:this._onHideCalloutClicked,resourceLinks:r.resourceLinks,defaultSelectedKey:this._getDefaultSelectedKey(e.url),insertMode:o}))};e.prototype._getDefaultSelectedKey=function(e){var t=this.props.resourceLinks;if(e&&t&&!this.state.insertMode)for(var i=new c.default(e),r=i.getStringWithoutQueryAndFragment(),n=i.getQuery(),o=0,a=t;o<a.length;o++){var s=a[o].url,l=new c.default(s);if(e===s||r===l.getStringWithoutQueryAndFragment()&&n===l.getQuery())return s}};e.prototype._renderContextMenu=function(r,n,t){for(var o=this,a=[{name:_.default.ContextMenuEdit,key:"idEdit",onClick:function(){o.setState({menuVisibleForLink:void 0},function(){o._onShowCalloutClicked(r,!1)})}}],s=n.indexOf(r),e=function(e){var i=Number(e.key);S(i,r,n,t,l._maxLevelCount)&&a.push(d.__assign({},e,{onClick:function(){o._dataCache.processCommand(r,i);o.setState({isSaveButtonDisabled:!1,menuVisibleForLink:void 0},function(){var e;if(4===i){var t=n[s-1];e=t&&t.elementId}else e=x(r);(e&&document.getElementById(e)||o.refs.root).focus()})}}))},l=this,i=0,c=y;i<c.length;i++){e(c[i])}return u.createElement(p.FocusZone,{direction:p.FocusZoneDirection.vertical},u.createElement(f.ContextualMenu,{target:"#"+x(r),directionalHint:g.getRTL()?6:4,items:a,isBeakVisible:!1,gapSpace:0,onDismiss:this._onDismissMenu,className:"ms-EditNav_contextMenu"}))};e.prototype._onShowCalloutClicked=function(e,t){this.setState({calloutVisibleForLink:e,menuVisibleForLink:void 0,insertMode:t})};e.prototype._onHideCalloutClicked=function(){this.setState({calloutVisibleForLink:void 0,insertMode:void 0})};e.prototype._onShowHideMenuClicked=function(e){this.state.menuVisibleForLink===e?this.setState({menuVisibleForLink:void 0}):this.setState({menuVisibleForLink:e,calloutVisibleForLink:void 0,insertMode:void 0})};e.prototype._onCalloutOkClicked=function(e,t,i){if(this.state.insertMode)this._dataCache.addLink(e,i,t);else if(e){e.name=i;e.url=t}this.setState({isSaveButtonDisabled:!1,calloutVisibleForLink:void 0})};e.prototype._onSaveClick=function(e){this.setState({isSaveButtonDisabled:!0});this.props.onSave(this._dataCache);e.stopPropagation();e.preventDefault()};e.prototype._onCancelClick=function(e){this.props.onCancel();e.stopPropagation();e.preventDefault()};e.prototype._onDismissMenu=function(e){this.setState({menuVisibleForLink:void 0});e.stopPropagation();e.preventDefault()};e.prototype._focusIfNeeded=function(){if(!this._hasFocused&&this.refs.root){this.refs.root.focus();this._hasFocused=!0}};e.defaultProps={group:void 0,onSave:void 0,onCancel:void 0,onRenderLink:function(e){return u.createElement("span",{className:"ms-EditNav-linkText"},e.name)}};d.__decorate([m.autobind],e.prototype,"_onHideCalloutClicked",null);d.__decorate([m.autobind],e.prototype,"_onSaveClick",null);d.__decorate([m.autobind],e.prototype,"_onCancelClick",null);d.__decorate([m.autobind],e.prototype,"_onDismissMenu",null);return e}(m.BaseComponent);t.EditNav=i});define("IF",["require","exports","ap","IG"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("IG",["require","exports","ap","at","IB","wg","wO","BU","BM","jP","Dn","a0","IH"],function(e,t,i,a,s,l,c,d,u,p,m,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h="URL",r=/^(https?:\/\/|mailto:|\/|#)/i,f=/^(https?:\/\/|mailto:)$/i,n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this,i=e.resourceLinks;if(i&&i.length){t._dropdownOptions=i.filter(function(e){return!!e.name}).map(function(e){return{key:e.url,text:e.name,data:e}});var r={url:"http://",name:"",engagementName:h};t._dropdownOptions.unshift({key:h,text:h,data:r})}t.state={address:e.address||"http://",display:e.display||"",selectedKey:e.defaultSelectedKey||h};return t}e.prototype.componentDidMount=function(){this._events.on(window,"keydown",this._onKeyDown)};e.prototype.render=function(){var e=this.props,t=this.state,i=this._isOKDisabled(),r=p.getRTL(),n=e.insertMode,o=!!this._dropdownOptions;return a.createElement(l.Callout,{target:e.target,className:"ms-EditNavCallout",isBeakVisible:!0,beakWidth:15,gapSpace:0,directionalHint:r?9:12,onDismiss:this._onCancelClick,setInitialFocus:!0},a.createElement(u.FocusTrapZone,null,a.createElement("div",{className:"ms-EditNavCallout-header ms-EditNavCallout-title"},n?s.default.CalloutAddLinkTitle:s.default.CalloutEditLinkTitle),a.createElement("div",{className:"ms-EditNavCallout-inner"},o?a.createElement(m.Dropdown,{componentRef:this._resolveRef("_dropdown"),options:this._dropdownOptions,selectedKey:t.selectedKey,onChanged:this._onOptionChanged,label:s.default.LinkTo}):null,a.createElement(d.TextField,{label:s.default.CalloutAddressLabel,placeholder:n?s.default.CalloutAddressPlacehold:"",ariaLabel:s.default.CalloutAddressLabel,onChanged:this._onAddressChanged,onBlur:this._onBlur,value:t.address,disabled:o&&!t.selectedKey,multiline:!0}),a.createElement(d.TextField,{label:s.default.CalloutDisplayLabel,placeholder:n?s.default.CalloutDisplayPlacehold:"",ariaLabel:s.default.CalloutDisplayLabel,value:t.display,onChanged:this._onDisplayChanged,disabled:o&&!t.selectedKey}),a.createElement("div",{className:"ms-EditNavCallout-buttonArea"},a.createElement(c.PrimaryButton,{className:"ms-EditNav-SaveButton",disabled:i,onClick:this._onOkClick},s.default.CalloutOkButton),a.createElement(c.DefaultButton,{className:"ms-EditNav-CancelButton",onClick:this._onCancelClick},s.default.CancelButtonLabel)))))};e.prototype._isOKDisabled=function(){var e=this.state,t=e.address,i=e.display;t=(t||"").trim();i=(i||"").trim();return!t||!i||t===s.default.CalloutAddressPlacehold||f.test(t)};e.prototype._logEngagement=function(){o.Engagement.logData({name:this.props.insertMode?"EditNav.AddLink":"EditNav.EditLink",isIntentional:!0});if(this._dropdownOptions)for(var e=0,t=this._dropdownOptions;e<t.length;e++){var i=t[e];if(i.key===this.state.selectedKey){var r=i.data;o.Engagement.logData({name:"EditNav.AddLink.Option."+r.engagementName,isIntentional:!0});break}}};e.prototype._shouldPrependHttp=function(e){return(e=(e||"").trim())&&!r.test(e)&&!/^h(t(t(ps?(:(\/\/?)?)?)?)?)?$/i.test(e)&&!/^m(a(i(l(t(o:?)?)?)?)?)?$/i.test(e)};e.prototype._onAddressChanged=function(e){var t;t=this._shouldPrependHttp(e)?"http://"+e.trim():e;this.setState({address:t})};e.prototype._onBlur=function(){var e=(this.state.address||"").trim();if(e&&!r.test(e)){e="http://"+e;this.setState({address:e})}};e.prototype._onOkClick=function(e){this._logEngagement();var t=this.state;this.props.onOKClicked(t.address.trim(),t.display.trim());e.stopPropagation();e.preventDefault()};e.prototype._onCancelClick=function(e){this.props.onCancelClicked&&this.props.onCancelClicked()};e.prototype._onOptionChanged=function(e){var t=e.data,i=e!==this._dropdownOptions[0];this.setState({address:t.url,display:t.name,selectedKey:e.key,addressDisabled:i})};e.prototype._onKeyDown=function(e){if(!this._dropdown||!this._dropdown.state.isOpen){var t=!1;if(13!==e.which||this._isOKDisabled()){if(27===e.which){this._onCancelClick(e);t=!0}}else{this._onOkClick(e);t=!0}if(t){e.stopPropagation();e.preventDefault()}}};e.prototype._onDisplayChanged=function(e){this.setState({display:e})};i.__decorate([p.autobind],e.prototype,"_onAddressChanged",null);i.__decorate([p.autobind],e.prototype,"_onBlur",null);i.__decorate([p.autobind],e.prototype,"_onOkClick",null);i.__decorate([p.autobind],e.prototype,"_onCancelClick",null);i.__decorate([p.autobind],e.prototype,"_onOptionChanged",null);i.__decorate([p.autobind],e.prototype,"_onKeyDown",null);i.__decorate([p.autobind],e.prototype,"_onDisplayChanged",null);return e}(p.BaseComponent);t.EditNavCallout=n});define("IH",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:"[dir=ltr] .ms-Dropdown-item.ms-Button+.ms-Button{margin-left:0}[dir=rtl] .ms-Dropdown-item.ms-Button+.ms-Button{margin-right:0}.ms-EditNavCallout{width:320px}.ms-EditNavCallout-buttonArea{vertical-align:top;display:inline-block;margin-top:20px;width:100%}[dir=ltr] .ms-EditNavCallout-buttonArea{text-align:right}[dir=rtl] .ms-EditNavCallout-buttonArea{text-align:left}.ms-EditNavCallout-inner{height:100%;padding:0 24px 20px}.ms-EditNavCallout-header{padding:18px 24px 12px}.ms-EditNavCallout-title{margin:0;font-size:21px;font-weight:100;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:300}"}])});define("IC",["require","exports","ap","ID"],function(e,t,r,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=1;function o(){return"EditNavLink-"+i++}var n=function(){function e(e,t){this._maxLevelCount=t;this.init(e)}e.prototype.init=function(e,t){this._clientLinks=[];this._deletedLinks=[];this._group=r.__assign({},e,{links:this._getLinksToEdit(e.links,!1)})};e.prototype.getGroupToEdit=function(){return this._group};e.prototype.getLinksToSave=function(){return this._group.links.concat(this._deletedLinks)};e.prototype.getViewLinks=function(){return this._getViewLinks(this._group.links).concat(this._clientLinks)};e.prototype.updateLink=function(e,t,i,r){e.name=t;e.url=i;e.target=r};e.prototype.addLink=function(e,t,i,r){var n={name:t,url:i,target:r,isExpanded:!0,elementId:o()};this._addLink(this._group.links,e,n)};e.prototype.processCommand=function(e,t){this._processCommand(t,e,this._group,0)};e.prototype._addLink=function(e,t,i){if(0===e.length){e.push(i);return!0}for(var r=0;r<e.length;r++){var n=e[r],o=n.links,a=o&&o.length;if(n===t){a?o.unshift(i):e.splice(r+1,0,i);return!0}if(a&&this._addLink(o,t,i))return!0}return!1};e.prototype._processCommand=function(e,t,i,r,n){for(var o=i.links,a=0;a<o.length;a++){var s=o[a],l=s.links&&s.links.length;if(s===t){if(!u.isCommandAllowed(e,t,i.links,r,this._maxLevelCount))return!0;switch(e){case 0:o[a]=o[a-1];o[a-1]=t;break;case 1:o[a]=o[a+1];o[a+1]=t;break;case 4:o.splice(a,1)[0];if(t.key){t.isDeleted=!0;this._deletedLinks.push(t)}break;case 2:var c=o[a-1];c.links||(c.links=[]);c.links.push(t);o.splice(a,1);break;case 3:var d=n.indexOf(i);n.splice(d+1,0,t);o.splice(a,1)}return!0}if(l&&this._processCommand(e,t,s,r+1,o))return!0}return!1};e.prototype._getLinksToEdit=function(e,t){var i=this;void 0===t&&(t=!1);return e.filter(function(e){if(!e)return!1;if(void 0===e.key||0<=Number(e.key))return!0;i._clientLinks.push(e);return!1}).map(function(e){return r.__assign({},e,{links:e.links?i._getLinksToEdit(e.links,!0):null,isDeleted:!1,isExpanded:!0,elementId:o()})})};e.prototype._getViewLinks=function(e){var t=this;return e.filter(function(e){return!e.isDeleted}).map(function(e){return r.__assign({},e,{links:e.links?t._getViewLinks(e.links):null,isExpanded:!1,isDeleted:void 0,elementId:void 0})})};return e}();t.EditNavDataCache=n});define("IE",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-EditNav{overflow-y:auto;-webkit-overflow-scrolling:touch;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding-bottom:14px}.ms-EditNav.is-onTop{position:absolute}.ms-EditNav.is-horizontal li{display:inline-block}.ms-EditNav ul{list-style-type:none}.ms-EditNav ul,.ms-EditNav ul>li{padding:0}[dir=ltr] .ms-EditNav li>ul{margin-left:14px}[dir=rtl] .ms-EditNav li>ul{margin-right:14px}.ms-EditNav-links{display:block;margin-bottom:20px}.ms-EditNav-Icon{padding:0;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";transition:transform .1s linear}.ms-EditNav-links{display:block;position:relative}.ms-EditNav-chevronButton{display:block;font-weight:400;font-size:12px;line-height:40px;margin:5px 0;padding:0 40px;border:none;text-transform:uppercase;cursor:pointer;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] .ms-EditNav-chevronButton{text-align:left}[dir=rtl] .ms-EditNav-chevronButton{text-align:right}.ms-EditNav-chevronButton:visited{color:inherit}.ms-EditNav-chevronButton:hover{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.ms-EditNav-chevronButton.ms-EditNav-chevronButton--group{width:100%;height:40px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ms-EditNav-chevron.ms-Icon{position:absolute;height:40px;line-height:40px;font-size:12px;transition:transform .1s linear}[dir=ltr] .ms-EditNav-chevron.ms-Icon{left:15px}[dir=rtl] .ms-EditNav-chevron.ms-Icon{right:15px}.ms-EditNav-linkText{vertical-align:middle}.ms-EditNav-linkButton{position:absolute;top:0;color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";height:40px;width:40px;text-align:center;line-height:40px}[dir=ltr] .ms-EditNav-linkButton{right:0}[dir=rtl] .ms-EditNav-linkButton{left:0}.ms-EditNav-linkButton.is-visible,.ms-EditNav-linkButton:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";cursor:pointer}.ms-EditNav-linkRow{position:relative;cursor:pointer}.ms-EditNav-link{display:block;position:relative;padding:9px 40px 10px 20px;cursor:pointer;word-wrap:break-word;text-decoration:none;font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=rtl] .ms-EditNav-link{padding:9px 20px 10px 40px}.ms-EditNav-link:hover{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.ms-EditNav-link.is-selected{position:relative;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.ms-EditNav-link.is-selected:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ms-EditNav-link.is-selected:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0}[dir=ltr] .ms-EditNav-link.is-selected:after{border-left:2px solid "},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}[dir=rtl] .ms-EditNav-link.is-selected:after{border-right:2px solid "},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.ms-Fabric .ms-EditNav-chevronButton--group::-moz-focus-inner,.ms-Fabric .ms-EditNav-chevronButton--link::-moz-focus-inner,.ms-Fabric .ms-EditNav-chevronButton::-moz-focus-inner,.ms-Fabric .ms-EditNav-link::-moz-focus-inner{border:0}.ms-Fabric .ms-EditNav-chevronButton,.ms-Fabric .ms-EditNav-chevronButton--group,.ms-Fabric .ms-EditNav-chevronButton--link,.ms-Fabric .ms-EditNav-link{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .ms-EditNav-chevronButton--group:focus:after,.ms-Fabric.is-focusVisible .ms-EditNav-chevronButton--link:focus:after,.ms-Fabric.is-focusVisible .ms-EditNav-chevronButton:focus:after,.ms-Fabric.is-focusVisible .ms-EditNav-link:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .ms-EditNav-chevronButton--group:focus:after,.ms-Fabric.is-focusVisible .ms-EditNav-chevronButton--link:focus:after,.ms-Fabric.is-focusVisible .ms-EditNav-chevronButton:focus:after,.ms-Fabric.is-focusVisible .ms-EditNav-link:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .ms-EditNav-chevronButton--group:focus:after,.ms-Fabric.is-focusVisible .ms-EditNav-chevronButton--link:focus:after,.ms-Fabric.is-focusVisible .ms-EditNav-chevronButton:focus:after,.ms-Fabric.is-focusVisible .ms-EditNav-link:focus:after{border-color:#37006e}}.ms-EditNav-insertLine{display:block;padding:0 40px;height:16px;opacity:0;position:absolute;z-index:1;bottom:-10px;left:0;right:0;transition:opacity 367ms ease;outline:0;cursor:pointer}.ms-EditNav-insertLine .ms-EditNav-plusIcon{font-size:12px;position:absolute;top:0;left:50%;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:50%;z-index:1;padding:2px;cursor:pointer}[dir=ltr] .ms-EditNav-insertLine .ms-EditNav-plusIcon{margin-left:-7px}[dir=rtl] .ms-EditNav-insertLine .ms-EditNav-plusIcon{margin-right:-7px}.ms-EditNav-insertLine::after{content:'';background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";position:absolute;left:0;right:0;height:2px;top:7px}.ms-EditNav-insertLine.is-visible,.ms-EditNav-insertLine:focus,.ms-EditNav-insertLine:hover{opacity:1}.ms-EditNav-horizontal{overflow-x:auto;list-style-type:none}.ms-EditNav-Buttons{margin-left:10px;margin-top:40px;display:-ms-flexbox;display:flex}[dir=ltr] .ms-EditNav-SaveButton{margin-right:8px}[dir=rtl] .ms-EditNav-SaveButton{margin-left:8px}[dir=ltr] .ms-EditNav-CancelButton{margin-left:0}[dir=rtl] .ms-EditNav-CancelButton{margin-right:0}.ms-EditNav_contextMenu{display:block}.ms-EditNav_contextMenu .ms-ContextualMenu.is-open{position:relative;box-shadow:none;border:none}.ms-EditNav_contextMenu .ms-ContextualMenu.is-open .ms-ContextualMenu-link{height:36px}.ms-Callout-container{z-index:299}"}])});define("IL",["require","exports","ap","IM","Gk"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t)});define("IM",["require","exports","ap","Gl","V"],function(e,t,i,n,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.onSave=function(e,t){var i=this._transformToEditableMenuState(e,t);return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/navigation/SaveMenuState",parseResponse:function(e){try{return 200===JSON.parse(e).value}catch(e){return!1}},qosName:"SaveEditNavData",additionalPostData:i,method:"POST",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1})};t.prototype.addLinkToQuickLaunch=function(e,t,i){void 0===i&&(i=!0);var r={__metadata:{type:"SP.NavigationNode"},IsExternal:i,Title:e,Url:t};return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/web/navigation/quicklaunch",parseResponse:function(e){var t=JSON.parse(e);return t.d&&void 0!==t.d.Id?{key:String(t.d.Id),name:t.d.Title,url:t.d.Url,target:n.ViewNavDataSource.isRelativeUrl(t.d.Url)?"":"_blank"}:null},qosName:"AddToQuickLaunch",additionalPostData:JSON.stringify(r),method:"POST"})};t.prototype._transformToEditableMenuState=function(e,t){var i=new Date,r=a.format("{0}-{1}-{2}T{3}:{4}:{5}Z",i.getUTCFullYear(),i.getUTCMonth()+1,i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds()),n=this._pageContext,o={Version:r,StartingNodeKey:t?"1002":"1025",StartingNodeTitle:t?"SharePoint Top Navigation Bar":"Quick launch",SPSitePrefix:t?n.siteServerRelativeUrl:"/",SPWebPrefix:n.webServerRelativeUrl,FriendlyUrlPrefix:"",SimpleUrl:"",Nodes:this._getEditableNodesFromLinks(e.links)};return JSON.stringify({menuState:o,mapProviderName:this._mapProviderName})};t.prototype._getEditableNodesFromLinks=function(e){if(e&&!(e.length<=0)){for(var t=[],i=0,r=e;i<r.length;i++){var n=r[i];(void 0===n.key||0<=Number(n.key))&&t.push({NodeType:0,Key:n.key,Title:n.name,SimpleUrl:n.url,FriendlyUrlSegment:"",IsDeleted:n.isDeleted,Nodes:this._getEditableNodesFromLinks(n.links)})}return t}};return t}(n.ViewNavDataSource);t.EditNavDataSource=r;t.default=r});define("Gl",["require","exports","ap","fB"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){i.__extends(l,r);function l(e,t){var i=r.call(this,e,"ViewNavDataSource",{cacheTimeoutTime:36e5})||this;i._mapProviderName=t;return i}l.isRelativeUrl=function(e){return!!e&&(!/^[a-z0-9+-.]+:\/\//i.test(e)&&-1===e.indexOf("/_layouts/15/groupstatus.aspx?"))};l.transformNodesToLinks=function(e,i,r){var n=function(e,t){r&&(e=e.filter(function(e){return r(e,t)}));return e.map(function(e){return{name:e.Title,key:e.Id.toString(),url:e.Url,onClick:i,links:e.Children&&e.Children.length?n(e.Children,t+1):void 0}})};return n(e=e||[],0)};l.getAreaNavigationSettingsUrl=function(e){return e.webAbsoluteUrl+"/"+e.layoutsUrl+"/AreaNavigationSettings.aspx"};l.prototype.getMenuState=function(e){var i=this;void 0===e&&(e={});var t=e.providerName,r=void 0===t?this._mapProviderName:t,n=e.isGlobalNav,o=e.useCache,a=e.forceRefresh,s=o?"getMenuStateUsingCache":"getMenuState",l="";r=r||this._mapProviderName;if(n||r){l+="?menuNodeKey="+(n?"1002":"");r&&(l+="&mapProviderName='"+r+"'")}var c={url:this._pageContext.webAbsoluteUrl+"/_api/navigation/MenuState"+l,qosName:s,parseResponse:function(e){var t=JSON.parse(e);return i._transformToNavLinkGroup(t)},method:"GET",additionalHeaders:{"ODATA-VERSION":"4.0",Accept:"*/*, application/json; odata.metadata=minimal"},contentType:"application/json; odata.metadata=minimal",maxRetries:1,crossSiteCollectionCall:!0,bypassCache:a};return o?this.getDataUtilizingCache(c):this.dataRequestor.getData(c)};l.prototype._transformToNavLinkGroup=function(e){if(e&&e.Nodes&&0!==e.Nodes.length){return{links:this._getLinksFromNodes(e.Nodes,e.FriendlyUrlPrefix)}}};l.prototype._getLinksFromNodes=function(e,o){var a=this,s=function(e,r,t){e=e.filter(function(e){return"1033"!==e.Key&&-1===e.Key.indexOf("SPNavigationNodeId=1033")&&(!e.IsDeleted&&!e.IsHidden)});var n=t?t+"/":void 0;return e.map(function(e){var t=r&&(n?n+r.FriendlyUrlSegment:r.FriendlyUrlSegment),i=a._getUrl(e,!!r,o,t);return{name:e.Title,url:i,key:e.Key,ariaLabel:e.Title,isExpanded:!1,target:l.isRelativeUrl(i)?"":"_blank",links:e.Nodes&&e.Nodes.length?s(e.Nodes,e,t):void 0}})};return s(e||[])};l.prototype._getUrl=function(e,t,i,r){if(e.SimpleUrl)return e.SimpleUrl;var n;1===e.NodeType&&e.FriendlyUrlSegment&&(n=(n=t?i+(r?"/"+r:"")+"/"+e.FriendlyUrlSegment:i+e.FriendlyUrlSegment).replace("//","/"));return n};return l}(r.CachedDataSource);t.ViewNavDataSource=n;t.default=n});define("Gk",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.globalNavParent="1002";e.quickLaunchParent="1025";e.globalNavHome="2003";e.subsites="1026";e.quickLaunchHome="1031";e.quickLaunchRecent="1033";e.siteContents="1034";e.clientRecycleBin="-1000";e.clientEdit="-999";e.clientSharedWithUs="-998"}(t.NavNodeKeys||(t.NavNodeKeys={}));!function(e){e.publishingGlobalNav="GlobalNavigationSwitchableProvider";e.publishingQuickLaunch="CurrentNavigationSwitchableProvider"}(t.NavigationProvider||(t.NavigationProvider={}));!function(e){e[e.SimpleLink=0]="SimpleLink";e[e.FriendlyUrl=1]="FriendlyUrl"}(t.EditNavLinkType||(t.EditNavLinkType={}))});define("IJ",["require","exports","ap","at","IA","IK"],function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isLoading:!0};t._state=new a.EditNavStateManager(r.__assign({},e,{isLoading:!0,container:t}));return t}e.prototype.componentWillMount=function(){this._state.componentWillMount()};e.prototype.render=function(){var e=this._state.getEditNavProps();return n.createElement(o.EditNav,r.__assign({},e))};return e}(n.Component);t.EditNavContainer=i});define("It",["require","exports","ap","Iu","Iu"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=n.SiteSettingsPanel});define("Iu",["require","exports","ap","Ix","Iw","Iv"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);t.SiteSettingsPanelResx=o.default});define("Ix",["require","exports","ap","at","Iv","wN","mo","Dz","xH","Dn","HZ","BZ","mh","Du","wd","o1","BT","jP","a0","V","bS","Iy"],function(e,o,t,m,h,f,g,b,s,_,a,v,y,S,l,x,k,C,c,d,n){"use strict";Object.defineProperty(o,"__esModule",{value:!0});o.SupportedImageTypes=["image/png","image/jpeg","image/gif","image/bmp","image/tiff"];o.MaxImageFileSize=4194304;var r=0,i=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={showPanel:!0,privacySelectedKey:void 0,classificationSelectedKey:void 0,joinHubSiteSelectedKey:void 0,showClassificationDescriptions:!1,makeHubCheckboxChecked:e.isHubSite,hubDisplayType:e.hubDisplayType,makeHubDisplayType:e.makeHubDisplayType};t._classificationDropdownId="SiteClassificationDropdown"+r++;c.Engagement.logData({name:"SiteSettingsPanel.Opened"});return t}e.prototype.componentWillReceiveProps=function(e){var t=this.state;((this._nextProps=e).errorMessage||e.groupDeleteErrorMessage)&&this.setState({showSavingSpinner:!1,showDeletingSpinner:!1,saveButtonDisabled:!1,errorMessage:e.errorMessage});if(!e.showLoadingSpinner){void 0===t.privacySelectedKey&&this.setState({privacySelectedKey:e.privacySelectedKey});void 0===t.classificationSelectedKey&&this.setState({classificationSelectedKey:e.classificationSelectedKey});void 0===t.joinHubSiteSelectedKey&&this.setState({joinHubSiteSelectedKey:e.joinHubSiteSelectedKey})}e.hubDisplayType!==t.hubDisplayType&&this.setState({hubDisplayType:e.hubDisplayType});e.makeHubDisplayType!==t.makeHubDisplayType&&this.setState({makeHubDisplayType:e.makeHubDisplayType})};e.prototype.render=function(){var e,t=this.props,i=this.props,r=i.classificationOptions,n=i.classificationDescriptions,o=i.makeHubDisplayType,a=i.name,s=i.privacyOptions,l=i.groupNameValidationError,c=i.groupNameWithPrefixAndSuffix,d=i.isGroupNameValidationInProgress,u=this.state,p=h.default.title;if(t.showLoadingSpinner)e=m.createElement(x.Spinner,null);else if(u.showClassificationDescriptions){e=this._renderClassificationDescriptions();p=h.default.classificationDescriptionsTitle}else e=m.createElement("div",{className:"ms-SiteSettingsPanel-content"},this._renderSiteLogo(),this._renderUsageLink(),m.createElement("div",{className:"ms-SiteSettingsPanel-SiteInfo","data-automationid":"SiteSettingsPanelSiteInfo"},m.createElement(k.TextField,{className:C.css("ms-SiteSettingsPanel-nameText",{"prefix-suffix":!!c}),ref:"nameText",label:h.default.nameLabel,defaultValue:a,onChanged:this._onNameTextChanged,errorMessage:d?null:l,required:!0,"data-automationid":"SiteSettingsPanelNameText"}),d?m.createElement(x.Spinner,{label:h.default.validateGroupNameSpinnerLabel}):c?m.createElement("span",{className:"ms-SiteSettingsPanel-groupNameWithPrefixAndSuffix"},c):null,m.createElement(k.TextField,{ref:"descriptionText",label:h.default.descriptionLabel,defaultValue:t.description,multiline:!0,resizable:!1,"data-automationid":"SiteSettingsPanelDescriptionText"}),s&&s.length?m.createElement(_.Dropdown,{className:"ms-SiteSettingsPanel-PrivacyDropdown",ref:"privacyDropdown",label:h.default.privacyLabel,options:s,selectedKey:u.privacySelectedKey,onChanged:this._onPrivacyOptionChanged}):null,r&&r.length?m.createElement("div",{className:"ms-SiteSettingsPanel-classification"},m.createElement(v.Label,{className:"ms-Dropdown-label ms-SiteSettingsPanel-classificationDropDownLabel",htmlFor:this._classificationDropdownId},h.default.classificationLabel),n&&0<n.length?m.createElement(y.Link,{onClick:this._onClassificationDescriptionsClick,"data-automationid":"SiteSettingsPanelclassificationInfoIcon"},m.createElement(g.Icon,{iconName:"Info",className:"ms-SiteSettingsPanel-classificationInfoIcon"})):null,m.createElement(_.Dropdown,{className:"ms-SiteSettingsPanel-ClassificationDropdown",ref:"classificationDropdown",id:this._classificationDropdownId,options:r,selectedKey:u.classificationSelectedKey,onChanged:this._onClassificationOptionChanged})):null,this._renderJoinHubDropdown(),2===o?m.createElement(b.Checkbox,{className:"ms-SiteSettingsPanel-makeHubCheckbox",label:h.default.makeHubSiteLabel,checked:u.makeHubCheckboxChecked,onChange:this._onMakeHubCheckboxChecked,disabled:!!u.joinHubSiteSelectedKey}):null,u.errorMessage?m.createElement("div",{className:"ms-SiteSettingsPanel-ErrorMessage","data-automationid":"SiteSettingsPanelErrorMessage"},u.errorMessage):null,m.createElement("div",{className:"ms-SiteSettingsPanel-Buttons","data-automationid":"SiteSettingsPanelButtons"},m.createElement("span",{className:"ms-SiteSettingsPanelButton-container"},m.createElement(f.PrimaryButton,{className:"ms-SiteSettingsPanelButton-saveButton",disabled:u.saveButtonDisabled,onClick:this._onSaveClick,"data-automationid":"SiteSettingsPanelSaveButton"},h.default.saveButton)),m.createElement("span",{className:"ms-SiteSettingsPanelButton-container"},m.createElement(f.DefaultButton,{className:"ms-SiteSettingsPanelButton-cancelButton",onClick:this._onCancelClick,"data-automationid":"SiteSettingsPanelCancelButton"},h.default.closeButton))),u.showSavingSpinner?m.createElement(x.Spinner,{className:"ms-SiteSettingsPanel-savingSpinner"}):null,this._renderHelpTextFooter(),this._renderDeleteGroupLink()));return m.createElement(S.Panel,{className:"ms-SiteSettingsPanel",isOpen:u.showPanel,type:S.PanelType.smallFixedFar,onDismiss:this._closePanel,isLightDismiss:!0,closeButtonAriaLabel:h.default.closeButton,headerText:p},e,this._renderDeleteConfirmationDialog())};e.prototype._onMakeHubCheckboxChecked=function(e,t){c.Engagement.logData({name:"SiteSettingsPanel.MakeHub.Click",isIntentional:!0});this.setState({makeHubCheckboxChecked:t,hubDisplayType:t?0:this._nextProps.hubDisplayType})};e.prototype._onDeleteConfirmationCheckboxChange=function(e,t){this.setState({deleteConfirmationCheckboxChecked:t})};e.prototype._onDeleteConfirmationDialogAccept=function(){c.Engagement.logData({name:"SiteSettingsPanel.DeleteGroupConfirmation.Click"});this.setState({showDeletingSpinner:!0});this.props.onDeleteGroup&&this.props.onDeleteGroup()};e.prototype._onDeleteConfirmationDialogCancel=function(){this.setState({showDeleteConfirmationDialog:!1});this.props.onDeleteGroupDismiss&&this.props.onDeleteGroupDismiss()};e.prototype._onDeleteGroupClick=function(){c.Engagement.logData({name:"SiteSettingsPanel.DeleteGroup.Click"});this.props.deleteSiteFallbackUrl?window.location.href=this._nextProps.deleteSiteFallbackUrl:this.setState({showDeleteConfirmationDialog:!0,showDeletingSpinner:!1,deleteConfirmationCheckboxChecked:!1})};e.prototype._onSaveClick=function(e){var t=this.refs,i=t.nameText,r=t.descriptionText,n=t.imageBrowser,o=this.props,a=this.state;c.Engagement.logData({name:"SiteSettingsPanel.Save.Click"});this.setState({showSavingSpinner:!0,saveButtonDisabled:!0});if(o.onSave){var s=i&&i.value?i.value.trim():"",l=r&&r.value?r.value.trim():"";o.onSave(o.groupNameWithPrefixAndSuffix?o.groupNameWithPrefixAndSuffix:s,l,this._findDropdownOption(o.privacyOptions,a.privacySelectedKey),this._findDropdownOption(o.classificationOptions,a.classificationSelectedKey),n&&n.getImageFile(),this._findDropdownOption(o.joinHubSiteOptions,a.joinHubSiteSelectedKey),a.makeHubCheckboxChecked)}};e.prototype._onCancelClick=function(e){c.Engagement.logData({name:"SiteSettingsPanel.Cancel.Click"});this._closePanel()};e.prototype._onNameTextChanged=function(){var i=this.refs.nameText,r=i&&i.value?i.value.trim():"";if(this.props.onValidateGroupName){var e=new n.default(this);this.state.saveButtonDisabled||this.setState({saveButtonDisabled:!0});e.setTimeout(function(){var e=this,t=i&&i.value?i.value.trim():"";t===r&&this.props.onValidateGroupName(t).then(function(){e.setState({saveButtonDisabled:e.props.isGroupNameValidationInProgress||!Boolean(t)||Boolean(e.props.groupNameValidationError)})})}.bind(this),500)}else this.setState({saveButtonDisabled:!Boolean(r)})};e.prototype._onClassificationOptionChanged=function(e){this.setState({classificationSelectedKey:e.key,errorMessage:void 0})};e.prototype._onJoinHubSiteOptionChanged=function(e){this.setState({joinHubSiteSelectedKey:e.key,makeHubDisplayType:e.key?0:this._nextProps.makeHubDisplayType})};e.prototype._onPrivacyOptionChanged=function(e){this.setState({privacySelectedKey:e.key})};e.prototype._closePanel=function(){this.setState({showPanel:!1});this.props.onDismiss&&this.props.onDismiss()};e.prototype._findDropdownOption=function(e,t){return e&&e.filter(function(e){return e.key===t})[0]};e.prototype._renderJoinHubDropdown=function(){var e=this.props,t=this.state,i=e.hubDisplayType,r=e.joinHubSiteOptions,n=t.joinHubSiteSelectedKey;if(2!==i||!r.length)return null;var o=e.joinHubSiteSelectedKey!==n?n?h.default.joinHubSiteTip:h.default.disconnectHubSiteTip:null;return m.createElement("div",{className:"ms-SiteSettingsPanel-joinHubSite"},m.createElement(_.Dropdown,{className:"ms-SiteSettingsPanel-joinHubSiteDropdown",ref:"joinHubSiteDropdown",label:h.default.hubLabel,options:r,selectedKey:n,onChanged:this._onJoinHubSiteOptionChanged,disabled:!!t.makeHubCheckboxChecked}),m.createElement("span",{className:"ms-SiteSettingsPanel-hubDropdownTip",role:"alert"},m.createElement("span",{key:n||"none"},o)))};e.prototype._renderDeleteGroupLink=function(){var e=null;this.props.enableDelete&&(e=m.createElement("div",{className:"ms-SiteSettingsPanel-DeleteGroupLink"},m.createElement(y.Link,{onClick:this._onDeleteGroupClick,"data-automationid":"SiteSettingsPanelDeleteGroupLink"},m.createElement(g.Icon,{iconName:"Delete",className:"ms-SiteSettingsPanel-DeleteGroupLinkIcon"}),m.createElement("span",{className:"ms-SiteSettingsPanel-DeleteGroupLinkLabel"},h.default.deleteGroupLinkText))));return e};e.prototype._renderDeleteConfirmationDialog=function(){var e=this.props,t=e.enableDelete,i=e.groupDeleteErrorMessage,r=e.name,n=e.useDeleteSiteStrings,o=this.state,a=null;t&&(a=m.createElement(s.Dialog,{isOpen:o.showDeleteConfirmationDialog,type:s.DialogType.close,onDismiss:this._onDeleteConfirmationDialogCancel,isBlocking:!0,closeButtonAriaLabel:h.default.closeButton,title:n?h.default.deleteSiteConfirmationDialogTitle:h.default.deleteGroupConfirmationDialogTitle},m.createElement("div",null,d.format(n?h.default.deleteSiteConfirmationDialogText:h.default.deleteGroupConfirmationDialogText,r)),m.createElement(b.Checkbox,{className:"ms-SiteSettingsPanel-DeleteGroupConfirmationCheckbox",label:n?h.default.deleteSiteConfirmationDialogCheckbox:h.default.deleteGroupConfirmationDialogCheckbox,onChange:this._onDeleteConfirmationCheckboxChange}),i?m.createElement("div",{className:"ms-SiteSettingsPanel-ErrorMessage"},i):null,m.createElement(s.DialogFooter,null,m.createElement(f.PrimaryButton,{disabled:!o.deleteConfirmationCheckboxChecked||o.showDeletingSpinner,onClick:this._onDeleteConfirmationDialogAccept,text:h.default.deleteGroupConfirmationDialogButtonDelete}),m.createElement(f.DefaultButton,{onClick:this._onDeleteConfirmationDialogCancel,text:h.default.closeButton}),o.showDeletingSpinner?m.createElement(x.Spinner,null):null)));return a};e.prototype._renderHelpTextFooter=function(){var e=this.props.classicSiteSettingsUrl,t=null;if(e){var i=h.default.classicSiteSettingsHelpText.split("{0}");2===i.length&&(t=m.createElement("div",{className:"ms-SiteSettingsPanel-HelpText","data-automationid":"SiteSettingsPanelHelperText"},m.createElement("span",null,i[0]),m.createElement(y.Link,{href:e},h.default.classicSiteSettingsLinkText),m.createElement("span",null,i[1])))}return t};e.prototype._renderSiteLogo=function(){var e=this.props,t=this.props,i=t.siteLogo,r=t.showImageBrowser,n=null;i&&!r?n=m.createElement(l.GroupSiteLogo,{siteTitle:e.name,siteLogoUrl:i.imageUrl,siteAcronym:i.acronym,siteLogoBgColor:i.backgroundColor,disableSiteLogoFallback:!1}):r&&(n=m.createElement(a.ImageBrowser,{ref:"imageBrowser",emptyImageUrl:e.emptyImageUrl||"",initialPreviewUrl:i&&i.imageUrl,disableRemove:e.disableRemoveLogo,supportedImageTypes:o.SupportedImageTypes}));return m.createElement("div",{className:"ms-SiteSettingsPanel-SiteLogo","data-automationid":"SiteSettingsPanelSiteLogo"},m.createElement(v.Label,null,h.default.logoLabel),n)};e.prototype._renderUsageLink=function(){var e=this.props.usageGuidelinesUrl,t=null;e&&(t=m.createElement("div",{className:"ms-SiteSettingsPanel-UsageLink"},m.createElement(y.Link,{href:e,target:"_blank","data-automationid":"SiteSettingsPanelUsageLink"},h.default.usageGuidelinesLinkText)));return t};e.prototype._renderClassificationDescriptions=function(){var e=this.props.classificationDescriptions;return e&&0<e.length?m.createElement("div",{className:"ms-ClassificationDescriptions"},e.map(function(e,t){return m.createElement("div",{className:"ms-ClassificationDescriptions-item",key:t},m.createElement("div",{className:"ms-ClassificationDescriptions-itemTitle"},e.classificationTitle),m.createElement("div",{className:"ms-ClassificationDescriptions-itemDescription"},e.classificationDescription))}),m.createElement(f.PrimaryButton,{className:"ms-ClassificationDescriptions-dismissButton",onClick:this._onClassificationDescriptionsDismiss},h.default.classificationDescriptionDismiss)):null};e.prototype._onClassificationDescriptionsClick=function(){c.Engagement.logData({name:"SiteSettingsPanel.ClassificationDescriptions.Click"});this.setState({showClassificationDescriptions:!0})};e.prototype._onClassificationDescriptionsDismiss=function(){this.setState({showClassificationDescriptions:!1})};t.__decorate([C.autobind],e.prototype,"_onMakeHubCheckboxChecked",null);t.__decorate([C.autobind],e.prototype,"_onDeleteConfirmationCheckboxChange",null);t.__decorate([C.autobind],e.prototype,"_onDeleteConfirmationDialogAccept",null);t.__decorate([C.autobind],e.prototype,"_onDeleteConfirmationDialogCancel",null);t.__decorate([C.autobind],e.prototype,"_onDeleteGroupClick",null);t.__decorate([C.autobind],e.prototype,"_onSaveClick",null);t.__decorate([C.autobind],e.prototype,"_onCancelClick",null);t.__decorate([C.autobind],e.prototype,"_onNameTextChanged",null);t.__decorate([C.autobind],e.prototype,"_onClassificationOptionChanged",null);t.__decorate([C.autobind],e.prototype,"_onJoinHubSiteOptionChanged",null);t.__decorate([C.autobind],e.prototype,"_onPrivacyOptionChanged",null);t.__decorate([C.autobind],e.prototype,"_closePanel",null);t.__decorate([C.autobind],e.prototype,"_onClassificationDescriptionsClick",null);t.__decorate([C.autobind],e.prototype,"_onClassificationDescriptionsDismiss",null);return e}(m.Component);o.SiteSettingsPanel=i});define("HZ",["require","exports","ap","H0","H0"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=n.ImageBrowser});define("H0",["require","exports","ap","H1"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("H1",["require","exports","ap","at","jP","wN","mb","H4","H3","H2"],function(e,t,r,d,n,u,p,o,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={};return t}e.prototype.render=function(){var e,t,i=this.props,r=this.state,n=i.initialPreviewUrl,o=i.disableRemove,a="imageHeight"in i?i.imageHeight:96,s="imageWidth"in i?i.imageWidth:96,l="imageFit"in i?i.imageFit:p.ImageFit.contain,c=!1;if(r.newPreviewSrc){e=r.newPreviewSrc;t=!o}else if(n){e=n;t=!o}else{e=i.emptyImageUrl||"";t=!1;c=i.useUploadWithEmptyImage}return d.createElement("div",{className:"ms-ImageBrowser"},d.createElement(p.Image,{className:"ms-ImageBrowser-image",width:s,height:a,imageFit:l,src:e}),d.createElement(u.DefaultButton,{className:"ms-ImageBrowser-change",onClick:this._onChangeClick,ariaLabel:c?m.default.uploadAriaLabel:m.default.changeAriaLabel},c?m.default.uploadLabel:m.default.changeLabel),t&&d.createElement(u.DefaultButton,{className:"ms-ImageBrowser-remove",onClick:this._onRemoveClick,ariaLabel:m.default.removeAriaLabel},m.default.removeLabel),d.createElement("input",{ref:"fileBrowser",style:{display:"none"},type:"file",accept:(i.supportedImageTypes||["image/*"]).join(","),onChange:this._onImageChange,tabIndex:-1,multiple:!1}))};e.prototype.getImageFile=function(){return this.state.removeImage?null:this.state.fileToUpload};e.prototype._onChangeClick=function(){this.props.onChangeClick&&this.props.onChangeClick();var e=this.refs.fileBrowser;e&&e.click()};e.prototype._onImageChange=function(e){var t=this,i=e.target,r=i&&i.files&&i.files[0];r&&o.LocalFileReader.readFile(r).then(function(e){t.setState({newPreviewSrc:e,fileToUpload:r,removeImage:!1})})};e.prototype._onRemoveClick=function(){this.props.onRemoveClick&&this.props.onRemoveClick();this.setState({newPreviewSrc:void 0,fileToUpload:void 0,removeImage:!0})};r.__decorate([n.autobind],e.prototype,"_onChangeClick",null);r.__decorate([n.autobind],e.prototype,"_onImageChange",null);r.__decorate([n.autobind],e.prototype,"_onRemoveClick",null);return e}(d.Component);t.ImageBrowser=i;t.default=i});define("H4",["require","exports","ap","H5"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("H5",["require","exports","ax"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.readFile=function(i){if(!i)return Promise.resolve("");var r=new FileReader;return new Promise(function(e,t){r.onloadend=function(){return e(r.result)};r.onerror=function(e){return t(e.error)};r.readAsDataURL(i)})};return e}();t.LocalFileReader=i});
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   3.1.2
 */
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   3.1.2
 */
(function(){"use strict";function c(e){return"function"==typeof e}function t(){return function(){setTimeout(i,1)}}function i(){for(var e=0;e<C;e+=2){(0,E[e])(E[e+1]),E[e]=void 0,E[e+1]=void 0}C=0}function a(){}function s(e){try{return e.then}catch(e){return B.error=e,B}}function l(e,t,i){t.constructor===e.constructor&&i===D&&constructor.resolve===M?(o=e,(a=t)._state===O?u(o,a._result):a._state===A?p(o,a._result):m(a,void 0,function(e){d(o,e)},function(e){p(o,e)})):i===B?p(e,B.error):void 0===i?u(e,t):c(i)?(r=t,n=i,P(function(t){var i=!1,e=function(e,t,i,r){try{e.call(t,i,r)}catch(e){return e}}(n,r,function(e){i||(i=!0,r!==e?d(t,e):u(t,e))},function(e){i||(i=!0,p(t,e))},t._label);!i&&e&&(i=!0,p(t,e))},e)):u(e,t);var r,n,o,a}function d(e,t){e===t?p(e,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(i=t)||"object"==typeof i&&null!==i?l(e,t,s(t)):u(e,t);var i}function r(e){e._onerror&&e._onerror(e._result),h(e)}function u(e,t){e._state===N&&(e._result=t,e._state=O,0!==e._subscribers.length&&P(h,e))}function p(e,t){e._state===N&&(e._state=A,e._result=t,P(r,e))}function m(e,t,i,r){var n=e._subscribers,o=n.length;e._onerror=null,n[o]=t,n[o+O]=i,n[o+A]=r,0===o&&e._state&&P(h,e)}function h(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var r,n,o=e._result,a=0;a<t.length;a+=3)r=t[a],n=t[a+i],r?f(i,r,n,o):n(o);e._subscribers.length=0}}function e(){this.error=null}function f(e,t,i,r){var n,o,a,s,l=c(i);if(l){if((n=function(e,t){try{return e(t)}catch(e){return H.error=e,H}}(i,r))===H?(s=!0,o=n.error,n=null):a=!0,t===n)return void p(t,new TypeError("A promises callback cannot return that same promise."))}else n=r,a=!0;t._state!==N||(l&&a?d(t,n):s?p(t,o):e===O?u(t,n):e===A&&p(t,n))}function n(e){this._id=G++,this._state=void 0,this._result=void 0,this._subscribers=[],a!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof n?function(t,e){try{e(function(e){d(t,e)},function(e){p(t,e)})}catch(e){p(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}function o(e,t){this._instanceConstructor=e,this.promise=new e(a),Array.isArray(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?u(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&u(this.promise,this._result))):p(this.promise,this._validationError())}var g,b,_,v,y,S,x,k=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},C=0,P=function(e,t){E[C]=e,E[C+1]=t,2===(C+=2)&&(b?b(i):_())},I="undefined"!=typeof window?window:void 0,w=I||{},T=w.MutationObserver||w.WebKitMutationObserver,L="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),F="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,E=new Array(1e3);_=L?function(){process.nextTick(i)}:T?(y=0,S=new T(i),x=document.createTextNode(""),S.observe(x,{characterData:!0}),function(){x.data=y=++y%2}):F?((v=new MessageChannel).port1.onmessage=i,function(){v.port2.postMessage(0)}):void 0===I&&"function"==typeof require?function(){try{var e=require("vertx");return g=e.runOnLoop||e.runOnContext,function(){g(i)}}catch(e){return t()}}():t();var D=function(e,t){var i=this._state;if(i===O&&!e||i===A&&!t)return this;var r=new this.constructor(a),n=this._result;if(i){var o=arguments[i-1];P(function(){f(i,r,o,n)})}else m(this,r,e,t);return r},M=function(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(a);return d(t,e),t},N=void 0,O=1,A=2,B=new e,H=new e,U=function(e){function t(e){d(r,e)}function i(e){p(r,e)}var r=new this(a);if(!k(e))return p(r,new TypeError("You must pass an array to race.")),r;for(var n=e.length,o=0;r._state===N&&o<n;o++)m(this.resolve(e[o]),void 0,t,i);return r},R=function(e){var t=new this(a);return p(t,e),t},G=0,V=n;n.all=function(e){return new q(this,e).promise},n.race=U,n.resolve=M,n.reject=R,n._setScheduler=function(e){b=e},n._setAsap=function(e){P=e},n._asap=P,n.prototype={constructor:n,then:D,catch:function(e){return this.then(null,e)}};var q=o;o.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},o.prototype._enumerate=function(){for(var e=this.length,t=this._input,i=0;this._state===N&&i<e;i++)this._eachEntry(t[i],i)},o.prototype._eachEntry=function(t,e){var i=this._instanceConstructor,r=i.resolve;if(r===M){var n=s(t);if(n===D&&t._state!==N)this._settledAt(t._state,e,t._result);else if("function"!=typeof n)this._remaining--,this._result[e]=t;else if(i===V){var o=new i(a);l(o,t,n),this._willSettleAt(o,e)}else this._willSettleAt(new i(function(e){e(t)}),e)}else this._willSettleAt(r(t),e)},o.prototype._settledAt=function(e,t,i){var r=this.promise;r._state===N&&(this._remaining--,e===A?p(r,i):this._result[t]=i),0===this._remaining&&u(r,this._result)},o.prototype._willSettleAt=function(e,t){var i=this;m(e,void 0,function(e){i._settledAt(O,t,e)},function(e){i._settledAt(A,t,e)})};var W=function(){var e;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;(!t||"[object Promise]"!==Object.prototype.toString.call(t.resolve())||t.cast)&&(e.Promise=V)},z={Promise:V,polyfill:W};"function"==typeof define&&define.amd?define("ax",[],function(){return z}):"undefined"!=typeof module&&module.exports?module.exports=z:void 0!==this&&(this.ES6Promise=z),W()}).call(this);define("H2",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-ImageBrowser-image{margin-bottom:8px}[dir=ltr] .ms-ImageBrowser-change{margin-right:8px}[dir=rtl] .ms-ImageBrowser-change{margin-left:8px}"}])});define("Iy",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-SiteSettingsPanel-ErrorMessage{font-size:12px;font-weight:400;color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:";box-sizing:border-box;box-shadow:none;margin:0;padding:0;margin-top:20px;margin-bottom:13px}.ms-SiteSettingsPanel-content .ms-Label{font-size:14px;font-weight:400}.ms-SiteSettingsPanel-SiteLogo{margin:2px 0 24px}.ms-SiteSettingsPanel-SiteInfo .ms-spinner{margin-top:8px}.ms-SiteSettingsPanel-Buttons{padding-top:24px}.ms-SiteSettingsPanel-HelpText{padding-top:22px}.ms-SiteSettingsPanel-DeleteGroupConfirmationCheckbox{padding-top:20px}.ms-SiteSettingsPanel-DeleteGroupLink{padding-top:22px}.ms-SiteSettingsPanel-DeleteGroupLinkIcon{vertical-align:middle}.ms-SiteSettingsPanel-DeleteGroupLinkLabel{margin-left:4px;vertical-align:middle}.ms-SiteSettingsPanel-classificationDropDownLabel{padding:5px 0;font-size:12px;font-weight:400;display:inline-block}[dir=ltr] .ms-SiteSettingsPanel-classificationDropDownLabel{margin-right:5px}[dir=rtl] .ms-SiteSettingsPanel-classificationDropDownLabel{margin-left:5px}.ms-SiteSettingsPanel-classificationInfoIcon{vertical-align:middle}.ms-ClassificationDescriptions-item{margin-bottom:12px}.ms-ClassificationDescriptions-itemTitle{font-size:14px;font-weight:400;font-weight:600;padding:5px 0}.ms-ClassificationDescriptions-itemDescription{font-size:12px;font-weight:400}.ms-ClassificationDescriptions-dismissButton{margin-top:10px}.ms-SiteSettingsPanel-groupNameWithPrefixAndSuffix{font-size:12px;font-weight:400;display:inline-block;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";margin-bottom:8px}.ms-SiteSettingsPanel-nameText.prefix-suffix{margin-bottom:0}.ms-SiteSettingsPanel-hubDropdownTip{font-size:11px;font-weight:400}.ms-SiteSettingsPanel-makeHubCheckbox{margin-top:8px;display:none}[dir=ltr] .ms-SiteSettingsPanelButton-cancelButton{margin-left:8px}[dir=rtl] .ms-SiteSettingsPanelButton-cancelButton{margin-right:8px}.ms-SiteSettingsPanel-savingSpinner{padding-top:8px}"}])});define("Iw",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.hidden=0]="hidden";e[e.readOnly=1]="readOnly";e[e.enabled=2]="enabled"}(t.HubDisplayType||(t.HubDisplayType={}))});define("H6",["require","exports","ap","at","dn","It","H7","iE"],function(e,t,i,n,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=e.hostModel.resources;t._state=new s.SiteSettingsPanelContainerStateManager({siteSettingsPanelContainer:t,pageContext:i.consume(l.pageContext),emptyImageUrl:o.getIconUrl(i,"photo",96)});return t}e.prototype.componentDidMount=function(){this._state.componentDidMount()};e.prototype.componentWillUnmount=function(){this._state.componentWillUnmount()};e.prototype.render=function(){var e=this._state.getRenderProps();return n.createElement(a.SiteSettingsPanel,i.__assign({},e))};return e}(n.Component);t.SiteSettingsPanelContainer=r;t.default=r});define("H7",["require","exports","ap","H9","H8"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t)});define("H9",["require","exports","ap","bT","eq","aC","bE","vM","jP","Ij","If","Ib","GQ","It","HR","HT","a0","HP","aW","V","aG","Ia","bf"],function(e,t,i,d,m,h,u,p,r,f,g,b,_,v,y,n,a,S,c,s,o,x,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k="public",C=function(){function e(e){this._params=e;this._pageContext=e.pageContext;this._isGroup=m.isGroupWebContext(this._pageContext);this._isRootWeb=this._pageContext.webAbsoluteUrl===this._pageContext.siteAbsoluteUrl;this._isCommunicationSite=Number(this._pageContext.webTemplate)===o.WebTemplateType.sitePagePublishing;this._isClassificationDescriptionsFlightEnabled=c.default.isFeatureEnabled({ODB:257,ODC:null,Fallback:!1});this._isGroupNamingPolicyFlightEnabled=c.default.isFeatureEnabled({ODB:312,ODC:null,Fallback:!1});this._hubDataSource=new n.HubDataSource(this._pageContext);this._enableDelete=c.default.isFeatureEnabled({ODB:116})&&(this._isGroup||this._isCommunicationSite||!this._isRootWeb)}e.prototype.componentDidMount=function(){var a=this,e=this._params,t=[],i=e.pageContext;this._spListCollectionDataSource=new _.SPListCollectionDataSource(i);this._acronymDataSource=new p.AcronymAndColorDataSource(i);var r=this._acronymDataSource.getAcronymData(i.webTitle);t.push(r);r.done(function(e){a.setState({siteAcronym:e.acronym,siteLogoColor:a._isGroup?i.groupColor:e.color})});this._setUpHubOptions(t);if(this._isGroup){this._groupsProvider=new f.GroupsProvider({pageContext:e.pageContext});var n=this._groupsProvider.group,o=new u.default;this._eventGroup=new d.default(this);this._eventGroup.on(n,f.Group.onSourceChange,function(e){if(e===f.SourceType.Server){a.setState({name:n.name,description:n.description,privacyOptions:a._getPrivacyOptions(n),privacySelectedKey:n.isPublic?k:"private",siteLogoUrl:a._getSiteLogoUrl(n),hasPictureUrl:n.hasPictureUrl});o.complete(n)}});n.load(!0);var s=o.getPromise();this._groupSiteProvider=new g.GroupSiteProvider({pageContext:i});var l=this._groupSiteProvider.getGroupCreationContext();t.push(s);t.push(l);h.default.all([s,l]).done(function(e){var t=e[0];a._creationContext=e[1];var i=t.classification,r=!1,n=a._creationContext&&a._creationContext.dataClassificationOptions&&0<a._creationContext.dataClassificationOptions.length?a._creationContext.dataClassificationOptions.map(function(e){e===t.classification&&(r=!0);return{key:e,text:e}}):[];i&&!r&&n.push({key:t.classification,text:t.classification});var o=a._isClassificationDescriptionsFlightEnabled&&a._creationContext&&a._creationContext.classificationDescriptions?a._creationContext.classificationDescriptions:[];void 0===i&&0<n.length&&(i=n[0].key);a.setState({classificationOptions:n,classificationSelectedKey:i,usageGuidelinesUrl:a._creationContext&&a._creationContext.usageGuidelineUrl||void 0,classificationDescriptions:o})})}else{this._spSiteProvider=new b.SPSiteProvider({pageContext:i});this._webDataSource=new y.WebDataSource(i);var c=this._webDataSource.getBasicWebProperties(!0);c.done(function(e){a.setState({description:e.description,name:e.title,siteLogoUrl:e.siteLogoUrl,hasPictureUrl:!0})});t.push(c)}h.default.all(t).done(function(){a.setState({isLoading:!1})})};e.prototype.componentWillUnmount=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=null}};e.prototype.getRenderProps=function(){var e=this._params,t=e.pageContext,i=e.siteSettingsPanelContainer.state||{},r=Number(t.webTemplate);return{name:i.name||"",description:i.description||"",privacyOptions:i.privacyOptions||[],privacySelectedKey:i.privacySelectedKey||"",classificationOptions:i.classificationOptions||[],classificationSelectedKey:i.classificationSelectedKey||"",showLoadingSpinner:"boolean"!=typeof i.isLoading||i.isLoading,showImageBrowser:c.default.isFeatureEnabled({ODB:117})&&i.hasPictureUrl,hubDisplayType:i.hubDisplayType,makeHubDisplayType:i.makeHubDisplayType,enableDelete:this._enableDelete,errorMessage:i.errorMessage,groupDeleteErrorMessage:i.groupDeleteErrorMessage,useDeleteSiteStrings:!this._isGroup,classicSiteSettingsUrl:t.webAbsoluteUrl+"/_layouts/15/settings.aspx",deleteSiteFallbackUrl:this._isGroup||this._isRootWeb&&!l.Killswitch.isActivated("57B712A0-FA84-4081-85F6-E4F9E8AB2FAF")&&(r===o.WebTemplateType.group||r===o.WebTemplateType.sitePagePublishing||"STS#3"===t.webTemplateConfiguration)?null:t.webAbsoluteUrl+"/_layouts/15/deleteweb.aspx",usageGuidelinesUrl:i.usageGuidelinesUrl,emptyImageUrl:e.emptyImageUrl,disableRemoveLogo:this._isGroup,classificationDescriptions:i.classificationDescriptions,joinHubSiteOptions:i.joinHubSiteOptions,joinHubSiteSelectedKey:i.joinHubSiteSelectedKey,isHubSite:t.isHubSite,siteLogo:{imageUrl:i.siteLogoUrl,acronym:i.siteAcronym,backgroundColor:i.siteLogoColor},onDeleteGroup:this._onDeleteGroup,onDeleteGroupDismiss:this._onDeleteGroupDismiss,onSave:this._onSave,onValidateGroupName:this._isGroup&&this._isGroupNamingPolicyFlightEnabled?this._onValidateGroupName:void 0,groupNameValidationError:i.groupNameValidationError,groupNameWithPrefixAndSuffix:i.groupNameWithPrefixAndSuffix,isGroupNameValidationInProgress:i.isGroupNameValidationInProgress}};e.prototype.setState=function(e){this._params.siteSettingsPanelContainer.setState(e)};e.prototype._getSharePointHomePageUrl=function(){var e=this._pageContext;return e.webAbsoluteUrl&&e.webServerRelativeUrl?m.getServerUrl(e)+"/_layouts/15/sharepoint.aspx":void 0};e.prototype._setUpHubOptions=function(e){var i=this,t=this._pageContext,r=t.isSiteAdmin,n=t.isHubSite,o=t.hubSiteId,a=o&&!n;if(c.default.isFeatureEnabled({ODB:367})&&r&&this._isRootWeb){if(!n){var s=new u.default;this.setState({hubDisplayType:a?1:2});this._hubDataSource.getHubSites().then(function(e){var t=e?e.map(function(e){return{key:e.id,text:e.name}}):[];if(0<t.length){t.unshift({key:"",text:x.default.joinHubSiteNoneOptionName});o&&(t[0].ariaLabel=x.default.joinHubSiteNoneOptionName+", "+v.SiteSettingsPanelResx.disconnectHubSiteTip)}i.setState({joinHubSiteOptions:t,joinHubSiteSelectedKey:o,hubDisplayType:t.length?2:1});s.complete()},function(){return s.complete()});e.push(s.getPromise())}if(n||!o){var l=new u.default;this._hubDataSource.canCreateHubSite().then(function(e){e&&i.setState({makeHubDisplayType:2});l.complete()},function(){return l.complete()});e.push(l.getPromise())}}};e.prototype._getSiteLogoUrl=function(e){var t=this._pageContext.webLogoUrl;t===m.DEFAULT_LOGO_URL&&(t=e.pictureUrl);return t};e.prototype._getPrivacyOptions=function(e){return[{key:"private",text:x.default.privacyOptionPrivate},{key:k,text:x.default.privacyOptionPublic}]};e.prototype._onDeleteGroup=function(){var e,t=this;e=this._isGroup?this._groupsProvider.deleteGroup(this._groupsProvider.group):this._isRootWeb?this._spSiteProvider.deleteSite(this._pageContext.siteId):this._webDataSource.delete();this.setState({groupDeleteErrorMessage:null});e.then(function(){window.location.href=t._getSharePointHomePageUrl()},function(e){if(404!==e.status){t.setState({groupDeleteErrorMessage:t._getErrorString(e)});throw e}window.location.href=t._getSharePointHomePageUrl()})};e.prototype._onDeleteGroupDismiss=function(){this.setState({groupDeleteErrorMessage:null})};e.prototype._onSave=function(e,t,i,r,n,o,a){var s=this;this.setState({errorMessage:null});var l=o&&o.key;if(this._isGroup){var c=this._groupsProvider.group;c.name=e;c.description=t;c.isPublic=i.key===k;if(this._creationContext&&this._creationContext.dataClassificationOptions&&0<this._creationContext.dataClassificationOptions.length){if(!(r&&-1<this._creationContext.dataClassificationOptions.indexOf(r.text))){this.setState({errorMessage:x.default.classificationOptionsChanged});return}c.classification=r.text}this._groupsProvider.saveGroupProperties(c).then(function(){if(void 0!==n){if(n){if(-1===v.SupportedImageTypes.indexOf(n.type))throw new Error(x.default.setLogoUnsupportedTypeError);if(n.size>v.MaxImageFileSize)throw new Error(x.default.setLogoTooBigError)}return s._groupsProvider.setGroupImage(n).catch(function(e){throw new Error(x.default.setLogoGenericError)})}}).then(function(){return s._updateHubState(l,a)}).then(function(){return s._groupsProvider.syncGroupProperties()}).then(function(){return window.location.reload()}).catch(function(e){return s.setState({errorMessage:s._getErrorString(e)})})}else{var d={description:t,title:e},u=h.default.resolve(d);if(n){var p="__sitelogo__"+n.name;u=S.uploadThumbnailToSiteAssets(this._spListCollectionDataSource,this._webDataSource,p,n).then(function(e){d.siteLogoUrl=m.getServerUrl(s._pageContext)+e.serverRelativeUrl;return d})}else null===n&&(d.siteLogoUrl="");u.then(function(e){return s._webDataSource.setBasicWebProperties(e)}).then(function(){return s._updateHubState(l,a)}).then(function(){return window.location.reload()}).catch(function(e){s.setState({errorMessage:s._getErrorString(e)})})}};e.prototype._updateHubState=function(e,t){var i,r=this._hubDataSource,n=this._params.siteSettingsPanelContainer.state;if(2===n.hubDisplayType){var o=this._pageContext.hubSiteId;e=e||"";if(o&&!e){a.Engagement.logData({name:"SiteSettingsPanel.LeaveHub",isIntentional:!0});i=r.joinHubSite(e)}if(e&&o!==e){a.Engagement.logData({name:o?"SiteSettingsPanel.SwitchHub":"SiteSettingsPanel.JoinHub",isIntentional:!0});i=r.joinHubSite(e)}}if(!i&&2===n.makeHubDisplayType&&"boolean"==typeof t&&t!==!!this._pageContext.isHubSite)if(t){i=r.makeHubSite();a.Engagement.logData({name:"SiteSettingsPanel.MakeHubSite",isIntentional:!0})}else{i=r.removeHubSite().then(function(){return r.joinHubSite("")});a.Engagement.logData({name:"SiteSettingsPanel.RemoveHubSite",isIntentional:!0})}return i};e.prototype._getErrorString=function(e){return e&&e.message&&e.message.value||x.default.genericError};e.prototype._onValidateGroupName=function(i){var r,n,t=this,e=this._groupsProvider.group&&this._groupsProvider.group.alias?this._groupsProvider.group.alias:void 0;this.setState({isGroupNameValidationInProgress:!0,groupNameValidationError:void 0,groupNameWithPrefixAndSuffix:void 0});if(!i){this.setState({isGroupNameValidationInProgress:!1,groupNameValidationError:x.default.displayNameEmptyStringError,groupNameWithPrefixAndSuffix:n});return h.default.resolve(void 0)}var o=function(e){var t;2===e.validationErrorCode&&(t=e.blockedWord?s.format(x.default.displayNameContainsCustomBlockedWordError,e.blockedWord):x.default.displayNameContainsStandardBlockedWordError);return t},a=function(e){e&&e.message&&t._params.siteSettingsPanelContainer.state&&t._params.siteSettingsPanelContainer.state.isGroupNameValidationInProgress&&t.setState({isGroupNameValidationInProgress:!1,groupNameValidationError:e.message.value})};return this._groupSiteProvider.validateGroupName(i,e).then(function(e){if(e.displayNameErrorDetails){var t=e.displayNameErrorDetails;1===t.validationErrorCode?n=[t.prefix,i,t.suffix].join(""):r=o(t)}},function(e){a(e)}).then(function(){return n?t._groupSiteProvider.validateGroupName(n,e):h.default.resolve(void 0)}).then(function(e){e&&e.displayNameErrorDetails&&(r=o(e.displayNameErrorDetails));t._params.siteSettingsPanelContainer.state&&t._params.siteSettingsPanelContainer.state.isGroupNameValidationInProgress&&t.setState({isGroupNameValidationInProgress:!1,groupNameValidationError:r,groupNameWithPrefixAndSuffix:n})},function(e){a(e)})};i.__decorate([r.autobind],e.prototype,"_onDeleteGroup",null);i.__decorate([r.autobind],e.prototype,"_onDeleteGroupDismiss",null);i.__decorate([r.autobind],e.prototype,"_onSave",null);i.__decorate([r.autobind],e.prototype,"_onValidateGroupName",null);return e}();t.SiteSettingsPanelContainerStateManager=C});define("Ib",["require","exports","ap","fz","Id","Ic"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(o,t)});define("Id",["require","exports","ap","Ie","V","aZ"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){r.__extends(i,e);function i(){return null!==e&&e.apply(this,arguments)||this}i.prototype.getSiteStatus=function(e){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+n.format("/_api/SPSiteManager/status?url='{0}'",e)},function(e){return i._parseSiteInfoResponse(e,"Status")},"GetSiteStatus",void 0,"GET",void 0,void 0,3)};i.prototype.createSite=function(t){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/SPSiteManager/Create"},function(e){return i._parseSiteInfoResponse(e,"Create")},"CreateSite",function(){var e={request:{__metadata:{type:"Microsoft.SharePoint.Portal.SPSiteCreationRequest"},WebTemplate:t.webTemplate,Title:t.title,Url:t.url,Description:t.description,Classification:t.classification,SiteDesignId:t.siteDesignId,Lcid:t.lcid?t.lcid:void 0,ShareByEmailEnabled:t.shareByEmailEnabled,WebTemplateExtensionId:t.webTemplateExtensionId?t.webTemplateExtensionId:o.default.Empty}};return JSON.stringify(e)},"POST",void 0,void 0,3)};i.prototype.deleteSite=function(t){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/SPSiteManager/Delete"},void 0,"DeleteSite",function(){var e={siteId:t};return JSON.stringify(e)},"POST",void 0,void 0,3)};i._parseSiteInfoResponse=function(e,t){var i=JSON.parse(e);if(!i.d||!i.d[t])return{siteStatus:3};var r=i.d[t];return{siteUrl:r.SiteUrl,siteStatus:r.SiteStatus}};return i}(i.default);t.SPSiteCreationDataSource=a;t.default=a});define("Ic",["require","exports","aC","Id"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._dataSource=e.dataSource||new r.SPSiteCreationDataSource(e.pageContext)}e.prototype.checkSiteExists=function(e){return this._dataSource.checkSiteExists(e)};e.prototype.createSite=function(e){return this._dataSource.createSite(e)};e.prototype.getSiteStatus=function(e){return e?this._dataSource.getSiteStatus(e):i.default.reject("Missing site url.")};e.prototype.deleteSite=function(e){return this._dataSource.deleteSite(e)};return e}();t.SPSiteProvider=n;t.default=n});define("GQ",["require","exports","ap","GS","ey","GR"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(o,t)});define("GS",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.off=0]="off";e[e.on=1]="on";e[e.defaultVaule=2]="defaultVaule"}(t.QuickLaunchOptions||(t.QuickLaunchOptions={}))});define("GR",["require","exports","ap","ef","aM"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){r.__extends(e,i);function e(){return null!==i&&i.apply(this,arguments)||this}e.prototype.getDataSourceName=function(){return"ListCollectionDataSource"};e.prototype.createList=function(e){var t=this;return i.prototype.getData.call(this,function(){return n.default.escapeUrlForCallback(t._pageContext.webAbsoluteUrl)+"/_api/web/lists?&$expand=DefaultViewUrl"},function(e){return t._getSPList(e)},"CreateList",function(){return t._constructCreateListBody(e)})};e.prototype.ensureSiteAssetsLibrary=function(){var t=this;return i.prototype.getData.call(this,function(){return n.default.escapeUrlForCallback(t._pageContext.webAbsoluteUrl)+"/_api/web/lists/ensureSiteAssetsLibrary()"},function(e){return t._getSPList(e)},"EnsureSiteAssetsLibrary")};e.prototype._constructCreateListBody=function(e){return JSON.stringify({__metadata:{type:"SP.List"},BaseTemplate:e.templateType,Description:e.description,Title:e.title,OnQuickLaunch:0!==e.quickLaunchOption})};e.prototype._getSPList=function(e){var t=JSON.parse(e);if(t&&t.d){var i=t.d;return{title:i.Title,description:i.Description,defaultViewUrl:i.DefaultViewUrl,baseTemplate:i.BaseTemplate,hidden:i.Hidden,id:i.Id}}};return e}(i.default);t.SPListCollectionDataSource=o;t.default=o});define("HR",["require","exports","ap","HS"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("HS",["require","exports","ap","fB","eq","aM"],function(e,t,r,i,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){r.__extends(i,t);function i(e){return t.call(this,e,i._dataSourceName+"("+(e?e.webId:"")+")")||this}i.prototype.getDataSourceName=function(){return i._dataSourceName};i.prototype.addFileToWebList=function(e,t,i,r){var n=r?"true":"false",o=l.default.encodeRestUriStringToken(t),a=s.getSafeWebServerRelativeUrl(this._pageContext)+"/_api/Web/Lists('"+e+"')/RootFolder/Files/Add(Overwrite="+n+",Url='"+o+"')";return this.dataRequestor.getData({url:a,qosName:"AddFileToWebList",method:"POST",noRedirect:!0,additionalPostData:i,contentType:i.type,parseResponse:function(e){var t=JSON.parse(e);return t&&t.d?{name:t.d.Name,serverRelativeUrl:t.d.ServerRelativeUrl}:{name:void 0,serverRelativeUrl:void 0}}})};i.prototype.delete=function(){var e=this;return this.getData(function(){return s.getSafeWebServerRelativeUrl(e._pageContext)+"/_api/Web"},void 0,"DeleteWeb",void 0,"DELETE")};i.prototype.getBasicWebProperties=function(e){var t=this;return this.getDataUtilizingCache({getUrl:function(){return s.getSafeWebServerRelativeUrl(t._pageContext)+"/_api/Web?$select=Title,Description,SiteLogoUrl"},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d?{description:t.d.Description,siteLogoUrl:t.d.SiteLogoUrl,title:t.d.Title}:{description:void 0,siteLogoUrl:void 0,title:void 0}},qosName:"GetBasicWebProperties",method:"GET",noRedirect:!0,bypassCache:!!e})};i.prototype.setBasicWebProperties=function(t){var e=this;return this.getData(function(){return s.getSafeWebServerRelativeUrl(e._pageContext)+"/_api/Web"},void 0,"SetBasicWebProperties",function(){var e={__metadata:{type:"SP.Web"},Description:t.description,SiteLogoUrl:t.siteLogoUrl,Title:t.title};return JSON.stringify(e)},"PATCH")};i._dataSourceName="WebDataSource";return i}(i.default);t.WebDataSource=n;t.default=n});define("HT",["require","exports","ap","Go"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Go",["require","exports","ap","Gl","fB","aC","aM","aZ"],function(e,t,i,o,r,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){i.__extends(e,t);function e(e){return t.call(this,e,"HubDataSource",{cacheTimeoutTime:36e5})||this}e.prototype.getHubData=function(i,r){var n=this,e=this._pageContext.hubSiteId,t=r;!r&&this.isCachedDataInvalidated(e)&&(r=!0);return this.getDataUtilizingCache({getUrl:function(){return n._pageContext.webAbsoluteUrl+"/_api/web/HubSiteData"+(r?"(true)":"")},qosName:"GetHubData",cacheRequestKey:e,bypassCache:r,setInvalidated:t,parseResponse:function(e){return JSON.parse(JSON.parse(e).d.HubSiteData)}}).then(function(e){var t=e?{name:e.name,logoUrl:e.logoUrl,url:e.url,usesMetadataNavigation:e.usesMetadataNavigation,navigation:o.default.transformNodesToLinks(e.navigation||[]),themeKey:e.themeKey}:void 0;return i?n._ensureHubNavData(t,r):t})};e.prototype.joinHubSite=function(e){e||(e=s.default.Empty);return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/JoinHubSite(@v1)?@v1='"+a.default.encodeRestUriStringToken(e)+"'",qosName:"JoinHubSite",parseResponse:function(){}})};e.prototype.makeHubSite=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/RegisterHubSite",qosName:"MakeHubSite",parseResponse:function(e){return JSON.parse(e).d}}).then(function(e){return e?{etag:e.__metadata.etag,id:e.ID,siteId:e.SiteId,siteUrl:e.SiteUrl,logoUrl:e.LogoUrl,name:e.Title,description:e.Description,targets:e.Targets}:void 0})};e.prototype.removeHubSite=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/site/UnregisterHubSite",qosName:"RemoveHubSite",parseResponse:function(){}})};e.prototype.getHubSites=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/HubSites",qosName:"GetHubSites",method:"GET",parseResponse:function(e){return JSON.parse(e).d.results}}).then(function(e){return e?e.map(function(e){return{etag:e.__metadata.etag,id:e.ID,siteId:e.SiteId,siteUrl:e.SiteUrl,logoUrl:e.LogoUrl,name:e.Title,description:e.Description,targets:e.Targets}}):void 0})};e.prototype.getHubSite=function(e){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/HubSites/GetById('"+e+"')",qosName:"GetHubSite",parseResponse:function(e){return JSON.parse(e).d}}).then(function(e){return e?{etag:e.__metadata.etag,id:e.ID,siteId:e.SiteId,siteUrl:e.SiteUrl,logoUrl:e.LogoUrl,name:e.Title,description:e.Description,targets:e.Targets}:void 0})};e.prototype.updateHubSite=function(e){var t={__metadata:{etag:e.etag,type:"SP.HubSite"},LogoUrl:e.logoUrl,Title:e.name,Description:e.description||"",Targets:e.targets};return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/HubSites/GetById('"+e.id+"')",qosName:"UpdateHubSite",method:"POST",additionalPostData:JSON.stringify(t),additionalHeaders:{"X-HTTP-Method":"MERGE","If-Match":"*"}})};e.prototype.canCreateHubSite=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/SP.HubSites.CanCreate",qosName:"CanCreateHubSite",parseResponse:function(e){return JSON.parse(e).d.CanCreate}})};e.prototype.syncHubSiteTheme=function(){return this.dataRequestor.getData({url:this._pageContext.webAbsoluteUrl+"/_api/web/SyncHubSiteTheme",qosName:"SyncHubSiteTheme",parseResponse:function(){}})};e.prototype.getDataSourceName=function(){return"HubDataSource"};e.prototype._ensureHubNavData=function(i,e){if(i&&i.usesMetadataNavigation){var t=this._pageContext,r={env:t.env,killSwitches:t.killSwitches,layoutsUrl:t.layoutsUrl,siteAbsoluteUrl:i.url,siteClientTag:"",webAbsoluteUrl:i.url,webServerRelativeUrl:null,webTemplate:null,hasManageWebPermissions:!1,systemUserKey:t.systemUserKey,userDisplayName:t.userDisplayName,userId:t.userId,userLoginName:t.userLoginName,userEmail:t.userEmail};return new o.default(r,"GlobalNavigationSwitchableProvider").getMenuState({useCache:!0,forceRefresh:e}).then(function(e){var t=e&&e.links||[];return{name:i.name,logoUrl:i.logoUrl,url:i.url,usesMetadataNavigation:i.usesMetadataNavigation,navigation:t}})}return n.default.resolve(i)};return e}(r.default);t.HubDataSource=l;t.default=l});define("HP",["require","exports","HQ","aC"],function(e,t,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=648,l=648;function c(e,t,i,r){return e.ensureSiteAssetsLibrary().then(function(e){return t.addFileToWebList(e.id,i,r,!0)})}t.uploadToSiteAssets=c;t.uploadThumbnailToSiteAssets=function(t,i,r,n){return("image/svg+xml"===n.type?a.default.resolve(n):o.createImageThumbnail(n,s,l)).then(function(e){return c(t,i,r,n)})}});define("HQ",["require","exports","bT","aC"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createImageThumbnail=function(o,a,s){return function(e){var n=new i.default(this);return new r.default(function(t,i){var r=new FileReader;n.on(r,"load",function(e){t(r.result);n.dispose()});n.on(r,"error",function(e){i(r.error);n.dispose()});r.readAsDataURL(e)})}(o).then(function(e){var t=document.createElement("img");t.src=e;var i=t.width,r=t.height;if(r<i){if(a<i){r*=a/i;i=a}}else if(s<r){i*=s/r;r=s}i=Math.floor(i);r=Math.floor(r);if(i===t.width&&r===t.height)return o;var n=document.createElement("canvas");n.width=i;n.height=r;n.getContext("2d").drawImage(t,0,0,i,r);return function(e){for(var t=atob(e.split(",")[1]),i=new Uint8Array(t.length),r=e.split(",")[0].split(":")[1].split(";")[0],n=0,o=t.length;n<o;n++)i[n]=t.charCodeAt(n);return new Blob([i],{type:r})}("image/jpeg"===o.type?n.toDataURL(o.type,.92):n.toDataURL(o.type))})}});define("H8",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});define("HU",["require","exports","ap","HV","HV"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=n.HubSettingsPanel});define("HV",["require","exports","ap","HX","HW"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.HubSettingsPanelResx=n.default});define("HX",["require","exports","ap","at","wN","BZ","Du","o1","BT","jP","a0","HZ","HW","HY"],function(e,t,n,r,o,a,s,l,c,d,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function h(e,t,i,r){void 0===i&&(i=!0);void 0===r&&(r={});u.Engagement.logData({name:"HubSettingsPanel."+e,isIntentional:i,extraData:n.__assign({},r,{hubSiteId:t&&t.hubSiteId})})}t.logHubSettingsEvent=h;var i=function(i){n.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isPanelOpen:!0,showLoadingSpinner:!0,saveButtonDisabled:!0};return t}e.prototype.componentDidMount=function(){h("Opened",this.props.pageContext)};e.prototype.componentWillReceiveProps=function(e){e.isPanelOpen!==this.props.isPanelOpen&&this.setState({isPanelOpen:e.isPanelOpen});e.initialHubSettings!==this.props.initialHubSettings&&this.setState({showLoadingSpinner:!1,saveButtonDisabled:!1,errorMessage:e.errorMessage,showSavingSpinner:!1});e.errorMessage!==this.props.errorMessage&&this.setState({errorMessage:e.errorMessage})};e.prototype.render=function(){var e=this.props,t=this.state,i=e.initialHubSettings;return r.createElement(s.Panel,{className:"ms-HubSettingsPanel",isOpen:t.isPanelOpen,type:s.PanelType.smallFixedFar,onDismiss:this._onCancelClick,isLightDismiss:!0,closeButtonAriaLabel:m.default.cancelButton,headerText:m.default.panelTitle},t.showLoadingSpinner?r.createElement(l.Spinner,{label:m.default.loadingSpinner}):r.createElement("div",{className:"ms-HubSettingsPanelContent"},r.createElement("div",{className:"ms-HubSettingsPanel-Logo"},r.createElement(a.Label,null,m.default.logo),r.createElement(p.ImageBrowser,{ref:"imageBrowser",imageHeight:96,imageWidth:void 0,imageFit:void 0,emptyImageUrl:e.emptyImageUrl,initialPreviewUrl:i.logoUrl,onChangeClick:this._onClickChangeImage,onRemoveClick:this._onClickRemoveImage,useUploadWithEmptyImage:!0})),r.createElement(c.TextField,{ref:"nameText",className:"ms-HubSettingsPanel-Name",label:m.default.name,defaultValue:i.name,onChanged:this._onNameChanged,required:!0}),e.errorMessage&&r.createElement("div",{className:"ms-HubSettingsPanel-ErrorMessage"},e.errorMessage),r.createElement("div",{className:"ms-HubSettingsPanel-Buttons"},r.createElement(o.PrimaryButton,{className:"ms-HubSettingsPanel-SaveButton",disabled:t.saveButtonDisabled,onClick:this._onSaveClick},m.default.saveButton),r.createElement(o.DefaultButton,{className:"ms-HubSettingsPanel-CancelButton",disabled:t.showSavingSpinner,onClick:this._onCancelClick},m.default.cancelButton)),t.showSavingSpinner?r.createElement(l.Spinner,{className:"ms-HubSettingsPanel-Spinner",label:m.default.savingSpinner}):null))};e.prototype._onSaveClick=function(e){var t=this.props;h("Save.Click",t.pageContext);this.setState({showSavingSpinner:!0,saveButtonDisabled:!0});if(t.onSave){var i=this.refs,r=i.nameText,n=i.imageBrowser,o=r&&r.value&&r.value.trim()||"",a=n&&n.getImageFile();t.onSave(o,a)}if(e){e.stopPropagation();e.preventDefault()}};e.prototype._onCancelClick=function(e){h("Cancel.Click",this.props.pageContext);this.setState({isPanelOpen:!1});if(e){e.stopPropagation();e.preventDefault()}};e.prototype._onNameChanged=function(){var e=this.refs.nameText,t=e&&e.value||"";this.setState({saveButtonDisabled:!t.trim()})};e.prototype._onClickChangeImage=function(){h("ChangeLogo.Click",this.props.pageContext)};e.prototype._onClickRemoveImage=function(){h("RemoveLogo.Click",this.props.pageContext)};n.__decorate([d.autobind],e.prototype,"_onSaveClick",null);n.__decorate([d.autobind],e.prototype,"_onCancelClick",null);n.__decorate([d.autobind],e.prototype,"_onNameChanged",null);n.__decorate([d.autobind],e.prototype,"_onClickChangeImage",null);n.__decorate([d.autobind],e.prototype,"_onClickRemoveImage",null);return e}(d.BaseComponent);t.HubSettingsPanel=i});define("HY",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-HubSettingsPanel{margin-top:50px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.ms-HubSettingsPanel-Logo{margin-bottom:12px}.ms-HubSettingsPanelContent .ms-Label{font-size:14px;font-weight:400}.ms-HubSettingsPanel-Buttons{margin-top:24px}html[dir=ltr] .ms-HubSettingsPanel-CancelButton{margin-left:8px}html[dir=rtl] .ms-HubSettingsPanel-CancelButton{margin-right:8px}.ms-HubSettingsPanel-Spinner{margin-top:8px}.ms-HubSettingsPanel-ErrorMessage{font-size:12px;font-weight:400;color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:";box-sizing:border-box;box-shadow:none;margin:0;padding:0;margin-top:20px;margin-bottom:13px}"}])});define("HN",["require","exports","ap","HO"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("HO",["require","exports","ap","jP","HT","GQ","HR","eq","HP","aC","HU"],function(e,t,c,i,r,n,o,d,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this._params=e;this._params.hubSettingsPanelContainer.state={isPanelOpen:!0}}e.prototype.componentDidMount=function(){var t=this,e=this._params.pageContext;this._hubDataSource=new r.HubDataSource(e);this._spListCollectionDataSource=new n.SPListCollectionDataSource(e);this._webDataSource=new o.WebDataSource(e);this._hubDataSource.getHubSite(e.hubSiteId).done(function(e){if(e){t._hubSite=e;t.setState({initialHubSettings:e})}})};e.prototype.componentWillUnmount=function(){};e.prototype.getRenderProps=function(){var e=this._params,t=e.hubSettingsPanelContainer.state;return c.__assign({},t,{emptyImageUrl:e.emptyImageUrl,onSave:this._onSaveClick,pageContext:e.pageContext})};e.prototype.setState=function(e){this._params.hubSettingsPanelContainer.setState(e)};e.prototype._onSaveClick=function(t,e){var i=this;this.setState({errorMessage:null});var r,n,o=this._params,a=this._hubSite,s=a.name||"";t=(t||s||"").trim();if(e){var l="__hubLogo__"+e.name;n=u.uploadThumbnailToSiteAssets(this._spListCollectionDataSource,this._webDataSource,l,e).then(function(e){return d.getServerUrl(o.pageContext)+e.serverRelativeUrl})}else n=null===e?p.default.resolve(null):p.default.resolve(a.logoUrl);n.then(function(e){if(t!==s){r=!0;m.logHubSettingsEvent("UpdateName",o.pageContext)}if(e!==a.logoUrl){r=!0;m.logHubSettingsEvent("UpdateLogo",o.pageContext);e||m.logHubSettingsEvent("SaveRemoveLogo",o.pageContext)}if(r)return i._hubDataSource.updateHubSite(c.__assign({},a,{name:t,logoUrl:e,description:a.description||""}))}).then(function(){if(r)return i._hubDataSource.getHubData(!1,!0)}).then(function(){r?window.location.reload():i.setState({isPanelOpen:!1})},function(e){var t=e&&e.message&&e.message.value;i.setState({errorMessage:t||m.HubSettingsPanelResx.defaultErrorMessage})})};c.__decorate([i.autobind],e.prototype,"_onSaveClick",null);return e}();t.HubSettingsPanelStateManager=a;t.default=a});define("HM",["require","exports","ap","at","HU","HN","iE","dn"],function(e,t,i,r,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){i.__extends(e,n);function e(e){var t=n.call(this,e)||this,i=e.hostModel.resources,r=i.consume(s.pageContext);t._state=new a.HubSettingsPanelStateManager({hubSettingsPanelContainer:t,emptyImageUrl:l.getIconUrl(i,"photo",96),pageContext:r});return t}e.prototype.componentDidMount=function(){this._state.componentDidMount()};e.prototype.componentWillUnmount=function(){this._state.componentWillUnmount()};e.prototype.render=function(){return r.createElement(o.HubSettingsPanel,i.__assign({},this._state.getRenderProps()))};return e}(r.Component);t.HubSettingsPanelContainer=n;t.default=n});define("GZ",["require","exports","ap","HL","G0"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t)});define("HL",["require","exports","ap","G2"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("G2",["require","exports","ap","at","Du","wN","mh","jP","Hi","o1","G6","G5","G4","G3"],function(e,t,i,g,n,r,o,a,s,l,b,_,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.isOpen,i=e.editingTheme,r=e.isLoading;return g.createElement(n.Panel,{type:n.PanelType.smallFixedFar,className:"sp-ChangeTheLookPanel",onDismiss:this._onDismiss,isOpen:t,onRenderFooterContent:this._renderFooterContent,onRenderHeader:this._renderHeader,closeButtonAriaLabel:_.default.cancelButton,isBlocking:!1,forceFocusInsideTrap:!0,firstFocusableSelector:i?"sp-CustomizeTheme-container":"sp-ThemeListItem"},g.createElement("div",{ref:this._resolveRef("_root")},this._renderThemes(),i&&!r&&this._renderCustomizeTheme(),r&&g.createElement("div",{key:"spinner",className:"sp-ChangeTheLookPanel-spinnerContainer"},g.createElement(l.Spinner,null))))};t.prototype.componentDidUpdate=function(e){var t=this;e.editingTheme===this.props.editingTheme&&e.isLoading===this.props.isLoading||(this.props.editingTheme?setTimeout(function(){return t._themeCustomizer.focus()},50):setTimeout(function(){return t._themesList.focus()},50))};t.prototype._renderCustomizeTheme=function(){var e=this.props,t=e.currentlySelectedTheme,i=e.colorThemes,r=e.accentColorMap,n=e.onThemeClick,o=e.onHeaderEmphasisChanged,a=e.currentlySelectedHeaderEmphasis;return g.createElement(s.CustomizeThemeContainer,{defaultTheme:t,themes:i,accentColorMap:r,onPreviewThemeClick:n,componentRef:this._resolveRef("_themeCustomizer"),onHeaderEmphasisChanged:o,defaultHeaderEmphasis:a})};t.prototype._renderThemes=function(){var e=this.props,t=e.themes,i=e.isLoading,r=e.errorText,n=e.defaultThemes,o=e.currentlyAppliedTheme,a=e.onThemeClick,s=e.onEditThemeClick,l=e.currentThemeEditable,c=e.editingTheme,d=e.isThemeLocked,u=e.themeLockedText,p=t&&0<t.length,m=n&&0<n.length,h="";i||r||(p||m)||(h=_.default.noThemesFoundText||"");var f=d?u:void 0;return g.createElement("div",{style:{display:c&&"none"},"data-automationid":"ThemesListContainer"},!i&&g.createElement(b.ThemesListContainer,{isThemeLocked:d,componentRef:this._resolveRef("_themesList"),currentlyAppliedTheme:o,themeErrorText:h,themes:t,defaultThemes:n,onThemeClick:a,onEditThemeClick:s,currentlyAppliedThemeEditable:l,ariaLabel:f}),r&&g.createElement("div",{key:"errorText",className:"sp-ChangeTheLookPanel-errorText"},r))};t.prototype._onDismiss=function(){this.props.onDismiss&&this.props.onDismiss()};t.prototype._onSave=function(e){var t=this;this.props.onSave?this.props.onSave(e).then(function(){return t._onDismiss()}):this._onDismiss()};t.prototype._onCancel=function(e){if(this.props.onCancel){this.props.onCancel(e);this._onDismiss()}};t.prototype._renderHeader=function(){return g.createElement("div",{className:a.css("sp-ChangeTheLookPanel-headerContainer",this.props.editingTheme&&"editing")},this.props.editingTheme&&g.createElement(r.IconButton,{iconProps:{iconName:"Back"},ariaLabel:c.default.backButtonAriaLabel,onClick:this.props.onBackButtonClick}),g.createElement("h4",{className:"sp-ChangeTheLookPanel-headerText"},_.default.title))};t.prototype._resetEditingTheme=function(){this._themeCustomizer&&this._themeCustomizer.resetTheme()};t.prototype._renderFooterContent=function(){return this.props.isThemeLocked?g.createElement("div",{className:"sp-ChangeTheLookPanel-themeLockedText"},this.props.themeLockedText):g.createElement("div",null,g.createElement("div",null,g.createElement(r.PrimaryButton,{"data-automationid":"changethelookpanel-savebutton",onClick:this._onSave,className:"sp-ChangeTheLookPanel-footerButton",disabled:!this.props.saveEnabled},c.default.saveButton),g.createElement(r.DefaultButton,{"data-automationid":"changethelookpanel-cancelbutton",onClick:this._onCancel,className:"sp-ChangeTheLookPanel-footerButton"},_.default.cancelButton)),g.createElement("div",{className:"sp-ChangeTheLookPanel-footerLinkContainer"},g.createElement("div",{className:"sp-ChangeTheLookPanel-footerLinks"},g.createElement("div",null,this.props.editingTheme?g.createElement(o.Link,{className:"sp-ChangeTheLookPanel-footerlink",onClick:this._resetEditingTheme},_.default.resetToDefaultOptions):g.createElement(o.Link,{className:"sp-ChangeTheLookPanel-footerLink",href:this.props.changeTheLookPageLink},_.default.changeTheLookPageLinkText)))))};i.__decorate([a.autobind],t.prototype,"_onDismiss",null);i.__decorate([a.autobind],t.prototype,"_onSave",null);i.__decorate([a.autobind],t.prototype,"_onCancel",null);i.__decorate([a.autobind],t.prototype,"_renderHeader",null);i.__decorate([a.autobind],t.prototype,"_resetEditingTheme",null);i.__decorate([a.autobind],t.prototype,"_renderFooterContent",null);return t}(a.BaseComponent);t.ChangeTheLookPanel=d;t.default=d});define("Hi",["require","exports","ap","at","jP","Hl","Hk","Hj"],function(e,t,i,n,o,a,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this,i=e.defaultTheme;t.state={currentTheme:i,currentHeaderEmphasis:t.props.defaultHeaderEmphasis||0,primaryColors:t._loadPrimaryColors(e.themes),accentColors:t._getAccents(i)};t._defaultTheme=i;return t}e.prototype.focus=function(){this._customizeThemeContent&&this._customizeThemeContent.focus()};e.prototype.render=function(){return n.createElement(a.CustomizeThemeContent,i.__assign({componentRef:this._resolveRef("_customizeThemeContent")},this.getRenderProps()))};e.prototype.resetTheme=function(){this.props.onPreviewThemeClick(null,this._defaultTheme);this.setState({currentTheme:this._defaultTheme,currentHeaderEmphasis:this.props.defaultHeaderEmphasis,accentColors:this._getAccents(this._defaultTheme)})};e.prototype.getCurrentTheme=function(){return this.state.currentTheme};e.prototype.getRenderProps=function(){var e=this.state,t=e.currentTheme,i=e.currentHeaderEmphasis,r=e.primaryColors,n=e.accentColors,o="#0078d4",a=null;t&&t.theme&&t.theme.themePrimary&&(o=t.theme.themePrimary);t&&t.theme&&t.theme.accent&&(a=t.theme.accent);var s=t&&p.getColorNameMap(t.isInverted,t.theme.primaryBackground),l={};if(s)for(var c=0,d=Object.keys(s);c<d.length;c++){var u=d[c];if(m.default[u]){l[s[u]]=m.default[u]}}return{onPrimaryColorClick:this._onPrimaryColorClick,onAccentColorClick:this._onAccentColorClick,primaryColors:r,accentColors:n,currentPrimaryColor:o,currentAccentColor:a,colorNameMap:l,onHeaderEmphasisChanged:this._onHeaderEmphasisChanged,defaultHeaderEmphasis:i}};e.prototype._onPrimaryColorClick=function(e){var t=i.__assign({},this.state.currentTheme,{name:e,theme:i.__assign({},this.props.themes[e])});this.props.onPreviewThemeClick(null,t);this.setState({currentTheme:t,accentColors:this._getAccents(t)})};e.prototype._onAccentColorClick=function(e){var t=i.__assign({},this.state.currentTheme,{theme:i.__assign({},this.state.currentTheme.theme,{accent:e})});this.props.onPreviewThemeClick(null,t);this.setState({currentTheme:t})};e.prototype._onHeaderEmphasisChanged=function(e){this.props.onHeaderEmphasisChanged&&this.props.onHeaderEmphasisChanged(e);this.setState({currentHeaderEmphasis:e})};e.prototype._loadPrimaryColors=function(e){var t=[];for(var i in e){var r=e[i];r&&r.themePrimary&&t.push(r.themePrimary)}return t};e.prototype._getAccents=function(e){var t=e.theme.themePrimary,i=e.isInverted,r=this.props.accentColorMap;return i?[t].concat(r[t]):r[t].concat([t])};i.__decorate([o.autobind],e.prototype,"_onPrimaryColorClick",null);i.__decorate([o.autobind],e.prototype,"_onAccentColorClick",null);i.__decorate([o.autobind],e.prototype,"_onHeaderEmphasisChanged",null);return e}(o.BaseComponent);t.CustomizeThemeContainer=r});define("Hl",["require","exports","ap","at","jP","aW","Hn","Dn","Hh","Hm"],function(e,t,i,d,r,u,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.focus=function(){this._focusZone&&this._focusZone.focus()};t.prototype.render=function(){var e=this.props,i=e.onPrimaryColorClick,r=e.onAccentColorClick,t=e.currentPrimaryColor,n=e.currentAccentColor,o=e.primaryColors,a=e.accentColors,s=e.onHeaderEmphasisChanged,l=e.defaultHeaderEmphasis,c=u.default.isFeatureEnabled({ODB:175,Fallback:!1});return d.createElement("div",{"aria-label":h.default.customizerAriaNavigationInstructions,ref:this._resolveRef("_focusZone"),className:"sp-CustomizeTheme-container",tabIndex:0},d.createElement("div",{id:"sp-CustomizeTheme-accentTitle"},h.default.mainColor),d.createElement(p.SwatchColorPicker,{key:"primaryColors",className:"sp-CustomizeTheme-colorPicker",colorCells:this._convertColorsToCells(o),cellShape:"square",selectedId:t,columnCount:6,onColorChanged:function(e,t){return i(t)},shouldFocusCircularNavigate:!1}),a&&d.createElement("div",{className:"sp-CustomizeTheme-accentColors"},d.createElement("div",{key:"AccentColorsTitle"},h.default.accentColor),d.createElement(p.SwatchColorPicker,{key:"accentColors",className:"sp-CustomizeTheme-colorPicker",cellShape:"square",colorCells:this._convertColorsToCells(a),columnCount:6,selectedId:n,onColorChanged:function(e,t){return r(t)}})),c&&d.createElement("span",null,h.default.headerEmphasisTitle),c&&d.createElement(m.Dropdown,{selectedKey:String(l)||String(0),options:[{key:String(0),text:h.default.headerEmphasisOptionNone},{key:String(2),text:h.default.headerEmphasisOptionSoft},{key:String(3),text:h.default.headerEmphasisOptionStrong}],onChanged:function(e){if(s){var t=0;switch(e.key){case String(2):t=2;break;case String(3):t=3}s(t)}}}))};t.prototype._convertColorsToCells=function(e){var i=this;return e.map(function(e,t){return{id:e,color:e,index:t,label:i.props.colorNameMap[e]}})};return t}(r.BaseComponent);t.CustomizeThemeContent=n;t.default=n});define("Hn",["require","exports","ap","Ho"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Ho",["require","exports","ap","Hz","Hv","Ht","Hp"],function(e,t,i,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(o,t);i.__exportStar(a,t)});define("Hz",["require","exports","jP","Hv","HA"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SwatchColorPicker=i.styled(r.SwatchColorPickerBase,n.getStyles)});define("Hv",["require","exports","ap","at","jP","Hw","Ht"],function(e,t,d,u,r,p,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=r.classNamesFunction(),i=function(i){d.__extends(e,i);function e(e){var t,n=i.call(this,e)||this;n.navigationIdleDelay=250;n._onSwatchColorPickerBlur=function(){if(n.props.onCellFocused){n._cellFocused=!1;n.props.onCellFocused()}};n._renderOption=function(e){var t=n._id;return u.createElement(o.ColorPickerGridCell,{item:e,id:t,color:e.color,getStyles:n.props.getColorGridCellStyles,disabled:n.props.disabled,onClick:n._onCellClick,onHover:n._onGridCellHovered,onFocus:n._onGridCellFocused,selected:void 0!==n.state.selectedIndex&&n.state.selectedIndex===e.index,circle:"circle"===n.props.cellShape,label:e.label,onMouseEnter:n._onMouseEnter,onMouseMove:n._onMouseMove,onMouseLeave:n._onMouseLeave,onWheel:n._onWheel,onKeyDown:n._onKeyDown})};n._onMouseEnter=function(e){if(!n.props.focusOnHover)return!(n.isNavigationIdle&&!n.props.disabled);n.isNavigationIdle&&!n.props.disabled&&e.currentTarget.focus();return!0};n._onMouseMove=function(e){if(!n.props.focusOnHover)return!(n.isNavigationIdle&&!n.props.disabled);var t=e.currentTarget;!n.isNavigationIdle||document&&t===document.activeElement||t.focus();return!0};n._onMouseLeave=function(e){var t=n.props.mouseLeaveParentSelector;if(n.props.focusOnHover&&t&&n.isNavigationIdle&&!n.props.disabled)for(var i=document.querySelectorAll(t),r=0;r<i.length;r+=1)if(i[r].contains(e.currentTarget)){i[r].setActive?i[r].setActive():i[r].focus();break}};n._onWheel=function(){n.setNavigationTimeout()};n._onKeyDown=function(e){38!==e.which&&40!==e.which&&37!==e.which&&39!==e.which||n.setNavigationTimeout()};n.setNavigationTimeout=function(){if(n.isNavigationIdle||void 0===n.navigationIdleTimeoutId)n.isNavigationIdle=!1;else{n.async.clearTimeout(n.navigationIdleTimeoutId);n.navigationIdleTimeoutId=void 0}n.navigationIdleTimeoutId=n.async.setTimeout(function(){n.isNavigationIdle=!0},n.navigationIdleDelay)};n._onGridCellHovered=function(e){var t=n.props.onCellHovered;if(t)return e?t(e.id,e.color):t()};n._onGridCellFocused=function(e){var t=n.props.onCellFocused;if(t){if(e){n._cellFocused=!0;return t(e.id,e.color)}n._cellFocused=!1;return t()}};n._onCellClick=function(e){if(!n.props.disabled){var t=e.index;if(0<=t&&t!==n.state.selectedIndex){if(n.props.onCellFocused&&n._cellFocused){n._cellFocused=!1;n.props.onCellFocused()}n.props.onColorChanged&&n.props.onColorChanged(e.id,e.color);n.setState({selectedIndex:t})}}};n._id=e.id||r.getId("swatchColorPicker");n._warnMutuallyExclusive({focusOnHover:"onHover"});n._warnConditionallyRequiredProps(["focusOnHover"],"mouseLeaveParentSelector",!!n.props.mouseLeaveParentSelector);n.isNavigationIdle=!0;n.async=new r.Async(n);e.selectedId&&(t=n._getSelectedIndex(e.colorCells,e.selectedId));n.state={selectedIndex:t};return n}e.prototype.componentWillReceiveProps=function(e){var t;e.selectedId&&(t=this._getSelectedIndex(e.colorCells,e.selectedId));t!==this.state.selectedIndex&&this.setState({selectedIndex:t})};e.prototype.componentWillUnmount=function(){if(this.props.onCellFocused&&this._cellFocused){this._cellFocused=!1;this.props.onCellFocused()}};e.prototype.render=function(){var e=this.props,t=e.colorCells,i=e.columnCount,r=e.positionInSet,n=e.setSize,o=e.shouldFocusCircularNavigate,a=e.className,s=e.doNotContainWithinFocusZone,l=e.getStyles,c=m(l,{theme:this.props.theme,className:a});return t.length<1||i<1?null:u.createElement(p.Grid,d.__assign({},this.props,{items:t.map(function(e,t){return d.__assign({},e,{index:t})}),columnCount:i,onRenderItem:this._renderOption,positionInSet:r&&r,setSize:n&&n,shouldFocusCircularNavigate:o,doNotContainWithinFocusZone:s,onBlur:this._onSwatchColorPickerBlur,theme:this.props.theme,getStyles:function(e){return{root:c.root,tableCell:c.tableCell,focusedContainer:c.focusedContainer}}}))};e.prototype._getSelectedIndex=function(e,t){var i=r.findIndex(e,function(e){return e.id===t});return 0<=i?i:void 0};e.defaultProps={cellShape:"circle",disabled:!1,shouldFocusCircularNavigate:!0};return e=d.__decorate([r.customizable("SwatchColorPicker",["theme"])],e)}(r.BaseComponent);t.SwatchColorPickerBase=i});define("Hw",["require","exports","jP","Hy","Hx"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Grid=i.styled(r.GridBase,n.getStyles)});define("Hy",["require","exports","ap","at","jP","o7"],function(e,t,p,m,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=h.classNamesFunction(),i=function(i){p.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._id=h.getId();return t}e.prototype.render=function(){var i=this,e=this.props,t=e.items,r=e.columnCount,n=e.onRenderItem,o=e.positionInSet,a=e.setSize,s=e.getStyles,l=h.getNativeProps(this.props,h.htmlElementProperties,["onBlur, aria-posinset, aria-setsize"]),c=g(s,{theme:this.props.theme}),d=h.toMatrix(t,r),u=m.createElement("table",p.__assign({},l,{"aria-posinset":o,"aria-setsize":a,id:this._id,role:"grid",className:c.root}),m.createElement("tbody",null,d.map(function(e,t){return m.createElement("tr",{role:"row",key:i._id+"-"+t+"-row"},e.map(function(e,t){return m.createElement("td",{role:"presentation",key:i._id+"-"+t+"-cell",className:c.tableCell},n(e,t))}))})));return this.props.doNotContainWithinFocusZone?u:m.createElement(f.FocusZone,{isCircularNavigation:this.props.shouldFocusCircularNavigate,className:c.focusedContainer,onBlur:this.props.onBlur},u)};return e}(h.BaseComponent);t.GridBase=i});define("Hx",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){return{root:{padding:2,outline:"none"},tableCell:{padding:0}}}});define("Ht",["require","exports","jP","Hp","Hu"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ColorPickerGridCell=i.styled(r.ColorPickerGridCellBase,n.getStyles)});define("Hp",["require","exports","ap","at","jP","Hr","Hq","w5","d","jP"],function(e,t,i,b,r,n,o,u,p,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=a.classNamesFunction(),v=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t}(o.GridCell),s=function(e){i.__extends(t,e);function t(){var d=null!==e&&e.apply(this,arguments)||this;d._onRenderColorOption=function(e){return b.createElement("svg",{className:d._classNames.svg,viewBox:"0 0 20 20",fill:n.getColorFromString(e.color).str},d.props.circle?b.createElement("circle",{cx:"50%",cy:"50%",r:"50%"}):b.createElement("rect",{width:"100%",height:"100%"}))};d._getClassNames=function(e,t,i,r,n,o,a,s,l){var c=u.getStyles(e);return p.mergeStyleSets(d._classNames,{root:["ms-Button",c.root,i,t,a&&["is-checked",c.rootChecked],o&&["is-disabled",c.rootDisabled],!o&&!a&&{selectors:{":hover":c.rootHovered,":focus":c.rootFocused,":active":c.rootPressed}},o&&a&&[c.rootCheckedDisabled],!o&&a&&{selectors:{":hover":c.rootCheckedHovered,":active":c.rootCheckedPressed}}],flexContainer:["ms-Button-flexContainer",c.flexContainer]})};return d}t.prototype.render=function(){var e=this.props,t=e.item,i=e.id,r=e.selected,n=e.disabled,o=e.getStyles,a=e.theme,s=e.circle,l=e.color,c=e.onClick,d=e.onHover,u=e.onFocus,p=e.onMouseEnter,m=e.onMouseMove,h=e.onMouseLeave,f=e.onWheel,g=e.onKeyDown;this._classNames=_(o,{theme:a,disabled:n,selected:r,circle:s,isWhite:this._isWhiteCell(l)});return b.createElement(v,{item:t,id:i+"-"+t.id+"-"+t.index,key:t.id,disabled:n,role:"gridcell",onRenderItem:this._onRenderColorOption,selected:r,onClick:c,onHover:d,onFocus:u,label:t.label,className:this._classNames.colorCell,getClassNames:this._getClassNames,index:t.index,onMouseEnter:p,onMouseMove:m,onMouseLeave:h,onWheel:f,onKeyDown:g})};t.prototype._isWhiteCell=function(e){return"#ffffff"===e.toLocaleLowerCase()};t.defaultProps={circle:!0,disabled:!1,selected:!1};return t=i.__decorate([r.customizable("ColorPickerGridCell",["theme"])],t)}(b.Component);t.ColorPickerGridCellBase=s});define("Hr",["require","exports","jP","Hs"],function(e,l,i,r){"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.MAX_COLOR_SATURATION=100;l.MAX_COLOR_HUE=359;l.MAX_COLOR_VALUE=100;l.MAX_COLOR_RGBA=255;function d(e){return function(e){var t=r.COLOR_VALUES[e.toLowerCase()];if(t)return{r:t[0],g:t[1],b:t[2],a:100}}(e)||function(e){if("#"===e[0]&&4===e.length)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:100}}(e)||function(e){if("#"===e[0]&&7===e.length)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:100}}(e)||function(e){if(0===e.indexOf("rgb(")){var t=(e=e.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:100}}}(e)||function(e){if(0===e.indexOf("rgba(")){var t=(e=e.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:100*t[3]}}}(e)||function(e){if(0===e.indexOf("hsl(")){var t=(e=e.match(/hsl\(([^)]+)\)/)[1]).split(/ *, */),i=parseInt(t[0],10),r=parseInt(t[1],10),n=parseInt(t[2],10),o=s(i,r,n);o.a=100;return o}}(e)||function(e){if(0===e.indexOf("hsla(")){var t=(e=e.match(/hsla\(([^)]+)\)/)[1]).split(/ *, */),i=parseInt(t[0],10),r=parseInt(t[1],10),n=parseInt(t[2],10),o=100*parseInt(t[3],10),a=s(i,r,n);a.a=o;return a}}(e)}l.cssColor=d;function u(e,t,i){return[o(e),o(t),o(i)].join("")}l.rgb2hex=u;function t(e,t,i){var r=c(e,t,i);return u(r.r,r.g,r.b)}l.hsv2hex=t;function p(e,t,i){var r=NaN,n=Math.max(e,t,i),o=n-Math.min(e,t,i);0===o?r=0:e===n?r=(t-i)/o%6:t===n?r=(i-e)/o+2:i===n&&(r=(e-t)/o+4);(r=Math.round(60*r))<0&&(r+=360);return{h:r,s:Math.round(100*(0===n?0:o/n)),v:Math.round(n/255*100)}}l.rgb2hsv=p;function n(e,t,i){return{h:e,s:2*(t*=(i<50?i:100-i)/100)/(i+t)*100,v:i+t}}l.hsl2hsv=n;l.hsv2hsl=function(e,t,i){var r=(2-(t/=l.MAX_COLOR_SATURATION))*(i/=l.MAX_COLOR_VALUE),n=t*i;return{h:e,s:100*(n=(n/=r<=1?r:2-r)||0),l:100*(r/=2)}};function s(e,t,i){var r=n(e,t,i);return c(r.h,r.s,r.v)}l.hsl2rgb=s;function c(e,t,i){var r=[],n=(i/=100)*(t/=100),o=e/60,a=n*(1-Math.abs(o%2-1)),s=i-n;switch(Math.floor(o)){case 0:r=[n,a,0];break;case 1:r=[a,n,0];break;case 2:r=[0,n,a];break;case 3:r=[0,a,n];break;case 4:r=[a,0,n];break;case 5:r=[n,0,a]}return{r:Math.round(l.MAX_COLOR_RGBA*(r[0]+s)),g:Math.round(l.MAX_COLOR_RGBA*(r[1]+s)),b:Math.round(l.MAX_COLOR_RGBA*(r[2]+s))}}l.hsv2rgb=c;l.getColorFromString=function(e){var t=d(e);if(t){var i=t.a,r=t.b,n=t.g,o=t.r,a=p(o,n,r),s=a.h,l=a.s,c=a.v;return{a:i,b:r,g:n,h:s,hex:u(o,n,r),r:o,s:l,str:e,v:c}}};l.getColorFromRGBA=function(e){var t=e.a,i=e.b,r=e.g,n=e.r,o=p(n,r,i),a=o.h,s=o.s,l=o.v,c=u(n,r,i);return{a:t,b:i,g:r,h:a,hex:c,r:n,s:s,str:100===t?"#"+c:"rgba("+n+", "+r+", "+i+", "+t/100+")",v:l}};l.getFullColorString=function(e){return"#"+t(e.h,l.MAX_COLOR_SATURATION,l.MAX_COLOR_VALUE)};l.updateSV=function(e,t,i){var r=c(e.h,t,i),n=r.r,o=r.g,a=r.b,s=u(n,o,a);return{a:e.a,b:a,g:o,h:e.h,hex:s,r:n,s:t,str:100===e.a?"#"+s:"rgba("+n+", "+o+", "+a+", "+e.a/100+")",v:i}};l.updateH=function(e,t){var i=c(t,e.s,e.v),r=i.r,n=i.g,o=i.b,a=u(r,n,o);return{a:e.a,b:o,g:n,h:t,hex:a,r:r,s:e.s,str:100===e.a?"#"+a:"rgba("+r+", "+n+", "+o+", "+e.a/100+")",v:e.v}};l.updateA=function(e,t){return i.assign({},e,{a:t,str:100===t?"#"+e.hex:"rgba("+e.r+", "+e.g+", "+e.b+", "+t/100+")"})};function o(e){var t=e.toString(16);return 1===t.length?"0"+t:t}});define("Hs",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.COLOR_VALUES={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]}});define("Hq",["require","exports","ap","at","jP","wN"],function(e,t,i,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){i.__extends(t,e);function t(){var a=null!==e&&e.apply(this,arguments)||this;a._onClick=function(){var e=a.props,t=e.onClick,i=e.disabled,r=e.item;t&&!i&&t(r)};a._onMouseEnter=function(e){var t=a.props,i=t.onHover,r=t.disabled,n=t.item,o=t.onMouseEnter;o&&o(e)||!i||r||i(n)};a._onMouseMove=function(e){var t=a.props,i=t.onHover,r=t.disabled,n=t.item,o=t.onMouseMove;o&&o(e)||!i||r||i(n)};a._onMouseLeave=function(e){var t=a.props,i=t.onHover,r=t.disabled,n=t.onMouseLeave;n&&n(e)||!i||r||i()};a._onFocus=function(){var e=a.props,t=e.onFocus,i=e.disabled,r=e.item;t&&!i&&t(r)};return a}t.prototype.render=function(){var e,t=this.props,i=t.item,r=t.id,n=t.className,o=t.role,a=t.selected,s=t.disabled,l=t.onRenderItem,c=t.cellDisabledStyle,d=t.cellIsSelectedStyle,u=t.index,p=t.label,m=t.getClassNames;return h.createElement(g.CommandButton,{id:r,"data-index":u,"data-is-focusable":!0,disabled:s,className:f.css(n,(e={},e[""+d]=a,e[""+c]=s,e)),onClick:this._onClick,onMouseEnter:this._onMouseEnter,onMouseMove:this._onMouseMove,onMouseLeave:this._onMouseLeave,onFocus:this._onFocus,role:o,"aria-selected":a,ariaLabel:p,title:p,getClassNames:m},l(i))};t.defaultProps={disabled:!1,id:f.getId("gridCell")};return t}(h.Component);t.GridCell=r});define("Hu",["require","exports","d"],function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function c(e,t){return{width:12,height:12,border:"4px solid",borderColor:e,boxShadow:t?"none":"0 0 0 1px #969696",padding:4,margin:0}}t.getStyles=function(e){var t,i=e.theme,r=e.disabled,n=e.selected,o=e.circle,a=e.isWhite,s=i.semanticColors;return{colorCell:[{backgroundColor:"transparent",padding:0,overflow:"visible",position:"relative",boxSizing:"border-box",display:"inline-block",border:"1px solid transparent",background:"transparent",cursor:"pointer",textAlign:"center",verticalAlign:"top",userSelect:"none",height:40,selectors:(t={},t[l.HighContrastSelector]={border:"none"},t[".ms-Fabric--isFocusVisible &:focus, .ms-Fabric--isFocusVisible &:focus::after"]={border:"none"},t[".ms-Fabric--isFocusVisible &:focus $svg"]=c(i.palette.neutralQuaternaryAlt,!1),t[":hover $svg"]=c(i.palette.neutralQuaternaryAlt,!0),t[":focus $svg"]=c(i.palette.neutralQuaternaryAlt,!1),t[":active $svg"]=c("#969696",!1),t)},a&&{selectors:{$svg:{padding:0,border:"1px solid",borderColor:i.palette.neutralTertiary,margin:4}}},o&&{selectors:{$svg:{borderRadius:"100%"}}},n&&{selectors:{$svg:{boxShadow:"0 0 0 1px #969696",border:"4px solid",borderColor:i.palette.neutralTertiaryAlt,width:12,height:12},":hover $svg":{boxShadow:"0 0 0 1px #969696"},":focus $svg":{boxShadow:"0 0 0 1px #969696"},":active $svg":{boxShadow:"0 0 0 1px #969696",borderColor:"#969696"}}},n&&a&&{selectors:{$svg:{padding:4,margin:0}}},r&&{color:s.disabledBodyText,cursor:"default",pointerEvents:"none",opacity:.3}],svg:[{width:20,height:20,padding:4,boxSizing:"content-box"}]}}});define("HA",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){return{root:{padding:2,outline:"none"},tableCell:{padding:0},focusedContainer:["ms-swatchColorPickerBodyContainer",{clear:"both",display:"block",minWidth:"180px"},e.className]}}});define("Hm",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".sp-CustomizeTheme-colorPicker{position:relative}html[dir=ltr] .sp-CustomizeTheme-colorPicker{left:-8px}html[dir=rtl] .sp-CustomizeTheme-colorPicker{right:-8px}.sp-CustomizeTheme-accentColors{margin-top:20px}.ms-Fabric .sp-CustomizeTheme-container::-moz-focus-inner{border:0}.ms-Fabric .sp-CustomizeTheme-container{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .sp-CustomizeTheme-container:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .sp-CustomizeTheme-container:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .sp-CustomizeTheme-container:focus:after{border-color:#37006e}}.sp-CustomizeTheme-label{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}])});define("Hk",["require","exports","ap"],function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.Red=0]="Red";e[e.Orange=1]="Orange";e[e.Yellow=2]="Yellow";e[e.Green=3]="Green";e[e.Teal=4]="Teal";e[e.Blue=5]="Blue";e[e.Dark_Blue=6]="Dark_Blue";e[e.Indigo=7]="Indigo";e[e.Plum=8]="Plum";e[e.Purple=9]="Purple";e[e.Gray=10]="Gray";e[e.Warm_Gray=11]="Warm_Gray"}(i||(i={}));var r={red:"#a4262c",orange:"#ca5010",yellow:"#8f7034",green:"#407855",teal:"#038387",blue:"#0078d4",dark_Blue:"#40587c",indigo:"#4052ab",plum:"#854085",purple:"#8764b8",gray:"#737373",warm_Gray:"#867365"},n={red:"#ef6950",yellow:"#ffc83d",green:"#40c5af",blue:"#409ae1",purple:"#b4a0ff",gray:"#b2b2b2"},o=l.__assign({},n,{red:"#f2826e",blue:"#5caae6"}),a="#1f1f1f",c="#273a53";t.getDefaultThemes=function(){return S};t.getAccentColorMapping=function(e){return e===a?p:e===c?m:h};t.getPartialThemes=function(e,t){var i=function(e,t){var i=b,r=y;if(e){var n=t===c;i=n?g:f;r=n?v:_}return{partialThemes:r,neutrals:i}}(e,t),r=i.neutrals,n=i.partialThemes,o={};for(var a in n){var s=n[a];o[s.themePrimary]=l.__assign({},s,r)}return o};t.getColorNameMap=function(e,t){return e?t===c?o:n:r};var s,d,u,p={"#ef6950":["#b4a0ff","#40c5af","#409ae1","#b2b2b2"],"#ffc83d":["#409ae1","#ef6950","#b4a0ff","#b2b2b2"],"#40c5af":["#409ae1","#b4a0ff","#ef6950","#b2b2b2"],"#409ae1":["#b4a0ff","#40c5af","#ef6950","#b2b2b2"],"#b4a0ff":["#409ae1","#ef6950","#ffc83d","#b2b2b2"],"#b2b2b2":["#409ae1","#b4a0ff","#ef6950","#ffc83d"]},m={"#f2826e":["#b4a0ff","#ffc83d","#5caae6","#b2b2b2"],"#ffc83d":["#5caae6","#f2826e","#b4a0ff","#b2b2b2"],"#40c5af":["#5caae6","#b4a0ff","#f2826e","#b2b2b2"],"#5caae6":["#b4a0ff","#40c5af","#f2826e","#b2b2b2"],"#b4a0ff":["#5caae6","#f2826e","#ffc83d","#b2b2b2"],"#b2b2b2":["#5caae6","#b4a0ff","#f2826e","#ffc83d"]},h={"#a4262c":["#ca5010","#854085","#407855","#867365"],"#ca5010":["#8f7034","#a4262c","#407855","#867365"],"#8f7034":["#ca5010","#407855","#0078d4","#737373"],"#407855":["#038387","#0078d4","#ca5010","#737373"],"#038387":["#4052ab","#0078d4","#ca5010","#737373"],"#0078d4":["#8764b8","#038387","#ca5010","#737373"],"#40587c":["#038387","#0078d4","#8f7034","#737373"],"#4052ab":["#8764b8","#0078d4","#038387","#737373"],"#854085":["#038387","#0078d4","#ca5010","#737373"],"#8764b8":["#038387","#0078d4","#8f7034","#737373"],"#737373":["#0078d4","#ca5010","#407855","#a4262c"],"#867365":["#ca5010","#0078d4","#407855","#a4262c"]},f={neutralLighterAlt:"#282828",neutralLighter:"#313131",neutralLight:"#3f3f3f",neutralQuaternaryAlt:"#484848",neutralQuaternary:"#4f4f4f",neutralTertiaryAlt:"#6d6d6d",neutralTertiary:"#c8c8c8",neutralSecondary:"#dadada",neutralPrimaryAlt:"#eaeaea",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#1f1f1f",primaryBackground:"#1f1f1f",primaryText:"#ffffff"},g={neutralLighterAlt:"#2d435f",neutralLighter:"#324a6a",neutralLight:"#39567a",neutralQuaternaryAlt:"#3e5d85",neutralQuaternary:"#42638d",neutralTertiaryAlt:"#547baf",neutralTertiary:"#c8c8c8",neutralSecondary:"#dadada",neutralPrimaryAlt:"#eaeaea",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#273a53",primaryBackground:"#273a53",primaryText:"#ffffff"},b={neutralLighterAlt:"#f8f8f8",neutralLighter:"#f4f4f4",neutralLight:"#eaeaea",neutralQuaternaryAlt:"#dadada",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c8c8",neutralTertiary:"#a6a6a6",neutralSecondary:"#666666",neutralPrimary:"#333333",neutralPrimaryAlt:"#3c3c3c",neutralDark:"#212121",black:"#000000",white:"#ffffff",primaryBackground:"#ffffff",primaryText:"#333333"},_=((s={})[i.Red]={themePrimary:"#ef6950",themeLighterAlt:"#0f0301",themeLighter:"#1d0703",themeLight:"#3b0d05",themeTertiary:"#7b1c0b",themeSecondary:"#ed4e32",themeDarkAlt:"#f17661",themeDark:"#f49584",themeDarker:"#f7ac9e",accent:"#ef6950"},s[i.Yellow]={themePrimary:"#ffc83d",themeLighterAlt:"#100b00",themeLighter:"#201700",themeLight:"#3f2d00",themeTertiary:"#855f00",themeSecondary:"#ffbf1e",themeDarkAlt:"#ffce51",themeDark:"#ffd977",themeDarker:"#ffe194",accent:"#ffc83d"},s[i.Green]={themePrimary:"#40c5af",themeLighterAlt:"#030a09",themeLighter:"#061412",themeLight:"#0c2823",themeTertiary:"#19534a",themeSecondary:"#37b39e",themeDarkAlt:"#52cab6",themeDark:"#78d6c6",themeDarker:"#95dfd3",accent:"#40c5af"},s[i.Blue]={themePrimary:"#409ae1",themeLighterAlt:"#02080c",themeLighter:"#041019",themeLight:"#082032",themeTertiary:"#114268",themeSecondary:"#268ddc",themeDarkAlt:"#52a4e3",themeDark:"#78b9ea",themeDarker:"#95c8ee",accent:"#409ae1"},s[i.Purple]={themePrimary:"#b4a0ff",themeLighterAlt:"#bdabff",themeLighter:"#c5b5ff",themeLight:"#cdc0ff",themeTertiary:"#d6caff",themeSecondary:"#ded5ff",themeDarkAlt:"#e6dfff",themeDark:"#eee9ff",themeDarker:"#f6f4ff",accent:"#b4a0ff"},s[i.Gray]={themePrimary:"#b2b2b2",themeLighterAlt:"#090909",themeLighter:"#121212",themeLight:"#242424",themeTertiary:"#4b4b4b",themeSecondary:"#a1a1a1",themeDarkAlt:"#bababa",themeDark:"#c9c9c9",themeDarker:"#d5d5d5",accent:"#b2b2b2"},s),v=l.__assign({},_,((d={})[i.Red]={themePrimary:"#f2826e",themeLighterAlt:"#100401",themeLighter:"#200703",themeLight:"#410e06",themeTertiary:"#881e0c",themeSecondary:"#ef654d",themeDarkAlt:"#f48e7c",themeDark:"#f6a799",themeDarker:"#f8baaf",accent:"#f2826e"},d[i.Blue]={themePrimary:"#5caae6",themeLighterAlt:"#02090e",themeLighter:"#04121c",themeLight:"#092338",themeTertiary:"#124a75",themeSecondary:"#409be1",themeDarkAlt:"#6cb2e8",themeDark:"#8dc3ed",themeDarker:"#a5d0f1",accent:"#5caae6"},d)),y=((u={})[i.Red]={themePrimary:"#a4262c",themeLighterAlt:"#fcf2f3",themeLighter:"#f9e6e7",themeLight:"#f3cdcf",themeTertiary:"#e79599",themeSecondary:"#bc2b33",themeDarkAlt:"#932227",themeDark:"#721a1f",themeDarker:"#5a1518",accent:"#ca5010"},u[i.Orange]={themePrimary:"#ca5010",themeLighterAlt:"#fef6f1",themeLighter:"#fdede4",themeLight:"#fbdac9",themeTertiary:"#f6b28d",themeSecondary:"#e55c12",themeDarkAlt:"#b5490f",themeDark:"#8d390b",themeDarker:"#6f2d09",accent:"#8f7034"},u[i.Yellow]={themePrimary:"#8f7034",themeLighterAlt:"#fbf8f3",themeLighter:"#f7f2e8",themeLight:"#eee4d1",themeTertiary:"#dcc79d",themeSecondary:"#a6833c",themeDarkAlt:"#81652e",themeDark:"#644f24",themeDarker:"#4f3e1c",accent:"#ca5010"},u[i.Green]={themePrimary:"#407855",themeLighterAlt:"#f4f9f6",themeLighter:"#eaf4ed",themeLight:"#d4e8dc",themeTertiary:"#a5cfb5",themeSecondary:"#4b8d64",themeDarkAlt:"#396c4d",themeDark:"#2c543c",themeDarker:"#23422f",accent:"#038387"},u[i.Teal]={themePrimary:"#038387",themeLighterAlt:"#edfeff",themeLighter:"#dbfdfe",themeLight:"#b6fbfe",themeTertiary:"#66f7fc",themeSecondary:"#03a6ac",themeDarkAlt:"#02767a",themeDark:"#025c5f",themeDarker:"#01484a",accent:"#4052ab"},u[i.Blue]={themePrimary:"#0078d4",themeLighterAlt:"#f0f8ff",themeLighter:"#e1f2ff",themeLight:"#c4e4ff",themeTertiary:"#83c7ff",themeSecondary:"#0086f4",themeDarkAlt:"#006ac1",themeDark:"#005296",themeDarker:"#004176",accent:"#8764b8"},u[i.Dark_Blue]={themePrimary:"#40587c",themeLighterAlt:"#f4f6fa",themeLighter:"#eaeef4",themeLight:"#d5dde9",themeTertiary:"#a7b8d1",themeSecondary:"#4c6892",themeDarkAlt:"#3a5070",themeDark:"#2d3e57",themeDarker:"#243145",accent:"#038387"},u[i.Indigo]={themePrimary:"#4052ab",themeLighterAlt:"#f5f6fb",themeLighter:"#ebedf8",themeLight:"#d7dbf0",themeTertiary:"#aab3e0",themeSecondary:"#4a5dbc",themeDarkAlt:"#39499a",themeDark:"#2c3978",themeDarker:"#232d5e",accent:"#8764b8"},u[i.Plum]={themePrimary:"#854085",themeLighterAlt:"#faf4fa",themeLighter:"#f5eaf5",themeLight:"#ebd5eb",themeTertiary:"#d4a6d4",themeSecondary:"#9a4a9a",themeDarkAlt:"#773977",themeDark:"#5d2d5d",themeDarker:"#492349",accent:"#038387"},u[i.Purple]={themePrimary:"#8764b8",themeLighterAlt:"#f9f7fb",themeLighter:"#f3eff8",themeLight:"#e7e0f1",themeTertiary:"#ccbee1",themeSecondary:"#9273bf",themeDarkAlt:"#7750af",themeDark:"#5d3e88",themeDarker:"#49316b",accent:"#038387"},u[i.Gray]={themePrimary:"#737373",themeLighterAlt:"#f8f8f8",themeLighter:"#f1f1f1",themeLight:"#e3e3e3",themeTertiary:"#c4c4c4",themeSecondary:"#818181",themeDarkAlt:"#676767",themeDark:"#505050",themeDarker:"#3f3f3f",accent:"#0078d4"},u[i.Warm_Gray]={themePrimary:"#867365",themeLighterAlt:"#f9f8f7",themeLighter:"#f3f1ef",themeLight:"#e8e3e0",themeTertiary:"#cec4bd",themeSecondary:"#968172",themeDarkAlt:"#7a685b",themeDark:"#5f5147",themeDarker:"#4a3f38",accent:"#ca5010"},u),S={default_Office:{name:"",backgroundImageUri:"",theme:l.__assign({},y[i.Blue],b)},default_Orange:{name:"",backgroundImageUri:"",theme:l.__assign({},y[i.Orange],b)},default_Red:{name:"",backgroundImageUri:"",theme:l.__assign({},y[i.Red],b)},default_Purple:{name:"",backgroundImageUri:"",theme:l.__assign({},y[i.Purple],b)},default_Green:{name:"",backgroundImageUri:"",theme:l.__assign({},y[i.Green],b)},default_Gray:{name:"",backgroundImageUri:"",theme:l.__assign({},y[i.Gray],b)},default_DarkYellow:{name:"",backgroundImageUri:"",isInverted:!0,theme:l.__assign({},_[i.Yellow],f)},default_DarkBlue:{name:"",isInverted:!0,backgroundImageUri:"",theme:l.__assign({},v[i.Blue],g)}}});define("G6",["require","exports","ap","at","jP","Hh","G8","o7","G7"],function(e,t,r,d,n,u,a,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._spThemeListLabel=n.getId("spThemeList");t.state={selectedThemeId:{index:0,listId:u.default.currentTheme}};return t}e.prototype.focus=function(){this._focusZone.focus()};e.prototype.render=function(){var e=this.props,t=e.currentlyAppliedTheme,i=e.themes,r=e.defaultThemes,n=e.themeErrorText,o=e.currentlyAppliedThemeEditable,a=e.isThemeLocked,s=!a&&i&&0<i.length,l=!a&&r&&0<r.length,c=!a&&o;return d.createElement(p.FocusZone,{role:"listbox",className:"sp-ThemeList-focusZone","aria-label":this.props.ariaLabel,componentRef:this._resolveRef("_focusZone"),ariaLabelledBy:this._spThemeListLabel},d.createElement("label",{id:this._spThemeListLabel,className:"sp-ThemeList-ariaLabel"},this.props.ariaLabel),t&&this._renderThemeList(u.default.currentTheme,[t],c),s&&this._renderThemeList(u.default.companyThemes,i),l&&this._renderThemeList(u.default.sharePointThemes,r,!0),n&&n)};e.prototype._renderThemeList=function(r,e,t){var n=this;void 0===t&&(t=!1);var i=this.props.onEditThemeClick,o=this.state.selectedThemeId;return d.createElement("div",{key:r},d.createElement("div",{className:"sp-ChangeTheLookPanel-themeListHeader","data-automationid":"ThemeListHeader"},r),d.createElement(a.ThemeList,{themes:e,onThemeClick:function(e,t,i){return n._onThemeClick(e,t,r,i)},className:"sp-ChangeTheLookPanel-themeList",onEditThemeClick:i,selectedThemeId:o,themeListId:r,editEnabled:t}))};e.prototype._onThemeClick=function(e,t,i,r){void 0===r&&(r=0);this.props.onThemeClick&&this.props.onThemeClick(e,t);this.setState({selectedThemeId:{listId:i,index:r}})};r.__decorate([n.autobind],e.prototype,"_onThemeClick",null);return e}(n.BaseComponent);t.ThemesListContainer=i;t.default=i});define("G8",["require","exports","ap","at","oR","jP","G9"],function(e,t,i,a,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){return a.createElement(r.List,{ref:this._resolveRef("_themeList"),role:"group",className:n.css("sp-ThemeList",this.props.className),items:this.props.themes,renderedWindowsAhead:4,onRenderCell:this._onRenderTheme.bind(this)})};e.prototype.componentWillReceiveProps=function(e){e.selectedThemeId!==this.props.selectedThemeId&&(e.selectedThemeId.listId!==this.props.themeListId&&this.props.selectedThemeId.listId!==this.props.themeListId||this.forceUpdate())};e.prototype.forceUpdate=function(){this._themeList.forceUpdate();t.prototype.forceUpdate.call(this)};e.prototype._onRenderTheme=function(t,i){var r=this,e=this.props.selectedThemeId,n=e.index===i&&this.props.themeListId===e.listId,o=n?void 0:function(e){return r._onThemeClick(e,t,i)};return a.createElement("div",{onClick:o,title:t.name,"data-automationid":"ThemeListItem-"+i},a.createElement(s.ThemeListItem,{themeOption:t,index:i,selected:n,onEditThemeClick:this.props.onEditThemeClick,editable:this.props.editEnabled}))};e.prototype._onThemeClick=function(e,t,i){this.props.onThemeClick&&this.props.onThemeClick(e,t,i)};return e}(n.BaseComponent);t.ThemeList=o;t.default=o});define("G9",["require","exports","ap","at","jP","wN","d","Hd","Hb","Hh","Ha"],function(e,t,l,c,d,u,r,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){l.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={};return t}e.prototype.componentWillReceiveProps=function(e){if(this.props.selected!==e.selected){var t=e.selected;e.editable&&this.setState({buttonAnimation:t?r.AnimationStyles.fadeIn100:r.AnimationStyles.fadeOut100,titleAnimation:t?r.AnimationStyles.slideUpIn10:r.AnimationStyles.slideDownIn10})}else!this.props.selected&&this.state.buttonAnimation&&this.setState({buttonAnimation:void 0,titleAnimation:void 0})};e.prototype.render=function(){var e=this.props,t=e.selected,i=e.editable,r=e.themeOption,n=r.theme,o=r.name,a=r.isInverted,s={key:"choice",text:o,"data-is-focusable":!1};return c.createElement("div",{"data-is-focusable":!0,"aria-label":o,role:"option",className:d.css("sp-ThemeListItem",t&&"sp-ThemeListItem-selected"),"aria-selected":t},c.createElement("div",{"aria-hidden":!0,className:"sp-ThemeListItem-container"},c.createElement("div",{className:"sp-ThemeListItem-colorIcon"},c.createElement(m.ThemeIcon,{palette:n,isInverted:a,sampleText:h.default.themeSampleText})),c.createElement("div",{className:"sp-themeListItem-content"},c.createElement("div",{className:"sp-ThemeListItem-itemContentTitleContainer",style:l.__assign({},this.state.titleAnimation)},c.createElement(p.ChoiceGroup,{className:"sp-ThemeListItem-choice",options:[s],selectedKey:t&&"choice"})),t&&i&&c.createElement(u.CommandButton,{style:l.__assign({},this.state.buttonAnimation),className:"sp-ThemeListItem-commandButton","data-automationid":"ThemeListItemEditButton",onClick:this.props.onEditThemeClick},h.default.customizeThemeButton))))};return e}(d.BaseComponent);t.ThemeListItem=i});define("Hd",["require","exports","ap","He"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("He",["require","exports","ap","Hf"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("Hf",["require","exports","ap","at","mb","BZ","mo","jP","Hg"],function(e,t,u,p,s,o,l,m,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=i,r=function(i){u.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._inputElement=m.createRef();t._warnDeprecations({onChanged:"onChange"});t._warnMutuallyExclusive({selectedKey:"defaultSelectedKey"});t.state={keyChecked:void 0===e.defaultSelectedKey?t._getKeyChecked(e):e.defaultSelectedKey,keyFocused:void 0};t._id=m.getId("ChoiceGroup");t._labelId=m.getId("ChoiceGroupLabel");return t}e.prototype.componentWillReceiveProps=function(e){var t=this._getKeyChecked(e);t!==this._getKeyChecked(this.props)&&this.setState({keyChecked:t})};e.prototype.render=function(){var s=this,e=this.props,t=e.label,i=e.options,r=e.className,l=e.required,n=this.state,c=n.keyChecked,d=n.keyFocused;return p.createElement("div",{role:"application",className:r},p.createElement("div",{className:m.css("ms-ChoiceFieldGroup",h.root),role:"radiogroup","aria-labelledby":(this.props.label?this._id+"-label":"")+" "+(this.props["aria-labelledby"]||"")},this.props.label&&p.createElement(o.Label,{className:r,required:l,id:this._id+"-label"},t),p.createElement("div",{className:m.css("ms-ChoiceFieldGroup-flexContainer",i.some(function(e){return Boolean(e.iconProps||e.imageSrc)})&&h.optionsContainIconOrImage)},i.map(function(e){var t,i,r=e.onRenderField,n=void 0===r?s._onRenderField:r,o=e.onRenderLabel,a=void 0===o?s._onRenderLabel:o;m.assign(e,{checked:e.key===c,disabled:e.disabled||s.props.disabled,id:s._id+"-"+e.key,labelId:s._labelId+"-"+e.key,onRenderLabel:a});return p.createElement("div",{key:e.key,className:m.css("ms-ChoiceField",h.choiceField,(t={},t["ms-ChoiceField--image "+h.choiceFieldIsImage]=!!e.imageSrc,t["ms-ChoiceField--icon "+h.choiceFieldIsIcon]=!!e.iconProps,t["is-inFocus "+h.choiceFieldIsInFocus]=e.key===d,t))},p.createElement("div",{className:m.css("ms-ChoiceField-wrapper",h.choiceFieldWrapper)},p.createElement("input",u.__assign({ref:s._inputElement,id:e.id,className:m.css("ms-ChoiceField-input",h.input,(i={},i["ms-ChoiceField--image "+h.inputHasImage]=!!e.imageSrc,i["ms-ChoiceField--icon "+h.inputHasIcon]=!!e.iconProps,i)),type:"radio",name:s.props.name||s._id,disabled:e.disabled||s.props.disabled,checked:e.key===c,required:l,onChange:s._onChange.bind(s,e),onFocus:s._onFocus.bind(s,e),onBlur:s._onBlur.bind(s,e),"aria-labelledby":e.labelId},m.getNativeProps(e,m.inputProperties))),n(e,s._onRenderField)))}))))};e.prototype.focus=function(){this._inputElement.current&&this._inputElement.current.focus()};e.prototype._onFocus=function(e,t){this.setState({keyFocused:e.key,keyChecked:this.state.keyChecked})};e.prototype._onBlur=function(e,t){this.setState({keyFocused:void 0,keyChecked:this.state.keyChecked})};e.prototype._onRenderField=function(e){var t,i,r,n=e.onRenderLabel,o=e.imageSize?e.imageSize:{width:32,height:32},a=71<o.width||71<o.height;return p.createElement("label",{htmlFor:e.id,className:m.css("ms-ChoiceField-field",h.field,(t={},t["ms-ChoiceField-field--image "+h.fieldIsImage]=!!e.imageSrc,t["ms-ChoiceField--icon "+h.fieldIsIcon]=!!e.iconProps,t["is-checked "+h.fieldIsChecked]=e.checked,t["is-disabled "+h.fieldIsDisabled]=e.disabled,t["is-largeImage "+h.imageIsLarge]=!!e.imageSrc&&a,t))},e.imageSrc&&p.createElement("div",{className:m.css("ms-ChoiceField-innerField",h.innerField),style:{height:o.height,width:o.width}},p.createElement("div",{className:m.css("ms-ChoiceField-imageWrapper",h.imageWrapper,(i={},i["is-hidden "+h.imageWrapperIsHidden]=e.checked,i))},p.createElement(s.Image,{src:e.imageSrc,alt:e.imageAlt?e.imageAlt:"",width:o.width,height:o.height})),p.createElement("div",{className:m.css("ms-ChoiceField-imageWrapper",h.imageWrapper,(r={},r["is-hidden "+h.imageWrapperIsHidden]=!e.checked,r))},p.createElement(s.Image,{src:e.selectedImageSrc,alt:e.imageAlt?e.imageAlt:"",width:o.width,height:o.height}))),e.iconProps?p.createElement("div",{className:m.css("ms-ChoiceField-innerField",h.innerField)},p.createElement("div",{className:m.css("ms-ChoiceField-iconWrapper",h.iconWrapper)},p.createElement(l.Icon,u.__assign({},e.iconProps)))):null,e.imageSrc||e.iconProps?p.createElement("div",{className:m.css("ms-ChoiceField-labelWrapper",h.labelWrapper),style:{maxWidth:2*o.width}},n(e)):n(e))};e.prototype._onRenderLabel=function(e){return p.createElement("span",{id:e.labelId,className:"ms-Label"},e.text)};e.prototype._onChange=function(e,t){var i=this.props,r=i.onChanged,n=i.onChange;void 0===i.selectedKey&&this.setState({keyChecked:e.key});n?n(t,e):r&&r(e)};e.prototype._getKeyChecked=function(e){if(void 0!==e.selectedKey)return e.selectedKey;var t=e.options.filter(function(e){return e.checked});return 0===t.length?void 0:t[0].key};e.defaultProps={options:[]};return e}(m.BaseComponent);t.ChoiceGroup=r});define("Hg",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_5c88cb97{display:block}.optionsContainIconOrImage_5c88cb97{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap}.choiceField_5c88cb97{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;color:"},{theme:"bodyText",defaultValue:"#333333"},{rawString:";font-size:14px;font-weight:400;min-height:26px;border:none;position:relative;margin-top:8px}.choiceField_5c88cb97 .ms-Label{font-size:14px;padding:0 0 0 26px;display:inline-block}[dir='rtl'] .choiceField_5c88cb97 .ms-Label{padding:0 26px 0 0}.input_5c88cb97{position:absolute;opacity:0;top:8px}.field_5c88cb97::before{content:'';display:inline-block;background-color:"},{theme:"bodyBackground",defaultValue:"#ffffff"},{rawString:";border:1px solid "},{theme:"inputBorder",defaultValue:"#666666"},{rawString:";width:20px;height:20px;font-weight:normal;position:absolute;top:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-transition-property:border-color;transition-property:border-color;-webkit-transition-duration:200ms;transition-duration:200ms;-webkit-transition-timing-function:cubic-bezier(0.4, 0, 0.23, 1);transition-timing-function:cubic-bezier(0.4, 0, 0.23, 1);border-radius:50%}[dir='ltr'] .field_5c88cb97::before{left:0}[dir='rtl'] .field_5c88cb97::before{right:0}.field_5c88cb97::after{content:'';width:0;height:0;border-radius:50%;position:absolute;-webkit-transition-property:border-width;transition-property:border-width;-webkit-transition-duration:150ms;transition-duration:150ms;-webkit-transition-timing-function:cubic-bezier(0.4, 0, 0.23, 1);transition-timing-function:cubic-bezier(0.4, 0, 0.23, 1);-webkit-box-sizing:border-box;box-sizing:border-box}[dir='ltr'] .field_5c88cb97::after{left:10px}[dir='rtl'] .field_5c88cb97::after{right:10px}[dir='ltr'] .field_5c88cb97::after{right:0}[dir='rtl'] .field_5c88cb97::after{left:0}.field_5c88cb97{display:inline-block;cursor:pointer;margin-top:0;position:relative;vertical-align:top;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;min-height:20px}.field_5c88cb97:hover::before,.field_5c88cb97:focus::before{border-color:"},{theme:"inputBorderHovered",defaultValue:"#212121"},{rawString:"}@media screen and (-ms-high-contrast: active){.field_5c88cb97:hover::before,.field_5c88cb97:focus::before{border-color:Highlight}}.field_5c88cb97:hover .ms-Label,.field_5c88cb97:focus .ms-Label{color:"},{theme:"bodyTextChecked",defaultValue:"#000000"},{rawString:"}@media screen and (-ms-high-contrast: active){.field_5c88cb97:hover .ms-Label,.field_5c88cb97:focus .ms-Label{color:Highlight}}.field_5c88cb97.fieldIsChecked_5c88cb97::before{border:1px solid "},{theme:"inputBackgroundChecked",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast: active){.field_5c88cb97.fieldIsChecked_5c88cb97::before{border-color:Highlight}}.field_5c88cb97.fieldIsChecked_5c88cb97::after{border:5px solid "},{theme:"inputBackgroundChecked",defaultValue:"#0078d4"},{rawString:";top:5px;width:10px;height:10px}[dir='ltr'] .field_5c88cb97.fieldIsChecked_5c88cb97::after{left:5px}[dir='rtl'] .field_5c88cb97.fieldIsChecked_5c88cb97::after{right:5px}@media screen and (-ms-high-contrast: active){.field_5c88cb97.fieldIsChecked_5c88cb97::after{border-color:Highlight}}.field_5c88cb97.fieldIsChecked_5c88cb97:hover::before,.field_5c88cb97.fieldIsChecked_5c88cb97:focus::before{border-color:"},{theme:"inputBackgroundCheckedHovered",defaultValue:"#106ebe"},{rawString:"}.field_5c88cb97.fieldIsDisabled_5c88cb97{cursor:default}.field_5c88cb97.fieldIsDisabled_5c88cb97::before{background-color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:";border-color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}@media screen and (-ms-high-contrast: active){.field_5c88cb97.fieldIsDisabled_5c88cb97::before{border-color:GrayText}}.field_5c88cb97.fieldIsDisabled_5c88cb97 .ms-Label{color:"},{theme:"disabledText",defaultValue:"#c8c8c8"},{rawString:"}@media screen and (-ms-high-contrast: active){.field_5c88cb97.fieldIsDisabled_5c88cb97 .ms-Label{color:GrayText}}.field_5c88cb97.fieldIsChecked_5c88cb97.fieldIsDisabled_5c88cb97::before{background-color:"},{theme:"bodyBackground",defaultValue:"#ffffff"},{rawString:";border-color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field_5c88cb97.fieldIsChecked_5c88cb97.fieldIsDisabled_5c88cb97::after{background-color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:";border-color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.choiceFieldIsImage_5c88cb97,.choiceFieldIsIcon_5c88cb97{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;font-size:0;margin:0 4px 4px 0;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";height:100%}[dir='rtl'] .choiceFieldIsImage_5c88cb97,[dir='rtl'] .choiceFieldIsIcon_5c88cb97{margin:0 0 4px 4px}[dir='ltr'] .choiceFieldIsImage_5c88cb97,[dir='ltr'] .choiceFieldIsIcon_5c88cb97{padding-left:0px}[dir='rtl'] .choiceFieldIsImage_5c88cb97,[dir='rtl'] .choiceFieldIsIcon_5c88cb97{padding-right:0px}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97{display:inline-block;-webkit-box-sizing:content-box;box-sizing:content-box;cursor:pointer;padding-top:22px;margin:0;text-align:center;-webkit-transition:all 200ms ease;transition:all 200ms ease;border:2px solid transparent;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97.fieldIsDisabled_5c88cb97,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97.fieldIsDisabled_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97.fieldIsDisabled_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97.fieldIsDisabled_5c88cb97{cursor:default}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97.fieldIsDisabled_5c88cb97 .innerField_5c88cb97,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97.fieldIsDisabled_5c88cb97 .innerField_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97.fieldIsDisabled_5c88cb97 .innerField_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97.fieldIsDisabled_5c88cb97 .innerField_5c88cb97{opacity:0.25}@media screen and (-ms-high-contrast: active){.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97.fieldIsDisabled_5c88cb97 .innerField_5c88cb97,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97.fieldIsDisabled_5c88cb97 .innerField_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97.fieldIsDisabled_5c88cb97 .innerField_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97.fieldIsDisabled_5c88cb97 .innerField_5c88cb97{color:GrayText;opacity:1}}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97.imageIsLarge_5c88cb97 .innerField_5c88cb97,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97.imageIsLarge_5c88cb97 .innerField_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97.imageIsLarge_5c88cb97 .innerField_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97.imageIsLarge_5c88cb97 .innerField_5c88cb97{padding-left:24px;padding-right:24px}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97 .innerField_5c88cb97,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97 .innerField_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97 .innerField_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97 .innerField_5c88cb97{position:relative;display:inline-block;padding-left:30px;padding-right:30px}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97{padding-bottom:2px;-webkit-transition:opacity 200ms ease;transition:opacity 200ms ease}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97.imageWrapperIsHidden_5c88cb97,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97.imageWrapperIsHidden_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97.imageWrapperIsHidden_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97.imageWrapperIsHidden_5c88cb97{position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden;opacity:0}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97 .ms-Image,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97 .ms-Image,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97 .ms-Image,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97 .innerField_5c88cb97 .imageWrapper_5c88cb97 .ms-Image{display:inline-block;border-style:none}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97 .labelWrapper_5c88cb97,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97 .labelWrapper_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97 .labelWrapper_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97 .labelWrapper_5c88cb97{display:block;position:relative;margin:4px 8px;height:30px;line-height:15px;overflow:hidden;white-space:pre-wrap;text-overflow:ellipsis;font-size:14px;font-weight:400}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97 .labelWrapper_5c88cb97 .ms-Label,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97 .labelWrapper_5c88cb97 .ms-Label,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97 .labelWrapper_5c88cb97 .ms-Label,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97 .labelWrapper_5c88cb97 .ms-Label{padding:0}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97::before,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97::before,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97::before,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97::before{top:3px;opacity:0}[dir='ltr'] .choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97::before,[dir='ltr'] .choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97::before,[dir='ltr'] .choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97::before,[dir='ltr'] .choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97::before{right:3px}[dir='rtl'] .choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97::before,[dir='rtl'] .choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97::before,[dir='rtl'] .choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97::before,[dir='rtl'] .choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97::before{left:3px}[dir='ltr'] .choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97::before,[dir='ltr'] .choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97::before,[dir='ltr'] .choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97::before,[dir='ltr'] .choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97::before{left:auto}[dir='rtl'] .choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97::before,[dir='rtl'] .choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97::before,[dir='rtl'] .choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97::before,[dir='rtl'] .choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97::before{right:auto}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97::after,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97::after,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97::after,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97::after{top:13px}[dir='ltr'] .choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97::after,[dir='ltr'] .choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97::after,[dir='ltr'] .choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97::after,[dir='ltr'] .choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97::after{right:13px}[dir='rtl'] .choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97::after,[dir='rtl'] .choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97::after,[dir='rtl'] .choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97::after,[dir='rtl'] .choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97::after{left:13px}[dir='ltr'] .choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97::after,[dir='ltr'] .choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97::after,[dir='ltr'] .choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97::after,[dir='ltr'] .choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97::after{left:auto}[dir='rtl'] .choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97::after,[dir='rtl'] .choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97::after,[dir='rtl'] .choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97::after,[dir='rtl'] .choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97::after{right:auto}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover,.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus{border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}@media screen and (-ms-high-contrast: active){.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover,.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus{border-color:Highlight;color:Highlight}}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover::before,.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus::before,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover::before,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus::before,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover::before,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus::before,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):hover::before,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97):focus::before{opacity:1}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::before,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::before,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::before,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::before{opacity:1}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after{top:8px}[dir='ltr'] .choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after,[dir='ltr'] .choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after,[dir='ltr'] .choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after,[dir='ltr'] .choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after{right:8px}[dir='rtl'] .choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after,[dir='rtl'] .choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after,[dir='rtl'] .choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after,[dir='rtl'] .choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97::after{left:8px}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover,.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus{border-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover::before,.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus::before,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover::before,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus::before,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover::before,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus::before,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover::before,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus::before{border-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover::after,.choiceFieldIsImage_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus::after,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover::after,.choiceFieldIsImage_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus::after,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover::after,.choiceFieldIsIcon_5c88cb97 .fieldIsImage_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus::after,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:hover::after,.choiceFieldIsIcon_5c88cb97 .fieldIsIcon_5c88cb97:not(.fieldIsDisabled_5c88cb97).fieldIsChecked_5c88cb97:focus::after{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.choiceFieldIsImage_5c88cb97 .inputHasImage_5c88cb97,.choiceFieldIsImage_5c88cb97 .inputHasIcon_5c88cb97,.choiceFieldIsIcon_5c88cb97 .inputHasImage_5c88cb97,.choiceFieldIsIcon_5c88cb97 .inputHasIcon_5c88cb97{top:0;right:0;opacity:0;width:100%;height:100%;margin:0}.choiceFieldIsIcon_5c88cb97 .iconWrapper_5c88cb97{font-size:32px;line-height:32px;height:32px}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97 .choiceFieldWrapper_5c88cb97::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97 .choiceFieldWrapper_5c88cb97{outline:transparent}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97 .choiceFieldWrapper_5c88cb97{position:relative}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97 .choiceFieldWrapper_5c88cb97:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97 .choiceFieldWrapper_5c88cb97::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97 .choiceFieldWrapper_5c88cb97{outline:transparent}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97 .choiceFieldWrapper_5c88cb97{position:relative}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97 .choiceFieldWrapper_5c88cb97:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:2px solid WindowText}}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsImage_5c88cb97 .choiceFieldWrapper_5c88cb97::-moz-focus-inner,.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsIcon_5c88cb97 .choiceFieldWrapper_5c88cb97::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsImage_5c88cb97 .choiceFieldWrapper_5c88cb97,.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsIcon_5c88cb97 .choiceFieldWrapper_5c88cb97{outline:transparent}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsImage_5c88cb97 .choiceFieldWrapper_5c88cb97,.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsIcon_5c88cb97 .choiceFieldWrapper_5c88cb97{position:relative}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsImage_5c88cb97 .choiceFieldWrapper_5c88cb97:after,.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsIcon_5c88cb97 .choiceFieldWrapper_5c88cb97:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsImage_5c88cb97 .choiceFieldWrapper_5c88cb97::-moz-focus-inner,.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsIcon_5c88cb97 .choiceFieldWrapper_5c88cb97::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsImage_5c88cb97 .choiceFieldWrapper_5c88cb97,.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsIcon_5c88cb97 .choiceFieldWrapper_5c88cb97{outline:transparent}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsImage_5c88cb97 .choiceFieldWrapper_5c88cb97,.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsIcon_5c88cb97 .choiceFieldWrapper_5c88cb97{position:relative}.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsImage_5c88cb97 .choiceFieldWrapper_5c88cb97:after,.ms-Fabric--isFocusVisible .choiceFieldIsInFocus_5c88cb97.choiceFieldIsIcon_5c88cb97 .choiceFieldWrapper_5c88cb97:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid WindowText}}\n"}]);t.root="root_5c88cb97";t.optionsContainIconOrImage="optionsContainIconOrImage_5c88cb97";t.choiceField="choiceField_5c88cb97";t.input="input_5c88cb97";t.field="field_5c88cb97";t.fieldIsChecked="fieldIsChecked_5c88cb97";t.fieldIsDisabled="fieldIsDisabled_5c88cb97";t.choiceFieldIsImage="choiceFieldIsImage_5c88cb97";t.choiceFieldIsIcon="choiceFieldIsIcon_5c88cb97";t.fieldIsImage="fieldIsImage_5c88cb97";t.fieldIsIcon="fieldIsIcon_5c88cb97";t.innerField="innerField_5c88cb97";t.imageIsLarge="imageIsLarge_5c88cb97";t.imageWrapper="imageWrapper_5c88cb97";t.imageWrapperIsHidden="imageWrapperIsHidden_5c88cb97";t.labelWrapper="labelWrapper_5c88cb97";t.inputHasImage="inputHasImage_5c88cb97";t.inputHasIcon="inputHasIcon_5c88cb97";t.iconWrapper="iconWrapper_5c88cb97";t.choiceFieldIsInFocus="choiceFieldIsInFocus_5c88cb97";t.choiceFieldWrapper="choiceFieldWrapper_5c88cb97"});define("Hb",["require","exports","ap","at","Hc"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.palette.primaryBackground||this.props.palette.white||"transparent";return r.createElement("svg",{role:"presentation",className:"sp-ThemeListItem-svgIcon",viewBox:"0 0 84 46","aria-hidden":!0},r.createElement("rect",{height:"100%",width:"100%",fill:e,stroke:"none"}),this._renderShades(),r.createElement("text",{x:"10%",y:"84%",fill:this.props.palette.primaryText,role:"presentation"},this.props.sampleText))};t.prototype._renderShades=function(){var e=this.props.palette,t=this.props.isInverted;return[r.createElement("rect",{key:"primary",y:"0%",height:"50%",width:"50%",fill:e.themePrimary,stroke:"none"}),r.createElement("rect",{key:"secondary",y:"0%",height:"50%",width:50/3+"%",fill:t?e.themeDark:e.themeSecondary,stroke:"none",x:"50%"}),r.createElement("rect",{key:"accent",y:"0%",height:"50%",width:50/3+"%",fill:t?e.themeDarker:e.themeTertiary,stroke:"none",x:50+50/3+"%"}),r.createElement("rect",{key:"last",y:"0%",height:"50%",width:50/3+"%",fill:e.accent||e.themePrimary,stroke:"none",x:50+50/3+50/3+"%"})]};return t}(r.PureComponent);t.ThemeIcon=n});define("Hc",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".sp-ThemeListItem-svgIcon{height:100%;width:100%}"}])});define("Ha",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".sp-ThemeListItem-selected.sp-ThemeListItem{cursor:default}.ms-Fabric .sp-ThemeListItem::-moz-focus-inner{border:0}.ms-Fabric .sp-ThemeListItem{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .sp-ThemeListItem:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .sp-ThemeListItem:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .sp-ThemeListItem:focus:after{border-color:#37006e}}.sp-ThemeListItem-colorIcon{height:48px;width:86px;border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";box-sizing:border-box;-ms-flex-negative:0;flex-shrink:0}.sp-ThemeListItem{margin:4px 0;cursor:pointer}.sp-themeListItem-content{min-width:30px}.sp-ThemeListItem-itemContentTitleContainer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-positive:1;flex-grow:1}.sp-ThemeListItem-itemContentTitle{font-weight:400;text-overflow:ellipsis;white-space:nowrap;min-width:10px;overflow:hidden}html[dir=ltr] .sp-ThemeListItem-itemContentTitle{padding-left:8px}html[dir=rtl] .sp-ThemeListItem-itemContentTitle{padding-right:8px}.sp-ThemeListItem-container{position:relative;display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center;padding:8px 0}.sp-ThemeListItem-commandButton{font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";height:20px}html[dir=ltr] .sp-ThemeListItem-commandButton{padding-left:29px}html[dir=rtl] .sp-ThemeListItem-commandButton{padding-right:29px}html[dir=ltr] .sp-ThemeListItem-choice{padding-left:8px}html[dir=rtl] .sp-ThemeListItem-choice{padding-right:8px}.sp-ThemeListItem-choice .ms-ChoiceField{margin-top:0}"}])});define("G7",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-Fabric .sp-ThemeList-focusZone::-moz-focus-inner{border:0}.ms-Fabric .sp-ThemeList-focusZone{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .sp-ThemeList-focusZone:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .sp-ThemeList-focusZone:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .sp-ThemeList-focusZone:focus:after{border-color:#37006e}}.sp-ChangeTheLookPanel-themeListHeader{font-size:14px}.sp-ThemeList-ariaLabel{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.sp-ChangeTheLookPanel-themeList{margin-top:0;margin-bottom:20px;width:100%}"}])});define("G3",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".sp-ChangeTheLookPanel-footerButton+.sp-ChangeTheLookPanel-footerButton{margin:0 4px}.sp-ChangeTheLookPanel-spinnerContainer{height:30px}.sp-ChangeTheLookPanel-footerLinkContainer{padding-top:16px}.sp-ChangeTheLookPanel-footerLinks{display:block;box-sizing:border-box}.sp-ChangeTheLookPanel-footerLink{margin:4px 0}.sp-ChangeTheLookPanel{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.sp-ChangeTheLookPanel-errorText{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";background-color:"},{theme:"errorBackground",defaultValue:"#fde7e9"},{rawString:"}.sp-ChangeTheLookPanel-headerContainer{display:-ms-flexbox;display:flex;margin:30px 0}@media (min-width:768px){.sp-ChangeTheLookPanel-headerContainer{padding-left:32px;padding-right:32px}.sp-ChangeTheLookPanel-headerContainer.editing{padding-left:24px;padding-right:24px}}@media (min-width:1366px){.sp-ChangeTheLookPanel-headerContainer{padding-left:40px;padding-right:40px}.sp-ChangeTheLookPanel-headerContainer.editing{padding-left:32px;padding-right:32px}}.sp-ChangeTheLookPanel-headerText{font-size:21px;font-weight:100;margin:0}"}])});define("G0",["require","exports","ap","HB","G1"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t)});define("HB",["require","exports","ap","aC","HG","jP","aI","a0","aW","G4","Go","V","HD","HC"],function(e,t,n,o,i,r,l,a,s,c,d,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:519},f=function(){function e(e){var t=this;this._params=e;this._pageContext=e.pageContext;this._themeManager=new i.ThemeManager({pageContext:e.pageContext});this._defaultThemes=[];this._EditableChangeTheLookPanelFlight=s.default.isFeatureEnabled(h);this._editingTheme=!1;this._themes=this._themeManager.getThemes();this._isOpen=!0;this._themeApplied=!1;this._errorText="";this._hubSiteName="";this._loading=!0;this._themeManager.getCurrentTheme().then(function(e){t._currentlySelectedTheme=t._currentlyAppliedTheme=e;t._params.updateState(t.getRenderProps())});this._currentlySelectedHeaderEmphasis=this._pageContext.headerEmphasis;a.Engagement.logData({name:"ChangeTheLookPanelStateManager.LoadPanel"})}e.prototype.getRenderProps=function(){var e,t,i=!!this._EditableChangeTheLookPanelFlight&&this._canEditCurrentTheme();if(this._isThemeLocked())e=[this._currentlyAppliedTheme];else{e=this._themes;t=this._defaultThemes}var r=this._getEditingThemeProps(),n=r.colorThemes,o=r.accentColorMap,a=this._isThemeLocked(),s=a?u.format(c.default.themeLockedText,this._hubSiteName):void 0;return{onSave:this._onSave,saveEnabled:!!this._currentlySelectedTheme,onCancel:this._onCancel,themes:e,onThemeClick:this._onThemeClick,isThemeLocked:a,themeLockedText:s,isOpen:this._isOpen,onDismiss:this._onDismiss,changeTheLookPageLink:this._getClassicChangeTheLookUrl(),onClearTheme:this._onClearTheme,errorText:this._errorText,isLoading:this._loading,currentlySelectedTheme:this._currentlySelectedTheme,onEditThemeClick:this._onEditThemeClick,editingTheme:this._editingTheme,onBackButtonClick:this._onBackClick,currentlyAppliedTheme:this._currentlyAppliedTheme,defaultThemes:t,currentThemeEditable:i,colorThemes:n,accentColorMap:o,onHeaderEmphasisChanged:this._onHeaderEmphasisChanged,currentlySelectedHeaderEmphasis:this._currentlySelectedHeaderEmphasis}};e.prototype.componentDidMount=function(){var t=this,i=this._isThemeLocked(),e=[];e.push(this._themeManager.getCurrentTheme().then(function(e){t._currentlySelectedTheme=t._currentlyAppliedTheme=e;if(!i)return t._loadThemes()}));if(i){var r=new d.HubDataSource(this._pageContext);e.push(r.getHubData().then(function(e){t._hubSiteName=e.name}))}var n=function(){t._loading=!1;t._params.updateState(t.getRenderProps())};o.default.all(e).then(n,n)};e.prototype._loadThemes=function(){var a=this,s=new l.Qos({name:"ChangeTheLookPanelStateManager.LoadThemes"});return this._themeManager.getThemesPromise().then(function(e){if(e.defaultThemes&&e.defaultThemes.length)for(var t=0,i=e.defaultThemes;t<i.length;t++){(o=i[t]).error?a._errorText=c.default.errorFetchingThemes:a._EditableChangeTheLookPanelFlight?a._defaultThemes.push(o):a._themes.push(o)}if(e.customThemes&&e.customThemes.length)for(var r=0,n=e.customThemes;r<n.length;r++){var o;(o=n[r]).error?a._errorText=c.default.errorFetchingThemes:a._themes.push(o)}s.end({resultType:l.ResultTypeEnum.Success})},function(e){s.end({resultType:l.ResultTypeEnum.Failure,error:"There was an error while loading the themes "+JSON.stringify(e)});a._errorText=c.default.errorFetchingThemes})};e.prototype._onDismiss=function(){var e=this;if(this._isOpen){this._isOpen=!1;this._params.updateState(this.getRenderProps(),function(){e._params.onDismiss&&e._params.onDismiss();if(!e._themeApplied){a.Engagement.logData({name:"ChangeTheLookPanelStateManager.Cancel.Click"});var t=new l.Qos({name:"ChangeTheLookPanelStateManager.CancelClick"});try{e._themeManager.resetTheme();p.setEmphasisTheme(e._pageContext.headerEmphasis);t.end({resultType:l.ResultTypeEnum.Success})}catch(e){t.end({resultType:l.ResultTypeEnum.Failure,error:e})}}})}};e.prototype._onSave=function(){var i=this,r=new l.Qos({name:"ChangeTheLookPanelStateManager.SaveTheme"});a.Engagement.logData({name:"ChangeTheLookPanelStateManager.SaveTheme.Click",extraData:n.__assign({},this._currentlySelectedTheme.extraData,{isInverted:this._currentlySelectedTheme.isInverted})});if(this._currentlyAppliedTheme||this._currentlySelectedHeaderEmphasis){this._loading=!0;return o.default.all([new o.default(function(t){i._params.updateState(i.getRenderProps(),function(){i._themeApplied=!0;i._themeManager.setTheme(i._currentlySelectedTheme).then(function(e){r.end({resultType:l.ResultTypeEnum.Success});t()},function(e){r.end({resultType:l.ResultTypeEnum.Failure,error:e});t()})})}),new o.default(function(t){new m.HeaderEmphasisDataSource(i._pageContext).setHeaderEmphasis(i._currentlySelectedHeaderEmphasis).then(function(e){i._pageContext.headerEmphasis=i._currentlySelectedHeaderEmphasis;t()})})]).catch(function(e){return o.default.reject(e)})}return o.default.resolve()};e.prototype._onClearTheme=function(){var e=this,t=new l.Qos({name:"ChangeTheLookPanelStateManager.ClearTheme"});a.Engagement.logData({name:"ChangeTheLookPanelStateManager.ClearTheme.Click"});this._themeManager.clearSetTheme().then(function(){return e._themeManager.getCurrentTheme(!0).then(function(e){t.end({resultType:l.ResultTypeEnum.Success});location.reload()},function(e){t.end({resultType:l.ResultTypeEnum.Failure,error:e})})});p.setEmphasisTheme(this._pageContext.headerEmphasis);this._currentlySelectedHeaderEmphasis=this._pageContext.headerEmphasis};e.prototype._onCancel=function(){this._verifyAndCallFunction(this._params.onCancel)};e.prototype._onThemeClick=function(e,t){var i,r=this;if(this._editingTheme){i=new l.Qos({name:"ChangeTheLookPanelStateManager.EditThemePreviewClick"});a.Engagement.logData({name:"ChangeTheLookPanelStateManager.EditThemePreview.Click"})}else{i=new l.Qos({name:"ChangeTheLookPanelStateManager.PreviewThemeClick"});a.Engagement.logData({name:"ChangeTheLookPanelStateManager.PreviewTheme.Click"})}if(t){this._currentlySelectedTheme=t;this._params.updateState(this.getRenderProps(),function(){try{r._applyTheme(t);i.end({resultType:l.ResultTypeEnum.Success})}catch(e){i.end({resultType:l.ResultTypeEnum.Failure,error:"There was an error attempting to preview the theme"});r._errorText=c.default.errorPreviewingTheme;r._params.updateState(r.getRenderProps())}})}else{i.end({resultType:l.ResultTypeEnum.Failure,error:"No theme was provided to preview"});this._errorText=c.default.errorPreviewingTheme;this._params.updateState(this.getRenderProps())}};e.prototype._applyTheme=function(e){this._themeManager.loadTheme(e);p.setEmphasisTheme(this._currentlySelectedHeaderEmphasis)};e.prototype._onEditThemeClick=function(e){a.Engagement.logData({name:"ChangeTheLookPanelStateManager.EditTheme.Click"});this._editingTheme=!0;this._themeBeingEdited=this._currentlySelectedTheme;e.stopPropagation();this._params.updateState(this.getRenderProps())};e.prototype._onBackClick=function(e){var t=new l.Qos({name:"ChangeTheLookPanelStateManager.ExitEditThemeClick"});a.Engagement.logData({name:"ChangeTheLookPanelStateManager.ExitEditTheme.Click"});try{this._editingTheme=!1;this._currentlySelectedTheme=this._themeBeingEdited;this._themeBeingEdited=null;this._applyTheme(this._currentlySelectedTheme);t.end({resultType:l.ResultTypeEnum.Success})}catch(e){t.end({resultType:l.ResultTypeEnum.Failure,error:"There was an error attempting to preview the theme while exiting edit mode."})}e.stopPropagation();this._params.updateState(this.getRenderProps())};e.prototype._onHeaderEmphasisChanged=function(e){p.setEmphasisTheme(e);this._currentlySelectedHeaderEmphasis=e};e.prototype._getEditingThemeProps=function(){var e={colorThemes:void 0,accentColorMap:void 0};this._editingTheme&&(e={colorThemes:this._getColorThemes(),accentColorMap:this._getAccentColors()});return e};e.prototype._getColorThemes=function(){var e=this._themeBeingEdited;if(this._EditableChangeTheLookPanelFlight&&e)return this._themeManager.getColorThemes(e.isInverted,e.theme.primaryBackground)};e.prototype._getAccentColors=function(){var e=this._themeBeingEdited;if(this._EditableChangeTheLookPanelFlight&&e)return this._themeManager.getAccentColors(e.theme.primaryBackground)};e.prototype._canEditCurrentTheme=function(){var e=this._currentlyAppliedTheme;if(this._currentlyAppliedTheme){var t=this._themeManager.getColorThemes()[e.theme.themePrimary];if(t&&t.primaryBackground===e.theme.primaryBackground)return!0}return!1};e.prototype._getClassicChangeTheLookUrl=function(){return this._pageContext.webAbsoluteUrl+"/"+this._pageContext.layoutsUrl+"/designgallery.aspx"};e.prototype._verifyAndCallFunction=function(e){e&&"function"==typeof e&&e()};e.prototype._isThemeLocked=function(){var e=this._pageContext,t=e.isHubSite;return e.hubSiteId&&!t};n.__decorate([r.autobind],e.prototype,"_onDismiss",null);n.__decorate([r.autobind],e.prototype,"_onSave",null);n.__decorate([r.autobind],e.prototype,"_onClearTheme",null);n.__decorate([r.autobind],e.prototype,"_onCancel",null);n.__decorate([r.autobind],e.prototype,"_onThemeClick",null);n.__decorate([r.autobind],e.prototype,"_applyTheme",null);n.__decorate([r.autobind],e.prototype,"_onEditThemeClick",null);n.__decorate([r.autobind],e.prototype,"_onBackClick",null);n.__decorate([r.autobind],e.prototype,"_onHeaderEmphasisChanged",null);n.__decorate([r.autobind],e.prototype,"_getEditingThemeProps",null);return e}();t.ChangeTheLookPanelStateManager=f;t.default=f});define("HG",["require","exports","ap","d","Hk","HH","aF","aC","jP","Hh"],function(e,t,a,n,r,i,s,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function o(e){this._themeProvider=e.themeProvider?e.themeProvider:i.getDefaultThemeProvider(e.pageContext);this._themes=[];this._tenantThemeProvider=e.TenantThemesProvider?e.TenantThemesProvider:new i.TenantThemesProvider({pageContext:e.pageContext});this._currentThemePromise=o._currentTheme?l.default.wrap(o._currentTheme):this._loadCurrentTheme(!0);this._themesPromise=this._loadThemes()}o.prototype.resetTheme=function(){this.loadTheme(o._currentTheme)};o.prototype.loadTheme=function(e){var t=e.backgroundImageUri?'url("'+e.backgroundImageUri+'")':"none",i=e.theme.backgroundOverlay?e.theme.backgroundOverlay:"",r=a.__assign({},o._getGeneratedThemeColors(e.theme),e.theme,{backgroundImageUri:t,backgroundOverlay:i});n.loadTheme({palette:r,isInverted:!!e.isInverted})};o.prototype.getThemes=function(){return this._themes};o.prototype.getThemesPromise=function(){var t=this;return l.default.all([this._themesPromise,this.getCurrentTheme(!1)]).then(function(e){t._themes=e[0];return{currentTheme:o._currentTheme=e[1],customThemes:t._themes,defaultThemes:t._defaultThemes}})};o.prototype.getLoadingThemes=function(){return this._loadingThemes};o.prototype.getCurrentTheme=function(e){if(e){o._currentTheme=null;this._currentThemePromise=this._loadCurrentTheme(!0)}return!o._currentTheme&&this._currentThemePromise?this._currentThemePromise:l.default.resolve(o._currentTheme)};o.prototype.clearSetTheme=function(){return this._tenantThemeProvider.clearTheme()};o.prototype.setTheme=function(e){var t={};for(var i in e.theme)t[i]=s.default.fromHtmlColor(e.theme[i]);var r={name:e.name,theme:{backgroundImageUri:e.backgroundImageUri||"",palette:t,cacheToken:"",isDefault:!0,isInverted:e.isInverted,version:""}},n=e;return this._tenantThemeProvider.setTheme(r).then(function(e){o._currentTheme=a.__assign({},n,{name:d.default.currentTheme});return e})};o.prototype.getColorThemes=function(e,t){return r.getPartialThemes(e,t)};o.prototype.getAccentColors=function(e){return r.getAccentColorMapping(e)};o.prototype._loadCurrentTheme=function(e){var r=this;return this._themeProvider.loadFullThemeData(e).then(function(e){var t={name:d.default.currentTheme,theme:{}};if(e){t.isInverted=e.isInverted;t.backgroundImageUri=e.backgroundImageUri;for(var i in e.palette)e.palette[i]&&(t.theme[i]=s.default.toHtmlString(e.palette[i]))}t.theme=c.assign({},t.theme,n.createTheme({palette:t.theme}).palette);o._currentTheme=t;r._currentThemePromise=null;return t})};o.prototype._loadThemes=function(){var i=this;return this._tenantThemeProvider.getTenantThemingOptions().then(function(e){var t=[];e.hideDefaultThemes||(i._defaultThemes=i._getDefaultThemes());e.themes.forEach(function(e){t.push({name:e.name,isInverted:e.theme.isInverted,backgroundImageUri:e.theme.backgroundImageUri,theme:i._convertPaletteToHTMLStrings(e.theme.palette),error:e.error})});return t})};o.prototype._convertPaletteToHTMLStrings=function(e){var t={};for(var i in e)e[i]&&(t[i]=s.default.toHtmlString(e[i]));return t};o.prototype._getDefaultThemes=function(){var e=r.getDefaultThemes(),t=[];if(d.default)for(var i in d.default)if(e[i]){e[i].name=d.default[i];e[i].extraData={isOutOfBoxTheme:!0};t.push(e[i])}return t};o._getGeneratedThemeColors=function(e){return{primaryBackground:e.PageBackground||e.backgroundColor,primaryText:e.primaryText||e.neutralPrimary,backgroundOverlay:e.BackgroundOverlay,suiteBarBackground:e.SuiteBarBackground||e.themePrimary,suiteBarText:e.SuiteBarText||e.white,suiteBarDisabledText:e.SuiteBarDisabledText||e.neutralLight,topBarBackground:e.TopBarBackground||e.neutralLight,topBarText:e.TopBarText||e.neutralSecondary,topBarHoverText:e.TopBarHoverText||e.neutralPrimary,dialogBorder:e.DialogBorder||e.neutralLighter}};return o}();t.ThemeManager=o;t.default=o});define("HH",["require","exports","ap","ea","HK","HJ","aB","HI","aE"],function(e,t,i,r,n,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(o,t);i.__exportStar(a,t);i.__exportStar(s,t);i.__exportStar(l,t)});define("HK",["require","exports","ap","eq","ef","aM","eb"],function(e,t,p,r,i,n,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(i){p.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._pageContext=e;return t}e.prototype.getThemingOptions=function(){var t=this,e=r.getSafeWebServerRelativeUrl(this._pageContext),i=this.getTenantThemeRestUrl(e);return this.getData(function(){return i+"GetTenantThemingOptions"},function(e){return t._processResponse(e,"GetTenantThemingOptions")},"GetTenantThemingOptions",null,"GET")};e.prototype.setTheme=function(e){var t={name:e.name,themeJson:JSON.stringify(e.theme)};return this._applyTheme(t)};e.prototype.clearTheme=function(){return this._applyTheme({name:"",themeJson:""}).then(function(e){return!0},function(e){return!1})};e.prototype.getDataSourceName=function(){return"ThemeManager"};e.prototype._applyTheme=function(e){var t=r.getSafeWebServerRelativeUrl(this._pageContext),i=this.getTenantThemeRestUrl(t);return this.getData(function(){return i+"ApplyTheme"},function(e){var t=JSON.parse(e);return t.d&&t.d.ApplyTheme?t.d.ApplyTheme:""},"ApplyTheme",function(){return JSON.stringify(e)},"POST",null,null,null,!0,null,function(e){return"error was thrown "+e.correlationId})};e.prototype._processResponse=function(e,t){var i=JSON.parse(e),r=[],n=!1;if(i&&i.d&&i.d[t]){var o=i.d[t];n=!!o.hideDefaultThemes;for(var a=0,s=o.themePreviews.results;a<s.length;a++){var l=s[a],c=void 0,d=void 0,u={name:l.name,theme:{backgroundImageUri:"",cacheToken:"",isDefault:!1,isInverted:!1,palette:{},version:""}};try{c=JSON.parse(l.themeJson);d=m.default.convertColorsToRgba(c.palette);u.theme=p.__assign({},c,{palette:d})}catch(e){u.error=!0}r.push(u)}}return{hideDefaultThemes:n,themes:r}};e.prototype.getTenantThemeRestUrl=function(e){var t=e&&e.replace(/\/$/,"")||"";return n.default.escapeUrlForCallback(t)+"/_api/ThemeManager/"};return e}(i.DataSource);t.default=o});define("HJ",["require","exports","HK","a1"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._themeDataSource=e.tenantThemeDataSource?e.tenantThemeDataSource:new i.default(e.pageContext)}e.prototype.getTenantThemingOptions=function(){return this._themeDataSource.getThemingOptions()};e.prototype.setTheme=function(t){return this._themeDataSource.setTheme(t).then(function(e){e&&r.default.updateThemeCache(t.theme,e);return e})};e.prototype.clearTheme=function(){return this._themeDataSource.clearTheme()};return e}();t.TenantThemesProvider=n});define("HI",["require","exports","aB","aE","ea","aC"],function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDefaultThemeProvider=function(e){var t=e||window._spPageContextInfo,i={webThemeProvider:function(){return new n.WebThemeProvider({pageContext:t,getThemeDataSource:function(){return a.default.resolve(new o.default(t))}})}};return r.getThemeProvider(i,t)}});define("HD",["require","exports","jP","e","HE"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.setEmphasisTheme=function(e){var t;switch(e){case 2:t=n.getSoftVariant(r.getTheme());break;case 3:t=n.getStrongVariant(r.getTheme())}i.Customizations.applySettings({emphasisTheme:t})}});define("HE",["require","exports","HF"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getNeutralVariant=i.getNeutralVariant;t.getSoftVariant=i.getSoftVariant;t.getStrongVariant=i.getStrongVariant});define("HF",["require","exports","ap","e"],function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(e,t,i){return o.createTheme(n.__assign({},e,{palette:n.__assign({},e.palette,t),semanticColors:n.__assign({},e.semanticColors,i)}))}t.getNeutralVariant=function(e){var t=o.createTheme(e).palette;return i(e,{neutralLight:t.neutralQuaternaryAlt,neutralLighter:t.neutralLight,neutralLighterAlt:t.neutralLight,white:t.neutralLighter},{bodyBackground:t.neutralLighter})};t.getSoftVariant=function(e){var t=o.createTheme(e).palette;return i(e,{white:t.themeLighterAlt},{bodyBackground:t.themeLighterAlt,inputBorder:t.themeLighter,inputBackground:t.themeLighter,inputForegroundChecked:t.themeLighterAlt})};t.getStrongVariant=function(e){var t=o.createTheme(e).palette,i={themeDarker:t.white,themeDark:t.neutralLighterAlt,themeDarkAlt:t.neutralLighterAlt,themePrimary:t.white,themeSecondary:t.neutralLighter,themeTertiary:t.neutralLight,themeLight:t.neutralQuaternaryAlt,themeLighter:t.neutralQuaternary,themeLighterAlt:t.neutralTertiaryAlt,black:t.neutralLighterAlt,neutralDark:t.neutralLighter,neutralPrimary:t.white,neutralPrimaryAlt:t.neutralLight,neutralSecondary:t.neutralQuaternaryAlt,neutralTertiary:t.neutralQuaternary,neutralTertiaryAlt:t.themeLighterAlt,neutralQuaternary:t.themeLighter,neutralQuaternaryAlt:t.themeLight,neutralLight:t.themeTertiary,neutralLighter:t.themeSecondary,neutralLighterAlt:t.themePrimary,white:t.themeDarkAlt},r={bodyBackground:t.themeDarkAlt,bodyText:t.white,bodySubtext:t.white,inputBorder:t.themeDark,inputBackground:t.themeDark,inputBackgroundChecked:t.white,inputForegroundChecked:t.themeDark};return o.createTheme(n.__assign({},e,{palette:i,semanticColors:r,isInverted:!e.isInverted}))}});define("HC",["require","exports","ap","aC","ef"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.getDataSourceName=function(){return"HeaderEmphasis"};e.prototype.setHeaderEmphasis=function(e){var t=this;return e.toString()?this.getData(function(){return t._pageContext.webAbsoluteUrl+"/_api/web"},function(e){},"setHeaderEmphasis",function(){return JSON.stringify({HeaderEmphasis:e,__metadata:{type:"SP.Web"}})},"POST",{"X-HTTP-Method":"MERGE"}):r.default.resolve()};return e}(n.DataSource);t.HeaderEmphasisDataSource=o});define("G1",["require","exports","ap","at","HB","G2","jP"],function(e,t,r,n,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._changeTheLookPanelStateManager=new o.ChangeTheLookPanelStateManager(r.__assign({},e,{updateState:t.setState.bind(t)}));t.state=t._changeTheLookPanelStateManager.getRenderProps();return t}e.prototype.componentDidMount=function(){this._changeTheLookPanelStateManager.componentDidMount()};e.prototype.render=function(){return n.createElement(a.ChangeTheLookPanel,r.__assign({},this.state))};return e}(i.BaseComponent);t.ChangeTheLookPanelContainer=s});define("GT",["require","exports","ap","GW","GU"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t)});define("GW",["require","exports","ap","at","jP","o1","Du","GY","GX"],function(e,t,i,s,r,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){i.__extends(e,t);function e(e){return t.call(this,e)||this}e.prototype.render=function(){var e=this.props,t=e.isWidgetRendered,i=e.showError,r=e.containerId,n=e.showWidget,o=e.errorImgUrl,a=t&&!i;return s.createElement(c.Panel,{className:"ms-FlowPanel",type:c.PanelType.smallFixedFar,isHiddenOnDismiss:!0,isLightDismiss:!0,isOpen:n,onDismiss:this._onDismiss,forceFocusInsideTrap:!1},s.createElement("div",{className:"ms-FlowPanel-contents","data-automationid":"flowControl"},!t&&!i&&s.createElement(l.Spinner,{className:"ms-FlowPanel-center"}),i&&s.createElement("div",{className:"ms-FlowPanel-center"},s.createElement("img",{className:"ms-FlowPanel-errorImage",role:"presentation",src:o}),s.createElement("div",{className:"ms-FlowPanel-errorMessage ms-font-s ms-fontColor-neutralSecondary"},d.default.error)),r&&s.createElement("div",{className:"ms-FlowPanel-iframeContainer "+(a?"":"ms-FlowPanel--hidden"),id:r,ref:this._resolveRef("_iframeContainer")})))};e.prototype.componentDidUpdate=function(e,t){var i=this.props.stateManager;if(i&&this._iframeContainer&&!this._isIframeContainerPassed){this._isIframeContainerPassed=!0;i.onFlowPanelRendered(this._iframeContainer)}};e.prototype._onDismiss=function(){var e=this.props.stateManager;e&&e.onDismiss()};i.__decorate([r.autobind],e.prototype,"_onDismiss",null);return e}(r.BaseComponent);t.default=n});define("GX",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-FlowPanel-contents{overflow:hidden;position:absolute;left:0;top:0;right:0;bottom:20px}.ms-FlowPanel-contents iframe{width:100%;height:100%;border:0}.ms-FlowPanel-center{position:absolute;transform:translate(-50%,-50%);left:50%;top:50%}.ms-FlowPanel-iframeContainer{height:100%;width:100%}.ms-FlowPanel-errorImage{display:block;margin:auto}.ms-FlowPanel--hidden{visibility:hidden}"}])});define("GU",["require","exports","ap","at","jP","GW","GV"],function(e,t,r,n,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._stateManager=new a.default(r.__assign({},e,{updateState:t.setState.bind(t)}));return t}e.prototype.componentDidMount=function(){this._stateManager.componentDidMount()};e.prototype.render=function(){return n.createElement(o.default,r.__assign({},this.state))};return e}(i.BaseComponent);t.FlowPanelContainer=s});define("GV",["require","exports","aC"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){(this._params=e).flowWidgetProvider.addListener(this);this._isWidgetRendered=!1;this._showError=!1;this._showWidget=!1;this._containerId=e.flowWidgetProvider.containerId}e.prototype.getRenderProps=function(){return{stateManager:this,isWidgetRendered:this._isWidgetRendered,showWidget:this._showWidget,showError:this._showError,containerId:this._containerId,errorImgUrl:this._params.errorImgUrl}};e.prototype.componentDidMount=function(){this._params.updateState(this.getRenderProps())};e.prototype.onFlowPanelRendered=function(t){this._params.widgetDataSignal.complete({iframePromise:new i.default(function(e){e(t)}),widgetStyleSettings:{backgroundColor:"white"}})};e.prototype.onDismiss=function(){if(this._showWidget){this._params.flowWidgetProvider.onDismiss();this._showWidget=!1;this._params.updateState(this.getRenderProps())}};e.prototype.onLaunchWidget=function(){this._updateWidgetVisibility(!0)};e.prototype.onWidgetError=function(e){if(!this._showError){this._showError=!0;this._params.updateState(this.getRenderProps())}};e.prototype.onWidgetRendered=function(){if(!this._isWidgetRendered){this._isWidgetRendered=!0;this._params.updateState(this.getRenderProps())}};e.prototype.onRunFlowCompleted=function(){this._updateWidgetVisibility(!1)};e.prototype.onRunFlowCanceled=function(){this._updateWidgetVisibility(!1)};e.prototype.onCloseWidget=function(){this._updateWidgetVisibility(!1)};e.prototype._updateWidgetVisibility=function(e){if(this._showWidget!==e){this._showWidget=e;this._params.updateState(this.getRenderProps())}};return e}();t.default=r});define("GO",["require","exports","ap","GP"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("GP",["require","exports","ap","jP","GQ","a0"],function(e,t,i,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this._params=e;this._pageContext=e.pageContext;this._params.listCreationPanelContainer.state={listUrl:void 0,errorMessage:null,isPanelOpen:!0}}e.prototype.componentDidMount=function(){var e=this._pageContext;this._spListCollectionDataSource=new n.SPListCollectionDataSource(e)};e.prototype.getRenderProps=function(){var e=this._params,t=e.listCreationPanelContainer.state,i={type:e.panelType,headerText:e.strings.panelHeaderText,isOpen:t.isPanelOpen,isLightDismiss:!0,closeButtonAriaLabel:e.strings.closeButtonAriaLabel},r={onCreateString:e.strings.onCreateString,onCreateAction:this._onCreateClick},n={onCancelString:e.strings.onCancelString,onCancelAction:this._onCancelClick};return{panelProps:i,listCreationPanelContentProps:{panelDescription:e.strings.panelDescription,nameFieldLabel:e.strings.nameFieldLabel,nameFieldPlaceHolder:e.strings.nameFieldPlaceHolder,descriptionFieldLabel:e.strings.descriptionFieldLabel,descriptionFieldPlaceHolder:e.strings.descriptionFieldPlaceHolder,errorMessage:t.errorMessage,spinnerString:e.strings.spinnerString,onCreate:r,onCancel:n,showInQuickLaunchDefault:e.showInQuickLaunchDefault,showInQuickLaunchString:e.strings.showInQuickLaunchString}}};e.prototype.setState=function(e){this._params.listCreationPanelContainer.setState(e)};e.prototype._onCreateClick=function(e,t,i,r){var n,o=this;s.Engagement.logData({name:"listCreationPanel.onCreate.Click"});n=i?1:0;var a={title:e,description:t,templateType:this._params.listTemplateType,quickLaunchOption:n};this._spListCollectionDataSource.createList(a).then(function(e){var t=e.defaultViewUrl;o._onSuccess(t,r)},function(e){var t=e.message.value;o.setState({errorMessage:t})});this._params.onCreateClick&&this._params.onCreateClick(r);r.stopPropagation();r.preventDefault()};e.prototype._onCancelClick=function(e){s.Engagement.logData({name:"listCreationPanel.onCancel.Click"});this.setState({isPanelOpen:!1});this._params.onCancelClick&&this._params.onCancelClick(e);e.stopPropagation();e.preventDefault()};e.prototype._onSuccess=function(e,t){this._params.onSuccess(t,e);t.stopPropagation();t.preventDefault()};i.__decorate([r.autobind],e.prototype,"_onCreateClick",null);i.__decorate([r.autobind],e.prototype,"_onCancelClick",null);i.__decorate([r.autobind],e.prototype,"_onSuccess",null);return e}();t.ListCreationPanelContainerStateManager=o;t.default=o});define("GH",["require","exports","ap","GK","GJ","GI"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);i.__exportStar(o,t)});define("GK",["require","exports","ap","Du","jP","GJ","GI","aI","GL","ey"],function(e,t,n,o,i,a,s,l,r,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e){var t=this;this._params=e;this._listDataSource=e.getListDataSource?e.getListDataSource():new r.ListDataSource(e.pageContext);this._listFieldsPromise=this._listDataSource.getFields(e.listFullUrl);this._getListFieldsError=null;this._listFields=null;this._listFieldsPromise.then(function(e){t._listFields=e},function(e){t._getListFieldsError=e});this._currencyListPromise=this._listDataSource.getCurrencyList();this._regionalDateTimeSchemaPromise=this._listDataSource.getRegionalDateTimeSchema();this._errorStrings=a.fillInColumnManagementPanelErrorStrings(e.errorStrings);this._originalName="";this._isEditPanel=!!e.editField;this._isDocumentLibrary=c.isDocumentLibrary(this._params.pageContext.listBaseTemplate);e.editField&&e.editField.fieldName?this._currentValuesPromise=this._listDataSource.getField(this._params.editField.fieldName,e.listFullUrl):this._currentValuesPromise=null;this._params.columnManagementPanelContainer.state={isPanelOpen:!0,duplicateColumnName:!1,savingColumn:!1,saveDisabled:!0,errorMessage:null,showPanel:!1,isContentLoading:!0,deleteDisabled:!1,confirmDeleteDialogIsOpen:!1,confirmSaveDialogIsOpen:!1,confirmSaveDialogText:""};this._loadTimer=setTimeout(function(){return t._showPanel()},250)}e.prototype.getRenderProps=function(){var e=this._params,t=e.columnManagementPanelContainer.state,i=a.fillInColumnManagementPanelStrings(e.strings),r=this._isEditPanel?null:e.createField.fieldType,n=this._isEditPanel?i.editPanelTitle:i.title;return{panelProps:{type:e.panelType?e.panelType:o.PanelType.smallFixedFar,isOpen:t.isPanelOpen,headerText:n,closeButtonAriaLabel:i.closeButtonAriaLabel,onDismiss:this._onDismiss,isLightDismiss:!0},columnManagementPanelContentProps:{pageContext:e.pageContext,strings:i,onClearError:this._onClearError,updateSaveDisabled:this._updateSaveDisabled,duplicateColumnName:t.duplicateColumnName,isEditPanel:this._isEditPanel,currentLanguage:e.pageContext.currentLanguage,currentLocale:e.pageContext.currentCultureLCID,updateParentStateWithCurrentValues:this._updateStateWithCurrentValues,currentValuesPromise:this._currentValuesPromise,currencyListPromise:this._currencyListPromise,regionalDateTimeSchemaPromise:this._regionalDateTimeSchemaPromise,fieldType:r,isHyperlink:e.isHyperlink,isDocumentLibrary:this._isDocumentLibrary,enableVersions:this._params.enableVersions},saveDisabled:t.saveDisabled,onDismiss:this._onDismiss,onSave:this._onSaveClick,errorMessage:t.errorMessage,isEditPanel:this._isEditPanel,showPanel:t.showPanel,isContentLoading:t.isContentLoading,deleteDisabled:t.deleteDisabled,confirmDeleteDialogIsOpen:t.confirmDeleteDialogIsOpen,showHideConfirmDeleteDialog:this._showHideConfirmDeleteDialog,confirmSaveDialogIsOpen:t.confirmSaveDialogIsOpen,showConfirmSaveDialog:this._showConfirmSaveDialog,hideConfirmSaveDialog:this._hideConfirmSaveDialog,confirmSaveDialogText:t.confirmSaveDialogText,onDelete:this._deleteColumn}};e.prototype.setState=function(e,t){this._params.columnManagementPanelContainer.setState(e,t&&t)};e.prototype._onDismiss=function(){if(this._params.columnManagementPanelContainer.state.isPanelOpen){clearTimeout(this._loadTimer);this.setState({isPanelOpen:!1},this._params.onDismiss)}};e.prototype._onSaveClick=function(e){var t=this._canSave(e);this.setState({saveDisabled:!0});if(t&&e.fieldData){var i=e.fieldData,r=i.fieldSchema,n=i.fieldOptions;this._isEditPanel?this._editColumn(r):this._createColumn(r,n)}};e.prototype._createColumn=function(t,e){var i=this,r=new l.Qos({name:"ColumnManagementPanel.CreateField"});this._listDataSource.createField(t,this._params.listFullUrl,e).then(function(e){i._handleColumnActionSuccess(r,t.DisplayName,e,"Create")},function(e){i._handleColumnActionErrorInPanel(r,e,"Create")})};e.prototype._editColumn=function(t){var i=this,r=new l.Qos({name:"ColumnManagementPanel.EditField"});this._listDataSource.editField(this._params.editField.fieldName,t,this._params.listFullUrl).then(function(e){i._handleColumnActionSuccess(r,t.DisplayName,i._params.editField.fieldName,"Edit")},function(e){i._handleColumnActionErrorInPanel(r,e,"Edit")})};e.prototype._deleteColumn=function(){var t=this;this.setState({deleteDisabled:!0});var i=new l.Qos({name:"ColumnManagementPanel.DeleteField"});this._listDataSource.deleteField(this._params.editField.fieldName,this._params.listFullUrl).then(function(e){t._handleColumnActionSuccess(i,t._originalName,t._params.editField.fieldName,"Delete")},function(e){t._handleColumnActionErrorExternal(i,t._originalName,"Delete",e)})};e.prototype._handleColumnActionSuccess=function(e,t,i,r){e.end({resultType:l.ResultTypeEnum.Success});this.setState({isPanelOpen:!1});this._params.onSuccess(t,i,r)};e.prototype._handleColumnActionErrorInPanel=function(e,t,i){e.end({resultType:l.ResultTypeEnum.Failure,error:t});var r=s.handleCreateEditColumnError(t,this._errorStrings,i);this.setState({errorMessage:r,confirmSaveDialogIsOpen:!1,saveDisabled:!1})};e.prototype._handleColumnActionErrorExternal=function(e,t,i,r){e.end(n.__assign({resultType:l.ResultTypeEnum.Failure},r&&{error:r}));this.setState({isPanelOpen:!1});this._params.onError(t,r,i)};e.prototype._updateSaveDisabled=function(e,t){var i=t&&Object.keys(t).some(function(e){return""===t[e]});!e||i?this.setState({saveDisabled:!0}):this.setState({saveDisabled:!1})};e.prototype._onClearError=function(){this.setState({duplicateColumnName:!1})};e.prototype._updateStateWithCurrentValues=function(e){this.setState({isContentLoading:!1});this._updateSaveDisabled(e.name,{choicesText:e.choicesText});this._originalName=e.name};e.prototype._showPanel=function(){this.setState({showPanel:!0})};e.prototype._showHideConfirmDeleteDialog=function(){this.setState(function(e){return{confirmDeleteDialogIsOpen:!e.confirmDeleteDialogIsOpen}})};e.prototype._showConfirmSaveDialog=function(e){this.setState({confirmSaveDialogIsOpen:!0,confirmSaveDialogText:e})};e.prototype._hideConfirmSaveDialog=function(){this.setState({confirmSaveDialogIsOpen:!1})};e.prototype._isColumnNameTaken=function(t,e){if(!e)return!1;t=t.toLocaleLowerCase();return e.some(function(e){return t===e.title.toLocaleLowerCase()})};e.prototype._canSave=function(e){var t=e.fieldData,i=e.error,r=this._isEditPanel?"Edit":"Create",n=!0;if(t){var o=t.fieldSchema,a=new l.Qos({name:"ColumnManagementPanel.VerifyColumnName"});if(o.DisplayName!==this._originalName&&this._isColumnNameTaken(o.DisplayName,this._listFields)){n=!1;a.end({resultType:l.ResultTypeEnum.ExpectedFailure,resultCode:"DuplicateColumnName"});this.setState({duplicateColumnName:!0,errorMessage:null})}else this._listFields||o.DisplayName===this._originalName?a.end({resultType:l.ResultTypeEnum.Success}):this._handleColumnActionErrorExternal(a,o.DisplayName,r,this._getListFieldsError)}else{var s=new l.Qos({name:"ColumnManagementPanel.VerifyColumnSaveHandler"});if(i){n=!1;this._handleColumnActionErrorInPanel(s,i,r)}else s.end({resultType:l.ResultTypeEnum.Success})}return n};n.__decorate([i.autobind],e.prototype,"_onDismiss",null);n.__decorate([i.autobind],e.prototype,"_onSaveClick",null);n.__decorate([i.autobind],e.prototype,"_createColumn",null);n.__decorate([i.autobind],e.prototype,"_editColumn",null);n.__decorate([i.autobind],e.prototype,"_deleteColumn",null);n.__decorate([i.autobind],e.prototype,"_handleColumnActionSuccess",null);n.__decorate([i.autobind],e.prototype,"_handleColumnActionErrorInPanel",null);n.__decorate([i.autobind],e.prototype,"_handleColumnActionErrorExternal",null);n.__decorate([i.autobind],e.prototype,"_updateSaveDisabled",null);n.__decorate([i.autobind],e.prototype,"_onClearError",null);n.__decorate([i.autobind],e.prototype,"_updateStateWithCurrentValues",null);n.__decorate([i.autobind],e.prototype,"_showPanel",null);n.__decorate([i.autobind],e.prototype,"_showHideConfirmDeleteDialog",null);n.__decorate([i.autobind],e.prototype,"_showConfirmSaveDialog",null);n.__decorate([i.autobind],e.prototype,"_hideConfirmSaveDialog",null);return e}();t.ColumnManagementPanelContainerStateManager=d});define("GJ",["require","exports","ap"],function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.MockColumnManagementPanelStrings={title:null,editPanelTitle:null,failureToLoadEditPanel:null,titleLearnMore:null,editPanelTitleLearnMore:null,nameLabel:null,duplicateColumnNameError:null,descriptionLabel:null,fieldTypeDropdownLabel:null,fieldTypeDropdownAriaLabel:null,choicesLabel:null,choicesPlaceholder:null,choicesAriaLabel:null,useCalculatedValue:null,useCalculatedValueTeachingBubble:null,defaultValueHeader:null,defaultFormulaPlaceholder:null,defaultFormulaAriaLabel:null,defaultValueDropdownAriaLabel:null,choiceDefaultValue:null,manuallyAddValuesCheckbox:null,allowSelectionOfGroupsCheckbox:null,infoButtonAriaLabel:null,infoButtonAriaLabelFormat:null,manuallyAddValuesTeachingBubble:null,moreOptionsButtonText:null,saveButtonText:null,cancelButtonText:null,deleteButtonText:null,allowMultipleSelectionToggle:null,requiredToggle:null,enforceUniqueValuesToggle:null,addToAllContentTypesToggle:null,unlimitedLengthInDocumentLibraryToggle:null,richTextToggle:null,currencyListItemDropdownLabel:null,currencyListDropdownAriaLabel:null,failureToLoadCurrencyList:null,appendOnlyToggle:null,appendOnlyNotValid:null,toggleOnText:null,toggleOffText:null,columnValidationButtonText:null,columnValidationGuideText:null,formulaLearnMoreLink:null,formulaLabel:null,userMessageGuideText:null,userMessageLabel:null,confirmDeleteDialogTitle:null,confirmDeleteDialogText:null,confirmSaveDialogTitle:null,switchTypeWarningFormat:null,multipleToSingleUserWarning:null,multipleToSingleChoiceWarning:null,richTextToPlainTextWarning:null,closeButtonAriaLabel:null,displayNameText:null,displayNameNote:null,displayNameNumber:null,displayNameBoolean:null,displayNameUser:null,displayNameChoice:null,displayNameHyperlink:null,displayNamePicture:null,displayNameCurrency:null,displayNameDateTime:null,decimalPlacesDropdownLabel:null,decimalPlacesDropdownAriaLabel:null,decimalPlacesAutomatic:null,showAsPercentageCheckbox:null,enterNumberPlaceholder:null,defaultNumberAriaLabel:null,defaultNumberNotValid:null,minimumValueLabel:null,minimumValueAriaLabel:null,minimumValueNotValid:null,minimumLargerThanMaximum:null,maximumValueLabel:null,maximumValueAriaLabel:null,maximumValueNotValid:null,numberOfLinesLabel:null,numberOfLinesAriaLabel:null,numberOfLinesNotValid:null,maximumLengthLabel:null,maximumLengthNotValid:null,defaultValuePlaceholder:null,defaultValueAriaLabel:null};r.MockColumnManagementPanelErrorStrings={formulaSyntaxError:null,formulaInvalidColumnName:null,formulaColumnNameIneligible:null,formulaSelfReference:null,formulaEmptyError:null,validationFormulaInvalidColumnName:null,referenceToFieldFound:null,referenceToSemiValueFound:null,columnIsBeingIndexed:null,largeListError:null,genericCreateColumnError:null,genericEditColumnError:null};r.fillInColumnManagementPanelStrings=function(e){var t=n.__assign({},r.MockColumnManagementPanelStrings);for(var i in r.MockColumnManagementPanelStrings)t[i]=e[i]?e[i]:i;return t};r.fillInColumnManagementPanelErrorStrings=function(e){var t=n.__assign({},r.MockColumnManagementPanelErrorStrings);for(var i in r.MockColumnManagementPanelErrorStrings)t[i]=e[i]?e[i]:i;return t}});define("GI",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=-2130575270,o=-2130575273,a=-2130575272,s=-2130575271,l=-2130575199,c=-2130575296,d=-2130575160,u=-2130575295,p=-2130246331,m=-2147024860,h=-2147024809,f=-2147467261;function i(e,t,i){var r;switch(e&&e.code&&Number(e.code.split(",")[0])){case n:r=t.formulaSyntaxError;break;case o:r=t.formulaInvalidColumnName;break;case a:r=t.formulaColumnNameIneligible;break;case s:r=t.formulaSelfReference;break;case l:r=t.formulaEmptyError;break;case d:r=t.validationFormulaInvalidColumnName;break;case c:r=t.referenceToFieldFound;break;case u:r=t.referenceToSemiValueFound;break;case p:r=t.columnIsBeingIndexed;break;case m:r=t.largeListError;break;case h:case f:default:r="Edit"===i?t.genericEditColumnError:t.genericCreateColumnError}return r}t.handleCreateEditColumnError=i;t.default=i});define("GB",["require","exports","ap","at","wd","GE","wL","GD","a0","GC"],function(e,t,d,u,p,m,h,f,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){d.__extends(e,i);function e(e,t){return i.call(this,e,t)||this}e.prototype.render=function(){var t=[],e=this.props,i=e.title,n=e.links,r=e.siteLogo,o=e.membersInfoProps,a=e.enableJoinLeaveGroup,s=!!(o&&o.onJoin&&o.onJoin.onJoinString);if(n)for(var l=function(e){var r=n[e];t.push({key:e.toString(),name:r.title,icon:r.icon,onClick:function(e,t){var i=r.engagementId||"GroupCard.Unknown.Click";g.Engagement.logData({name:i});window.open(r.href,"_blank")}})},c=0;c<n.length;c++)l(c);return u.createElement("div",{className:"ms-groupCard","data-automationid":"GroupCard"},u.createElement("div",{className:"ms-groupCard-top"},u.createElement("div",{className:"ms-groupCard-body"},u.createElement("div",{className:"ms-groupCard-title"},i),o&&u.createElement(h.MembersInfo,d.__assign({},o,{enableJoinLeaveGroup:a})),a&&s&&u.createElement("div",{className:"ms-groupCard-joinbutton"},u.createElement(f.MembersInfoJoinButton,d.__assign({},o)))),u.createElement("div",{className:"ms-groupCard-logo"},u.createElement(p.GroupSiteLogo,d.__assign({},r)))),u.createElement("div",{className:"ms-groupCard-iconGroup"},u.createElement(m.CommandBar,{items:t,className:"ms-groupCard-CmdBar"})))};return e}(u.Component);t.GroupCard=i});define("GD",["require","exports","ap","at","wN","jP","o1","mo","wM"],function(e,t,r,o,a,n,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c;!function(e){e[e.joined=0]="joined";e[e.joining=1]="joining";e[e.unjoin=2]="unjoin";e[e.joinLeaveError=3]="joinLeaveError";e[e.leaving=4]="leaving"}(c=t.membersInfoJoinStatus||(t.membersInfoJoinStatus={}));var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state=t.GetInitialState();return t}e.prototype.GetInitialState=function(){return{joinStatus:this._getJoinStatus(this.props)}};e.prototype.componentWillReceiveProps=function(e){var t=this._getJoinStatus(e);this.setState({joinStatus:t})};e.prototype.render=function(){var e=this.props,t=e.onJoin,i=e.joinLeaveError,r=e.onLeaveGroup,n=this.state.joinStatus;return n===c.unjoin?o.createElement(a.PrimaryButton,{className:"ms-membersInfo-joinButton",onClick:this._onJoinClick,"data-automationid":"JoinButton"},t.onJoinString):n===c.joining?o.createElement("span",{className:"ms-membersInfo-joinButton--joining"},o.createElement(s.Spinner,{className:"ms-membersInfo-joinButton-spinner",label:t.onJoiningString})):n===c.leaving?o.createElement("span",{className:"ms-membersInfo-joinButton--leaving"},o.createElement(s.Spinner,{className:"ms-membersInfo-joinButton-spinner",label:r.onLeavingGroupString})):n===c.joinLeaveError?o.createElement("span",{className:"ms-membersInfo-joinButton--joinLeaveError"},o.createElement("span",{className:"ms-membersInfo-joinButton--joinLeaveErrorText"},i),o.createElement(l.Icon,{iconName:"Cancel",className:"ms-membersInfo-joinButton--dismiss",onClick:this._onErrorDismissClick})):null};e.prototype._onJoinClick=function(e){this.setState({joinStatus:c.joining});if(this.props.onJoin.onJoinAction){this.props.onJoin.onJoinAction(e);e.stopPropagation();e.preventDefault()}};e.prototype._onErrorDismissClick=function(e){this.props.isMemberOfCurrentGroup?this.setState({joinStatus:c.joined}):this.setState({joinStatus:c.unjoin});if(this.props.onErrorDismissClick){this.props.onErrorDismissClick(e);e.stopPropagation();e.preventDefault()}};e.prototype._getJoinStatus=function(e){return e.isMemberOfCurrentGroup&&e.isLeavingGroup?c.leaving:e.joinLeaveError?c.joinLeaveError:e.isMemberOfCurrentGroup?c.joined:c.unjoin};r.__decorate([n.autobind],e.prototype,"_onJoinClick",null);r.__decorate([n.autobind],e.prototype,"_onErrorDismissClick",null);return e}(n.BaseComponent);t.MembersInfoJoinButton=i});define("GC",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-groupCard{width:345px;padding-left:20px;padding-right:20px;padding-top:10px}.ms-groupCard-top{display:-ms-flexbox;display:flex;padding-bottom:40px}.ms-groupCard-body{display:inline-block;-ms-flex-positive:1;flex-grow:1;overflow:hidden}[dir=ltr] .ms-groupCard-body{padding-left:6px}[dir=rtl] .ms-groupCard-body{padding-right:6px}.ms-groupCard-title{font-size:21px;font-weight:100;vertical-align:top;overflow:hidden}.ms-groupCard-logo{-ms-flex-negative:0;flex-shrink:0;display:inline-block}[dir=ltr] .ms-groupCard-logo{margin-left:10px}[dir=rtl] .ms-groupCard-logo{margin-right:10px}.ms-groupCard-icon{font-size:28px;font-weight:100;padding:4px}.ms-groupCard-iconGroup{border-top:1px solid #eaeaea}.ms-CommandBar.ms-groupCard-CmdBar{background-color:transparent}.ms-groupCard-joinbutton{margin-top:20px}.ms-groupCard-iconGroup .ms-CommandBar-primaryCommands{margin:0}.ms-ContextualMenu.ms-FocusZone{position:relative;box-shadow:none;border:none}.ms-ContextualMenu.ms-FocusZone .ms-ContextualMenu-link{height:36px}"}])});define("Gv",["require","exports","ap","at","jP","Gw"],function(e,t,i,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){i.__extends(n,r);function n(e,t){var i=r.call(this,e,t)||this;i.state={lpcCallbacks:n.makeSpLpcCallbacks(i.props.addGroupMembersCallback)};return i}n.prototype.render=function(){return o.createElement(s.LivePersonaCardAdapter,{personaType:this.props.personaType,email:this.props.identifier,pageContext:this.props.pageContext,dataAutomationId:this.props.dataAutomationId,lpcCallbacks:this.state.lpcCallbacks},this.props.children)};n.makeSpLpcCallbacks=function(e){return{getAndPrefetchPersonaImageUri:function(e,t){"User"===e.PersonaType&&e.Smtp?t("/_layouts/15/userphoto.aspx?size=L&accountname="+e.Smtp):"Group"===e.PersonaType&&t();t()},addGroupMembers:e}};i.__decorate([a.autobind],n.prototype,"render",null);return n}(a.BaseComponent);t.SpLivePersonaCard=r});define("Gc",["require","exports","ap","Gd","Gd"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.default=n.HubNav});define("Gd",["require","exports","ap","Gm","Gf","Ge"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t);t.HubNavResx=o.default});define("Gm",["require","exports","ap","at","Gf","Gg","Gp","Go","bT","V","jP","Ge","Gn"],function(e,t,r,p,m,a,h,n,s,f,o,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={hubData:void 0,navLinkGroup:void 0,logoLoadError:void 0,editLink:void 0},i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={};t._initialProps=e;return t}e.prototype.componentWillMount=function(){var e=this._initialProps;if(e){this._initMembers(e);this._init(e);this._initialProps=void 0}};e.prototype.componentWillReceiveProps=function(e){var t=this._pageContext,i=e.pageContext,r=t.siteId!==i.siteId;if(t.webId!==i.webId||r){this._initMembers(e);var n=t.hubSiteId!==i.hubSiteId,o=t.isHubSite!==i.isHubSite,a=!r&&o,s=this.state.navLinkGroup,l=!1;if(n||this._dataPromise||!this.state.hubData){this._dataPromise&&this._dataPromise.cancel();this._init(e)}else if(a)l=!0;else if(r){s=this._getHubGroup(this.state.hubData);this.setState({navLinkGroup:s});l=!0}if(l){var c=m.canEditHubNav(i);s.hasEditLink=c;this.setState({editLink:c?this._getEditLink(s):void 0})}}};e.prototype.render=function(){var e,t,i=this.state,r=i.hubData,n=i.logoLoadError,o=i.navLinkGroup,a=i.editLink,s=this.props;m.logHubRender(s.pageContext);var l="";if(r){var c=r.name,d=r.logoUrl,u=r.url;l=c;e=p.createElement("a",{className:"ms-HubNav-nameLink ms-HubNav-link",href:u},d&&!n?p.createElement("img",{className:"ms-HubNav-logo",src:d,onClick:this._onLogoClick,onError:this._onLogoError,alt:g.default.logoAriaLabel,role:"presentation"}):void 0,p.createElement("span",{onClick:this._onNameClick},c||""));t=p.createElement(h.HorizontalNav,{items:o.links,editLink:a,skipRole:!0,moduleLoader:s.moduleLoader})}return p.createElement("div",{className:"ms-HubNav",role:"navigation","aria-label":f.format(g.default.ariaLabel,l)},e,t)};e.prototype._initMembers=function(e){this._dataSource=e.getDataSource&&e.getDataSource()||e.dataSource||new n.HubDataSource(e.pageContext);this._pageContext=e.pageContext};e.prototype._init=function(e){var i=this;this._dataPromise=this._dataSource.getHubData(!0);this._dataPromise.then(function(e){i._dataPromise=null;try{if(e){m.trySyncTheme(e,i._dataSource,i._pageContext);m.addClickHandlers(e,i._pageContext);var t=i._getHubGroup(e);i.setState({hubData:e,navLinkGroup:t,editLink:i._getEditLink(t),logoLoadError:!1})}}catch(e){i.setState(r.__assign({},l))}},function(){return i.setState(r.__assign({},l))})};e.prototype._getHubGroup=function(e,t){t=t||e.navigation;return m.getHubGroup(e,this._dataSource,this._pageContext,t)};e.prototype._getEditLink=function(e){if(e.hasEditLink){var t=e.links&&e.links.length?void 0:g.default.addLinkLabel;return a.getEditLink(this._pageContext,!1,this._onEditClicked,t)}};e.prototype._onEditClicked=function(e){var n=this,o=this.state,t={group:o.navLinkGroup,updateDisplayedLinks:function(e,t){var i=n._getHubGroup(o.hubData,e),r=n._getEditLink(i);n.setState({navLinkGroup:i,editLink:r},t)}};s.default.raise(window,a.EDIT_EVENT_NAME,t)};e.prototype._onNameClick=function(){var e=this._pageContext;m.logHubEvent("Name.Click",e);m.logHubEvent("Click",e)};e.prototype._onLogoClick=function(){var e=this._pageContext;m.logHubEvent("Logo.Click",e);m.logHubEvent("Click",e)};e.prototype._onLogoError=function(){this.setState({logoLoadError:!0})};r.__decorate([o.autobind],e.prototype,"_onEditClicked",null);r.__decorate([o.autobind],e.prototype,"_onNameClick",null);r.__decorate([o.autobind],e.prototype,"_onLogoClick",null);r.__decorate([o.autobind],e.prototype,"_onLogoError",null);return e}(o.BaseComponent);t.HubNav=i;t.default=i});define("Gf",["require","exports","ap","cY","a0","Gg"],function(e,n,a,t,o,s){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.logPrefix="HubNav";function l(e,t,i,r){void 0===r&&(r=!0);o.Engagement.logData({name:n.logPrefix+"."+e,isIntentional:r,extraData:{hubSiteId:t&&t.hubSiteId,isHubSite:t&&t.isHubSite,siteId:t&&t.siteId,responsiveMode:!!i}})}n.logHubEvent=l;var i;n.logHubRender=function(e,t){if(e.siteId!==i){l("Rendered",e,t,!1);i=e.siteId}};function c(e,i,r){if(e&&e.navigation){var n=function(e,t){return e.map(function(e){return a.__assign({},e,{forceAnchor:!0,onClick:function(){l("LinkLevel"+t+".Click",i,r);l("Link.Click",i,r);l("Click",i,r)},links:e.links&&n(e.links,t+1)})})};e.navigation=n(e.navigation,1)}}n.addClickHandlers=c;n.getHubGroup=function(t,e,i,r,n){var o=r||t.navigation||[];c(t,i,n);return{name:t.name,collapseByDefault:!0,links:o,key:"HubNav",onHeaderClick:function(e,t){l((t?"Collapse":"Expand")+"Group.Click",i,!0,n)},onSaved:function(){e.getHubData(!0,!0)},getNewLinks:function(){return e.getHubData(t.usesMetadataNavigation,!0).then(function(e){return e.navigation})},hasEditLink:d(i),onEditClicked:function(){t.usesMetadataNavigation&&e.getHubData(!0,!0).then(function(){var e=s.getEditLink(i,!1,void 0);window.location.href=e.url})},augmentLinks:function(e){c(a.__assign({},t,{navigation:e}),i,n)}}};function d(e){return e.isHubSite&&t.PermissionMask.hasPermission(e.webPermMasks,t.PermissionMask.manageLists)}n.canEditHubNav=d;n.trySyncTheme=function(e,t,i){var r,n=i.themedCssFolderUrl;if(n){var o=n.split("/");r=o[o.length-1]}if(e.themeKey&&e.themeKey!==r){t.syncHubSiteTheme();l("SyncHubSiteTheme",i,!1)}}});define("Gg",["require","exports","ap","Gi","Gh"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.NavResx=n.default});define("Gi",["require","exports","Gj","Gh"],function(e,t,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EDIT_EVENT_NAME="EditLinkGroup";t.UPDATE_LINKS_EVENT_NAME="UpdateDisplayedLinks";!function(e){e.quickLaunch="QuickLaunch";e.globalNav="GlobalNav";e.hubNav="HubNav"}(t.LinkGroupKey||(t.LinkGroupKey={}));t.getEditLink=function(e,t,i,r){var n=e.PublishingFeatureOn?o.ViewNavDataSource.getAreaNavigationSettingsUrl(e):void 0;return{name:r||a.default.EditButtonLabel,url:n,onClick:i,icon:t?"Edit":void 0,key:"-999"}}});define("Gj",["require","exports","ap","Gl","Gk"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.NavNodeKeys=n.NavNodeKeys;t.NavigationProvider=n.NavigationProvider});define("Gp",["require","exports","ap","Gr","Gq"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);t.HorizontalNavResx=n.default});define("Gr",["require","exports","jP","Gu","Gs"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HorizontalNav=i.styled(n.HorizontalNavBase,r.getStyles)});define("Gu",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t=e.theme.palette;return{root:"ms-HorizontalNav",link:{color:t.neutralSecondary,selectors:{":hover":{color:t.themePrimary}}},linkSelected:{color:t.neutralPrimary,borderBottom:"2px solid "+t.themePrimary},splitButton:{selectors:{":hover":{color:t.themePrimary}}},chevron:{color:t.neutralSecondary},editButton:["ms-HorizontalNavItem-Edit",{border:"none",color:t.themePrimary,selectors:{":hover":{color:t.themeDarker}}}]}}});define("Gs",["require","exports","ap","at","aC","o7","jP","l4","Gj","mo","c","bf","Gq","jP","Gt"],function(n,e,o,l,a,c,s,d,u,p,m,h,f,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var g,i,b=t.classNamesFunction(),_=0,v="overflow";function y(e,t){void 0===i&&(i=!h.Killswitch.isActivated("083DAF4F-6FCA-4455-983A-FE6E665CB657","1/30/2018","Use string keys for horizontal nav items"));return i?e.key+e.name+e.url:String(t)}var r=function(r){o.__extends(e,r);function e(e,t){var i=r.call(this,e,t)||this;i._horizontalNavItemsRef={};i._boundItemClick={};i._boundMainItemHover={};i._instanceIdPrefix="HorizontalNav-"+_+++"-";i.state=i._getStateFromProps(i.props);i._editLinkWidth=-1;i._resolvedElement=function(t){return function(e){return i._horizontalNavItemsRef[t]=e}};i._newAnchorHandling=!h.Killswitch.isActivated("234320C6-FAE7-4991-8C47-E739916D85F0","1/16/2018","Respect click handlers on anchor-type links");m.flush();return i}e.prototype.componentDidMount=function(){this._updateItemMeasurements();this._updateRenderedItems();this._events.on(window,"resize",this._updateRenderedItems)};e.prototype.componentWillReceiveProps=function(e){this.setState(this._getStateFromProps(e));this._navItemWidths=null};e.prototype.componentDidUpdate=function(e,t){if(!this._navItemWidths&&!this.state.isEditMode){this._updateItemMeasurements();this._updateRenderedItems()}};e.prototype.render=function(){var e=this.props,t=e.getStyles,i=e.theme,r=e.useMegaMenu;this._classNames=b(t,{theme:i});var n=this.state,o=n.contextMenuItems;if(n.isEditMode)return l.createElement("div",null);var a=void 0;o&&(a=r?this._getDefferredMenu(this._getMegaMenuProps(o),"@ms/odsp-shared-react/lib/components/MegaMenu/MegaMenuCallout"):this._getDefferredMenu(this._getContextualMenuProps(o),"wt"));var s=this.props.skipRole?void 0:"navigation";return l.createElement("div",{className:this._classNames.root,ref:this._resolveRef("_horizontalNavRegion"),role:s},l.createElement(c.FocusZone,{direction:c.FocusZoneDirection.horizontal,"aria-label":this.props.ariaLabel||f.default.ariaLabel},l.createElement("div",{className:"ms-HorizontalNavItems",role:"menubar"},this._renderHorizontalNavItems(a),this._renderOverflow(),this._renderEditLink())),!r&&o&&a)};e.prototype._getDefferredMenu=function(e,t){var i=this,r={modulePath:t,getModule:function(){return new a.default(function(e,t){i.props.useMegaMenu?n(["../MegaMenu/MegaMenuCallout"],e):n(["wt"],e)})},moduleLoader:this.props.moduleLoader,waitPLT:!1,props:e};return l.createElement(d.ReactDeferredComponent,o.__assign({},r))};e.prototype._getContextualMenuProps=function(e){this.props.moduleLoader&&(this.props.moduleLoader.parse=function(e){return e.wt&&e.wt.ContextualMenu});return{className:"ms-HorizontalNav",labelElementId:this._instanceIdPrefix+v,items:this._getContextualItemProps(e),target:this.state.contextMenuRef,onDismiss:this._onNavMenuDismiss,gapSpace:8,isBeakVisible:!1,directionalHint:4,shouldFocusOnMount:!0}};e.prototype._getMegaMenuProps=function(e){var t=this,i="@ms/odsp-shared-react/lib/components/MegaMenu/MegaMenuCallout";this.props.moduleLoader&&(this.props.moduleLoader.parse=function(e){return e[i]&&e[i].MegaMenuCallout});return{layoutProps:{maxColumnCount:4,showDivider:!0},onDismiss:this._onNavMenuDismiss,target:this.state.contextMenuRef,sections:e.map(function(e){return{heading:e.name,items:e.links&&t._getContextualItemProps(e.links),theme:t.props.theme}})}};e.prototype.measureLayout=function(){this._updateRenderedItems()};e.prototype._getContextualItemProps=function(e){var a=this;return e.filter(function(e){return"1033"!==e.key}).map(function(i,e){var t,r,n=y(i,e),o=a._hasSublinks(i);o?t=i.url?function(){return location.href=i.url}:i.onClick?function(e,t){return i.onClick(e,i)}:null:r=i.onClick?function(e,t){return i.onClick(e,i)}:null;return{key:n,name:i.name,href:o?null:i.url,items:o?i.links.filter(function(e){return"1033"!==e.key}).map(function(i,e){return{key:y(i,e),name:i.name,href:i.url,onClick:i.onClick?function(e,t){i.onClick(e,i)}:null}}):void 0,onMouseDown:t,onClick:r}})};e.prototype._renderHorizontalNavItems=function(n){var o=this,e=this.state.renderedItems;if(e&&0!==e.length)return e.map(function(e,t){var i=y(e,t),r=o._boundMainItemHover[i]||o._onMainItemHover.bind(o,e);return l.createElement("span",{className:"ms-HorizontalNavItem",key:i,ref:o._resolvedElement(i),role:"menuitem"},o._shouldRenderAsAnchor(e)?o._renderAnchorLink(e,i,r):o._renderButtonLink(e,i,r),o._hasSublinks(e)?l.createElement("button",{className:s.css("ms-HorizontalNavItem-splitbutton",o._classNames.splitButton),onClick:o._boundItemClick[i]||o._onItemClick.bind(o,e),onMouseEnter:r,onMouseLeave:o._onMouseLeave,"aria-label":o.props.splitButtonAriaLabel||f.default.splitButtonAriaLabel,"aria-haspopup":o._hasSublinks(e),onKeyDown:o._handleKeyPress.bind(o,e)},l.createElement(p.Icon,{iconName:"ChevronDown",className:s.css("ms-HorizontalNav-chevronDown",o._classNames.chevron)})):null,o.props.useMegaMenu&&o.state.contextMenuItems===e.links&&n&&n)})};e.prototype._renderAnchorLink=function(e,t,i){var r=!!this.props.hasSelectedState&&this._isLinkSelected(e);return l.createElement("a",{className:s.css("ms-HorizontalNavItem-link",{"is-selected":r},this._classNames.link,r&&this._classNames.linkSelected),href:e.url,title:e.title||e.name,"aria-label":e.ariaLabel,onMouseEnter:i,onMouseLeave:this._onMouseLeave,onKeyDown:this._handleKeyPress.bind(this,e),onClick:this._newAnchorHandling&&e.onClick?this._boundItemClick[t]:void 0,"aria-haspopup":this._hasSublinks(e),role:"menuitem",target:u.ViewNavDataSource.isRelativeUrl(e.url)?"_self":"_blank",rel:"noopener"},e.name)};e.prototype._hasSublinks=function(e){return!!(e&&e.links&&e.links.length)};e.prototype._shouldRenderAsAnchor=function(e){return!!(e.url||this._newAnchorHandling&&e.forceAnchor)};e.prototype._renderButtonLink=function(e,t,i){var r=!!this.props.hasSelectedState&&this._isLinkSelected(e);return l.createElement("button",{className:s.css("ms-HorizontalNavItem-link",{"is-selected":r},this._classNames.link,r&&this._classNames.linkSelected),title:e.title||e.name,"aria-label":e.ariaLabel,onClick:this._boundItemClick[t]||this._onItemClick.bind(this,e),onMouseEnter:i,onMouseLeave:this._onMouseLeave,onKeyDown:this._handleKeyPress.bind(this,e),"aria-haspopup":this._hasSublinks(e),role:"menuitem"},e.name)};e.prototype._renderOverflow=function(){var e=this.state.overflowItems;return e&&e.length?l.createElement("div",{className:"ms-HorizontalNavItem",key:v,ref:this._resolveRef("_overflowElementRef"),"data-automationid":"HorizontalNav-overflow"},l.createElement("button",{id:this._instanceIdPrefix+v,className:s.css("ms-HorizontalNavItem-link",this._classNames.link),onClick:this._onOverflowClick,"aria-haspopup":!0,onKeyDown:this._handleKeyPress.bind(this,v),role:"menuitem"},l.createElement(p.Icon,{iconName:"More",className:"ms-HorizontalNavItem-overflow"}))):null};e.prototype._renderEditLink=function(){var e=this.props,t=e.editLink,i=e.isEditMode;return t&&!i?l.createElement("div",{className:"ms-HorizontalNavItem",ref:this._resolveRef("_editLinkElementRef"),"data-automationid":"HorizontalNav-edit"},l.createElement("button",{id:this._instanceIdPrefix+"EditLink",className:s.css("ms-HorizontalNavItem-link",this._classNames.link,this._classNames.editButton),onClick:this._onEditClick},t.name)):null};e.prototype._updateItemMeasurements=function(){this._currentOverflowWidth=this._overflowElementRef||this.props.overflowItems&&this.props.overflowItems.length?32.67:0;-1===this._editLinkWidth&&this.props.editLink&&this._editLinkElementRef&&(this._editLinkWidth=this._getElementWidth(this._editLinkElementRef));this._navItemWidths||(this._navItemWidths={});for(var e=this.props.items,t=0;t<e.length;t++){var i=y(e[t],t);this._navItemWidths[i]||(this._navItemWidths[i]=this._getElementWidth(this._horizontalNavItemsRef[i]))}};e.prototype._getElementWidth=function(e){var t=s.getRTL();return e?e.getBoundingClientRect().width+parseInt(t?window.getComputedStyle(e).marginLeft:window.getComputedStyle(e).marginRight,10):0};e.prototype._updateRenderedItems=function(){for(var e=this.props.items.slice(),t=this._horizontalNavRegion.clientWidth-this._currentOverflowWidth-this._editLinkWidth,i=this.props.overflowItems||[],r=0,n=0;n<e.length;n++){var o=y(e[n],n),a=this._navItemWidths[o];if(t<=r+a){0<n&&0===i.length&&t-r<32.67&&n--;i=e.splice(n).concat(i);break}r+=a}this.setState({renderedItems:e,overflowItems:i})};e.prototype._onOverflowClick=function(e){if(this.state.contextMenuItems||this.state.lastTriggeringItem===v){this._onNavMenuDismiss();this.setState({lastTriggeringItem:null})}else this.setState({contextMenuItems:this.state.overflowItems,contextMenuRef:e.currentTarget,lastTriggeringItem:v})};e.prototype._onEditClick=function(e){this.props.editLink.onClick(e);this.setState({isEditMode:!1})};e.prototype._onAnchorClick=function(e,t){e.onClick&&e.onClick(t,e)};e.prototype._onItemClick=function(e,t){this._navItemHoverTimerId&&this._async.clearTimeout(this._navItemHoverTimerId);t.stopPropagation();t.preventDefault();if(this.state.contextMenuItems||this.state.lastTriggeringItem===e){this.setState({lastTriggeringItem:null});this._onNavMenuDismiss()}else"I"!==t.target.tagName?e.onClick?e.onClick(t,e):e.url&&window.open(e.url,u.ViewNavDataSource.isRelativeUrl(e.url)?"_self":"_blank"):this.setState({contextMenuItems:e.links,contextMenuRef:t.currentTarget,lastTriggeringItem:e})};e.prototype._onMainItemHover=function(e,t){var i=this;e.url&&(window.status=e.url);t.stopPropagation();t.preventDefault();var r=t.currentTarget;this._hasSublinks(e)&&(this._navItemHoverTimerId=this._async.setTimeout(function(){if(i.state.contextMenuItems!==e.links){i.state.contextMenuItems&&i._onNavMenuDismiss();i._openSubMenu(e.links,r,e)}},250))};e.prototype._onMouseLeave=function(){this._async.clearTimeout(this._navItemHoverTimerId)};e.prototype._handleKeyPress=function(e,t){if(32===t.which||40===t.which||13===t.which&&t.target&&"ms-HorizontalNavItem-splitbutton"===t.target.className){t.stopPropagation();t.preventDefault();e===v?this._openSubMenu(this.state.overflowItems,t.target,e):this._openSubMenu(e.links,t.target,e)}};e.prototype._openSubMenu=function(e,t,i){if("ms-HorizontalNavItem-splitbutton"===t.className||"i"===t.tagName&&i!==v){for(var r=t;r&&"span"!==r.tagName.toLowerCase();)r=r.parentElement;r&&r.children&&0<r.children.length&&(t=r.children[0])}this.setState({lastTriggeringItem:i,contextMenuItems:e,contextMenuRef:t})};e.prototype._onNavMenuDismiss=function(e){if(e&&e.relatedTarget&&this._horizontalNavRegion.contains(e.relatedTarget)){e.stopPropagation();e.preventDefault()}else this.setState({contextMenuItems:null})};e.prototype._getStateFromProps=function(e){var t=e.items,i=e.overflowItems,r=e.isEditMode;this._boundItemClick={};this._boundMainItemHover={};for(var n=0;n<t.length;n++){var o=t[n],a=y(o,n);this._boundItemClick[a]=this._shouldRenderAsAnchor(o)?this._onAnchorClick.bind(this,o):this._onItemClick.bind(this,o);this._boundMainItemHover[a]=this._onMainItemHover.bind(this,o)}return{renderedItems:t,overflowItems:i||[],contextMenuItems:null,isEditMode:r,selectedKey:void 0}};e.prototype._isLinkSelected=function(e){if(void 0!==this.props.selectedKey)return e.key===this.props.selectedKey;if(void 0!==this.state.selectedKey&&e.key===this.state.selectedKey)return!0;if("undefined"==typeof window)return!1;if(!e.url)return!1;(g=g||document.createElement("a")).href=e.url||"";var t=g.href,i=t+"/SitePages/Home.aspx";if(location.href===t||location.href===i)return!0;var r=location.protocol+"//"+location.host+location.pathname;if(r===t||r===i)return!0;if(location.hash){if(location.hash===e.url)return!0;g.href=location.hash.substring(1);return g.href===t}return!1};o.__decorate([s.autobind],e.prototype,"_onOverflowClick",null);o.__decorate([s.autobind],e.prototype,"_onEditClick",null);o.__decorate([s.autobind],e.prototype,"_onMouseLeave",null);o.__decorate([s.autobind],e.prototype,"_onNavMenuDismiss",null);return e=o.__decorate([t.customizable("HorizontalNav",["theme"])],e)}(s.BaseComponent);e.HorizontalNavBase=r});define("Gt",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-HorizontalNav{white-space:nowrap}.ms-HorizontalNavItem{display:inline-block}[dir=ltr] .ms-HorizontalNavItem:not(:last-child){margin-right:28px}[dir=rtl] .ms-HorizontalNavItem:not(:last-child){margin-left:28px}.ms-HorizontalNavItem-link{background:0 0;cursor:pointer;min-width:20px;text-align:center;margin:0;padding:0;display:inline-block;height:100%;box-sizing:border-box;text-decoration:none;font-size:12px;font-weight:400}.ms-Fabric .ms-HorizontalNavItem-link:focus::-moz-focus-inner{border:0}.ms-Fabric .ms-HorizontalNavItem-link:focus{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .ms-HorizontalNavItem-link:focus:focus:after{content:'';position:absolute;top:1px;right:1px;bottom:1px;left:1px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .ms-HorizontalNavItem-link:focus:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .ms-HorizontalNavItem-link:focus:focus:after{border-color:#37006e}}.ms-HorizontalNavItem-link.is-selected{padding-bottom:6px}.ms-HorizontalNavItem-splitbutton{padding:0;background:0 0;border-style:none}.ms-Fabric .ms-HorizontalNavItem-splitbutton:focus::-moz-focus-inner{border:0}.ms-Fabric .ms-HorizontalNavItem-splitbutton:focus{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .ms-HorizontalNavItem-splitbutton:focus:focus:after{content:'';position:absolute;top:1px;right:1px;bottom:1px;left:1px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .ms-HorizontalNavItem-splitbutton:focus:focus:after{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .ms-HorizontalNavItem-splitbutton:focus:focus:after{border-color:#37006e}}.ms-HorizontalNav-chevronDown{display:inline;vertical-align:middle;line-height:11px}[dir=ltr] .ms-HorizontalNav-chevronDown{margin-left:8px}[dir=rtl] .ms-HorizontalNav-chevronDown{margin-right:8px}.ms-HorizontalNavItem-overflow{line-height:17px;vertical-align:middle}.ms-HorizontalNav .ms-ContextualMenu-itemText{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});define("Gn",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ms-HubNav{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;box-sizing:border-box;height:40px;padding:8px 32px;line-height:24px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ms-HubNav .ms-HorizontalNavItem-link{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.ms-HubNav .ms-HorizontalNavItem-link.ms-HorizontalNavItem-Edit{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-HubNav .ms-HorizontalNav{-ms-flex:1 1 auto;flex:1 1 auto;min-width:0}.ms-HubNav .ms-HorizontalNav .ms-ContextualMenu-itemText{font-size:12px;font-weight:400}.ms-HubNav-link{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;min-width:0;font-size:14px;font-weight:400;font-weight:600;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";text-decoration:none;white-space:nowrap}[dir=ltr] .ms-HubNav-link{margin-right:20px}[dir=rtl] .ms-HubNav-link{margin-left:20px}.ms-HubNav-logo{height:24px}html[dir=ltr] .ms-HubNav-logo{margin-right:8px}html[dir=rtl] .ms-HubNav-logo{margin-left:8px}"}])});define("FU",["require","exports","ap","at","FZ","FX","FV"],function(e,t,r,n,o,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;e&&(t._pageContext=e.pageContext);return t}e.prototype.componentWillMount=function(){this._siteAnalyticsDataSource=new a.SiteAnalyticsDataSource(this._pageContext);var e=new Date;e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));var t=new Date;t.setDate(t.getDate()-90);var i=new Date;i.setDate(i.getDate()-59);i=new Date(Date.UTC(i.getFullYear(),i.getMonth(),1));var r=new Date;r.setDate(r.getDate()-13);this._dailySiteActivityPromise=this._siteAnalyticsDataSource.getDailySiteActivity(t,e);this._monthlySiteActivityPromise=this._siteAnalyticsDataSource.getDailySiteActivity(i,e,720);this._weeklySiteActivityPromise=this._siteAnalyticsDataSource.getDailySiteActivity(r,e,168);this._totalSiteActivityPromise=this._siteAnalyticsDataSource.getTotalSiteActivity()};e.prototype.render=function(){if(!this.props)return null;var e={highchartsInstance:this.props.highchartsInstance,ranges:this._buildRanges(),sources:this._buildSources(),loggingName:"SiteUsageChart"};return n.createElement(o.AnalyticsChart,r.__assign({},e))};e.prototype._buildRanges=function(){return s.buildRanges()};e.prototype._buildSources=function(){return s.buildSource(this._dailySiteActivityPromise,this._weeklySiteActivityPromise,this._monthlySiteActivityPromise,this._totalSiteActivityPromise)};return e}(n.Component);t.default=i});define("FX",["require","exports","ap","FY"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("FY",["require","exports","ap","fB","eq","aZ","ej","bf"],function(e,t,i,r,o,a,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,c="SiteAnalyticsDataSource";!function(e){e[e.ViewCount=0]="ViewCount";e[e.ViewerCount=1]="ViewerCount"}(l=t.AnalyticsOrdering||(t.AnalyticsOrdering={}));var d=function(t){i.__extends(e,t);function e(e){return t.call(this,e,c)||this}e.prototype.getDataSourceName=function(){return c};e.prototype.getDailySiteActivity=function(e,t,i){var r=e.toISOString(),n=t.toISOString(),o=this._getBaseUrl();i=i||"day";var a=u()?"oneDrive.getActivitiesByInterval":"getanalyticsbyinterval",s=u()?"startDateTime="+r+"&endDateTime="+n+"&interval="+i:"startDateTime='"+r+"'&endDateTime='"+n+"'&interval='"+i+"'";return this.getDataUtilizingCache({getUrl:function(){return o+"/"+a+"?"+s},parseResponse:function(e){var t=JSON.parse(e),i=[];u()?(t=t)&&t.value&&(i=t.value.map(p)):(t=t)&&t.Items&&(i=t.Items);return i},qosName:"GetDailySiteActivity",method:"GET",noRedirect:!0,additionalHeaders:{accept:"application/json"}})};e.prototype.getTotalSiteActivity=function(){var e=this._getBaseUrl();return this.getDataUtilizingCache({getUrl:function(){return e+"/analytics/allTime"},parseResponse:function(e){var t=JSON.parse(e);return u()?p(t):t},qosName:"GetTotalSiteActivity",method:"GET",noRedirect:!0,additionalHeaders:{accept:"application/json"}})};e.prototype.getTopListItems=function(e){var t=this._getBaseUrl("2.0"),i=e===l.ViewCount?"analytics/lastSevenDays/viewCount":"analytics/lastSevenDays/viewerCount",r="GetTopListItems"+l[e];return this.getDataUtilizingCache({getUrl:function(){return t+"/search?$select=Id,Name,WebUrl,analytics/lastSevenDays&$expand=analytics/lastSevenDays&$orderby="+i+" desc"},parseResponse:function(e){var t=JSON.parse(e),i=[];t&&(i=t.value);return i},qosName:r,method:"GET",noRedirect:!0,additionalHeaders:{accept:"application/json"}})};e.prototype._getBaseUrl=function(e){var t=o.getServerUrl(this._pageContext),i=new s.default(t).getAuthority(),r=a.default.normalizeLower(this._pageContext.siteId,!1),n=a.default.normalizeLower(this._pageContext.webId,!1);return t+"/_api/v"+(e=e||(u()?"2.1":"2.0"))+"/sites/"+i+","+r+","+n};return e}(r.default);t.SiteAnalyticsDataSource=d;function u(){return!n.Killswitch.isActivated("1DDBE980-C8F3-4DE4-AF12-65BDE794287A","12/4/2017","Disables analytics v2.1 vroom endpoint")}function p(e){return e&&{activity:{},incompleteData:{missingDataBeforeDateTime:e.incompleteData&&e.incompleteData.missingDataBeforeDateTime,wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},interval:void 0,isTrending:e.isTrending,startDateTime:e.startDateTime,viewCount:e.access&&e.access.actionCount,viewerCount:e.access&&e.access.actorCount}}});define("FQ",["require","exports","ap","FR"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("FR",["require","exports","ap","FS"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("FS",["require","exports","ap","at","jP","BZ","FT"],function(e,t,S,x,k,C,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=i;!function(e){e[e.Previous=0]="Previous";e[e.Next=1]="Next"}(t.ValuePosition||(t.ValuePosition={}));var r=function(i){S.__extends(e,i);function e(e){var h=i.call(this,e)||this;h._sliderLine=k.createRef();h._thumb=k.createRef();h._getAriaValueText=function(e){if(h.props.ariaValueText&&void 0!==e)return h.props.ariaValueText(e)};h._onMouseDownOrTouchStart=function(e){if("mousedown"===e.type){h._events.on(window,"mousemove",h._onMouseMoveOrTouchMove,!0);h._events.on(window,"mouseup",h._onMouseUpOrTouchEnd,!0)}else if("touchstart"===e.type){h._events.on(window,"touchmove",h._onMouseMoveOrTouchMove,!0);h._events.on(window,"touchend",h._onMouseUpOrTouchEnd,!0)}h._onMouseMoveOrTouchMove(e,!0)};h._onMouseMoveOrTouchMove=function(e,t){if(h._sliderLine.current){var i,r,n,o=h.props,a=o.max,s=o.min,l=o.step,c=(a-s)/l,d=h._sliderLine.current.getBoundingClientRect(),u=(h.props.vertical?d.height:d.width)/c;if(h.props.vertical){var p=h._getPosition(e,h.props.vertical);i=(d.bottom-p)/u}else{var m=h._getPosition(e,h.props.vertical);i=(k.getRTL()?d.right-m:m-d.left)/u}if(i>Math.floor(c))n=r=a;else if(i<0)n=r=s;else{n=s+l*i;r=s+l*Math.round(i)}h._updateValue(r,n);if(!t){e.preventDefault();e.stopPropagation()}}};h._onMouseUpOrTouchEnd=function(){h.setState({renderedValue:h.state.value});h._events.off()};h._onKeyDown=function(e){var t=h.state.value,i=h.props,r=i.max,n=i.min,o=i.step,a=0;switch(e.which){case k.getRTLSafeKeyCode(37):case 40:a=-o;break;case k.getRTLSafeKeyCode(39):case 38:a=o;break;case 36:t=n;break;case 35:t=r;break;default:return}var s=Math.min(r,Math.max(n,t+a));h._updateValue(s,s);e.preventDefault();e.stopPropagation()};h._warnMutuallyExclusive({value:"defaultValue"});h._id=k.getId("Slider");var t=e.value||e.defaultValue||e.min;h.state={value:t,renderedValue:t};return h}e.prototype.componentWillReceiveProps=function(e){if(void 0!==e.value){var t=Math.max(e.min,Math.min(e.max,e.value));this.setState({value:t,renderedValue:t})}};e.prototype.render=function(){var e,t,i,r=this.props,n=r.ariaLabel,o=r.className,a=r.disabled,s=r.label,l=r.max,c=r.min,d=r.showValue,u=r.buttonProps,p=r.vertical,m=this.state,h=m.value,f=m.renderedValue,g=(f-c)/(l-c)*100,b=p?"height":"width",_=a?{}:{onMouseDown:this._onMouseDownOrTouchStart},v=a?{}:{onTouchStart:this._onMouseDownOrTouchStart},y=a?{}:{onKeyDown:this._onKeyDown};return x.createElement("div",{className:k.css("ms-Slider",P.root,o,(e={},e["ms-Slider-enabled "+P.rootIsEnabled]=!a,e["ms-Slider-disabled "+P.rootIsDisabled]=a,e["ms-Slider-row "+P.rootIsHorizontal]=!p,e["ms-Slider-column "+P.rootIsVertical]=p,e))},s&&x.createElement(C.Label,S.__assign({className:P.titleLabel},n?{}:{htmlFor:this._id}),s),x.createElement("div",{className:k.css("ms-Slider-container",P.container)},x.createElement("button",S.__assign({"aria-valuenow":h,"aria-valuemin":c,"aria-valuemax":l,"aria-valuetext":this._getAriaValueText(h),"aria-label":n||s},_,v,y,u,{className:k.css("ms-Slider-slideBox",P.slideBox,u.className,!!d&&"ms-Slider-showValue",f===h&&"ms-Slider-showTransitions "+P.showTransitions),id:this._id,disabled:a,type:"button",role:"slider"}),x.createElement("div",{ref:this._sliderLine,className:k.css("ms-Slider-line",P.line)},x.createElement("span",{ref:this._thumb,className:k.css("ms-Slider-thumb",P.thumb),style:this._getThumbStyle(p,g)}),x.createElement("span",{className:k.css("ms-Slider-active",P.lineContainer,P.activeSection),style:(t={},t[b]=g+"%",t)}),x.createElement("span",{className:k.css("ms-Slider-inactive",P.lineContainer,P.inactiveSection),style:(i={},i[b]=100-g+"%",i)}))),d&&x.createElement(C.Label,{className:k.css("ms-Slider-value",P.valueLabel)},h)))};e.prototype.focus=function(){this._thumb.current&&this._thumb.current.focus()};Object.defineProperty(e.prototype,"value",{get:function(){return this.state.value},enumerable:!0,configurable:!0});e.prototype._getThumbStyle=function(e,t){var i;return(i={})[e?"bottom":k.getRTL()?"right":"left"]=t+"%",i};e.prototype._getPosition=function(e,t){var i;switch(e.type){case"mousedown":case"mousemove":i=t?e.clientY:e.clientX;break;case"touchstart":case"touchmove":i=t?e.touches[0].clientY:e.touches[0].clientX}return i};e.prototype._updateValue=function(e,t){var i=this,r=1/this.props.step,n=Math.round(e*r)/r,o=n!==this.state.value;this.setState({value:n,renderedValue:t},function(){o&&i.props.onChange&&i.props.onChange(i.state.value)})};e.defaultProps={step:1,min:0,max:10,showValue:!0,disabled:!1,vertical:!1,buttonProps:{}};return e}(k.BaseComponent);t.Slider=r});define("FT",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_0ec34fde{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.titleLabel_0ec34fde{padding:0}.line_0ec34fde{display:-webkit-box;display:-ms-flexbox;display:flex;position:relative}.line_0ec34fde .lineContainer_0ec34fde{border-radius:4px;-webkit-box-sizing:border-box;box-sizing:border-box}.container_0ec34fde{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.valueLabel_0ec34fde{-ms-flex-negative:1;flex-shrink:1;width:30px;line-height:1}.slideBox_0ec34fde{background:transparent;border:none;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;line-height:28px}.slideBox_0ec34fde::-moz-focus-inner{border:0}.slideBox_0ec34fde{outline:transparent}.slideBox_0ec34fde{position:relative}.ms-Fabric--isFocusVisible .slideBox_0ec34fde:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#000000"},{rawString:"}.slideBox_0ec34fde .thumb_0ec34fde{border:2px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";display:block;width:16px;height:16px;position:absolute;border-radius:10px}.rootIsHorizontal_0ec34fde .line_0ec34fde{width:100%}.rootIsHorizontal_0ec34fde .line_0ec34fde .lineContainer_0ec34fde{height:4px}.rootIsHorizontal_0ec34fde .slideBox_0ec34fde{height:28px;padding:0 8px}.rootIsHorizontal_0ec34fde .slideBox_0ec34fde .thumb_0ec34fde{top:-6px}html[dir='ltr'] .rootIsHorizontal_0ec34fde .slideBox_0ec34fde .thumb_0ec34fde{-webkit-transform:translateX(-50%);transform:translateX(-50%)}html[dir='rtl'] .rootIsHorizontal_0ec34fde .slideBox_0ec34fde .thumb_0ec34fde{-webkit-transform:translateX(50%);transform:translateX(50%)}.rootIsHorizontal_0ec34fde .valueLabel_0ec34fde{margin:0 8px;white-space:nowrap;width:40px}.rootIsVertical_0ec34fde{margin-right:8px}.rootIsVertical_0ec34fde .line_0ec34fde{height:100%;width:4px;margin:0 auto;-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.rootIsVertical_0ec34fde .line_0ec34fde .lineContainer_0ec34fde{width:4px;height:100%}.rootIsVertical_0ec34fde .slideBox_0ec34fde{height:100%;width:28px;padding:8px 0}.rootIsVertical_0ec34fde .slideBox_0ec34fde .thumb_0ec34fde{left:-6px;margin:0 auto;-webkit-transform:translateY(8px);transform:translateY(8px)}.rootIsVertical_0ec34fde .container_0ec34fde{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%;text-align:center;margin:8px 0}.rootIsVertical_0ec34fde .valueLabel_0ec34fde{margin:0 auto;white-space:nowrap;width:40px}.activeSection_0ec34fde{background:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}@media screen and (-ms-high-contrast: active){.activeSection_0ec34fde{background-color:WindowText}}.inactiveSection_0ec34fde{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}@media screen and (-ms-high-contrast: active){.inactiveSection_0ec34fde{border:1px solid WindowText}}.showTransitions_0ec34fde .thumb_0ec34fde{-webkit-transition:left .367s cubic-bezier(0.1, 0.9, 0.2, 1);transition:left .367s cubic-bezier(0.1, 0.9, 0.2, 1)}.showTransitions_0ec34fde .activeSection_0ec34fde,.showTransitions_0ec34fde .inactiveSection_0ec34fde{-webkit-transition:width .367s cubic-bezier(0.1, 0.9, 0.2, 1);transition:width .367s cubic-bezier(0.1, 0.9, 0.2, 1)}.rootIsEnabled_0ec34fde .slideBox_0ec34fde:hover .thumb_0ec34fde,.rootIsEnabled_0ec34fde .slideBox_0ec34fde:active .thumb_0ec34fde{border:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast: active){.rootIsEnabled_0ec34fde .slideBox_0ec34fde:hover .thumb_0ec34fde,.rootIsEnabled_0ec34fde .slideBox_0ec34fde:active .thumb_0ec34fde{border-color:Highlight}}.rootIsEnabled_0ec34fde .slideBox_0ec34fde:hover .activeSection_0ec34fde,.rootIsEnabled_0ec34fde .slideBox_0ec34fde:active .activeSection_0ec34fde{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast: active){.rootIsEnabled_0ec34fde .slideBox_0ec34fde:hover .activeSection_0ec34fde,.rootIsEnabled_0ec34fde .slideBox_0ec34fde:active .activeSection_0ec34fde{background-color:Highlight}}.rootIsEnabled_0ec34fde .slideBox_0ec34fde:hover .inactiveSection_0ec34fde,.rootIsEnabled_0ec34fde .slideBox_0ec34fde:active .inactiveSection_0ec34fde{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}@media screen and (-ms-high-contrast: active){.rootIsEnabled_0ec34fde .slideBox_0ec34fde:hover .inactiveSection_0ec34fde,.rootIsEnabled_0ec34fde .slideBox_0ec34fde:active .inactiveSection_0ec34fde{border-color:Highlight}}.rootIsEnabled_0ec34fde .slideBox_0ec34fde:active .thumb_0ec34fde{border:2px solid "},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.rootIsEnabled_0ec34fde .slideBox_0ec34fde:active .activeSection_0ec34fde{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.rootIsDisabled_0ec34fde .thumb_0ec34fde{border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}@media screen and (-ms-high-contrast: active){.rootIsDisabled_0ec34fde .thumb_0ec34fde{border-color:GrayText}}@media screen and (-ms-high-contrast: active){.rootIsDisabled_0ec34fde .activeSection_0ec34fde,.rootIsDisabled_0ec34fde .inactiveSection_0ec34fde{background-color:GrayText;border-color:GrayText}}.rootIsDisabled_0ec34fde .activeSection_0ec34fde{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.rootIsDisabled_0ec34fde .inactiveSection_0ec34fde{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}\n"}]);t.root="root_0ec34fde";t.titleLabel="titleLabel_0ec34fde";t.line="line_0ec34fde";t.lineContainer="lineContainer_0ec34fde";t.container="container_0ec34fde";t.valueLabel="valueLabel_0ec34fde";t.slideBox="slideBox_0ec34fde";t.thumb="thumb_0ec34fde";t.rootIsHorizontal="rootIsHorizontal_0ec34fde";t.rootIsVertical="rootIsVertical_0ec34fde";t.activeSection="activeSection_0ec34fde";t.inactiveSection="inactiveSection_0ec34fde";t.showTransitions="showTransitions_0ec34fde";t.rootIsEnabled="rootIsEnabled_0ec34fde";t.rootIsDisabled="rootIsDisabled_0ec34fde"});define("FL",["require","exports","ap","FM"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("FM",["require","exports","ap","FP","FN"],function(e,t,i,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t);i.__exportStar(n,t)});define("FP",["require","exports","ap","at","jP","FN","wE","FO"],function(e,t,o,a,s,l,c,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=i,r=function(i){o.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={};t._defaultCalloutProps={beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:12};return t}e.prototype.render=function(){var e=this.props,t=e.calloutProps,i=e.targetElement,r=e.onDismiss,n=o.__assign({},this._defaultCalloutProps,t);return a.createElement(c.Callout,o.__assign({target:i,onDismiss:r},n,{className:s.css("ms-TeachingBubble",d.root,this.props.isWide?d.wideCallout:null,n?n.className:void 0)}),a.createElement(l.TeachingBubbleContent,o.__assign({},this.props)))};e.defaultProps={calloutProps:{beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:12}};return e}(s.BaseComponent);t.TeachingBubble=r});define("FN",["require","exports","ap","at","jP","wN","mb","FO"],function(e,t,f,g,b,_,v,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=i,r=function(i){f.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={};return t}e.prototype.render=function(){var e,t,i,r,n,o=this.props,a=o.illustrationImage,s=o.primaryButtonProps,l=o.secondaryButtonProps,c=o.headline,d=o.hasCondensedHeadline,u=o.hasCloseIcon,p=o.onDismiss,m=o.closeButtonAriaLabel,h=o.hasSmallHeadline;a&&a.src&&(e=g.createElement("div",{className:"ms-TeachingBubble-header ms-TeachingBubble-image"},g.createElement(v.Image,f.__assign({},a))));c&&(t=g.createElement("div",{className:b.css("ms-TeachingBubble-header",d?"ms-TeachingBubble-header--condensed "+y.headerIsCondensed:h?"ms-TeachingBubble-header--small "+y.headerIsSmall:"ms-TeachingBubble-header--large "+y.headerIsLarge)},g.createElement("p",{className:b.css("ms-TeachingBubble-headline",y.headline)},c)));this.props.children&&(i=g.createElement("div",{className:b.css("ms-TeachingBubble-body",y.body)},g.createElement("p",{className:b.css("ms-TeachingBubble-subText",y.subText)},this.props.children)));(s||l)&&(r=g.createElement("div",{className:b.css("ms-TeachingBubble-footer",y.footer)},s&&g.createElement(_.PrimaryButton,f.__assign({},s,{className:b.css("ms-TeachingBubble-primaryButton",y.primaryButton,s.className)})),l&&g.createElement(_.DefaultButton,f.__assign({},l,{className:b.css("ms-TeachingBubble-secondaryButton",y.secondaryButton,l.className)}))));u&&(n=g.createElement(_.IconButton,{className:b.css("ms-TeachingBubble-closebutton",y.closeButton),iconProps:{iconName:"Cancel"},title:m,ariaLabel:m,onClick:p}));return g.createElement("div",{className:b.css("ms-TeachingBubble-content")},e,n,g.createElement("div",{className:b.css("ms-TeachingBubble-bodycontent",y.bodyContent)},t,i,r))};e.defaultProps={hasCondensedHeadline:!1,imageProps:{imageFit:v.ImageFit.cover,width:364,height:130}};return e}(b.BaseComponent);t.TeachingBubbleContent=r});define("FO",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:"@-webkit-keyframes bounceAnimation_0a22b123{0%{-webkit-transform:matrix3d(0.5, 0, 0, 0, 0, 0.5, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.5, 0, 0, 0, 0, 0.5, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}1.7%{-webkit-transform:matrix3d(0.658, 0, 0, 0, 0, 0.703, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.658, 0, 0, 0, 0, 0.703, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}2.35%{-webkit-transform:matrix3d(0.725, 0, 0, 0, 0, 0.8, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.725, 0, 0, 0, 0, 0.8, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}3.4%{-webkit-transform:matrix3d(0.83, 0, 0, 0, 0, 0.946, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.83, 0, 0, 0, 0, 0.946, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}4.7%{-webkit-transform:matrix3d(0.942, 0, 0, 0, 0, 1.084, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.942, 0, 0, 0, 0, 1.084, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}5.11%{-webkit-transform:matrix3d(0.971, 0, 0, 0, 0, 1.113, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.971, 0, 0, 0, 0, 1.113, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}6.81%{-webkit-transform:matrix3d(1.062, 0, 0, 0, 0, 1.166, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.062, 0, 0, 0, 0, 1.166, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}7.06%{-webkit-transform:matrix3d(1.07, 0, 0, 0, 0, 1.165, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.07, 0, 0, 0, 0, 1.165, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}8.76%{-webkit-transform:matrix3d(1.104, 0, 0, 0, 0, 1.12, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.104, 0, 0, 0, 0, 1.12, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}9.36%{-webkit-transform:matrix3d(1.106, 0, 0, 0, 0, 1.094, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.106, 0, 0, 0, 0, 1.094, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}10.66%{-webkit-transform:matrix3d(1.098, 0, 0, 0, 0, 1.035, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.098, 0, 0, 0, 0, 1.035, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}12.16%{-webkit-transform:matrix3d(1.075, 0, 0, 0, 0, 0.98, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.075, 0, 0, 0, 0, 0.98, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}12.61%{-webkit-transform:matrix3d(1.067, 0, 0, 0, 0, 0.969, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.067, 0, 0, 0, 0, 0.969, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}14.51%{-webkit-transform:matrix3d(1.031, 0, 0, 0, 0, 0.948, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.031, 0, 0, 0, 0, 0.948, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}14.96%{-webkit-transform:matrix3d(1.024, 0, 0, 0, 0, 0.949, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.024, 0, 0, 0, 0, 0.949, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}17.77%{-webkit-transform:matrix3d(0.99, 0, 0, 0, 0, 0.981, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.99, 0, 0, 0, 0, 0.981, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}18.37%{-webkit-transform:matrix3d(0.986, 0, 0, 0, 0, 0.989, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.986, 0, 0, 0, 0, 0.989, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}20.52%{-webkit-transform:matrix3d(0.98, 0, 0, 0, 0, 1.011, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.98, 0, 0, 0, 0, 1.011, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}22.22%{-webkit-transform:matrix3d(0.983, 0, 0, 0, 0, 1.016, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.983, 0, 0, 0, 0, 1.016, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}26.08%{-webkit-transform:matrix3d(0.996, 0, 0, 0, 0, 1.003, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.996, 0, 0, 0, 0, 1.003, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}29.93%{-webkit-transform:matrix3d(1.003, 0, 0, 0, 0, 0.995, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.003, 0, 0, 0, 0, 0.995, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}31.63%{-webkit-transform:matrix3d(1.004, 0, 0, 0, 0, 0.996, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.004, 0, 0, 0, 0, 0.996, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}37.64%{-webkit-transform:matrix3d(1.001, 0, 0, 0, 0, 1.002, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.001, 0, 0, 0, 0, 1.002, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}42.74%{-webkit-transform:matrix3d(0.999, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.999, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}45.35%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}49.9%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}50%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}52.15%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}54.3%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}56.46%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}58.61%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}64.16%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}69.72%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}80.83%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}91.99%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}100%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}}@keyframes bounceAnimation_0a22b123{0%{-webkit-transform:matrix3d(0.5, 0, 0, 0, 0, 0.5, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.5, 0, 0, 0, 0, 0.5, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}1.7%{-webkit-transform:matrix3d(0.658, 0, 0, 0, 0, 0.703, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.658, 0, 0, 0, 0, 0.703, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}2.35%{-webkit-transform:matrix3d(0.725, 0, 0, 0, 0, 0.8, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.725, 0, 0, 0, 0, 0.8, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}3.4%{-webkit-transform:matrix3d(0.83, 0, 0, 0, 0, 0.946, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.83, 0, 0, 0, 0, 0.946, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}4.7%{-webkit-transform:matrix3d(0.942, 0, 0, 0, 0, 1.084, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.942, 0, 0, 0, 0, 1.084, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}5.11%{-webkit-transform:matrix3d(0.971, 0, 0, 0, 0, 1.113, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.971, 0, 0, 0, 0, 1.113, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}6.81%{-webkit-transform:matrix3d(1.062, 0, 0, 0, 0, 1.166, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.062, 0, 0, 0, 0, 1.166, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}7.06%{-webkit-transform:matrix3d(1.07, 0, 0, 0, 0, 1.165, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.07, 0, 0, 0, 0, 1.165, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}8.76%{-webkit-transform:matrix3d(1.104, 0, 0, 0, 0, 1.12, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.104, 0, 0, 0, 0, 1.12, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}9.36%{-webkit-transform:matrix3d(1.106, 0, 0, 0, 0, 1.094, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.106, 0, 0, 0, 0, 1.094, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}10.66%{-webkit-transform:matrix3d(1.098, 0, 0, 0, 0, 1.035, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.098, 0, 0, 0, 0, 1.035, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}12.16%{-webkit-transform:matrix3d(1.075, 0, 0, 0, 0, 0.98, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.075, 0, 0, 0, 0, 0.98, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}12.61%{-webkit-transform:matrix3d(1.067, 0, 0, 0, 0, 0.969, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.067, 0, 0, 0, 0, 0.969, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}14.51%{-webkit-transform:matrix3d(1.031, 0, 0, 0, 0, 0.948, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.031, 0, 0, 0, 0, 0.948, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}14.96%{-webkit-transform:matrix3d(1.024, 0, 0, 0, 0, 0.949, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.024, 0, 0, 0, 0, 0.949, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}17.77%{-webkit-transform:matrix3d(0.99, 0, 0, 0, 0, 0.981, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.99, 0, 0, 0, 0, 0.981, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}18.37%{-webkit-transform:matrix3d(0.986, 0, 0, 0, 0, 0.989, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.986, 0, 0, 0, 0, 0.989, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}20.52%{-webkit-transform:matrix3d(0.98, 0, 0, 0, 0, 1.011, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.98, 0, 0, 0, 0, 1.011, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}22.22%{-webkit-transform:matrix3d(0.983, 0, 0, 0, 0, 1.016, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.983, 0, 0, 0, 0, 1.016, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}26.08%{-webkit-transform:matrix3d(0.996, 0, 0, 0, 0, 1.003, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.996, 0, 0, 0, 0, 1.003, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}29.93%{-webkit-transform:matrix3d(1.003, 0, 0, 0, 0, 0.995, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.003, 0, 0, 0, 0, 0.995, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}31.63%{-webkit-transform:matrix3d(1.004, 0, 0, 0, 0, 0.996, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.004, 0, 0, 0, 0, 0.996, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}37.64%{-webkit-transform:matrix3d(1.001, 0, 0, 0, 0, 1.002, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1.001, 0, 0, 0, 0, 1.002, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}42.74%{-webkit-transform:matrix3d(0.999, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(0.999, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}45.35%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}49.9%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}50%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}52.15%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}54.3%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}56.46%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}58.61%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}64.16%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}69.72%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}80.83%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}91.99%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}100%{-webkit-transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);transform:matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)}}@-webkit-keyframes opacityFadeIn_0a22b123{0%{opacity:0;-webkit-animation-timing-function:cubic-bezier(0.1, 0.25, 0.75, 0.9);animation-timing-function:cubic-bezier(0.1, 0.25, 0.75, 0.9)}26.26%{opacity:1}100%{opacity:1}}@keyframes opacityFadeIn_0a22b123{0%{opacity:0;-webkit-animation-timing-function:cubic-bezier(0.1, 0.25, 0.75, 0.9);animation-timing-function:cubic-bezier(0.1, 0.25, 0.75, 0.9)}26.26%{opacity:1}100%{opacity:1}}.root_0a22b123{display:block;max-width:364px;border:0;-webkit-box-shadow:none !important;box-shadow:none !important;-webkit-animation-name:bounceAnimation_0a22b123,opacityFadeIn_0a22b123;animation-name:bounceAnimation_0a22b123,opacityFadeIn_0a22b123;-webkit-animation-duration:2000ms;animation-duration:2000ms;-webkit-animation-timing-function:linear;animation-timing-function:linear;-webkit-animation-fill-mode:both;animation-fill-mode:both}.bodyContent_0a22b123{padding:20px}.headerIsLarge_0a22b123:not(:last-child){margin-bottom:14px}.headerIsSmall_0a22b123:not(:last-child){margin-bottom:14px}.headline_0a22b123{margin:0;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.headerIsLarge_0a22b123 .headline_0a22b123{font-size:28px;font-weight:100;font-weight:100}.headerIsCondensed_0a22b123 .headline_0a22b123{font-size:14px;font-weight:400;font-weight:600}[dir='ltr'] .headerIsCondensed_0a22b123 .headline_0a22b123{margin-right:10px}[dir='rtl'] .headerIsCondensed_0a22b123 .headline_0a22b123{margin-left:10px}.headerIsSmall_0a22b123 .headline_0a22b123{font-size:14px;font-weight:400;font-weight:600}[dir='ltr'] .headerIsSmall_0a22b123 .headline_0a22b123{margin-right:10px}[dir='rtl'] .headerIsSmall_0a22b123 .headline_0a22b123{margin-left:10px}.body_0a22b123:not(:last-child){margin-bottom:20px}.subText_0a22b123{margin:0;font-size:14px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-weight:300}.root_0a22b123 .closeButton_0a22b123{position:absolute;top:0;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:12px}[dir='ltr'] .root_0a22b123 .closeButton_0a22b123{right:0}[dir='rtl'] .root_0a22b123 .closeButton_0a22b123{left:0}html[dir='ltr'] .footer_0a22b123 .ms-Button:not(:first-child){margin-left:20px}html[dir='rtl'] .footer_0a22b123 .ms-Button:not(:first-child){margin-right:20px}.root_0a22b123 .ms-Callout-main,.root_0a22b123 .ms-Callout-beak,.root_0a22b123 .ms-Callout-smallbeak{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.wideCallout_0a22b123{max-width:456px}.wideCallout_0a22b123 .ms-TeachingBubble-content{display:-webkit-box;display:-ms-flexbox;display:flex}.wideCallout_0a22b123 .ms-TeachingBubble-image{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:20px;max-width:154px}.wideCallout_0a22b123 .bodyContent_0a22b123{max-width:302px}.root_0a22b123 .primaryButton_0a22b123{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.root_0a22b123 .primaryButton_0a22b123 .ms-Button-label{font-size:14px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.root_0a22b123 .primaryButton_0a22b123:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";border-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}.root_0a22b123 .primaryButton_0a22b123:focus{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.root_0a22b123 .primaryButton_0a22b123:active{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.root_0a22b123 .secondaryButton_0a22b123{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.root_0a22b123 .secondaryButton_0a22b123 .ms-Button-label{font-size:14px;font-weight:400;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.root_0a22b123 .secondaryButton_0a22b123:hover{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.root_0a22b123 .secondaryButton_0a22b123:focus{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.root_0a22b123 .secondaryButton_0a22b123:active{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}\n"}]);t.root="root_0a22b123";t.bounceAnimation="bounceAnimation_0a22b123";t.opacityFadeIn="opacityFadeIn_0a22b123";t.bodyContent="bodyContent_0a22b123";t.headerIsLarge="headerIsLarge_0a22b123";t.headerIsSmall="headerIsSmall_0a22b123";t.headline="headline_0a22b123";t.headerIsCondensed="headerIsCondensed_0a22b123";t.body="body_0a22b123";t.subText="subText_0a22b123";t.closeButton="closeButton_0a22b123";t.footer="footer_0a22b123";t.wideCallout="wideCallout_0a22b123";t.primaryButton="primaryButton_0a22b123";t.secondaryButton="secondaryButton_0a22b123"});define("adz",["require","exports","ap","at","a0","adH","adF","adD","adr","jP","o7","CC","Cr","adB","Fb","V","adA"],function(e,t,g,b,f,r,n,o,_,v,y,i,a,S,x,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.BasePickerListBelow,l=function(i){g.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._currentText="";t._ariaLabelId=v.getId("CheckboxFilterSection");return t}e.prototype.render=function(){var i=this,e=this.props,t=e.sectionInfo,r=e.seeAllLinkProps,n=e.hideSectionHeader,o=e.showFilterPicker,a=e.onResolveSuggestions,s=e.onSelectedSuggestionChange,l=e.className,c=e.commandItems,d=e.strings,u=r&&(t.showSeeAllLink||!1!==t.showSeeAllLink&&t.options&&5<=t.options.length),p=0,m=t.title;u&&(r.filterSectionInfo=t);if(t.options&&t.options.length)for(var h=0,f=t.options;h<f.length;h++){f[h].checked&&p++}0<p&&(m=k.format(d.SectionTitleWithNumber,t.title,p));return b.createElement("div",{ref:this._resolveRef("root"),className:v.css(l,"FiltersPane-section"),"data-automationtype":"FilterSection","data-section-type":t.type,"data-section-key":t.fieldName},!n&&b.createElement(_.default,{rootElementId:this._ariaLabelId,text:m,showEditButton:t.showEditButton,commandItems:c}),b.createElement("div",{className:"FiltersPane-sectionContent",role:"group","aria-labelledby":this._ariaLabelId},o&&a&&s&&this._renderFilterPicker(),t.options&&0<t.options.length&&b.createElement(y.FocusZone,{ref:this._resolveRef("focusZone"),direction:y.FocusZoneDirection.vertical,isCircularNavigation:!0},t.options.map(function(e,t){if(!u||t<5)return i._renderOption(e)}))),u&&b.createElement("div",{className:"FiltersPane-sectionFooter"},b.createElement(S.SeeAllLink,g.__assign({},r)," ")))};e.prototype.resetFocus=function(e){var t=this.props.sectionInfo;if(t&&t.options&&0<t.options.length&&0<=e){var i=this.root.querySelectorAll("input[type=checkbox]")[Math.min(e,t.options.length-1)];this.focusZone.focusElement(i)}};e.prototype._renderFilterPicker=function(){var e=this.props,t=e.sectionInfo,i=e.pageContext,r=e.strings;return 0===t.type&&i?b.createElement(a.PeoplePicker,{className:"od-CheckBoxFilterSection-peoplePicker",context:i,peoplePickerType:a.PeoplePickerType.listBelow,onRenderItem:this._onRenderItem,onSelectedPersonasChange:this._onSelectedPersonasChange,inputProps:{placeholder:r.PeoplePickerPlaceholder},noResultsFoundText:r.NoResults}):b.createElement(s,{className:"od-CheckBoxFilterSection-filterPicker",onResolveSuggestions:this._onResolveSuggestions,getTextFromItem:this._getTextFromItem,onRenderItem:this._onRenderItem,onRenderSuggestionsItem:this._onRenderSuggestionsItem,pickerSuggestionsProps:{onRenderNoResultFound:this._onRenderNoResultFound},inputProps:{placeholder:r.FilterPickerPlaceholder},onChange:this._onSelectedSuggestionsChange})};e.prototype._onSelectedPersonasChange=function(e){var t=e&&0<e.length&&e[e.length-1];if(t){var i={key:t.name,checked:!0,values:[t.name],label:t.name,iconUrl:t.image};this._onSelectedSuggestionsChange([i])}};e.prototype._onRenderNoResultFound=function(){return b.createElement("div",{className:"od-CheckboxFilterSection-Suggestions-none"},k.format(this.props.strings.NoResultFound,this._currentText))};e.prototype._getTextFromItem=function(e){return e.label};e.prototype._onResolveSuggestions=function(e,t){this._currentText=e;var i=this.props,r=i.onResolveSuggestions,n=i.sectionInfo;if(r)return r(n.fieldName,n.fieldType,e,t)};e.prototype._onRenderItem=function(){return null};e.prototype._onRenderSuggestionsItem=function(e){return b.createElement("div",null,e.label)};e.prototype._onSelectedSuggestionsChange=function(e){var t=this.props,i=t.sectionInfo,r=t.onSelectedSuggestionChange,n=e&&0<e.length&&e[e.length-1];r&&n&&r(i.fieldName,i.fieldType,n)};e.prototype._renderOption=function(e){var t=this.props.sectionInfo;return 0===t.type?b.createElement(r.PersonaCheckbox,{key:e.key,label:e.label,imageUrl:e.iconUrl,onChanged:this._onToggleChanged,checked:e.checked}):2===t.type?b.createElement(n.FileTypeCheckbox,{key:e.key,label:e.label,imageUrl:e.iconUrl,onChanged:this._onToggleChanged,checked:e.checked}):b.createElement(o.ComposedCheckbox,{key:e.key,label:e.label,onChanged:this._onToggleChanged,checked:e.checked,showLabel:!0})};e.prototype._onToggleChanged=function(e,t){for(var i=this.props,r=i.sectionInfo,n=i.onChange,o=i.engagementSource,a=[],s=0,l=r.options;s<l.length;s++){var c=l[s],d=c.checked;c.key===e&&(d=t);if(d)for(var u=0,p=c.values;u<p.length;u++){var m=p[u];a.push(m)}}n&&n(r.fieldName,r.fieldType,a);o=o||"SmartFiltersPane";var h=k.format("{0}Checkbox.{1}.Click",x.ColumnFieldType[r.fieldType],o);f.Engagement.logData({name:h,extraData:{isChecked:t}})};g.__decorate([v.autobind],e.prototype,"resetFocus",null);g.__decorate([v.autobind],e.prototype,"_renderFilterPicker",null);g.__decorate([v.autobind],e.prototype,"_onSelectedPersonasChange",null);g.__decorate([v.autobind],e.prototype,"_onRenderNoResultFound",null);g.__decorate([v.autobind],e.prototype,"_onResolveSuggestions",null);g.__decorate([v.autobind],e.prototype,"_onSelectedSuggestionsChange",null);g.__decorate([v.autobind],e.prototype,"_renderOption",null);g.__decorate([v.autobind],e.prototype,"_onToggleChanged",null);return e}(v.BaseComponent);t.CheckboxFilterSection=l});define("adH",["require","exports","ap","at","xA","adD"],function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.label,i=e.imageUrl;return n.createElement(a.ComposedCheckbox,r.__assign({className:"PersonaCheckbox",showLabel:!1},this.props),n.createElement(o.Persona,{primaryText:t,imageUrl:i||"/_layouts/15/userphoto.aspx?size=S&accountname=",size:o.PersonaSize.extraSmall}))};return t}(n.Component);t.PersonaCheckbox=i});define("adD",["require","exports","ap","at","Dz","jP","adE"],function(e,t,r,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.state={isFocused:!1};return t}e.prototype.render=function(){var e=this.props,t=e.checked,i=e.label,r=e.children,n=e.className,o=e.showLabel,a=this.state.isFocused;null==t&&(t=!1);var s={onFocus:this._onFocus,onBlur:this._onBlur,"aria-label":i};return o&&"string"!=typeof i?null:l.createElement("div",{className:d.css("ComposedCheckbox",n,{"is-inFocus":a}),"data-automationtype":"ComposedCheckbox","data-is-checked":t,"data-checked-value":i},l.createElement(c.Checkbox,{className:"ComposedCheckbox-checkBox",label:o&&i,checked:t,onChange:this._onToggleChanged,inputProps:s}),r&&l.createElement("div",{className:"ComposedCheckbox-children-container","aria-hidden":"true"},r))};e.prototype._onFocus=function(){this.setState({isFocused:!0})};e.prototype._onBlur=function(){this.setState({isFocused:!1})};e.prototype._onToggleChanged=function(e,t){var i=this.props,r=i.label,n=i.onChanged;n&&n(r,t)};r.__decorate([d.autobind],e.prototype,"_onFocus",null);r.__decorate([d.autobind],e.prototype,"_onBlur",null);r.__decorate([d.autobind],e.prototype,"_onToggleChanged",null);return e}(l.Component);t.ComposedCheckbox=i});define("adE",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".ComposedCheckbox{white-space:nowrap;position:relative;display:-ms-flexbox;display:flex;font-size:14px}.ComposedCheckbox-checkBox{min-width:20px}.ComposedCheckbox-children-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}[dir=ltr] .ComposedCheckbox-children-container{margin-left:8px}[dir=rtl] .ComposedCheckbox-children-container{margin-right:8px}.od-focus--enabled .ComposedCheckbox.is-inFocus::before{content:'';position:absolute;top:0;bottom:0;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}[dir=ltr] .od-focus--enabled .ComposedCheckbox.is-inFocus::before{right:-8px}[dir=rtl] .od-focus--enabled .ComposedCheckbox.is-inFocus::before{left:-8px}[dir=ltr] .od-focus--enabled .ComposedCheckbox.is-inFocus::before{left:-8px}[dir=rtl] .od-focus--enabled .ComposedCheckbox.is-inFocus::before{right:-8px}@media screen and (-ms-high-contrast:active){.od-focus--enabled .ComposedCheckbox.is-inFocus::before{border:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-focus--enabled .ComposedCheckbox.is-inFocus::before{border:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-focus--enabled .ComposedCheckbox.is-inFocus button:focus{box-shadow:none}.od-focus--enabled .ComposedCheckbox.is-inFocus .ComposedCheckbox-checkBox:focus::after{content:none}"}])});define("adF",["require","exports","ap","at","mb","adD","adG"],function(e,t,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){r.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.imageUrl,i=e.label;return n.createElement(a.ComposedCheckbox,r.__assign({className:"FileTypeCheckbox",showLabel:!1},this.props),n.createElement(o.Image,{src:t,width:"16px"}),n.createElement("span",{className:"FileTypeCheckbox-label"},i))};return t}(n.Component);t.FileTypeCheckbox=i});define("adG",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:"[dir=ltr] .FileTypeCheckbox .FileTypeCheckbox-label{margin-left:8px}[dir=rtl] .FileTypeCheckbox .FileTypeCheckbox-label{margin-right:8px}"}])});define("adr",["require","exports","ap","at","jP","wN","ads"],function(e,t,i,a,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var t=this,e=this.props,i=e.text,r=e.rootElementId,n=e.showEditButton,o=e.commandItems;return a.createElement("div",{className:"od-FilterSectionHeader",id:r},i,n&&o&&a.createElement("div",{className:"od-FilterSectionHeader-sideCommands"},o.map(function(e){return t._onRenderCommand(e)})))};t.prototype._onRenderCommand=function(t){return a.createElement(n.DefaultButton,{name:t.name,ariaLabel:t.ariaLabel,"data-automationtype":"FilterSectionHeaderButton",key:t.key,className:"od-FilterSectionHeader-button",iconProps:{iconName:t.iconProps?t.iconProps.iconName:""},menuProps:t.subMenuProps,onRenderMenuIcon:this._onRenderMenuIcon,onClick:!t.subMenuProps&&t.onClick?function(e){t.onClick(e,t)}:void 0})};t.prototype._onRenderMenuIcon=function(){return null};i.__decorate([r.autobind],t.prototype,"_onRenderCommand",null);return t}(r.BaseComponent);t.default=o});define("ads",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".od-FilterSectionHeader{position:relative;font-size:14px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";height:20px;padding:6px 0}.od-FilterSectionHeader .od-FilterSectionHeader-sideCommands{position:absolute;top:0}[dir=ltr] .od-FilterSectionHeader .od-FilterSectionHeader-sideCommands{right:0}[dir=rtl] .od-FilterSectionHeader .od-FilterSectionHeader-sideCommands{left:0}.od-FilterSectionHeader .od-FilterSectionHeader-button{padding:0 4px;min-width:32px;background-color:transparent}.od-FilterSectionHeader .od-FilterSectionHeader-button:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] .od-FilterSectionHeader .od-FilterSectionHeader-button+.od-FilterSectionHeader-button{margin-left:8px}[dir=rtl] .od-FilterSectionHeader .od-FilterSectionHeader-button+.od-FilterSectionHeader-button{margin-right:8px}"}])});define("adB",["require","exports","ap","at","Zz","aL","a0","jP","adC"],function(e,t,r,o,m,n,a,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._onClick=t._onClick.bind(t);t._ariaDescriptionId=s.getId("SeeAllLink");t._labelId=s.getId("SeeAllLink");return t}e.prototype.render=function(){var e=this.props,t=e.label,i=e.ariaDescription,r=i?o.createElement("span",{className:"ms-accessible",id:this._ariaDescriptionId},i):null,n=r?this._ariaDescriptionId:null;return o.createElement("a",{className:"SeeAllLink",href:"#",onClick:this._onClick,role:"button","aria-describedby":n},o.createElement("span",{id:this._labelId},t),r)};e.prototype._onClick=function(e){var t=this.props,c=t.filterSectionInfo,d=t.getOptionFromServerFilterValue,i=t.getFilterData,u=t.launchFilterSelectPanel,p=n.deepCopy(c);i(p.fieldName,p.fieldType).then(function(e){for(var t=m.default.getFilterData(e,p.fieldName),i={},r=0,n=p.options;r<n.length;r++){i[(l=n[r]).key]=l}for(var o=0,a=t;o<a.length;o++){var s=a[o];if(d){var l;if(i[(l=d(c.fieldType,s)).key])continue;p.options.push(l)}}u(p)});a.Engagement.logData({name:"SeeAll.SmartFiltersPane.Click"});e.stopPropagation();e.preventDefault()};return e}(o.Component);t.SeeAllLink=i});define("adC",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".SeeAllLink{font-size:14px;font-weight:400;font-weight:300;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}])});define("adA",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".od-CheckboxFilterSection-Suggestions-none{text-align:center;color:"},{theme:"info",defaultValue:"#107c10"},{rawString:";font-size:12px;line-height:30px}.od-CheckBoxFilterSection-peoplePicker{margin-bottom:12px}.od-CheckBoxFilterSection-filterPicker{margin-bottom:8px}.FiltersPane-sectionContent .PersonaCheckbox.ComposedCheckbox{padding:4px 0}.FiltersPane-sectionContent .ComposedCheckbox{padding:8px 0}"}])});define("adw",["require","exports","ap","at","a0","adr","adx","jP"],function(e,t,r,o,d,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._ariaLabelId=l.getId("HierachyFilterSection");return t}e.prototype.render=function(){var e=this.props,t=e.sectionInfo,i=e.commandItems,r=e.className,n=e.hideSectionHeader;return o.createElement("div",{className:l.css(r,"FiltersPane-section FiltersPane-hierachyFilterSection"),"data-automationtype":"FilterSection","data-section-type":t.type,"data-section-key":t.fieldName},!n&&o.createElement(a.default,{text:t.title,showEditButton:t.showEditButton,commandItems:i,rootElementId:this._ariaLabelId}),o.createElement(s.CheckboxTree,{nodes:t.options,checkedKeys:t.checkedKeys,ariaLabelledBy:this._ariaLabelId,expandedKeys:t.expandedKeys,onCheckChange:this._onCheckChange,onExpandChange:this._onExpandChange}))};e.prototype._onCheckChange=function(e,t,i,r,n){var o=this.props,a=o.sectionInfo,s=o.engagementSource,l=o.onCheckChange;l&&l(a.fieldName,a.fieldType,n,r);var c="CheckboxTree."+(s=s||"SmartFiltersPane")+".Click";d.Engagement.logData({name:c,isIntentional:!0,extraData:{isChecked:i}})};e.prototype._onExpandChange=function(e,t,i,r){var n=this.props,o=n.sectionInfo,a=n.engagementSource,s=n.onExpandChange;s&&s(o.fieldName,t,i,r);var l="CheckboxTreeExpand."+(a=a||"SmartFiltersPane")+".Click";d.Engagement.logData({name:l,isIntentional:!0,extraData:{isExpanded:i}})};r.__decorate([l.autobind],e.prototype,"_onCheckChange",null);r.__decorate([l.autobind],e.prototype,"_onExpandChange",null);return e}(o.Component);t.HierachyFilterSection=i;t.default=i});define("adx",["require","exports","ap","at","Dz","wN","BZ","o7","jP","ady"],function(e,t,r,c,l,d,u,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._statusHashMap={};t._id=m.getId("CheckboxTree");t._initializeStatusHashMap(e);t.state={focusedKey:null};return t}e.prototype.componentWillReceiveProps=function(e){e.nodes===this.props.nodes&&e.checkedKeys===this.props.checkedKeys&&e.expandedKeys===this.props.expandedKeys||this._initializeStatusHashMap(e)};e.prototype.render=function(){var t=this,e=this.props,i=e.nodes,r=e.label,n=e.ariaLabelledBy,o=this._id+"-label",a=!1;if(i)for(var s=0,l=i;s<l.length;s++){if(l[s].hasChildren){a=!0;break}}return c.createElement("div",null,r&&c.createElement(u.Label,{id:o}," ",r),c.createElement(p.FocusZone,{ref:this._resolveRef("focusZone"),direction:p.FocusZoneDirection.vertical,isCircularNavigation:!0},c.createElement("ul",{className:"CheckboxTree",role:"tree","aria-labelledby":n||(r?o:"")},i&&i.length&&i.map(function(e){return t._renderNode(e,1,a)}))))};e.prototype._renderNode=function(e,t,i){var r=this,n=e.hasChildren||e.children&&e.children.length,o=this._isNodeChecked(e),a=!(!this._statusHashMap[e.key]||!this._statusHashMap[e.key].expanded),s=!n;1!==t||i||(s=!1);return c.createElement("li",{className:"CheckboxTree-node",key:e.key},c.createElement("div",{className:m.css("CheckboxTree-row",{"is-inFocus":e.key===this.state.focusedKey}),role:"treeitem","aria-expanded":n?a?"true":"false":null,"data-is-focusable":!0,onFocus:this._onFocus.bind(this,e.key),onBlur:this._onBlur.bind(this,e.key),onKeyDown:this._onKeyDown.bind(this,e)},n&&c.createElement(d.IconButton,{"data-is-focusable":!1,onFocus:this._onExpandButtonFocus,onClick:this._onExpandChange.bind(this,e,!a),className:"CheckboxTree-toggleExpand-button",iconProps:{iconName:a?"ChevronDown":"ChevronRight"}}),c.createElement(l.Checkbox,{checked:o,label:e.label,inputProps:{"data-is-focusable":!1},className:s?"needIndent":"",onChange:this._onCheckChange.bind(this,e,!o)})),n&&a&&e.children&&e.children.length&&c.createElement("ul",{className:"CheckboxTree-childTree",role:"group"},e.children.map(function(e){return r._renderNode(e,t+1)})))};e.prototype._onExpandButtonFocus=function(e){e.preventDefault();e.stopPropagation()};e.prototype._onFocus=function(e){this.setState({focusedKey:e})};e.prototype._onBlur=function(e){this.setState({focusedKey:null})};e.prototype._onKeyDown=function(e,t){var i=m.getRTL()?37:39,r=m.getRTL()?39:37,n=this._statusHashMap[e.key],o=!(!n||!n.expanded),a=!(!n||!n.checked);if(t.which===i&&!o||t.which===r&&o){t.preventDefault();t.stopPropagation();this._onExpandChange(e,!o,t)}else 32===t.which&&this._onCheckChange(e,!a,t)};e.prototype._onCheckChange=function(e,t,i){var r=this.props,n=r.onCheckChange,o=r.checkedKeys;if(n){for(var a=this._toggleChecked(o.slice(),e,t),s=[],l=0,c=a;l<c.length;l++){var d=c[l],u=this._statusHashMap[d]&&this._statusHashMap[d].node.values;if(u)for(var p=0,m=u;p<m.length;p++){var h=m[p];-1===s.indexOf(h)&&s.push(h)}}n(i,e,t,a,s)}};e.prototype._onExpandChange=function(e,t,i){var r=this.props,n=r.onExpandChange,o=r.expandedKeys;if(n){var a=o.slice();this._updateStatusArray(a,e.key,t);n(i,e,t,a)}};e.prototype._initializeStatusHashMap=function(e){this._statusHashMap={};this._updateStatusHashMap(void 0,e.nodes,e.checkedKeys,e.expandedKeys)};e.prototype._updateStatusHashMap=function(e,t,i,r){for(var n=0,o=t;n<o.length;n++){var a=o[n];this._statusHashMap[a.key]={checked:i&&0<=i.indexOf(a.key),expanded:r&&0<=r.indexOf(a.key),parentKey:e?e.key:void 0,node:a};a.children&&0<a.children.length&&this._updateStatusHashMap(a,a.children,i,r)}};e.prototype._isNodeChecked=function(e){return!!(e.children&&0!==e.children.length?this._isEveryChildChecked(e):this._statusHashMap[e.key]&&this._statusHashMap[e.key].checked)};e.prototype._isEveryChildChecked=function(e){var t=this;return e.children&&e.children.every(function(e){return e.children&&0<e.children.length?t._isEveryChildChecked(e):!(!t._statusHashMap[e.key]||!t._statusHashMap[e.key].checked)})};e.prototype._toggleChecked=function(t,e,i){var r=this;this._statusHashMap[e.key].checked=i;e.children&&e.children.forEach(function(e){r._toggleChecked(t,e,i)});var n=this._updateStatusArray(t,e.key,i);if(i)for(a=this._statusHashMap[e.key]&&this._statusHashMap[e.key].parentKey;a&&!(0<=t.indexOf(a));){var o=this._statusHashMap[a]&&this._statusHashMap[a].node;if(!o||!this._isNodeChecked(o))break;this._statusHashMap[a].checked=i;this._updateStatusArray(t,a,i);a=this._statusHashMap[o.key]&&this._statusHashMap[o.key].parentKey}else for(var a=this._statusHashMap[e.key]&&this._statusHashMap[e.key].parentKey;a&&n;){this._statusHashMap[a].checked=i;n=this._updateStatusArray(t,a,i);a=this._statusHashMap[a]&&this._statusHashMap[a].parentKey}return t};e.prototype._updateStatusArray=function(e,t,i){var r=e.indexOf(t),n=!1;if(-1<r&&!i){e.splice(r,1);n=!0}else if(-1===r&&i){e.push(t);n=!0}return n};e.defaultProps={nodes:[],checkedKeys:[],expandedKeys:[]};return e}(m.BaseComponent);t.CheckboxTree=i});define("ady",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".CheckboxTree{white-space:nowrap;list-style-type:none;margin-top:8px}[dir=ltr] .CheckboxTree{padding-left:0}[dir=rtl] .CheckboxTree{padding-right:0}.CheckboxTree .ms-Checkbox{display:inline-block;padding:8px 0;font-size:14px}[dir=ltr] .CheckboxTree .needIndent{padding-left:26px}[dir=rtl] .CheckboxTree .needIndent{padding-right:26px}.CheckboxTree-toggleExpand-button{-ms-flex-negative:0;flex-shrink:0;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .CheckboxTree-toggleExpand-button{margin-left:-6px}[dir=rtl] .CheckboxTree-toggleExpand-button{margin-right:-6px}.CheckboxTree-toggleExpand-button:visited{color:inherit}.CheckboxTree-toggleExpand-button:hover{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.CheckboxTree-node{list-style-type:none}[dir=ltr] .CheckboxTree-childTree{margin-left:-12px}[dir=rtl] .CheckboxTree-childTree{margin-right:-12px}.CheckboxTree-row{position:relative;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.CheckboxTree-row:focus{outline:1px solid transparent}.CheckboxTree-title{position:relative;font-size:14px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-focus--enabled .CheckboxTree-row.is-inFocus::before{content:'';position:absolute;top:0;bottom:0;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}[dir=ltr] .od-focus--enabled .CheckboxTree-row.is-inFocus::before{right:-8px}[dir=rtl] .od-focus--enabled .CheckboxTree-row.is-inFocus::before{left:-8px}[dir=ltr] .od-focus--enabled .CheckboxTree-row.is-inFocus::before{left:-8px}[dir=rtl] .od-focus--enabled .CheckboxTree-row.is-inFocus::before{right:-8px}@media screen and (-ms-high-contrast:active){.od-focus--enabled .CheckboxTree-row.is-inFocus::before{border:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-focus--enabled .CheckboxTree-row.is-inFocus::before{border:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}"}])});define("adt",["require","exports","ap","at","V","a0","gP","FK","adv","adz","adr","adl","adu"],function(e,t,i,f,g,r,b,_,v,y,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){i.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.sectionInfo,i=e.seeAllLinkProps,r=e.onDateCheckboxChange,n=e.commandItems,o=void 0===t.minValue||null===t.minValue?b.DateTimeSliderValue.none:t.minValue,a=void 0===t.maxValue||null===t.maxValue?b.DateTimeSliderValue.nextYear:t.maxValue,s=a===b.DateTimeSliderValue.today?v.strings.DateTimeSliderToday:t.maxValueLabel,l=this._getDateSliderLabel(t.value,t.minValueLabel),c=!1,d=t.showSeeAllLink&&i,u=0;if(t.options&&0<t.options.length)for(var p=0,m=t.options;p<m.length;p++){if(m[p].checked){u++;c=!0}}0<u&&(l=g.format(v.strings.SectionTitleWithNumber,l,u));d&&(i.filterSectionInfo=t);var h=g.format(v.strings.DateTimeSliderAdditionalHint,t.minValueLabel||v.strings.Oldest,s);return f.createElement("div",{className:"FiltersPane-section FiltersPane-sliderFilterSection","data-automationtype":"FilterSection","data-section-type":t.type,"data-section-key":t.fieldName},f.createElement(S.default,{text:l,showEditButton:t.showEditButton,commandItems:n}),f.createElement("div",{className:"FiltersPane-slider"},f.createElement(_.Slider,{label:l,ariaLabel:l?l+". "+h:h,min:o,max:a,step:1,value:t.value,showValue:!1,onChange:this._onChange,disabled:c}),c&&f.createElement(_.DefaultButton,{className:"FiltersPane-slider-resetButton","data-automationid":"FiltersPane-slider-resetButton",onClick:this._onReset,text:v.strings.ResetButtonLabel}),f.createElement("div",{className:"FiltersPane-slider-bottomLabel"},f.createElement("span",{className:"FiltersPane-slider-minLabel"},t.minValueLabel||v.strings.Oldest),f.createElement("span",{className:"FiltersPane-slider-maxLabel"},s))),f.createElement(y.CheckboxFilterSection,{key:t.fieldName,strings:x.strings,sectionInfo:t,onChange:r,seeAllLinkProps:i,hideSectionHeader:!0}))};t.prototype._onReset=function(){var e=this.props,t=e.sectionInfo;(0,e.onDateCheckboxChange)(t.fieldName,t.fieldType,[],!0);r.Engagement.logData({name:"ResetButton.SmartFiltersPane.Click",isIntentional:!0})};t.prototype._onChange=function(e){var t=this.props,i=t.sectionInfo;(0,t.onChange)(i.fieldName,i.fieldType,e);r.Engagement.logData({name:"DateTimeSlider.SmartFiltersPane.Click",isIntentional:!0})};t.prototype._getDateSliderLabel=function(e,t){var i=this.props.sectionInfo.title;switch(e){case b.DateTimeSliderValue.none:i=t?g.format(v.strings.DateTimeSliderValueDefault,i,t):g.format(v.strings.DateTimeSliderValueDefaultWithNoMinValue,i);break;case b.DateTimeSliderValue.last3Months:i=g.format(v.strings.DateTimeSliderValueLast3Months,i);break;case b.DateTimeSliderValue.last30Days:i=g.format(v.strings.DateTimeSliderValueLast30Days,i);break;case b.DateTimeSliderValue.last7Days:i=g.format(v.strings.DateTimeSliderValueLast7Days,i);break;case b.DateTimeSliderValue.yesterday:i=g.format(v.strings.DateTimeSliderValueYesterday,i);break;case b.DateTimeSliderValue.today:i=g.format(v.strings.DateTimeSliderValueToday,i);break;case b.DateTimeSliderValue.tomorrow:i=g.format(v.strings.DateTimeSliderValueTomorrow,i);break;case b.DateTimeSliderValue.next7Days:i=g.format(v.strings.DateTimeSliderValueNext7Days,i);break;case b.DateTimeSliderValue.next30Days:i=g.format(v.strings.DateTimeSliderValueNext30Days,i);break;case b.DateTimeSliderValue.next3Months:i=g.format(v.strings.DateTimeSliderValueNext3Months,i);break;case b.DateTimeSliderValue.nextYear:i=g.format(v.strings.DateTimeSliderValueNextYear,i)}return i};i.__decorate([_.autobind],t.prototype,"_onReset",null);i.__decorate([_.autobind],t.prototype,"_onChange",null);i.__decorate([_.autobind],t.prototype,"_getDateSliderLabel",null);return t}(f.Component);t.SliderFilterSection=n});define("adu",["c","az"],function(e,t){e.loadStyles([{rawString:".FiltersPane-sliderFilterSection .FiltersPane-sectionFooter{margin-top:8px}.FiltersPane-sliderFilterSection .FiltersPane-section{margin-bottom:0}.FiltersPane-slider-resetButton{position:absolute;bottom:20px}[dir=ltr] .FiltersPane-slider-resetButton{left:calc(50% - 40px)}[dir=rtl] .FiltersPane-slider-resetButton{right:calc(50% - 40px)}.FiltersPane-slider{position:relative;margin-top:4px}.FiltersPane-slider .ms-Slider .ms-Label{display:none}.FiltersPane-slider .ms-Slider-active{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.FiltersPane-slider .ms-Slider-inactive{background:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.FiltersPane-slider .ms-Slider-enabled .ms-Slider-slideBox:active .ms-Slider-active,.FiltersPane-slider .ms-Slider-enabled .ms-Slider-slideBox:hover .ms-Slider-active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.FiltersPane-slider .ms-Slider-enabled .ms-Slider-slideBox:active .ms-Slider-inactive,.FiltersPane-slider .ms-Slider-enabled .ms-Slider-slideBox:hover .ms-Slider-inactive{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.FiltersPane-slider .ms-Slider-enabled .ms-Slider-slideBox:active .ms-Slider-inactive{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.FiltersPane-slider .ms-Slider-disabled .ms-Slider-active{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.FiltersPane-slider .ms-Slider-disabled .ms-Slider-inactive{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}"}])});define("adm",["require","exports","aC","on","aq","adn"],function(i,e,t,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=r.createComponent("ms-filter-select-panel","adn",function(){return new t.default(function(e,t){i(["adn"],e,t)})});n.components.isRegistered(o.tagName)||n.components.register(o.tagName,o);e.default=o});define("adn",["require","exports","ap","at","FK","Bm","E4","adl","dZ","dJ","dc","bX","jG","iE","ado","dn"],function(e,t,r,p,i,m,h,f,g,b,_,v,y,S,x,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._resources=e.hostViewModel.resources;t._columnSchema=e.columnSchema;return t}e.prototype.render=function(){var t=this,e=this.props,i=e.filterSectionInfo,r=e.onComplete,n=e.getFilterSuggestions,o=e.getTaxonomyFilterSectionInfo,a=e.getTaxonomyFieldNextFilteringHierachy,s=this._resources.consume(v.currentView),l={eventScope:this._resources.consume(y.eventScope),pageContext:this._resources.consume(S.pageContext),dataSource:this._resources.consume(g.items),currentView:s&&s.peek(),getIconUrlFromExtension:function(e){return k.getIconUrlFromExtension(t._resources,e,16)}},c=this._resources.consume(_.navigation),d=b.serializeQuery(c.viewParams),u={filterSelect:m.strings,smartFilter:h.strings,checkboxFilterSection:f.strings};return p.createElement(x.FilterSelect,{dependencies:l,strings:u,viewParamsString:d,filterSectionInfo:i,columnSchema:this._columnSchema,onComplete:r,getFilterSuggestions:n,getTaxonomyFilterSectionInfo:o,getTaxonomyFieldNextFilteringHierachy:a,allowRenderHierachySection:!0})};return e}(i.BaseComponent);t.default=n});define("ado",["require","exports","ap","adp"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});define("adp",["require","exports","ap","at","a0","jP","wN","hK","V","bT","aC","Zz","gP","E9","E8","adz","adw","adq"],function(e,t,i,l,o,d,u,x,p,a,s,k,m,C,P,h,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g="SmartFiltersSeeAllPanel",r=function(c){i.__extends(e,c);function e(n){var t=c.call(this,n)||this,o=n.columnSchema,e=n.allowRenderHierachySection;if(!n.filterSectionInfo&&o){var i=n.dependencies.dataSource,a=o.internalName||o.key,r=n.dependencies.currentView,s=r&&r.id,l=void 0;l=4===P.getSectionType(o.fieldType,a)&&n.getTaxonomyFilterSectionInfo&&e?n.getTaxonomyFilterSectionInfo(o).then(function(e){var t=n.dependencies.currentView,i=t?C.getFilter(t,a):void 0;if(i){var r={};r[o.internalName]=o;P.updateSectionInfosCore(n.dependencies,void 0,[e],[i],r,{})}return e}):i.getFilterData(a,n.viewParamsString,s,o.fieldType).then(function(e){return t._getSectionInfoFromFilterDataResponse(e)});t.state={isLoading:!0,showBottomLine:!1,filterSectionInfo:n.filterSectionInfo};l.then(function(e){t.setState({isLoading:!1,showBottomLine:!1,filterSectionInfo:e})})}else t.state={filterSectionInfo:n.filterSectionInfo,isLoading:!1,showBottomLine:!1};return t}e.prototype.componentDidMount=function(){this._events.on(window,"resize",this._sizeScrollRegion);this._sizeScrollRegion()};e.prototype.componentDidUpdate=function(e,t){(t.isLoading&&!this.state.isLoading||t.showBottomLine!==this.state.showBottomLine)&&this._sizeScrollRegion()};e.prototype.render=function(){var e=this.props.strings,t=this.state,i=t.filterSectionInfo,r=t.isLoading,n=t.showBottomLine,o=0;if(!r&&i.options&&i.options.length)for(var a=0,s=i.options;a<s.length;a++){s[a].checked&&o++}return!r&&l.createElement("div",{className:"od-FilterSelect-panel","data-automationid":"FilterSelect"},l.createElement("div",{className:"od-FilterSelect-region"},l.createElement("div",{className:"od-FilterSelect-title"},o?p.format(e.filterSelect.FilterSelectPanelTitleWithNumber,i.title,o):p.format(e.filterSelect.FilterSelectPanelTitle,i.title)),l.createElement("div",{className:"od-FilterSelect-scrollRegion",ref:this._resolveRef("_scrollRegion")},this._renderSection(i)),l.createElement("div",{className:"od-FilterSelect-stickyFooter",ref:this._resolveRef("_stickyFooter")},n&&l.createElement("div",{className:"od-FilterSelect-ruledLine",role:"separator","aria-hidden":"true"}),l.createElement("div",{className:d.css("od-FilterSelect-buttons",{hasRuledLine:n})},l.createElement("span",{className:"FilterSelect-buttonContainer"},l.createElement(u.PrimaryButton,{className:"FilterSelect-button","data-automationid":"FilterSelect-Apply",onClick:this._onApplyButtonClick,ariaDescription:e.filterSelect.ApplyFilterButtonAriaDescription,text:e.filterSelect.ApplyFilterButtonLabel})),l.createElement("span",{className:"FilterSelect-buttonContainer-far"},l.createElement(u.DefaultButton,{className:"FilterSelect-button","data-automationid":"FilterSelect-ClearAll",onClick:this._onClearAllClick,ariaDescription:p.format(e.filterSelect.ClearAllButtonAriaDescription,i.title),text:e.filterSelect.ClearAllButtonLabel}))))))};e.prototype._renderSection=function(e){var t=this.props,i=t.dependencies,r=t.strings;if(4===e.type){var n=e;return l.createElement(f.HierachyFilterSection,{className:"od-FilterSelect-filterSection",key:e.fieldName,sectionInfo:n,onCheckChange:this._onTreeNodeCheckChange,onExpandChange:this._onTreeNodeExpandChange,hideSectionHeader:!0})}var o=e&&(e.fieldType===x.ColumnFieldType.Text||e.fieldType===x.ColumnFieldType.User||e.fieldType===x.ColumnFieldType.Title);return l.createElement(h.CheckboxFilterSection,{ref:this._resolveRef("_checkboxFilterSection"),className:"od-FilterSelect-filterSection",key:e.fieldName,strings:r.checkboxFilterSection,sectionInfo:e,onChange:this._onChange,engagementSource:g,hideSectionHeader:!0,showFilterPicker:o,onResolveSuggestions:this._onResolveSuggestions,onSelectedSuggestionChange:this._onSelectedSuggestionsChange,pageContext:i&&i.pageContext})};e.prototype._sizeScrollRegion=function(){if(this._scrollRegion){var e=window.innerHeight,t=this._scrollRegion.getBoundingClientRect(),i=this._stickyFooter.offsetHeight,r=e-t.top-i,n=!1;this._scrollRegion.style.maxHeight=r.toString()+"px";t.bottom-t.top>r&&(n=!0);this.state.showBottomLine!==n&&this.setState({showBottomLine:n})}};e.prototype._onResolveSuggestions=function(e,t,i,r){var n=this.props.getFilterSuggestions;return n?n(e,t,i):s.default.resolve([])};e.prototype._onSelectedSuggestionsChange=function(e,t,i){var r=this,n=this.state.filterSectionInfo;if(i){var o,a=n,s=-1;if(a.fieldName===e){for(var l=0;l<a.options.length;l++){var c=a.options[l];if(i.key===c.key||i.values[0]===c.values[0]){(o=c).checked=!0;s=l;break}}if(!o){i.checked=!0;a.options.push(i);s=a.options.length-1}this.setState({filterSectionInfo:a},function(){r._checkboxFilterSection.resetFocus(s)})}}};e.prototype._onChange=function(e,t,i){for(var r=this.state.filterSectionInfo,n=0,o=r.options;n<o.length;n++){for(var a=o[n],s=!1,l=0,c=a.values;l<c.length;l++){var d=c[l];if(0<=i.indexOf(d)){s=!0;break}}a.checked=s}this.setState({filterSectionInfo:r})};e.prototype._onApplyButtonClick=function(){var e=this.props,t=e.onComplete,i=e.dependencies,r=this.state.filterSectionInfo;t&&t(r);i&&i.eventScope&&a.default.raise(i.eventScope,m.FiltersPaneEvents.applyPanel,r);var n=p.format("ApplyButton.{0}.Click",g);o.Engagement.logData({name:n})};e.prototype._onClearAllClick=function(){for(var e=this.state.filterSectionInfo,t=0,i=e.options;t<i.length;t++){i[t].checked=!1}if(4===e.type){var r=e;r.checkedKeys=[];r.checkedValues=[]}this.setState({filterSectionInfo:e});var n=p.format("ClearAllButton.{0}.Click",g);o.Engagement.logData({name:n})};e.prototype._getSectionInfoFromFilterDataResponse=function(e){for(var t,i=this.props,r=i.columnSchema,n=i.dependencies,o=i.strings,a=r.internalName||r.key,s=r.fieldType,l=n.currentView,c=k.default.getFilterData(e,a),d=[],u=l?C.getFilter(l,a):void 0,p=u&&u.values,m={},h=0,f=c;h<f.length;h++){var g=f[h];if(r.isCalculated){var b=g.value&&g.value.indexOf("_");0<b&&(g.value=g.value.substring(b+1))}var _={getIconUrlFromExtension:n.getIconUrlFromExtension},v=P.getFilterOptionCore(_,o.smartFilter,s,g.display,g.value);if(p&&0<v.values.length){var y=v.values[0];-1<p.indexOf(y)&&(v.checked=!0)}if(!m[v.key]){d.push(v);m[v.key]={count:1,option:v}}}if(s===x.ColumnFieldType.DateTime)(t=P.getNewDateTimeFilterSectionInfo(a,r.id,s,r.name,m)).options=d;else{var S=P.getSectionType(s,a);4===S&&(S=3);t={fieldName:a,fieldId:r.id,fieldType:s,type:P.getSectionType(s,a),serverFieldType:r.isCalculated&&r.resultType?r.resultType:r.serverFieldType,title:P.getSectionTitleCore(o.smartFilter,s,r.name),options:d}}return t};e.prototype._onTreeNodeExpandChange=function(e,n,t,i){var o=this,r=this.props.getTaxonomyFieldNextFilteringHierachy,a=this.state.filterSectionInfo,s=a;s.expandedKeys=i;t&&r?r(a.fieldId,n.key).then(function(e){n.children=e;if(0<=s.checkedKeys.indexOf(n.key))for(var t=0,i=e;t<i.length;t++){var r=i[t];-1===s.checkedKeys.indexOf(r.key)&&s.checkedKeys.push(r.key)}o.setState({filterSectionInfo:a})}):this.setState({filterSectionInfo:a})};e.prototype._onTreeNodeCheckChange=function(e,t,i,r){var n=this.state.filterSectionInfo,o=n;o.checkedKeys=r;o.checkedValues=i;this.setState({filterSectionInfo:n})};i.__decorate([d.autobind],e.prototype,"_renderSection",null);i.__decorate([d.autobind],e.prototype,"_sizeScrollRegion",null);i.__decorate([d.autobind],e.prototype,"_onResolveSuggestions",null);i.__decorate([d.autobind],e.prototype,"_onSelectedSuggestionsChange",null);i.__decorate([d.autobind],e.prototype,"_onChange",null);i.__decorate([d.autobind],e.prototype,"_onApplyButtonClick",null);i.__decorate([d.autobind],e.prototype,"_onClearAllClick",null);i.__decorate([d.autobind],e.prototype,"_getSectionInfoFromFilterDataResponse",null);i.__decorate([d.autobind],e.prototype,"_onTreeNodeExpandChange",null);i.__decorate([d.autobind],e.prototype,"_onTreeNodeCheckChange",null);return e}(d.BaseComponent);t.FilterSelect=r});define("adq",["require","exports","c","az"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".od-FilterSelect-panel{position:absolute;top:0;height:100%;width:100%;overflow:hidden}[dir=ltr] .od-FilterSelect-panel{left:0}[dir=rtl] .od-FilterSelect-panel{right:0}.od-FilterSelect-panel .od-FilterSelect-region{padding-top:70px}.od-FilterSelect-panel .od-FilterSelect-title{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;cursor:default;font-size:21px;font-weight:100}[dir=ltr] .od-FilterSelect-panel .od-FilterSelect-title{padding-left:40px}[dir=rtl] .od-FilterSelect-panel .od-FilterSelect-title{padding-right:40px}.od-FilterSelect-panel .od-FilterSelect-scrollRegion{overflow-y:auto;overflow-x:hidden}.od-FilterSelect-panel .od-FilterSelect-ruledLine{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-FilterSelect-panel .od-FilterSelect-buttons{padding:11px 40px 20px;display:-ms-flexbox;display:flex}.od-FilterSelect-panel .od-FilterSelect-buttons.hasRuledLine{padding:20px 40px}.od-FilterSelect-panel .od-FilterSelect-filterSection{margin-bottom:0;padding:0 40px}.od-FilterSelect-panel .FiltersPane-sectionContent{margin-top:12px;font-size:12px}[dir=ltr] .od-FilterSelect-panel .FilterSelect-buttonContainer-far{padding-left:8px}[dir=rtl] .od-FilterSelect-panel .FilterSelect-buttonContainer-far{padding-right:8px}.od-FilterSelect-panel .ms-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}])});define("adh",[],function(){return"\x3c!--ko component: { name: 'od-transclusion-content', params: infoPaneTransclusionContentParams }--\x3e<div data-bind=\"component: filtersPaneComponent\"></div>\x3c!--/ko--\x3e"});define("ada",["require","exports","ap","aC","bN","ci","adb","dm","aI","dI"],function(e,t,i,r,n,o,a,s,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=s.strings,u=function(t){i.__extends(e,t);function e(e){void 0===e&&(e={});return t.call(this,e)||this}e.prototype.execute=function(){return this.resources.consume(o.resourceKey).requestDialog({title:d.keyboardShortcutsTitle,size:"Large",component:{name:a.default.tagName,params:{}},actions:[{name:d.ok,icon:new c.default("Cancel"),isDefault:!0,execute:function(){return r.default.wrap(2)}}]}).wait().then(function(){return{resultType:l.ResultTypeEnum.Success}})};return e}(n.default);t.default=u});define("adb",["require","exports","ade","b5","add","adc"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-keyboard-map",template:e("add"),viewModel:i.default});t.default=n});define("ade",["require","exports","ap","bF","adf","by"],function(e,t,i,r,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.strings=n.strings;var i=t.resources.consume(o.platformDetection);t.isMac=i.isMac;t.isPC=!i.isMac;return t}return e}(r.default);t.default=a});define("add",[],function(){return"<div class=od-KeyboardMap-group><ul class=od-KeyboardMap-table><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.arrowsDesc + '; ' + strings.arrowsAria + '; ' }\"><span class=od-KeyboardMap-key>&uarr; &darr; &larr; &rarr;</span> <span class=od-KeyboardMap-val data-bind=\"text: strings.arrowsDesc\"></span></li>\x3c!--ko if: isMac--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.selectAllDesc + '; ' + strings.selectAllMacAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.selectAllMacKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.selectAllDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isPC--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.selectAllDesc + '; ' + strings.selectAllPCAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.selectAllPCKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.selectAllDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isMac--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deselectAllDesc + '; ' + strings.deselectAllMacAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deselectAllMacKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deselectAllDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isPC--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deselectAllDesc + '; ' + strings.deselectAllPCAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deselectAllPCKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deselectAllDesc\"></span></li>\x3c!--/ko--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.escDesc + '; ' + strings.escAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.escKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.escDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.spaceDesc + '; ' + strings.spaceKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.spaceKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.spaceDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.enterDesc + '; ' + strings.enterKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.enterKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.enterDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.altUpDesc + '; ' + strings.altUpAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.altUpKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.altUpDesc\"></span></li></ul></div><div class=od-KeyboardMap-group><ul class=od-KeyboardMap-table><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.renameDesc + '; ' + strings.renameKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.renameKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.renameDesc\"></span></li>\x3c!--ko if: isMac--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deleteDesc + '; ' + strings.deleteMacAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deleteMacKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deleteDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isPC--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deleteDesc + '; ' + strings.deletePCKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deletePCKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deleteDesc\"></span></li>\x3c!--/ko--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.toggleInfoDesc + '; ' + strings.toggleInfoKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.toggleInfoKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.toggleInfoDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.showKeymapDesc + '; ' + strings.showKeymapAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.showKeymapKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.showKeymapDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.showSearchDesc + '; ' + strings.showSearchAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.showSearchKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.showSearchDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.showShareDesc + '; ' + strings.showShareKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.showShareKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.showShareDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.openContextualMenuDesc + '; ' + strings.openContextualMenuKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.openContextualMenuKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.openContextualMenuDesc\"></span></li></ul></div>"});define("adc",["c","az"],function(e,t){e.loadStyles([{rawString:".od-KeyboardMap-group{display:inline-block;width:50%;min-width:200px;font-size:12px;vertical-align:top}.od-KeyboardMap-table{display:table;list-style:none;margin:0;padding:0}.od-KeyboardMap-row{display:table-row}.od-KeyboardMap-row span{display:table-cell}.od-KeyboardMap-key{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";min-width:55px}.od-KeyboardMap-val{padding:4px 8px}"}])});define("acu",["require","exports","ap","cE","aI","bN","bX","dZ","ac5","acv","ci","eO","lB","aC","DL","ig","kL","ba","eX"],function(e,t,i,d,u,r,p,h,f,g,b,_,v,y,S,x,k,C,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(m){i.__extends(e,m);function e(e){var t=m.call(this,e)||this;t.canFallbackToParent=!1;t.canToggleEditInline=!1;t.hideInviteOptions=!1;t.isSingleSelectAction=!0;t.requireSignInByDefault=!0;var i=e.actionName,r=void 0===i?null:i,n=e.item,o=void 0===n?null:n,a=e.itemKey,s=void 0===a?null:a,l=e.selectionHelper,c=void 0===l?null:l,d=e.sharingMethod,u=void 0===d?null:d;t._selectionHelper=c;t.name=r;t.sharingMethod=u;if(o&&o())t._itemPromise=y.default.wrap([o()]);else if(s){var p=t.resources.consume(P.resourceKey);t._itemPromise=p.getSpecifiedItems({itemKeys:[s],recurseInFolders:!0}).then(function(e){return e.children})}t.urlDataSource=t.resources.consume(h.url);return t}e.prototype.execute=function(){var r=this;C.isOneDrive&&this.trackPromise(this.resources.consumeAsync(k.resourceKey).then(function(e){var t=r._selectionHelper.selection.peek(),i=t&&t.length&&r.peekUnwrapObservable(t[0]);e.fireShareEvent(i)}));for(var n=2===this.sharingMethod?f.default.tagName:g.default.tagName,o=this.resources.consume(b.resourceKey),a=this.observables.create(""),s=[],e=0;e<this._selectionHelper.selection().length;e++){var t=this._selectionHelper.selection()[e];s.push(t())}var i=this._itemPromise,l=!1;if(!i){i=y.default.wrap(s);l=!0}if(!l)var c=o.requestDialog({title:S.strings.ShareText,size:"Medium",component:{name:v.default.tagName,params:{}}});return i.then(function(e){c&&c.dismiss();if(!e[0])return y.default.wrapError({resultType:u.ResultTypeEnum.Failure,resultCode:"ItemNotFound"});x.default.isShortcutItem(e[0])&&r.resources.consume(d.resourceKey).logData({name:"ShortcutLink.ShareByLinkInitiate"});var t=o.requestDialog({title:a,size:"Medium",component:{name:n,params:{items:e,dialogTitle:a,onExecuteAction:function(){return t.state(2)},sharingMethod:r.sharingMethod}}}),i=r.subscribe(r.resources.consume(p.currentItemSet),function(){t.dismiss()});return t.wait().then(function(){i.dispose();var e={},t={count:s.length};if(1===s.length){e.fileType=_.default[s[0].type];e.extension=s[0].extension||""}return{resultType:u.ResultTypeEnum.Success,extraData:e,extraMetrics:t}},function(e){i.dispose();return y.default.wrapError(e)})})};return e}(r.default);t.default=n});define("ac5",["require","exports","ac8","b5","ac7","ac6"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-email-link",template:e("ac7"),viewModel:i.default,synchronous:!0});t.default=n});define("ac8",["require","exports","ap","cE","ac9","Or","V","dZ","ba","eX","qY","DI","yk","eO","lB","qT","XU","acY","acA","acI","bF"],function(e,t,i,r,l,n,o,c,a,d,u,p,m,h,f,g,b,_,v,y,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this;t.loadingSpinnerTagName=f.default.tagName;t.panelHostTagName=g.default.tagName;t.peoplePickerTagName=b.default.tagName;t.sharingHintsTagName=_.default.tagName;t.sharingTipsTagName=y.default.tagName;var i=e.dialogTitle,r=e.items,n=e.onExecuteAction,o=e.sharingMethod;t._dialogTitle=i;t._items=r;t._onExecuteAction=n;t._sharingMethod=o;t._itemProvider=t.resources.consume(d.resourceKey);t.resources.bind(u.resourceKey);t._panelProvider=t.resources.consume(u.resourceKey);t._policyTipDataSource=t.resources.consume(c.policyTip);t._sharingProvider=t.resources.consume(p.resourceKey);t._suiteNavProvider=t.resources.consume(m.resourceKey);t.canCurrentUserShareExternally=t.createObservable(!1);t.canSendEmail=t.createObservable(!1);t.charCountText=t.createObservable("");t.charLimitReached=t.createObservable(!1);t.charLimitVisible=t.createObservable(!1);t.currentSharingLink=t.createObservable(null);t.emailInputPlaceholder=l.strings.EmailPlaceholder;t.emailInputText=t.createObservable("");t.error=t.createObservable("");t.hasLinkInfo=t.createObservable(!1);t.hasNote=t.createObservable(!1);t.isLoading=t.createObservable(!0);t.newExpirationInDays=t.observables.create(30);t.newRole=t.observables.create(null);t.newType=t.observables.create(null);t.note=t.createObservable("");t.policyTipInfo=t.createObservable(null);t.ppResultHasUnresolvedText=t.observables.create(!1);t.ppResultSelectedPeople=t.observables.create([]);t.ppResultSelectedPeopleContainsExternal=t.observables.create(!1);t.shareButtonText=l.strings.ShareButtonText;t.switchLinksTitle=l.strings.ChangeLinkTitle;var a=t._items[0].key;t.item=t._itemProvider.getItemSync({parentKey:a}).item;t._companyDisplayName=t.createObservable("");t._emailCharLimit=-1;t._hasOutlook=t.createObservable(!1);t._isDoneGettingSharingSettings=t.createObservable(!1);t._missingItemError=t._items[0].type===h.default.Folder?l.strings.MissingFolderError:l.strings.MissingFileError;t._missingItemErrorTitle=t._items[0].type===h.default.Folder?l.strings.MissingFolderTitle:l.strings.MissingFileTitle;t._peopleSharingWith=t.createObservable([]);t._sharingLinksCollection=t.createObservable([]);t._sharingSettings=t.observables.create(null);t._linkType=t.createPureComputed(t._computeLinkType);t._referenceRevision=t.createPureComputed(function(){return t.item().revision});t._requireSignIn=t.createComputed(t._computeRequireSignIn);t._roleSelection=t.createComputed(t._computeRoleSelection);t.createBackgroundComputed(t._refreshSharingSettings);t.createComputed(t._computeValidateMessageLength);t.policyTipType=t.createPureComputed(t._computePolicyTipType);t.ppQueryParams=t.createPureComputed(t._computePeoplePickerQueryParams);t.ppQueryParamsBlockViaPolicy=t.createPureComputed(t._computeBlockViaPolicy);t.shareAvailable=t.createComputed(t._computeShareAvailable);t.sharingHintsParams=t.createPureComputed(t._computeSharingHintsParams);t.sharingHintText=t.createComputed(t._computeSharingHintText);t.sharingPermissionsParams=t.createPureComputed(t._computeSharingPermissionsParams);t.sharingTipsParams=t.createComputed(t._computeSharingTipsParams);t._getSuiteNavData();t._getSharingInfo(!(!t.ppQueryParamsBlockViaPolicy||!t.ppQueryParamsBlockViaPolicy.peek()));t._checkForSpecialFolder();return t}e.prototype.closePanel=function(){this._panel.state(1)};e.prototype.onShareClicked=function(){var e=this.resources.consume(p.resourceKey),t={items:[this.item.peek()],roleValue:this._roleSelection.peek(),message:this.emailInputText.peek(),sendEmail:!0,requireSignIn:this._requireSignIn.peek(),propagateSharing:!0,linkType:this._linkType.peek(),expiration:this.currentSharingLink.peek().expiration};this.resources.consume(r.resourceKey).logData({name:"Share.SharingDialog.Click",isIntentional:!0});e.share(this.peoplePickerParams.selectedPeople.peek(),t);this._onExecuteAction()};e.prototype.switchLinks=function(){var d=this;this._panel=this._panelProvider.requestPanel({component:{name:v.default.tagName,params:this.sharingPermissionsParams},noTitle:!0});this._panel.wait().then(function(){var e=d.newType.peek(),t=d.newRole.peek();d.newType(null);d.newRole(null);if(null!==e||null!==t){var i=e,r=t,n=d.newExpirationInDays.peek(),o=void 0;if(!(0<i&&i<10)){i=d.currentSharingLink.peek().type;r=d.currentSharingLink.peek().role;o=d.currentSharingLink.peek().expiration}if(n){for(var a=void 0,s=0;s<d._sharingLinksCollection.peek().length;s++){var l=d._sharingLinksCollection.peek()[s];if(l.role===r&&l.type===i){a=l;break}}var c=a.expiration;o=d._calculateDays(c)===n?c:d._calculateLinkExpiration(1440*n)}d.currentSharingLink({role:r,type:i,url:"",expiration:o,supportsExpiration:!!o})}})};e.prototype._calculateDays=function(e){var t=new Date(e),i=new Date;return Math.round((t.getTime()-i.getTime())/864e5)};e.prototype._calculateLinkExpiration=function(e){if(0<e){var t=new Date;t.setUTCMinutes(t.getUTCMinutes()+e);return t.toString()}return null};e.prototype._checkForSpecialFolder=function(){this._items[0].isSpecialFolder&&this.note(l.strings.SpecialFolderNote)};e.prototype._computeLinkType=function(){var e=this.currentSharingLink();if(e)return e.type};e.prototype._computeRequireSignIn=function(){if(this.currentSharingLink()){var e=this.currentSharingLink();return 6!==e.type&&5!==e.type}};e.prototype._computePolicyTipType=function(){var e=this.item();if(e)return e.policyTip};e.prototype._computeBlockViaPolicy=function(){if(!a.isFeatureEnabled(a.PolicyTipPanel))return!1;var e=this.policyTipType();return e?4===e:void 0};e.prototype._computeSharingHintsParams=function(){var e=this.item();if(e)return{guestLinkExists:this.createObservable(!1),sharingHintsOption:0,items:[e]}};e.prototype._computeSharingPermissionsParams=function(){if(this._isDoneGettingSharingSettings()){var e=this.item();if(e)return{item:e,whoCanAccessOptions:this._getWhoCanAccessThisLinkOptions(this._sharingSettings()),currentSharingLink:this.currentSharingLink,newType:this.newType,newRole:this.newRole,expirationRequired:this._enforceRequiredAnonymousLinkExpiration,maxExpirationInDays:this._adminRequiredAnonymousLinkExpirationInDays,newExpirationInDays:this.newExpirationInDays,peoplePickerParams:this.peoplePickerParams,closePanel:this.closePanel.bind(this),sharingHintText:n.getSharingInfoText(this._peopleSharingWith()),sharingMethod:this._sharingMethod,canManageReadWriteLink:this._sharingSettings().canManageReadWriteLink,canManageOrganizationalReadWriteLink:this._sharingSettings().canManageOrganizationalReadWriteLink,sharingLinks:this._sharingLinksCollection.peek(),blockPeoplePickerAndSharing:this._sharingSettings().blockPeoplePickerAndSharing}}};e.prototype._computeRoleSelection=function(){if(this.currentSharingLink()){return this.currentSharingLink().role.toString()}};e.prototype._computeShareAvailable=function(){if(!this._isDoneGettingSharingSettings())return!1;if(this.peoplePickerParams.hasUnresolvedText&&this.peoplePickerParams.hasUnresolvedText())return!1;if(a.isFeatureEnabled(a.PolicyTipPanel)&&!this.canCurrentUserShareExternally()&&this.peoplePickerParams.selectedPeopleContainsExternal())return!1;for(var e=0,t=this.peoplePickerParams.selectedPeople();e<t.length;e++){if(!t[e].isResolved)return!1}this._emailCharLimit=this._mailSettings&&this._mailSettings.defaultCharacterLimit;this._evaluateMessageLength(this.emailInputText.peek());return!this.charLimitReached()&&0<this.peoplePickerParams.selectedPeople().length};e.prototype._computeSharingHintText=function(){if(this._isDoneGettingSharingSettings())return n.getLinkHintText(this.currentSharingLink(),this._companyDisplayName(),this._peopleSharingWith(),this._sharingMethod)};e.prototype._computeSharingTipsParams=function(){if(this._isDoneGettingSharingSettings()){return{selectedPeople:this.peoplePickerParams.selectedPeople,showAdditionalSharingWarning:this.showExternalUserWarning,policyTipType:this.policyTipType(),policyTipInfo:this.policyTipInfo,item:this.item()}}};e.prototype._computeValidateMessageLength=function(){var e=this.emailInputText();this._evaluateMessageLength(e)};e.prototype._evaluateMessageLength=function(e){var t=this._getEncodedMessageLength(e),i=this._emailCharLimit;if(9999999999!==i){!this.charLimitVisible.peek()&&t&&i-100<t&&this.charLimitVisible(!0);if(this.charLimitVisible.peek()){this.charCountText(o.format(l.strings.CharacterCounterFormat,t,i));i<t?this.charLimitReached(!0):this.charLimitReached.peek()&&this.charLimitReached(!1)}}else{this.charLimitVisible(!1);this.charLimitReached(!1)}};e.prototype._getBestSharingLink=function(e){var t=this;this.isReady=e.getBestSharingLink(this._defaultSharingLinkType).then(function(e){if(e){2!==e.role&&1!==e.role&&(e.role=2);t.currentSharingLink.peek()||t.currentSharingLink(e);t.hasLinkInfo(!0)}},function(e){t.error(l.strings.ServerError)})};e.prototype._getEncodedMessageLength=function(e){var t=0,i=e.length,r=0,n=!1;if(!e||0===e.length)return 0;for(var o="&#160;",a="<br />",s="&quot;&quot;&quot;",l="&amp;",c="&#39;",d="&lt;",u="&gt;",p=" ";r<i;){var m=null,h=e[r];if(" "===h)m=r+1<i&&" "===e[r+1]||n?o:" ";else if("\n"===h){m=a;n=!0}else{'"'===h?m=s:"&"===h?m=l:"'"===h?m=c:"<"===h?m=d:">"===h?m=u:"\r"===h&&(m=p);n=!1}t+=null!==m?m.length:1;r++}return t};e.prototype._getPolicyTip=function(){var t=this;this.policyTipType||this.policyTipInfo(null);this._policyTipDataSource.getPolicyTip(this.item()).done(function(e){e&&e.issueDescriptions&&e.issueDescriptions.length&&t.policyTipInfo(e)})};e.prototype._getSuiteNavData=function(){var i=this;this._suiteNavProvider&&this._suiteNavProvider.loadData().then(function(e){i._companyDisplayName(e.CompanyDisplayName);try{var t=JSON.parse(e.ClientData);i._hasOutlook(t.HasEXOLicense||!1)}catch(e){i._hasOutlook(!1)}})};e.prototype._getSharingLinks=function(e){var t=this;e.getLinks().then(function(e){null!=e&&t._sharingLinksCollection(e.filter(function(e){return e.item.id===t.item().id}))},function(e){t.error(l.strings.ServerError);t.isLoading(!1)})};e.prototype._getSharingInfo=function(e){var t=this,i=this._sharingProvider.getSharingData(this.item.peek(),e);this._getSharingSettings(i).then(function(){t._getSharingLinks(i);t._getBestSharingLink(i);t._getPolicyTip()})};e.prototype._computePeoplePickerQueryParams=function(){var e=this._sharingSettings();if(e){var t={maximumEntitySuggestions:30,blockViaPolicy:this.ppQueryParamsBlockViaPolicy()},i=e.pickerProperties;if(i){t.principalSource=i.PrincipalSource;t.principalType=i.PrincipalAccountType;t.querySettings=i.QuerySettings;var r=this._linkType();if(this.ppQueryParamsBlockViaPolicy()&&9!==r){t.allowEmailAddresses=i.AllowEmailAddresses;t.filterExternalUsers=!1}else{t.allowEmailAddresses=i.AllowEmailAddresses&&9!==r;t.filterExternalUsers=9===r}}return t}};e.prototype._getSharingSettings=function(e){var i=this;return this.isReady=e.getSettings().then(function(e){i._sharingSettings(e);if(e.itemId){var t=i.item().name;i._dialogTitle(o.format(l.strings.TitleText,t));if(e.blockPeoplePickerAndSharing){i.error(l.strings.CannotShareText);i.isLoading(!1)}else{i._adminRequiredAnonymousLinkExpirationInDays=e.requiredAnonymousLinkExpirationInDays;i._defaultSharingLinkType=e.defaultLinkType;i._enforceRequiredAnonymousLinkExpiration=0<Number(e.requiredAnonymousLinkExpirationInDays);i._mailSettings=e.mailSettings;i._peopleSharingWith(e.sharedWith);i.canCurrentUserShareExternally(e.canCurrentUserShareExternally);i.canSendEmail(e.canSendEmail);i.showExternalUserWarning=e.showAdditionalExternalWarning;0<i._adminRequiredAnonymousLinkExpirationInDays&&i.newExpirationInDays(i._adminRequiredAnonymousLinkExpirationInDays);i.peoplePickerParams={selectedPeople:i.ppResultSelectedPeople,selectedPeopleContainsExternal:i.ppResultSelectedPeopleContainsExternal,peoplePickerQueryParams:i.ppQueryParams,contactInviteLimit:e.contactInviteLimit,hasUnresolvedText:i.ppResultHasUnresolvedText,currentSharingLink:i.currentSharingLink};i._isDoneGettingSharingSettings(!0);i.isLoading(!1)}}else{i._dialogTitle(i._missingItemErrorTitle);i.error(i._missingItemError);i.isLoading(!1)}},function(e){e&&403===e.status?i.error(l.strings.AccessDenied):i.error(l.strings.ServerError);i._isDoneGettingSharingSettings(!0);i.isLoading(!1)})};e.prototype._getWhoCanAccessThisLinkOptions=function(e){return n.getWhoCanAccessLinkOptions(e,this._companyDisplayName(),this._sharingMethod)};e.prototype._refreshSharingSettings=function(){var t=this;this._referenceRevision()&&this._itemProvider.getItem({parentKey:this.item.peek().key,skipCache:!0,skipInMemoryCache:!0}).then(function(e){t._getSharingInfo(!0)})};return e}(s.default);t.default=S});define("acA",["require","exports","acH","b5","acG","acF","acB"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-sharing-permissions",template:e("acG"),viewModel:i.default});t.default=n});define("acH",["require","exports","ap","Bk","acX","acW","gz","V","dZ","acS","a0","ba","qY","bF","aq","XU","O1","OY","d7","acI","OX"],function(e,t,r,n,o,a,s,l,c,d,u,p,m,i,h,f,g,b,_,v,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.peoplePickerTagName=f.default.tagName;t.sharingTipsTagName=v.default.tagName;t._closePanel=e.closePanel;t._currentSharingLink=e.currentSharingLink;t._item=e.item;t._options=e.whoCanAccessOptions;t._currentTypeInDropdown=e.currentTypeInDropdown||t.createObservable(t._currentSharingLink.peek().type);t._canManageReadWriteLink=e.canManageReadWriteLink;t._canManageOrganizationalReadWriteLink=e.canManageOrganizationalReadWriteLink;t._sharingLinks=e.sharingLinks;t._blockPeoplePickerAndSharing=e.blockPeoplePickerAndSharing;t.resources.bind(m.resourceKey);t._panelProvider=t.resources.consume(m.resourceKey);t.title=o.strings.PanelTitle;t.subTitle=t._item.name;t.daysLabel=o.strings.DaysLabel;t.okayButtonText=o.strings.OkayButtonLabel;t.cancelButtonText=o.strings.CancelButtonLabel;t.dropdownFormTag=d.default.tagName;t.dropdownFieldParams={options:h.observableArray(t._options.map(function(e){return e.text})),selectedOption:h.observable(t._getSelectedDropdownItem()),label:h.observable(o.strings.WhoCanAccess)};t.allowEditText=o.strings.AllowEdit;t.allowEditChecked=h.observable(2===t._currentSharingLink().role);t.linkExpiresChecked=h.observable(e.expirationRequired);t.isExpiryVisible=t.createPureComputed(t._computeIsExpiryVisible);t.linkExpiresText=o.strings.LinkExpires;t.errorMessage=h.observable("");t._newType=e.newType;t._newRole=e.newRole;t.expirationRequired=e.expirationRequired;t.newExpirationInDays=e.newExpirationInDays;t._maxExpirationInDays=e.maxExpirationInDays;t.infoBarParams={type:h.observable(0),infoText:h.observable(o.strings.SecurityPolicyInformationText)};t.existingUserInfoBarParams={type:h.observable(0),infoText:h.observable(e.sharingHintText)};t._hasSharingHintText=!!e.sharingHintText;t.isSecurityPoliciesPreventingInfoBarVisible=t.createPureComputed(t._computeShowSecurityPolicyWarning);t.isExistingUserPermissionsBarVisible=t.createPureComputed(t._computeIsExistingUserPermissionsBarVisible);t._instrumentationProvider=t.resources.consume(_.instrumentation);t.policyTipMessageBarTagName=g.default.tagName;t.policyTipMessageBarParams={item:t._item,onClick:t.onViewPolicyTipClick.bind(t)};t.isPolicyTipPanelEnabled=p.isFeatureEnabled(p.PolicyTipPanel);t.hasPolicyTipResponse=t.createObservable(!1);t._policyTipDataSource=t.resources.consume(c.policyTip);t._policyTipType=t._item.policyTip;t._policyTipInfo=t.createObservable(null);t._policyTipBlocksSharing=y.isPolicyTipFlagSet(t._policyTipType,4);t.showPolicyTipMessageBar=t.isPolicyTipPanelEnabled&&t._policyTipBlocksSharing;t._policyTipBlocksSharing&&t._policyTipDataSource.getPolicyTip(t._item).done(function(e){t.hasPolicyTipResponse(!0);e&&e.issueDescriptions&&e.issueDescriptions.length&&t._policyTipInfo(e)},function(){t.hasPolicyTipResponse(!0)});t.peoplePickerParams=e.peoplePickerParams;t.isPeoplePickerVisible=t.createPureComputed(t._computeIsPeoplePickerVisible);t.sharingTipsParams={selectedPeople:t.peoplePickerParams.selectedPeople,showAdditionalSharingWarning:!1,showPolicyTip:!1};u.default.logData({name:a.UsageName[2===e.sharingMethod?a.UsageName.SharingDialogOpenPermissionsPaneEmailLink:a.UsageName.SharingDialogOpenPermissionsPaneGetLink],location:a.LocationName[a.LocationName.SharingDialog],usageType:s.UsageType[s.UsageType.Click],currentPage:t._instrumentationProvider.currentPageName(),previousPage:t._instrumentationProvider.previousPageName()});t.createComputed(t._computeCurrentTypeInDropdown);t.isAllowEditLocked=t.createComputed(t._computeIsEditLocked);t.shareAvailable=t.createComputed(t._computeShareAvailable);t.createComputed(t._computeExpiration);return t}e.prototype.onViewPolicyTipClick=function(){var e={item:this._item,policyTipInfo:this._policyTipInfo()};this._panelProvider.requestPanel({component:{name:b.default.tagName,params:e}})};e.prototype.updateLink=function(){this._newType(this._getNewType());this._newRole(this._getNewRole());6===this._newType()&&1===this._newRole()&&this._newType(5);this.isExpiryVisible()&&this.linkExpiresChecked()||this.newExpirationInDays(null);this._closePanel()};e.prototype.closePermissionsPanel=function(){this._closePanel()};e.prototype._calculateDays=function(e){var t=new Date(e),i=new Date;return Math.round((t.getTime()-i.getTime())/864e5)};e.prototype._computeCurrentTypeInDropdown=function(){this.dropdownFieldParams.selectedOption()&&this._currentTypeInDropdown&&this._currentTypeInDropdown(this._getNewType())};e.prototype._computeExpiration=function(){var e=this._currentTypeInDropdown(),t=this.allowEditChecked(),i=this._maxExpirationInDays;if(6===e){for(var r=t?2:1,n=t?6:5,o=void 0,a=0;a<this._sharingLinks.length;a++){var s=this._sharingLinks[a];if(s.role===r&&s.type===n){o=s;break}}var l=o&&o.expiration;l&&(i=this._calculateDays(l))}this.newExpirationInDays(i)};e.prototype._computeIsEditLocked=function(){if(this.dropdownFieldParams.selectedOption()){var e=this._getNewType();if(6===e){for(var t=!1,i=0;i<this._sharingLinks.length;i++){var r=this._sharingLinks[i];if(6===r.type&&2===r.role){t=!0;break}}if(this._canManageReadWriteLink&&t)return!1;this.allowEditChecked(!1);return!0}if(9===e){if(this._canManageOrganizationalReadWriteLink)return!1;this.allowEditChecked(!1);return!0}return!1}return!1};e.prototype._computeShareAvailable=function(){if(this.linkExpiresChecked()&&this.isExpiryVisible()){var e=this.newExpirationInDays().toString(),t=void 0,i=e.match(/^-?[0-9]+/);if(i&&i[0]!==e||!i){this.errorMessage(o.strings.ValidNumberValueErrorMessage);return!1}if((t=Number(e))<=0){this.errorMessage(o.strings.NegativeDayValueErrorMessage);return!1}if(this.expirationRequired&&this._maxExpirationInDays<t){this.errorMessage(l.format(o.strings.MaxExpirationDaysErrorMessage,this._maxExpirationInDays));return!1}this.errorMessage("");return!0}if(!this._computeIsPeoplePickerVisible())return!0;for(var r=0,n=this.peoplePickerParams.selectedPeople();r<n.length;r++){if(!n[r].isResolved)return!1}return(!this.peoplePickerParams.hasUnresolvedText||!this.peoplePickerParams.hasUnresolvedText())&&!(p.isFeatureEnabled(p.PolicyTipPanel)&&this._policyTipBlocksSharing&&this.peoplePickerParams.selectedPeopleContainsExternal())};e.prototype._computeIsPeoplePickerVisible=function(){return this.dropdownFieldParams.selectedOption()===n.strings.SpecificPeopleOptionText&&!this._blockPeoplePickerAndSharing};e.prototype._computeShowSecurityPolicyWarning=function(){var e=this.isExpiryVisible();return this.expirationRequired&&e||this.isAllowEditLocked()};e.prototype._computeIsExistingUserPermissionsBarVisible=function(){var e=this.dropdownFieldParams.selectedOption();return this._hasSharingHintText&&(e===n.strings.SpecificPeopleOptionText||e===n.strings.ToLineOptionText)};e.prototype._getSelectedDropdownItem=function(){for(var e=0;e<this._options.length;e++){var t=this._options[e];if(t.type===this._currentSharingLink().type||6===t.type&&5===this._currentSharingLink().type)return t.text}};e.prototype._getNewType=function(){switch(this.dropdownFieldParams.selectedOption.peek()){case n.strings.SpecificPeopleOptionText:case n.strings.ToLineOptionText:return 8;case n.strings.AnonymousOptionText:return 6;case n.strings.UnnamedOrganizationOptionText:default:return 9}};e.prototype._getNewRole=function(){return this.allowEditChecked()?2:1};e.prototype._computeIsExpiryVisible=function(){switch(this.dropdownFieldParams.selectedOption()){case n.strings.AnonymousOptionText:return!0}return!1};return e}(i.default);t.default=S});define("acW",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.SharingDialogEnterEmailLink=1]="SharingDialogEnterEmailLink";e[e.SharingDialogOpenPermissionsPaneEmailLink=2]="SharingDialogOpenPermissionsPaneEmailLink";e[e.SharingDialogShareEmailLink=3]="SharingDialogShareEmailLink";e[e.SharingDialogEnterGetLink=4]="SharingDialogEnterGetLink";e[e.SharingDialogOpenPermissionsPaneGetLink=5]="SharingDialogOpenPermissionsPaneGetLink";e[e.SharingDialogShareCreateLink=6]="SharingDialogShareCreateLink";e[e.SharingDialogShareCopyLink=7]="SharingDialogShareCopyLink";e[e.SharingDialogPermissionsChanged=8]="SharingDialogPermissionsChanged"}(t.UsageName||(t.UsageName={}));(i=t.LocationName||(t.LocationName={}))[i.SharingDialog=1]="SharingDialog"});define("acS",["require","exports","b5","acV","acU","acT"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"ms-dropdownformfield",template:e("acU"),viewModel:r.default});t.default=n});define("acV",["require","exports","ap","bF"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.label=e.label;t.options=e.options;t.selectedOption=e.selectedOption;return t}return e}(i.default);t.default=n});define("acU",[],function(){return'<label>\x3c!--ko if: label--\x3e<span class=ms-Label data-bind="text: label"></span>\x3c!--/ko--\x3e<select class=od-DropdownFormField-select data-bind="options: options, value: selectedOption"></select></label>'});define("acT",["c","az"],function(e,t){e.loadStyles([{rawString:".od-DropdownFormField-select{width:100%;margin-bottom:10px}"}])});define("acG",[],function(){return'<div class=od-SharingPermissions-titleHolder><div class=od-SharingPermissions-title data-bind="text: title"></div><div class=od-SharingPermissions-subTitle data-bind="text: subTitle"></div></div>\x3c!--ko if: showPolicyTipMessageBar && hasPolicyTipResponse--\x3e\x3c!--ko component: {\r\n name: policyTipMessageBarTagName,\r\n params: policyTipMessageBarParams\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=od-SharingPermissions-linkSelector><div data-bind="component: { name: dropdownFormTag, params: dropdownFieldParams }"></div>\x3c!--ko if: isPeoplePickerVisible--\x3e<div class="Sharing-table od-SharingPermissions-peoplePicker"><div class=Sharing-row><div class="Sharing-cell Sharing-peoplePicker" id=Sharing-peoplePicker data-bind="component: { name: peoplePickerTagName, params: peoplePickerParams }"></div></div></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: isPeoplePickerVisible--\x3e<div aria-live=polite class=od-SharingPermissions-tips data-bind="component: { name: sharingTipsTagName, params: sharingTipsParams }"></div>\x3c!--/ko--\x3e<div class=od-SharingPermissions-checkBoxes><div class=ms-CheckBox><input type=checkbox id=od-SharingPermissions-allowEdit class=ms-CheckBox-input data-bind="checked: allowEditChecked, disable: isAllowEditLocked"> <label for=od-SharingPermissions-allowEdit class="od-SharingPermissions-ChoiceField-field ms-CheckBox-field" data-bind="css: { \'is-checked\': allowEditChecked, \'is-disabled\': isAllowEditLocked }"><span data-bind="text: allowEditText" class=ms-Label></span></label></div>\x3c!--ko if: isExpiryVisible--\x3e<div class="ms-CheckBox od-SharingPermissions-linkExpires-field"><input type=checkbox id=od-SharingPermissions-linkExpires class=ms-CheckBox-input data-bind="checked: linkExpiresChecked, disable: expirationRequired"> <label for=od-SharingPermissions-linkExpires class="od-SharingPermissions-ChoiceField-field ms-CheckBox-field" data-bind="css: { \'is-disabled\': expirationRequired, \'is-checked\': linkExpiresChecked }"><span data-bind="text: linkExpiresText" class=ms-Label></span></label>\x3c!--ko if: linkExpiresChecked--\x3e<div><input class=od-SharingPermissions-linkExpiresDaysInput type=text id=od-SharingPermissions-linkExpiresDays data-bind="value: newExpirationInDays, valueUpdate: \'afterkeydown\'"> <label for=od-SharingPermissions-linkExpiresDays><span class="ms-Label od-SharingPermissions-linkExpiresDays-label" data-bind="text: daysLabel"></span></label></div><div aria-live=assertive class=od-SharingPermissions-error data-bind="if: errorMessage"><span data-bind="text: errorMessage"></span></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div><div class=od-SharingPermissions-buttonHolder><button class="od-Dialog-action od-Button od-Button--primary" data-bind="click: updateLink, enable: shareAvailable"><span class=od-Button-label data-bind="text: okayButtonText"></span></button> <button class="od-Dialog-action od-Button" data-bind="click: closePermissionsPanel"><span class=od-Button-label data-bind="text: cancelButtonText"></span></button></div>\x3c!--ko if: isSecurityPoliciesPreventingInfoBarVisible--\x3e<div class=od-SharingPermissions-infoBar data-bind="component: { name: \'ms-infoBar\', params: infoBarParams }"></div>\x3c!--/ko--\x3e\x3c!--ko if: isExistingUserPermissionsBarVisible--\x3e<div class=od-SharingPermissions-infoBar data-bind="component: { name: \'ms-infoBar\', params: existingUserInfoBarParams }"></div>\x3c!--/ko--\x3e\x3c!--ko component: { name: \'ms-panel-host\' }--\x3e\x3c!--/ko--\x3e'});define("acF",["c","az"],function(e,t){e.loadStyles([{rawString:".od-SharingPermissions-buttonHolder{margin-top:20px}.od-SharingPermissions-advanced{margin-top:20px}.od-SharingPermissions-peoplePicker{margin-bottom:10px}.od-SharingPermissions-tips{font-size:12px}[dir=ltr] .od-SharingPermissions-tips{margin-left:-5px}[dir=rtl] .od-SharingPermissions-tips{margin-right:-5px}.od-SharingPermissions-linkExpiresDaysInput{height:16px;width:16px;padding:8px;margin-top:16px}.od-SharingPermissions-ChoiceField-field.ms-ChoiceField-field{margin-top:0}.od-SharingPermissions-ChoiceField-field.ms-ChoiceField-field .ms-Label{font-size:12px}.od-SharingPermissions-error{margin-top:5px;color:#a80000}.od-SharingPermissions-title{font-size:21px}.od-SharingPermissions-subTitle{font-size:11px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.od-SharingPermissions-titleHolder{margin-bottom:16px}.od-SharingPermissions-linkExpires-field .ms-Label.od-SharingPermissions-linkExpiresDays-label{display:inline-block;font-size:12px}[dir=ltr] .od-SharingPermissions-linkExpires-field .ms-Label.od-SharingPermissions-linkExpiresDays-label{padding-left:0}[dir=rtl] .od-SharingPermissions-linkExpires-field .ms-Label.od-SharingPermissions-linkExpiresDays-label{padding-right:0}.od-SharingPermissions-linkSelector{margin-bottom:8px}.od-SharingPermissions-linkSelector .od-DropdownFormField-select{height:38px}[dir=ltr] .od-SharingPermissions-linkSelector .od-DropdownFormField-select{padding-left:7px}[dir=rtl] .od-SharingPermissions-linkSelector .od-DropdownFormField-select{padding-right:7px}.od-SharingPermissions-infoBar{margin-top:16px}.od-SharingPermissions-policyTipInfoBar{margin:12px 0}.od-SharingPermissions-checkBoxes{margin:20px 0}"}])});define("ac7",[],function(){return'<div class=od-EmailLink>\x3c!--ko if: isLoading()--\x3e<div class=od-EmailLink-loadingSpinner data-bind="component: { name: loadingSpinnerTagName }"></div>\x3c!--/ko--\x3e\x3c!--Main sharing content in this block.--\x3e\x3c!--ko if: !isLoading() && !error()--\x3e\x3c!--ko if: hasNote()--\x3e<div aria-live=assertive class=od-EmailLink-note><span data-bind="text: note"></span></div>\x3c!--/ko--\x3e\x3c!--Hint if file/folder is irregular, i.e. has 100 files in it.--\x3e<div class=od-EmailLink-sharingHints data-bind="component: { name: sharingHintsTagName, params: sharingHintsParams }"></div>\x3c!--Hint that describes the type of link, i.e. "Only people in Contoso...".--\x3e<a href=javascript:; class=od-EmailLink-sharingHint data-bind="attr: { title: switchLinksTitle }, click: switchLinks"><span data-bind="text: sharingHintText"></span></a><div class=od-EmailLink-table><div class=od-EmailLink-row><div class="od-EmailLink-cell od-EmailLink-peoplePicker" id=od-EmailLink-peoplePicker data-bind="component: { name: peoplePickerTagName, params: peoplePickerParams }"></div></div></div><div aria-live=polite data-bind="component: { name: sharingTipsTagName, params: sharingTipsParams }"></div>\x3c!--ko if: canSendEmail()--\x3e<textarea class="od-EmailLink-mailInput od-TextField-field od-TextField-field--unresizable" data-bind="textInput: emailInputText, attr: { placeholder: emailInputPlaceholder }">\r\n            </textarea>\x3c!--/ko--\x3e<div class=od-EmailLink-charCounter data-bind="visible: charLimitVisible, css: { \'od-EmailLink-charCounter--limitReached\': charLimitReached }, text: charCountText" aria-live=polite></div><div class=ms-clearfix></div><div class=od-EmailLink-submit><button class="od-EmailLink-submitButton od-Button od-Button--primary" data-bind="click: onShareClicked, enable: shareAvailable, automation: \'shareDialogCommit\'"><span class=od-EmailLink-button-label data-bind="text: shareButtonText"></span></button></div>\x3c!--/ko--\x3e\x3c!--Error content in this block.--\x3e\x3c!--Possible errors: fail getting sharing settings, item doesn\'t exist--\x3e\x3c!--ko if: !isLoading() && error()--\x3e<div class=od-EmailLink-error data-bind="text: error" aria-live=assertive></div>\x3c!--/ko--\x3e\x3c!--Panel host for sharing permissions control.--\x3e\x3c!--ko component: { name: panelHostTagName }--\x3e\x3c!--/ko--\x3e</div>'});define("ac6",["c","az"],function(e,t){e.loadStyles([{rawString:".od-EmailLink{margin-top:-10px;margin-bottom:20px}.od-EmailLink-loadingSpinner{text-align:center;padding:75px 0}.od-EmailLink-note{margin-bottom:10px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-EmailLink-sharingHints{margin-bottom:5px}.od-EmailLink-sharingHint{display:inline-block;margin-bottom:10px;cursor:pointer}.od-EmailLink-linkSection{margin-top:14px}.od-EmailLink-table{display:table;width:100%}.od-EmailLink-row{display:table-row}.od-EmailLink-cell{display:table-cell}.od-EmailLink-iconCell{width:50px;vertical-align:top}.od-EmailLink-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:';font-size:20px;border-radius:50%;width:40px;height:40px}[dir=ltr] .od-EmailLink-icon{margin-right:20px}[dir=rtl] .od-EmailLink-icon{margin-left:20px}.od-EmailLink-icon .ms-Icon--Link{position:relative;top:6px}[dir=ltr] .od-EmailLink-icon .ms-Icon--Link{left:7px}[dir=rtl] .od-EmailLink-icon .ms-Icon--Link{right:7px}.od-EmailLink-icon .ms-Icon--Mail{position:relative;top:5px}[dir=ltr] .od-EmailLink-icon .ms-Icon--Mail{left:10px}[dir=rtl] .od-EmailLink-icon .ms-Icon--Mail{right:10px}.od-EmailLink-creatingLink-loadingSpinner{display:inline-block;padding:5px 0}button.od-EmailLink-copyButton{padding:0 10px;height:1.94em}[dir=ltr] button.od-EmailLink-copyButton{margin-left:15px}[dir=rtl] button.od-EmailLink-copyButton{margin-right:15px}.od-EmailLink-copyButton-label{position:relative;top:-1px}.od-EmailLink-linkText{font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.od-EmailLink-peoplePicker{width:100%;vertical-align:top}.od-EmailLink-mailInput{resize:none;height:80px;width:100%;box-sizing:border-box;border:1px solid '},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";overflow-y:auto}html[dir=ltr] .od-EmailLink-charCounter{text-align:right}html[dir=rtl] .od-EmailLink-charCounter{text-align:left}.od-EmailLink-charCounter--limitReached{color:#a80000}.od-EmailLink-submitButton{position:relative;width:100%;height:30px;margin-top:5px}.od-EmailLink-submit{margin-bottom:30px}html[dir=ltr] .od-EmailLink-submit{float:right}html[dir=rtl] .od-EmailLink-submit{float:left}.od-Button .od-EmailLink-button-label{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-Button.is-disabled .od-EmailLink-button-label,.od-Button:disabled .od-EmailLink-button-label{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}"}])});define("acv",["require","exports","acy","b5","acx","acw"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r.registerComponent({tagName:"od-get-link",template:e("acx"),viewModel:i.default,synchronous:!0});t.default=n});define("acy",["require","exports","ap","cE","ac4","Or","V","ac3","ba","eX","qY","DI","yk","eO","lB","qT","aC","acY","acA","bF","c6","Bk","acz"],function(e,t,i,n,l,r,o,c,a,d,u,p,m,h,f,g,b,_,v,s,y,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=function(s){i.__extends(e,s);function e(e){var t=s.call(this,e)||this;t.loadingSpinnerTagName=f.default.tagName;t.panelHostTagName=g.default.tagName;t.sharingHintsTagName=_.default.tagName;var i=e.dialogTitle,r=e.items,n=e.sharingMethod,o=e.isPage;t._dialogTitle=i;t._items=r;t._sharingMethod=n;t.isPage=o;t._itemProvider=t.resources.consume(d.resourceKey);t.resources.bind(u.resourceKey);t._panelProvider=t.resources.consume(u.resourceKey);t._sharingProvider=t.resources.consume(p.resourceKey);t._suiteNavProvider=t.resources.consume(m.resourceKey);t.canCurrentUserShareExternally=t.createObservable(!1);t.copyText=S.strings.CopyLinkText;t.currentSharingLink=t.createObservable(null);t.error=t.createObservable("");t.getLinkText=S.strings.GetLink;t.hasLinkInfo=t.createObservable(!1);t.hasNote=t.createObservable(!1);t.inputAriaLabel=l.strings.LinkAvailable;t.isCopyLoadingVisible=t.createObservable(!1);t.isCreatingLink=t.createObservable(!1);t.isLoading=t.createObservable(!0);t.newExpirationInDays=t.observables.create(30);t.newRole=t.observables.create(null);t.newType=t.observables.create(null);t.note=t.createObservable("");t.ppResultHasUnresolvedText=t.observables.create(!1);t.ppResultSelectedPeople=t.observables.create([]);t.ppResultSelectedPeopleContainsExternal=t.observables.create(!1);t.supportsCopy=c.default.CanUseClipboardData()||document.queryCommandSupported&&document.queryCommandSupported("copy");t.switchLinksTitle=S.strings.ChangeLinkTitle;t.pageType=t.observables.create("5");t.pageRole=t.observables.create("1");var a=t._items[0].key;t.item=t._itemProvider.getItemSync({parentKey:a}).item;t._companyDisplayName=t.createObservable("");t._currentTypeInDropdown=t.createObservable(null);t._hasShareEventFired=!1;t._isDoneGettingSharingSettings=t.createObservable(!1);t._missingItemError=t._items[0].type===h.default.Folder?S.strings.MissingFolderError:S.strings.MissingFileError;t._missingItemErrorTitle=t._items[0].type===h.default.Folder?x.strings.MissingFolderTitle:x.strings.MissingFileTitle;t._peopleSharingWith=t.createObservable([]);t._sharingLinksCollection=t.createObservable([]);t._sharingSettings=t.observables.create(null);t._usersAdded=[];t._linkType=t.createPureComputed(t._computeLinkType);t._referenceRevision=t.createPureComputed(function(){return t.item().revision});t.createBackgroundComputed(t._refreshSharingSettings);t.inputHasFocus=t.createPureComputed(t._computeInputHasFocus);t.policyTipType=t.createPureComputed(t._computePolicyTipType);t.ppQueryParams=t.createPureComputed(t._computePeoplePickerQueryParams);t.ppQueryParamsBlockViaPolicy=t.createPureComputed(t._computeBlockViaPolicy);t.sharingHintsParams=t.createPureComputed(t._computeSharingHintsParams);t.sharingHintText=t.createPureComputed(t._computeSharingHintText);t.sharingPermissionsParams=t.createPureComputed(t._computeSharingPermissionsParams);t._getCompanyDisplayName();t._getSharingInfo(!(!t.ppQueryParamsBlockViaPolicy||!t.ppQueryParamsBlockViaPolicy.peek()));t._checkForSpecialFolder();return t}e.prototype.closePanel=function(){this._panel.state(1)};e.prototype.logCopy=function(e,t,i){var r=this;this.resources.consume(n.resourceKey).logData({name:this.currentSharingLink().tag+"Link.SharingByLink.Copy",isIntentional:!0});this._hasShareEventFired||(this._hasShareEventFired=!0);if(i){this.isCopyLoadingVisible(!0);this.async.setTimeout(function(){r.isCopyLoadingVisible(!1);y.findAncestor(t.target,"od-GetLink-copyButton").blur()},1e3)}return!0};e.prototype.onClickCopyLink=function(e,t){var i=!1,r=y.findAncestor(t.target,"od-GetLink-row").getElementsByTagName("input")[0];try{r.select();i=document.execCommand("copy")}catch(e){}!i&&c.default.CanUseClipboardData()&&(i=!!c.default.CopyToClipboard(this.currentSharingLink().url));this.logCopy(e,t,i);return!0};e.prototype.onClickCreateLink=function(){this._createLink()};e.prototype.pageCreateLink=function(){var e=parseInt(this.pageType.peek(),10),t=8;5===e?t=5:6===e?t=6:9===e&&(t=9);var i=1;2===parseInt(this.pageRole.peek(),10)&&(i=2);this._createLink(t,i)};e.prototype.switchLinks=function(){var s=this;this._panel=this._panelProvider.requestPanel({component:{name:v.default.tagName,params:this.sharingPermissionsParams},noTitle:!0});this._panel.wait().then(function(){if(null!==s.newType()||null!==s.newRole()){var e=s.newType.peek()||s.currentSharingLink.peek().type,t=s.newRole.peek()||s.currentSharingLink.peek().role,i=s.newExpirationInDays.peek()?parseInt(s.newExpirationInDays.peek().toString(),10):null;s.newType(null);s.newRole(null);if(i){for(var r=void 0,n=0;n<s._sharingLinksCollection.peek().length;n++){var o=s._sharingLinksCollection.peek()[n];if(o.role===t&&o.type===e){r=o;break}}var a=r.expiration;s._calculateDays(a)===i?s._createLink(e,t,null,a):s._createLink(e,t,i)}else s._createLink(e,t,i)}})};e.prototype.onResizeClick=function(){var e=this._getRandomInt(200,500),t=this._getRandomInt(200,500);window.external&&window.external.Resize?window.external.Resize(e,t):window.macTestObject&&window.macTestObject.ResizeWindowWidth_Height_&&window.macTestObject.ResizeWindowWidth_Height_(e,t)};e.prototype._getRandomInt=function(e,t){e=Math.ceil(e);t=Math.floor(t);return Math.floor(Math.random()*(t-e))+e};e.prototype._calculateDays=function(e){var t=new Date(e),i=new Date;return Math.round((t.getTime()-i.getTime())/864e5)};e.prototype._calculateLinkExpiration=function(e){if(0<e){var t=new Date;t.setUTCMinutes(t.getUTCMinutes()+e);return t.toString()}return null};e.prototype._checkForSpecialFolder=function(){this._items[0].isSpecialFolder&&this.note(S.strings.specialFolderNote)};e.prototype._computeInputHasFocus=function(){if(this.isCreatingLink())return!1;var e=this.currentSharingLink&&this.currentSharingLink();return!!e&&!!e.url};e.prototype._computeSharingHintText=function(){if(this._isDoneGettingSharingSettings())return r.getLinkHintText(this.currentSharingLink(),this._companyDisplayName(),this._peopleSharingWith(),this._sharingMethod)};e.prototype._computePolicyTipType=function(){var e=this.item();if(e)return e.policyTip};e.prototype._computeBlockViaPolicy=function(){if(!a.isFeatureEnabled(a.PolicyTipPanel))return!1;var e=this.policyTipType();return e?4===e:void 0};e.prototype._computeSharingHintsParams=function(){var e=this.item();if(e)return{guestLinkExists:this.createObservable(!1),sharingHintsOption:0,items:[e]}};e.prototype._computeSharingPermissionsParams=function(){if(this._isDoneGettingSharingSettings()){var e=this.item();this._currentTypeInDropdown(this.currentSharingLink.peek().type);if(e)return{item:e,whoCanAccessOptions:this._getWhoCanAccessThisLinkOptions(this._sharingSettings()),currentSharingLink:this.currentSharingLink,newType:this.newType,newRole:this.newRole,expirationRequired:this._enforceRequiredAnonymousLinkExpiration,maxExpirationInDays:this._adminRequiredAnonymousLinkExpirationInDays,newExpirationInDays:this.newExpirationInDays,peoplePickerParams:this._peoplePickerParams,closePanel:this.closePanel.bind(this),sharingHintText:r.getSharingInfoText(this._peopleSharingWith()),sharingMethod:this._sharingMethod,currentTypeInDropdown:this._currentTypeInDropdown,canManageReadWriteLink:this._sharingSettings().canManageReadWriteLink,canManageOrganizationalReadWriteLink:this._sharingSettings().canManageOrganizationalReadWriteLink,sharingLinks:this._sharingLinksCollection.peek(),blockPeoplePickerAndSharing:this._sharingSettings().blockPeoplePickerAndSharing}}};e.prototype._computePeoplePickerQueryParams=function(){var e=this._sharingSettings();if(e){var t={maximumEntitySuggestions:30,blockViaPolicy:this.ppQueryParamsBlockViaPolicy()},i=e.pickerProperties;if(i){t.principalSource=i.PrincipalSource;t.principalType=i.PrincipalAccountType;t.querySettings=i.QuerySettings;var r=this._currentTypeInDropdown()||this._linkType();if(this.ppQueryParamsBlockViaPolicy()&&9!==r){t.allowEmailAddresses=i.AllowEmailAddresses;t.filterExternalUsers=!1}else{t.allowEmailAddresses=i.AllowEmailAddresses&&9!==r;t.filterExternalUsers=9===r}}return t}};e.prototype._computeLinkType=function(){var e=this.currentSharingLink();if(e)return e.type};e.prototype._createLink=function(e,t,i,r){var n,o=this,a=!1;this.isCreatingLink(!0);if(!(0<e&&e<10)){e=this.currentSharingLink().type;t=this.currentSharingLink().role;n=this.currentSharingLink().expiration}if(i){n=this._calculateLinkExpiration(1440*i)}else r&&(n=r);if(8===e&&1===this._sharingMethod){this._shareCanonicalLink(t);return b.default.wrap(!0)}for(var s=0,l=this._sharingLinksCollection.peek();s<l.length;s++){var c=l[s];if(c.url&&c.type===e&&c.role===t&&(!c.supportsExpiration||c.expiration===n)||8===e&&c.type===e){8===e&&(c.role=2===t?2:1);this.currentSharingLink(c);a=!0;this.async.setTimeout(function(){o.isCreatingLink(!1)},500);break}}if(a)return b.default.wrap(!0);var d={create:!0,role:t,type:e,expiration:n};return this._sharingProvider.manageSharingLinks([this.item()],d).then(function(e){var t=e[0],i=o._sharingLinksCollection.peek();t.supportsExpiration=!!t.expiration;if(t.supportsExpiration)for(var r=0;r<i.length;r++){var n=i[r];n.type===t.type&&n.role===t.role&&i.splice(r,1,t)}else i.push(t);o._sharingLinksCollection(i);o.currentSharingLink(t);o.isCreatingLink(!1);o._itemProvider.invalidateItem(o.item().key,{triggerFetch:!0});return b.default.wrap(!0)},function(e){o.error(S.strings.ServerError)})};e.prototype._getBestSharingLink=function(e){var t=this;this.isReady=e.getBestSharingLink(this._defaultSharingLinkType).then(function(e){if(e){2!==e.role&&1!==e.role&&(e.role=2);t.currentSharingLink.peek()||t.currentSharingLink(e);t.hasLinkInfo(!0)}},function(e){t.error(S.strings.ServerError)})};e.prototype._getCompanyDisplayName=function(){var t=this;this._suiteNavProvider&&this._suiteNavProvider.loadData().then(function(e){t._companyDisplayName(e.CompanyDisplayName)})};e.prototype._getSharingLinks=function(e){var t=this;e.getLinks().then(function(e){null!=e&&t._sharingLinksCollection(e.filter(function(e){return e.item.id===t.item().id}))},function(e){t.error(S.strings.ServerError);t.isLoading(!1)})};e.prototype._getSharingInfo=function(e){var t=this,i=this._sharingProvider.getSharingData(this.item.peek(),e);this._getSharingSettings(i).then(function(){t._getSharingLinks(i);t._getBestSharingLink(i)})};e.prototype._getSharingSettings=function(e){var i=this;return this.isReady=e.getSettings().then(function(e){i._sharingSettings(e);if(e.itemId){var t=i.item().name;i._dialogTitle(o.format(x.strings.TitleText,t));i._adminRequiredAnonymousLinkExpirationInDays=e.requiredAnonymousLinkExpirationInDays;i._defaultSharingLinkType=e.defaultLinkType;i._enforceRequiredAnonymousLinkExpiration=0<Number(e.requiredAnonymousLinkExpirationInDays);i._peopleSharingWith(e.sharedWith);i.canCurrentUserShareExternally(e.canCurrentUserShareExternally);0<i._adminRequiredAnonymousLinkExpirationInDays&&i.newExpirationInDays(i._adminRequiredAnonymousLinkExpirationInDays);i._peoplePickerParams={selectedPeople:i.ppResultSelectedPeople,selectedPeopleContainsExternal:i.ppResultSelectedPeopleContainsExternal,peoplePickerQueryParams:i.ppQueryParams,contactInviteLimit:e.contactInviteLimit,hasUnresolvedText:i.ppResultHasUnresolvedText};i._isDoneGettingSharingSettings(!0);i.isLoading(!1)}else{i._dialogTitle(i._missingItemErrorTitle);i.error(i._missingItemError);i.isLoading(!1)}},function(e){e&&403===e.status?i.error(S.strings.AccessDenied):i.error(S.strings.ServerError);i._isDoneGettingSharingSettings(!0);i.isLoading(!1)})};e.prototype._getWhoCanAccessThisLinkOptions=function(e){return r.getWhoCanAccessLinkOptions(e,this._companyDisplayName(),this._sharingMethod)};e.prototype._refreshSharingSettings=function(){var t=this;this._referenceRevision()&&this._itemProvider.getItem({parentKey:this.item.peek().key,skipCache:!0,skipInMemoryCache:!0}).then(function(e){t._getSharingInfo(!0)})};e.prototype._shareCanonicalLink=function(e){for(var t=[],i=[],r=[],n=this._peopleSharingWith.peek(),o=0,a=this._sharingLinksCollection.peek();o<a.length;o++){var s=a[o];if(s.url&&8===s.type){s.role=e;this.currentSharingLink(s);this.isCreatingLink(!1);break}}for(var l=0;l<this._peoplePickerParams.selectedPeople.peek().length;l++){var c=this._peoplePickerParams.selectedPeople.peek()[l];c.sharingInfo={type:null,role:e};if(!this._usersAdded[c.email]){r.push(c);this._usersAdded[c.email]=!0}1===c.entityType?i.push(c):t.push(c)}this._peopleSharingWith(r.concat(n));var d={items:[this.item.peek()],roleValue:e.toString(),sendEmail:!1,requireSignIn:!0,propagateSharing:!0},u={items:[this.item.peek()],roleValue:e.toString(),sendEmail:!0,requireSignIn:!0,propagateSharing:!0};0<t.length&&this._sharingProvider.share(t,d);0<i.length&&this._sharingProvider.share(i,u)};return e}(s.default);t.default=k});define("acx",[],function(){return'<div class=od-GetLink>\x3c!--ko if: isLoading()--\x3e<div class=od-GetLink-loadingSpinner data-bind="component: { name: loadingSpinnerTagName }"></div>\x3c!--/ko--\x3e\x3c!--Main sharing content in this block.--\x3e\x3c!--ko if: !isLoading() && !error()--\x3e\x3c!--ko if: hasNote()--\x3e<div aria-live=assertive class=od-GetLink-note><span data-bind="text: note"></span></div>\x3c!--/ko--\x3e\x3c!--Hint if file/folder is irregular, i.e. has 100 files in it.--\x3e<div class=od-GetLink-sharingHints data-bind="component: { name: sharingHintsTagName, params: sharingHintsParams }"></div>\x3c!--Hint that describes the type of link, i.e. "Only people in Contoso...".--\x3e<a href=javascript:; class=od-GetLink-sharingHint data-bind="attr: { title: switchLinksTitle }, click: switchLinks"><span data-bind="text: sharingHintText"></span></a><div class=od-GetLink-linkSection>\x3c!--ko if: hasLinkInfo()--\x3e<div class=od-GetLink-table><div class=od-GetLink-row><div class="od-GetLink-cell od-GetLink-iconCell">\x3c!--ko if: currentSharingLink().url--\x3e<div class=od-GetLink-icon><i class="ms-Icon ms-Icon--Link" data-bind="icon: true"></i></div>\x3c!--/ko--\x3e\x3c!--ko if: !currentSharingLink().url--\x3e<a href=# class=od-GetLink-linkText id=od-GetLink-linkText data-bind="click: onClickCreateLink, automation: \'getLink\'"><div class=od-GetLink-icon><i class="ms-Icon ms-Icon--Link" data-bind="icon: true"></i></div>\x3c!--ko if: !isCreatingLink()--\x3e<span data-bind="text: getLinkText"></span>\x3c!--/ko--\x3e\x3c!--ko if: isCreatingLink()--\x3e<div class=od-GetLink-creatingLink-loadingSpinner data-bind="component: { name: loadingSpinnerTagName }"></div>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e</div>\x3c!--ko if: currentSharingLink().url--\x3e<div class=od-GetLink-cell aria-live=polite><div class="od-GetLink-table od-GetLink-url"><div class=od-GetLink-row><div class=od-GetLink-cell><input class=od-GetLink-input type=text role=textbox readonly data-bind="value: currentSharingLink().url, automation: \'sharingLinkUrl\', selectOnFocus: { isPermanent: true }, event: { copy: logCopy }, css: { \'is-disabled\': isCreatingLink }, attr: { \'aria-label\': inputAriaLabel, \'disabled\': isCreatingLink }, hasFocus: inputHasFocus"></div><div class=od-GetLink-cell><button class="ms-Dialog-action od-Button od-Button--primary od-GetLink-copyButton" data-bind="visible: supportsCopy, click: onClickCopyLink"><i class="od-GetLink-copySuccess ms-Icon ms-Icon--CheckMark" data-bind="icon: true, visible: isCopyLoadingVisible"></i> <span class=od-GetLink-copyButton-label data-bind="text: copyText, visible: !isCopyLoadingVisible()"></span></button></div></div></div></div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: isPage--\x3eYou\'re seeing this because you are hosting web content.<div class=pageForm><div class=pageForm-inputSection><label>type (5, 6, or 9):</label> <input type=text data-bind="value: pageType"></div><div class=pageForm-inputSection><label>role (1 or 2):</label> <input type=text data-bind="value: pageRole"></div><button data-bind="click: pageCreateLink">create link</button><p>anonymous view link: type = 5 and role = 1</p><p>anonymous edit link: type = 6 and role = 2</p><p>organizational view link: type = 9 and role = 1</p><p>organizational edit link: type = 9 and role = 2</p><button data-bind="click: onResizeClick">resize</button></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--Error content in this block.--\x3e\x3c!--Possible errors: fail getting sharing settings, item doesn\'t exist--\x3e\x3c!--ko if: !isLoading() && error()--\x3e<div class=od-GetLink-error data-bind="text: error" aria-live=assertive></div>\x3c!--/ko--\x3e\x3c!--Panel host for sharing permissions control.--\x3e\x3c!--ko component: { name: panelHostTagName }--\x3e\x3c!--/ko--\x3e</div>'});define("acw",["c","az"],function(e,t){e.loadStyles([{rawString:".od-GetLink{margin-top:-10px;margin-bottom:20px}.od-GetLink-loadingSpinner{text-align:center;padding:75px 0}.od-GetLink-note{margin-bottom:10px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-GetLink-sharingHints{margin-bottom:5px}.od-GetLink-sharingHint{display:inline-block;margin-bottom:4px;cursor:pointer}.od-GetLink-linkSection{margin-top:14px}.od-GetLink-table{display:table;width:100%}.od-GetLink-row{display:table-row}.od-GetLink-cell{display:table-cell}.od-GetLink-iconCell{width:50px;vertical-align:top}.od-GetLink-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:20px;border-radius:50%;width:40px;height:40px}[dir=ltr] .od-GetLink-icon{margin-right:12px}[dir=rtl] .od-GetLink-icon{margin-left:12px}.od-GetLink-icon .ms-Icon--Link{position:relative;top:8.5px}[dir=ltr] .od-GetLink-icon .ms-Icon--Link{left:10px}[dir=rtl] .od-GetLink-icon .ms-Icon--Link{right:10px}.od-GetLink-creatingLink-loadingSpinner{display:inline-block;padding:5px 0}.od-GetLink-input{padding:3px;width:250px;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}.od-GetLink-input.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.sm .od-GetLink-input{width:100%}button.od-GetLink-copyButton{padding:0 10px;height:1.94em}[dir=ltr] .sm button.od-GetLink-copyButton{margin-left:24px}[dir=rtl] .sm button.od-GetLink-copyButton{margin-right:24px}.od-GetLink-copyButton-label{position:relative;top:-1px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:'}.od-GetLink-linkText{font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;font-weight:400}.od-GetLink-copySuccess{color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.pageForm{margin-top:10px}.pageForm-inputSection{margin-bottom:10px}"}])});define("act",["require","exports","ap","bN","dZ","c7","aC"],function(i,e,t,r,s,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(a){t.__extends(e,a);function e(e){var t=a.call(this,e)||this;t.canFallbackToParent=!1;t.isSingleSelectAction=!0;var i=e.actionName,r=void 0===i?null:i,n=e.useNewSharingDialog,o=void 0===n?null:n;t.name=r;t._useNewSharingDialog=o;t.urlDataSource=t.resources.consume(s.url);return t}e.prototype.execute=function(){var t=this;return new o.default(function(){t._useNewSharingDialog?n.loadModule({path:"LW",getModule:function(){return new o.default(function(e,t){i(["LW"],e,t)})}}).then(function(e){new(t.resources.injected(e))({sharingMethod:1}).execute({})}):n.loadModule({path:"Mx",getModule:function(){return new o.default(function(e,t){i(["Mx"],e,t)})}}).then(function(e){new(t.resources.injected(e))({activeTab:2}).execute({})})})};return e}(r.default);e.default=a});define("acq",["require","exports","b5","acs","acr"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"launch-columnManagementPanel-executor",template:e("acr"),viewModel:r.default,synchronous:!0});t.default=n});define("acs",["require","exports","ap","AV","dR","cg","dY","eQ","Mk","V","Mc","cE","aI","oq","la","aC"],function(o,e,t,i,a,s,l,c,d,u,p,m,h,f,g,b){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(n){t.__extends(e,n);function e(e){var t=n.call(this,e)||this;t._fieldType=e.createField&&e.createField.fieldType;t._fieldToInsertAfter=e.createField&&e.createField.fieldToInsertAfter;t._fieldName=e.editField&&e.editField.fieldName;t._isHyperlink=e.isHyperlink;t._operationProvider=t.resources.consume(a.resourceKey);t._columnActionsHelper=t.resources.consume(p.resourceKey);var i=t._engagement=t.resources.consume(m.resourceKey);t.addBindingHandlers({react:f.default});var r=void 0!==t._fieldName?"Edit":"Create";i.logData({name:r+"Field.Click",isIntentional:!0});t.columnManagementPanelContainer={componentPath:"awT",getModule:function(){return new b.default(function(e,t){o(["awT"],e,t)})},props:t.createPureComputed(t._computeColumnManagementPanelProps)};return t}e.prototype._onDismiss=function(){this.action.cancel()};e.prototype._createProgressOperation=function(e,t){var i,r={Create:"createColumn",Edit:"editColumn",Delete:"deleteColumn"}[t],n=this._operationProvider.register({name:e,type:s.default[r],payloads:(i={},i[r]={name:e},i)});n.state(l.default.started);return n};e.prototype._onSuccess=function(e,t,i){var r=this,n=this._engagement,o=this._createProgressOperation(e,i);n.logData({name:"Success"+i+g.default[this._fieldType]+".Click",isIntentional:!0});n.logData({name:"Success"+i+"Field.Click",isIntentional:!0});if("Edit"===i){this._columnActionsHelper.invalidateSchema();o.state(l.default.completed);this.action.complete()}else{var a,s=void 0;if("Create"===i){a=new h.Qos({name:"ColumnManagementPanel.AddFieldToView"});s=this._columnActionsHelper.getAddToViewAction(t,this._fieldToInsertAfter)}else if("Delete"===i){a=new h.Qos({name:"ColumnManagementPanel.RemoveFieldFromView"});s=this._columnActionsHelper.getRemoveFromViewAction(t)}new(this.child(s.action))(s.params).execute(null).done(function(){r._columnActionsHelper.invalidateInfoPaneCache();o.state(l.default.completed);r.action.complete();a.end({resultType:h.ResultTypeEnum.Success})},function(){o.state(l.default.completed);r.action.complete();a.end({resultType:h.ResultTypeEnum.Failure})})}};e.prototype._onError=function(e,t,i){var r=this._createProgressOperation(e,i);r.state(l.default.failed);var n={Create:d.strings.createColumnOperationFailed,Edit:d.strings.editColumnOperationFailed,Delete:d.strings.deleteColumnOperationFailed};r.error(new c.default({message:u.format(n[i],e)}));this.action.complete()};e.prototype._computeColumnManagementPanelProps=function(){var r=this,e={hostModel:this,onDismiss:function(){return r._onDismiss()},onSuccess:function(e,t,i){return r._onSuccess(e,t,i)},onError:function(e,t,i){return r._onError(e,t,i)},isHyperlink:this._isHyperlink};void 0!==this._fieldName?e.editField={fieldName:this._fieldName}:void 0!==this._fieldType&&(e.createField={fieldType:this._fieldType});return e};return e}(i.default);e.default=r});define("acr",[],function(){return'<div data-bind="react: columnManagementPanelContainer"></div>'});define("acn",["require","exports","b5","acp","aco"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"launch-hubSettingsPanel-executor",template:e("aco"),viewModel:r.default,synchronous:!0});t.default=n});define("acp",["require","exports","ap","AV","oq","aC"],function(r,e,t,i,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({react:n.default});t.panelComponent={componentPath:"HM",getModule:function(){return new o.default(function(e,t){r(["HM"],e,t)})},props:{hostModel:t,onDismiss:function(){return t.action.complete()}}};return t}return e}(i.default);e.default=a});define("aco",[],function(){return'<div data-bind="react: panelComponent"></div>'});define("ack",["require","exports","b5","acm","acl"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"launch-siteSettingsPanel-executor",template:e("acl"),viewModel:r.default,synchronous:!0});t.default=n});define("acm",["require","exports","ap","AV","oq","aC"],function(r,e,t,i,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({react:n.default});t.panelComponent={componentPath:"H6",getModule:function(){return new o.default(function(e,t){r(["H6"],e,t)})},props:t.createPureComputed(t._computeSiteSettingsPanelProps)};return t}e.prototype._onDismiss=function(){this.action.complete()};e.prototype._computeSiteSettingsPanelProps=function(){var e=this;return{hostModel:this,onDismiss:function(){return e._onDismiss()}}};return e}(i.default);e.default=a});define("acl",[],function(){return'<div data-bind="react: panelComponent"></div>'});define("ach",["require","exports","b5","acj","aci"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"launch-changeTheLookPanel-executor",template:e("aci"),viewModel:r.default,synchronous:!0});t.default=n});define("acj",["require","exports","ap","AV","oq","aC"],function(r,e,t,i,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a="az2",s=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({react:n.default});t.changeTheLookPanelReactBinding={componentPath:a,props:t._computeChangeTheLookPanelProps(),getModule:function(){return new o.default(function(e,t){r([a],e,t)})}};return t}e.prototype._onDismiss=function(){this.action.complete()};e.prototype._computeChangeTheLookPanelProps=function(){var e=this;return{hostModel:this,onDismiss:function(){return e._onDismiss()}}};return e}(i.default);e.default=s});define("aci",[],function(){return'<div data-bind="react: changeTheLookPanelReactBinding"></div>'});define("ace",["require","exports","b5","acg","acf"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"launch-sitePermissionsPanel-executor",template:e("acf"),viewModel:r.default,synchronous:!0});t.default=n});define("acg",["require","exports","ap","AV","oq","aC"],function(r,e,t,i,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({react:n.default});t.panelComponent={componentPath:"Jv",getModule:function(){return new o.default(function(e,t){r(["Jv"],e,t)})},props:t.createPureComputed(t._computeSitePermissionsPanelProps)};return t}e.prototype._onDismiss=function(){this.action.complete()};e.prototype._computeSitePermissionsPanelProps=function(){var e=this;return{hostModel:this,onDismiss:function(){return e._onDismiss()}}};return e}(i.default);e.default=a});define("acf",[],function(){return'<div data-bind="react: panelComponent"></div>'});define("acb",["require","exports","b5","acd","acc"],function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i.registerComponent({tagName:"launch-groupMembershipPanel-executor",template:e("acc"),viewModel:r.default,synchronous:!0});t.default=n});define("acd",["require","exports","ap","AV","oq","aC"],function(r,e,t,i,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(i){t.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.addBindingHandlers({react:n.default});t.panelComponent={componentPath:"JS",getModule:function(){return new o.default(function(e,t){r(["JS"],e,t)})},props:t.createPureComputed(t._computeGroupMembershipPanelProps)};return t}e.prototype._onDismiss=function(){this.action.complete()};e.prototype._computeGroupMembershipPanelProps=function(){var e=this;return{hostModel:this,onDismiss:function(){return e._onDismiss()}}};return e}(i.default);e.default=a});define("acc",[],function(){return'<div data-bind="react: panelComponent"></div>'});define("ab9",["require","exports","ap","eK","aI","aca"],function(e,t,r,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t._moveCopyProvider=t.resources.consume(n.resourceKey);return t}e.prototype.onExecute=function(e){var t,i=this,r=this.context(),n=this._moveCopyProvider;t=this.isCrossSite?this.isMove?n.moveItemsAsync(r):n.copyItemsAsync(r):this.isMove?n.moveItems(r):n.copyItems(r);this.onComplete();return t.then(function(){return{resultType:o.ResultTypeEnum.Success,extraData:{IsMove:i.isMove,IsCrossSite:i.isCrossSite,NumItems:r.items.length}}})};return e}(i.default);t.default=a});define("aca",["require","exports","ap","Ln"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){r.__extends(e,i);function e(e){var t=i.call(this,e)||this;t.name="MoveCopy";t.context=e.context;t.onComplete=e.onComplete;t.isMove=e.isMove;t.isCrossSite=!!e.isCrossSite&&e.isCrossSite;return t}e.prototype.onIsAvailable=function(){return this.selectionHelper.selection().length&&this.context().isMove===this.isMove};e.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};return e}(i.default);t.default=n});define("ab7",["require","exports","ap","g4","aI","dm","ab8"],function(e,t,i,r,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(r){i.__extends(e,r);function e(e){var t=r.call(this,e)||this;t.name="CreateNewFolder";t.parentItem=e.parentItem;t._newName=e.newFolderName;var i=e.options||{};t._options={dataUpdated:i.dataUpdated||t.observables.create(!1),showNewFolderInput:i.showNewFolderInput||t.observables.create(!0),hasError:i.hasError||t.observables.create(!1),status:i.status||t.observables.create(""),hasFocus:i.hasFocus||t.observables.create(!0),isEnabled:i.isEnabled||t.observables.create(!0),needsRefocus:i.needsRefocus||t.observables.create(!1)};return t}e.prototype.onExecute=function(e){var i=this;this._options.status(o.strings.Saving);this._options.hasError(!1);this._options.isEnabled(!1);return this.resources.consumeAsync(a.typeResourceKey).then(function(e){var t=new e({parent:i.parentItem,folderName:i._newName.peek()});return i.trackPromise(t.start())}).then(function(){i._options.dataUpdated(!0);i._options.showNewFolderInput(!1);i._options.isEnabled(!0);i._options.status("");return{resultType:n.ResultTypeEnum.Success}},function(e){i._options.hasError(!0);i._options.status(e.message);i._options.isEnabled(!0);i._options.hasFocus(!0);return{resultType:n.ResultTypeEnum.Failure}})};return e}(r.default);t.default=s});