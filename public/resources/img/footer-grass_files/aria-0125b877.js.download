var clienttelemetry_build,Microsoft,sct,microsoft;(clienttelemetry_build||(clienttelemetry_build={})).version="2.9.0";!function(e){!function(e){var t,n;(t=e.BondDataType||(e.BondDataType={}))[t.BT_STOP=0]="BT_STOP",t[t.BT_STOP_BASE=1]="BT_STOP_BASE",t[t.BT_BOOL=2]="BT_BOOL",t[t.BT_UINT8=3]="BT_UINT8",t[t.BT_UINT16=4]="BT_UINT16",t[t.BT_UINT32=5]="BT_UINT32",t[t.BT_UINT64=6]="BT_UINT64",t[t.BT_FLOAT=7]="BT_FLOAT",t[t.BT_DOUBLE=8]="BT_DOUBLE",t[t.BT_STRING=9]="BT_STRING",t[t.BT_STRUCT=10]="BT_STRUCT",t[t.BT_LIST=11]="BT_LIST",t[t.BT_SET=12]="BT_SET",t[t.BT_MAP=13]="BT_MAP",t[t.BT_INT8=14]="BT_INT8",t[t.BT_INT16=15]="BT_INT16",t[t.BT_INT32=16]="BT_INT32",t[t.BT_INT64=17]="BT_INT64",t[t.BT_WSTRING=18]="BT_WSTRING",t[t.BT_UNAVAILABLE=127]="BT_UNAVAILABLE";(n=e.ProtocolType||(e.ProtocolType={}))[n.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",n[n.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",n[n.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",n[n.JSON_PROTOCOL=21322]="JSON_PROTOCOL",n[n.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",n[n.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));!function(e){var t;(function(e){var t=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e){for(var t=0;t<this._buffer.length&&this._buffer[t]!=e;++t);t==this._buffer.length&&this._buffer.push(e)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e}();e.Set=t;var n=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})},e.prototype.AddOrReplace=function(e,t){var n=this._getIndex(e);0<=n?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})},e.prototype.Remove=function(e){var t=this._getIndex(e);0<=t&&this._buffer.splice(t,1)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e.prototype.ContainsKey=function(e){return 0<=this._getIndex(e)},e.prototype.Get=function(e){var t=this._getIndex(e);return 0<=t?this._buffer[t].Value:null},e.prototype._getIndex=function(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t;break}return n},e}();e.Map=n})((t=e.Bond||(e.Bond={})).Collections||(t.Collections={}))}(Microsoft||(Microsoft={}));!function(a){!function(l){!function(e){var t=function(){function e(){}return e.GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||57344<=i?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t},e}();e.Utf8=t;var n=function(){function e(){}return e.GetString=function(e){var t,n,i,r,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=[],a=e.length%3;for(t=0,i=e.length-a;t<i;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],s.push([o.charAt((r=n)>>18&63),o.charAt(r>>12&63),o.charAt(r>>6&63),o.charAt(63&r)].join(""));switch(a){case 1:n=e[e.length-1],s.push(o.charAt(n>>2)),s.push(o.charAt(n<<4&63)),s.push("==");break;case 2:n=(e[e.length-2]<<8)+e[e.length-1],s.push(o.charAt(n>>10)),s.push(o.charAt(n>>4&63)),s.push(o.charAt(n<<2&63)),s.push("=")}return s.join("")},e}();e.Base64=n;var i=function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},e}();e.Varint=i;var r=function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i},e}();e.Varint64=r;var o=function(){function e(){}return e.GetBytes=function(e){if(l.BrowserChecker.IsDataViewSupport()){var t=new DataView(new ArrayBuffer(4));t.setFloat32(0,e,!0);for(var n=[],i=0;i<4;++i)n.push(t.getUint8(i));return n}return u.ConvertNumberToArray(e,!1)},e}();e.Float=o;var s=function(){function e(){}return e.GetBytes=function(e){if(l.BrowserChecker.IsDataViewSupport()){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e,!0);for(var n=[],i=0;i<8;++i)n.push(t.getUint8(i));return n}return u.ConvertNumberToArray(e,!0)},e}();e.Double=s;var a=function(){function e(){}return e.EncodeZigzag16=function(e){return(e=l.Number.ToInt16(e))<<1^e>>15},e.EncodeZigzag32=function(e){return(e=l.Number.ToInt32(e))<<1^e>>31},e.EncodeZigzag64=function(e){var t=e.low,n=e.high,i=n<<1|t>>>31,r=t<<1;2147483648&n&&(i=~i,r=~r);var o=new l.UInt64("0");return o.low=r,o.high=i,o},e}();e.Zigzag=a}(l.Encoding||(l.Encoding={}));!function(e){var t=function(){function e(){}return e.GetString=function(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(i<=191)t.push(String.fromCharCode(i));else if(i<=223){var r=e[++n];t.push(String.fromCharCode((31&i)<<6|63&r))}else if(i<=239){r=e[++n];var o=e[++n];t.push(String.fromCharCode((15&i)<<12|(63&r)<<6|63&o))}else{i=(7&i)<<18|(63&(r=e[++n]))<<12|(63&(o=e[++n]))<<6|63&e[++n],i-=65536,t.push(String.fromCharCode(55296|i>>10&1023)),t.push(String.fromCharCode(56320|1023&i))}}return t.join("")},e}();e.Utf8=t;var n=function(){function e(){}return e.GetBytes=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=0;i<e.length;++i){var r=t.indexOf(e.charAt(i++)),o=t.indexOf(e.charAt(i++)),s=t.indexOf(e.charAt(i++)),a=t.indexOf(e.charAt(i));n.push(r<<2|o>>4),0<=s&&(n.push(o<<4&240|s>>2),0<=a&&n.push(s<<6&192|a))}return n},e}();e.Base64=n;var i=function(){function e(){}return e.GetInt64=function(e){var t=new a.Bond.Int64("0"),n=this._Read(e);return t.low=n[0],1<n.length&&(t.high=n[1]),t},e.GetNumber=function(e){return this._Read(e)[0]},e._Read=function(e){for(var t=[],n=0,i=!0,r=0;i;){if(i=0!=(128&(o=e.shift())),o&=127,!(r<28)){n|=o<<r,t.push(n),n=o>>4,r=3;break}n|=o<<r,r+=7}for(;i;){var o;if(i=0!=(128&(o=e.shift())),n|=(o&=127)<<r,32<=(r+=7))break}return t.push(n),t},e}();e.Varint=i;var r=function(){function e(){}return e.GetNumber=function(e){if(l.BrowserChecker.IsDataViewSupport()){for(var t=new DataView(new ArrayBuffer(4)),n=0;n<4;++n)t.setUint8(n,e[n]);return t.getFloat32(0,!0)}return u.ConvertArrayToNumber(e,!1)},e}();e.Float=r;var o=function(){function e(){}return e.GetNumber=function(e){if(l.BrowserChecker.IsDataViewSupport()){for(var t=new DataView(new ArrayBuffer(8)),n=0;n<8;++n)t.setUint8(n,e[n]);return t.getFloat64(0,!0)}return u.ConvertArrayToNumber(e,!0)},e}();e.Double=o;var s=function(){function e(){}return e.DecodeZigzag16=function(e){return((65535&e)>>>1^-(1&e))<<16>>16},e.DecodeZigzag32=function(e){return e>>>1^-(1&e)},e.DecodeZigzag64=function(e){var t=1&e.high,n=e.high>>>1,i=1&e.low,r=e.low>>>1;r|=t<<31,i&&(r^=4294967295,n^=4294967295);var o=new a.Bond.UInt64("0");return o.low=r,o.high=n,o},e}();e.Zigzag=s}(l.Decoding||(l.Decoding={}));var u=function(){function e(){}return e.ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?52:23,i=(1<<(t?11:8)-1)-1,r=1-i,o=i,s=e<0?1:0;e=Math.abs(e);for(var a=Math.floor(e),u=e-a,d=2*(i+2)+n,c=new Array(d),l=0;l<d;)c[l++]=0;for(l=i+2;l&&a;)c[--l]=a%2,a=Math.floor(a/2);for(l=i+1;l<d-1&&0<u;)1<=(u*=2)?(c[++l]=1,--u):c[++l]=0;for(var _=0;_<d&&!c[_];++_);var f=i+1-_,h=_+n;if(c[h+1]){for(l=h;_<l&&!(c[l]=1-c[l]);--l);l==_&&++f}if(o<f||a)return s?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(f<r)return t?this._doubleZero:this._floatZero;if(t){var p=0;for(l=0;l<20;++l)p=p<<1|c[++_];for(var I=0;l<52;++l)I=I<<1|c[++_];return[255&I,I>>8&255,I>>16&255,I>>>24,255&(p=s<<31|2147483647&(p|=f+i<<20)),p>>8&255,p>>16&255,p>>>24]}var T=0;for(l=0;l<23;++l)T=T<<1|c[++_];return[255&(T=s<<31|2147483647&(T|=f+i<<23)),T>>8&255,T>>16&255,T>>>24]},e.ConvertArrayToNumber=function(e,t){var n=(1<<(t?11:8)-1)-1,i=0!=(128&e[t?7:3]),r=t?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==r)throw new l.Exception("Not a valid float/double buffer.");var o=1,s=1;if(t){var a=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,u=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!r&&!a&&!u)return 0;for(var d=0;d<20;++d)s/=2,a<0&&(o+=s),a<<=1;for(d=0;d<32;++d)s/=2,u<0&&(o+=s),u<<=1}else{var c=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!r&&!c)return 0;for(d=0;d<23;++d)s/=2,c<0&&(o+=s),c<<=1}return o*=Math.pow(2,r-n),i?0-o:o},e}();u._floatZero=[0,0,0,0],u._doubleZero=[0,0,0,0,0,0,0,0],u._floatInifinity=[0,0,128,127],u._floatNegInifinity=[0,0,128,255],u._doubleInifinity=[0,0,0,0,0,0,240,127],u._doubleNegInifinity=[0,0,0,0,0,0,240,255]}(a.Bond||(a.Bond={}))}(Microsoft||(Microsoft={}));!function(e){var t,n,i;t=e.Bond||(e.Bond={}),n=t.IO||(t.IO={}),i=function(){function e(){this._buffer=[]}return e.prototype.WriteByte=function(e){this._buffer.push(t.Number.ToByte(e))},e.prototype.Write=function(e,t,n){for(;n--;)this.WriteByte(e[t++])},e.prototype.GetBuffer=function(){return this._buffer},e}(),n.MemoryStream=i}(Microsoft||(Microsoft={}));!function(e){!function(e){var t=function(e,t){this.Type=e,this.Id=t};e.FieldTag=t;var n=function(e,t){this.ElementType=e,this.Size=t};e.ContainerTag=n;var i=function(e,t,n){this.KeyType=e,this.ValueType=t,this.Size=n};e.KeyValueContainerTag=i;var r=function(){};e.Bonded=r;var o=function(){function n(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}return n.prototype.Equals=function(e){var t=new n(e);return this.low==t.low&&this.high==t.high},n}();e.Int64=o;var s=function(){function n(e){this.low=0,this.high=0,this.low=parseInt(e)}return n.prototype.Equals=function(e){var t=new n(e);return this.low==t.low&&this.high==t.high},n}();e.UInt64=s;var a=function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e)},e.ToInt8=function(e){return 127&e|(128&e)<<24>>24},e.ToInt16=function(e){return 32767&e|(32768&e)<<16>>16},e.ToInt32=function(e){return 2147483647&e|2147483648&e},e.ToUInt8=function(e){return 255&e},e.ToUInt16=function(e){return 65535&e},e.ToUInt32=function(e){return 4294967295&e},e}();e.Number=a;var u=function(e){this.Message=e};e.Exception=u;var d=function(){};e.KeyValuePair=d;var c=function(){function e(){}return e.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();e.BrowserChecker=c}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={})),function(e){!function(n){var e=function(){function e(e){this._stream=e}return e.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)},e.prototype.WriteBool=function(e){this._stream.WriteByte(e?1:0)},e.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e)},e.prototype.WriteMapContainerBegin=function(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)},e.prototype.WriteContainerEnd=function(){},e.prototype.WriteDouble=function(e){var t=n.Encoding.Double.GetBytes(e);this._stream.Write(t,0,t.length)},e.prototype.WriteFloat=function(e){var t=n.Encoding.Float.GetBytes(e);this._stream.Write(t,0,t.length)},e.prototype.WriteFieldBegin=function(e,t,n){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},e.prototype.WriteFieldEnd=function(){},e.prototype.WriteFieldOmitted=function(e,t,n){},e.prototype.WriteInt16=function(e){e=n.Encoding.Zigzag.EncodeZigzag16(e),this.WriteUInt16(e)},e.prototype.WriteInt32=function(e){e=n.Encoding.Zigzag.EncodeZigzag32(e),this.WriteUInt32(e)},e.prototype.WriteInt64=function(e){this.WriteUInt64(n.Encoding.Zigzag.EncodeZigzag64(e))},e.prototype.WriteInt8=function(e){this._stream.WriteByte(n.Number.ToInt8(e))},e.prototype.WriteString=function(e){if(""==e)this.WriteUInt32(0);else{var t=n.Encoding.Utf8.GetBytes(e);this.WriteUInt32(t.length),this._stream.Write(t,0,t.length)}},e.prototype.WriteStructBegin=function(e,t){},e.prototype.WriteStructEnd=function(e){this.WriteUInt8(e?n.BondDataType.BT_STOP_BASE:n.BondDataType.BT_STOP)},e.prototype.WriteUInt16=function(e){var t=n.Encoding.Varint.GetBytes(n.Number.ToUInt16(e));this._stream.Write(t,0,t.length)},e.prototype.WriteUInt32=function(e){var t=n.Encoding.Varint.GetBytes(n.Number.ToUInt32(e));this._stream.Write(t,0,t.length)},e.prototype.WriteUInt64=function(e){var t=n.Encoding.Varint64.GetBytes(e);this._stream.Write(t,0,t.length)},e.prototype.WriteUInt8=function(e){this._stream.WriteByte(n.Number.ToUInt8(e))},e.prototype.WriteWString=function(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}},e}();n.CompactBinaryProtocolWriter=e;var t=function(){};n.CompactBinaryProtocolReader=t}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));!function(e){var t=function(){function o(){}return o.IsSafari=function(){if(null===o._isSafari)if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();o._isSafari=0<=e.indexOf("safari")&&e.indexOf("chrome")<0}else o._isSafari=!1;return o._isSafari},o.IsReactNative=function(){return null===o._isReactNative&&(o._isReactNative=!("undefined"==typeof navigator||!navigator.product)&&"ReactNative"===navigator.product),o._isReactNative},o.IsUint8ArrSupported=function(){return!e.Utils.IsSafari()&&"undefined"!=typeof Uint8Array&&!e.Utils.IsReactNative()},o.ajax=function(e,t){var n=o._createConnection();if(e.headers){var i="qsp=true";for(var r in e.headers)i+="&",i+=encodeURIComponent(r),i+="=",i+=encodeURIComponent(e.headers[r]);e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+=i}n.open(e.type,e.url,!t),e.complete&&(n.onload=function(){e.complete(n)},n.ontimeout=function(){e.complete(n)},n.onerror=function(){e.complete(n)},n.onabort=function(){e.complete(n)}),n.send(e.data)},o.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},o.IsUsingXDomainRequest=function(){if(null==o._usingXDomainRequest){var e=new XMLHttpRequest;o._usingXDomainRequest=void 0===e.withCredentials&&"undefined"!=typeof XDomainRequest}return o._usingXDomainRequest},o._createConnection=function(){var e=new XMLHttpRequest;return o.IsUsingXDomainRequest()?new XDomainRequest:e},o}();t._isSafari=null,t._isReactNative=null,t._usingXDomainRequest=null,e.Utils=t}(sct||(sct={}));!function(e){var t,c;t=e.applications||(e.applications={}),function(e){var t,n,i,r,o=function(){function e(){}return e.GetGuid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")},e.GetTimeStamp=function(){var e=(new Date).getTime(),t=new Microsoft.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e.GetTimeStampWithValue=function(e){var t=new Microsoft.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e}();e.utils=o;(t=e.RecordType||(e.RecordType={}))[t.NotSet=0]="NotSet",t[t.Event=1]="Event",t[t.PerformanceCounter=2]="PerformanceCounter",t[t.Anomaly=3]="Anomaly",t[t.Prediction=4]="Prediction",t[t.TraceLog=5]="TraceLog",t[t.EventSourceLog=6]="EventSourceLog",t[t.HttpLog=7]="HttpLog",t[t.PerformanceCounterAzure=8]="PerformanceCounterAzure",t[t.PerformanceCounterGfs=9]="PerformanceCounterGfs";(n=e.PIIScrubber||(e.PIIScrubber={}))[n.NotSet=0]="NotSet",n[n.O365=1]="O365",n[n.SkypeBI=2]="SkypeBI",n[n.SkypeData=3]="SkypeData";(i=e.PIIKind||(e.PIIKind={}))[i.NotSet=0]="NotSet",i[i.DistinguishedName=1]="DistinguishedName",i[i.GenericData=2]="GenericData",i[i.IPV4Address=3]="IPV4Address",i[i.IPv6Address=4]="IPv6Address",i[i.MailSubject=5]="MailSubject",i[i.PhoneNumber=6]="PhoneNumber",i[i.QueryString=7]="QueryString",i[i.SipAddress=8]="SipAddress",i[i.SmtpAddress=9]="SmtpAddress",i[i.Identity=10]="Identity",i[i.Uri=11]="Uri",i[i.Fqdn=12]="Fqdn",i[i.IPV4AddressLegacy=13]="IPV4AddressLegacy";(r=e.UserIdType||(e.UserIdType={}))[r.Unknown=0]="Unknown",r[r.MSACID=1]="MSACID",r[r.MSAPUID=2]="MSAPUID",r[r.ANID=3]="ANID",r[r.OrgIdCID=4]="OrgIdCID",r[r.OrgIdPUID=5]="OrgIdPUID",r[r.UserObjectId=6]="UserObjectId",r[r.Skype=7]="Skype",r[r.Yammer=8]="Yammer",r[r.EmailAddress=9]="EmailAddress",r[r.PhoneNumber=10]="PhoneNumber",r[r.SipAddress=11]="SipAddress",r[r.MUID=12]="MUID";var s=function(){function e(){this.ScrubType=c.datamodels.PIIScrubber.NotSet,this.Kind=c.datamodels.PIIKind.NotSet,this.RawContent=""}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){e.WriteStructBegin(null,t),this.ScrubType!=c.datamodels.PIIScrubber.NotSet?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,1,null),e.WriteInt32(this.ScrubType),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,1,null),this.Kind!=c.datamodels.PIIKind.NotSet?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),e.WriteInt32(this.Kind),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null),""!=this.RawContent?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,3,null),e.WriteString(this.RawContent),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,3,null),e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();e.PII=s;var a=function(){function e(){this.Id=o.GetGuid(),this.Timestamp=o.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new Microsoft.Bond.Collections.Map,this.RecordType=c.datamodels.RecordType.NotSet,this.PIIExtensions=new Microsoft.Bond.Collections.Map}return e.prototype.AddOrReplacePII=function(e,t,n){var i=new c.datamodels.PII;i.RawContent=t,i.Kind=n,i.ScrubType=c.datamodels.PIIScrubber.O365,this.PIIExtensions.AddOrReplace(e,i)},e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),""!=this.Id?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,1,null),e.WriteString(this.Id),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,1,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,3,null):(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,3,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),""!=this.Type?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),e.WriteString(this.Type),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null),""!=this.EventType?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,6,null),e.WriteString(this.EventType),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,6,null),this.Extension.Count()){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,13,null),e.WriteMapContainerBegin(this.Extension.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRING);for(var n=0;n<this.Extension.GetBuffer().length;++n)e.WriteString(this.Extension.GetBuffer()[n].Key),e.WriteString(this.Extension.GetBuffer()[n].Value);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,13,null);if(this.RecordType!=c.datamodels.RecordType.NotSet?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,24,null),e.WriteInt32(this.RecordType),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,24,null),this.PIIExtensions.Count()){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,30,null),e.WriteMapContainerBegin(this.PIIExtensions.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRUCT);for(var i=0;i<this.PIIExtensions.GetBuffer().length;++i)e.WriteString(this.PIIExtensions.GetBuffer()[i].Key),this.PIIExtensions.GetBuffer()[i].Value.WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,30,null);e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();e.Record=a;var u=function(){function e(){this.Source="",this.DataPackageId="",this.Timestamp=new Microsoft.Bond.Int64("0"),this.Records=[]}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,6,null):(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,8,null);e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();e.DataPackage=u;var d=function(){function e(){this.DataPackages=[],this.RequestRetryCount=0}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null),e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();e.ClientToCollectorRequest=d}((c=t.telemetry||(t.telemetry={})).datamodels||(c.datamodels={}))}(microsoft||(microsoft={}));!function(e){var t,f;t=e.applications||(e.applications={}),function(e){var d,t,i,n;(t=d=e.CallbackEventType||(e.CallbackEventType={}))[t.SENT=0]="SENT",t[t.SEND_FAILED=1]="SEND_FAILED";(n=i=e.DATARV_ERROR||(e.DATARV_ERROR={}))[n.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",n[n.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",n[n.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",n[n.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",n[n.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",n[n.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG";var r=function(){function e(e){this._errorCode=i.DATARV_ERROR_OK,this._errorCode=e}return e.prototype.ErrorCode=function(){return this._errorCode},e.prototype.toString=function(){switch(this._errorCode){case i.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case i.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case i.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case i.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case i.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case i.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}},e}();e.Exception=r;var o=function(){};e.TelemetryConfig=o;var s=function(){function e(){}return e.CreateTelemetryManager=function(){return new u},e}();e.TelemetryManagerFactory=s;var c,a,l=function(){function e(){}return e.MaxPackageSizeInBytes=function(){return 3e6},e.TimeIntervalForNextSendInMS=function(){return 1e3},e}();(a=c||(c={}))[a.Created=0]="Created",a[a.Initialized=1]="Initialized",a[a.Started=2]="Started";var u=function(){function u(){this._MaxPackageSizeInBytes=l.MaxPackageSizeInBytes(),this._listeners=[],this._status=c.Created,this._etag=null,this._testServerResponseHook=null,this._isPaused=!1}return u.prototype.Initialize=function(e){if(this._status!=c.Created)throw new r(i.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new r(i.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=c.Initialized,this._Verbose("Initialize() done")},u.prototype.AddListener=function(e){if(this._status<c.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)},u.prototype.RemoveListener=function(e){if(this._status<c.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)},u.prototype.Start=function(){if(this._status<c.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",u._tag].join(" ")),this._status>=c.Started&&this._Verbose("Start() already, ignore"),++u._tag,this._status=c.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",u._tag].join(""))},u.prototype.Stop=function(){if(this._status<c.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS);return this._Verbose("Stop(), status: "+this._status),this._status==c.Initialized?void this._Verbose("Stop() already, ignore"):(this._Reset(),this._status=c.Initialized,void this._Verbose("Stop() done, status: "+this._status))},u.prototype.Pause=function(){this._isPaused=!0,this._CleanTimer()},u.prototype.Resume=function(){this._isPaused=!1,this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1)},u.prototype.Flush=function(e){this._eventsCache.IsEmpty()||this._WorkThread(e,!0)},u.prototype.SendAsync=function(e,t){if(this._status<c.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",t.length].join(" ")),this._status<c.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!t)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new r(i.DATARV_ERROR_INVALID_ARG);for(var n=0;n<t.length;++n)if(!t[n].Id||!u._eventTypeRegex.test(t[n].EventType)||t[n].Timestamp.Equals("0"))throw this._Error(["eventId:",t[n].Id,"eventType:",t[n].EventType,"timestamp high:",t[n].Timestamp.high,"timestamp low:",t[n].Timestamp.low].join("")),new r(i.DATARV_ERROR_INVALID_EVENT);return this._eventsCache.AddEvents(e,t),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0},u.prototype._WorkThread=function(t,n){var i=this;try{if(this._Verbose("_WorkThread, status: "+this._status),this._status<c.Started)return void this._Verbose("_WorkThread, status is not started, return");var r=this._eventsCache.DequeuEvents();if(null==r)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var o=this._PackEvents(r.tenantToken,r.events);if(this._eventsCache.AddEvents(r.tenantToken,o.remainedEvents),null==o.buffer||0==o.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testServerResponseHook){var e=this._testServerResponseHook();return void setTimeout(this._SendCallback(a,r.tenantToken,o.sendEvents,e,!1,null),100)}var s={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+clienttelemetry_build.version},complete:function(e){return i._SendCallback(a,r.tenantToken,o.sendEvents,e,n,t)}};sct.Utils.IsUint8ArrSupported()?(this._Verbose("Uint8Array is defined, send with binary format directly."),s.data=new Uint8Array(o.buffer)):(this._Verbose("Uint8Array is undefined, send with base64 encode."),s.data=Microsoft.Bond.Encoding.Base64.GetString(o.buffer),s.headers["content-encoding"]="base64"),r.tenantToken&&(s.headers["x-apikey"]=r.tenantToken);var a=u._tag;this._lastActiveTime=(new Date).getTime(),sct.Utils.ajax(s,n),this._Verbose("_Workthread, send via jquery, tag: "+a)}catch(t){this._Error("_WorkThread, exception: "+t)}},u.prototype._PackEvents=function(e,t){this._Verbose("_PackageEvents, total Count: "+t.length);var n=new f.datamodels.ClientToCollectorRequest,i=new f.datamodels.DataPackage;i.Source="JS_default_source",i.DataPackageId=f.datamodels.utils.GetGuid(),i.Timestamp=f.datamodels.utils.GetTimeStamp();var r,o=t;for(t=[];i.Records=[],i.Records.push.apply(i.Records,o),n.DataPackages=[],n.DataPackages.push(i),r=this._Serialize(n),this._Verbose(["_PackageEvents, sendEvents.length:",o.length,"buffer.length:",r.length,"MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(r.length<this._MaxPackageSizeInBytes);){if(1==o.length){o=[],r=null;break}var s=o.splice(0,Math.floor(o.length/2));this._Verbose("_PackageEvents, too large, package again"),t.push.apply(t,o),o=s}return this._Verbose(["_PakcageEvents done, sendEventsCount:",o.length,"buffer.length:",null==r?0:r.length,"remained events:",t.length].join("")),{buffer:r,sendEvents:o,remainedEvents:t}},u.prototype._Serialize=function(e){var t=new Microsoft.Bond.IO.MemoryStream,n=new Microsoft.Bond.CompactBinaryProtocolWriter(t);return e.Write(n),t.GetBuffer()},u.prototype._SendCallback=function(e,t,n,i,r,o){if(this._Verbose(["_SendCallback","tag:",e,"current tag:",u._tag,"tenantToken:",t,"events count:",n.length,"jqXHR:",i].join("")),o&&o(i?i.status:0,t,n),!r){var s=i&&void 0!==i.status&&200===i.status;if(this._status<c.Started||e<u._tag)return void this._Verbose("_SendCallback, is not started, or tag is not the same, return");if(!s&&(i&&void 0!==i.status&&501!==i.status&&505!==i.status&&(i.status<300||500<=i.status||408===i.status)||!i||void 0===i.status))return this._Verbose("retry statusCode: "+(i?i.status:0)),this._eventsCache.AddEvents(t,n),void this._ScheduleTimer(!0);for(var a=0;a<this._listeners.length;++a)this._listeners[a](s?d.SENT:d.SEND_FAILED,i?i.status:0,t,n);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}},u.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)},u.prototype._ScheduleTimer=function(e){var t=this;if(!this._isPaused)if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);var n=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout(function(){return t._WorkThread(null,!1)},1e3*n),this._Verbose("_ScheduleTimer, next try (s): "+n),this._rescheduleFactor<<=1,64<this._rescheduleFactor&&(this._rescheduleFactor=1)}else{n=0;var i=(new Date).getTime()-this._lastActiveTime;n=i>l.TimeIntervalForNextSendInMS()?0:l.TimeIntervalForNextSendInMS()-i,this._timer=setTimeout(function(){return t._WorkThread(null,!1)},n),this._Verbose("_ScheduleTimer, next try: "+n),this._rescheduleFactor=1}},u.prototype._Verbose=function(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)},u.prototype._Info=function(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)},u.prototype._Error=function(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)},u.prototype._Reset=function(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new _},u.prototype.__GetListenerArray=function(){return this._listeners},u.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount()},u.prototype.__IsScheduled=function(){return null!=this._timer},u.prototype.__ChageMaxPackageSizeInKB=function(e){this._MaxPackageSizeInBytes=1024*e},u.prototype.__SetTestServerResponseHook=function(e){this._testServerResponseHook=e},u}();u._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,u._tag=0;var _=function(){function e(){this._events={},this._tokens=[]}return e.prototype.AddEvents=function(e,t){t.length&&(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t))},e.prototype.IsEmpty=function(){return 0==this._tokens.length},e.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}},e.prototype.GetTotalEventsCount=function(){var e=0;for(var t in this._events)e+=this._events[t].length;return e},e}()}((f=t.telemetry||(t.telemetry={}))._sender||(f._sender={}))}(microsoft||(microsoft={}));!function(p){var e;(function(c){var r=c._sender.TelemetryManagerFactory.CreateTelemetryManager(),e=function(){this.collectorUrl=null,this.enableAutoUserSession=!1,this.browserOverrides=null,this.disableCookies=!1};e.COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",e.COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",e.COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",e.COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",e.COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",c.LogConfiguration=e;var o=function(){this.onSaveData=null,this.onGetData=null};c.LogConfigurationBrowserOverrides=o;var a,t,s=function(){function e(){this.value=null,this.pii=null}return e._isPii=function(e){return null!=e&&e!==c.datamodels.PIIKind.NotSet&&!isNaN(e)&&void 0!==c.datamodels.PIIKind[e]},e}(),n=function(){function i(){this.name=null,this.timestamp=null,this.properties={},this.eventType=null}return i.prototype.setProperty=function(e,t,n){if(!e||!i._propertyNameRegex.test(e))throw new u(a.INVALID_PROPERTY_NAME);this.properties[e]=n?{value:t,pii:n!=c.datamodels.PIIKind.NotSet?n:null}:{value:t,pii:null}},i}();n._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,c.EventProperties=n;(t=a=c.TelemetryError||(c.TelemetryError={}))[t.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",t[t.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",t[t.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",t[t.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",t[t.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",t[t.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",t[t.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",t[t.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE",t[t.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET=10]="INVALID_CONFIGURATION_USE_CUSTOM_GET_SET";var u=function(){function e(e){this.errorCode=null,this.errorCode=e}return e.prototype.ErrorCode=function(){return this.errorCode},e.prototype.toString=function(){switch(this.errorCode){case a.INVALID_TENANT_TOKEN:return"Invalid tenant token";case a.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case a.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$";case a.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case a.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case a.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case a.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case a.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";case a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET:return"Invalid configuration provided during initialization. Both onGetConfigData and onSaveConfigData must be provided together.  These are manditory when running in a non-brower enviornment";default:return"Unknown error"}},e}();c.Exception=u;var d=function(){function e(e){this.contextMap={},this.piiKind=c.datamodels.PIIKind.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}return e.prototype.setAppId=function(e){e&&(this.contextMap["AppInfo.Id"]=e)},e.prototype.setAppVersion=function(e){e&&(this.contextMap["AppInfo.Version"]=e)},e.prototype.setAppLanguage=function(e){e&&(this.contextMap["AppInfo.Language"]=e)},e.prototype.setDeviceId=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.Id"]=e,_.checkAndUpdateDeviceId(e))},e.prototype.setDeviceOsName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsName"]=e)},e.prototype.setDeviceOsVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsVersion"]=e)},e.prototype.setDeviceBrowserName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserName"]=e)},e.prototype.setDeviceBrowserVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserVersion"]=e)},e.prototype.setUserId=function(e,t,n){if(e&&(this.contextMap["UserInfo.Id"]=e),n)this.contextMap["UserInfo.IdType"]=n;else{var i;switch(t){case p.applications.telemetry.datamodels.PIIKind.SipAddress:i=p.applications.telemetry.datamodels.UserIdType.SipAddress;break;case p.applications.telemetry.datamodels.PIIKind.PhoneNumber:i=p.applications.telemetry.datamodels.UserIdType.PhoneNumber;break;case p.applications.telemetry.datamodels.PIIKind.SmtpAddress:i=p.applications.telemetry.datamodels.UserIdType.EmailAddress;break;default:i=p.applications.telemetry.datamodels.UserIdType.Unknown}this.contextMap["UserInfo.IdType"]=i}if(t)s._isPii(t)&&(this.piiKind=t);else{var r;switch(n){case p.applications.telemetry.datamodels.UserIdType.Skype:r=p.applications.telemetry.datamodels.PIIKind.Identity;break;case p.applications.telemetry.datamodels.UserIdType.EmailAddress:r=p.applications.telemetry.datamodels.PIIKind.SmtpAddress;break;case p.applications.telemetry.datamodels.UserIdType.PhoneNumber:r=p.applications.telemetry.datamodels.PIIKind.PhoneNumber;break;case p.applications.telemetry.datamodels.UserIdType.SipAddress:r=p.applications.telemetry.datamodels.PIIKind.SipAddress;break;default:r=p.applications.telemetry.datamodels.PIIKind.NotSet}s._isPii(r)&&(this.piiKind=r)}},e.prototype.setUserMsaId=function(e){e&&(this.contextMap["UserInfo.MsaId"]=e)},e.prototype.setUserANID=function(e){e&&(this.contextMap["UserInfo.ANID"]=e)},e.prototype.setUserAdvertisingId=function(e){e&&(this.contextMap["UserInfo.AdvertisingId"]=e)},e.prototype.setUserTimeZone=function(e){e&&(this.contextMap["UserInfo.TimeZone"]=e)},e.prototype.setUserLanguage=function(e){e&&(this.contextMap["UserInfo.Language"]=e)},e}();c.SemanticContext=d;var l,i,_=function(){function d(){}return d.initialize=function(e,t){this._overrides=e,this._disableCookies=t;var n=d._getAppLanguage();n&&d.semanticContext.setAppLanguage(n);var i=d._getUserLanguage();i&&d.semanticContext.setUserLanguage(i);var r=(new Date).getTimezoneOffset(),o=r%60,s=(r-o)/60,a="+";0<s&&(a="-"),d.semanticContext.setUserTimeZone(a+(s<10?"0"+s:s.toString())+":"+(o<10?"0"+o:o.toString()));if(d._getUserAgent()&&(d.semanticContext.setDeviceBrowserName(d._getBrowserName()),d.semanticContext.setDeviceBrowserVersion(d._getBrowserVersion()),d.semanticContext.setDeviceOsName(d._getOsName()),d.semanticContext.setDeviceOsVersion(d._getOsVersion())),this._disableCookies&&!this._overrides)return d._deleteCookie(d.DEVICE_ID_COOKIE),void d._deleteCookie(d.FIRST_LAUNCH_TIME_COOKIE);var u=d._getData(d.DEVICE_ID_COOKIE);u&&""!=u||(u=c.datamodels.utils.GetGuid()),d.semanticContext.setDeviceId(u)},d.checkAndUpdateDeviceId=function(e){var t=d._getData(d.DEVICE_ID_COOKIE),n=d._getData(d.FIRST_LAUNCH_TIME_COOKIE);t!==e&&(n=(new Date).getTime().toString()),d.firstLaunchTime=parseInt(n),d._saveData(d.DEVICE_ID_COOKIE,e),d._saveData(d.FIRST_LAUNCH_TIME_COOKIE,n)},d._saveData=function(e,t){if(this._overrides)this._overrides.onSaveData(e,t);else if("undefined"!=typeof document&&void 0!==document.cookie&&!d._disableCookies){var n=new Date;n.setTime(n.getTime()+31536e6);var i="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+i}},d._getData=function(e){if(this._overrides)return this._overrides.onGetData(e)||"";if("undefined"!=typeof document&&void 0!==document.cookie&&!d._disableCookies)for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i],o=0;" "==r.charAt(o);)o++;if(0==(r=r.substring(o)).indexOf(t))return r.substring(t.length,r.length)}return""},d._getUserAgent=function(){return"undefined"!=typeof navigator&&navigator.userAgent||""},d._getAppLanguage=function(){return"undefined"!=typeof document&&document.documentElement?document.documentElement.lang:null},d._getUserLanguage=function(){return"undefined"!=typeof navigator?navigator.userLanguage||navigator.language:null},d._userAgentContainsString=function(e){return-1<d._getUserAgent().indexOf(e)},d._isIe=function(){return d._userAgentContainsString("Trident")},d._isEdge=function(){return d._userAgentContainsString(d.BROWSERS.EDGE)},d._isOpera=function(){return d._userAgentContainsString("OPR/")},d._getBrowserName=function(){return d._isOpera()?d.BROWSERS.UNKNOWN:d._userAgentContainsString(d.BROWSERS.PHANTOMJS)?d.BROWSERS.PHANTOMJS:d._isIe()?d.BROWSERS.MSIE:d._isEdge()?d.BROWSERS.EDGE:d._userAgentContainsString(d.BROWSERS.ELECTRON)?d.BROWSERS.ELECTRON:d._userAgentContainsString(d.BROWSERS.CHROME)?d.BROWSERS.CHROME:d._userAgentContainsString(d.BROWSERS.FIREFOX)?d.BROWSERS.FIREFOX:d._userAgentContainsString(d.BROWSERS.SAFARI)?d.BROWSERS.SAFARI:d._userAgentContainsString(d.BROWSERS.SKYPE_SHELL)?d.BROWSERS.SKYPE_SHELL:d.BROWSERS.UNKNOWN},d._getBrowserVersion=function(){return d._isIe()?(i=d._getUserAgent(),(r=i.match(new RegExp(d.BROWSERS.MSIE+" "+d.REGEX_VERSION)))?r[1]:(n=i.match(new RegExp("rv:"+d.REGEX_VERSION)))?n[1]:void 0):((e=d._getBrowserName())===d.BROWSERS.SAFARI&&(e="Version"),(t=d._getUserAgent().match(new RegExp(e+"/"+d.REGEX_VERSION)))?t[1]:d.UNKNOWN_VERSION);var e,t,n,i,r},d._getOsName=function(){return d._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?d.OPERATING_SYSTEMS.WINDOWS_PHONE:d._getUserAgent().match(/ arm;/i)?d.OPERATING_SYSTEMS.WINDOWS_RT:d._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?d.OPERATING_SYSTEMS.IOS:d._getUserAgent().match(/android/i)?d.OPERATING_SYSTEMS.ANDROID:d._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?d.OPERATING_SYSTEMS.LINUX:d._getUserAgent().match(/(macintosh|mac os x)/i)?d.OPERATING_SYSTEMS.MACOSX:d._getUserAgent().match(/(windows|win32)/i)?d.OPERATING_SYSTEMS.WINDOWS:d.OPERATING_SYSTEMS.UNKNOWN},d._getOsVersion=function(){return d._getOsName()===d.OPERATING_SYSTEMS.WINDOWS?(e=d._getUserAgent().match(new RegExp("Windows NT "+d.REGEX_VERSION)))&&d.VERSION_MAPPINGS[e[1]]?d.VERSION_MAPPINGS[e[1]]:d.UNKNOWN_VERSION:d._getOsName()===d.OPERATING_SYSTEMS.MACOSX?function(){var e,t=d._getUserAgent().match(new RegExp(d.OPERATING_SYSTEMS.MACOSX+" "+d.REGEX_VERSION_MAC));if(t){var n=t[1].replace(/_/g,".");if(n){var i=-1<(e=n).indexOf(".")?".":-1<e.indexOf("_")?"_":null;return i?n.split(i)[0]:n}}return d.UNKNOWN_VERSION}():d.UNKNOWN_VERSION;var e},d}();_.semanticContext=new d(!0),_.firstLaunchTime=-1,_.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},_.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},_.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},_.REGEX_VERSION="([\\d,.]+)",_.REGEX_VERSION_MAC="([\\d,_,.]+)",_.UNKNOWN_VERSION="Unknown",_.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",_.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",_._deleteCookie=function(e){"undefined"!=typeof document&&void 0!==document.cookie&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;")},_._disableCookies=!1;(i=l=c.SessionState||(c.SessionState={}))[i.STARTED=0]="STARTED",i[i.ENDED=1]="ENDED";var f=function(){function i(){}return i.initialize=function(e,t){if(!i._initialized){if(!e)throw new u(a.INVALID_TENANT_TOKEN);if(i._defaultToken=e,i._tmConfig.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/",i._configuration=t,!("undefined"!=typeof window||t&&t.browserOverrides&&t.browserOverrides.onGetData))throw new u(a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);var n=null;if(t)if(t.collectorUrl&&(i._tmConfig.collectorUrl=t.collectorUrl),t.browserOverrides){if(n=new o,t.browserOverrides.onGetData?!t.browserOverrides.onSaveData:t.browserOverrides.onSaveData)throw new u(a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);n.onGetData=t.browserOverrides.onGetData,n.onSaveData=t.browserOverrides.onSaveData}else t.disableCookies&&(i._sessionEnabled=!1);r.Initialize(i._tmConfig),r.Start(),_.initialize(n,t.disableCookies),i._initialized=!0,"undefined"!=typeof window&&window.addEventListener&&(t&&t.enableAutoUserSession&&(i._logger=new h).logSession(l.STARTED),window.addEventListener("beforeunload",i._teardown))}},i.pauseTransmission=function(){r.Pause()},i.resumeTransmission=function(){r.Resume()},i.flush=function(e){r.Flush(e)},i.addCallbackListener=function(e){i._initialized&&r.AddListener(e)},i.setContext=function(e,t,n){i._contextProperties.setProperty(e,t,n)},i.isInitialized=function(){return i._initialized},i.getDefaultToken=function(){return i._defaultToken},i.getSemanticContext=function(){return i._semanticContext},i._getInitIdForToken=function(e){return i._initIdMap[e]||(i._initIdMap[e]=c.datamodels.utils.GetGuid()),i._initIdMap[e]},i._getSequenceForToken=function(e){return i._sequenceMap[e]||(i._sequenceMap[e]=0),i._sequenceMap[e]++,i._sequenceMap[e]},i._teardown=function(){i._logger&&i._logger.logSession(l.ENDED),i.flush()},i.__backToUninitialized=function(){i._tmConfig=new c._sender.TelemetryConfig,i._semanticContext=new d(!0),i._contextProperties=new n,i._configuration=null,r=c._sender.TelemetryManagerFactory.CreateTelemetryManager(),i._initialized=!1,i._initIdMap={},i._sequenceMap={}},i}();f._initialized=!1,f._defaultToken=null,f._tmConfig=new c._sender.TelemetryConfig,f._logger=null,f._initIdMap={},f._sequenceMap={},f._configuration=null,f._contextProperties=new n,f._semanticContext=new d(!0),f._sessionEnabled=!0,c.LogManager=f;var h=function(){function e(e){this._initId=null,this._tenantToken=null,this._contextProperties=new n,this._semanticContext=new d(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||f.getDefaultToken(),this._initId=f._getInitIdForToken(this._tenantToken)}return e.prototype.logEvent=function(e){if(!e.name)throw new u(a.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addPropertiesAndSendEvent(t,e)},e.prototype.logFailure=function(e,t,n,i,r){if(!e)throw new u(a.MISSING_FAILURE_SIGNATURE);if(!t)throw new u(a.MISSING_FAILURE_DETAIL);var o=this._createEventRecord("failure","failure");o.Extension.Add("Failure.Signature",e),o.Extension.Add("Failure.Detail",t),n&&o.Extension.Add("Failure.Category",n),i&&o.Extension.Add("Failure.Id",i),this._addPropertiesAndSendEvent(o,r)},e.prototype.logPageView=function(e,t,n,i,r,o){if(!e)throw new u(a.MISSING_PAGEVIEW_ID);if(!t)throw new u(a.MISSING_PAGEVIEW_NAME);var s=this._createEventRecord("pageview","pageview");s.Extension.Add("PageView.Id",e),s.Extension.Add("PageView.Name",t),n&&s.Extension.Add("PageView.Category",n),i&&s.Extension.Add("PageView.Uri",i),r&&s.Extension.Add("PageView.ReferrerUri",r),this._addPropertiesAndSendEvent(s,o)},e.prototype.logSession=function(e,t){if(f._sessionEnabled){if(e!==l.STARTED&&e!==l.ENDED)throw new u(a.INVALID_SESSION_STATE);var n=this._createEventRecord("session","session");if(e===l.STARTED){if(0<this._sessionStartTime)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=c.datamodels.utils.GetGuid(),n.Extension.Add("Session.Id",this._sessionId),n.Extension.Add("Session.State","Started")}else if(e===l.ENDED){if(0==this._sessionStartTime)return;var i=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);n.Extension.Add("Session.Duration",i.toString()),n.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(i)),n.Extension.Add("Session.Id",this._sessionId),n.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}n.Extension.Add("Session.FirstLaunchTime",this._getISOString(new Date(_.firstLaunchTime))),this._addPropertiesAndSendEvent(n,t)}},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.setContext=function(e,t,n){this._contextProperties.setProperty(e,t,n)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e.prototype._createEventRecord=function(e,t){var n=new c.datamodels.Record;t||(t="custom"),n.EventType=e.toLowerCase(),n.Type=t.toLowerCase(),n.Extension.Add("EventInfo.Source","JS_default_source"),n.Extension.Add("EventInfo.InitId",this._initId),n.Extension.Add("EventInfo.Sequence",f._getSequenceForToken(this._tenantToken).toString()),n.Extension.Add("EventInfo.Name",e.toLowerCase());var i=new Date;return n.Timestamp=c.datamodels.utils.GetTimeStampWithValue(i.getTime()),n.Extension.Add("EventInfo.Time",this._getISOString(i)),n.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+clienttelemetry_build.version),n},e.prototype._getISOString=function(e){function t(e){return e<10?"0"+e:e.toString()}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+((n=e.getUTCMilliseconds())<10?"00"+n:n<100?"0"+n:n.toString())+"Z";var n},e.prototype._addCustomPropertiesToEvent=function(e,t){this._addSemanticContext(e,_.semanticContext),this._addSemanticContext(e,f._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,f._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)},e.prototype._addSemanticContext=function(e,t){if(t&&t.contextMap){var n=t.contextMap;for(var i in t.contextMap)"UserInfo.Id"==i&&t.piiKind!=c.datamodels.PIIKind.NotSet?e.AddOrReplacePII(i,n[i],t.piiKind):e.Extension.AddOrReplace(i,n[i])}},e.prototype._addEventPropertiesToEvent=function(e,t){if(t){t.timestamp&&t.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=c.datamodels.utils.GetTimeStampWithValue(t.timestamp),e.Extension.AddOrReplace("EventInfo.Time",this._getISOString(new Date(t.timestamp)))),t.name&&(e.EventType=t.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",t.name.toLowerCase()));var n=t.properties;if(n)for(var i in n)i&&(n[i].value||!1===n[i].value||0==n[i].value||""==n[i].value)&&(s._isPii(n[i].pii)?(e.AddOrReplacePII(i,n[i].value.toString(),n[i].pii),e.Extension.Remove(i)):(e.Extension.AddOrReplace(i,n[i].value.toString()),e.PIIExtensions.Remove(i)))}},e.prototype._addPropertiesAndSendEvent=function(e,t){this._addCustomPropertiesToEvent(e,t),f.isInitialized()&&(this._sanitizeName(e),r.SendAsync(this._tenantToken,[e]))},e.prototype._sanitizeName=function(e){var t=e.EventType.replace(/\./g,"_");e.EventType=t,e.Extension.AddOrReplace("EventInfo.Name",t)},e}();c.Logger=h})((e=p.applications||(p.applications={})).telemetry||(e.telemetry={}))}(microsoft||(microsoft={})),"undefined"!=typeof module&&(module.exports=microsoft.applications.telemetry);