define("avh",["require","exports","avk","avf","avj","iN","avi","avd"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});define("avk",["require","exports","ap","aC","bA","bN","ey","dZ","iE","ba","bb","eJ","gf","avl"],function(e,t,r,o,n,i,s,a,c,u,h,p,l,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(n){r.__extends(e,n);function e(e,t){var r=n.call(this,e,t)||this;r._useDnsUrl=!0;r._microServiceDataSource=t.microServiceDataSource;r._vroomDataRequester=t.vroomDataRequestor;r._pageContext=t.pageContext;return r}e.prototype.getBaseUrl=function(){var t=this;if(!this._isGenericList())return o.default.wrap(void 0);if(h.default.isActivated("613f2ebc-cf4b-4bdb-84cd-9a868a506135","3/28/2018","Disable getting a url for lists"))return o.default.wrap(void 0);var r=u.isFeatureEnabled(u.AllowPushChannelDnsUrls),n=r&&this._useDnsUrl,e=this._microServiceDataSource.getPushChannelUrl();return o.default.wrap(e).then(function(e){return e&&0<e.length?e:t._microServiceDataSource.hasSetBaseInfo()?t._pushChannelEndpoint?t._pushChannelEndpoint:t.resources.consumeAsync(f.resourceKey).then(function(e){return e.getMicroserviceEndPoints("push").then(function(e){return e},function(e){var t=p.get("srr");if(t&&0<t.length)return"https://centralus0.pushd.svc.ms"})}).then(function(e){e&&0<e.length&&(t._pushChannelEndpoint=e);return t._pushChannelEndpoint}):void 0}).then(function(e){e&&n&&(e=e.replace("-push",".push"));e&&r&&(t._useDnsUrl=!t._useDnsUrl);return e})};e.prototype.isLongPollingAllowed=function(){return u.isFeatureEnabled(u.AllowPushChannelLongPolling)};e.prototype.getDriveSubscription=function(){var n=this;if(!this._isGenericList()&&this._isAuthValid()){var o=u.isFeatureEnabled(u.AllowPushChannelDnsUrls),i=o&&this._useDnsUrl;return this._vroomDataRequester.send({apiName:"socketIo",path:"/drive/root/subscriptions/socketIo",useAuthorizationHeaders:!0}).then(function(e){if(e){if(!e.token){var t=e.notificationUrl.indexOf("token=");if(-1===t)return;e.token=e.notificationUrl.substring(t+6)}if(!e.serverUrl){var r=e.notificationUrl.indexOf("/callback");if(-1===r)return;e.serverUrl=e.notificationUrl.substring(0,r)}e.serverUrl=i?e.serverUrl.replace("-push",".push"):e.serverUrl.replace(".push","-push");o&&(n._useDnsUrl=!n._useDnsUrl);return e}})}};e.prototype.getCurrentView=function(){return this._pageContext.listId};e.prototype.registerForViewUpdates=function(e){this._microServiceDataSource.registerSetBaseInfoCallback(function(){e()});this._microServiceDataSource.hasSetBaseInfo()&&e()};e.prototype._isAuthValid=function(){return this._microServiceDataSource.hasSetBaseInfo()&&this._microServiceDataSource.hasAuthData()&&!this._microServiceDataSource.hasAuthDataExpired()};e.prototype._isGenericList=function(){return this._pageContext.listBaseTemplate&&Number(this._pageContext.listBaseTemplate)===s.default.genericList};e.dependencies=r.__assign({},i.default.dependencies,{microServiceDataSource:a.microService,vroomDataRequestor:l.resourceKey,pageContext:c.pageContext});return e}(i.default);t.default=d;t.resourceKey=n.createResolvedResourceKey(e("module").id,d)});define("avl",["require","exports","aC","c7","bA"],function(r,e,t,n,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.resourceKey=new o.ResourceKey({name:r("module").id,loader:new o.AliasResourceLoader(function(){return n.loadModuleExport({path:"YC",getModule:function(){return new t.default(function(e,t){r(["YC"],e,t)})},getExport:function(e){return e.resourceKey}})})})});define("avf",["require","exports","ap","afF","bN","aC","fW","aN","aZ","vx","aI","cb","bA","dZ","ba","av"],function(e,t,o,h,r,c,u,p,l,i,f,d,n,s,a,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g;!function(e){e[e.BaseUrlWaiting=0]="BaseUrlWaiting";e[e.BaseUrlReceived=1]="BaseUrlReceived";e[e.BaseUrlFail=2]="BaseUrlFail";e[e.Registered=3]="Registered";e[e.RegisterFailed=4]="RegisterFailed";e[e.SocketIoConnected=5]="SocketIoConnected";e[e.SocketIoDisconnected=6]="SocketIoDisconnected"}(g||(g={}));var m=1e3,v=function(n){o.__extends(e,n);function e(e,t){var r=n.call(this,e,t)||this;r._totalRetries=0;r._retryDelay=m;r._firedRegisterEvent=!1;r._firedConnectEvent=!1;r._totalConnectionAttempts=0;r._connectionIssueCount=0;r._notificationHandlers={};r._connectedHandlers=[];r._pushChannelDataSource=t.pushChannelDataSource;r._pushChannelDataSource.registerForViewUpdates(r._onViewUpdate.bind(r));return r}e.prototype.isConnected=function(){return this._io&&this._io.connected};e.prototype.log=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];a.isFeatureEnabled(a.EnablePushChannelLogging)&&console.log.apply(console,[h.PushChannelLogSource[e]].concat(t))};e.prototype.getNotificationUrl=function(){return this._registerResponse?this._registerResponse.webhookUrl:void 0};e.prototype.setupNotificationHandler=function(e,t){var r=e.source,n=e.scenarios,o=e.id,i=void 0===o?"":o,s=h.NotificationSource[r];if(s)if(n&&n.length)for(var a=0,c=n;a<c.length;a++){var u=c[a];this._notificationHandlers[s.toLowerCase()+h.NotificationScenario[u].toLowerCase()+i]=t}else this._notificationHandlers[s.toLowerCase()+i]=t;else p.default.verbose("Attempted to add unknown notification handler "+r,"PushChannelCommon.setupNotificationHandler")};e.prototype.addConnectedHandler=function(e){this._connectedHandlers.push(e)};e.prototype.getDriveSubscription=function(e){var r=this;if(this._socketIoSubscription&&!1===e)return c.default.wrap(this._socketIoSubscription);var t=this._pushChannelDataSource.getDriveSubscription();return t?t.then(function(e){if(e){var t=!r._io||!r._io.connected||void 0===r._socketIoSubscription||r._socketIoSubscription.serverUrl!==e.serverUrl||r._socketIoSubscription.notificationUrl!==e.notificationUrl||r._socketIoSubscription.token!==e.token;r._socketIoSubscription=e;if(t){r.log(h.PushChannelLogSource.PushChannelProvider,"Connect to server",e);r._registerResponse={token:e.token,serverUrl:e.serverUrl,webhookUrl:e.notificationUrl};r._ensureIoDisconnected();r._nextState(g.Registered)}else r.log(h.PushChannelLogSource.PushChannelProvider,"getDriveSubscription",e);return e}}):void 0};e.prototype._getBaseUrlThenRegister=function(e){var t=this;void 0===e&&(e=!1);e&&this.log(h.PushChannelLogSource.PushChannelProvider,"getBaseUrlThenRegister");var r=this.getDriveSubscription(!0);if(void 0!==r)r.then(function(e){e||t._delayNextState(g.BaseUrlWaiting)},function(e){t.log(h.PushChannelLogSource.PushChannelProvider,"getDriveSubscription error",e);i.isGraphError(e)&&403===e.status?t.log(h.PushChannelLogSource.PushChannelProvider,"getDriveSubscription encountered a 403. Not retrying"):t._delayNextState(g.BaseUrlFail)});else{var n=function(){return t.async.setTimeout(function(){t._getBaseUrlThenRegister()},1e3)};this._pushChannelDataSource.getBaseUrl().then(function(e){e?t._register(e):n()},function(e){n()})}};e.prototype._onViewUpdate=function(){var e=this._pushChannelDataSource.getCurrentView();if(void 0!==e&&this._view!==e){this.log(h.PushChannelLogSource.PushChannelProvider,"onViewUpdate. '"+this._view+"' -> '"+e+"'");this._view=e;this._socketIoSubscription=void 0;this._getBaseUrlThenRegister(!0)}};e.prototype._register=function(e){var o=this;this.log(h.PushChannelLogSource.PushChannelProvider,"register",e);this._registerResponse=void 0;this._ensureIoDisconnected();var i,s=e+"/notifications/register",a=l.default.generate();if(!this._firedRegisterEvent){this._firedRegisterEvent=!0;i=new d.Api({name:"PushChannel.Register",url:s})}var r=function(e,t,r){if(void 0!==i){var n=void 0;(n=e instanceof Error?{resultType:c.default.isCanceled(e)?f.ResultTypeEnum.ExpectedFailure:f.ResultTypeEnum.Failure,error:e.message,extraData:{}}:{resultType:f.ResultTypeEnum.Failure,extraData:o._getExtraData(e,s)}).extraData.correlationId=a;void 0!==t&&(n.extraData.xhrStatusCode=t.toString());void 0!==r&&(n.extraData.xhrIsTimeout=r.toString());i.end(n)}o._delayNextState(g.RegisterFailed)};u.default.start({url:s,method:"GET",headers:{"X-Correlation-Id":a},requestTimeoutInMS:1e4}).then(function(e){if(e&&e.responseText&&0<e.responseText.length)try{var t=JSON.parse(e.responseText);if(t&&t.token&&t.serverUrl&&t.webhookUrl){o.log(h.PushChannelLogSource.PushChannelProvider,"register data",t);o._registerResponse=t}}catch(e){o.log(h.PushChannelLogSource.PushChannelProvider,"register failed",e)}if(o._registerResponse){void 0!==i&&i.end({resultType:f.ResultTypeEnum.Success});o._nextState(g.Registered)}else r(e)},r)};e.prototype._connect=function(){var a=this;this._ensureIoDisconnected();var e={autoConnect:!1,reconnection:!1,query:"token="+this._registerResponse.token};-1!==this._registerResponse.serverUrl.indexOf("-push")&&this._pushChannelDataSource.isLongPollingAllowed()&&(e.transports=["polling"]);var t,r=this._io=y(this._registerResponse.serverUrl,e);if(!this._firedConnectEvent){this._firedConnectEvent=!0;t=new f.Qos({name:"PushChannel.Connect",extraData:o.__assign({},this._registerResponse,{totalConnectionAttempts:this._totalConnectionAttempts})})}this._io.on("connect",function(){if(r===a._io){t&&t.end({resultType:f.ResultTypeEnum.Success,extraData:a._registerResponse});a._connectionIssueCount=0;a._nextState(g.SocketIoConnected)}else{a.log(h.PushChannelLogSource.PushChannelProvider,"SocketIoClientMismatch",a._io,r);t&&t.end({resultType:f.ResultTypeEnum.Failure,error:"SocketIoClientMismatch",extraData:a._registerResponse});r.disconnect()}});this._io.on("connect_error",function(e){a.log(h.PushChannelLogSource.PushChannelProvider,"connect error",typeof e,e);t&&t.end({resultType:f.ResultTypeEnum.Failure,error:e,extraData:a._registerResponse});a._onConnectionIssue()});this._io.on("disconnect",this._onConnectionIssue.bind(this));this._io.on("notification",function(t){a.log(h.PushChannelLogSource.PushChannelProvider,"notification received",t);var e;try{e=JSON.parse(t)}catch(e){a.log(h.PushChannelLogSource.PushChannelProvider,"notification received error",t);return}var r=e.source,n=e.scenario?e.scenario.toLowerCase():"";r||(r=h.NotificationSource[h.NotificationSource.WebhookSubscription]);r=r.toLowerCase();var o=!1;o=a._handleMessage(e,r);var i=r+n;for(var s in a._notificationHandlers)-1!==s.indexOf(i)&&s!==r&&(o=a._handleMessage(e,s,i)||o);o||a.log(h.PushChannelLogSource.PushChannelProvider,"notification received - missing handler for message")});this._totalConnectionAttempts++;this._io.connect()};e.prototype._handleMessage=function(e,t,r){void 0===r&&(r=t);var n=this._notificationHandlers[t];if(n){n(e.payload?e.payload:e.value);return!0}return!1};e.prototype._onConnectionIssue=function(){this._connectionIssueCount++;this._delayNextState(g.SocketIoDisconnected)};e.prototype._ensureIoDisconnected=function(){if(this._io){this._io.disconnect();this._io=void 0}};e.prototype._nextState=function(e){this.log(h.PushChannelLogSource.PushChannelProvider,"nextState",(new Date).toLocaleString(),g[e]);this._clearDelayTimeout();if(!this._registerResponse||this._io&&!this._io.connected&&1<this._connectionIssueCount)this._getBaseUrlThenRegister();else if(this._io&&this._io.connected){for(var t=0,r=this._connectedHandlers;t<r.length;t++){(0,r[t])()}this._totalRetries=0;this._retryDelay=m}else this._connect()};e.prototype._delayNextState=function(e,t){var r=this;if(e===g.BaseUrlFail||e===g.RegisterFailed){this._totalRetries++;if(100<this._totalRetries){this.log(h.PushChannelLogSource.PushChannelProvider,"Exceeded max retry limit");new f.Qos({name:"PushChannel.RetryLimitExceeded"}).end({resultType:f.ResultTypeEnum.Success});return}}var n=this._delayRetry(function(){return r._nextState(e)},t);this.log(h.PushChannelLogSource.PushChannelProvider,g[e],"delaying for "+n+"ms")};e.prototype._delayRetry=function(e,t){var r=this,n=t;if(!n){n=this._retryDelay;this._retryDelay<12e4&&(this._retryDelay+=3001*Math.random()+2e3)}this._clearDelayTimeout();this._delayTimeoutId=this.async.setTimeout(function(){r._delayTimeoutId=void 0;e()},n);return n};e.prototype._clearDelayTimeout=function(){if(void 0!==this._delayTimeoutId){this.async.clearTimeout(this._delayTimeoutId);this._delayTimeoutId=void 0}};e.prototype._getExtraData=function(e,t){var r={};if(e){var n=e&&"function"==typeof e.getAllResponseHeaders?e.getAllResponseHeaders():void 0;n&&-1!==n.indexOf("access_token")&&(n="");r.readyState=e.readyState;r.status=e.status;r.statusText=e.statusText;r.headers=n;r.responseText=e.responseText}t&&(r.url=t);return r};e.dependencies=o.__assign({},r.BaseModel.dependencies,{pushChannelDataSource:s.pushChannel});return e}(r.BaseModel);t.default=v;t.resourceKey=n.createResolvedResourceKey(e("module").id,v)});define("afF",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.WebhookSubscription=0]="WebhookSubscription";e[e.Meta=1]="Meta"}(t.NotificationSource||(t.NotificationSource={}));(r=t.NotificationScenario||(t.NotificationScenario={}))[r.Zip=0]="Zip";!function(e){e[e.PushChannelProvider=0]="PushChannelProvider";e[e.ItemAutoRefreshProvider=1]="ItemAutoRefreshProvider";e[e.ItemAutoRefreshDataSource=2]="ItemAutoRefreshDataSource"}(t.PushChannelLogSource||(t.PushChannelLogSource={}))});define("vx",["require","exports","ap","gi"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.__exportStar(n,t)});!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("av",[],t):"object"==typeof exports?exports.io=t():e.io=t()}(this,function(){return function(r){function n(e){if(o[e])return o[e].exports;var t=o[e]={exports:{},id:e,loaded:!1};return r[e].call(t.exports,t,t.exports,n),t.loaded=!0,t.exports}var o={};return n.m=r,n.c=o,n.p="",n(0)}([function(e,t,r){"use strict";function n(e,t){"object"===(void 0===e?"undefined":c(e))&&(t=e,e=void 0),t=t||{};var r,n=u(e),o=n.source,i=n.id,s=n.path,a=l[i]&&s in l[i].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?(p("ignoring socket cache for %s",o),r=h(o,t)):(l[i]||(p("new io instance for %s",o),l[i]=h(o,t)),r=l[i]),n.query&&!t.query&&(t.query=n.query),r.socket(n.path,t)}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=r(1),o=r(7),h=r(13),p=r(3)("av");e.exports=t=n;var l=t.managers={};t.protocol=o.protocol,t.connect=n,t.Manager=r(13),t.Socket=r(39)},function(e,t,r){(function(o){"use strict";var i=r(2),s=r(3)("socket.io-client:url");e.exports=function(e,t){var r=e;t=t||o.location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(s("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),s("parse %s",e),r=i(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var n=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+n+":"+r.port,r.href=r.protocol+"://"+n+(t&&t.port===r.port?"":":"+r.port),r}}).call(t,function(){return this}())},function(e,t){var a=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,c=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));for(var o=a.exec(e||""),i={},s=14;s--;)i[c[s]]=o[s]||"";return-1!=r&&-1!=n&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i}},function(r,i,n){(function(t){function e(){var e;try{e=i.storage.debug}catch(e){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e}(i=r.exports=n(5)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},i.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+i.humanize(this.diff),t){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var n=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(o=n))}),e.splice(o,0,r)}},i.save=function(e){try{null==e?i.storage.removeItem("debug"):i.storage.debug=e}catch(e){}},i.load=e,i.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},i.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),i.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],i.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},i.enable(e())}).call(i,n(4))},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(t){if(u===setTimeout)return setTimeout(t,0);if((u===r||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function i(){d&&l&&(d=!1,l.length?f=l.concat(f):y=-1,f.length&&s())}function s(){if(!d){var e=o(i);d=!0;for(var t=f.length;t;){for(l=f,f=[];++y<t;)l&&l[y].run();y=-1,t=f.length}l=null,d=!1,function(t){if(h===clearTimeout)return clearTimeout(t);if((h===n||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}(e)}}function a(e,t){this.fun=e,this.array=t}function c(){}var u,h,p=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:r}catch(e){u=r}try{h="function"==typeof clearTimeout?clearTimeout:n}catch(e){h=n}}();var l,f=[],d=!1,y=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new a(e,t)),1!==f.length||d||o(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.prependListener=c,p.prependOnceListener=c,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,a,t){function r(e){function n(){if(n.enabled){var o=n,e=+new Date,t=e-(c||e);o.diff=t,o.prev=c,o.curr=e,c=e;for(var i=new Array(arguments.length),r=0;r<i.length;r++)i[r]=arguments[r];i[0]=a.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var s=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;s++;var r=a.formatters[t];if("function"==typeof r){var n=i[s];e=r.call(o,n),i.splice(s,1),s--}return e}),a.formatArgs.call(o,i);(n.log||a.log||console.log.bind(console)).apply(o,i)}}return n.namespace=e,n.enabled=a.enabled(e),n.useColors=a.useColors(),n.color=function(e){var t,r=0;for(t in e)r=(r<<5)-r+e.charCodeAt(t),r|=0;return a.colors[Math.abs(r)%a.colors.length]}(e),"function"==typeof a.init&&a.init(n),n}(a=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},a.disable=function(){a.enable("")},a.enable=function(e){a.save(e),a.names=[],a.skips=[];for(var t=("string"==typeof e?e:"").split(/[\s,]+/),r=t.length,n=0;n<r;n++)t[n]&&("-"===(e=t[n].replace(/\*/g,".*?"))[0]?a.skips.push(new RegExp("^"+e.substr(1)+"$")):a.names.push(new RegExp("^"+e+"$")))},a.enabled=function(e){var t,r;for(t=0,r=a.skips.length;t<r;t++)if(a.skips[t].test(e))return!1;for(t=0,r=a.names.length;t<r;t++)if(a.names[t].test(e))return!0;return!1},a.humanize=t(6),a.names=[],a.skips=[],a.formatters={};var c},function(e,t){function i(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}var s=1e3,a=60*s,c=60*a,u=24*c,h=365.25*u;e.exports=function(e,t){t=t||{};var r,n,o=typeof e;if("string"===o&&0<e.length)return function(e){if(!(100<(e=String(e)).length)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*h;case"days":case"day":case"d":return r*u;case"hours":case"hour":case"hrs":case"hr":case"h":return r*c;case"minutes":case"minute":case"mins":case"min":case"m":return r*a;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(e);if("number"===o&&!1===isNaN(e))return t.long?i(n=e,u,"day")||i(n,c,"hour")||i(n,a,"minute")||i(n,s,"second")||n+" ms":u<=(r=e)?Math.round(r/u)+"d":c<=r?Math.round(r/c)+"h":a<=r?Math.round(r/a)+"m":s<=r?Math.round(r/s)+"s":r+"ms";throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,s,t){function r(){}function i(e){var t=""+e.type;return s.BINARY_EVENT!==e.type&&s.BINARY_ACK!==e.type||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data)),u("encoded %j as %s",e,t),t}function n(){this.reconstructor=null}function o(e){var t=0,r={type:Number(e.charAt(0))};if(null==s.types[r.type])return c();if(s.BINARY_EVENT===r.type||s.BINARY_ACK===r.type){for(var n="";"-"!==e.charAt(++t)&&(n+=e.charAt(t),t!=e.length););if(n!=Number(n)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(n)}if("/"===e.charAt(t+1))for(r.nsp="";++t;){if(","===(i=e.charAt(t)))break;if(r.nsp+=i,t===e.length)break}else r.nsp="/";var o=e.charAt(t+1);if(""!==o&&Number(o)==o){for(r.id="";++t;){var i;if(null==(i=e.charAt(t))||Number(i)!=i){--t;break}if(r.id+=e.charAt(t),t===e.length)break}r.id=Number(r.id)}return e.charAt(++t)&&(r=function(e,t){try{e.data=JSON.parse(t)}catch(e){return c()}return e}(r,e.substr(t))),u("decoded %s as %j",e,r),r}function a(e){this.reconPack=e,this.buffers=[]}function c(){return{type:s.ERROR,data:"parser error"}}var u=t(3)("socket.io-parser"),h=t(8),p=t(9),l=t(11),f=t(12);s.protocol=4,s.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],s.CONNECT=0,s.DISCONNECT=1,s.EVENT=2,s.ACK=3,s.ERROR=4,s.BINARY_EVENT=5,s.BINARY_ACK=6,s.Encoder=r,s.Decoder=n,r.prototype.encode=function(e,t){if(e.type!==s.EVENT&&e.type!==s.ACK||!p(e.data)||(e.type=e.type===s.EVENT?s.BINARY_EVENT:s.BINARY_ACK),u("encoding packet %j",e),s.BINARY_EVENT===e.type||s.BINARY_ACK===e.type)r=e,o=t,l.removeBlobs(r,function(e){var t=l.deconstructPacket(e),r=i(t.packet),n=t.buffers;n.unshift(r),o(n)});else{t([i(e)])}var r,o},h(n.prototype),n.prototype.add=function(e){var t;if("string"==typeof e)t=o(e),s.BINARY_EVENT===t.type||s.BINARY_ACK===t.type?(this.reconstructor=new a(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!f(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",t))}},n.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},a.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=l.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},a.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,r){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}(e.exports=n).prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var n,o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks["$"+e];if(r)for(var n=0,o=(r=r.slice(0)).length;n<o;++n)r[n].apply(this,t);return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(t,e,r){(function(i){var s=r(10),e=Object.prototype.toString,a="function"==typeof i.Blob||"[object BlobConstructor]"===e.call(i.Blob),c="function"==typeof i.File||"[object FileConstructor]"===e.call(i.File);t.exports=function e(t){if(!t||"object"!=typeof t)return!1;if(s(t)){for(var r=0,n=t.length;r<n;r++)if(e(t[r]))return!0;return!1}if("function"==typeof i.Buffer&&i.Buffer.isBuffer&&i.Buffer.isBuffer(t)||"function"==typeof i.ArrayBuffer&&t instanceof ArrayBuffer||a&&t instanceof Blob||c&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&e(t[o]))return!0;return!1}}).call(e,function(){return this}())},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,r,n){(function(e){var h=n(10),p=n(12),t=Object.prototype.toString,l="function"==typeof e.Blob||"[object BlobConstructor]"===t.call(e.Blob),f="function"==typeof e.File||"[object FileConstructor]"===t.call(e.File);r.deconstructPacket=function(e){var t=[],r=e.data,n=e;return n.data=function e(t,r){if(!t)return t;if(p(t)){var n={_placeholder:!0,num:r.length};return r.push(t),n}if(h(t)){for(var o=new Array(t.length),i=0;i<t.length;i++)o[i]=e(t[i],r);return o}if("object"==typeof t&&!(t instanceof Date)){o={};for(var s in t)o[s]=e(t[s],r);return o}return t}(r,t),n.attachments=t.length,{packet:n,buffers:t}},r.reconstructPacket=function(e,t){return e.data=function e(t,r){if(!t)return t;if(t&&t._placeholder)return r[t.num];if(h(t))for(var n=0;n<t.length;n++)t[n]=e(t[n],r);else if("object"==typeof t)for(var o in t)t[o]=e(t[o],r);return t}(e.data,t),e.attachments=void 0,e},r.removeBlobs=function(e,a){var c=0,u=e;(function e(t,r,n){if(!t)return t;if(l&&t instanceof Blob||f&&t instanceof File){c++;var o=new FileReader;o.onload=function(){n?n[r]=this.result:u=this.result,--c||a(u)},o.readAsArrayBuffer(t)}else if(h(t))for(var i=0;i<t.length;i++)e(t[i],i,t);else if("object"==typeof t&&!p(t))for(var s in t)e(t[s],s,t)})(u),c||a(u)}}).call(r,function(){return this}())},function(e,t){(function(t){e.exports=function(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}}).call(t,function(){return this}())},function(e,t,r){"use strict";function n(e,t){if(!(this instanceof n))return new n(e,t);e&&"object"===(void 0===e?"undefined":o(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var r=t.parser||a;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=r(14),i=r(39),s=r(8),a=r(7),u=r(41),h=r(42),p=r(3)("socket.io-client:manager"),l=r(37),f=r(43),d=Object.prototype.hasOwnProperty;(e.exports=n).prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)d.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},n.prototype.updateSocketIds=function(){for(var e in this.nsps)d.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},n.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},s(n.prototype),n.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},n.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},n.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(r,e){if(p("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;p("opening %s",this.uri),this.engine=c(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var o=u(t,"open",function(){n.onopen(),r&&r()}),i=u(t,"error",function(e){if(p("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",e),r){var t=new Error("Connection error");t.data=e,r(t)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;p("connect attempt will timeout after %d",s);var a=setTimeout(function(){p("connect attempt timed out after %d",s),o.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(o),this.subs.push(i),this},n.prototype.onopen=function(){p("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(u(e,"data",h(this,"ondata"))),this.subs.push(u(e,"ping",h(this,"onping"))),this.subs.push(u(e,"pong",h(this,"onpong"))),this.subs.push(u(e,"error",h(this,"onerror"))),this.subs.push(u(e,"close",h(this,"onclose"))),this.subs.push(u(this.decoder,"decoded",h(this,"ondecoded")))},n.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},n.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},n.prototype.ondata=function(e){this.decoder.add(e)},n.prototype.ondecoded=function(e){this.emit("packet",e)},n.prototype.onerror=function(e){p("error",e),this.emitAll("error",e)},n.prototype.socket=function(e,t){function r(){~l(o.connecting,n)||o.connecting.push(n)}var n=this.nsps[e];if(!n){n=new i(this,e,t),this.nsps[e]=n;var o=this;n.on("connecting",r),n.on("connect",function(){n.id=o.generateId(e)}),this.autoConnect&&r()}return n},n.prototype.destroy=function(e){var t=l(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},n.prototype.packet=function(r){p("writing packet %j",r);var n=this;r.query&&0===r.type&&(r.nsp+="?"+r.query),n.encoding?n.packetBuffer.push(r):(n.encoding=!0,this.encoder.encode(r,function(e){for(var t=0;t<e.length;t++)n.engine.write(e[t],r.options);n.encoding=!1,n.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},n.prototype.cleanup=function(){p("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){p("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(e){p("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();p("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var r=setTimeout(function(){t.skipReconnect||(p("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(p("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(p("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(r)}})}},n.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,r){e.exports=r(15)},function(e,t,r){e.exports=r(16),e.exports.parser=r(23)},function(t,e,u){(function(n){function p(e,t){if(!(this instanceof p))return new p(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=a(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=a(t.host).host),this.secure=null!=t.secure?t.secure:n.location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||(n.location?location.hostname:"localhost"),this.port=t.port||(n.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode;var r="object"==typeof n&&n;r.global===r&&(t.extraHeaders&&0<Object.keys(t.extraHeaders).length&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}var o=u(17),e=u(8),l=u(3)("engine.io-client:socket"),i=u(37),s=u(23),a=u(2),r=u(38),c=u(31);(t.exports=p).priorWebsocketSuccess=!1,e(p.prototype),p.protocol=s.protocol,(p.Socket=p).Transport=u(22),p.transports=u(17),p.parser=u(23),p.prototype.createTransport=function(e){l('creating transport "%s"',e);var t=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var r=this.transportOptions[e]||{};this.id&&(t.sid=this.id);return new o[e]({query:t,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0})},p.prototype.open=function(){var e;if(this.rememberUpgrade&&p.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},p.prototype.setTransport=function(e){l("setting transport %s",e.name);var t=this;this.transport&&(l("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),(this.transport=e).on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},p.prototype.probe=function(r){function e(){if(h.onlyBinaryUpgrades){var e=!this.supportsBinary&&h.transport.supportsBinary;u=u||e}u||(l('probe transport "%s" opened',r),c.send([{type:"ping",data:"probe"}]),c.once("packet",function(e){if(!u)if("pong"===e.type&&"probe"===e.data){if(l('probe transport "%s" pong',r),h.upgrading=!0,h.emit("upgrading",c),!c)return;p.priorWebsocketSuccess="websocket"===c.name,l('pausing current transport "%s"',h.transport.name),h.transport.pause(function(){u||"closed"!==h.readyState&&(l("changing transport and sending upgrade packet"),a(),h.setTransport(c),c.send([{type:"upgrade"}]),h.emit("upgrade",c),c=null,h.upgrading=!1,h.flush())})}else{l('probe transport "%s" failed',r);var t=new Error("probe error");t.transport=c.name,h.emit("upgradeError",t)}}))}function n(){u||(u=!0,a(),c.close(),c=null)}function t(e){var t=new Error("probe error: "+e);t.transport=c.name,n(),l('probe transport "%s" failed because of error: %s',r,e),h.emit("upgradeError",t)}function o(){t("transport closed")}function i(){t("socket closed")}function s(e){c&&e.name!==c.name&&(l('"%s" works - aborting "%s"',e.name,c.name),n())}function a(){c.removeListener("open",e),c.removeListener("error",t),c.removeListener("close",o),h.removeListener("close",i),h.removeListener("upgrading",s)}l('probing transport "%s"',r);var c=this.createTransport(r,{probe:1}),u=!1,h=this;p.priorWebsocketSuccess=!1,c.once("open",e),c.once("error",t),c.once("close",o),this.once("close",i),this.once("upgrading",s),c.open()},p.prototype.onOpen=function(){if(l("socket open"),this.readyState="open",p.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){l("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},p.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(l('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(r(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else l('packet received with socket readyState "%s"',this.readyState)},p.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},p.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},p.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){l("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},p.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},p.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)===this.writeBuffer.length?this.emit("drain"):this.flush()},p.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(l("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},p.prototype.write=p.prototype.send=function(e,t,r){return this.sendPacket("message",e,t,r),this},p.prototype.sendPacket=function(e,t,r,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState){(r=r||{}).compress=!1!==r.compress;var o={type:e,data:t,options:r};this.emit("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}},p.prototype.close=function(){function e(){n.onClose("forced close"),l("socket closing - telling transport to close"),n.transport.close()}function t(){n.removeListener("upgrade",t),n.removeListener("upgradeError",t),e()}function r(){n.once("upgrade",t),n.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():e()}):this.upgrading?r():e()}return this},p.prototype.onError=function(e){l("socket error %j",e),p.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},p.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){l('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},p.prototype.filterUpgrades=function(e){for(var t=[],r=0,n=e.length;r<n;r++)~i(this.transports,e[r])&&t.push(e[r]);return t}}).call(e,function(){return this}())},function(e,t,r){(function(s){var a=r(18),c=r(20),u=r(34),e=r(35);t.polling=function(e){var t=!1,r=!1,n=!1!==e.jsonp;if(s.location){var o="https:"===location.protocol,i=location.port;i||(i=o?443:80),t=e.hostname!==location.hostname||i!==e.port,r=e.secure!==o}if(e.xdomain=t,e.xscheme=r,"open"in new a(e)&&!e.forceJSONP)return new c(e);if(!n)throw new Error("JSONP disabled");return new u(e)},t.websocket=e}).call(t,function(){return this}())},function(e,t,r){(function(o){var i=r(19);e.exports=function(e){var t=e.xdomain,r=e.xscheme,n=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||i))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!r&&n)return new XDomainRequest}catch(e){}if(!t)try{return new(o[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}).call(t,function(){return this}())},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(h,e,p){(function(o){function t(){}function e(e){if(n.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,o.location){var t="https:"===location.protocol,r=location.port;r||(r=t?443:80),this.xd=e.hostname!==o.location.hostname||r!==e.port,this.xs=e.secure!==t}}function i(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function r(){for(var e in i.requests)i.requests.hasOwnProperty(e)&&i.requests[e].abort()}var s=p(18),n=p(21),a=p(8),c=p(32),u=p(3)("engine.io-client:polling-xhr");h.exports=e,h.exports.Request=i,c(e,n),e.prototype.supportsBinary=!0,e.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new i(e)},e.prototype.doWrite=function(e,t){var r="string"!=typeof e&&void 0!==e,n=this.request({method:"POST",data:e,isBinary:r}),o=this;n.on("success",t),n.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=n},e.prototype.doPoll=function(){u("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},a(i.prototype),i.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new s(e),r=this;try{u("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(var n in this.extraHeaders)this.extraHeaders.hasOwnProperty(n)&&t.setRequestHeader(n,this.extraHeaders[n])}}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){r.onLoad()},t.onerror=function(){r.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState){var e;try{e=t.getResponseHeader("Content-Type")}catch(e){}"application/octet-stream"===e&&(t.responseType="arraybuffer")}4===t.readyState&&(200===t.status||1223===t.status?r.onLoad():setTimeout(function(){r.onError(t.status)},0))},u("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){r.onError(e)},0)}o.document&&(this.index=i.requestsCount++,i.requests[this.index]=this)},i.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},i.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},i.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},i.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=t:this.xhr.onreadystatechange=t,e)try{this.xhr.abort()}catch(e){}o.document&&delete i.requests[this.index],this.xhr=null}},i.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},i.prototype.hasXDR=function(){return void 0!==o.XDomainRequest&&!this.xs&&this.enablesXDR},i.prototype.abort=function(){this.cleanup()},i.requestsCount=0,i.requests={},o.document&&(o.attachEvent?o.attachEvent("onunload",r):o.addEventListener&&o.addEventListener("beforeunload",r,!1))}).call(e,function(){return this}())},function(e,t,r){function n(e){var t=e&&e.forceBase64;h&&!t||(this.supportsBinary=!1),o.call(this,e)}var o=r(22),i=r(31),s=r(23),a=r(32),c=r(33),u=r(3)("engine.io-client:polling");e.exports=n;var h=null!=new(r(18))({xdomain:!1}).responseType;a(n,o),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(e){function t(){u("paused"),r.readyState="paused",e()}var r=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(u("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){u("pre-pause polling complete"),--n||t()})),this.writable||(u("we are currently writing - waiting to pause"),n++,this.once("drain",function(){u("pre-pause writing complete"),--n||t()}))}else t()},n.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(e){var n=this;u("polling got data %s",e);s.decodePayload(e,this.socket.binaryType,function(e,t,r){return"opening"===n.readyState&&n.onOpen(),"close"===e.type?(n.onClose(),!1):void n.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function e(){u("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(u("transport open - closing"),e()):(u("transport not open - deferring close"),this.once("open",e))},n.prototype.write=function(e){var t=this;this.writable=!1;var r=function(){t.writable=!0,t.emit("drain")};s.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,r)})},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",r="";!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(r=":"+this.port),e.length&&(e="?"+e);return t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e}},function(e,t,r){function n(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var o=r(23);r(8)((e.exports=n).prototype),n.prototype.onError=function(e,t){var r=new Error(e);return r.type="TransportError",r.description=t,this.emit("error",r),this},n.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},n.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(e){var t=o.decodePacket(e,this.socket.binaryType);this.onPacket(t)},n.prototype.onPacket=function(e){this.emit("packet",e)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,m,n){(function(u){function a(e,t,r){if(!t)return m.encodeBase64Packet(e,r);if(p)return function(e,t,r){if(!t)return m.encodeBase64Packet(e,r);var n=new FileReader;return n.onload=function(){e.data=n.result,m.encodePacket(e,t,!0,r)},n.readAsArrayBuffer(e.data)}(e,t,r);var n=new Uint8Array(1);n[0]=f[e.type];return r(new g([n.buffer,e.data]))}function o(e,t,r){for(var o=new Array(e.length),n=c(e.length,r),i=function(r,e,n){t(e,function(e,t){o[r]=t,n(e,o)})},s=0;s<e.length;s++)i(s,e[s],n)}var i,e=n(24),s=n(9),l=n(25),c=n(26),h=n(27);u&&u.ArrayBuffer&&(i=n(29));var t="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),r="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),p=t||r;m.protocol=3;var f=m.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=e(f),y={type:"error",data:"parser error"},g=n(30);m.encodePacket=function(e,t,r,n){"function"==typeof t&&(n=t,t=!1),"function"==typeof r&&(n=r,r=null);var o,i=void 0===e.data?void 0:e.data.buffer||e.data;if(u.ArrayBuffer&&i instanceof ArrayBuffer)return function(e,t,r){if(!t)return m.encodeBase64Packet(e,r);var n=e.data,o=new Uint8Array(n),i=new Uint8Array(1+n.byteLength);i[0]=f[e.type];for(var s=0;s<o.length;s++)i[s+1]=o[s];return r(i.buffer)}(e,t,n);if(g&&i instanceof u.Blob)return a(e,t,n);if(i&&i.base64)return o=e,n("b"+m.packets[o.type]+o.data.data);var s=f[e.type];return void 0!==e.data&&(s+=r?h.encode(String(e.data),{strict:!1}):String(e.data)),n(""+s)},m.encodeBase64Packet=function(t,r){var n,o="b"+m.packets[t.type];if(g&&t.data instanceof u.Blob){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];r(o+e)},i.readAsDataURL(t.data)}try{n=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var s=new Uint8Array(t.data),a=new Array(s.length),c=0;c<s.length;c++)a[c]=s[c];n=String.fromCharCode.apply(null,a)}return o+=u.btoa(n),r(o)},m.decodePacket=function(e,t,r){if(void 0===e)return y;if("string"==typeof e){if("b"===e.charAt(0))return m.decodeBase64Packet(e.substr(1),t);if(r&&!1===(e=function(e){try{e=h.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return y;var n=e.charAt(0);return Number(n)==n&&d[n]?1<e.length?{type:d[n],data:e.substring(1)}:{type:d[n]}:y}n=new Uint8Array(e)[0];var o=l(e,1);return g&&"blob"===t&&(o=new g([o])),{type:d[n],data:o}},m.decodeBase64Packet=function(e,t){var r=d[e.charAt(0)];if(!i)return{type:r,data:{base64:!0,data:e.substr(1)}};var n=i.decode(e.substr(1));return"blob"===t&&g&&(n=new g([n])),{type:r,data:n}},m.encodePayload=function(e,t,r){"function"==typeof t&&(r=t,t=null);var n=s(e);return t&&n?g&&!p?m.encodePayloadAsBlob(e,r):m.encodePayloadAsArrayBuffer(e,r):e.length?void o(e,function(e,r){m.encodePacket(e,!!n&&t,!1,function(e){r(null,(t=e).length+":"+t);var t})},function(e,t){return r(t.join(""))}):r("0:")},m.decodePayload=function(e,t,r){if("string"!=typeof e)return m.decodePayloadAsBinary(e,t,r);"function"==typeof t&&(r=t,t=null);var n;if(""===e)return r(y,0,1);for(var o,i,s="",a=0,c=e.length;a<c;a++){var u=e.charAt(a);if(":"===u){if(""===s||s!=(o=Number(s)))return r(y,0,1);if(s!=(i=e.substr(a+1,o)).length)return r(y,0,1);if(i.length){if(n=m.decodePacket(i,t,!1),y.type===n.type&&y.data===n.data)return r(y,0,1);if(!1===r(n,a+o,c))return}a+=o,s=""}else s+=u}return""!==s?r(y,0,1):void 0},m.encodePayloadAsArrayBuffer=function(e,n){return e.length?void o(e,function(e,t){m.encodePacket(e,!0,!0,function(e){return t(null,e)})},function(e,t){var r=t.reduce(function(e,t){var r;return e+(r="string"==typeof t?t.length:t.byteLength).toString().length+r+2},0),s=new Uint8Array(r),a=0;return t.forEach(function(e){var t="string"==typeof e,r=e;if(t){for(var n=new Uint8Array(e.length),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);r=n.buffer}s[a++]=t?0:1;var i=r.byteLength.toString();for(o=0;o<i.length;o++)s[a++]=parseInt(i[o]);s[a++]=255;for(n=new Uint8Array(r),o=0;o<n.length;o++)s[a++]=n[o]}),n(s.buffer)}):n(new ArrayBuffer(0))},m.encodePayloadAsBlob=function(e,r){o(e,function(e,a){m.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);e=r.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),i=new Uint8Array(o.length+1);for(n=0;n<o.length;n++)i[n]=parseInt(o[n]);if(i[o.length]=255,g){var s=new g([t.buffer,i.buffer,e]);a(null,s)}})},function(e,t){return r(new g(t))})},m.decodePayloadAsBinary=function(e,r,n){"function"==typeof r&&(n=r,r=null);for(var t=e,o=[];0<t.byteLength;){for(var i=new Uint8Array(t),s=0===i[0],a="",c=1;255!==i[c];c++){if(310<a.length)return n(y,0,1);a+=i[c]}t=l(t,2+a.length),a=parseInt(a);var u=l(t,0,a);if(s)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){var h=new Uint8Array(u);u="";for(c=0;c<h.length;c++)u+=String.fromCharCode(h[c])}o.push(u),t=l(t,a)}var p=o.length;o.forEach(function(e,t){n(m.decodePacket(e,r,!0),t,p)})}}).call(m,function(){return this}())},function(e,t){e.exports=Object.keys||function(e){var t=[],r=Object.prototype.hasOwnProperty;for(var n in e)r.call(e,n)&&t.push(n);return t}},function(e,t){e.exports=function(e,t,r){var n=e.byteLength;if(t=t||0,r=r||n,e.slice)return e.slice(t,r);if(t<0&&(t+=n),r<0&&(r+=n),n<r&&(r=n),n<=t||r<=t||0===n)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(r-t),s=t,a=0;s<r;s++,a++)i[a]=o[s];return i.buffer}},function(e,t){function s(){}e.exports=function(e,r,n){function o(e,t){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(i=!0,r(e),r=n):0!==o.count||i||r(null,t)}var i=!1;return n=n||s,0===(o.count=e)?r():o}},function(e,y,g){var m;(function(f,d){!function(e){function a(e){for(var t,r,n=[],o=0,i=e.length;o<i;)55296<=(t=e.charCodeAt(o++))&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function n(e,t){if(55296<=e&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function o(e,t){return l(e>>t&63|128)}function c(e,t){if(0==(4294967168&e))return l(e);var r="";return 0==(4294965248&e)?r=l(e>>6&31|192):0==(4294901760&e)?(n(e,t)||(e=65533),r=l(e>>12&15|224),r+=o(e,6)):0==(4292870144&e)&&(r=l(e>>18&7|240),r+=o(e,12),r+=o(e,6)),r+l(63&e|128)}function i(){if(h<=p)throw Error("Invalid byte index");var e=255&u[p];if(p++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function s(e){var t,r;if(h<p)throw Error("Invalid byte index");if(p==h)return!1;if(t=255&u[p],p++,0==(128&t))return t;if(192==(224&t)){if(128<=(r=(31&t)<<6|i()))return r;throw Error("Invalid continuation byte")}if(224==(240&t)){if(2048<=(r=(15&t)<<12|i()<<6|i()))return n(r,e)?r:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(65536<=(r=(7&t)<<18|i()<<12|i()<<6|i())&&r<=1114111))return r;throw Error("Invalid UTF-8 detected")}var t=("object"==typeof f&&f&&f.exports,"object"==typeof d&&d);t.global!==t&&t.window!==t||t;var u,h,p,l=String.fromCharCode,r={version:"2.1.2",encode:function(e,t){for(var r=!1!==(t=t||{}).strict,n=a(e),o=n.length,i=-1,s="";++i<o;)s+=c(n[i],r);return s},decode:function(e,t){var r=!1!==(t=t||{}).strict;u=a(e),h=u.length,p=0;for(var n,o=[];!1!==(n=s(r));)o.push(n);return function(e){for(var t,r=e.length,n=-1,o="";++n<r;)65535<(t=e[n])&&(o+=l((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=l(t);return o}(o)}};void 0===(m=function(){return r}.call(y,g,y,f))||(f.exports=m)}()}).call(y,g(28)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){!function(){"use strict";for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=new Uint8Array(256),e=0;e<i.length;e++)p[i.charCodeAt(e)]=e;t.encode=function(e){var t,r=new Uint8Array(e),n=r.length,o="";for(t=0;t<n;t+=3)o+=i[r[t]>>2],o+=i[(3&r[t])<<4|r[t+1]>>4],o+=i[(15&r[t+1])<<2|r[t+2]>>6],o+=i[63&r[t+2]];return n%3==2?o=o.substring(0,o.length-1)+"=":n%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,r,n,o,i,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var u=new ArrayBuffer(s),h=new Uint8Array(u);for(t=0;t<a;t+=4)r=p[e.charCodeAt(t)],n=p[e.charCodeAt(t+1)],o=p[e.charCodeAt(t+2)],i=p[e.charCodeAt(t+3)],h[c++]=r<<2|n>>4,h[c++]=(15&n)<<4|o>>2,h[c++]=(3&o)<<6|63&i;return u}}()},function(c,e){(function(e){function o(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.buffer instanceof ArrayBuffer){var n=r.buffer;if(r.byteLength!==n.byteLength){var o=new Uint8Array(r.byteLength);o.set(new Uint8Array(n,r.byteOffset,r.byteLength)),n=o.buffer}e[t]=n}}}function t(e,t){t=t||{};var r=new i;o(e);for(var n=0;n<e.length;n++)r.append(e[n]);return t.type?r.getBlob(t.type):r.getBlob()}function r(e,t){return o(e),new Blob(e,t||{})}var i=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,n=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),s=n&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),a=i&&i.prototype.append&&i.prototype.getBlob;c.exports=n?s?e.Blob:r:a?t:void 0}).call(e,function(){return this}())},function(e,t){t.encode=function(e){var t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t},t.decode=function(e){for(var t={},r=e.split("&"),n=0,o=r.length;n<o;n++){var i=r[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},function(e,t){e.exports=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t){"use strict";function r(e){for(var t="";t=i[e%s]+t,0<(e=Math.floor(e/s)););return t}function n(){var e=r(+new Date);return e!==o?(c=0,o=e):e+"."+r(c++)}for(var o,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s=64,a={},c=0,u=0;u<s;u++)a[i[u]]=u;n.encode=r,n.decode=function(e){var t=0;for(u=0;u<e.length;u++)t=t*s+a[e.charAt(u)];return t},e.exports=n},function(s,e,a){(function(r){function n(){}function e(e){o.call(this,e),this.query=this.query||{},i||(r.___eio||(r.___eio=[]),i=r.___eio),this.index=i.length;var t=this;i.push(function(e){t.onData(e)}),this.query.j=this.index,r.document&&r.addEventListener&&r.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=n)},!1)}var o=a(21),t=a(32);s.exports=e;var i,u=/\n/g,h=/\\n/g;t(e,o),e.prototype.supportsBinary=!1,e.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},e.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(e,r):(document.head||document.body).appendChild(e),this.script=e;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},e.prototype.doWrite=function(e,t){function r(){n(),t()}function n(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(e){o.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+o.iframeId+'">';i=document.createElement(e)}catch(e){(i=document.createElement("iframe")).name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}var o=this;if(!this.form){var i,s=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=c,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),n(),e=e.replace(h,"\\\n"),this.area.value=e.replace(u,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&r()}:this.iframe.onload=r}}).call(e,function(){return this}())},function(p,e,l){(function(i){function e(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=u&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(h=t),r.call(this,e)}var t,r=l(22),s=l(23),n=l(31),o=l(32),a=l(33),c=l(3)("engine.io-client:websocket"),u=i.WebSocket||i.MozWebSocket;if("undefined"==typeof window)try{t=l(36)}catch(e){}var h=u;h||"undefined"!=typeof window||(h=t),o(p.exports=e,r),e.prototype.name="websocket",e.prototype.supportsBinary=!0,e.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx,r.key=this.key,r.passphrase=this.passphrase,r.cert=this.cert,r.ca=this.ca,r.ciphers=this.ciphers,r.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(r.headers=this.extraHeaders),this.localAddress&&(r.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?t?new h(e,t):new h(e):new h(e,t,r)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},e.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},e.prototype.write=function(e){var n=this;this.writable=!1;for(var o=e.length,t=0,r=o;t<r;t++)!function(r){s.encodePacket(r,n.supportsBinary,function(e){if(!n.usingBrowserWebSocket){var t={};if(r.options&&(t.compress=r.options.compress),n.perMessageDeflate){("string"==typeof e?i.Buffer.byteLength(e):e.length)<n.perMessageDeflate.threshold&&(t.compress=!1)}}try{n.usingBrowserWebSocket?n.ws.send(e):n.ws.send(e,t)}catch(e){c("websocket closed before onclose event")}--o||(n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0))})}(e[t])},e.prototype.onClose=function(){r.prototype.onClose.call(this)},e.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},e.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",r="";this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(r=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||(e.b64=1),(e=n.encode(e)).length&&(e="?"+e);return t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+r+this.path+e},e.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===e.prototype.name)}}).call(e,function(){return this}())},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t){(function(t){var r=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(s,"").replace(a,""),t.JSON&&JSON.parse?JSON.parse(e):r.test(e.replace(n,"@").replace(o,"]").replace(i,""))?new Function("return "+e)():void 0):null}}).call(t,function(){return this}())},function(e,t,r){"use strict";function n(e,t,r){this.io=e,this.nsp=t,(this.json=this).ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,r&&r.query&&(this.query=r.query),this.io.autoConnect&&this.open()}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(7),s=r(8),a=r(40),c=r(41),u=r(42),h=r(3)("socket.io-client:socket"),p=r(31);e.exports=n;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=s.prototype.emit;s(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[c(e,"open",u(this,"onopen")),c(e,"packet",u(this,"onpacket")),c(e,"close",u(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},n.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},n.prototype.emit=function(e){if(l.hasOwnProperty(e))return f.apply(this,arguments),this;var t=a(arguments),r={type:i.EVENT,data:t,options:{}};return r.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(h("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),delete this.flags,this},n.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},n.prototype.onopen=function(){if(h("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===o(this.query)?p.encode(this.query):this.query;h("sending connect packet with query %s",e),this.packet({type:i.CONNECT,query:e})}else this.packet({type:i.CONNECT})},n.prototype.onclose=function(e){h("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},n.prototype.onpacket=function(e){if(e.nsp===this.nsp)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},n.prototype.onevent=function(e){var t=e.data||[];h("emitting event %j",t),null!=e.id&&(h("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},n.prototype.ack=function(t){var r=this,n=!1;return function(){if(!n){n=!0;var e=a(arguments);h("sending ack %j",e),r.packet({type:i.ACK,id:t,data:e})}}},n.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(h("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):h("bad ack %s",e.id)},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){h("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(h("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},n.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},function(e,t){e.exports=function(e,t){for(var r=[],n=(t=t||0)||0;n<e.length;n++)r[n-t]=e[n];return r}},function(e,t){"use strict";e.exports=function(e,t,r){return e.on(t,r),{destroy:function(){e.removeListener(t,r)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t){function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}(e.exports=r).prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-r:e+r}return 0|Math.min(e,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}}])});define("avj",["require","exports","ap","bN","gl","fO","fZ"],function(e,t,n,r,o,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(r){n.__extends(e,r);function e(e){void 0===e&&(e={});var t=r.call(this,e)||this;t._itemUrlHelper=t.resources.consume(i.resourceKey);t._apiUrlHelper=t.resources.consume(s.resourceKey);t._dataRequestor=new(t.child(o.typeResourceKey))({});return t}e.prototype.getSubscriptions=function(e){var t=this._itemUrlHelper.getItemUrlParts(e.key),r=this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl).segment("Subscriptions");return this._dataRequestor.getData({url:r.toString(),qosName:"GetSubscriptions",method:"GET",noRedirect:!0}).then(function(e){var t=[];e&&e.d&&e.d.results&&(t=e.d.results);return t})};e.prototype.updateSubscription=function(e){throw new Error("Not Implemented")};e.prototype.getRootSubscriptions=function(){throw new Error("Not Implemented")};e.prototype.createRootSubscription=function(e){throw new Error("Not Implemented")};e.prototype.updateRootSubscription=function(e){throw new Error("Not Implemented")};e.prototype.deleteRootSubscription=function(e){throw new Error("Not Implemented")};return e}(r.default);t.default=a});define("avi",["require","exports","ap","bN","bn","bA","bp","bd","ex","ey","ds","ej","in","ep","ba","bb","iJ","fZ","fO","gl","afF","iH","dZ","iC","iE"],function(e,t,r,o,C,n,w,k,l,i,c,f,x,s,a,u,h,p,d,y,g,m,v,b,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=function(n){r.__extends(e,n);function e(e,t){var r=n.call(this,e,t)||this;r._itemsStore=t.itemsStore;r._urlDataSource=t.urlDataSource;r._apiUrlHelper=t.apiUrlHelper;r._itemUrlHelper=t.itemUrlHelper;r._microServiceDataSource=t.microServiceDataSource;r._pushChannelProvider=t.pushChannelProvider;r._vroomDataContext=t.vroomDataContext;r._pageContext=t.pageContext;r._listContext=t.listContext;r._dataRequestor=new(r.child(y.typeResourceKey))({});return r}e.prototype.isEnabled=function(){var e=Number(this._pageContext.webTemplate),t=e===s.default.mySite;u.default.isActivated("52fb8675-82cf-44a3-8b64-243ef0cfd4c8","3/22/2018","Disable auto refresh for ODB shares")&&(t=t&&this._pageContext.isSiteAdmin);var r=e===s.default.group&&!!this._pageContext.groupId,n=e===s.default.teamSite,o=e===s.default.sitePagePublishing;return a.isFeatureEnabled(a.EnablePushChannelAutoRefresh)&&(t||r||n||o)};e.prototype.isAuthValid=function(){return this._isGenericList()?!u.default.isActivated("2570cfba-9a8f-4ba5-a86f-501082ab4613","3/28/2018","Disable auto refresh for lists"):this._microServiceDataSource.hasAuthData()&&!this._microServiceDataSource.hasAuthDataExpired()};e.prototype.onGetChanges=function(e){var i=this;if(this._isGenericList()){var t,r,s=e&&"SPO_LIST,"===e.substr(0,9),n=this._getListUrl(!0).segment("RenderListDataAsStream");if(s){var o=e.split(","),a=o[1],c=o[2],u='<Eq><FieldRef Name="Modified" /><Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+c+"</Value></Eq>",h='<Gt><FieldRef Name="ID" /><Value Type="Number">'+a+"</Value></Gt>";t=w.combineFilters([u,h],C.CamlTags.and);var p='<Gt><FieldRef Name="Modified" /><Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+c+"</Value></Gt>";t=w.combineFilters([t,p],C.CamlTags.or);var l=this._getListColumns();if(l){r=["ID","FileRef","Modified","Title"];for(var f=0,d=l;f<d.length;f++){var y=d[f];r.push(y.internalName)}}}else r=["ID","FileRef","Modified"];var g=s?"Modified":"ID",m=s,v=s?200:1,b=new x.default("<View></View>");t&&b.addFilters([t]);r&&b.replaceFields(r);b.updateSort({fieldName:g,isAscending:m});b.updateRowLimit({rowLimit:v,isPerPage:!1});var _={viewXml:b.getEffectiveViewXml(),requestDatesInUtc:!0},S=k.getAdditionalPostData(_);return this._dataRequestor.getData({url:n.toString(),parseResponse:function(e){var t=JSON.parse(e);if(t&&t.Row){var r=t.Row,n=i._getLastIdInList(r),o=s?i._getLastModifiedTimeInList(r):(new Date).toISOString();return{value:r.map(function(e){return{id:e.FileRef,key:e.FileRef,name:e.Title,lastModifiedDateTime:e.Modified,parentReference:{id:i._pageContext.listUrl,driveId:"",path:""},properties:e}}),"@delta.token":"SPO_LIST,"+n+","+o,"@odata.nextLink":void 0}}},qosName:"ItemAutoRefreshDataSource.onGetChanges",method:"POST",additionalPostData:S,noRedirect:!0})}};e.prototype.createSubscription=function(r,e,t){var n=this;if(this._isGenericList()){var o=this._getListUrl(!1);o=r?o.method("Subscriptions",{guid:r}).segment("Update"):o.segments("Subscriptions","Add");var i={parameters:{resource:this._pageContext.listId,notificationUrl:e,expirationDateTime:t.toISOString(),clientState:""}};return this._dataRequestor.getData({url:o.toString(),parseResponse:function(e){var t=JSON.parse(e);if(t&&t.d){delete t.d.__metadata;r&&(t.d.id=r);n._subscriptionListUrl=n._getListUrl(!1);return t.d}throw new Error("Invalid subscription object")},additionalPostData:JSON.stringify(i),qosName:"ItemAutoRefreshDataSource.createSubscription",method:"POST",noRedirect:!0})}this._subscriptionListUrl=void 0};e.prototype.onSubscriptionCreated=function(){this._isGenericList()||(this._subscriptionListUrl=void 0)};e.prototype.deleteSubscription=function(e){if(this._subscriptionListUrl){var t=this._subscriptionListUrl.segment("Subscriptions('"+e+"')");this._subscriptionListUrl=void 0;return this._dataRequestor.getData({url:t.toString(),parseResponse:function(e){},qosName:"ItemAutoRefreshDataSource.deleteSubscription",method:"DELETE",noRedirect:!0})}};e.prototype.getChangesHeaders=function(){return{"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"}};e.prototype.parseChangesResponse=function(e){for(var t=this._isGenericList(),r=[],n=0,o=e.value;n<o.length;n++){var i=o[n],s=null;if(i.webUrl&&!this._vroomDataContext.getPathFromItemId(i.id)){var a=new f.default(i.webUrl).getPath();this._vroomDataContext.setFileSystemIdMapping(i.id,a);this._pushChannelProvider.log(g.PushChannelLogSource.ItemAutoRefreshDataSource,"Adding missing item mapping",i.id,a)}if(i.parentReference)s=i.parentReference.id;else if(i.root)continue;var c=void 0,u=t?i.properties:void 0;if(u){c={};for(var h=0,p=Object.keys(u);h<p.length;h++){var l=p[h];c[0===l.indexOf("OData_")?l.substr(6):l]=u[l]}}r.push({deleted:!!i.deleted,id:i.id,eTag:i.eTag,parentId:s,dateModified:i.lastModifiedDateTime,name:i.name,requiresMapping:!t,properties:c,isShared:!!i.shared})}return r};e.prototype.onMessage=function(e){if(this._isGenericList()&&0===e.length){var t=this._urlDataSource.getKey(((n={}).id=this._pageContext.listUrl,n)),r=void 0;if(a=this._itemsStore.getItem(t)){r=a();this._pushChannelProvider.log(g.PushChannelLogSource.ItemAutoRefreshDataSource,"Refreshing list due to deleted item",r);return[r]}return[]}var n,o=[];e.sort(function(e,t){return e.parentId?0:1});for(var i=0;i<e.length;i++){var s=e[i];this._pushChannelProvider.log(g.PushChannelLogSource.ItemAutoRefreshDataSource,"onMessage",s);var a;r=void 0;if(a=this._getItem(s.id,s.requiresMapping)){r=a();var c=this._hasItemChanged(s,r);this._pushChannelProvider.log(g.PushChannelLogSource.ItemAutoRefreshDataSource,"Changed item: "+c,r);if(!1!==c)r=r.parent||r;else{r=null;this._pushChannelProvider.log(g.PushChannelLogSource.ItemAutoRefreshDataSource,"Ignoring item, we already have the latest");for(var u=i+1;u<e.length;u++){if(e[u].id===s.parentId){this._pushChannelProvider.log(g.PushChannelLogSource.ItemAutoRefreshDataSource,"Removing parent to prevent a refresh");e.splice(u,1);break}}}}else s.parentId&&(a=this._getItem(s.parentId,s.requiresMapping))&&(r=a());r&&o.push(r)}return o};e.prototype._getItem=function(e,t){var r,n=t?this._vroomDataContext.getPathFromItemId(e):e;if(n){var o=this._urlDataSource.getKey(((r={}).id=n,r));return this._itemsStore.getItem(o)}return null};e.prototype._hasItemChanged=function(u,h){if(u.deleted)return!!h.parent&&"Item deleted";if(u.dateModified&&h.dateModifiedValue){var e=new Date(u.dateModified),t=new Date(h.dateModifiedValue);e.setSeconds(0,0);t.setSeconds(0,0);if(1e3<=Math.abs(e.getTime()-t.getTime()))return"Item date modified changed from "+h.dateModifiedValue+" to "+u.dateModified}if(h.isRootFolder)return!1;if(u.name!==h.name)return"Item name changed from "+h.name+" to "+u.name;if(void 0!==h.sharingType){var r=h.sharingType===c.default.Shared;if(u.isShared!==r)return"Item acl changed from "+r+" to "+u.isShared}if(h.listItem){if(u.id!==h.id)return"List item id changed from "+h.id+" to "+u.id}else if(u.id!==h.itemId)return"Item id changed from "+h.id+" to "+u.id;var n=this._getListColumns();if(n&&u.properties&&h.properties)for(var o=function(e){for(var t=e.key,r=0,n=Object.keys(u.properties).filter(function(e){return 0===e.indexOf(t)});r<n.length;r++){var o=n[r],i=h.properties[o],s=u.properties[o];try{"object"==typeof i&&(i=JSON.stringify(i));"object"==typeof s&&(s=JSON.stringify(s));switch(e.fieldType){case l.default.DateTime:var a=Date.parse(i),c=Date.parse(s);if(!isNaN(a)&&!isNaN(c)){i=a;s=c}}}catch(e){p._pushChannelProvider.log(g.PushChannelLogSource.ItemAutoRefreshDataSource,"Failed to reformat values for property "+o,i,s,e);continue}if(i!==s)return{value:'Item property "'+o+'" changed from "'+i+'" ('+typeof i+') to "'+s+'" ('+typeof s+")"}}},p=this,i=0,s=n;i<s.length;i++){var a=o(s[i]);if("object"==typeof a)return a.value}return!1};e.prototype._isGenericList=function(){return this._pageContext.listBaseTemplate&&Number(this._pageContext.listBaseTemplate)===i.default.genericList};e.prototype._getListColumns=function(){if(this._isGenericList()&&this._listContext&&this._listContext.listSchema)return this._listContext.listSchema.filter(function(e){return!!e.name&&e.fieldType!==l.default.Title})};e.prototype._getListUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:this._pageContext.listUrl,listUrl:this._pageContext.listUrl});return e?this._apiUrlHelper.build().webByItemUrl(t).method("GetList",this._pageContext.listUrl):this._apiUrlHelper.build().listById(t,this._pageContext.listId)};e.prototype._getLastIdInList=function(e){return e&&0<e.length?Math.max.apply(Math,e.map(function(e){return parseInt(e.ID,10)})):0};e.prototype._getLastModifiedTimeInList=function(e){if(e&&0<e.length){for(var t=void 0,r=void 0,n=0,o=e;n<o.length;n++){var i=o[n].Modified;if(i){var s=new Date(i);if(void 0===r||r<s){r=s;t=i}}}return t}return(new Date).toISOString()};e.dependencies=r.__assign({},o.BaseModel.dependencies,{itemsStore:h.resourceKey,urlDataSource:v.url,apiUrlHelper:p.resourceKey,itemUrlHelper:d.resourceKey,microServiceDataSource:v.microService,pushChannelProvider:m.resourceKey,vroomDataContext:b.dataContext,pageContext:_.pageContext,listContext:_.listContext});return e}(o.BaseModel);t.default=S;t.resourceKey=n.createResolvedResourceKey(e("module").id,S)});define("avd",["require","exports","ap","bN","aC","ej","aM","aN","aI","aI","bA","iJ","afF","avf","vx","gf","dZ"],function(e,t,r,n,o,s,i,a,p,l,c,u,f,h,d,y,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m;!function(e){e[e.Connected=0]="Connected";e[e.SyncTokenRetrieved=1]="SyncTokenRetrieved";e[e.GetChangesFailed=2]="GetChangesFailed";e[e.CreatedSubscription=3]="CreatedSubscription";e[e.CreateSubscriptionFailed=4]="CreateSubscriptionFailed";e[e.SocketIoConnected=5]="SocketIoConnected";e[e.SocketIoDisconnected=6]="SocketIoDisconnected"}(m||(m={}));var v=function(n){r.__extends(e,n);function e(e,t){var r=n.call(this,e,t)||this;r._totalRetries=0;r._delayTimeoutId=[];r._retryDelay=[];r._syncToken="latest";r._itemsStore=t.itemsStore;r._itemAutoRefreshDataSource=t.itemAutoRefreshDataSource;r._pushChannelProvider=t.pushChannelProvider;r._vroomDataRequester=t.vroomDataRequestor;r.initialize();return r}e.prototype.initialize=function(){var t=this;if(this._itemAutoRefreshDataSource.isEnabled()){this._notificationHandlerDebounce=this.async.debounce(function(){t._handleWebhookSubscriptionMessage()},1e4,{leading:!0,maxWait:1e4});this._pushChannelProvider.setupNotificationHandler({source:f.NotificationSource.WebhookSubscription},function(){t._notificationHandlerDebounce()});this._pushChannelProvider.addConnectedHandler(function(){var e=t._pushChannelProvider.getNotificationUrl();if(t._notificationUrl!==e){t._notificationUrl=e;t._reset()}t._nextState(m.Connected)})}else this._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"Not enabled")};e.prototype._reset=function(){var t=this;this._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"Reset");if(this._subscriptionId){var e=this._itemAutoRefreshDataSource.deleteSubscription(this._subscriptionId);e&&e.then(function(){t._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"deleteSubscription")},function(e){t._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"deleteSubscription failed",e)})}this._syncToken="latest";this._subscriptionId=void 0;this._clearDelayTimeout(1)};e.prototype._retrieveSyncToken=function(){var t=this;this._getChanges().then(function(){t._nextState(m.SyncTokenRetrieved)},function(e){t._logError("GetChangesFailed",e);t._delayNextState(m.GetChangesFailed)})};e.prototype._getDriveSubscriptionResubscribeDelay=function(e){var t=255001*Math.random()+15e3;return Date.parse(e.expirationDateTime)-Date.now()-t};e.prototype._createSubscription=function(){var r=this,e=this._pushChannelProvider.getDriveSubscription(!1);if(void 0===e){var t=this._pushChannelProvider.getNotificationUrl(),n=new Date(Date.now()+3e5),o=this._itemAutoRefreshDataSource.createSubscription(this._subscriptionId,t,n);o?o.then(function(e){r._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"_onSubscriptionCreated",e);r._subscriptionId=e.id;r._retryDelay[0]=1e3;r._totalRetries=0;r._delayNextState(m.CreatedSubscription,295e3)},function(e){r._subscriptionId=void 0;r._logError("CreateSubscriptionFailed",e);r._delayNextState(m.CreateSubscriptionFailed)}):this._delayNextState(m.CreateSubscriptionFailed)}else e.then(function(e){if(void 0!==e){var t=r._getDriveSubscriptionResubscribeDelay(e);return 0<t?t:r._pushChannelProvider.getDriveSubscription(!0).then(function(e){if(void 0!==e)return r._getDriveSubscriptionResubscribeDelay(e)})}},function(e){r._logError("CreateSubscriptionFailed",e)}).then(function(e){if(void 0!==e){r._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"_onSubscriptionCreated");r._retryDelay[0]=1e3;r._totalRetries=0;r._delayNextState(m.CreatedSubscription,e)}else r._delayNextState(m.CreateSubscriptionFailed)})};e.prototype._getChanges=function(){var t=this,e=this._itemAutoRefreshDataSource.onGetChanges(this._syncToken);if(!e){if(this._syncToken&&"SPO_LIST,"===this._syncToken.substr(0,9))return o.default.wrap(void 0);e=this._vroomDataRequester.send({apiName:"viewDelta",path:"/drive/root/view.delta?token="+i.default.encodeURIComponent(this._syncToken),useAuthorizationHeaders:!0,headers:this._itemAutoRefreshDataSource.getChangesHeaders()})}return e.then(function(e){t._syncToken=e?e["@delta.token"]:void 0;return e})};e.prototype._handleWebhookSubscriptionMessage=function(){var c=this;this._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"handleWebhookSubscriptionMessage");if(this._itemAutoRefreshDataSource.isAuthValid()){var u={},h=new p.Qos({name:"PushChannel.WebhookSubscriptionMessage"});this._getChanges().then(function(e){if(e){c._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"Ran getChanges",e.value);var t=0,r=c._itemAutoRefreshDataSource.parseChangesResponse(e);if(r){var n=c._itemAutoRefreshDataSource.onMessage(r);if(n){for(var o=[],i=0,s=n;i<s.length;i++){var a=s[i];if(a&&-1===o.indexOf(a.key)){o.push(a.key);c._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"invalidateItem",a);c._itemsStore.invalidateItem(a.key)}}t=o.length}}u.itemsInvalidated=t.toString();h.end({resultType:l.ResultTypeEnum.Success,extraData:u});e["@odata.nextLink"]&&c._handleWebhookSubscriptionMessage()}},function(e){var t,r=!1;if(d.isGraphError(e)){switch(e.status){case 404:r=!0;c._syncToken="latest";break;case 410:r=!0;var n="latest",o=e.request.getResponseHeader("Location");if(o){var i=new s.default(o).getQueryParameter("token");i&&(n=decodeURIComponent(i))}c._syncToken=n;break;case 401:case 403:case 500:c._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"Invalid token",c._itemAutoRefreshDataSource.isAuthValid())}t=JSON.stringify(d.getQosExtraDataFromError(e))}else t=e.message;h.end({resultType:l.ResultTypeEnum.Failure,error:t,extraData:u});r&&c._delayRetry(1,function(){c._handleWebhookSubscriptionMessage()})})}};e.prototype._logError=function(e,t){e="ItemAutoRefreshProvider."+e;this._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,e,t);var r;d.isGraphError(t)&&(r=JSON.stringify(d.getQosExtraDataFromError(t)));a.default.log({message:r},e)};e.prototype._nextState=function(e){this._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"nextState",(new Date).toLocaleString(),m[e]);this._clearDelayTimeout(0);this._pushChannelProvider.isConnected()?this._itemAutoRefreshDataSource.isAuthValid()?void 0===this._syncToken||"latest"===this._syncToken?this._retrieveSyncToken():this._createSubscription():this._delayNextState(e,5e3):this._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"nextState","Not connected")};e.prototype._delayNextState=function(e,t){var r=this;if(this._incrementRetryCount(0,e)){var n=this._delayRetry(0,function(){return r._nextState(e)},t);this._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,m[e],"delaying for "+n+"ms")}};e.prototype._delayRetry=function(e,t,r){var n=this;if(this._incrementRetryCount(e)){var o=r;if(!o){void 0===(o=this._retryDelay[e])&&(o=this._retryDelay[e]=1e3);o<12e4&&(this._retryDelay[e]+=3001*Math.random()+2e3)}this._clearDelayTimeout(e);this._delayTimeoutId[e]=this.async.setTimeout(function(){n._delayTimeoutId[e]=void 0;t()},o);return o}};e.prototype._clearDelayTimeout=function(e){if(void 0!==this._delayTimeoutId[e]){this.async.clearTimeout(this._delayTimeoutId[e]);this._delayTimeoutId[e]=void 0}};e.prototype._incrementRetryCount=function(e,t){if(1===e||t===m.GetChangesFailed||t===m.CreateSubscriptionFailed){this._totalRetries++;if(100<this._totalRetries){this._pushChannelProvider.log(f.PushChannelLogSource.ItemAutoRefreshProvider,"Exceeded max retry limit");new p.Qos({name:"ItemAutoRefreshProvider.RetryLimitExceeded"}).end({resultType:l.ResultTypeEnum.Success});return!1}}return!0};e.dependencies={itemsStore:u.resourceKey,itemAutoRefreshDataSource:g.itemAutoRefresh,pushChannelProvider:h.resourceKey,vroomDataRequestor:y.resourceKey};return e}(n.BaseModel);t.default=v;t.resourceKey=c.createResolvedResourceKey(e("module").id,v)});